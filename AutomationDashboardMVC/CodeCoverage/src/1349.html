<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Platform UI\Common\BrixItemPage.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Text;
using System.Web;
using System.Web.Script.Serialization;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.BusinessLayer.BL;
using Aurigo.AMP3.Core.BusinessLayer.DTO;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebDataInput;
using System.Web.Http;
using System.Net.Http;
using System.Net;
using Aurigo.DataBinding;
using Aurigo.AMP3.ProjectBL;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Newtonsoft.Json;
using Aurigo.AMP3.DataAccess.Core;

namespace Aurigo.AMP3.Core.UI.Common
{
    public partial class BrixItemPage : BrixPageBase, IXMLControl //, ICallbackEventHandler
    {
        public ItemPickerControl ucItemPicker;
        public PickerGrid BudItemPicker;

        #region Private Fields

        private readonly MenuArray menus = new MenuArray();
        private readonly List&lt;MenuGroup&gt; menuGroups = new List&lt;MenuGroup&gt;();
        private ComponentsControl components;
        private ContainerControl container;
        private string context;
        private ModeTypes currentMode = ModeTypes.New;
        private ItemActivityControl itemActivities;
        public ItemDetailModel itemModel;
        private ItemPickerControl itemPicker;
        private RateAnalysisControl rateAnalysisDetail;
        private SubItemControl subItemList;

        private int _selectedContainerID = 0;
        private string _selectedContainerPath = string.Empty;
        private List&lt;string&gt; _budgetModuleComponent = null;

        private CalendarCalculationsModel _calendarModel = CalendarCalculationsModel.GetInstance(&quot;WBSTRUC&quot;);
        private CalendarDetails _calendar
        {
            get
            {
                return _calendarModel.GetCalendarDetails(Int32.Parse(Request.QueryString[&quot;PID&quot;], CultureInfo.CurrentCulture));
            }
        }


        #endregion

        public List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);

        public string callbackResult { get; set; }

        private bool ReadOnly
        {
            set
            {
                //Item Page
                txtAccountingCode.ReadOnly = (value || !itemModel.EnableAccountingCode);
                txtItemDesc.ReadOnly = (value || !itemModel.EnableItemDescription);
                txtItemID.ReadOnly = value;
                txtNotes.ReadOnly = (value || !itemModel.EnableNotes);
                wneQuantity.ReadOnly = (value || !itemModel.EnableQuantity);
                wneUnitCost.ReadOnly = (value || !itemModel.EnableBaseCost);
                wneMarginPercentage.ReadOnly = (value || !itemModel.EnableMargin);
                wneDiscountPercentage.ReadOnly = (value || !itemModel.EnableDiscount);
                rateAnalysisDetail.ReadOnly = value;
                components.ReadOnly = value;
                subItemList.ReadOnly = value;
                trEstimateItemUnitPriceSearch.Disabled = (hdnMode.Value == ModeTypes.View.ToString2());
                //wneUnitPrice.ReadOnly = (value || !itemModel.EnableUnitPrice);

                itemActivities.ReadOnly = (hdnMode.Value == ModeTypes.View.ToString2());
                itemAttachments.ReadOnly = value || (currentMode == ModeTypes.View);

                lnkActivities.Disabled = !itemModel.EnableActivityLink;
                lnkComponents.Disabled = !itemModel.EnableComponentsLink;
                likSubItems.Disabled = !itemModel.EnableSubItemsLink;
                likRateAnalysis.Disabled = !itemModel.EnableRateAnalysisLink;
                likGetCost.Disabled = !itemModel.EnableUpdateCost;
                if (ModuleComponents.Contains(&quot;RateAnalysis&quot;))
                    phRA.Visible = !itemModel.DisplayRateAnalysisSection;
                ddlContainer.Enabled = !value;
                ddlGroups.Enabled = (!value &amp;&amp; itemModel.EnableGroup);
                ddlUnit.Enabled = (!value &amp;&amp; itemModel.EnableUnitSelection);
                ddlFundRule.Enabled = (!value &amp;&amp; itemModel.EnableFundRuleSelection);
                chkComplete.Enabled = (!value &amp;&amp; itemModel.EnableIsComplete);
                chkMustBid.Enabled = (!value &amp;&amp; itemModel.EnableIsMustBid);
                btnItemPathPicker.Visible = (!value &amp;&amp; itemModel.EnableContainerSelection);
                btnOk.Visible = !value;
                btnSaveCont.Visible = !value;
                lnkClear.Visible = (!value &amp;&amp; itemModel.EnableClear);
                ucItemPicker.PickerButton.Enabled =
                    ucItemPicker.PickerText.Enabled = (!value &amp;&amp; itemModel.EnableItemSelection);

                txtStandardItemNo.Enabled = !value &amp;&amp; itemModel.EnableItemSelection;

                if (string.IsNullOrEmpty(ucItemPicker.PickerText.Attributes[&quot;readonly&quot;]) &amp;&amp;
                    (value || !itemModel.EnableStandardItemNo))
                {
                    ucItemPicker.PickerText.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                    txtStandardItemNo.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                }
                else if (itemPicker.ReferenceItemType == &quot;M&quot; || itemPicker.ReferenceItemType == &quot;D&quot;)
                //When Modify existing BOQ  or when COType=&#39;M&#39; then Standard Item No,Description,Quantity,Accounting Code&#39;s textbox should be readonly
                {
                    ucItemPicker.ItemValidationGroup = &quot;&quot;;
                    ucItemPicker.ValidationSkipRequired = true;

                    ucItemPicker.PickerText.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                    if (currentMode == ModeTypes.New)
                    {
                        ucItemPicker.ReadOnly = true;
                        ucItemPicker.PickerButton.Enabled = true;
                    }
                    else
                    {
                        ucItemPicker.ReadOnly = true;
                        ucItemPicker.PickerButton.Enabled = false;
                    }

                    txtItemDesc.ReadOnly = true;
                    wneQuantity.ReadOnly = true;
                    txtAccountingCode.ReadOnly = true;
                    trAmount.Style.Add(HtmlTextWriterStyle.Display, &quot;&quot;);
                }
                else
                {
                    ucItemPicker.PickerText.Attributes.Remove(&quot;readonly&quot;);
                    txtStandardItemNo.Attributes.Remove(&quot;readonly&quot;);
                }

                if ((hdnMode.Value == ModeTypes.Edit.ToString2()))
                {
                    txtNotes.ReadOnly = !itemModel.EnableNotes;
                    btnOk.Visible = chkComplete.Enabled = true;
                }
                if (hdnMode.Value == ModeTypes.View.ToString2())
                    ucItemPicker.ValidationSkipRequired = true;
                chkNC.Enabled = !value &amp; !(chkNC.Checked = itemModel.CheckedNonContractItem);
                btnEdit.Visible = value &amp; !itemModel.CheckedNonContractItem &amp; !itemModel.IsEditOnlyQuantity;
                chkRW.Enabled = (!value &amp;&amp; itemModel.EnableIsRework);
                likGetCost.Attributes[&quot;onclick&quot;] = (value || !itemModel.EnableUpdateCost)
                    ? &quot;return true;&quot;
                    : &quot;GetCost();&quot;;

                if (itemPicker.ReferenceItemType == &quot;M&quot;)
                {
                    //Enable container selection 
                    ddlContainer.Enabled = true;
                    btnItemPathPicker.Visible = true;
                }
            }
        }

        public override void InclueScriptAndStyleFiles()
        {
            base.InclueScriptAndStyleFiles();
            RegisterClientScriptInclude(&quot;~/Scripts/bundle.brixitem.*.js&quot;);
        }

        public override int GetProjectIdFromInstanceId()
        {
            if (!String.IsNullOrEmpty(Request[&quot;mode&quot;]) &amp;&amp;
                         (Request[&quot;mode&quot;].Equals((ModeTypes.Edit.ToInt32_2()).ToString2())
                || (Request[&quot;mode&quot;].Equals((ModeTypes.View.ToInt32_2()).ToString2()))))
            {
                if (itemModel == null)
                {
                    itemModel = SetItemModel();

                    if (itemModel == null)
                    {
                        //TODO: Display approrinate message
                        UIHelper.RedirectURL(MessageResourceManager.GetString(&quot;E_USRMGMT_NO_PERMISSIONS_TO_VIEW_PAGE&quot;,
                       Enumerations.MessageType.ErrorMessage),
                        ResolveUrl(Constants.URL_ENTERPRISE), null, Context);
                    }
                }

                string moduleId = Request.QueryString[&quot;context&quot;];

                int itemId = -1;
                if (!string.IsNullOrEmpty(Request[&quot;ItemID&quot;]))
                {
                    int.TryParse(Request[&quot;ItemID&quot;], out itemId);
                }

                int parentId = -1;
                if (!string.IsNullOrEmpty(Request[&quot;ParentId&quot;]))
                {
                    int.TryParse(Request[&quot;ParentId&quot;], out parentId);
                }

                return itemModel.GetProjectIdFromItemInstanceId(ModuleId, parentId, itemId);
            }
            else // return value coming from url
                return base.GetProjectIdFromInstanceId();
        }

        protected override void OnPreInit(EventArgs e)
        {
            base.OnPreInit(e);
            if ((UserDetail.GetCurrentUserDetail()) == null)
            {
                UIHelper.RedirectURL(&quot;Please login to access the system.&quot;,
                    ConfigurationManager.AppSettings[&quot;ssoLoginUrl&quot;],
                    Request.Url.PathAndQuery.ToString2(), Context);
            }

            itemModel = SetItemModel();
            if (itemModel == null)
            {
                //TODO: Display approrinate message
                UIHelper.RedirectURL(MessageResourceManager.GetString(&quot;E_USRMGMT_NO_PERMISSIONS_TO_VIEW_PAGE&quot;,
                    Enumerations.MessageType.ErrorMessage),
                    ResolveUrl(Constants.URL_ENTERPRISE), null, Context);

                return;
            }

            ModuleId = itemModel.ModuleId;
        }

        private ItemDetailModel SetItemModel()
        {
            context = Request.QueryString[&quot;context&quot;];
            ItemDetailModel retModel = ItemDetailModel.GetInstance(Request, Response,
                Session[Constants.EIS_ADDITIONAL_INFO] == null
                    ? string.Empty
                    : Session[Constants.EIS_ADDITIONAL_INFO].
                        ToString2());
            return retModel;
        }

        protected override void OnInit(EventArgs e)
        {
            InitializeTaskItemPicker();
            InitializebudgetItemPicker();
            InitializeIPItemPicker();
            if (!string.IsNullOrEmpty(Request[&quot;ItemID&quot;]))
            {
                int itemId;
                if (int.TryParse(Request[&quot;ItemID&quot;], out itemId))
                    txtItemID.Text = Request[&quot;ItemID&quot;];
            }
            int parentInstanceID = 0;

            if (Request.QueryString[&quot;ParentID&quot;] != null)
                parentInstanceID = Convert.ToInt32(Request.QueryString[&quot;ParentID&quot;], CultureInfo.CurrentCulture);

            #region Init ItemPicker

            if (!string.IsNullOrEmpty(Request.QueryString[&quot;Context&quot;]) &amp;&amp;
                (!string.IsNullOrEmpty(Request.QueryString[&quot;COType&quot;]) &amp;&amp;
                 (Request.QueryString[&quot;Context&quot;] == &quot;CHNGORD&quot; || Request.QueryString[&quot;Context&quot;] == &quot;BDGTREV&quot;)
                 &amp;&amp; ((Request.QueryString[&quot;COType&quot;] == &quot;M&quot;) || Request.QueryString[&quot;COType&quot;] == &quot;D&quot;)) ||
                (!string.IsNullOrEmpty(Request.QueryString[&quot;AddExistingItem&quot;]) &amp;&amp;
                 Request.QueryString[&quot;Context&quot;] == &quot;ESTMADD&quot; &amp;&amp; Request.QueryString[&quot;AddExistingItem&quot;] == &quot;Y&quot;))
            {
                ucItemPicker = (ItemPickerControl)Page.LoadControl(&quot;~/Modules/UserControls/ItemPickerControl.ascx&quot;);
                OldItemPickerPlaceHolder.Controls.Add(ucItemPicker);

                txtStandardItemNo.Style.Add(&quot;display&quot;, &quot;none&quot;);
                itemNoMandatorySign.Style.Add(&quot;display&quot;, &quot;none&quot;);
                divItemPicker.Style.Add(&quot;display&quot;, &quot;none&quot;);
                txtNotes.Style.Add(&quot;width&quot;, &quot;505px&quot;);
                RequiredFieldValidator2.Enabled = false;
                if(Request.QueryString[&quot;Context&quot;] == &quot;BDGTREV&quot;)
                {
                    RequiredFieldValidator1.Enabled = false;
                    RequiredFieldValidator2.Enabled = true;
                    RequiredFieldValidator2.Style.Add(&quot;position&quot;,&quot;relative&quot;);
                    RequiredFieldValidator2.Style.Add(&quot;margin-left&quot;,&quot;245px&quot;);
                    RequiredFieldValidator2.Style.Add(&quot;top&quot;,&quot;17px&quot;);
                }

                if (Request.QueryString[&quot;Context&quot;] == &quot;ESTMADD&quot; &amp;&amp; Request.QueryString[&quot;AddExistingItem&quot;] == &quot;Y&quot;)
                {
                    ucItemPicker.ReadOnly = true;
                }
            }
            else
            {
                ucItemPicker =
                    (ItemPickerControl)Page.LoadControl(&quot;~/Modules/UserControls/ItemPickerControlItemPageUI.ascx&quot;);
                NewItemPickerPlaceHolder.Controls.Add(ucItemPicker);
                ucItemPicker.PickerGridButtonText = &quot;Select&quot;;

                if (!string.IsNullOrEmpty(Request.QueryString[&quot;Context&quot;]) &amp;&amp; (Request.QueryString[&quot;Context&quot;] == &quot;LIBRARY&quot; || Request.QueryString[&quot;Context&quot;] == &quot;WBSTRUC&quot;))
                {
                    divItemPicker.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    txtNotes.Style.Add(&quot;width&quot;, &quot;505px&quot;);
                }
            }


            itemPicker = (ucItemPicker);

            ItemPicker_Init();
            //ucItemPicker.InitItemPickerParams += new ItemPickerControl.InitParams(ItemPicker_Init);


            itemPicker.ReferenceItemType = Request.QueryString[&quot;COType&quot;];

            //CHNGORD - SHOWS ALL THE CONTRACT ITEMS // IF REFERENCETYPE IS C =&gt; ALL NON CONTRACT ITEM ELSE CONTRACT ITEMS
            //LIBRARY - SHOWS ALL THE STANDARD ITEMS
            //BDGTREV - shows all the budget estimate items 
            itemPicker.ModuleID = !(String.IsNullOrEmpty(Request[&quot;AddExistingItem&quot;]))
                ? &quot;ADDENDU&quot;
                : (!string.IsNullOrEmpty(itemPicker.ReferenceItemType) &amp;&amp; itemPicker.ReferenceItemType != &quot;N&quot;)
                    ? (context == &quot;BDGTREV&quot; ? &quot;BDGTREV&quot; : &quot;CHNGORD&quot;)
                    : &quot;LIBRARY&quot;;

            itemPicker.IsContractView = itemModel.IsContractView;
            itemPicker.ParentInstanceID = parentInstanceID;
            if (itemPicker.ModuleID == &quot;LIBRARY&quot;)
            {
                itemPicker.DisplayIgnoreContainer = true;
                itemPicker.DefaultTableID = itemModel.DefaultStandardTable;
            }

            if (Request.QueryString[&quot;COType&quot;] != null &amp;&amp; Request.QueryString[&quot;COType&quot;] == &quot;C&quot;)
            {
                itemPicker.EnableMultipleSelect = true;
                itemPicker.MultipleSelectedIndexChanged += itemPicker_MultipleSelectedIndexChanged;
            }
            else
                itemPicker.SelectedIndexChanged += itemPicker_SelectedIndexChanged;

            #endregion

            #region Item Activities

            itemActivities = (ucItemActivity);
            itemActivities.ModuleID = itemModel.ModuleId;
            itemActivities.ParentInstanceID = parentInstanceID;
            itemActivities.BackClicked += BtnCancelFromControl_Click;
            itemActivities.ParentItemModel = itemModel;
            itemModel.ActivityControl = itemActivities;
            itemActivities.ValidateQty = itemModel.ValidateActivityQty;

            #endregion

            #region Sub Items

            subItemList = (ucSubItem);
            subItemList.ModuleID = itemModel.ModuleId;
            subItemList.IsContractView = itemModel.IsContractView;
            subItemList.ParentInstanceID = parentInstanceID;
            subItemList.BackClicked += BtnCancelFromControl_Click;
            if (!string.IsNullOrEmpty((Request.QueryString[&quot;COType&quot;]))
                &amp;&amp; Request.QueryString[&quot;COType&quot;].Equals(&quot;M&quot;))
            {
                ucSubItem.ReferenceItemType = &quot;M&quot;;
            }
            else if (!string.IsNullOrEmpty((Request.QueryString[&quot;COType&quot;]))
                     &amp;&amp; Request.QueryString[&quot;COType&quot;].Equals(&quot;D&quot;))
            {
                ucSubItem.ReferenceItemType = &quot;D&quot;;
            }
            subItemList.ParentItemModel = itemModel;
            itemModel.SubitemControl = subItemList;

            #endregion

            #region Rate Analysis

            rateAnalysisDetail = (ucRateAnalysis);
            rateAnalysisDetail.ModuleID = itemModel.ModuleId;
            rateAnalysisDetail.ParentInstanceID = parentInstanceID;
            rateAnalysisDetail.BackClicked += BtnCancelFromControl_Click;
            rateAnalysisDetail.ParentItemModel = itemModel;

            #endregion

            #region &quot;Container&quot;

            container = (ucContainerControl);

            //TODO: Test this block
            container.ModuleID = itemModel.ModuleId;
            container.ParentInstanceID = itemModel.ParentModuleInstanceID;
            container.NodeClicked += container_NodeClicked;

            #endregion

            #region Components

            components = (ucComponents);
            components.ModuleID = itemModel.ModuleId;
            components.ParentInstanceID = parentInstanceID;
            components.BackClicked += BtnCancelFromControl_Click;
            components.ParentItemModel = itemModel;

            #endregion

            lnkActivities.ServerClick += lnkActivities_ServerClick;
            lnkGhostActivities.ServerClick += lnkActivities_ServerClick;
            lnkComponents.ServerClick += lnkComponents_ServerClick;
            lnkGhostComponents.ServerClick += lnkComponents_ServerClick;
            likSubItems.ServerClick += lnkSubItems_Click;
            lnkGhostSubItems.ServerClick += lnkSubItems_Click;
            likRateAnalysis.ServerClick += lnkRateAnalysis_Click;
            lnkGhostRateAnalysis.ServerClick += lnkRateAnalysis_Click;
            //btnOk.Click += btnOk_ServerClick;
            //btnSaveCont.Click += btnSaveCont_ServerClick;
            btnEdit.Click += btnEdit_Click;
            btnItemPathPicker.Click += btnItemPathPicker_Click;
            if (string.IsNullOrEmpty(Request[&quot;mode&quot;]) ||
                !Request[&quot;mode&quot;].Equals(Convert.ToInt32(ModeTypes.View, CultureInfo.CurrentCulture).ToString2()))
            {
                lnkUnitPriceSearch.ServerClick += lnkUnitPriceSearch_ServerClick;
            }
            wneQuantity.Value = 0;
            //btnOk.Attributes.Add(&quot;onclick&quot;, &quot;document.getElementById(&#39;&quot; + hdnSave.ClientID + &quot;&#39;).value = &#39;true&#39;;&quot;);

            wneUnitCost.HorizontalAlign =
                wneUnitCostFinal.HorizontalAlign =
                    wneOverheadCost.HorizontalAlign =
                        wneUnitPrice.HorizontalAlign = wneMarginPercentage.HorizontalAlign =
                            wceMargin.HorizontalAlign =
                                wneDiscountPercentage.HorizontalAlign =
                                    wceDiscount.HorizontalAlign =
                                        wneAmount.HorizontalAlign =
                                            HorizontalAlign.Right;


            // Adding Event Handler for &quot;Projected Unit Price&quot; field for all BOQ Items except New CO BOQ in Change Order
            bool isNewCOItem = !string.IsNullOrEmpty((Request.QueryString[&quot;COType&quot;])) &amp;&amp;
                               Request.QueryString[&quot;COType&quot;].Equals(&quot;N&quot;) &amp;&amp;
                               (Request.QueryString[&quot;Context&quot;].Equals(&quot;CHNGORD&quot;) ||
                                Request.QueryString[&quot;Context&quot;].Equals(&quot;BDGTREV&quot;));
            if (!isNewCOItem)
            {
                wneUnitPrice.ClientSideEvents.TextChanged = &quot;wneUnitPrice_TextChanged&quot;;
                wneUnitPrice.ReadOnly = true;
            }

            base.OnInit(e);
        }

        public void itemPicker_CustomizeGridColumns(ref List&lt;PickerColumnDetails&gt; lst)
        {
            //throw new NotImplementedException();
            //override in the corresponding concrete models to make necessary customizations
            itemModel.CustomizeItemPickerColumns(ref lst);
        }

        private void lnkComponents_ServerClick(object sender, EventArgs e)
        {
            if (hdnMode.Value.Equals(ModeTypes.New.ToString2()) || hdnMode.Value.Equals(ModeTypes.Edit.ToString2()))
                btnSaveCont_ServerClick(sender, e);
            if (!string.IsNullOrEmpty(txtItemID.Text.Trim()) &amp;&amp;
                (ViewState[&quot;HasErrors&quot;] == null ||
                 (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2())))
            {
                ShowDiv(ItemDivEnums.Components);
                PageTitle = &quot;Components&quot;;
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                components.LoadItem(Convert.ToInt32(txtItemID.Text.Trim(), CultureInfo.CurrentCulture));
            }
        }

        private void lnkActivities_ServerClick(object sender, EventArgs e)
        {
            if ((hdnMode.Value.Equals(ModeTypes.Edit.ToString2())) || (hdnMode.Value.Equals(ModeTypes.New.ToString2())))
                btnSaveCont_ServerClick(sender, e);

            if (!string.IsNullOrEmpty(txtItemID.Text.Trim()) &amp;&amp;
                (ViewState[&quot;HasErrors&quot;] == null ||
                 (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2())))
            {
                ShowDiv(ItemDivEnums.ItemActivity);
                PageTitle = GlobalizationUtility.SetResource(&quot;Item Activities&quot;, false);
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                itemActivities.DisplayPicker = itemModel.DisplayActivityPicker;
                itemActivities.DisplayActivityQuantity = itemModel.DisplayActivityQuantity;
                itemActivities.DisplayComplete = itemModel.DisplayActivityComplete;
                itemModel.LoadActivityDetails(txtItemID.Text.Trim().ToInt32_2());
                itemActivities.SetStdItemNoAndDescTemporarily(ucItemPicker.Text, txtItemDesc.Text);
            }
        }

        private void container_NodeClicked(object sender, EventArgs e)
        {
            ShowDiv(ItemDivEnums.CreateItem);
            PageTitle = hdnMode.Value.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
            ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            txtItemPath.Text = container.SelectedNodePath;
            hdnContainerID.Value = container.SelectedNode.Value;

            //Clear off the hdnSelItemContainerID - Don&#39;t create the Container
            hdnSelItemContainerID.Value = String.Empty;
        }

        private void btnEdit_Click(object sender, EventArgs e)
        {
            Response.Redirect(&quot;~/Common/BrixItemPage.aspx?&quot; +
                              Request.QueryString.ToString2().Replace(&quot;Mode=&quot; + (int)ModeTypes.View,
                                  &quot;Mode=&quot; + (int)ModeTypes.Edit));
        }

        private void SetMode(ModeTypes mode)
        {
            hdnMode.Value = mode.ToString2();
            rateAnalysisDetail.ReadOnly = subItemList.ReadOnly = itemActivities.ReadOnly = mode.Equals(ModeTypes.View);
        }

        private void itemPicker_SelectedIndexChanged(object sender, ClickEventArgs e)
        {
            Item stdItem = itemPicker.GetDTOFromHTTP(null);

            //TODO: Test this
            //If the operation is modifying existing item then only Quantity is editable.
            //Moreover if item has subitem then Quantity is editable by going on Subitem else directly on 
            //the Itempage. If operation is Conversion then returing back to list page.
            //And if operation is neither of them then do not perform any operation.

            if (stdItem != null)
            {
                string moduleID = &quot;LIBRARY&quot;; // Note: For library - satndard items, ModuleID is coming null.
                if (!string.IsNullOrWhiteSpace(stdItem.ModuleID))
                    moduleID = stdItem.ModuleID;

                GetItemDetails(sender, e, stdItem);
                if (stdItem.ItemID.HasValue &amp;&amp; itemModel.DisplayRateAnalysisSection)
                {
                    ucRateAnalysis.IsStdItemSelected = true;
                    ucRateAnalysis.LoadItem(moduleID, stdItem.ParentInstanceID, stdItem.ItemID.Value);
                }
            }
            else
                throw new Exception(&quot;There are no Items. Create items in Library&quot;);
        }

        private void GetItemDetails(object sender, ClickEventArgs e, Item stdItem)
        {
            ModifyingExisting modifyExisting = ModifyingExisting.None;
            bool IsQuantityEditable = false;
            modifyExisting = itemModel.HandleItemPickerData(stdItem, modifyExisting);
            if (modifyExisting == ModifyingExisting.Edit)
            {
                if (
                    !(currentMode == ModeTypes.New &amp;&amp; !string.IsNullOrEmpty(Request.QueryString[&quot;AddExistingItem&quot;]) &amp;&amp;
                      Request.QueryString[&quot;AddExistingItem&quot;].Equals(&quot;Y&quot;)))
                {
                    EditOnlyQuantity();
                    // Note: Above function call will stop saving resource data.
                    // But should be allowed, as on selection of current budget item in budget revision. We need to copy resource data and save.
                    // Hence, overriding the flag.
                    ucRateAnalysis.ReadOnly = false;
                }
                if (itemModel.EnableBaseCost)
                    wneUnitCost.ReadOnly = false;

                chkComplete.Enabled = true;

                IsQuantityEditable = true;
                hdnReferenceItemID.Value = stdItem.ItemID.ToString2();

                object qty = itemModel.GetSubItemQuantity(stdItem.ItemID ?? 0);
                if (qty != null &amp;&amp; qty is decimal)
                {
                    wneQuantity.ReadOnly = true;
                    wneQuantity.ValueDecimal = qty.ToDecimal2();
                }

                BindInflationFields(stdItem, ModeTypes.Edit);
            }
            else if (modifyExisting == ModifyingExisting.Cancel)
                btnCancel_Click(sender, null);

            //Need to see if this effects anything. 
            //This was a fix for PI-30792: When the user changes the quanity in modify CO,the unit price automatically becomes zero
            //Setting the NC checkbox from the selected item.
            chkNC.Checked = (stdItem.IsNonContract ?? false) || itemModel.CheckedNonContractItem;
            chkMustBid.Checked = (stdItem.IsMustBid.HasValue) ? stdItem.IsMustBid.Value : false;
            ucItemPicker.Text = stdItem.StandardItemNo;
            txtStandardItemNo.Text = stdItem.StandardItemNo;
            hdnSelectedBudgetItemToDelete.Value = stdItem.ItemID.ToString();
            txtItemDesc.Text = stdItem.Description;
            txtNotes.Text = stdItem.Notes;
            txtAccountingCode.Text = stdItem.AccountingCode;
            ddlUnit.SelectedIndex = -1;
            if (itemModel.DisplayBudgetItemLinkPicker &amp;&amp; ModuleManager.Instance.ModuleExists(Constants.MODID_BDGMGMT) &amp;&amp;
                BudgetModuleComponent.Contains(&quot;LinkBudgetItem&quot;))
            {
                txtBudgetItem.Text = stdItem.LinkedBudgetItemName;
                hdnSelectedBudgetItem.Value = stdItem.LinkedBudgetItem.ToString();
                if (!string.IsNullOrEmpty(stdItem.LinkedBudgetItem.ToString()) &amp;&amp; itemModel.DisallowRelinking)
                {
                    btnShowItemPicker.Enabled = false;
                    btnClearBudgetItem.Enabled = false;
                    btnClearBudgetItem.OnClientClick = null;
                }
                else
                {
                    btnShowItemPicker.Enabled = true;
                    btnClearBudgetItem.Enabled = true;
                    btnClearBudgetItem.OnClientClick = &quot;return ClearBudgetItemLinking()&quot;;
                }
            }
            if (ddlUnit.Items.FindByText(stdItem.Unit) != null)
                ddlUnit.Items.FindByText(stdItem.Unit).Selected = true;
            else
            {
                int newUnitID = ItemManager.Instance.CopyMeasureUnit(Request[&quot;Context&quot;],
                    Convert.ToInt32(Request[&quot;ParentID&quot;],
                        CultureInfo.CurrentCulture),
                    stdItem.UnitID);
                if (newUnitID &gt; 0)
                {
                    ddlUnit.Items.Insert(0, new ListItem(stdItem.Unit, newUnitID.ToString2()));
                    ddlUnit.SelectedIndex = -1;
                    ddlUnit.SelectedIndex = 0;
                }
            }

            ddlGroups.SelectedIndex = -1;
            if (ddlGroups.Items.FindByText(stdItem.GroupName) != null)
            {
                ddlGroups.Items.FindByText(stdItem.GroupName).Selected = true;
            }
            else
            {
                ddlGroups.Items.Insert(0, new ListItem(stdItem.GroupName, &quot;0&quot;));
                ddlGroups.SelectedIndex = 0;
            }
            if (ddlFundRule.Items.FindByText(stdItem.RuleName) != null)
            {
                ddlFundRule.SelectedIndex = -1;
                ddlFundRule.Items.FindByText(stdItem.RuleName).Selected = true;
            }
            else if (!string.IsNullOrEmpty(Request.QueryString[&quot;Context&quot;]) &amp;&amp;
                     (!string.IsNullOrEmpty(Request.QueryString[&quot;COType&quot;]) &amp;&amp;
                      (Request.QueryString[&quot;Context&quot;] == &quot;CHNGORD&quot; || Request.QueryString[&quot;Context&quot;] == &quot;BDGTREV&quot;)
                      &amp;&amp; (Request.QueryString[&quot;COType&quot;] == &quot;M&quot; || Request.QueryString[&quot;COType&quot;] == &quot;D&quot;)) ||
                     (!string.IsNullOrEmpty(Request.QueryString[&quot;AddExistingItem&quot;]) &amp;&amp;
                      Request.QueryString[&quot;Context&quot;] == &quot;ESTMADD&quot; &amp;&amp; Request.QueryString[&quot;AddExistingItem&quot;] == &quot;Y&quot;))
            {
                ddlFundRule.SelectedIndex = -1;
                if (ddlFundRule.Items.FindByText(&quot;Select&quot;) != null)
                {
                    ddlFundRule.Items.FindByText(&quot;Select&quot;).Selected = true;
                }
            }
            ddlAlternates.SelectedIndex = -1;
            if (ddlAlternates.Items.FindByValue(stdItem.AlternateID.ToString2()) != null)
                ddlAlternates.Items.FindByValue(stdItem.AlternateID.ToString2()).Selected = true;
            if (ddlAlternates.Items.Count &gt; 0 &amp;&amp; string.IsNullOrEmpty(stdItem.AlternateID.ToString2()))
            {
                ddlAlternates.Items.FindByText(&quot;Base Bid&quot;).Selected = true;
            }

            if (stdItem.ItemID.HasValue)
                hdnStdItemID.Value = stdItem.ItemID.ToString2();

            if (stdItem.ItemID.HasValue)
                hdnReferenceItemID.Value = (!string.IsNullOrEmpty(Request[&quot;Context&quot;]) &amp;&amp; Request[&quot;Context&quot;] == &quot;ESTMADD&quot;
                                            &amp;&amp; string.IsNullOrEmpty(Request[&quot;AddExistingItem&quot;]))
                    ? &quot;0&quot;
                    : stdItem.ItemID.ToString2();

            ShowDiv(ItemDivEnums.CreateItem);

            //APPLY CURRENCY CONVERSION FROM LIBRARY CURRENCY TO CONTRACT/ESTIMATE CURRENCY
            //APPLIED TO BASE UNIT COST,UNIT COST,RATE ANALYSIS COST,MARGIN,DISCOUNT,AMOUNT,UNIT PRICE

            string context = Request[&quot;Context&quot;];
            string instanceId = Request[&quot;ParentID&quot;];
            //CONTRACT CURRENCY FOR CHANGE ORDER                    
            instanceId = (context.Equals(&quot;CHNGORD&quot;) || context.Equals(&quot;BDGTREV&quot;)) ? Request[&quot;ContractId&quot;] : instanceId;
            context = context.Equals(&quot;CHNGORD&quot;) ? &quot;CONTMGT&quot; : (context.Equals(&quot;BDGTREV&quot;) ? &quot;CURBDGT&quot; : context);

            //CONTRACT CURRENCY FOR CostRevision                    
            instanceId = context.Equals(&quot;COSTVER&quot;) ? Request[&quot;ContractId&quot;] : instanceId;
            context = context.Equals(&quot;COSTVER&quot;) ? &quot;CONTMGT&quot; : context;

            //PROJECT CURRENCY FOR FOR ESTIMATE ADDENDUM           
            instanceId = context.Equals(&quot;ESTMADD&quot;) ? Request[&quot;PID&quot;] : instanceId;
            context = context.Equals(&quot;ESTMADD&quot;) ? &quot;PROJECT&quot; : context;

            string contractCurrency = LocalizationManager.GetModuleCurrency(context, instanceId);
            string libraryCurrency = LocalizationManager.GetModuleCurrency(&quot;LIBRARY&quot;, null);
            bool isApply = true;
            if (contractCurrency.Equals(libraryCurrency))
                isApply = false;
            //NO CURRENCY CONVERSION FOR ADD EXISTING ITEM
            if (!string.IsNullOrEmpty(Request[&quot;AddExistingItem&quot;]) &amp;&amp; Request[&quot;AddExistingItem&quot;].Equals(&quot;Y&quot;))
                isApply = false;
            decimal baseUnitCost = stdItem.BaseUnitCost.GetValueOrDefault(0M);
            if (isApply)
                LocalizationManager.ApplyCurrencyConversion(libraryCurrency, contractCurrency, ref baseUnitCost,
                    Session[&quot;AXCompany&quot;].ToString2());
            wneUnitCost.Value = baseUnitCost;
            decimal unitCost = ModuleComponents.Contains(&quot;ItemUnitCost&quot;)
                ? stdItem.UnitCost.GetValueOrDefault(0M)
                : baseUnitCost;
            if (isApply)
                LocalizationManager.ApplyCurrencyConversion(libraryCurrency, contractCurrency, ref unitCost,
                    Session[&quot;AXCompany&quot;].ToString2());
            wneUnitCostFinal.Value = unitCost;

            decimal overHeadCost = stdItem.OverheadCost.GetValueOrDefault(0M);
            if (isApply)
                LocalizationManager.ApplyCurrencyConversion(libraryCurrency, contractCurrency, ref overHeadCost,
                    Session[&quot;AXCompany&quot;].ToString2());
            wneOverheadCost.Value = overHeadCost;

            decimal baseUnitCostWithOverhead = baseUnitCost + overHeadCost;
            wneMarginPercentage.Value = stdItem.Margin;
            wceMargin.Value = baseUnitCostWithOverhead * stdItem.Margin.GetValueOrDefault(0M) * 0.01M;

            decimal costWithMargin = baseUnitCostWithOverhead + wceMargin.ValueDecimal;
            wneDiscountPercentage.Value = stdItem.Discount.GetValueOrDefault(0M);
            wceDiscount.Value = costWithMargin * stdItem.Discount.GetValueOrDefault(0M) * 0.01M;

            if (itemModel.IsCalculateUnitPriceFromUnitCost ||
                (!(ModuleComponents.Contains(&quot;ItemMargin&quot;) &amp;&amp; ModuleComponents.Contains(&quot;ItemDiscount&quot;))))
                wneUnitPrice.Value = (unitCost +
                                      (Convert.ToDecimal(wceMargin.Value, CultureInfo.CurrentCulture) -
                                       Convert.ToDecimal(wceDiscount.Value, CultureInfo.CurrentCulture)));
            else
                wneUnitPrice.Value = stdItem.UnitPrice;
            wneAmount.Value = itemModel.IsAmountFromUnitCost
                ? (stdItem.Quantity * wneUnitCostFinal.ValueDecimal)
                : (stdItem.Quantity * wneUnitPrice.ValueDecimal);

            decimal rateAnalysisCost =
                Convert.ToDecimal(
                    ItemManager.Instance.GetUnitCost(stdItem.ItemID.GetValueOrDefault(0), itemPicker.ModuleID,
                        stdItem.ParentInstanceID), CultureInfo.CurrentCulture);
            if (isApply)
                LocalizationManager.ApplyCurrencyConversion(libraryCurrency, contractCurrency, ref rateAnalysisCost,
                    Session[&quot;AXCompany&quot;].ToString2());
            lblCost.Text = rateAnalysisCost.ToString(AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE,
                CultureInfo.CurrentCulture);

            decimal quantity = (!IsQuantityEditable) ? stdItem.Quantity : 0;
            if (!string.IsNullOrEmpty(Request.QueryString[&quot;AddExistingItem&quot;]) &amp;&amp;
                Request.QueryString[&quot;AddExistingItem&quot;].Equals(&quot;Y&quot;))
                quantity = stdItem.Quantity;
            wneQuantity.Value = quantity;
            wneAmount.Value = itemModel.IsAmountFromUnitCost
                ? (quantity * wneUnitCostFinal.ValueDecimal)
                : (quantity * wneUnitPrice.ValueDecimal);

            if (stdItem.ContainerID.HasValue &amp;&amp; !itemModel.IgnoreStdItemContainer)
            {
                int newID = stdItem.ContainerID.Value;
                if (newID &gt; 0)
                {
                    if ((!string.IsNullOrEmpty(Request[&quot;COType&quot;]) &amp;&amp; Request[&quot;COType&quot;].Equals(&quot;M&quot;)) ||
                        (!string.IsNullOrEmpty(Request[&quot;AddExistingItem&quot;]) &amp;&amp; Request[&quot;AddExistingItem&quot;].Equals(&quot;Y&quot;)))
                    {
                        hdnContainerID.Value = newID.ToString2();
                        container.DataBind(hdnContainerID.Value);
                        txtItemPath.Text = container.SelectedNodePath;
                    }
                    else if (!itemPicker.FilterIgnoreContainer)
                    {
                        //Store the Selected Std. Item&#39;s Container ID - Belongs to LIBRARY
                        hdnSelItemContainerID.Value = newID.ToString2();
                        DataSet selContainerData = ItemManager.Instance.GetContainer(null, null, newID);
                        if (hdnContainerID.Value.Equals(Request[&quot;ContainerID&quot;]))
                        {
                            //txtItemPath.Text += &quot;/&quot; + selContainerData.Tables[0].Rows[0][&quot;ContainerName&quot;].ToString2();
                            txtItemPath.Text = _selectedContainerPath + &quot;/&quot; + selContainerData.Tables[0].Rows[0][&quot;ContainerName&quot;].ToString2();
                        }
                        else
                        {
                            txtItemPath.Text = selContainerData.Tables[0].Rows[0][&quot;ContainerName&quot;].ToString2();
                            if (string.IsNullOrEmpty(hdnContainerID.Value))
                                hdnContainerID.Value = selContainerData.Tables[0].Rows[0][&quot;ContainerID&quot;].ToString2();
                        }
                    }
                }
            }
            PageTitle = hdnMode.Value.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
            ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            if (string.IsNullOrEmpty(txtItemID.Text))
            {
                GetActivityCount(stdItem.ModuleID, stdItem.ParentInstanceID, stdItem.ItemID.Value);
                GetComponentCount(stdItem.ItemID.Value, stdItem.ModuleID, stdItem.ParentInstanceID);
            }

            if (!hdnMode.Value.Contains(&quot;New&quot;))
                hdnIsNewItem.Value = &quot;Y&quot;;

            BindInflationFields(stdItem, ModeTypes.Edit);
        }

        private void itemPicker_MultipleSelectedIndexChanged(object sender, ClickEventArgs e)
        {
            List&lt;Item&gt; Items = itemPicker.GetMultipleDTOFromHTTP();

            //TODO: Test this
            //If the operation is modifying existing item then only Quantity is editable.
            //Moreover if item has subitem then Quantity is editable by going on Subitem else directly on 
            //the Itempage. If operation is Conversion then returing back to list page.
            //And if operation is neither of them then do not perform any operation.

            foreach (Item stdItem in Items)
            {
                GetItemDetails(sender, e, stdItem);
            }
            if (!hdnMode.Value.Contains(&quot;New&quot;))
                hdnIsNewItem.Value = &quot;Y&quot;;
        }

        private void EditOnlyQuantity()
        {
            ReadOnly = true;

            // Override State of Funding Rule &amp; Accounting Code control.
            if (itemModel.IsOverrideAccCodeAndFundingRuleState)// Note: This property getting assigned as true from BudgetRevisionItemModel &amp; ChangeOrderItemModel
            {
                ddlFundRule.Enabled = itemModel.EnableFundRuleSelection;
                txtAccountingCode.ReadOnly = !itemModel.EnableAccountingCode;
            }

            ucSubItem.ReferenceItemType = &quot;M&quot;;
            ucSubItem.ReadOnly = false;
            itemAttachments.ReadOnly = false;
            wneQuantity.ReadOnly = txtNotes.ReadOnly = !itemModel.EnableQuantity;
            btnOk.Visible = true;
            if (ucSubItem.ReferenceItemType == &quot;M&quot;)
            {
                ucItemPicker.ItemValidationGroup = &quot;&quot;;
                ucItemPicker.ValidationSkipRequired = true;

                if (currentMode == ModeTypes.New)
                {
                    ucItemPicker.PickerButton.Enabled = true;
                    lnkClear.Visible = itemModel.EnableClear;
                }                   
                else if (currentMode == ModeTypes.Edit || currentMode == ModeTypes.View)
                    ucItemPicker.PickerButton.Enabled = false;

                btnSaveCont.Visible = false;
            }
            else
            {
                ucItemPicker.PickerButton.Enabled = true;
                btnSaveCont.Visible = true;
            }
        }

        private void GetActivityCount(string moduleID, int parentInstanceID, int itemID)
        {
            if (itemID != 0)
                txtActivities.Text =
                    itemModel.GetItemActivities(moduleID, parentInstanceID, itemID, &quot;Y&quot;).Tables[0].Rows[0][
                        &quot;ActivityCount&quot;].ToString2();
            else
                txtActivities.Text = &quot;0&quot;;
        }

        private void GetSubItemQuantity()
        {
            if (!string.IsNullOrEmpty(txtItemID.Text))
            {
                object qty = itemModel.GetSubItemQuantity(txtItemID.Text.ToInt32_2());
                if (qty is decimal)
                {
                    wneQuantity.ReadOnly = true;
                    wneQuantity.ValueDecimal = qty.ToDecimal2();
                }
                else
                {
                    if (wneQuantity.ReadOnly &amp;
                        (String.IsNullOrEmpty(Request[&quot;mode&quot;]) ||
                         Request[&quot;mode&quot;].Equals((ModeTypes.Edit.ToInt32_2()).ToString2())))
                    {
                        int parentId, itemId;
                        int.TryParse(Request[&quot;ParentID&quot;].ToString2(), out parentId);
                        if (int.TryParse(Request[&quot;ItemID&quot;], out itemId))
                        {
                            Item itemDTO = itemModel.GetItemDetails(itemId);

                            if (Request[&quot;mode&quot;].Equals((ModeTypes.Edit.ToInt32_2()).ToString2()))
                            {
                                wneQuantity.ValueDecimal = itemDTO.Quantity;
                                wneQuantity.ReadOnly = (wneQuantity.ValueDecimal == 0)
                                    ? !itemModel.EnableQuantity
                                    : true;
                            }
                        }
                        else
                        {
                            wneQuantity.ValueDecimal = 0M;
                            wneQuantity.ReadOnly = !itemModel.EnableQuantity;
                        }
                    }
                }
                wneAmount.ValueDecimal = itemModel.IsAmountFromUnitCost
                    ? (wneQuantity.ValueDecimal * wneUnitCostFinal.ValueDecimal)
                    : (wneQuantity.ValueDecimal * wneUnitPrice.ValueDecimal);
            }
        }

        private void GetItemCost()
        {
            decimal cost = 0.0M;
            if (!string.IsNullOrEmpty(txtItemID.Text))
            {
                cost = itemModel.GetUnitCost(txtItemID.Text.ToInt32_2());
                lblCost.Text = cost.ToString(AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE,
                    CultureInfo.CurrentCulture);
            }
        }

        private ActivityDate CreateActivityDateDTO(int itemID)
        {
            var activityDateDTO = new ActivityDate();
            activityDateDTO.ItemID = itemID;
            activityDateDTO.ParentInstanceID = Int32.Parse(Request.QueryString[&quot;ParentID&quot;], CultureInfo.CurrentCulture);
            activityDateDTO.ModuleID = Request[&quot;Context&quot;].Trim();
            activityDateDTO.StartDate = dtStartDate.Value.ToDateTime_MWCulture().Date.ToUtc();
            activityDateDTO.EndDate = dtEndDate.Value.ToDateTime_MWCulture().Date.ToUtc();
            if (dtActualStartDate.Value != null)
                activityDateDTO.ActualStartDate = dtActualStartDate.Value.ToDateTime_MWCulture().Date.ToUtc();
            if (dtActualEndDate.Value != null)
                activityDateDTO.ActualEndDate = dtActualEndDate.Value.ToDateTime_MWCulture().Date.ToUtc();
            var duration = wneDuration.ValueDecimal * _calendar.Hours.TotalHours.ToDecimal2();
            activityDateDTO.EffortTicks = new TimeSpan(Convert.ToInt32(Math.Floor(duration)),
                                                        Convert.ToInt32((duration - Math.Truncate(duration)) * 60 - 1), 0);
            activityDateDTO.ProgressPercent = wnePerComplete.Value.ToInt32_2();
            if (chkComplete.Checked &amp;&amp; itemModel.IsWBS)
                activityDateDTO.ProgressPercent = 100;


            return activityDateDTO;

        }

        private Item CreateItemDTOFromHttpRequest()
        {
            string context = Request[&quot;Context&quot;].Trim();
            string quantity = &quot;0&quot;;
            var DTO = new Item();

            if (string.IsNullOrEmpty(txtItemID.Text))
                DTO.ItemID = null;
            else
                DTO.ItemID = int.Parse(txtItemID.Text.Trim(), CultureInfo.CurrentCulture);

            DTO.AccountingCode = txtAccountingCode.Text.Trim();
            DTO.CreatedBy = UserDetail.GetCurrentUserDetail().UID;
            DTO.Description = txtItemDesc.Text.Trim();
            DTO.IsComplete = itemModel.DisplayComplete &amp; chkComplete.Checked;
            if (itemModel.DisplayNonContractItem)
                DTO.IsNonContract = chkNC.Checked;
            DTO.Notes = txtNotes.Text.Trim();
            DTO.ParentInstanceID = Int32.Parse(Request.QueryString[&quot;ParentID&quot;], CultureInfo.CurrentCulture);
            DTO.ModuleID = context;
            if (wneQuantity != null &amp;&amp; wneQuantity.Value != null &amp;&amp; wneQuantity.Value.ToString2().ToLower() != &quot;nan&quot;)
            {
                quantity = wneQuantity.Value.ToString2();
            }
            DTO.Quantity = hdnQtyText.Value != &quot;0&quot; ? ((Convert.ToDecimal(hdnQtyText.Value) == Convert.ToDecimal(wneQuantity.Text)) ? decimal.Parse(hdnQtyValue.Value) : Decimal.Parse(quantity, CultureInfo.CurrentCulture)) : (Decimal.Parse(quantity, CultureInfo.CurrentCulture));
            DTO.UnitID = Int32.Parse(ddlUnit.SelectedValue, CultureInfo.CurrentCulture);
            DTO.Unit = ddlUnit.SelectedItem.Text;
            if (ddlGroups.Items.Count &gt; 0 &amp;&amp; !string.IsNullOrEmpty(ddlGroups.SelectedValue))
            {
                DTO.GroupID = Convert.ToInt32(ddlGroups.SelectedValue, CultureInfo.CurrentCulture);
                DTO.GroupName = ddlGroups.SelectedItem.Text;
            }
            else
            {
                DTO.GroupName = string.Empty;
            }

            if (itemModel.DisplayMustBid)
            {
                DTO.AlternateID = Int32.Parse(ddlAlternates.SelectedValue, CultureInfo.CurrentCulture);
                DTO.IsMustBid = chkMustBid.Checked;
                if (hdnReferenceItemID.Value.Length &gt; 0)
                    DTO.ReferenceItemID = Convert.ToInt32(hdnReferenceItemID.Value, CultureInfo.CurrentCulture);
                if (DTO.ModuleID == &quot;ESTMADD&quot;)
                    DTO.ParentID = itemModel.ParentModuleInstanceID;
            }

            DTO.Margin = chkNC.Checked ? 0 : wneMarginPercentage.ValueDecimal;
            DTO.Discount = chkNC.Checked ? 0 : wneDiscountPercentage.ValueDecimal;
            DTO.BaseUnitCost = wneUnitCost.ValueDecimal;
            DTO.OverheadCost = wneOverheadCost.ValueDecimal;
            DTO.UnitCost = wneUnitCostFinal.ValueDecimal;
            DTO.UnitPrice = wneUnitPrice.ValueDecimal;
            DTO.StandardItemNo = ucItemPicker.Text.Trim();
            if (itemModel.DisplayContainer)
                DTO.ContainerID = (ddlContainer.Items.Count &gt; 0)
                    ? Int32.Parse(ddlContainer.SelectedValue, CultureInfo.CurrentCulture)
                    : 0;
            else if (itemModel.DisplayContainerSelector &amp;&amp; txtItemPath.Text != string.Empty)
            {
                DTO.ContainerID = Convert.ToInt32(hdnContainerID.Value);
            }
            else
            {
                if (currentMode == ModeTypes.Edit &amp;&amp; hdnContainerID.Value != null)
                {
                    DTO.ContainerID = Convert.ToInt32(hdnContainerID.Value);
                }
                else
                {
                    DTO.ContainerID = Convert.ToInt32(Request.QueryString[&quot;ContainerID&quot;], CultureInfo.CurrentCulture);
                }
            }
            DTO.IsReWork = chkRW.Checked;
            if (ddlFundRule.Items.Count &gt; 0 &amp;&amp; !string.IsNullOrEmpty(ddlFundRule.SelectedValue) &amp;&amp;
                (ddlFundRule.SelectedValue) != &quot;Select&quot;)
            {
                DTO.RuleID = Convert.ToInt32(ddlFundRule.SelectedValue, CultureInfo.CurrentCulture);
            }

            DTO.LinkedBudgetItem = string.IsNullOrEmpty(hdnSelectedBudgetItem.Value) ? null : (int?)int.Parse(hdnSelectedBudgetItem.Value);

            if (WneWeightage.Value != null)
                DTO.Weightage = WneWeightage.ValueDecimal;

            if (ddlTaskPriority.SelectedValue != &quot;0&quot;)
                DTO.Priority = ddlTaskPriority.SelectedValue.ToInt32_2();
            else
                DTO.Priority = null;

            //TODO: Test this block
            itemModel.SetModuleItemData(DTO, hdnReferenceItemID, hdnReferenceItemType);

            DTO.LastUpdatedBy = UserDetail.GetCurrentUserDetail().UID;

            if (itemModel.DisplayProject)
            {
                if (ddlProject.Items.Count &gt; 0 &amp;&amp; !string.IsNullOrEmpty(ddlProject.SelectedValue))
                {
                    DTO.ProjectID = Convert.ToInt32(ddlProject.SelectedValue, CultureInfo.CurrentCulture);
                    DTO.ProjectName = ddlProject.SelectedItem.Text;
                }
                else
                {
                    DTO.ProjectName = string.Empty;
                }
            }

            // Capture Inflation data if module component is enabled
            if (itemModel.EnableInflation)
            {
                DTO.InflationRuleID = Convert.ToInt32(inflationRuleID.Value, CultureInfo.CurrentCulture);
                DTO.AnnualInflationRate = wneAnnualInflationRate.ValueDecimal;
                DTO.InflationEffectiveFrom = string.IsNullOrEmpty(Convert.ToString(wdcInflationEffectiveFrom.Value))
                                           ? (DateTime?)null
                                           : wdcInflationEffectiveFrom.Value.ToDateTime_MWCulture().Date.ToUtc();
            }
            //CreatedOn was saving date which was causing overflow exception
            DTO.CreatedOn = MWDateTimeHelper.MWToday.ToUtc();

            DTO.AmountForResource = ucRateAnalysis != null ? ucRateAnalysis.TotalResourceAmount : 0;
            DTO.TotalItemEstimate = (DTO.Quantity * DTO.UnitPrice) + DTO.AmountForResource;

            return DTO;
        }

        private void BindHTTPFromActivityDetailsDTO(ActivityDate aDTO)
        {
            dtStartDate.Value = aDTO.StartDate.ToMWDateTime();
            dtEndDate.Value = aDTO.EndDate.ToMWDateTime();
            wnePerComplete.Value = aDTO.ProgressPercent;
            wneDuration.ValueDecimal = (aDTO.EffortTicks.TotalHours / _calendar.Hours.TotalHours).ToDecimal2();
            if (aDTO.ActualStartDate != null)
                dtActualStartDate.Value = aDTO.ActualStartDate.ToMWDateTime();
            if (aDTO.ActualEndDate != null)
                dtActualEndDate.Value = aDTO.ActualEndDate.ToMWDateTime();
        }

        private void BindHTTPFromDTO(Item itemDTO)
        {
            txtAccountingCode.Text = itemDTO.AccountingCode;
            txtItemDesc.Text = itemDTO.Description;
            chkComplete.Checked = false;
            if (itemDTO.IsComplete != null)
            {
                chkComplete.Checked = itemDTO.IsComplete.Value;
            }
            chkNC.Checked = false;
            if (itemDTO.IsNonContract != null)
            {
                chkNC.Checked = itemDTO.IsNonContract.Value;
            }
            chkRW.Checked = false;
            if (itemDTO.IsReWork != null)
            {
                chkRW.Checked = itemDTO.IsReWork.Value;
            }
            txtNotes.Text = itemDTO.Notes;
            wneQuantity.Value = itemDTO.Quantity;
            hdnQtyValue.Value = wneQuantity.Value.ToString2();
            hdnQtyText.Value = wneQuantity.Text.ToString2();

            if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            {
                ddlUnit.SelectedItem.Text = itemDTO.Unit;
            }
            else
            {
                ddlUnit.SelectedValue = itemDTO.UnitID.ToString2();
            }

            ddlGroups.SelectedValue = itemDTO.GroupID.ToString2();

            txtBudgetItem.Text = itemDTO.LinkedBudgetItemName.ToString2();
            hdnSelectedBudgetItem.Value = itemDTO.LinkedBudgetItem.HasValue ? itemDTO.LinkedBudgetItem.Value.ToString2() : string.Empty;

            ddlFundRule.SelectedValue = itemDTO.RuleID.ToString2();

            if (ViewState[&quot;GroupDetails&quot;] != null)
            {
                var dtGroupDetails = (DataTable)ViewState[&quot;GroupDetails&quot;];

                DataRow[] dr = dtGroupDetails.Select(&quot;GroupID=&quot; + itemDTO.GroupID.ToString2());
                if (dr != null &amp;&amp; dr.Length &gt; 0)
                {
                    hdnDiscount.Value = dr[0][&quot;Discount&quot;].ToString2();
                    hdnUPIncrease.Value = dr[0][&quot;OTPPercentage&quot;].ToString2();
                }
            }

            wneUnitCost.Value = itemDTO.BaseUnitCost.GetValueOrDefault(0M);
            wneOverheadCost.Value = itemDTO.OverheadCost.GetValueOrDefault(0M);
            //wneUnitCostFinal.Value = itemDTO.UnitCost.GetValueOrDefault(0M);
            if (!(ModuleComponents.Contains(&quot;ItemMargin&quot;) &amp;&amp; ModuleComponents.Contains(&quot;ItemDiscount&quot;)))
            {
                wneUnitPrice.Value = itemDTO.BaseUnitCost.GetValueOrDefault(0M);
            }
            else
                wneUnitPrice.Value = itemDTO.UnitPrice;

            decimal baseUnitCostWithOverhead = itemDTO.BaseUnitCost.GetValueOrDefault(0M) +
                                               itemDTO.OverheadCost.GetValueOrDefault(0M);
            wneUnitCostFinal.Value = baseUnitCostWithOverhead;
            wneMarginPercentage.Value = itemDTO.Margin.GetValueOrDefault(0M);
            wceMargin.Value = baseUnitCostWithOverhead * itemDTO.Margin.GetValueOrDefault(0M) * 0.01M;

            decimal costWithMargin = baseUnitCostWithOverhead + wceMargin.ValueDecimal;
            wneDiscountPercentage.Value = itemDTO.Discount;
            wceDiscount.Value = costWithMargin * itemDTO.Discount.GetValueOrDefault(0M) * 0.01M;

            wneAmount.Value = itemModel.IsAmountFromUnitCost
                ? (itemDTO.Quantity * itemDTO.UnitCost.ToDecimal2())
                : (itemDTO.Quantity * itemDTO.UnitPrice);
            ucItemPicker.Text = itemDTO.StandardItemNo;
            txtStandardItemNo.Text = itemDTO.StandardItemNo;
            if (itemDTO.IsMustBid.HasValue)
                chkMustBid.Checked = Convert.ToBoolean(itemDTO.IsMustBid, CultureInfo.CurrentCulture);
            if (itemDTO.AlternateID.HasValue)
                ddlAlternates.SelectedValue = itemDTO.AlternateID.ToString2();
            if (itemModel.DisplayActivity)
                txtActivities.Text = itemDTO.ActivityCount.ToString2();
            if (itemDTO.ContainerID.HasValue)
            {
                hdnContainerID.Value =
                    ddlContainer.SelectedValue = itemDTO.ContainerID.ToString2();
            }
            if (itemDTO.ReferenceItemID.HasValue)
                hdnReferenceItemID.Value = itemDTO.ReferenceItemID.ToString2();
            hdnReferenceItemType.Value = itemDTO.ReferenceItemType;
            txtItemPath.Text = itemDTO.Path;

            if ((itemDTO.ModuleID == &quot;CHNGORD&quot;) &amp;&amp; (itemDTO.ReferenceItemType == &quot;M&quot;) &amp;&amp; (!string.IsNullOrEmpty(itemDTO.LinkedBudgetItem.ToString())))
            {
                btnShowItemPicker.Enabled = false;
                btnClearBudgetItem.Enabled = false;
                btnClearBudgetItem.OnClientClick = null;
            }
            if (itemDTO.Priority.HasValue)
                ddlTaskPriority.SelectedValue = itemDTO.Priority.ToString2();

            if (itemDTO.Weightage.HasValue)
                WneWeightage.Value = itemDTO.Weightage.Value;

            if (itemModel.DisplayProject)
            {
                ddlProject.SelectedValue = itemDTO.ProjectID.ToString2();
            }

            // Bind Inflation fields if applicable
            BindInflationFields(itemDTO, currentMode);
        }

        private void BindInflationFields(Item item, ModeTypes mode)
        {
            if (itemModel.EnableInflation)
            {
                switch (mode)
                {
                    case ModeTypes.New:
                        inflationRuleID.Value = string.Empty;
                        wneAnnualInflationRate.Value = 0;
                        wdcInflationEffectiveFrom.Value = null;
                        break;

                    case ModeTypes.View:
                    case ModeTypes.Edit:
                        inflationRuleID.Value = item.InflationRuleID.ToString2();
                        wneAnnualInflationRate.Value = item.AnnualInflationRate;

                        wdcInflationEffectiveFrom.Value = item.InflationEffectiveFrom?.ToMWDateTime(); // ?. avoids the method call if object is NULL

                        Tuple&lt;int, string&gt; libraryNewInflationRuleDetails = itemModel.GetLIBRARYNewInflationRuleDetails(mode, item.InflationRuleID);

                        var id = libraryNewInflationRuleDetails.Item1;
                        var name = libraryNewInflationRuleDetails.Item2;

                        if (item.InflationRuleID == null)
                            item.InflationRuleID = id; // in this case, id contains the RuleID for Inflation = &#39;None&#39; from database

                        inflationRuleID.Value = id.ToString();
                        txtInflationRule.Text = name;

                        rfvAnnualInflationRate.Enabled =
                            revAnnualInflationRate.Enabled =
                               rfvInflationEffectiveFrom.Enabled =
                                    wneAnnualInflationRate.Enabled = (name == &quot;Manual&quot;);

                        if (name == &quot;None&quot;)
                            wdcInflationEffectiveFrom.Enabled = false;
                        else
                            wdcInflationEffectiveFrom.Enabled = true;

                        break;
                }
            }
        }

        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        public override bool CheckAccess()
        {
            var strPermList = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];
            if (!String.IsNullOrEmpty(Request[&quot;ParentID&quot;]))
            {
                if (!strPermList.Contains(&quot;View&quot;))
                {
                    return false;
                }
            }

            return true;
        }

        public override void OnAccessDeniedRedirect()
        {
            UIHelper.RedirectURL(
                       &quot;The current role does not have the required permissions to view this page.&quot;,
                       ResolveUrl((IsProposedProject)
                           ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                           : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;), null, Context);
        }
        private void SetCalendarDetails()
        {
            CalendarCalculationsModel ccm = CalendarCalculationsModel.GetInstance(&quot;WBSTRUC&quot;);
            CalendarDetails cd = ccm.GetCalendarDetails(int.Parse(Request.QueryString[&quot;PID&quot;]));

            StringBuilder sbExceptionWorkingDay = new StringBuilder();
            foreach (DateTime ewd in cd.ExceptionalWorkingDays)
            {
                sbExceptionWorkingDay.Append(ewd.Date.ToShortDateString());
                sbExceptionWorkingDay.Append(&quot;;&quot;);
            }
            hdnExceptionWorkingDay.Value = sbExceptionWorkingDay.ToString();

            StringBuilder sbHoliday = new StringBuilder();
            foreach (DateTime holiday in cd.Holidays)
            {
                sbHoliday.Append(holiday.Date.ToShortDateString());
                sbHoliday.Append(&quot;;&quot;);
            }
            hdnHolidays.Value = sbHoliday.ToString();

            StringBuilder sbWorkingDays = new StringBuilder();
            foreach (DayOfWeek wd in cd.WorkingDays)
            {
                sbWorkingDays.Append((int)Enum.Parse(typeof(DayOfWeek), wd.ToString()));
                sbWorkingDays.Append(&quot;;&quot;);
            }

            hdnWorkingDays.Value = sbWorkingDays.ToString();
            hdnCalendarDetailsJSON.Value = JsonConvert.SerializeObject(cd, Formatting.None);
        }

        protected void Page_Load(object sender, EventArgs e)
        {

            RegisterCallBackScript();

            if (Request[&quot;Context&quot;] == &quot;WBSTRUC&quot;)
            {
                SetCalendarDetails();
                dtStartDate.ClientSideEvents.CalendarRenderDay = &quot;renderWorkingDays&quot;;
                dtStartDate.ClientSideEvents.CalendarValueChanging = &quot;validateDateSelected&quot;;
                dtEndDate.ClientSideEvents.CalendarRenderDay = &quot;renderWorkingDays&quot;;
                dtEndDate.ClientSideEvents.CalendarValueChanging = &quot;validateDateSelected&quot;;
                dtActualStartDate.ClientSideEvents.CalendarRenderDay = &quot;renderWorkingDays&quot;;
                dtActualStartDate.ClientSideEvents.CalendarValueChanging = &quot;validateDateSelected&quot;;
                dtActualEndDate.ClientSideEvents.CalendarRenderDay = &quot;renderWorkingDays&quot;;
                dtActualEndDate.ClientSideEvents.CalendarValueChanging = &quot;validateDateSelected&quot;;
                dtStartDate.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                dtEndDate.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                dtActualStartDate.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                dtActualEndDate.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
            }

            if (itemModel.DisableRoleSelection)
                UIHelper.DisableRoleSelection(Page);
            else
                UIHelper.EnableRoleSelection(Page);

            // Hides or shows the controls based on the module.
            ShowHideControls();
            ApplyFormattoWne(wneAmount, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
            ApplyFormattoWne(wneUnitCostFinal, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE);
            ApplyFormattoWne(wneUnitCost, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE);
            ApplyFormattoWne(wneOverheadCost, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE);
            ApplyFormattoWne(wneUnitPrice, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE);
            ApplyFormattoWne(wneQuantity, AMP3ApplicationSettings.Instance.FORMAT_QUANTITY);

            ApplyFormattoWne(wneAnnualInflationRate, AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE);

            string modeType_Str = Request[&quot;mode&quot;];
            if (string.IsNullOrEmpty(modeType_Str))
                modeType_Str = &quot;New&quot;;
            ModeTypes modeType_Enum = (ModeTypes)Enum.Parse(typeof(ModeTypes), modeType_Str);

            if (modeType_Enum.HasFlag(ModeTypes.Edit))
                currentMode = ModeTypes.Edit;
            else if (modeType_Enum.HasFlag(ModeTypes.View))
                currentMode = ModeTypes.View;

            if (!IsPostBack)
            {
                string errDocuSign = string.Empty;
                if (Session[&quot;DocuSignErr&quot;] != null)
                    errDocuSign = Session[&quot;DocuSignErr&quot;].ToString();

                if (!string.IsNullOrEmpty(errDocuSign))
                {
                    ShowError(errDocuSign);
                    Session.Remove(&quot;DocuSignErr&quot;);
                }

                ucItemPicker.MandatoryMarkRequired = true; //For showing mandatory mark(*) next to pay item number   
                List&lt;string&gt; estimateComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_ESTMATE);
                if (estimateComponents != null &amp;&amp; estimateComponents.Contains(&quot;IgnoreContainersStdItemUncheck&quot;))
                {
                    ucItemPicker.FilterIgnoreContainerChecked = false;
                }
                else
                {
                    ucItemPicker.FilterIgnoreContainerChecked = true;
                }
                string ReferenceItemType = string.Empty;

                hdnSelItemContainerID.Value = String.Empty;

                if (!itemModel.IsCalculateUnitPriceFromUnitCost)
                    hdnCalculatePriceFromCost.Value = &quot;N&quot;;
                else
                    hdnCalculatePriceFromCost.Value = &quot;Y&quot;;

                if (itemModel.IsAmountFromUnitCost)
                    hdnIsAmountFromUnitCost.Value = &quot;1&quot;;

                if (!string.IsNullOrEmpty(Request.QueryString[&quot;COType&quot;]))
                {
                    ReferenceItemType = Request.QueryString[&quot;COType&quot;];
                }

                if ((ReferenceItemType == &quot;C&quot; || ReferenceItemType == &quot;M&quot; || ReferenceItemType == &quot;D&quot;)
                    &amp;&amp; currentMode == ModeTypes.New)
                {
                    ucItemPicker.ModuleID = Request.QueryString[&quot;context&quot;];
                    ucItemPicker.ParentInstanceID = Convert.ToInt32(Request.QueryString[&quot;ParentID&quot;],
                        CultureInfo.CurrentCulture);
                    ucItemPicker.ReferenceItemType = Request.QueryString[&quot;COType&quot;].ToString2();
                    //ShowDiv(ItemDivEnums.ItemPicker);
                }
                BindModuleData();
                MainToolBar.ShowMenu(&quot;lnkSaveContinue&quot;);
                if (currentMode == ModeTypes.Edit)
                {
                    SetMode(ModeTypes.Edit);
                    btnSaveCont.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                    ReadOnly = false;
                    if (MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;) != null)
                        MainToolBar.HideMenu(&quot;lnkSaveContinue&quot;);
                }
                else if (currentMode == ModeTypes.View)
                {
                    SetMode(ModeTypes.View);
                    ReadOnly = true;
                    ucItemPicker.TextOnly = true;

                    divItemPicker.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    txtNotes.Style.Add(&quot;width&quot;, &quot;505px&quot;);
                    RequiredFieldValidator2.Enabled = false;
                    if (ddlAlternates != null) ddlAlternates.Enabled = false;
                }
                else
                {
                    if (!string.IsNullOrEmpty(Request[&quot;ContainerID&quot;]) &amp;&amp; !itemModel.DisplayContainer &amp;&amp;
                        Convert.ToInt32(Request[&quot;ContainerID&quot;]) != 0)
                    {
                        hdnContainerID.Value = Request[&quot;ContainerID&quot;];
                        container.DataBind(hdnContainerID.Value);
                        txtItemPath.Text = container.SelectedNodePath;
                        if (container.SelectedNode != null)
                            hdnContainerID.Value = container.SelectedNode.Value;
                    }
                    SetMode(currentMode);
                    ReadOnly = false;
                }

                PageTitle = currentMode.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;

                if (itemModel.DisplayActivity
                    &amp;&amp; currentMode == ModeTypes.New)
                    txtActivities.Text = &quot;0&quot;;
                if (!string.IsNullOrEmpty(Request[&quot;ItemID&quot;]) &amp;&amp; hdnSave.Value != &quot;true&quot;)
                {
                    int parentId, itemId;
                    int.TryParse(Request[&quot;ParentID&quot;].ToString2(), out parentId);
                    if (int.TryParse(Request[&quot;ItemID&quot;], out itemId))
                    {
                        if (string.IsNullOrEmpty(itemId.ToString()) &amp;&amp; Session[&quot;UnitPriceSearchDetails&quot;] != null)
                        {
                            Hashtable htItemDetail = new Hashtable();
                            htItemDetail = (Hashtable)Session[&quot;UnitPriceSearchDetails&quot;];
                            txtItemID.Text = htItemDetail[&quot;ItemIDValue&quot;].ToString();
                        }
                        else
                            txtItemID.Text = itemId.ToString2();

                        Item itemDTO = itemModel.GetItemDetails(itemId);

                        if (currentMode == ModeTypes.Edit)
                        {
                            ReadOnly = itemModel.IsReadOnly;

                            if (itemModel.IsEditOnlyQuantity)
                                EditOnlyQuantity();
                            if (itemModel.EnableBaseCost)
                                wneUnitCost.ReadOnly = false;
                        }
                        BindHTTPFromDTO(itemDTO);

                        if (itemModel.IsWBS)
                        {
                            ActivityDate activityDateDTO = itemModel.GetItemActivityDetails(itemId);
                            BindHTTPFromActivityDetailsDTO(activityDateDTO);
                        }
                    }

                    if (!string.IsNullOrEmpty(Request[&quot;DisplayType&quot;]))
                    {
                        if (Request[&quot;DisplayType&quot;].Equals(&quot;SI&quot;))
                        {
                            ShowDiv(ItemDivEnums.SubItems);
                            itemModel.LoadSubItemDetails(itemId);
                            PageTitle = &quot;Sub Items&quot;;
                        }
                        else if (Request[&quot;DisplayType&quot;].Equals(&quot;RA&quot;))
                        {
                            ucRateAnalysis.LoadItem(Request[&quot;Context&quot;], parentId, itemId);
                            PageTitle = &quot;Rate Analysis&quot;;
                            ShowDiv(ItemDivEnums.RateAnalysis);
                        }
                        else
                        {
                            itemModel.LoadActivityDetails(itemId);
                            PageTitle = &quot;Activities&quot;;
                            ShowDiv(ItemDivEnums.ItemActivity);
                        }
                    }
                    ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                }
                if (itemModel.IsWBS)
                {
                    ddlUnit.SelectedIndex = 1;
                    wneQuantity.Value = 1;
                }
                GetItemCost();
                GetSubItemQuantity();
                GetComponentCount(
                    string.IsNullOrEmpty(txtItemID.Text) ? 0 : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture),
                    Request[&quot;Context&quot;].Trim(), Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture));
                GetActivityCount(context, int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                    string.IsNullOrEmpty(txtItemID.Text)
                        ? 0
                        : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture));
                tdDesc.InnerText = &quot;&quot; + LocalizationManager.GetString(&quot;ItemDescription&quot;) + &quot; :&quot;;
                tdNotes.InnerText = &quot;&quot; + LocalizationManager.GetString(&quot;ItemNotes&quot;) + &quot; :&quot;;
                //Initialize attachments control -- copied from brixform page
                itemAttachments.InstanceID = txtItemID.Text;
                itemAttachments.SrcType = &quot;ITM&quot; + context;
                itemAttachments.ReadOnly = (currentMode == ModeTypes.View);

                List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                if (!(ModuleComponents.Contains(&quot;ItemMargin&quot;) &amp;&amp; ModuleComponents.Contains(&quot;ItemDiscount&quot;)))
                {
                    lblUnitCost.Text = &quot;Unit Price :&quot;;
                }
                if (Request[&quot;UnitPriceSearch&quot;] != null &amp;&amp; Request[&quot;Context&quot;] != null &amp;&amp; Request[&quot;Context&quot;] == &quot;ESTMATE&quot;)
                {
                    AssignItemDetailsUnitPriceSearch();
                }
                if (Request[&quot;Context&quot;] != null &amp;&amp; Request[&quot;Context&quot;] != &quot;LIBRARY&quot; &amp;&amp;
                    ModuleComponents.Contains(&quot;DisabledStandardItemEdit&quot;))
                {
                    ucItemPicker.PickerText.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
                    txtItemDesc.ReadOnly = true;
                    txtStandardItemNo.ReadOnly = true;
                }
            }

            itemModel.OnPageLoad(itemModel);

            if (!string.IsNullOrEmpty(Request[&quot;ContainerID&quot;]) &amp;&amp; !itemModel.DisplayContainer &amp;&amp;
                        Convert.ToInt32(Request[&quot;ContainerID&quot;]) != 0)
            {
                _selectedContainerID = Request[&quot;ContainerID&quot;].ToInt32_2();
                if (IsPostBack &amp;&amp; container.Visible) //Data-bind if the container is visible
                    container.DataBind(_selectedContainerID.ToString());
                _selectedContainerPath = container.SelectedNodePath;
            }

            if (chkNC != null &amp;&amp; chkNC.Checked)
            {
                itemModel.DisplayAmount =
                    itemModel.DisplayDiscount =
                        itemModel.DisplayMargin = false;
                trMargin.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayMargin ? &quot;table-row&quot; : &quot;none&quot;);
                trDiscount.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayDiscount ? &quot;table-row&quot; : &quot;none&quot;);
                //If its not cost revision, then Amount should be displayed. (Unit Price * Quantity)
                if (!context.Equals(&quot;COSTVER&quot;, StringComparison.CurrentCultureIgnoreCase))
                    trAmount.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayAmount ? &quot;table-row&quot; : &quot;none&quot;);
                trProjectedUnitPrice.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            }

            //btnOk.Attributes.Add(&quot;onclick&quot;, &quot;if(!ConfirmSaveItem(&#39;I&#39;)) return false;&quot;);
            //btnSaveCont.Attributes.Add(&quot;onclick&quot;, &quot;if(!ConfirmSaveItem(&#39;I&#39;)) return false;&quot;);
            if (DivComponents.Visible != false)
            {
                PageTitle = &quot;Components&quot;;
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            }

            if ((context.Equals(&quot;CHNGORD&quot;, StringComparison.CurrentCultureIgnoreCase) ||
                 context.Equals(&quot;BDGTREV&quot;, StringComparison.CurrentCultureIgnoreCase))
                &amp;&amp; (Request.QueryString[&quot;COType&quot;] == &quot;M&quot; || Request.QueryString[&quot;COType&quot;] == &quot;D&quot;))
            {
                if (string.IsNullOrEmpty(ucItemPicker.Text))
                    likSubItems.Disabled = true;
            }

            //Hide the links if the components doesnt exists
            // Note that there is already a fucntion ShowHide on top of this code and we are overriding those settings here.

            ShowHideModuleComponents();

            if (string.IsNullOrEmpty(ViewState[&quot;PageTitleValue&quot;].ToString2()))
            {
                if (string.IsNullOrEmpty(Request.QueryString[&quot;mode&quot;]))
                    PageTitle = ModeTypes.New.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
                else if ((Request.QueryString[&quot;mode&quot;].Equals(ModeTypes.View.ToString2()))
                         ||
                         (Request.QueryString[&quot;mode&quot;].Equals(
                             Convert.ToInt32(ModeTypes.View, CultureInfo.CurrentCulture).ToString2())))
                    PageTitle = ModeTypes.View.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
                else
                    PageTitle = ModeTypes.Edit.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);

                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            }
            else
            {
                PageTitle = ViewState[&quot;PageTitleValue&quot;].ToString2();
            }

            SetControlLables();

            // set the page unique context for breadcrum from the list model
            if (!string.IsNullOrEmpty(itemModel.PageUniqueID))
                base.PageUniqueID = itemModel.PageUniqueID;

            lblItemGroup.Text = LocalizationManager.GetString(&quot;Group&quot;);

            if (!String.IsNullOrEmpty(context) &amp;&amp;
                context.Equals(&quot;BDGTEMP&quot;, StringComparison.CurrentCultureIgnoreCase))
            {
                trComplete.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            }

            if (Request.QueryString[&quot;COType&quot;] != null &amp;&amp; Request.QueryString[&quot;COType&quot;].ToString() == &quot;D&quot;) { likSubItems.Disabled = true; likSubItems.Visible = false; }

            // Set readonly/disabled on Inflation fields
            if (itemModel.EnableInflation)
            {

                wneAnnualInflationRate.Enabled = (currentMode != ModeTypes.View &amp;&amp; txtInflationRule.Text.ToString2() == &quot;Manual&quot;);

                if (txtInflationRule.Text.ToString2() == &quot;None&quot;)
                    wdcInflationEffectiveFrom.Enabled = false;
                else
                    wdcInflationEffectiveFrom.Enabled = true;

                pickerInflationItem.Visible = (currentMode != ModeTypes.View);

                Tuple&lt;DateTime, DateTime&gt; planningProgramCycleStartAndEndDates = itemModel.GetPlanningProgramCycleStartAndEndDates();
                var startDate = planningProgramCycleStartAndEndDates.Item1;
                var endDate = planningProgramCycleStartAndEndDates.Item2;

                wdcInflationEffectiveFrom.MinDate = startDate;
                wdcInflationEffectiveFrom.MaxDate = endDate;

                if (currentMode == ModeTypes.New &amp;&amp; inflationRuleID.Value == string.Empty &amp;&amp; txtInflationRule.Text == string.Empty)
                {
                    Tuple&lt;int, string&gt; libraryNewInflationRuleDetails = itemModel.GetLIBRARYNewInflationRuleDetails(ModeTypes.New, null);
                    var id = libraryNewInflationRuleDetails.Item1;
                    var name = libraryNewInflationRuleDetails.Item2;
                    inflationRuleID.Value = id.ToString();
                    txtInflationRule.Text = name;
                    wdcInflationEffectiveFrom.Enabled = false;
                }
            }
        }

        void AssignItemDetailsUnitPriceSearch()
        {
            Hashtable htItemDetail = new Hashtable();
            htItemDetail = (Hashtable)Session[&quot;UnitPriceSearchDetails&quot;];
            if (Request[&quot;WeightedAverage&quot;] != null &amp;&amp; Request[&quot;WeightedAverage&quot;] != &quot;&quot;)
                wneUnitCost.Text = Request[&quot;WeightedAverage&quot;].ToString();
            //If Margin and Discount are not included in Build and Mode is View or Edit
            else if (Request[&quot;UnitPriceSearch&quot;] != null)
                wneUnitCost.Text = htItemDetail[&quot;ItemUnitPrice&quot;].ToString();
            //If Margin and Discount are not included in Build and Mode is New

            //Overhead cost is not been sent from unit price search page, hence assigning the unitcost to unitcostfinal.
            wneUnitCostFinal.ValueDecimal = wneUnitCost.ValueDecimal;

            txtItemPath.Text = htItemDetail[&quot;Container&quot;].ToString();
            ucItemPicker.Text = htItemDetail[&quot;PayItemNo&quot;].ToString();
            txtStandardItemNo.Text = htItemDetail[&quot;PayItemNo&quot;].ToString();
            txtItemDesc.Text = htItemDetail[&quot;ItemDesc&quot;].ToString();
            txtAccountingCode.Text = htItemDetail[&quot;AccNode&quot;].ToString();
            lnkComponents.InnerText = htItemDetail[&quot;ComponentCount&quot;].ToString();
            wneQuantity.Text = htItemDetail[&quot;ItemQuantity&quot;].ToString();
            chkMustBid.Checked = htItemDetail[&quot;FourceUnitPrice&quot;].ToBoolean2();
            //wneAmount.Text = htItemDetail[&quot;ItemAmount&quot;].ToString();
            txtNotes.Text = htItemDetail[&quot;ItemNotes&quot;].ToString();
            txtItemID.Text = htItemDetail[&quot;ItemIDValue&quot;].ToString();
            hdnContainerID.Value = htItemDetail[&quot;ContainerID&quot;].ToString();
            hdnStdItemID.Value = htItemDetail[&quot;StdItemID&quot;].ToString();
            hdnReferenceItemID.Value = htItemDetail[&quot;ReferenceItemID&quot;].ToString();
            hdnSelItemContainerID.Value = htItemDetail[&quot;SelItemContainerID&quot;].ToString();
            ListItem ddlUnitItem = ddlUnit.Items.FindByValue(htItemDetail[&quot;UnitSelectedValue&quot;].ToString2());
            if (ddlUnitItem != null)
            {
                ddlUnit.ClearSelection();
                ddlUnitItem.Selected = true;
            }
            ListItem ddlGroupsItem = ddlGroups.Items.FindByValue(htItemDetail[&quot;GroupSelectedValue&quot;].ToString2());
            if (ddlGroupsItem != null)
            {
                ddlGroups.ClearSelection();
                ddlGroupsItem.Selected = true;
            }
            ClientScript.RegisterStartupScript(GetType(), &quot;calculatefn&quot;, &quot;$(document).ready(function() {Calculate();});&quot;,
                true);
        }

        private void SetControlLables()
        {
            lblContainerName.Text = itemModel.ContainerLabel;
            lblStandardItemNo.Text = itemModel.StandardItemNoLabel;
            tdDesc.InnerText =
                lblDescription.Text = itemModel.ItemDescriptionLabel;
            lblAccountingCode.Text = itemModel.AccountingCodeLabel;
        }

        private void ShowHideModuleComponents()
        {
            List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            lnkActivities.Style.Add(HtmlTextWriterStyle.Display,
                ModuleComponents.Contains(&quot;Activities&quot;) ? &quot;table-row&quot; : &quot;none&quot;);
            trActivity.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;Activities&quot;) &amp;&amp; itemModel.DisplayActivity) ? &quot;table-row&quot; : &quot;none&quot;);
            lnkComponents.Style.Add(HtmlTextWriterStyle.Display,
                ModuleComponents.Contains(&quot;Components&quot;) ? &quot;table-row&quot; : &quot;none&quot;);
            likSubItems.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;SubItems&quot;) &amp;&amp; ModuleComponents.Contains(&quot;ONGFundMgmt&quot;))
                    ? &quot;table-row&quot;
                    : &quot;none&quot;);
            if (itemModel.DisplayOverheadCost) // if it is visible,component settings will override it 
                trOverheadCost.Style.Add(HtmlTextWriterStyle.Display,
                    (ModuleComponents.Contains(&quot;RateAnalysis&quot;) &amp;&amp; ModuleComponents.Contains(&quot;ItemOverheadCost&quot;))
                        ? &quot;table-row&quot;
                        : &quot;none&quot;);
            if (ModuleComponents.Contains(&quot;RateAnalysis&quot;))
                phRA.Visible = !itemModel.DisplayRateAnalysisSection;
            DivRateAnalysis.Visible = itemModel.DisplayRateAnalysisSection &amp;&amp; !ucSubItem.Visible; // When subitem div is shown, dont show rate analysis.
            //trComplete.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);//IsComplete checkbox not required for Item creation page 
            trComplete.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;ItemComplete&quot;) &amp;&amp; !(ModuleId == &quot;BDGTEST&quot; || ModuleId == &quot;BDGTREV&quot;))
                    ? &quot;table-row&quot;
                    : &quot;none&quot;); //IsComplete is only required for Pinellas
            trMargin.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;ItemMargin&quot;) &amp;&amp; itemModel.DisplayMargin) ? &quot;table-row&quot; : &quot;none&quot;);
            trDiscount.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;ItemDiscount&quot;) &amp;&amp; itemModel.DisplayDiscount) ? &quot;table-row&quot; : &quot;none&quot;);
            trUnitCost.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;ItemUnitCost&quot;) &amp;&amp; itemModel.DisplayUnitCost) ? &quot;table-row&quot; : &quot;none&quot;);
            bool bShowUnitPrice = (ModuleComponents.Contains(&quot;ItemUnitPrice&quot;) ||
                                   ((ModuleId == &quot;CHNGORD&quot; || ModuleId == &quot;BDGTREV&quot;) &amp;&amp;
                                    (Request.QueryString[&quot;COType&quot;] != &quot;N&quot;))) &amp;&amp; itemModel.DisplayProjectedUnitPrice;
            trProjectedUnitPrice.Style.Add(HtmlTextWriterStyle.Display, (bShowUnitPrice) ? &quot;table-row&quot; : &quot;none&quot;);
            trNonContractItem.Style.Add(HtmlTextWriterStyle.Display,
                (ModuleComponents.Contains(&quot;ItemNCItem&quot;) &amp;&amp; itemModel.DisplayNonContractItem) ? &quot;table-row&quot; : &quot;none&quot;);
            if (!string.IsNullOrEmpty(context) &amp;&amp; context == &quot;ESTMATE&quot;)
                //Compelte check box should not be available for Estiamte BOQ&#39;s
                trComplete.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
        }

        private void GetComponentCount(int ItemID, String ModuleID, int ParentInstanceID)
        {
            if (ItemID != 0)
            {
                txtComponents.Text =
                    ItemManager.Instance.GetComponentCount(ItemID, ModuleID, ParentInstanceID).ToString2();
            }
            else
            {
                txtComponents.Text = &quot;0&quot;;
            }
        }

        private void ApplyFormattoWne(WebNumericEdit wne, String format)
        {
            int DecimalLength = format.Length -
                                (format.LastIndexOf(&#39;.&#39;) == -1 ? format.Length - 1 : format.LastIndexOf(&#39;.&#39;)) - 1;

            wne.MinDecimalPlaces = (MinDecimalPlaces)(Enum.ToObject(typeof(MinDecimalPlaces), DecimalLength));
        }

        private void BindModuleData()
        {
            DataSet dsModuleData = itemModel.GetModuleData(Request.QueryString[&quot;Context&quot;],
                int.Parse(Request.QueryString[&quot;ParentID&quot;],
                    CultureInfo.CurrentCulture));
            itemActivities.MeasSysID =
                rateAnalysisDetail.MeasSysID =
                    Convert.ToInt32(dsModuleData.Tables[0].Rows[0][0], CultureInfo.CurrentCulture);
            if (itemModel.DisplayContainer)
            {
                UIHelper.BindDropDownData(ddlContainer, dsModuleData.Tables[1], &quot;ContainerName&quot;, &quot;ContainerID&quot;);
                if (!string.IsNullOrEmpty(Request[&quot;ContainerID&quot;]) &amp;&amp;
                    int.Parse(Request[&quot;ContainerID&quot;], CultureInfo.CurrentCulture) &gt; 0)
                {
                    if (ddlContainer.Items.FindByValue(Request[&quot;ContainerID&quot;]) != null)
                    {
                        ddlContainer.SelectedIndex = -1;
                        ddlContainer.Items.FindByValue(Request[&quot;ContainerID&quot;]).Selected = true;
                    }
                }
            }
            if (dsModuleData.Tables.Count &gt; 2)
            {
                UIHelper.BindDropDownData(ddlUnit, dsModuleData.Tables[2], &quot;Unit&quot;, &quot;UnitID&quot;);
                rateAnalysisDetail.BindUnits(dsModuleData.Tables[2], &quot;Unit&quot;, &quot;UnitID&quot;);
                if (itemModel.DisplayActivity)
                    itemActivities.BindUnits(dsModuleData.Tables[2], &quot;Unit&quot;, &quot;UnitID&quot;);
            }

            if (dsModuleData.Tables.Count &gt; 3)
                UIHelper.BindDropDownData(ddlGroups, dsModuleData.Tables[3], &quot;GroupName&quot;, &quot;GroupID&quot;);

            if (itemModel.DisplayAlternate &amp;&amp; dsModuleData.Tables.Count &gt; 4)
            {
                if (dsModuleData.Tables[4].Select(&quot;AlternateCode = &#39;Base Bid&#39;&quot;).Length &gt; 0)
                {
                    ddlAlternates.SelectedValue =
                        Convert.ToString(dsModuleData.Tables[4].Select(&quot;AlternateCode = &#39;Base Bid&#39;&quot;)[0][&quot;AlternateID&quot;]);
                }
                UIHelper.BindDropDownData(ddlAlternates, dsModuleData.Tables[4], &quot;AlternateCode&quot;, &quot;AlternateID&quot;);
            }

            if ((ViewState[&quot;HasErrors&quot;] == null ||
               (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2())) &amp;&amp; itemModel.DisplayRateAnalysisSection)
            {
                rateAnalysisDetail.LoadItem(Convert.ToInt32(txtItemID.Text.Trim() == &quot;&quot; ? &quot;0&quot; : txtItemID.Text.Trim(), CultureInfo.CurrentCulture));
            }


            DataRow dr = itemModel.DisplayAlternate ? dsModuleData.Tables[5].Rows[0] : dsModuleData.Tables[4].Rows[0];

            ViewState[&quot;GroupDetails&quot;] = dsModuleData.Tables[3];

            hdnUPIncrease.Value = hdnDiscount.Value = &quot;0&quot;;
            hdnUPIncrease.Value = dr[&quot;UPIncrease&quot;].ToString2();
            hdnDiscount.Value = dr[&quot;Discount&quot;].ToString2();

            string context = Request[&quot;Context&quot;];
            context = context.Equals(&quot;CHNGORD&quot;)
                ? &quot;CONTMGT&quot;
                : context.Equals(&quot;BDGTREV&quot;) ? &quot;BDGTEST&quot; : (context.Equals(&quot;ESTMADD&quot;) ? &quot;ESTMATE&quot; : context);

            List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_FNDMGMT);
            if (ModuleComponents != null &amp;&amp; ModuleComponents.Contains(&quot;FUND&quot; + context))
            {
                trFundRul.Visible = true;
                DataSet dsFundRule = itemModel.GetFundRule(int.Parse(Request.QueryString[&quot;PID&quot;]));
                if (dsFundRule.Tables.Count &gt; 0)
                {
                    UIHelper.BindDropDownData(ddlFundRule, dsFundRule.Tables[0], &quot;RuleName&quot;, &quot;ID&quot;);
                    DataRow[] rows = dsFundRule.Tables[0].Select(&quot;IsDefault=1&quot;);
                    var li = new ListItem(&quot;Select&quot;, &quot;0&quot;);
                    li.Selected = true;
                    ddlFundRule.Items.Insert(0, li);
                    if (rows.Length &gt; 0)
                    {
                        ddlFundRule.SelectedIndex = -1;
                        ddlFundRule.Items.FindByValue(rows[0][&quot;ID&quot;].ToString()).Selected = true;
                    }
                }
            }
            else
            {
                trFundRul.Visible = false;
            }

            if (itemModel.DisplayProject)
            {
                DataTable dsProjects = itemModel.GetProjects();
                UIHelper.BindDropDownData(ddlProject, dsProjects, &quot;ProjectName&quot;, &quot;ProjectID&quot;);
                var li = new ListItem(&quot;Select&quot;, &quot;0&quot;);
                li.Selected = true;
                ddlProject.Items.Insert(0, li);
            }


        }

        private bool ItemPicker_Init()
        {
            //No idea why bind is happenning here
            //container.DataBind(string.Empty);
            itemPicker.CustomizeGridColumns += new ItemPickerControl.CustomizeColumns(itemPicker_CustomizeGridColumns);
            itemPicker.DisplayOverheadCost = itemModel.DisplayOverheadCost &amp;&amp;
                                             (ModuleComponents.Contains(&quot;RateAnalysis&quot;) &amp;&amp;
                                              ModuleComponents.Contains(&quot;ItemOverheadCost&quot;));
            itemPicker.DisplayUnitCost = itemModel.DisplayUnitCost &amp;&amp; ModuleComponents.Contains(&quot;ItemUnitCost&quot;);
            itemPicker.Currency = Request[&quot;Context&quot;].Equals(&quot;ESTMADD&quot;)
                ? LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL)
                : LocalizationManager.GetModuleCurrency(&quot;LIBRARY&quot;, null, Session[&quot;AXCompany&quot;].ToString2());
            itemPicker.EnableMultipleSelect = false;
            return true;
        }

        private void InitializeIPItemPicker()
        {
            string json = &quot;{\&quot;DataSource\&quot; : \&quot;_table:vw_LIBRARYNewInflationRule\&quot;}&quot;;
            pickerInflationItem.InitializePicker(&quot;/api/InflationRulePicker/&quot;, GetWIPItemGridColumns(), &quot;ID&quot;);
            pickerInflationItem.TriggerButton.Text = &quot;...&quot;;
            pickerInflationItem.Title = &quot;Select Inflation Rule&quot;;
            pickerInflationItem.EnableMultiSelect = false;
            pickerInflationItem.PostBackAfterSelect = true;
            pickerInflationItem.OptionalParamaters = pickerInflationItem.BuildOptionalParameters(json);
            pickerInflationItem.OnItemSelected += new PickerGrid.SelectedItems(pickerInflationItem_OnItemSelected);
        }

        void pickerInflationItem_OnItemSelected(PickerGrid grid, List&lt;Dictionary&lt;string, object&gt;&gt; selectedRows)
        {

            if ((selectedRows.Count &gt; 0) &amp;&amp; (selectedRows[0].ContainsKey(&quot;ID&quot;)))
            {
                txtInflationRule.Text = selectedRows[0][&quot;Name&quot;].ToString();
                wneAnnualInflationRate.Enabled = (currentMode != ModeTypes.View &amp;&amp; txtInflationRule.Text.ToString2() == &quot;Manual&quot;);
                if (txtInflationRule.Text.ToString2() == &quot;None&quot;)
                    wdcInflationEffectiveFrom.Enabled = false;
                else
                    wdcInflationEffectiveFrom.Enabled = true;
                wneAnnualInflationRate.Value = selectedRows[0][&quot;Percent&quot;];
                wdcInflationEffectiveFrom.Value = string.IsNullOrEmpty(Convert.ToString(selectedRows[0][&quot;EffectiveFromDate&quot;])) ? string.Empty : Convert.ToString(selectedRows[0][&quot;EffectiveFromDate&quot;]);
                inflationRuleID.Value = selectedRows[0][&quot;ID&quot;].ToString2();
            }
        }

        private List&lt;PickerColumnDetails&gt; GetWIPItemGridColumns()
        {
            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Name&quot;,
                Caption = &quot;Name&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Percent&quot;,
                Caption = &quot;Percent&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;EffectiveFromDate&quot;,
                Caption = &quot;Effective From Date&quot;,
                Hidden = false,
                Type = &quot;string&quot;,
                Format = &quot;string&quot;
            });
            return gridColumns;
        }


        /// &lt;summary&gt;
        /// function used to delete the items from the items page
        /// currently its used to delete the items in the budget revision where a person can delete the items. and save
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void btnDeleteCont_ServerClick(object sender, EventArgs e)
        {
            Item ObjItemDetails = CreateItemDTOFromHttpRequest();

            int? deleteItemID = string.IsNullOrEmpty(hdnSelectedBudgetItemToDelete.Value) ? null : (int?)int.Parse(hdnSelectedBudgetItemToDelete.Value);
            if (Request[&quot;Context&quot;] != null &amp;&amp; Request[&quot;COType&quot;] != null &amp;&amp; Request[&quot;COType&quot;].Equals(&quot;D&quot;) &amp;&amp; Request[&quot;Context&quot;].ToString2() == &quot;BDGTREV&quot; &amp;&amp; deleteItemID != null)
            {

                if (itemModel.ValidateItemDelete(deleteItemID) == -1)
                {
                    AlertError(&quot;The selected object is linked to an item hence cannot be deleted.Request Denied.&quot;);
                    return;
                }
            }
            int itemID = ItemManager.Instance.SaveItemDetails(ObjItemDetails);
            itemModel.AfterDelete(itemModel);

            Response.Redirect(itemModel.ReturnUrl, false);
        }

        private void lnkSubItems_Click(object sender, EventArgs e)
        {
            validateSubitem = false;
            if (PreviousPage != null &amp;&amp; PreviousPage.IsCrossPagePostBack)
            {
                var temp = (HiddenField)sender;
                txtItemID.Text = temp.Value.Split(&#39;,&#39;)[1];
            }
            else if (hdnMode.Value.Equals(ModeTypes.New.ToString2()) || hdnMode.Value.Equals(ModeTypes.Edit.ToString2()))
                btnSaveCont_ServerClick(sender, e);

            if (!string.IsNullOrEmpty(txtItemID.Text.Trim()) &amp;&amp;
                (ViewState[&quot;HasErrors&quot;] == null ||
                 (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2())))
            {
                ShowDiv(ItemDivEnums.SubItems);
                PageTitle = &quot;Sub Items&quot;;
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                itemModel.LoadSubItemDetails(txtItemID.Text.Trim().ToInt32_2());
                ucSubItem.SetStdItemNoAndDescTemporarily(ucItemPicker.Text, txtItemDesc.Text);
            }
        }

        private void lnkRateAnalysis_Click(object sender, EventArgs e)
        {
            if (hdnMode.Value.Equals(ModeTypes.New.ToString2()) || hdnMode.Value.Equals(ModeTypes.Edit.ToString2()))
                btnSaveCont_ServerClick(sender, e);
            if (!string.IsNullOrEmpty(txtItemID.Text.Trim()) &amp;&amp;
                (ViewState[&quot;HasErrors&quot;] == null ||
                 (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2())))
            {
                ShowDiv(ItemDivEnums.RateAnalysis);

                PageTitle = &quot;Rate Analysis&quot;;
                ViewState[&quot;PageTitleValue&quot;] = PageTitle;

                rateAnalysisDetail.LoadItem(Convert.ToInt32(txtItemID.Text.Trim(), CultureInfo.CurrentCulture));
            }
        }

        private void lnkUnitPriceSearch_ServerClick(object sender, EventArgs e)
        {
            //Implemented Unit Price Search in Estimate Item Page
            if (ViewState[&quot;HasErrors&quot;] == null ||
                (ViewState[&quot;HasErrors&quot;] != null &amp;&amp; !ViewState[&quot;HasErrors&quot;].ToBoolean2()))
                if (!string.IsNullOrEmpty(context) &amp;&amp; context == &quot;ESTMATE&quot;)
                {
                    GetItemDetailsUnitPriceSearch();
                    string strReorderQS = string.Empty;
                    if (!string.IsNullOrEmpty(Request.QueryString[&quot;Reorder&quot;]) &amp;&amp; Request.QueryString[&quot;Reorder&quot;] == &quot;1&quot;)
                    {
                        strReorderQS = &quot;&amp;Reorder=1&amp;TargetID=&quot; + Request.QueryString[&quot;TargetID&quot;] + &quot;&amp;Action=&quot; +
                                       Request.QueryString[&quot;Action&quot;];
                    }
                    if (Request[&quot;ItemID&quot;] != null)
                        Response.Redirect(
                            string.Format(
                                &quot;~/Modules/ESTMATE/UnitPriceSearch.aspx?Type=Item&amp;Context=ESTMATE&amp;ParentID={0}&amp;PID={1}&amp;ContainerID={2}&amp;ItemID={3}&amp;Mode={4}&amp;PayItemNo={5}&amp;ItemDesc={6}{7}&amp;UnitPriceSearch=&quot;,
                                Request[&quot;ParentID&quot;], Request[&quot;PID&quot;], Request[&quot;ContainerID&quot;], Request[&quot;ItemID&quot;],
                                Request[&quot;Mode&quot;], HttpUtility.UrlEncode(ucItemPicker.Text),
                                HttpUtility.UrlEncode(txtItemDesc.Text), strReorderQS), false);
                    else
                        Response.Redirect(
                            string.Format(
                                &quot;~/Modules/ESTMATE/UnitPriceSearch.aspx?Type=Item&amp;Context=ESTMATE&amp;ParentID={0}&amp;PID={1}&amp;ContainerID={2}&amp;PayItemNo={3}&amp;ItemDesc={4}{5}&amp;UnitPriceSearch=&quot;,
                                Request[&quot;ParentID&quot;], Request[&quot;PID&quot;], Request[&quot;ContainerID&quot;],
                                HttpUtility.UrlEncode(ucItemPicker.Text), HttpUtility.UrlEncode(txtItemDesc.Text),
                                strReorderQS), false);
                }
        }

        void GetItemDetailsUnitPriceSearch()
        {
            //If Margin and Discount are not included in Build
            Session[&quot;UnitPriceSearchDetails&quot;] = null;
            Hashtable htItemDetail = new Hashtable();
            htItemDetail.Add(&quot;Container&quot;, txtItemPath.Text);
            htItemDetail.Add(&quot;PayItemNo&quot;, ucItemPicker.Text);
            htItemDetail.Add(&quot;ItemDesc&quot;, txtItemDesc.Text);
            htItemDetail.Add(&quot;AccNode&quot;, txtAccountingCode.Text);
            htItemDetail.Add(&quot;ComponentCount&quot;, lnkComponents.InnerText);
            htItemDetail.Add(&quot;ItemQuantity&quot;, wneQuantity.Text);
            htItemDetail.Add(&quot;ItemUnitPrice&quot;, wneUnitCost.Text); //If Margin and Discount are not included in Build
            htItemDetail.Add(&quot;FourceUnitPrice&quot;, chkMustBid.Checked);
            htItemDetail.Add(&quot;ItemAmount&quot;, wneAmount.Text);
            htItemDetail.Add(&quot;ItemNotes&quot;, txtNotes.Text);
            htItemDetail.Add(&quot;ItemIDValue&quot;, txtItemID.Text);
            htItemDetail.Add(&quot;ContainerID&quot;, hdnContainerID.Value);
            htItemDetail.Add(&quot;SelItemContainerID&quot;, hdnSelItemContainerID.Value);
            htItemDetail.Add(&quot;StdItemID&quot;, hdnStdItemID.Value);
            htItemDetail.Add(&quot;ReferenceItemID&quot;, hdnReferenceItemID.Value);
            htItemDetail.Add(&quot;UnitSelectedValue&quot;, ddlUnit.SelectedItem.Value);
            htItemDetail.Add(&quot;GroupSelectedValue&quot;, ddlGroups.SelectedItem.Value);
            Session[&quot;UnitPriceSearchDetails&quot;] = htItemDetail;
        }

        bool validateSubitem = true;

        protected void btnOk_ServerClick(object sender, EventArgs e)
        {
            btnSaveCont_ServerClick(sender, e);

            if (ViewState[&quot;HasErrors&quot;] == null || ViewState[&quot;HasErrors&quot;].ToBoolean2() == false)
                Response.Redirect(itemModel.ReturnUrl, false);
        }

        private void AlertError(string errMessage)
        {
            JavaScriptSerializer JS = new JavaScriptSerializer();
            errMessage = JS.Serialize(errMessage.Replace(&quot;|&quot;, &quot;\\n&quot;));
            ClientScript.RegisterStartupScript(GetType(), &quot;ShowAlert&quot;, &quot;ShowError(&quot; + errMessage + &quot;);&quot;, true);
        }

        private void btnSaveCont_ServerClick(object sender, EventArgs e)
        {
            ViewState[&quot;HasErrors&quot;] = false;
            if (string.IsNullOrEmpty(ucItemPicker.Text))
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Please Enter &quot; + LocalizationManager.GetString(&quot;StandardItemNo&quot;) +
                    &quot;&#39;);&lt;/script&gt;&quot;);
                return;
            }
            if (itemModel.EnableItemDescription &amp; string.IsNullOrEmpty(txtItemDesc.Text.Trim()))
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Cannot Add Standard Item Without Description&#39;);&lt;/script&gt;&quot;);
                return;
            }
            if (itemModel.DisplayContainer &amp; (ddlContainer.Items.Count &lt;= 0))
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Cannot Add Standard Item Without container&#39;);&lt;/script&gt;&quot;);
                return;
            }
            if (Convert.ToDouble(wneUnitCost.Value) &gt; 1000000000)
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Unit price cannot be greater than 1000000000.00&#39;);&lt;/script&gt;&quot;);
                return;
            }
            if (Convert.ToDouble(wneUnitCost.Value) &lt; -1000000000)
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Unit price cannot be less than -1000000000.00&#39;);&lt;/script&gt;&quot;);
                return;
            }
            if (ddlUnit.Items.Count == 0 || ddlUnit.SelectedValue == null)
            {
                ViewState[&quot;HasErrors&quot;] = true;
                AlertError(&quot;Unit is required. Request denied.&quot;);
                return;
            }
            Item ObjItemDetails = CreateItemDTOFromHttpRequest();
            if (!string.IsNullOrEmpty(hdnStdItemID.Value) &amp;&amp; !string.IsNullOrEmpty(hdnSelItemContainerID.Value))
            {
                int? parent = (string.IsNullOrEmpty(hdnContainerID.Value) ||
                               !hdnContainerID.Value.Equals(Request[&quot;ContainerID&quot;])
                    ? null
                    : (int?)int.Parse(hdnContainerID.Value, CultureInfo.CurrentCulture));
                hdnContainerID.Value =
                    (ObjItemDetails.ContainerID =
                        ItemManager.Instance.CopyContainer(
                            int.Parse(hdnSelItemContainerID.Value, CultureInfo.CurrentCulture), parent, context,
                            int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture))).ToString2();
            }

            #region Validate Item before Saving

            #region Fill in the Difference in Quantity

            if (ObjItemDetails.ItemID.GetValueOrDefault(0) &gt; 0)
            {
                Item existingItem = ItemManager.Instance.GetItemDetails(ObjItemDetails.ModuleID,
                    ObjItemDetails.ParentInstanceID,
                    ObjItemDetails.ItemID.GetValueOrDefault(0));
                ObjItemDetails.DiffQuantity = ObjItemDetails.Quantity - existingItem.Quantity;

                if (!ucSubItem.IsSubItemsLoaded)
                    ucSubItem.LoadItemForValidation(ObjItemDetails.ItemID.Value);
            }

            #endregion

            string resValidate = string.Empty;
            resValidate = itemModel.ValidateItemBeforeSave(ObjItemDetails);
            if (validateSubitem &amp;&amp; string.IsNullOrEmpty(resValidate))
                resValidate = ucSubItem.ValidateSubItem(ObjItemDetails, false);
            if (!string.IsNullOrEmpty(resValidate))
            {
                ViewState[&quot;HasErrors&quot;] = true;
                AlertError(resValidate.Replace(&quot;global group&quot;, &quot;sub item&quot;));
                return;
            }

            #endregion

            int itemID = ItemManager.Instance.SaveItemDetails(ObjItemDetails);
            //save documents
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            itemAttachments.SaveAttachments(itemID.ToString2(), &quot;ITM&quot; + context, ud.UID,
                ud.UserName, &quot;Item Documents&quot;);

            if (hdnIsNewItem.Value.Contains(&quot;Y&quot;) &amp;&amp; hdnMode.Value.Contains(&quot;Edit&quot;))
                hdnIsNewItem.Value = &quot;Y&quot;;
            else
                hdnIsNewItem.Value = &quot;N&quot;;
            if (itemID &gt; 0)
            {
                txtItemID.Text = itemID.ToString2();
                subItemList.ItemID = itemID;

                //TODO Removed the code here, need to test how it behaves
                //A new property is added to get SourceModuleID.
                string sourceModuleID = itemModel.SourceModuleID;

                if (!string.IsNullOrEmpty(hdnStdItemID.Value))
                {
                    // Note: Resource saving is taken care by RateAnalysis control.
                    ////Copy Rate Analysis
                    //ItemManager.Instance.CopyRateAnalysisFromSrcItem(sourceModuleID, null,
                    //    Convert.ToInt32(hdnStdItemID.Value,
                    //        CultureInfo.CurrentCulture),
                    //    Request[&quot;Context&quot;].Trim(),
                    //    Convert.ToInt32(Request[&quot;ParentID&quot;],
                    //        CultureInfo.CurrentCulture), itemID,
                    //    true);

                    //APPLY CURRENCY CONVERSION FOR RATE ANALYSIS FROM COMPANY CURRENCY TO MODULE CURRENCY
                    ItemManager.Instance.ApplyCurrencyConversionForRateAnalysis(itemID, Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentId&quot;]),
                        Session[Constants.EIS_ADDITIONAL_INFO].
                            ToString());

                    //Copy SubItems
                    itemModel.CopySubItemsFromSourceItem(itemID, sourceModuleID, hdnStdItemID);

                    //Copy Components
                    ItemManager.Instance.CopyComponentsFromStandardTable(sourceModuleID, 0,
                        Convert.ToInt32(hdnStdItemID.Value,
                            CultureInfo.CurrentCulture),
                        Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;],
                            CultureInfo.CurrentCulture),
                        itemID);

                    // Note: No need to create activity for sub contract. RateAnalysis control is taking care already.
                    //if (hdnRetAct.Value.Contains(&quot;Y&quot;) || hdnMode.Value.Contains(&quot;New&quot;) ||
                    //    hdnIsNewItem.Value.Contains(&quot;Y&quot;))
                    //{
                    //    //Copy Activities
                    //    itemModel.CopyItemActivitiesFromSourceItem(itemID, sourceModuleID, hdnStdItemID);
                    //}
                    hdnIsNewItem.Value = &quot;N&quot;;

                    //Clears the hidden field after successfully copying the Rate analysis and Sub Item
                    hdnStdItemID.Value = String.Empty;
                    hdnMode.Value = &quot;Edit&quot;;
                }

                if (!string.IsNullOrEmpty(Request.QueryString[&quot;Reorder&quot;]) &amp;&amp; Request.QueryString[&quot;Reorder&quot;] == &quot;1&quot;)
                {
                    int targetId = 0;
                    int.TryParse(Request.QueryString[&quot;TargetID&quot;], out targetId);
                    string action = Request.QueryString[&quot;Action&quot;];

                    ItemManager.Instance.ReorderItemStructure(itemID, &quot;I&quot;,
                        targetId, &quot;I&quot;, action, ModuleId, Request.QueryString[&quot;ParentID&quot;].ToInt32_2());
                }

                //If injection is there then the basepage injection save shd be called explicitly
                //TODO: Need to change this - Akila
                if (xmlInjection != null)
                    BrixPageBase_SaveXMLInjectionData(sender, e);

                if (itemModel.IsWBS)
                {
                    itemModel.ActivityDate = CreateActivityDateDTO(itemID);
                }


                if (sender.GetType() != typeof(HtmlAnchor))
                {
                    txtItemID.Text = String.Empty;
                    ResetControls();
                    PageTitle = ModeTypes.New.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
                    ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                    ucSubItem.ClearSubItems();
                    itemAttachments.ClearAllAttachments();
                }
                else
                    itemActivities.ResetGrid(Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture), itemID,
                        true);


                if (itemModel.DisplayRateAnalysisSection)
                {
                    rateAnalysisDetail.SetItemID4RateAnalysis = itemID;
                    // Override
                    rateAnalysisDetail.SaveResources(sender, e);
                }

                itemModel.AfterSave(itemModel);
            }
            else if (itemID == -2)
            {
                ViewState[&quot;HasErrors&quot;] = true;
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error&quot;,
                    &quot;&lt;script&gt;ShowError(&#39;Cannot Insert Duplicate Standard Item&#39;);&lt;/script&gt;&quot;);
            }
        }

        private void ResetControls()
        {
            txtAccountingCode.Text =
                txtItemDesc.Text =
                    txtItemID.Text =
                        ucItemPicker.Text =
                            txtNotes.Text =
                                txtStandardItemNo.Text =
                                    txtBudgetItem.Text = String.Empty;
            wneQuantity.Value =
                wneUnitCostFinal.Value =
                    wneOverheadCost.Value =
                        wneUnitCost.Value =
                            wneUnitPrice.Value =
                                wneAmount.Value =
                                    wneDiscountPercentage.Value =
                                        wceDiscount.Value =
                                            wceMargin.Value =
                                                wneMarginPercentage.Value =
                                                    hdnSelectedBudgetItem.Value =
                                                    hdnSelectedBudgetItemToDelete.Value = string.Empty;
            chkComplete.Checked =
                chkMustBid.Checked = false;
            if (chkNC.Enabled)
                chkNC.Checked = false;
            if (chkRW.Enabled)
                chkRW.Checked = false;
            decimal cost = 0.0M;
            lblCost.Text = cost.ToString(AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE, CultureInfo.CurrentCulture);
            txtActivities.Text = txtComponents.Text = &quot;0&quot;;
            itemActivities.ResetGrid(Request[&quot;Context&quot;].Trim(),
                Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture), 0, true);
            wneQuantity.ReadOnly = !itemModel.EnableQuantity;
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Response.Redirect(itemModel.ReturnUrl, false);
        }

        protected void BtnCancelFromControl_Click(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty((Request.QueryString[&quot;COType&quot;]))
                &amp;&amp; !Request.QueryString[&quot;COType&quot;].Equals(&quot;N&quot;))
            {
                if (Request.QueryString[&quot;COType&quot;].Equals(&quot;C&quot;)
                    || (Request.QueryString[&quot;COType&quot;].Equals(&quot;M&quot;)
                        &amp;&amp; sender.ToString2().Contains(&quot;itempickercontrol&quot;)))
                    btnCancel_Click(sender, e);
            }
            ShowDiv(ItemDivEnums.CreateItem);
            if (string.IsNullOrEmpty(Request.QueryString[&quot;mode&quot;]))
                PageTitle = ModeTypes.New.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
            else if ((Request.QueryString[&quot;mode&quot;].Equals(ModeTypes.View.ToString2()))
                     ||
                     (Request.QueryString[&quot;mode&quot;].Equals(
                         Convert.ToInt32(ModeTypes.View, CultureInfo.CurrentCulture).ToString2())))
                PageTitle = ModeTypes.View.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
            else
                PageTitle = ModeTypes.Edit.ToString2() + &quot; &quot; + LocalizationManager.GetString(itemModel.Header);
            if (sender.ToString2().Contains(&quot;rateanalysiscontrol&quot;))
            {
                if (string.IsNullOrEmpty(Request[&quot;DisplayType&quot;]))
                {
                    GetItemCost();
                    GetActivityCount(context, int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture));
                }
                else
                    btnCancel_Click(sender, e);
            }
            else if (sender.ToString2().Contains(&quot;subitemcontrol&quot;))
            {
                ClientScript.RegisterStartupScript(GetType(), &quot;calculatefnSubItem&quot;,
                    &quot;$(document).ready(function() {Calculate();});&quot;, true);
                if (string.IsNullOrEmpty(Request[&quot;DisplayType&quot;]))
                {
                    itemActivities.ResetGrid(Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture), true);

                    if ((!string.IsNullOrEmpty((Request.QueryString[&quot;AddExistingItem&quot;])) &amp;&amp;
                         Request.QueryString[&quot;AddExistingItem&quot;].Equals(&quot;Y&quot;)))
                    {
                        object qty = itemModel.GetSubItemQuantity(Convert.ToInt32(txtItemID.Text.Trim()), &quot;ESTMADD&quot;);
                        if (qty != null &amp;&amp; qty is decimal)
                        {
                            wneQuantity.ReadOnly = true;
                            wneQuantity.ValueDecimal = qty.ToDecimal2();
                            wneAmount.ValueDecimal = itemModel.IsAmountFromUnitCost
                                ? (wneQuantity.ValueDecimal * wneUnitCostFinal.ValueDecimal)
                                : (wneQuantity.ValueDecimal * wneUnitPrice.ValueDecimal);
                        }
                    }
                    else
                        GetSubItemQuantity();

                    GetItemCost();
                    GetActivityCount(context, int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture));
                    GetComponentCount(
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture), Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture));
                }
                else
                    btnCancel_Click(sender, e);

                if (Request[&quot;Context&quot;] != null &amp;&amp; Request[&quot;COType&quot;] != null &amp;&amp; ucItemPicker != null &amp;&amp;
                    (Request[&quot;Context&quot;].ToString2() == &quot;CHNGORD&quot; || Request[&quot;Context&quot;].ToString2() == &quot;BDGTREV&quot;)
                    &amp;&amp; Request[&quot;COType&quot;].ToString2() == &quot;M&quot; &amp;&amp; Request[&quot;COType&quot;].ToString2() == &quot;D&quot; &amp;&amp;
                    !string.IsNullOrEmpty(ucItemPicker.PickerText.ToString2()))
                    trAmount.Style.Add(HtmlTextWriterStyle.Display, &quot;table-row&quot;);
            }
            else if (sender.Equals(itemActivities))
            {
                if (string.IsNullOrEmpty(Request[&quot;DisplayType&quot;]))
                {
                    GetActivityCount(context, int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture));
                    GetComponentCount(
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture), Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture));
                }
                else
                    btnCancel_Click(sender, e);
            }
            else if (sender.Equals(components))
            {
                if (string.IsNullOrEmpty(Request[&quot;DisplayType&quot;]))
                {
                    GetComponentCount(
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture), Request[&quot;Context&quot;].Trim(),
                        Convert.ToInt32(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture));
                    GetActivityCount(context, int.Parse(Request[&quot;ParentID&quot;], CultureInfo.CurrentCulture),
                        string.IsNullOrEmpty(txtItemID.Text)
                            ? 0
                            : int.Parse((txtItemID.Text), CultureInfo.CurrentCulture));
                }
                else
                    btnCancel_Click(sender, e);
            }
            ViewState[&quot;PageTitleValue&quot;] = PageTitle;
        }

        protected void btnItemPathPicker_Click(object sender, EventArgs e)
        {
            ShowDiv(ItemDivEnums.GroupHierarchyPicker);
            container.DataBind(hdnContainerID.Value);
            PageTitle = &quot;Select &quot; + LocalizationManager.GetString(&quot;Container&quot;);
            ViewState[&quot;PageTitleValue&quot;] = PageTitle;
        }

        protected void ddlGroups_SelectedIndexChanged(object sender, EventArgs e)
        {
            var dtGroupDetails = (DataTable)ViewState[&quot;GroupDetails&quot;];

            DataRow[] dr = dtGroupDetails.Select(&quot;GroupID = &quot; + ddlGroups.SelectedValue);

            if (dr != null &amp;&amp; dr.Length == 1)
            {
                hdnUPIncrease.Value = dr[0][&quot;OTPPercentage&quot;].ToString2();
                hdnDiscount.Value = dr[0][&quot;Discount&quot;].ToString2();

                if (!chkNC.Checked)
                {
                    // discount is provided on the calculated unitprice (after the applying the percentage increase)
                    wneUnitPrice.ValueDecimal = (wneUnitCostFinal.ValueDecimal *
                                                 (1 + Convert.ToDecimal(hdnUPIncrease.Value, CultureInfo.CurrentCulture))) -
                                                ((wneUnitCostFinal.ValueDecimal *
                                                  (1 +
                                                   Convert.ToDecimal(hdnUPIncrease.Value, CultureInfo.CurrentCulture))) *
                                                 Convert.ToDecimal(hdnDiscount.Value, CultureInfo.CurrentCulture));

                    wneAmount.ValueDecimal = itemModel.IsAmountFromUnitCost
                        ? (wneQuantity.ValueDecimal * wneUnitCostFinal.ValueDecimal)
                        : (wneQuantity.ValueDecimal * wneUnitPrice.ValueDecimal);
                }
                else
                {
                    wneUnitPrice.ValueDecimal = 0;
                    wneAmount.ValueDecimal = 0;
                }
            }
        }

        private void ShowHideControls()
        {
            ucItemPicker.TextOnly = !itemModel.DisplayItemPicker;
            trActivity.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayActivity ? &quot;table-row&quot; : &quot;none&quot;);
            trComponent.Style.Add(HtmlTextWriterStyle.Display,
                (itemModel.DisplayComponents &amp;&amp; ModuleComponents.Contains(&quot;Components&quot;)) ? &quot;table-row&quot; : &quot;none&quot;);
            trQuantity.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplaySubItems ? &quot;table-row&quot; : &quot;none&quot;);
            trAmount.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayAmount ? &quot;table-row&quot; : &quot;none&quot;);
            trAlternate.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayAlternate ? &quot;table-row&quot; : &quot;none&quot;);
            trMustBid.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayMustBid ? &quot;table-row&quot; : &quot;none&quot;);
            trComplete.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayComplete ? &quot;table-row&quot; : &quot;none&quot;);
            trNonContractItem.Style.Add(HtmlTextWriterStyle.Display,
                itemModel.DisplayNonContractItem ? &quot;table-row&quot; : &quot;none&quot;);
            trItemPath.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayContainerSelector ? &quot;table-row&quot; : &quot;none&quot;);
            trProjectedUnitPrice.Style.Add(HtmlTextWriterStyle.Display,
                itemModel.DisplayProjectedUnitPrice ? &quot;table-row&quot; : &quot;none&quot;);
            trGroup.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayGroup ? &quot;table-row&quot; : &quot;none&quot;);
            trContainer.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayContainer ? &quot;table-row&quot; : &quot;none&quot;);
            trReWorkItem.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayReWorkItem ? &quot;table-row&quot; : &quot;none&quot;);
            trOverheadCost.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayOverheadCost ? &quot;table-row&quot; : &quot;none&quot;);
            trPayItemNo.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayPayItemNo ? &quot;table-row&quot; : &quot;none&quot;);
            trItemDescription.Style.Add(HtmlTextWriterStyle.Display,
                itemModel.DisplayItemDiscription ? &quot;table-row&quot; : &quot;none&quot;);
            trAccountingCode.Style.Add(HtmlTextWriterStyle.Display,
                itemModel.DisplayAccountigCode ? &quot;table-row&quot; : &quot;none&quot;);
            trUnit.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayUnit ? &quot;table-row&quot; : &quot;none&quot;);

            trBaseUnitCost.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayBaseUnitCost ? &quot;table-row&quot; : &quot;none&quot;);
            trMargin.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayMargin ? &quot;table-row&quot; : &quot;none&quot;);
            trDiscount.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayDiscount ? &quot;table-row&quot; : &quot;none&quot;);
            trUnitCost.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayUnitCost ? &quot;table-row&quot; : &quot;none&quot;);
            trNotes.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayNotes ? &quot;table-row&quot; : &quot;none&quot;);
            ucRateAnalysis.isOverheadsShown = itemModel.DisplayOverheadCost;
            trQuantity.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayQuantity ? &quot;table-row&quot; : &quot;none&quot;);

            trWeightage.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayWeightage ? &quot;table-row&quot; : &quot;none&quot;);
            trTaskPriority.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayPriority ? &quot;table-row&quot; : &quot;none&quot;);

            trStartDate.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);
            trEndDate.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);
            trActualStartDate.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);
            trActualEndDate.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);
            trPerComplete.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);
            trDuration.Style.Add(HtmlTextWriterStyle.Display, itemModel.IsWBS ? &quot;table-row&quot; : &quot;none&quot;);

            if (!string.IsNullOrEmpty(context) &amp;&amp; context == &quot;ESTMATE&quot;)
                trEstimateItemUnitPriceSearch.Style.Add(HtmlTextWriterStyle.Display,
                    itemModel.DisplayEstimateUnitPriceSearch ? &quot;table-row&quot; : &quot;none&quot;);
            else
                trEstimateItemUnitPriceSearch.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);

            //Umbrella Contract Work Order
            trProject.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayProject ? &quot;table-row&quot; : &quot;none&quot;);

            DivRateAnalysis.Visible = itemModel.DisplayRateAnalysisSection &amp;&amp; !ucSubItem.Visible; // When subitem div is shown, dont show rate analysis.
            ResourceOnly.Visible = itemModel.DisplayRateAnalysisSection &amp;&amp; !CoreModuleComponents.Contains(Constants.ModuleComponent.ConsiderResourceForEstimate);
            divTotalEstimate.Visible = itemModel.DisplayRateAnalysisSection &amp;&amp; CoreModuleComponents.Contains(Constants.ModuleComponent.ConsiderResourceForEstimate);

            // Show/Hide Inflation Components
            updatePanelInflation.Visible = itemModel.EnableInflation;
        }

        private void ShowDiv(ItemDivEnums divType)
        {
            DivCreateItem.Visible = (ItemDivEnums.CreateItem == divType);
            DivAttachmentControl.Visible = (ItemDivEnums.CreateItem == divType);
            DivRateAnalysis.Visible = (ItemDivEnums.RateAnalysis == divType);
            ucSubItem.Visible = DivSubItems.Visible = (ItemDivEnums.SubItems == divType);
            ucItemActivity.Visible = DivItemActivity.Visible = (ItemDivEnums.ItemActivity == divType);
            DivGroupHierarchyPicker.Visible = (ItemDivEnums.GroupHierarchyPicker == divType);
            DivComponents.Visible = (ItemDivEnums.Components == divType);

            switch (divType)
            {
                case ItemDivEnums.ItemPicker:
                case ItemDivEnums.SubItems:
                case ItemDivEnums.ItemActivity:
                case ItemDivEnums.GroupHierarchyPicker:
                case ItemDivEnums.Components:
                    MainToolBar.Visible = false;
                    break;
                case ItemDivEnums.RateAnalysis:
                    if (itemModel.DisplayRateAnalysisSection)
                    {
                        MainToolBar.Visible = true;
                        MainToolBar.CreateToolBar(menuGroups);
                    }
                    else
                        MainToolBar.Visible = false;
                    break;
                case ItemDivEnums.CreateItem:
                    if (itemModel.DisplayRateAnalysisSection)
                        DivRateAnalysis.Visible = true;
                    MainToolBar.Visible = true;
                    MainToolBar.CreateToolBar(menuGroups);
                    break;
                default:
                    MainToolBar.Visible = true;
                    MainToolBar.CreateToolBar(menuGroups);
                    break;
            }
        }

        bool EnabledPlanning()
        {
            if (ModuleManager.Instance.GetModuleList().ContainsKey(Constants.MODID_PLANING))
                return true;
            else
                return false;
        }

        protected override void CreateChildControls()
        {
            try
            {
                //menus.Add(new BrixMenu(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;IcnEdit.png&quot;, 55));
                //menus.Add(new BrixMenu(&quot;lnkSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;, 55));
                //menus.Add(new BrixMenu(&quot;lnkSaveContinue&quot;, &quot;Save &amp; Continue&quot;, &quot;Icn_Save.png&quot;, 55));
                //menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));

                //CreateToolBarMenu(menus, null);            
                MenuGroup generalGroup = new MenuGroup(&quot;General&quot;);
                generalGroup.AddMenu(new LargeButton(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;Icn_Edit.png&quot;));
                if (AllowSave)
                    generalGroup.AddMenu(new LargeButton(&quot;lnkSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;));
                generalGroup.AddMenu(new TextIcon(&quot;lnkSaveContinue&quot;, &quot;Save &amp; Continue&quot;, &quot;Icn_Saveas_16.png&quot;));
                generalGroup.AddMenu(new TextIcon(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel_16.png&quot;));
                //if (EnabledPlanning() &amp;&amp; !string.IsNullOrEmpty(rblselectedbudgetitem()) &amp;&amp; rblselectedbudgetitem().ToUpper() == &quot;WORK PROJECTS&quot;)
                //generalGroup.AddMenu(new LargeButton(&quot;lnkWorkProjects&quot;, &quot;Add WP&quot;, &quot;Icn_Edit.png&quot;));
                generalGroup.AddMenu(new LargeButton(&quot;lnkDelete&quot;, &quot;Delete&quot;, &quot;Icn_Delete.png&quot;));
                menuGroups.Add(generalGroup);

                CreateToolBarMenu(menuGroups, null);
            }
            catch
            {
            }
        }

        protected string rblselectedbudgetitem()
        {
            Dictionary&lt;string, string&gt; appSettings = CoreDatabaseHelper.GetApplicationSettings();
            string CreateBudgetItemsThroughWPs;
            appSettings.TryGetValue(&quot;CreateBudgetItems&quot;, out CreateBudgetItemsThroughWPs);
            return CreateBudgetItemsThroughWPs;
        }

        private string LoadPicker { get; set; }
        private HiddenField hdnPickerSelectedRows;

        private List&lt;PickerColumnDetails&gt; GetGridColumns()
        {
            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;PID&quot;,
                Caption = &quot;PID&quot;,
                Hidden = true,
                Type = &quot;number&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Name&quot;,
                Caption = &quot;Name&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Description&quot;,
                Caption = &quot;Description&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;EstimatedCost&quot;,
                Caption = &quot;EstimatedCost&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Comment&quot;,
                Caption = &quot;Comment&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });

            return gridColumns;
        }

        private void InitializeTaskItemPicker()
        {
            Page page = HttpContext.Current.Handler as Page;
            Control ct = page.LoadControl(&quot;~/Modules/UserControls/PickerGrid.ascx&quot;);

            hdnPickerSelectedRows = new HiddenField();
            hdnPickerSelectedRows.ID = &quot;hdnPickerSelectedRows&quot;;
            hdnPickerSelectedRows.ClientIDMode = ClientIDMode.Static;

            page.Form.Controls.Add(hdnPickerSelectedRows);

            PickerGrid objGrid = (PickerGrid)ct;
            objGrid.InitializePicker(&quot;/api/GenericXMLPicker/&quot;, GetGridColumns(), &quot;ID&quot;);
            objGrid.ID = &quot;addBudgetItems&quot;;
            objGrid.EnableMultiSelect = false;
            objGrid.ButtonText = &quot;Add&quot;;
            objGrid.PageSize = 20;
            objGrid.PostBackAfterSelect = true;
            objGrid.BeforePickerLoadScript = &quot;&quot;;

            objGrid.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);

            objGrid.AfterPickerSelectScript = &quot;$(&#39;#hdnPickerSelectedRows&#39;).val(JSON.stringify({0}));&quot;;
            objGrid.OnItemSelected += new PickerGrid.SelectedItems(objGrid_OnItemSelected);

            objGrid.OnGridLoad += new PickerGrid.GridLoad(objGrid_OnGridLoad);

            objGrid.Title = &quot;Select Work Projects&quot;;

            LoadPicker = &quot;$(&#39;#&quot; + objGrid.TriggerButton.ClientID + &quot;&#39;).click();return false;&quot;;
            page.Form.Controls.Add(objGrid);
        }

        private void InitializebudgetItemPicker()
        {
            if (!itemModel.DisplayBudgetItemLinkPicker ||
                !ModuleManager.Instance.ModuleExists(Constants.MODID_BDGMGMT) ||
                !BudgetModuleComponent.Contains(&quot;LinkBudgetItem&quot;)) return;

            Page page = HttpContext.Current.Handler as Page;

            BudItemPicker = page.LoadControl(&quot;~/Modules/UserControls/PickerGrid.ascx&quot;) as PickerGrid;

            List&lt;PickerColumnDetails&gt; columns =
                new List&lt;PickerColumnDetails&gt; { new PickerColumnDetails { ColumnName = &quot;ItemID&quot;, Caption = &quot;Item Id&quot;, Hidden = true, Type = &quot;number&quot; },
                                                new PickerColumnDetails { ColumnName = &quot;ContainerPath&quot;, Caption = &quot;Container Path&quot;, Hidden = false, Type = &quot;string&quot; },
                                                new PickerColumnDetails { ColumnName = &quot;LineNo&quot;, Caption = &quot;Line No&quot;, Hidden = false, Type = &quot;int&quot; },
                                                new PickerColumnDetails { ColumnName = &quot;StandardItemNo&quot;, Caption = &quot;Standard Item No&quot;, Hidden = false, Type = &quot;string&quot; },
                                                new PickerColumnDetails { ColumnName = &quot;Description&quot;, Caption = &quot;Description&quot;, Hidden = false, Type = &quot;string&quot; }};

            StringBuilder parameters = new StringBuilder();
            parameters.Append(&quot;{&quot;)
                .Append(&quot;\&quot;DataSource\&quot; : \&quot;_table:vw_BDGMGMTReleasedBudgetItems\&quot;&quot;)
                .Append(&quot;,\&quot;WhereCond\&quot; : \&quot;PID @^ &quot; + Request[&quot;PID&quot;] + &quot; OR PID @^ 0\&quot;&quot;)
                .Append(&quot;}&quot;);

            BudItemPicker.Title = &quot;Select Budget Item&quot;;
            BudItemPicker.ID = &quot;associateBudgetItem&quot;;
            BudItemPicker.EnableMultiSelect = false;
            BudItemPicker.PostBackAfterSelect = false;
            BudItemPicker.PageSize = 20;
            BudItemPicker.BeforePickerLoadScript = string.Empty;
            BudItemPicker.AfterPickerSelectScript = &quot;onBudgetItemPickerSelect(&#39;&quot; + txtBudgetItem.ClientID + &quot;&#39;,&#39;&quot; + hdnSelectedBudgetItem.ClientID + &quot;&#39;,{0});&quot;;
            BudItemPicker.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);

            BudItemPicker.InitializePicker(&quot;/api/GenericXMLPicker/&quot;, columns, &quot;ItemID&quot;);
            BudItemPicker.OptionalParamaters = BudItemPicker.BuildOptionalParameters(parameters.ToString());

            BudgetItemPlaceHolder.Controls.Add(BudItemPicker);

            trBudLinkPick.Visible = true;

            txtBudgetItem.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
        }

        void objGrid_OnItemSelected(PickerGrid grid, List&lt;Dictionary&lt;string, object&gt;&gt; selectedRows)
        {
            try
            {
                foreach (Dictionary&lt;string, object&gt; entry in selectedRows)
                {
                    ucItemPicker.Text = txtStandardItemNo.Text = entry[&quot;Name&quot;].ToString2();
                    txtItemDesc.Text = entry[&quot;Description&quot;].ToString2();
                    wneQuantity.Value = 1;
                    wneUnitCost.Value = entry[&quot;EstimatedCost&quot;].ToString2();
                    wneAmount.Value = entry[&quot;EstimatedCost&quot;].ToString2();
                    txtNotes.Text = entry[&quot;Comment&quot;].ToString2();
                }
            }
            catch (System.Exception ex)
            {
                Page page = HttpContext.Current.Handler as Page;
                JavaScriptSerializer JS = new JavaScriptSerializer();
                string errMessage = JS.Serialize(ex.Message.Replace(&quot;|&quot;, &quot;&lt;br/&gt;&quot;));
                page.ClientScript.RegisterStartupScript(GetType(), &quot;ShowAlert&quot;, &quot;ShowError(&quot; + errMessage + &quot;);&quot;, true);
            }
        }

        private void objGrid_OnGridLoad(PickerGrid grid)
        {
            StringBuilder parameters = new StringBuilder();
            parameters.Append(&quot;{&quot;);
            parameters.Append(&quot;\&quot;DataSource\&quot; : \&quot;_table:WORKPRJMaster\&quot;&quot;);
            parameters.Append(&quot;,\&quot;WhereCond\&quot; : \&quot;PID @^ &quot; + Request[&quot;PID&quot;] + &quot; OR PID @^ 0\&quot;&quot;);
            parameters.Append(&quot;}&quot;);

            grid.OptionalParamaters = grid.BuildOptionalParameters(parameters.ToString());
        }

        public void HideMainToolBar()
        {
            MainToolBar.Visible = false;
        }

        protected override void CustomizeToolBar()
        {
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).CausesValidation = true;
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).ValidationGroup = &quot;CreateItem&quot;;
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Click += btnEdit_Click;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkSave&quot;).CausesValidation = true;
                MainToolBar.GetMenuReference(&quot;lnkSave&quot;).ValidationGroup = &quot;CreateItem&quot;;
                MainToolBar.GetMenuReference(&quot;lnkSave&quot;).Click += btnOk_ServerClick;
                lnkOk.Click += btnOk_ServerClick;
                if (ModuleComponents.Contains(&quot;Activities&quot;))
                {
                    hdnContainActivities.Value = &quot;1&quot;;
                }
                //When CausesValidation has been set to true then there is no need to call Page_ClientValidate() explicitly.
                MainToolBar.GetMenuReference(&quot;lnkSave&quot;).OnClientClick = &quot;document.getElementById(&#39;&quot; + hdnSave.ClientID +
                                                                        &quot;&#39;).value = &#39;true&#39;;&quot; +
                                                                        &quot;return ConfirmSaveItem(&#39;I&#39;)&quot;;

            }
            if (MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;).CausesValidation = true;
                MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;).ValidationGroup = &quot;CreateItem&quot;;
                //When CausesValidation has been set to true then there is no need to call Page_ClientValidate() explicitly.
                if (ModuleComponents.Contains(&quot;Activities&quot;))
                {
                    hdnContainActivities.Value = &quot;1&quot;;
                }
                MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;).OnClientClick = &quot;return ConfirmSaveItem(&#39;I&#39;)&quot;;
                MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;).Click += btnSaveCont_ServerClick;
                lnkSaveCont.Click += btnSaveCont_ServerClick;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkDelete&quot;) != null)
            {
                if (ModuleComponents.Contains(&quot;Activities&quot;))
                {
                    hdnContainActivities.Value = &quot;1&quot;;
                }
                //                MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).OnClientClick = &quot;return ConfirmSaveItem(&#39;I&#39;)&quot;;
                MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).Click += btnDeleteCont_ServerClick;
                //lnkSaveCont.Click += btnDeleteCont_ServerClick;

                //   MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).PostBackUrl = itemModel.ReturnUrl;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).ValidationGroup = &quot;CreateItem&quot;;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).PostBackUrl = itemModel.ReturnUrl;
            }
            itemModel.CustomizeToolBar(MainToolBar);
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                if (!btnEdit.Visible || btnEdit.Style[HtmlTextWriterStyle.Display] == &quot;none&quot;)
                    MainToolBar.HideMenu(&quot;lnkEdit&quot;);
                else if (!btnEdit.Enabled)
                    MainToolBar.DisableMenu(&quot;lnkEdit&quot;);
            }
            if (MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
            {
                if (!btnOk.Visible || btnOk.Style[HtmlTextWriterStyle.Display] == &quot;none&quot;)
                    MainToolBar.HideMenu(&quot;lnkSave&quot;);
                else if (!btnOk.Enabled)
                    MainToolBar.DisableMenu(&quot;lnkSave&quot;);
                else
                {
                    MainToolBar.ShowMenu(&quot;lnkSave&quot;);
                    MainToolBar.EnableMenu(&quot;lnkSave&quot;);
                }
            }
            if (MainToolBar.GetMenuReference(&quot;lnkSaveContinue&quot;) != null)
            {
                if (currentMode == ModeTypes.Edit || !btnSaveCont.Visible ||
                    btnSaveCont.Style[HtmlTextWriterStyle.Display] == &quot;none&quot; || btnSaveCont.Style[&quot;display&quot;] == &quot;none&quot;)
                    MainToolBar.HideMenu(&quot;lnkSaveContinue&quot;);
                else if (!btnSaveCont.Enabled)
                    MainToolBar.DisableMenu(&quot;lnkSaveContinue&quot;);
                else
                {
                    MainToolBar.ShowMenu(&quot;lnkSaveContinue&quot;);
                    MainToolBar.EnableMenu(&quot;lnkSaveContinue&quot;);
                }
            }
            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
            {
                if (!btnCancel.Visible || btnCancel.Style[HtmlTextWriterStyle.Display] == &quot;none&quot;)
                    MainToolBar.HideMenu(&quot;lnkCancel&quot;);
                else if (!btnCancel.Enabled)
                    MainToolBar.DisableMenu(&quot;lnkCancel&quot;);
                else
                {
                    MainToolBar.ShowMenu(&quot;lnkCancel&quot;);
                    MainToolBar.EnableMenu(&quot;lnkCancel&quot;);
                }
            }
            if (Request.QueryString[&quot;COType&quot;].ToString2() == &quot;D&quot;)
            {
                MainToolBar.HideMenu(&quot;lnkSave&quot;);
                MainToolBar.HideMenu(&quot;lnkEdit&quot;);
                MainToolBar.HideMenu(&quot;lnkSaveContinue&quot;);
                MainToolBar.HideMenu(&quot;lnkWorkProjects&quot;);
            }

            else
            {
                MainToolBar.HideMenu(&quot;lnkDelete&quot;);
            }

            if (currentMode == ModeTypes.View)
            {
                MainToolBar.HideMenu(&quot;lnkEdit&quot;);

            }

            if (!string.IsNullOrEmpty(rateAnalysisDetail.RAPageTitle) &amp;&amp; DivRateAnalysis.Visible &amp;&amp; !itemModel.DisplayRateAnalysisSection)
                PageTitle = rateAnalysisDetail.RAPageTitle;
            if (subItemList.Visible)
                PageTitle = &quot;Sub Items&quot;;

            ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            if (ModuleComponents.Contains(&quot;UnitQuantityModel&quot;))
            {
                wneUnitCost.ValueDecimal = wneUnitCostFinal.ValueDecimal = wneUnitPrice.ValueDecimal = 1;
                //Renaming Quantity to Amount 
                if (!string.IsNullOrEmpty(context) &amp;&amp; (context == &quot;CHNGORD&quot; || context == &quot;BDGTREV&quot;))
                    td1.InnerText = &quot;Additional &quot; + LocalizationManager.GetString(&quot;Amount&quot;) + &quot; :&quot;;
                else
                    td1.InnerText = LocalizationManager.GetString(&quot;Amount&quot;) + &quot; :&quot;;

                ShowHideModuleComponents();
                trAmount.Style.Add(HtmlTextWriterStyle.Display, itemModel.DisplayAmount ? &quot;table-row&quot; : &quot;none&quot;);
            }
            else if (!string.IsNullOrEmpty(itemModel.Legend_Quantity))
                td1.InnerText = itemModel.Legend_Quantity;

            if (!string.IsNullOrEmpty(Request.QueryString[&quot;COType&quot;]))
            {
                if (Request.QueryString[&quot;COType&quot;] == &quot;M&quot;)
                {
                    PageTitle = &quot;Modify Existing &quot; + LocalizationManager.GetString(&quot;Item&quot;);
                    ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                }
                if (Request.QueryString[&quot;COType&quot;] == &quot;D&quot;)
                {
                    PageTitle = &quot;Delete Existing &quot; + LocalizationManager.GetString(&quot;Item&quot;);
                    ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                }
            }

            if (!string.IsNullOrEmpty(Request.QueryString[&quot;Context&quot;]) &amp;&amp;
                Request.QueryString[&quot;Context&quot;].ToString() == &quot;ESTMADD&quot;)
            {
                if (!string.IsNullOrEmpty(Request.QueryString[&quot;AddExistingItem&quot;]) &amp;&amp;
                    Request.QueryString[&quot;AddExistingItem&quot;].ToString() == &quot;Y&quot;)
                {
                    PageTitle = &quot;Add Existing &quot; + LocalizationManager.GetString(&quot;Item&quot;);
                }
                else
                {
                    if (currentMode == ModeTypes.New)
                    {
                        PageTitle = &quot;New Addendum &quot; + LocalizationManager.GetString(&quot;Item&quot;);
                    }
                    else
                    {
                        PageTitle += &quot; Addendum &quot; + LocalizationManager.GetString(&quot;Item&quot;);
                    }
                }

                ViewState[&quot;PageTitleValue&quot;] = PageTitle;
            }

            itemModel.OnPreRender(itemModel);
            base.OnPreRender(e);
        }

        #region IXMLControl Members

        public object[] ParentFormInstanceID
        {
            get { return new[] { txtItemID.Text.Trim() }; }
        }

        public HtmlGenericControl XMLContainterDiv
        {
            get { throw new NotImplementedException(); }
            set { throw new NotImplementedException(); }
        }


        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        {
        }

        #endregion

        private void RegisterCallBackScript()
        {
            //var sb = new StringBuilder();
            //sb.Append(&quot;&lt;script language=\&quot;javascript\&quot; type=\&quot;text/javascript\&quot;&gt;&quot;);
            //sb.Append(&quot;function SendServerRqst(arguments,context){&quot;);
            //sb.Append(Page.ClientScript.GetCallbackEventReference(this, &quot;arguments&quot;, &quot;HandleServerResponse&quot;, &quot;context&quot;,
            //    false));
            //sb.Append(&quot;}&quot;);
            //sb.Append(&quot;&lt;/script&gt;&quot;);
            //Page.ClientScript.RegisterStartupScript(GetType(), &quot;CallBackScript&quot;, sb.ToString2());
        }

        #region ICallbackEventHandler Members

        //public override void RaiseCallbackEvent(string arguments)
        //{
        //    // process the arguments and do the required job then  - pass it to the callbackResult.
        //    string[] args = arguments.Split(new string[] { &quot;]&amp;[&quot; }, StringSplitOptions.RemoveEmptyEntries);
        //    var dic = new Dictionary&lt;string, string&gt;();
        //    var dicTemp = new Dictionary&lt;string, string&gt;();
        //    foreach (string str in args)
        //    {
        //        string[] tmpArray = str.Split(&quot;=&quot;.ToCharArray());
        //        dic.Add(tmpArray[0], tmpArray[1]);
        //    }

        //    if (dic[&quot;action&quot;] == &quot;validateSaveItem&quot;)
        //    {
        //        //confirmDuplicateItemSave
        //        int itemId = 0;

        //        Item ObjItemDetails = CreateItemDTOFromHttpRequest();

        //        if (ObjItemDetails.ItemID == null || ObjItemDetails.ItemID == 0)
        //            int.TryParse(hdnStdItemID.Value, out itemId);
        //        else
        //            itemId = ObjItemDetails.ItemID.ToInt32_2();

        //        StringBuilder itemXML = new StringBuilder();
        //        itemXML.Append(&quot;&lt;XMLRoot&gt;&lt;Item&gt;&quot;);
        //        itemXML.AppendFormat(&quot;&lt;ItemID&gt;{0}&lt;/ItemID&gt;&quot;, itemId);
        //        itemXML.AppendFormat(&quot;&lt;ContainerID&gt;{0}&lt;/ContainerID&gt;&quot;, dic[&quot;ContainerID&quot;]);
        //        itemXML.AppendFormat(&quot;&lt;StandardItemNo&gt;{0}&lt;/StandardItemNo&gt;&quot;,
        //            UIHelper.ReplaceXMLCharEntities(dic[&quot;StandardItemNo&quot;].Trim()));
        //        itemXML.AppendFormat(&quot;&lt;Description&gt;{0}&lt;/Description&gt;&quot;,
        //            UIHelper.ReplaceXMLCharEntities(dic[&quot;Description&quot;].Trim()));
        //        itemXML.AppendFormat(&quot;&lt;ModuleID&gt;{0}&lt;/ModuleID&gt;&quot;, ObjItemDetails.ModuleID);
        //        itemXML.AppendFormat(&quot;&lt;ParentInstanceID&gt;{0}&lt;/ParentInstanceID&gt;&quot;, ObjItemDetails.ParentInstanceID);
        //        itemXML.Append(&quot;&lt;/Item&gt;&lt;/XMLRoot&gt;&quot;);

        //        //DataTable dtResult = ItemManager.Instance.ValidateItemSave(itemXML.ToString2(), dic[&quot;StandardItemNo&quot;].Trim(), dic[&quot;Description&quot;].Trim());
        //        DataTable dtResult = ItemManager.Instance.ValidateItemSave(itemXML.ToString2());

        //        if (dtResult.Rows[0][0].ToString2() == &quot;1&quot; || dtResult.Rows[0][0].ToString2() == &quot;2&quot;)
        //        {
        //            callbackResult = &quot;Type=&quot; + dic[&quot;Type&quot;] + &quot;]&amp;[Result=confirmDuplicateItemSave]&amp;[Message=&quot; +
        //                             dtResult.Rows[0][0].ToString2();
        //        }
        //        else
        //            callbackResult = &quot;Type=&quot; + dic[&quot;Type&quot;];
        //    }
        //    else
        //    {
        //        callbackResult = &quot;&quot;; // DO NOTHING ON THE CLIENT SIDE
        //    }
        //}

        //public override string GetCallbackResult()
        //{
        //    return callbackResult;
        //}

        #endregion

        public void HandleInjectionAfterSave(object model, string parentFormInstanceId)
        {
        }

        public bool SkipDefaultXMLInjectionSave { get; set; }

        public List&lt;string&gt; BudgetModuleComponent
        {
            get
            {
                if (_budgetModuleComponent == null)
                    _budgetModuleComponent = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_BDGMGMT);
                return _budgetModuleComponent;
            }
        }
    }

    public enum ItemDivEnums
    {
        ItemPicker = 1,
        CreateItem = 2,
        RateAnalysis = 3,
        SubItems = 4,
        GroupHierarchyPicker = 5,
        ItemActivity = 6,
        Components = 7
    }

    [Authorize]
    public class ItemPageController : ApiController
    {
        [HttpGet]
        public HttpResponseMessage Get(string action, string StandardItemNo, string Description, string Type, int ContainerID, int ItemID, string ModuleID, int ParentInstanceID)
        {
            string callbackResult = string.Empty;
            if (action.ToLower().Equals(&quot;validatesaveitem&quot;))
            {
                StringBuilder itemXML = new StringBuilder();
                itemXML.Append(&quot;&lt;XMLRoot&gt;&lt;Item&gt;&quot;);
                itemXML.AppendFormat(&quot;&lt;ItemID&gt;{0}&lt;/ItemID&gt;&quot;, ItemID);
                itemXML.AppendFormat(&quot;&lt;ContainerID&gt;{0}&lt;/ContainerID&gt;&quot;, ContainerID);
                itemXML.AppendFormat(&quot;&lt;StandardItemNo&gt;{0}&lt;/StandardItemNo&gt;&quot;,
                    UIHelper.ReplaceXMLCharEntities(StandardItemNo.Trim()));
                itemXML.AppendFormat(&quot;&lt;Description&gt;{0}&lt;/Description&gt;&quot;,
                    UIHelper.ReplaceXMLCharEntities(Description.Trim()));
                itemXML.AppendFormat(&quot;&lt;ModuleID&gt;{0}&lt;/ModuleID&gt;&quot;, ModuleID);
                itemXML.AppendFormat(&quot;&lt;ParentInstanceID&gt;{0}&lt;/ParentInstanceID&gt;&quot;, ParentInstanceID);
                itemXML.Append(&quot;&lt;/Item&gt;&lt;/XMLRoot&gt;&quot;);

                //DataTable dtResult = ItemManager.Instance.ValidateItemSave(itemXML.ToString2(), dic[&quot;StandardItemNo&quot;].Trim(), dic[&quot;Description&quot;].Trim());
                DataTable dtResult = ItemManager.Instance.ValidateItemSave(itemXML.ToString2());

                if (dtResult.Rows[0][0].ToString2() == &quot;1&quot; || dtResult.Rows[0][0].ToString2() == &quot;2&quot;)
                {
                    callbackResult = &quot;Type=&quot; + Type + &quot;]&amp;[Result=confirmDuplicateItemSave]&amp;[Message=&quot; +
                                     dtResult.Rows[0][0].ToString2();
                }
                else
                    callbackResult = &quot;Type=&quot; + Type;
            }
            else
            {
                callbackResult = &quot;&quot;; // DO NOTHING ON THE CLIENT SIDE
            }

            var response = Request.CreateResponse(HttpStatusCode.OK);
            response.Content = new StringContent(callbackResult, Encoding.UTF8);
            return response;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[46,9,46,60,1],[47,9,47,77,1],[51,9,51,55,1],[58,9,58,46,1],[59,9,59,62,1],[60,9,60,60,1],[62,9,62,109,1],[66,13,66,14,0],[67,17,67,127,0],[68,13,68,14,0],[74,9,74,114,1],[76,40,76,44,0],[76,45,76,49,0],[81,13,81,14,1],[83,17,83,89,1],[84,17,84,84,1],[85,17,85,44,1],[86,17,86,71,1],[87,17,87,77,1],[88,17,88,77,1],[89,17,89,83,1],[90,17,90,87,1],[91,17,91,53,1],[92,17,92,45,1],[93,17,93,46,1],[94,17,94,104,1],[97,17,97,89,1],[98,17,98,85,1],[100,17,100,72,1],[101,17,101,74,1],[102,17,102,70,1],[103,17,103,78,1],[104,17,104,67,1],[105,17,105,63,1],[106,21,106,74,0],[107,17,107,47,1],[108,17,108,71,1],[109,17,109,77,1],[110,17,110,85,1],[111,17,111,78,1],[112,17,112,76,1],[113,17,113,92,1],[114,17,114,40,1],[115,17,115,46,1],[116,17,116,70,1],[117,17,118,97,1],[120,17,120,85,1],[122,17,123,64,1],[124,17,124,18,1],[125,21,125,84,1],[126,21,126,78,1],[127,17,127,18,1],[128,22,128,101,1],[130,17,130,18,1],[131,21,131,59,1],[132,21,132,64,1],[134,21,134,84,1],[135,21,135,54,1],[136,21,136,22,1],[137,25,137,54,1],[138,25,138,66,1],[139,21,139,22,1],[141,21,141,22,0],[142,25,142,54,0],[143,25,143,67,0],[144,21,144,22,0],[146,21,146,49,1],[147,21,147,49,1],[148,21,148,55,1],[149,21,149,73,1],[150,17,150,18,1],[152,17,152,18,1],[153,21,153,75,1],[154,21,154,69,1],[155,17,155,18,1],[157,17,157,67,1],[158,17,158,18,1],[159,21,159,64,1],[160,21,160,64,1],[161,17,161,18,1],[162,17,162,65,1],[163,21,163,64,1],[164,17,164,94,1],[165,17,165,109,1],[166,17,166,70,1],[167,17,169,36,1],[171,17,171,57,1],[172,17,172,18,1],[174,21,174,49,1],[175,21,175,54,1],[176,17,176,18,1],[177,13,177,14,1],[181,9,181,10,1],[182,13,182,46,1],[183,13,183,75,1],[184,9,184,10,1],[187,9,187,10,1],[188,13,190,88,1],[191,13,191,14,1],[192,17,192,39,1],[193,17,193,18,0],[194,21,194,48,0],[196,21,196,43,0],[197,21,197,22,0],[199,25,201,78,0],[202,21,202,22,0],[203,17,203,18,0],[205,17,205,66,1],[207,17,207,33,1],[208,17,208,62,1],[209,17,209,18,1],[210,21,210,65,1],[211,17,211,18,1],[213,17,213,35,1],[214,17,214,64,1],[215,17,215,18,1],[216,21,216,69,1],[217,17,217,18,1],[219,17,219,93,1],[222,17,222,58,1],[223,9,223,10,1],[226,9,226,10,1],[227,13,227,31,1],[228,13,228,61,1],[229,13,229,14,0],[230,17,232,68,0],[233,13,233,14,0],[235,13,235,40,1],[236,13,236,35,1],[237,13,237,14,0],[239,17,241,74,0],[243,17,243,24,0],[246,13,246,43,1],[247,9,247,10,1],[250,9,250,10,1],[251,13,251,54,1],[252,13,256,38,1],[257,13,257,29,1],[258,9,258,10,1],[261,9,261,10,1],[262,13,262,40,1],[263,13,263,42,1],[264,13,264,38,1],[265,13,265,58,1],[266,13,266,14,1],[268,17,268,65,1],[269,21,269,56,1],[270,13,270,14,1],[271,13,271,38,1],[273,13,273,57,1],[274,17,274,113,1],[278,13,283,112,1],[284,13,284,14,1],[285,17,285,117,1],[286,17,286,69,1],[288,17,288,64,1],[289,17,289,66,1],[290,17,290,60,1],[291,17,291,54,1],[292,17,292,57,1],[293,17,293,64,1],[294,17,294,18,1],[295,21,295,61,1],[296,21,296,60,1],[297,21,297,78,1],[298,21,298,78,1],[299,21,299,69,1],[300,17,300,18,1],[302,17,302,114,1],[303,17,303,18,0],[304,21,304,50,0],[305,17,305,18,0],[306,13,306,14,1],[308,13,308,14,1],[309,17,310,116,1],[311,17,311,69,1],[312,17,312,62,1],[314,17,314,171,1],[315,17,315,18,1],[316,21,316,64,1],[317,21,317,58,1],[318,17,318,18,1],[319,13,319,14,1],[322,13,322,41,1],[324,13,324,31,1],[328,13,328,74,1],[333,13,337,33,1],[339,13,339,66,1],[340,13,340,60,1],[341,13,341,50,1],[342,13,342,14,1],[343,17,343,58,1],[344,17,344,76,1],[345,13,345,14,1],[347,13,347,95,1],[348,13,348,14,0],[349,17,349,56,0],[350,17,350,100,0],[351,13,351,14,0],[353,17,353,84,1],[359,13,359,47,1],[360,13,360,58,1],[361,13,361,64,1],[362,13,362,70,1],[363,13,363,56,1],[364,13,364,56,1],[365,13,365,72,1],[371,13,371,39,1],[372,13,372,55,1],[373,13,373,67,1],[374,13,374,61,1],[375,13,375,67,1],[376,13,377,62,1],[378,13,378,14,1],[379,17,379,51,1],[380,13,380,14,1],[381,18,382,67,1],[383,13,383,14,1],[384,17,384,51,1],[385,13,385,14,1],[386,13,386,53,1],[387,13,387,52,1],[393,13,393,51,1],[394,13,394,62,1],[395,13,395,68,1],[396,13,396,74,1],[397,13,397,60,1],[403,13,403,46,1],[406,13,406,53,1],[407,13,407,75,1],[408,13,408,60,1],[414,13,414,41,1],[415,13,415,54,1],[416,13,416,60,1],[417,13,417,66,1],[418,13,418,52,1],[422,13,422,68,1],[423,13,423,73,1],[424,13,424,68,1],[425,13,425,73,1],[426,13,426,58,1],[427,13,427,63,1],[428,13,428,66,1],[429,13,429,71,1],[432,13,432,44,1],[433,13,433,64,1],[434,13,435,114,1],[436,13,436,14,1],[437,17,437,82,1],[438,13,438,14,1],[439,13,439,35,1],[442,13,450,67,1],[454,13,457,83,1],[458,13,458,30,1],[459,13,459,14,1],[460,17,460,88,1],[461,17,461,46,1],[462,13,462,14,1],[464,13,464,28,1],[465,9,465,10,1],[468,9,468,10,1],[471,13,471,59,1],[472,9,472,10,1],[475,9,475,10,0],[476,13,476,117,0],[477,17,477,52,0],[478,13,480,92,0],[481,13,481,14,0],[482,17,482,50,0],[483,17,483,42,0],[484,17,484,57,0],[485,17,485,105,0],[486,13,486,14,0],[487,9,487,10,0],[490,9,490,10,0],[491,13,491,121,0],[492,17,492,52,0],[494,13,496,92,0],[497,13,497,14,0],[498,17,498,52,0],[499,17,499,88,0],[500,17,500,57,0],[501,17,501,80,0],[502,17,502,92,0],[503,17,503,84,0],[504,17,504,82,0],[505,17,505,100,0],[506,13,506,14,0],[507,9,507,10,0],[510,9,510,10,1],[511,13,511,46,1],[512,13,512,107,1],[513,13,513,53,1],[514,13,514,59,1],[515,13,515,65,1],[518,13,518,56,1],[519,9,519,10,1],[522,9,522,10,0],[523,13,525,67,0],[526,9,526,10,0],[529,9,529,10,1],[530,13,530,46,1],[531,13,531,120,1],[532,9,532,10,1],[535,9,535,10,1],[536,13,536,60,1],[544,13,544,33,1],[545,13,545,14,1],[546,17,546,45,1],[547,17,547,66,1],[548,21,548,49,1],[550,17,550,52,1],[551,17,551,85,1],[552,17,552,18,1],[553,21,553,61,1],[554,21,554,103,1],[555,17,555,18,1],[556,13,556,14,1],[558,17,558,84,0],[559,9,559,10,1],[562,9,562,10,1],[563,13,563,71,1],[564,13,564,45,1],[565,13,565,86,1],[566,13,566,58,1],[567,13,567,14,1],[568,17,570,75,1],[571,17,571,18,1],[572,21,572,40,1],[576,21,576,53,1],[577,17,577,18,1],[578,17,578,46,1],[579,21,579,50,1],[581,17,581,44,1],[583,17,583,43,1],[584,17,584,71,1],[586,17,586,80,1],[587,17,587,51,1],[588,17,588,18,0],[589,21,589,49,0],[590,21,590,65,0],[591,17,591,18,0],[593,17,593,62,1],[594,13,594,14,1],[595,18,595,65,1],[596,17,596,47,0],[601,13,601,98,1],[602,13,602,97,1],[603,13,603,56,1],[604,13,604,61,1],[605,13,605,77,1],[606,13,606,52,1],[607,13,607,43,1],[608,13,608,61,1],[609,13,609,40,1],[610,13,611,66,1],[612,13,612,14,1],[613,17,613,67,1],[614,17,614,83,1],[615,17,615,111,1],[616,17,616,18,0],[617,21,617,55,0],[618,21,618,56,0],[619,21,619,61,0],[620,17,620,18,0],[622,17,622,18,1],[623,21,623,54,1],[624,21,624,55,1],[625,21,625,90,1],[626,17,626,18,1],[627,13,627,14,1],[628,13,628,64,1],[629,17,629,72,1],[631,13,631,14,0],[632,17,635,37,0],[636,17,636,35,0],[637,17,637,18,0],[638,21,638,96,0],[639,21,639,48,0],[640,21,640,47,0],[641,17,641,18,0],[642,13,642,14,0],[644,13,644,42,1],[645,13,645,71,1],[646,13,646,14,1],[647,17,647,79,1],[648,13,648,14,1],[650,13,650,14,0],[651,17,651,81,0],[652,17,652,45,0],[653,13,653,14,0],[654,13,654,72,1],[655,13,655,14,0],[656,17,656,48,0],[657,17,657,80,0],[658,13,658,14,0],[659,18,664,117,1],[665,13,665,14,1],[666,17,666,48,1],[667,17,667,68,1],[668,17,668,18,1],[669,21,669,76,1],[670,17,670,18,1],[671,13,671,14,1],[672,13,672,46,1],[673,13,673,90,1],[674,17,674,98,0],[675,13,675,104,1],[676,13,676,14,1],[677,17,677,76,1],[678,13,678,14,1],[680,13,680,41,1],[681,17,681,65,1],[683,13,683,41,1],[684,17,687,50,1],[689,13,689,46,1],[694,13,694,49,1],[695,13,695,53,1],[697,13,697,120,1],[698,13,698,113,1],[701,13,701,89,1],[702,13,702,71,1],[705,13,705,82,1],[706,13,706,71,1],[708,13,708,98,1],[709,13,709,93,1],[710,13,710,33,1],[711,13,711,58,1],[712,17,712,33,1],[714,13,714,109,1],[715,17,715,33,0],[716,13,716,79,1],[717,13,717,25,1],[718,17,719,55,0],[720,13,720,46,1],[721,13,723,32,1],[724,13,724,25,1],[725,17,726,55,0],[727,13,727,47,1],[729,13,729,79,1],[730,13,730,25,1],[731,17,732,55,0],[733,13,733,50,1],[735,13,735,76,1],[736,13,736,56,1],[737,13,737,103,1],[739,13,739,88,1],[740,13,740,82,1],[741,13,741,97,1],[743,13,744,107,1],[745,17,747,107,1],[749,17,749,56,0],[750,13,752,66,1],[754,13,757,80,1],[758,13,758,25,1],[759,17,760,55,0],[761,13,762,45,1],[764,13,764,77,1],[765,13,766,68,1],[767,17,767,45,0],[768,13,768,42,1],[769,13,771,58,1],[773,13,773,83,1],[774,13,774,14,1],[775,17,775,55,1],[776,17,776,31,1],[777,17,777,18,1],[778,21,779,119,1],[780,21,780,22,1],[781,25,781,66,1],[782,25,782,66,1],[783,25,783,71,1],[784,21,784,22,1],[785,26,785,64,1],[786,21,786,22,1],[788,25,788,73,1],[789,25,789,105,1],[790,25,790,81,1],[791,25,791,26,0],[793,29,793,143,0],[794,25,794,26,0],[796,25,796,26,1],[797,29,797,112,1],[798,29,798,76,1],[799,33,799,118,1],[800,25,800,26,1],[801,21,801,22,1],[802,17,802,18,1],[803,13,803,14,1],[804,13,804,107,1],[805,13,805,53,1],[806,13,806,54,1],[807,13,807,14,1],[808,17,808,100,1],[809,17,809,101,1],[810,13,810,14,1],[812,13,812,48,1],[813,17,813,42,1],[815,13,815,58,1],[816,9,816,10,1],[819,9,819,10,0],[820,13,820,68,0],[828,13,828,20,0],[828,22,828,34,0],[828,35,828,37,0],[828,38,828,43,0],[829,13,829,14,0],[830,17,830,52,0],[831,13,831,14,0],[832,13,832,48,0],[833,17,833,42,0],[834,9,834,10,0],[837,9,837,10,1],[838,13,838,29,1],[841,13,841,64,1],[842,13,842,14,1],[843,17,843,73,1],[844,17,844,78,1],[845,13,845,14,1],[847,13,847,47,1],[848,13,848,40,1],[849,13,849,46,1],[850,13,850,82,1],[851,13,851,34,1],[852,13,852,52,1],[853,13,853,14,1],[854,17,854,55,1],[855,17,855,60,1],[857,17,857,50,1],[858,17,858,18,1],[859,21,859,62,1],[860,21,860,62,1],[861,17,861,18,1],[862,22,862,89,0],[863,21,863,63,0],[865,17,865,45,1],[866,13,866,14,1],[868,13,868,14,0],[869,17,869,58,0],[870,17,870,44,0],[871,13,871,14,0],[872,9,872,10,1],[875,9,875,10,1],[876,13,876,29,1],[877,17,879,54,1],[881,17,881,42,1],[882,9,882,10,1],[885,9,885,10,1],[886,13,886,55,1],[887,13,887,14,1],[888,17,888,87,1],[889,17,889,36,1],[890,17,890,18,1],[891,21,891,49,1],[892,21,892,65,1],[893,17,893,18,1],[895,17,895,18,1],[896,21,898,92,1],[899,21,899,22,0],[901,25,901,85,0],[902,25,902,73,0],[903,25,903,26,0],[904,29,904,77,0],[906,29,906,98,0],[907,29,907,30,0],[908,33,908,77,0],[909,33,911,44,0],[912,29,912,30,0],[913,25,913,26,0],[915,25,915,26,0],[916,29,916,59,0],[917,29,917,78,0],[918,25,918,26,0],[919,21,919,22,0],[920,17,920,18,1],[921,17,923,78,1],[924,13,924,14,1],[925,9,925,10,1],[928,9,928,10,1],[929,13,929,33,1],[930,13,930,55,1],[931,13,931,14,1],[932,17,932,74,1],[933,17,934,49,1],[935,13,935,14,1],[936,9,936,10,1],[939,9,939,10,0],[940,13,940,54,0],[941,13,941,45,0],[942,13,942,121,0],[943,13,943,66,0],[944,13,944,95,0],[945,13,945,91,0],[946,13,946,49,0],[947,17,947,111,0],[948,13,948,47,0],[949,17,949,107,0],[950,13,950,95,0],[951,13,952,124,0],[953,13,953,80,0],[954,13,954,56,0],[955,17,955,55,0],[958,13,958,36,0],[960,9,960,10,0],[963,9,963,10,1],[964,13,964,56,1],[965,13,965,35,1],[966,13,966,34,1],[968,13,968,54,1],[969,17,969,35,1],[971,17,971,91,1],[973,13,973,64,1],[974,13,974,67,1],[975,13,975,55,1],[976,13,976,78,1],[977,13,977,50,1],[978,17,978,51,1],[979,13,979,46,1],[980,13,980,109,1],[981,13,981,36,1],[982,13,982,118,1],[983,13,983,14,1],[984,17,984,58,1],[985,13,985,14,1],[986,13,986,278,1],[987,13,987,89,1],[988,13,988,50,1],[989,13,989,93,1],[990,13,990,14,1],[991,17,991,100,1],[992,17,992,61,1],[993,13,993,14,1],[995,13,995,14,0],[996,17,996,46,0],[997,13,997,14,0],[999,13,999,42,1],[1000,13,1000,14,1],[1001,17,1001,104,1],[1002,17,1002,52,1],[1003,17,1003,57,1],[1004,21,1004,113,1],[1005,17,1005,47,1],[1006,21,1006,69,0],[1007,13,1007,14,1],[1009,13,1009,79,1],[1010,13,1010,83,1],[1011,13,1011,57,1],[1012,13,1012,61,1],[1013,13,1013,58,1],[1014,13,1014,55,1],[1015,13,1015,59,1],[1016,13,1016,44,1],[1017,17,1019,25,0],[1020,18,1020,93,1],[1021,13,1021,14,1],[1022,17,1022,73,1],[1023,13,1023,14,1],[1025,13,1025,14,1],[1026,17,1026,83,1],[1027,17,1027,18,1],[1028,21,1028,77,1],[1029,17,1029,18,1],[1031,17,1031,18,1],[1032,21,1032,119,1],[1033,17,1033,18,1],[1034,13,1034,14,1],[1035,13,1035,42,1],[1036,13,1037,57,1],[1038,13,1038,14,1],[1039,17,1039,101,1],[1040,13,1040,14,1],[1042,13,1042,140,1],[1044,13,1044,44,1],[1045,17,1045,59,1],[1047,13,1047,54,1],[1048,17,1048,74,0],[1050,17,1050,37,1],[1053,13,1053,88,1],[1055,13,1055,71,1],[1057,13,1057,42,1],[1058,13,1058,14,0],[1059,17,1059,99,0],[1060,17,1060,18,0],[1061,21,1061,107,0],[1062,21,1062,68,0],[1063,17,1063,18,0],[1065,17,1065,18,0],[1066,21,1066,52,0],[1067,17,1067,18,0],[1068,13,1068,14,0],[1071,13,1071,43,1],[1072,13,1072,14,1],[1073,17,1073,106,1],[1074,17,1074,79,1],[1075,17,1077,114,1],[1078,13,1078,14,1],[1080,13,1080,62,1],[1082,13,1082,101,1],[1083,13,1083,92,1],[1085,13,1085,24,1],[1086,9,1086,10,1],[1089,9,1089,10,0],[1090,13,1090,63,0],[1091,13,1091,59,0],[1092,13,1092,57,0],[1093,13,1093,112,0],[1094,13,1094,46,0],[1095,17,1095,79,0],[1096,13,1096,44,0],[1097,17,1097,75,0],[1098,9,1098,10,0],[1101,9,1101,10,1],[1102,13,1102,61,1],[1103,13,1103,52,1],[1104,13,1104,41,1],[1105,13,1105,44,1],[1106,13,1106,14,1],[1107,17,1107,64,1],[1108,13,1108,14,1],[1109,13,1109,35,1],[1110,13,1110,47,1],[1111,13,1111,14,1],[1112,17,1112,61,1],[1113,13,1113,14,1],[1114,13,1114,35,1],[1115,13,1115,42,1],[1116,13,1116,14,1],[1117,17,1117,56,1],[1118,13,1118,14,1],[1119,13,1119,43,1],[1120,13,1120,50,1],[1121,13,1121,63,1],[1122,13,1122,61,1],[1124,13,1124,103,1],[1125,13,1125,14,0],[1126,17,1126,58,0],[1127,13,1127,14,0],[1129,13,1129,14,1],[1130,17,1130,68,1],[1131,13,1131,14,1],[1133,13,1133,67,1],[1135,13,1135,75,1],[1136,13,1136,137,1],[1138,13,1138,68,1],[1140,13,1140,51,1],[1141,13,1141,14,1],[1142,17,1142,75,1],[1144,17,1144,96,1],[1145,17,1145,49,1],[1146,17,1146,18,1],[1147,21,1147,71,1],[1148,21,1148,78,1],[1149,17,1149,18,1],[1150,13,1150,14,1],[1152,13,1152,76,1],[1153,13,1153,80,1],[1155,13,1155,105,1],[1156,13,1156,14,1],[1157,17,1157,81,1],[1158,13,1158,14,1],[1160,17,1160,56,0],[1162,13,1163,91,1],[1164,13,1164,63,1],[1165,13,1165,78,1],[1166,13,1166,103,1],[1168,13,1168,88,1],[1169,13,1169,60,1],[1170,13,1170,97,1],[1172,13,1174,58,1],[1175,13,1175,56,1],[1176,13,1176,61,1],[1177,13,1177,44,1],[1178,17,1178,103,1],[1179,13,1179,46,1],[1180,17,1180,79,1],[1181,13,1181,43,1],[1182,17,1182,72,1],[1183,13,1183,46,1],[1184,13,1184,14,1],[1185,17,1186,82,1],[1187,13,1187,14,1],[1188,13,1188,50,1],[1189,17,1189,80,1],[1190,13,1190,68,1],[1191,13,1191,45,1],[1193,13,1193,151,1],[1194,13,1194,14,0],[1195,17,1195,51,0],[1196,17,1196,52,0],[1197,17,1197,57,0],[1198,13,1198,14,0],[1199,13,1199,43,1],[1200,17,1200,78,1],[1202,13,1202,44,1],[1203,17,1203,62,1],[1205,13,1205,42,1],[1206,13,1206,14,0],[1207,17,1207,74,0],[1208,13,1208,14,0],[1211,13,1211,55,1],[1212,9,1212,10,1],[1215,9,1215,10,1],[1216,13,1216,43,1],[1217,13,1217,14,1],[1218,17,1218,30,1],[1221,25,1221,62,0],[1222,25,1222,58,0],[1223,25,1223,64,0],[1224,25,1224,31,0],[1228,25,1228,82,1],[1229,25,1229,81,1],[1231,25,1231,103,1],[1233,25,1233,149,1],[1235,25,1235,71,1],[1236,25,1236,73,1],[1238,25,1238,58,1],[1239,29,1239,55,1],[1241,25,1241,63,1],[1242,25,1242,54,1],[1244,25,1247,89,1],[1249,25,1249,44,1],[1250,29,1250,71,1],[1252,29,1252,70,0],[1254,25,1254,31,1],[1256,13,1256,14,1],[1257,9,1257,10,1],[1262,13,1262,14,0],[1263,17,1266,94,0],[1267,13,1267,14,0],[1271,9,1271,10,1],[1272,13,1272,89,1],[1273,13,1273,60,1],[1274,13,1274,14,1],[1275,17,1275,51,1],[1276,17,1276,18,0],[1277,21,1277,34,0],[1279,13,1279,14,1],[1281,13,1281,25,1],[1282,9,1282,10,1],[1285,9,1285,10,0],[1286,13,1290,92,0],[1291,9,1291,10,0],[1293,9,1293,10,0],[1294,13,1294,94,0],[1295,13,1295,96,0],[1297,13,1297,71,0],[1298,13,1298,20,0],[1298,22,1298,34,0],[1298,35,1298,37,0],[1298,38,1298,63,0],[1299,13,1299,14,0],[1300,17,1300,76,0],[1301,17,1301,51,0],[1302,13,1302,14,0],[1303,13,1303,77,0],[1305,13,1305,59,0],[1306,13,1306,20,0],[1306,22,1306,38,0],[1306,39,1306,41,0],[1306,42,1306,53,0],[1307,13,1307,14,0],[1308,17,1308,68,0],[1309,17,1309,39,0],[1310,13,1310,14,0],[1311,13,1311,54,0],[1313,13,1313,63,0],[1314,13,1314,20,0],[1314,22,1314,34,0],[1314,35,1314,37,0],[1314,38,1314,52,0],[1315,13,1315,14,0],[1316,17,1316,89,0],[1317,17,1317,43,0],[1318,13,1318,14,0],[1320,13,1320,61,0],[1321,13,1321,93,0],[1322,9,1322,10,0],[1325,9,1325,10,1],[1327,13,1327,38,1],[1329,13,1329,49,1],[1330,13,1330,14,0],[1331,17,1331,38,0],[1332,17,1332,86,0],[1333,17,1333,93,0],[1334,17,1334,84,0],[1335,17,1335,91,0],[1336,17,1336,92,0],[1337,17,1337,99,0],[1338,17,1338,90,0],[1339,17,1339,97,0],[1340,17,1340,68,0],[1341,17,1341,66,0],[1342,17,1342,74,0],[1343,17,1343,72,0],[1344,13,1344,14,0],[1346,13,1346,48,1],[1347,17,1347,53,1],[1349,17,1349,52,0],[1352,13,1352,32,1],[1353,13,1353,89,1],[1354,13,1354,100,1],[1355,13,1355,95,1],[1356,13,1356,99,1],[1357,13,1357,96,1],[1358,13,1358,93,1],[1360,13,1360,106,1],[1362,13,1362,51,1],[1363,13,1363,52,1],[1364,17,1364,38,1],[1365,13,1365,94,1],[1367,13,1367,55,1],[1368,17,1368,46,1],[1369,18,1369,60,1],[1370,17,1370,46,1],[1372,13,1372,29,1],[1373,13,1373,14,1],[1374,17,1374,51,1],[1375,17,1375,52,1],[1376,21,1376,69,0],[1378,17,1378,56,1],[1379,17,1379,18,0],[1380,21,1380,44,0],[1381,21,1381,51,0],[1382,17,1382,18,0],[1384,17,1384,59,1],[1385,17,1385,120,1],[1386,17,1386,113,1],[1387,17,1387,18,1],[1388,21,1388,71,1],[1389,17,1389,18,1],[1391,17,1391,18,0],[1392,21,1392,70,0],[1393,17,1393,18,0],[1394,17,1394,57,1],[1396,17,1396,60,1],[1398,17,1398,65,1],[1399,21,1399,59,1],[1401,21,1401,59,1],[1403,17,1403,52,1],[1404,21,1404,57,0],[1406,17,1406,74,1],[1407,17,1407,18,1],[1408,21,1408,71,1],[1409,17,1409,18,1],[1411,17,1412,53,1],[1413,17,1413,18,1],[1414,21,1414,76,1],[1415,21,1416,53,1],[1417,21,1417,96,1],[1419,17,1419,18,1],[1420,17,1420,34,1],[1421,17,1421,57,1],[1422,17,1422,51,1],[1423,17,1423,18,1],[1424,21,1424,45,1],[1425,21,1425,80,1],[1426,21,1426,38,1],[1427,21,1427,81,1],[1428,25,1428,65,0],[1429,17,1429,18,1],[1430,22,1430,56,1],[1431,17,1431,18,1],[1432,21,1432,45,1],[1433,21,1433,37,1],[1434,21,1434,50,1],[1436,21,1436,64,1],[1437,21,1437,58,1],[1438,21,1438,61,1],[1439,21,1439,47,1],[1439,48,1439,78,1],[1440,17,1440,18,1],[1442,17,1442,18,1],[1443,21,1444,70,1],[1445,21,1445,22,0],[1446,25,1446,71,0],[1447,25,1447,66,0],[1448,25,1448,71,0],[1449,25,1449,60,0],[1450,29,1450,81,0],[1451,21,1451,22,0],[1452,21,1452,42,1],[1453,21,1453,38,1],[1454,17,1454,18,1],[1456,17,1456,109,1],[1457,17,1457,57,1],[1459,17,1460,53,1],[1461,21,1461,46,1],[1462,17,1462,89,1],[1463,17,1463,18,1],[1465,21,1465,81,1],[1466,21,1466,69,1],[1467,21,1467,22,1],[1468,25,1468,114,1],[1469,25,1469,26,0],[1470,29,1470,70,0],[1471,29,1471,89,0],[1472,29,1472,85,0],[1473,25,1473,26,0],[1475,29,1475,65,1],[1477,25,1477,73,1],[1479,25,1479,59,1],[1480,25,1480,26,1],[1481,29,1481,61,1],[1483,29,1483,62,1],[1484,33,1484,52,0],[1485,29,1485,58,1],[1486,33,1486,62,1],[1487,25,1487,26,1],[1488,25,1488,50,1],[1490,25,1490,45,1],[1491,25,1491,26,0],[1492,29,1492,101,0],[1493,29,1493,77,0],[1494,25,1494,26,0],[1495,21,1495,22,1],[1497,21,1497,71,1],[1498,21,1498,22,0],[1499,25,1499,65,0],[1500,25,1500,26,0],[1501,29,1501,60,0],[1502,29,1502,66,0],[1503,29,1503,53,0],[1504,25,1504,26,0],[1505,30,1505,70,0],[1506,25,1506,26,0],[1507,29,1507,91,0],[1508,29,1508,57,0],[1509,29,1509,64,0],[1510,25,1510,26,0],[1512,25,1512,26,0],[1513,29,1513,67,0],[1514,29,1514,54,0],[1515,29,1515,64,0],[1516,25,1516,26,0],[1517,21,1517,22,0],[1518,21,1518,61,1],[1519,17,1519,18,1],[1520,17,1520,37,1],[1521,17,1521,18,0],[1522,21,1522,47,0],[1523,21,1523,43,0],[1524,17,1524,18,0],[1525,17,1525,31,1],[1526,17,1526,38,1],[1527,17,1529,114,1],[1530,17,1533,84,1],[1534,17,1534,97,1],[1535,17,1535,92,1],[1537,17,1537,61,1],[1538,17,1538,59,1],[1539,17,1539,76,1],[1541,17,1541,115,1],[1542,17,1542,109,1],[1543,17,1543,18,1],[1544,21,1544,55,1],[1545,17,1545,18,1],[1546,17,1546,121,1],[1547,17,1547,18,1],[1548,21,1548,56,1],[1549,17,1549,18,1],[1550,17,1551,75,1],[1552,17,1552,18,0],[1553,21,1553,84,0],[1554,21,1554,49,0],[1555,21,1555,55,0],[1556,17,1556,18,0],[1557,13,1557,14,1],[1559,13,1559,45,1],[1561,13,1562,70,1],[1563,13,1563,14,0],[1564,17,1564,75,0],[1565,17,1565,53,0],[1566,21,1566,73,0],[1567,17,1567,69,0],[1568,13,1568,14,0],[1570,13,1570,48,1],[1571,13,1571,14,1],[1572,17,1574,57,1],[1575,17,1575,113,1],[1576,17,1576,117,1],[1578,17,1578,91,1],[1579,21,1579,117,1],[1580,17,1580,85,1],[1581,13,1581,14,1],[1585,13,1585,48,1],[1586,13,1586,14,0],[1587,17,1587,42,0],[1588,17,1588,57,0],[1589,13,1589,14,0],[1591,13,1593,99,1],[1594,13,1594,14,1],[1595,17,1595,61,1],[1596,21,1596,49,1],[1597,13,1597,14,1],[1602,13,1602,40,1],[1604,13,1604,79,1],[1605,13,1605,14,0],[1606,17,1606,71,0],[1607,21,1607,115,0],[1608,22,1611,104,0],[1612,21,1612,116,0],[1614,21,1614,116,0],[1616,17,1616,57,0],[1617,13,1617,14,0],[1619,13,1619,14,1],[1620,17,1620,69,1],[1621,13,1621,14,1],[1623,13,1623,32,1],[1626,13,1626,63,1],[1627,17,1627,60,1],[1629,13,1629,72,1],[1631,13,1632,86,1],[1633,13,1633,14,0],[1634,17,1634,75,0],[1635,13,1635,14,0],[1637,13,1637,106,1],[1637,107,1637,108,1],[1637,109,1637,137,1],[1637,138,1637,166,1],[1637,167,1637,168,1],[1640,13,1640,43,1],[1641,13,1641,14,1],[1643,17,1643,131,1],[1645,17,1645,65,1],[1646,21,1646,63,1],[1648,21,1648,62,1],[1650,17,1650,79,1],[1652,17,1652,134,1],[1653,17,1653,76,1],[1654,17,1654,74,1],[1656,17,1656,63,1],[1657,17,1657,61,1],[1659,17,1659,132,1],[1660,17,1660,18,1],[1661,21,1661,138,1],[1662,21,1662,67,1],[1663,21,1663,69,1],[1664,21,1664,59,1],[1665,21,1665,50,1],[1666,21,1666,63,1],[1667,17,1667,18,1],[1668,13,1668,14,1],[1669,9,1669,10,1],[1672,9,1672,10,1],[1673,13,1673,54,1],[1674,13,1674,73,1],[1675,13,1675,88,1],[1676,17,1676,74,1],[1678,18,1678,57,0],[1679,17,1679,77,0],[1683,13,1683,70,1],[1685,13,1685,69,1],[1686,13,1686,70,1],[1687,13,1687,75,1],[1688,13,1688,68,1],[1689,13,1689,73,1],[1690,13,1690,81,1],[1691,13,1691,72,1],[1692,13,1692,79,1],[1694,13,1694,66,1],[1695,13,1695,69,1],[1696,13,1696,75,1],[1697,13,1697,71,1],[1698,13,1698,83,1],[1699,13,1699,89,1],[1700,13,1700,109,1],[1701,13,1701,37,1],[1702,13,1702,14,1],[1703,17,1703,42,1],[1704,17,1704,45,1],[1705,13,1705,14,1],[1706,13,1706,114,1],[1707,13,1707,39,1],[1708,13,1708,14,1],[1709,17,1709,44,1],[1710,17,1710,47,1],[1711,13,1711,14,1],[1712,13,1713,23,1],[1714,9,1714,10,1],[1717,9,1717,10,1],[1718,13,1718,62,1],[1719,13,1719,68,1],[1720,13,1721,70,1],[1722,13,1722,68,1],[1723,9,1723,10,1],[1726,9,1726,10,1],[1727,13,1727,111,1],[1728,13,1729,81,1],[1730,13,1731,112,1],[1732,13,1733,81,1],[1734,13,1737,31,1],[1738,13,1738,47,1],[1739,17,1742,35,0],[1743,13,1743,59,1],[1744,17,1744,70,0],[1745,13,1745,98,1],[1747,13,1750,31,1],[1751,13,1752,110,1],[1753,13,1754,114,1],[1755,13,1756,114,1],[1757,13,1759,117,1],[1760,13,1760,114,1],[1761,13,1762,119,1],[1763,13,1763,72,1],[1765,17,1765,75,1],[1766,9,1766,10,1],[1769,9,1769,10,1],[1770,13,1770,29,1],[1771,13,1771,14,1],[1772,17,1773,108,1],[1774,13,1774,14,1],[1776,13,1776,14,1],[1777,17,1777,42,1],[1778,13,1778,14,1],[1779,9,1779,10,1],[1782,9,1782,10,1],[1783,13,1784,115,1],[1786,13,1786,111,1],[1787,9,1787,10,1],[1790,9,1790,10,1],[1791,13,1793,50,1],[1794,13,1796,100,1],[1797,13,1797,44,1],[1798,13,1798,14,0],[1799,17,1799,113,0],[1800,17,1801,87,0],[1802,17,1802,18,0],[1803,21,1803,88,0],[1804,21,1804,22,0],[1805,25,1805,57,0],[1806,25,1806,96,0],[1807,21,1807,22,0],[1808,17,1808,18,0],[1809,13,1809,14,0],[1810,13,1810,47,1],[1811,13,1811,14,1],[1812,17,1812,94,1],[1813,17,1813,88,1],[1814,17,1814,47,1],[1815,21,1815,88,1],[1816,13,1816,14,1],[1818,13,1818,47,1],[1819,17,1819,102,1],[1821,13,1821,77,1],[1822,13,1822,14,1],[1823,17,1823,92,1],[1824,17,1824,18,1],[1825,21,1826,121,1],[1827,17,1827,18,1],[1828,17,1828,114,1],[1829,13,1829,14,1],[1831,13,1832,130,1],[1833,13,1833,14,1],[1834,17,1834,149,1],[1835,13,1835,14,1],[1838,13,1838,119,1],[1840,13,1840,64,1],[1842,13,1842,59,1],[1843,13,1843,64,1],[1844,13,1844,60,1],[1846,13,1846,49,1],[1847,13,1849,109,1],[1851,13,1851,114,1],[1852,13,1852,89,1],[1853,13,1853,14,1],[1854,17,1854,42,1],[1855,17,1855,99,1],[1856,17,1856,49,1],[1857,17,1857,18,1],[1858,21,1858,100,1],[1859,21,1859,81,1],[1860,21,1860,58,1],[1861,21,1861,40,1],[1862,21,1862,53,1],[1863,21,1863,41,1],[1864,21,1864,22,0],[1865,25,1865,56,0],[1866,25,1866,97,0],[1867,21,1867,22,0],[1868,17,1868,18,1],[1869,13,1869,14,1],[1871,13,1871,14,1],[1872,17,1872,43,1],[1873,13,1873,14,1],[1875,13,1875,42,1],[1876,13,1876,14,0],[1877,17,1877,64,0],[1878,17,1878,95,0],[1879,17,1879,54,0],[1880,17,1880,36,0],[1881,17,1881,48,0],[1882,13,1882,14,0],[1885,9,1885,10,1],[1888,9,1888,10,1],[1891,13,1891,120,1],[1892,13,1894,94,1],[1895,13,1895,113,1],[1896,13,1898,108,1],[1899,13,1899,53,1],[1900,13,1900,25,1],[1901,9,1901,10,1],[1904,9,1904,10,1],[1905,13,1905,86,1],[1906,13,1906,110,1],[1907,13,1907,60,1],[1908,13,1908,65,1],[1909,13,1909,59,1],[1910,13,1910,60,1],[1911,13,1911,104,1],[1912,13,1912,116,1],[1913,9,1913,10,1],[1916,9,1916,10,0],[1918,13,1918,81,0],[1919,13,1919,14,0],[1920,17,1920,76,0],[1921,17,1921,131,0],[1922,17,1922,65,0],[1923,21,1923,63,0],[1925,21,1925,62,0],[1926,17,1926,75,0],[1927,17,1927,200,0],[1928,17,1928,75,0],[1929,13,1929,14,0],[1930,9,1930,10,0],[1933,9,1933,10,1],[1934,13,1934,85,1],[1935,13,1941,16,1],[1942,13,1948,16,1],[1949,13,1956,16,1],[1957,13,1957,32,1],[1958,9,1958,10,1],[1968,9,1968,10,1],[1969,13,1969,66,1],[1971,13,1971,153,1],[1972,13,1972,177,1],[1973,13,1973,14,1],[1975,17,1975,70,1],[1976,17,1976,18,0],[1977,21,1977,116,0],[1978,21,1978,28,0],[1980,13,1980,14,1],[1981,13,1981,79,1],[1982,13,1982,46,1],[1984,13,1984,59,1],[1985,9,1985,10,1],[1988,9,1988,10,1],[1989,13,1989,37,1],[1990,13,1990,74,1],[1991,13,1991,14,0],[1992,17,1992,48,0],[1993,17,1993,59,0],[1994,13,1994,14,0],[1995,18,1995,122,1],[1996,17,1996,52,1],[1998,13,2000,92,1],[2001,13,2001,14,1],[2002,17,2002,48,1],[2003,17,2003,41,1],[2004,17,2004,57,1],[2005,17,2005,81,1],[2006,17,2006,95,1],[2007,13,2007,14,1],[2008,9,2008,10,1],[2011,9,2011,10,0],[2012,13,2012,117,0],[2013,17,2013,52,0],[2014,13,2016,92,0],[2017,13,2017,14,0],[2018,17,2018,52,0],[2020,17,2020,45,0],[2021,17,2021,57,0],[2023,17,2023,113,0],[2024,13,2024,14,0],[2025,9,2025,10,0],[2028,9,2028,10,1],[2030,13,2031,90,1],[2032,17,2032,76,1],[2033,17,2033,18,1],[2034,21,2034,53,1],[2035,21,2035,56,1],[2036,21,2036,120,1],[2037,21,2037,22,0],[2038,25,2039,70,0],[2040,21,2040,22,0],[2041,21,2041,51,1],[2042,25,2047,96,0],[2049,25,2054,55,1],[2055,17,2055,18,1],[2056,9,2056,10,1],[2059,9,2059,10,1],[2061,13,2061,54,1],[2062,13,2062,54,1],[2063,13,2063,61,1],[2064,13,2064,62,1],[2065,13,2065,60,1],[2066,13,2066,65,1],[2067,13,2067,73,1],[2068,13,2068,64,1],[2069,13,2069,65,1],[2070,13,2070,69,1],[2071,13,2071,60,1],[2072,13,2072,58,1],[2073,13,2073,61,1],[2074,13,2074,67,1],[2075,13,2075,81,1],[2076,13,2076,63,1],[2077,13,2077,75,1],[2078,13,2078,79,1],[2079,13,2079,82,1],[2080,13,2080,62,1],[2081,9,2081,10,1],[2083,9,2083,37,1],[2086,9,2086,10,1],[2087,13,2087,48,1],[2089,13,2089,96,1],[2090,17,2090,63,1],[2091,9,2091,10,1],[2094,9,2094,10,0],[2095,13,2095,66,0],[2096,13,2096,71,0],[2097,13,2097,112,0],[2098,9,2098,10,0],[2101,9,2101,10,1],[2102,13,2102,44,1],[2103,13,2103,57,1],[2104,13,2104,14,0],[2105,17,2105,47,0],[2106,17,2108,37,0],[2109,17,2109,24,0],[2111,13,2111,97,1],[2112,13,2112,14,0],[2113,17,2113,47,0],[2114,17,2115,100,0],[2116,17,2116,24,0],[2118,13,2118,78,1],[2119,13,2119,14,0],[2120,17,2120,47,0],[2121,17,2122,98,0],[2123,17,2123,24,0],[2125,13,2125,66,1],[2126,13,2126,14,0],[2127,17,2127,47,0],[2128,17,2129,103,0],[2130,17,2130,24,0],[2132,13,2132,67,1],[2133,13,2133,14,0],[2134,17,2134,47,0],[2135,17,2136,101,0],[2137,17,2137,24,0],[2139,13,2139,75,1],[2140,13,2140,14,0],[2141,17,2141,47,0],[2142,17,2142,65,0],[2143,17,2143,24,0],[2145,13,2145,66,1],[2146,13,2146,113,1],[2147,13,2147,14,1],[2148,17,2151,90,1],[2152,17,2156,102,1],[2157,13,2157,14,1],[2163,13,2163,64,1],[2164,13,2164,14,1],[2165,17,2167,65,1],[2168,17,2168,95,1],[2170,17,2170,49,1],[2171,21,2171,82,1],[2172,13,2172,14,1],[2176,13,2176,47,1],[2177,13,2177,76,1],[2178,13,2178,70,1],[2179,17,2179,80,1],[2180,13,2180,52,1],[2181,13,2181,14,0],[2182,17,2182,47,0],[2183,17,2183,77,0],[2184,17,2184,24,0],[2189,13,2189,79,1],[2191,13,2191,63,1],[2192,13,2193,48,1],[2195,13,2195,84,1],[2196,17,2196,42,1],[2198,17,2198,42,1],[2199,13,2199,28,1],[2200,13,2200,14,1],[2201,17,2201,53,1],[2202,17,2202,45,1],[2206,17,2206,66,1],[2208,17,2208,63,1],[2209,17,2209,18,1],[2221,21,2224,41,1],[2227,21,2227,96,1],[2230,21,2236,33,1],[2245,21,2245,46,1],[2248,21,2248,55,1],[2249,21,2249,44,1],[2250,17,2250,18,1],[2252,17,2252,116,1],[2253,17,2253,18,0],[2254,21,2254,38,0],[2255,21,2255,81,0],[2256,21,2256,67,0],[2258,21,2259,103,0],[2260,17,2260,18,0],[2264,17,2264,42,1],[2265,21,2265,66,0],[2267,17,2267,37,1],[2268,17,2268,18,0],[2269,21,2269,76,0],[2270,17,2270,18,0],[2273,17,2273,60,1],[2274,17,2274,18,1],[2275,21,2275,51,1],[2276,21,2276,37,1],[2277,21,2277,115,1],[2278,21,2278,61,1],[2279,21,2279,47,1],[2280,21,2280,59,1],[2281,17,2281,18,1],[2283,21,2285,31,1],[2288,17,2288,58,1],[2289,17,2289,18,1],[2290,21,2290,72,1],[2292,21,2292,65,1],[2293,17,2293,18,1],[2295,17,2295,48,1],[2296,13,2296,14,1],[2297,18,2297,35,0],[2298,13,2298,14,0],[2299,17,2299,47,0],[2300,17,2301,93,0],[2302,13,2302,14,0],[2303,9,2303,10,1],[2306,9,2306,10,1],[2307,13,2313,71,1],[2314,13,2325,104,1],[2326,13,2327,44,1],[2328,13,2328,31,1],[2329,17,2329,39,1],[2330,13,2330,31,1],[2331,17,2331,39,1],[2332,13,2332,33,1],[2333,13,2333,122,1],[2334,13,2334,59,1],[2335,13,2336,92,1],[2337,13,2337,62,1],[2338,9,2338,10,1],[2341,9,2341,10,0],[2342,13,2342,59,0],[2343,9,2343,10,0],[2346,9,2346,10,1],[2347,13,2348,63,1],[2349,13,2349,14,0],[2350,17,2352,78,0],[2353,21,2353,48,0],[2354,13,2354,14,0],[2355,13,2355,46,1],[2356,13,2356,67,1],[2357,17,2357,111,1],[2358,18,2361,100,0],[2362,17,2362,112,0],[2364,17,2364,112,0],[2365,13,2365,68,1],[2366,13,2366,14,1],[2367,17,2367,66,1],[2368,17,2368,18,1],[2369,21,2369,35,1],[2370,21,2373,88,1],[2374,17,2374,18,1],[2376,21,2376,48,0],[2377,13,2377,14,1],[2378,18,2378,68,1],[2379,13,2379,14,1],[2380,17,2381,76,1],[2382,17,2382,66,1],[2383,17,2383,18,1],[2384,21,2388,94,1],[2390,21,2391,78,1],[2392,21,2392,22,0],[2393,25,2393,118,0],[2394,25,2394,59,0],[2395,25,2395,26,0],[2396,29,2396,57,0],[2397,29,2397,73,0],[2398,29,2400,90,0],[2401,25,2401,26,0],[2402,21,2402,22,0],[2404,25,2404,46,1],[2406,21,2406,35,1],[2407,21,2410,88,1],[2411,21,2415,91,1],[2416,17,2416,18,1],[2418,21,2418,48,0],[2420,17,2423,80,1],[2424,21,2424,82,0],[2425,13,2425,14,1],[2426,18,2426,52,0],[2427,13,2427,14,0],[2428,17,2428,66,0],[2429,17,2429,18,0],[2430,21,2433,88,0],[2434,21,2438,91,0],[2439,17,2439,18,0],[2441,21,2441,48,0],[2442,13,2442,14,0],[2443,18,2443,48,0],[2444,13,2444,14,0],[2445,17,2445,66,0],[2446,17,2446,18,0],[2447,21,2451,91,0],[2452,21,2455,88,0],[2456,17,2456,18,0],[2458,21,2458,48,0],[2459,13,2459,14,0],[2460,13,2460,53,1],[2461,9,2461,10,1],[2464,9,2464,10,1],[2465,13,2465,56,1],[2466,13,2466,54,1],[2467,13,2467,80,1],[2468,13,2468,53,1],[2469,9,2469,10,1],[2472,9,2472,10,1],[2473,13,2473,71,1],[2475,13,2475,90,1],[2477,13,2477,46,1],[2478,13,2478,14,1],[2479,17,2479,74,1],[2480,17,2480,67,1],[2482,17,2482,36,1],[2483,17,2483,18,1],[2485,21,2490,116,1],[2492,21,2494,82,1],[2495,17,2495,18,1],[2497,17,2497,18,0],[2498,21,2498,51,0],[2499,21,2499,48,0],[2500,17,2500,18,0],[2501,13,2501,14,1],[2502,9,2502,10,1],[2505,9,2505,10,1],[2506,13,2506,66,1],[2507,13,2507,113,1],[2508,13,2509,114,1],[2510,13,2510,113,1],[2511,13,2511,109,1],[2512,13,2512,115,1],[2513,13,2513,111,1],[2514,13,2514,113,1],[2515,13,2516,74,1],[2517,13,2517,122,1],[2518,13,2519,77,1],[2520,13,2520,107,1],[2521,13,2521,115,1],[2522,13,2522,117,1],[2523,13,2523,121,1],[2524,13,2524,115,1],[2525,13,2526,74,1],[2527,13,2528,72,1],[2529,13,2529,105,1],[2531,13,2531,121,1],[2532,13,2532,109,1],[2533,13,2533,113,1],[2534,13,2534,113,1],[2535,13,2535,107,1],[2536,13,2536,77,1],[2537,13,2537,113,1],[2539,13,2539,115,1],[2540,13,2540,117,1],[2542,13,2542,104,1],[2543,13,2543,102,1],[2544,13,2544,110,1],[2545,13,2545,108,1],[2546,13,2546,106,1],[2547,13,2547,103,1],[2549,13,2549,72,1],[2550,17,2551,86,1],[2553,17,2553,94,1],[2556,13,2556,111,1],[2558,13,2558,98,1],[2559,13,2559,162,1],[2560,13,2560,165,1],[2563,13,2563,70,1],[2564,9,2564,10,1],[2567,9,2567,10,1],[2568,13,2568,74,1],[2569,13,2569,81,1],[2570,13,2570,78,1],[2571,13,2571,90,1],[2572,13,2572,103,1],[2573,13,2573,94,1],[2574,13,2574,74,1],[2576,13,2576,29,1],[2583,21,2583,49,1],[2584,21,2584,27,1],[2586,21,2586,62,0],[2587,21,2587,22,0],[2588,25,2588,52,0],[2589,25,2589,63,0],[2590,21,2590,22,0],[2592,25,2592,53,0],[2593,21,2593,27,0],[2595,21,2595,62,1],[2596,25,2596,56,1],[2597,21,2597,48,1],[2598,21,2598,59,1],[2599,21,2599,27,1],[2601,21,2601,48,0],[2602,21,2602,59,0],[2603,21,2603,27,0],[2605,9,2605,10,1],[2608,9,2608,10,0],[2609,13,2609,93,0],[2610,17,2610,29,0],[2612,17,2612,30,0],[2613,9,2613,10,0],[2616,9,2616,10,1],[2618,13,2618,14,1],[2625,17,2625,67,1],[2626,17,2626,90,1],[2627,17,2627,31,1],[2628,21,2628,94,1],[2629,17,2629,111,1],[2630,17,2630,96,1],[2633,17,2633,96,1],[2634,17,2634,46,1],[2636,17,2636,53,1],[2637,13,2637,14,1],[2638,13,2638,18,0],[2639,13,2639,14,0],[2640,13,2640,14,0],[2641,9,2641,10,1],[2644,9,2644,10,0],[2645,13,2645,98,0],[2647,13,2647,91,0],[2648,13,2648,48,0],[2649,9,2649,10,0],[2651,37,2651,41,0],[2651,42,2651,46,1],[2655,9,2655,10,1],[2656,13,2656,85,1],[2657,13,2663,16,1],[2664,13,2670,16,1],[2671,13,2677,16,1],[2678,13,2684,16,1],[2685,13,2691,16,1],[2693,13,2693,32,1],[2694,9,2694,10,1],[2697,9,2697,10,1],[2698,13,2698,61,1],[2699,13,2699,85,1],[2701,13,2701,55,1],[2702,13,2702,64,1],[2703,13,2703,70,1],[2705,13,2705,59,1],[2707,13,2707,49,1],[2708,13,2708,88,1],[2709,13,2709,43,1],[2710,13,2710,47,1],[2711,13,2711,40,1],[2712,13,2712,35,1],[2713,13,2713,48,1],[2714,13,2714,49,1],[2716,13,2716,82,1],[2718,13,2718,103,1],[2719,13,2719,92,1],[2721,13,2721,79,1],[2723,13,2723,52,1],[2725,13,2725,95,1],[2726,13,2726,45,1],[2727,9,2727,10,1],[2730,9,2730,10,1],[2731,13,2733,67,1],[2733,68,2733,75,1],[2735,13,2735,61,1],[2737,13,2737,102,1],[2739,13,2744,163,1],[2746,13,2746,60,1],[2747,13,2750,30,1],[2752,13,2752,56,1],[2753,13,2753,54,1],[2754,13,2754,53,1],[2755,13,2755,55,1],[2756,13,2756,41,1],[2757,13,2757,65,1],[2758,13,2758,160,1],[2759,13,2759,88,1],[2761,13,2761,89,1],[2762,13,2762,109,1],[2764,13,2764,63,1],[2766,13,2766,42,1],[2768,13,2768,66,1],[2769,9,2769,10,1],[2772,9,2772,10,0],[2774,13,2774,14,0],[2775,17,2775,24,0],[2775,26,2775,58,0],[2775,59,2775,61,0],[2775,62,2775,74,0],[2776,17,2776,18,0],[2777,21,2777,92,0],[2778,21,2778,73,0],[2779,21,2779,43,0],[2780,21,2780,76,0],[2781,21,2781,74,0],[2782,21,2782,66,0],[2783,17,2783,18,0],[2784,13,2784,14,0],[2785,13,2785,40,0],[2786,13,2786,14,0],[2787,17,2787,65,0],[2788,17,2788,70,0],[2789,17,2789,84,0],[2790,17,2790,121,0],[2791,13,2791,14,0],[2792,9,2792,10,0],[2795,9,2795,10,0],[2796,13,2796,60,0],[2797,13,2797,36,0],[2798,13,2798,76,0],[2799,13,2799,97,0],[2800,13,2800,36,0],[2802,13,2802,91,0],[2803,9,2803,10,0],[2806,9,2806,10,0],[2807,13,2807,41,0],[2808,9,2808,10,0],[2811,9,2811,10,1],[2812,13,2812,65,1],[2813,13,2813,14,1],[2814,17,2814,81,1],[2815,17,2815,88,1],[2816,17,2816,80,1],[2817,13,2817,14,1],[2818,13,2818,65,1],[2819,13,2819,14,1],[2820,17,2820,81,1],[2821,17,2821,88,1],[2822,17,2822,84,1],[2823,17,2823,50,1],[2824,17,2824,61,1],[2825,17,2825,18,0],[2826,21,2826,54,0],[2827,17,2827,18,0],[2829,17,2831,103,1],[2833,13,2833,14,1],[2834,13,2834,73,1],[2835,13,2835,14,1],[2836,17,2836,89,1],[2837,17,2837,96,1],[2839,17,2839,61,1],[2840,17,2840,18,0],[2841,21,2841,54,0],[2842,17,2842,18,0],[2843,17,2843,111,1],[2844,17,2844,98,1],[2845,17,2845,62,1],[2846,13,2846,14,1],[2847,13,2847,67,1],[2848,13,2848,14,1],[2849,17,2849,61,1],[2850,17,2850,18,0],[2851,21,2851,54,0],[2852,17,2852,18,0],[2854,17,2854,94,1],[2858,13,2858,14,1],[2859,13,2859,67,1],[2860,13,2860,14,1],[2861,17,2861,84,1],[2862,17,2862,90,1],[2863,17,2863,93,1],[2864,13,2864,14,1],[2865,13,2865,53,1],[2866,9,2866,10,1],[2869,9,2869,10,1],[2870,13,2870,65,1],[2871,13,2871,14,1],[2872,17,2872,94,1],[2873,21,2873,53,1],[2874,22,2874,43,1],[2875,21,2875,56,0],[2876,13,2876,14,1],[2877,13,2877,65,1],[2878,13,2878,14,1],[2879,17,2879,90,1],[2880,21,2880,53,1],[2881,22,2881,41,1],[2882,21,2882,56,0],[2884,17,2884,18,1],[2885,21,2885,53,1],[2886,21,2886,55,1],[2887,17,2887,18,1],[2888,13,2888,14,1],[2889,13,2889,73,1],[2890,13,2890,14,1],[2891,17,2892,120,1],[2893,21,2893,61,1],[2894,22,2894,47,1],[2895,21,2895,64,0],[2897,17,2897,18,1],[2898,21,2898,61,1],[2899,21,2899,63,1],[2900,17,2900,18,1],[2901,13,2901,14,1],[2902,13,2902,67,1],[2903,13,2903,14,1],[2904,17,2904,98,1],[2905,21,2905,55,1],[2906,22,2906,45,1],[2907,21,2907,58,0],[2909,17,2909,18,1],[2910,21,2910,55,1],[2911,21,2911,57,1],[2912,17,2912,18,1],[2913,13,2913,14,1],[2914,13,2914,66,1],[2915,13,2915,14,1],[2916,17,2916,49,1],[2917,17,2917,49,1],[2918,17,2918,57,1],[2919,17,2919,57,1],[2920,13,2920,14,1],[2923,13,2923,14,1],[2924,17,2924,51,1],[2925,13,2925,14,1],[2927,13,2927,47,1],[2928,13,2928,14,1],[2929,17,2929,49,1],[2931,13,2931,14,1],[2933,13,2933,139,1],[2934,17,2934,60,0],[2935,13,2935,37,1],[2936,17,2936,41,1],[2938,13,2938,53,1],[2939,13,2939,64,1],[2940,13,2940,14,0],[2941,17,2941,106,0],[2943,17,2943,102,0],[2944,21,2944,100,0],[2946,21,2946,84,0],[2948,17,2948,44,0],[2949,17,2949,113,0],[2950,13,2950,14,0],[2951,18,2951,71,1],[2952,17,2952,59,1],[2954,13,2954,70,1],[2955,13,2955,14,1],[2956,17,2956,58,1],[2957,17,2957,18,1],[2958,21,2958,92,1],[2959,21,2959,61,1],[2960,17,2960,18,1],[2961,17,2961,58,1],[2962,17,2962,18,1],[2963,21,2963,92,1],[2964,21,2964,61,1],[2965,17,2965,18,1],[2966,13,2966,14,1],[2968,13,2969,72,1],[2970,13,2970,14,0],[2971,17,2972,78,0],[2973,17,2973,18,0],[2974,21,2974,89,0],[2975,17,2975,18,0],[2977,17,2977,18,0],[2978,21,2978,54,0],[2979,21,2979,22,0],[2980,25,2980,93,0],[2981,21,2981,22,0],[2983,21,2983,22,0],[2984,25,2984,91,0],[2985,21,2985,22,0],[2986,17,2986,18,0],[2988,17,2988,57,0],[2989,13,2989,14,0],[2991,13,2991,46,1],[2992,13,2992,33,1],[2993,9,2993,10,1],[2999,17,2999,18,1],[2999,19,2999,58,1],[2999,59,2999,60,1],[3004,17,3004,18,0],[3004,19,3004,55,0],[3005,17,3005,18,0],[3005,19,3005,55,0],[3010,9,3010,10,0],[3011,9,3011,10,0],[3016,9,3016,10,1],[3025,9,3025,10,1],[3090,9,3090,10,0],[3091,9,3091,10,0],[3093,51,3093,55,0],[3093,56,3093,60,0],[3098,13,3098,14,1],[3099,17,3099,52,1],[3100,21,3100,115,1],[3101,17,3101,47,1],[3102,13,3102,14,1],[3122,9,3122,10,1],[3123,13,3123,50,1],[3124,13,3124,61,1],[3125,13,3125,14,1],[3126,17,3126,61,1],[3127,17,3127,51,1],[3128,17,3128,70,1],[3129,17,3129,85,1],[3130,17,3131,77,1],[3132,17,3133,74,1],[3134,17,3134,76,1],[3135,17,3135,100,1],[3136,17,3136,53,1],[3139,17,3139,97,1],[3141,17,3141,102,1],[3142,17,3142,18,0],[3143,21,3144,70,0],[3145,17,3145,18,0],[3147,21,3147,53,1],[3148,13,3148,14,1],[3150,13,3150,14,0],[3151,17,3151,37,0],[3152,13,3152,14,0],[3154,13,3154,70,1],[3155,13,3155,81,1],[3156,13,3156,29,1],[3157,9,3157,10,1]]);
    </script>
  </body>
</html>