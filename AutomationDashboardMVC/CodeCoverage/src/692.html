<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\LibraryComponent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Common;
using System.Globalization;
using System.IO;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.BusinessLayer.DTO;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.LibraryDTO;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common.Utility;

namespace Aurigo.AMP3.LibraryDAC
{
    /// &lt;summary&gt;
    /// This Class contain the methods for accessing the DataBase and returning the Results back to the BL
    /// &lt;/summary&gt;
    public partial class LibraryComponent : SingletonManagerBase&lt;LibraryComponent&gt;
    {
        private LibraryComponent()
        {
        }

        public string ClassNameForResType = &quot;&quot;;

        internal DataSet GetLibraryDataSet(params LibCatalogs[] catalogs)
        {
            DataSet ds = new BrixDataSet();

            foreach (LibCatalogs list in catalogs)
            {
                var sWr = new StringWriter(CultureInfo.CurrentCulture);
                var xWr = new XmlTextWriter(sWr);

                xWr.WriteStartElement(&quot;ROOT&quot;);

                xWr.WriteStartElement(&quot;Catalog&quot;);
                xWr.WriteAttributeString(&quot;Name&quot;, list.name);
                xWr.WriteAttributeString(&quot;SearchBase&quot;, list.baseOp);
                xWr.WriteAttributeString(&quot;IsFiltered&quot;, list.isFiltered);
                if (list.sortOrder != null)
                    xWr.WriteAttributeString(&quot;SortOrder&quot;, list.sortOrder);

                if (list.filters != null &amp;&amp; list.filters.Length &gt; 0)
                {
                    for (int i = 0; i &lt; list.filters.Length; i++)
                    {
                        List&lt;string&gt; filterList = list.filters[i].Value;
                        if (filterList == null)
                            break;

                        xWr.WriteStartElement(&quot;Col&quot;);
                        xWr.WriteAttributeString(&quot;Name&quot;, list.filters[i].Key);
                        for (int n = 0; n &lt; filterList.Count; n++)
                        {
                            xWr.WriteStartElement(&quot;Filter&quot;);
                            xWr.WriteAttributeString(&quot;value&quot;, filterList[n]);
                            xWr.WriteEndElement(); // Filter
                        }
                        xWr.WriteEndElement(); // Col
                    }
                }
                xWr.WriteEndElement(); // Catalog

                xWr.WriteEndElement(); // ROOT

                xWr.Flush();
                string xmlCatalog = sWr.ToString2();
                sWr.Close();

                //DbCommand cmd = amp3conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetRecInTblFormat_X&quot;, new object[] { xmlCatalog }, 2);
                ////conn.DB.AddInParameter(cmd, &quot;xmlSchema&quot;, DbType.String, xmlCatalog);
                //DataSet dsTemp = amp3conn.DB.ExecuteDataSet(cmd);

                DataSet dsTemp = ComponentHelper.Instance.ExecuteDataSet(
                    StoredProcedure.usp_LIBRARYGetRecInTblFormat_X, null, xmlCatalog);
                //for (int i = 0; i &lt; dsTemp.Tables.Count; i += 2)
                //{
                if (dsTemp.Tables.Count &gt; 1)
                    dsTemp.Tables[1].TableName = list.name; // dsTemp.Tables[0].Rows[0][&quot;Name&quot;].ToString2();
                dsTemp.Tables[0].TableName = &quot;Table&quot; + ds.Tables.Count;
                //}

                for (int i = 0; i &lt; dsTemp.Tables.Count; i++)
                    ds.Tables.Add(dsTemp.Tables[i].Copy());
                //dsTemp.Tables[1].TableName = list.name;//dsTemp.Tables[0].Rows[0][&quot;Name&quot;].ToString2();

                //ds.Tables.Add(dsTemp.Tables[1].Copy());
            }
            return ds;
        }

        /// &lt;summary&gt;
        /// Gets all the nodes(visible and non-visible) from the Library Tree Table
        /// &lt;/summary&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        public DataTable GetLibraryList()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetLibraryList&quot;);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        internal Dictionary&lt;int, string&gt; GetChildNodes(string category)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var catalogs = new Dictionary&lt;int, string&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetNodeForACategory&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCategoryName&quot;, DbType.String, category);

                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        while (dr.Read())
                            catalogs.Add(dr.GetInt32(0), dr.GetString(1));
                    }
                    return catalogs;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets only the visible nodes from the Library Tree Table
        /// &lt;/summary&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        internal DataTable GetAllVisibleNodes()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetVisibleLibList&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes all the records, schema and the node from the tables
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;xmlStr&quot;&gt;&lt;/param&gt;
        internal void DeleteSchemaAssociatedRecords(string xmlStr)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDelNodeSchmRec&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramMyXml&quot;, DbType.String, xmlStr);
                    conn.DB.AddOutParameter(cmd, &quot;XmlHandle&quot;, DbType.Int32, 4);

                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Returns a dictionary containing NodeId and the Catalog Name
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Dictionary&lt;int, string&gt; GetAllCatalogs()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetAllCatalogs&quot;);
                    var catalogs = new Dictionary&lt;int, string&gt;();

                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        while (dr.Read())
                            catalogs.Add(dr.GetInt32(0), dr.GetString(1));
                    }
                    return catalogs;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the Maximum Column Order for a particular Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;CatalogID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private int GetMaxCatalogColumnOrderNumber(int CatalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetMaxCatColOrdNo&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, CatalogID);
                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? 0 : rd.ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the Maximum Row number from the CatalogRecords Table for a Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;CatalogID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int GetMaxCatalogRowNumber(int CatalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetMaxCatRowNo&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, CatalogID);

                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? 0 : rd.ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the schema for the Selected Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetCatalogSchema(int nodeID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetCatalogSchema&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, nodeID);
                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, &quot;null&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the schema for the Selected Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetCatalogSchema(string nodeName)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetCatalogSchema&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, -1);
                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, nodeName);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Create a New Column for the Catalog Schema
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;columnName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;columnType&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;columnSize&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isUnique&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isDescriptive&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isMandatory&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;CatalogColumnID on Successful creation of a new column&lt;/returns&gt;
        /// &lt;returns&gt;-1 if the Column Name already exists&lt;/returns&gt;
        internal int CreateCatalogSchema(int catalogID, string columnName, string columnType, int columnSize,
            bool isUnique, bool isDescriptive, bool isMandatory)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    int columnOrder = GetMaxCatalogColumnOrderNumber(catalogID) + 1;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYAddNewCatalogColumn&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnName&quot;, DbType.String, columnName);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnType&quot;, DbType.String, columnType);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnOrder&quot;, DbType.Int32, columnOrder);
                    conn.DB.AddOutParameter(cmd, &quot;paramSTATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddInParameter(cmd, &quot;paramIsUnique&quot;, DbType.Boolean, isUnique);
                    conn.DB.AddInParameter(cmd, &quot;paramIsDescriptive&quot;, DbType.Boolean, isDescriptive);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnSize&quot;, DbType.Int32, columnSize);
                    conn.DB.AddInParameter(cmd, &quot;paramIsMandatory&quot;, DbType.Boolean, isMandatory);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;paramSTATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Check whether the catalogvalue exists or not
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogValue&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool IsCatalogRecordUnique(string catalogValue, int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYIsCatRecUniq&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogValue&quot;, DbType.String, catalogValue);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? false : (rd.ToInt32_2() == 0);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Update the schema for the selected catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogColumnID&quot;&gt;The Uniaue Column ID&lt;/param&gt;
        /// &lt;param name=&quot;columnName&quot;&gt;The Column Name&lt;/param&gt;
        /// &lt;param name=&quot;columnType&quot;&gt;The Data Type of the Column&lt;/param&gt;
        /// &lt;param name=&quot;columnSize&quot;&gt;The Size of the Column&lt;/param&gt;
        /// &lt;param name=&quot;isUnique&quot;&gt;Is the column unique&lt;/param&gt;
        /// &lt;param name=&quot;isDescriptive&quot;&gt;Is the column descriptive&lt;/param&gt;
        /// &lt;param name=&quot;isMandatory&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;Success if its a new column,else returns error&lt;/returns&gt;
        internal int UpdateCatalogSchema(int catalogColumnID, string columnName, string columnType, int columnSize,
            bool isUnique, bool isDescriptive, bool isMandatory)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYUpdateCatalogSchema&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, catalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnName&quot;, DbType.String, columnName);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnType&quot;, DbType.String, columnType);
                    conn.DB.AddInParameter(cmd, &quot;paramIsUnique&quot;, DbType.Boolean, isUnique);
                    conn.DB.AddInParameter(cmd, &quot;paramIsDescriptive&quot;, DbType.Boolean, isDescriptive);
                    conn.DB.AddInParameter(cmd, &quot;paramIsMandatory&quot;, DbType.Boolean, isMandatory);
                    conn.DB.AddInParameter(cmd, &quot;paramColumnSize&quot;, DbType.Int32, columnSize);
                    conn.DB.AddOutParameter(cmd, &quot;paramErrorStatus&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;paramErrorStatus&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        internal void UpdateCatalogOrder(int catalogColumnID, int position)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYUpdateColumnOrder&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, catalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramPosition&quot;, DbType.Int32, position);

                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Delete the Schema for the selected Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogColumnID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        internal void DeleteCatalogSchema(int catalogColumnID, int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDeleteCatalogColumn&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, catalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the List of Child Nodes for the Selected Category
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetChildNodesList(int nodeID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetChildNodesList&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeID&quot;, DbType.Int32, nodeID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Adds a new record to the selected Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Value&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;CatalogColumnID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogRowID&quot;&gt;&lt;/param&gt;
        internal void AddNewRecord(int nodeID, string Value, int CatalogColumnID, int catalogRowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYAddNewRecord&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, CatalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramNodeID&quot;, DbType.Int32, nodeID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogValue&quot;, DbType.String, Value);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, catalogRowID);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Check for records with columns already set as mandatory
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal bool IsCatEmptyBeforeSettingMandatory(int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYIsCatEmptyB4Mand&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? false : (rd.ToInt32_2() == 0);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Edit record for a catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogValue&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;CatalogColumnID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogRowID&quot;&gt;&lt;/param&gt;
        internal void EditRecord(int catalogID, string catalogValue, int CatalogColumnID, int catalogRowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYEditRecord&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, CatalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogValue&quot;, DbType.String, catalogValue);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, catalogRowID);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes the selected record 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogRowID&quot;&gt;&lt;/param&gt;
        internal void DeleteRecord(int catalogID, int catalogRowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDeleteRecord&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, catalogRowID);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Checks whether the Schema Column name has associated records for it
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable CheckRecordsBeforeModify(int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetCatalogRowIDs&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Delete Schema.ColumnName associated Records
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogColumnID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;0 if success or else -1 on error&lt;/returns&gt;
        internal int DeleteSchemaAssociatedRecords(int catalogID, int catalogColumnID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDelSchmAssoRec&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, catalogColumnID);
                    conn.DB.AddOutParameter(cmd, &quot;paramErrorCode&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;paramErrorCode&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes all the records pertaining to a Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogID&quot;&gt;The NodeID/CatalogID of the selected node&lt;/param&gt;
        internal void DeleteAllRecords(int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDeleteAllRecords&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Returns the node id for a particular catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int GetNodeID(string nodeName)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetNodeID&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, nodeName);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Hide/Unhide a column in the catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;catalogColumnID&quot;&gt;The unique column id&lt;/param&gt;
        /// &lt;param name=&quot;isVisible&quot;&gt;&lt;/param&gt;
        internal void HideUnhideCatalogColumn(int catalogColumnID, bool isVisible)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYHideUnhideCatCol&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogColumnID&quot;, DbType.Int32, catalogColumnID);
                    conn.DB.AddInParameter(cmd, &quot;paramIsVisible&quot;, DbType.Boolean, isVisible);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Hide/Unhide a TreeNode in the Library Tree
        /// Here we are passing a xml string of nodeid&#39;s 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;xmlStr&quot;&gt;&lt;/param&gt;
        internal void HideUnhideTreeNodes(string xmlStr)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYHideUnhideTreeNodes&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramMyXml&quot;, DbType.String, xmlStr);
                    conn.DB.AddOutParameter(cmd, &quot;XmlHandle&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets XML String which contains the numner of categories, catalogs, hidden catalogs
        /// &lt;/summary&gt;
        /// &lt;returns&gt;XML String which contains the numner of categories, catalogs, hidden catalogs&lt;/returns&gt;
        internal DataTable GetLibrarySummary(int targetPage)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetLibrarySummary&quot;);

                    conn.DB.AddInParameter(cmd, &quot;targetPage&quot;, DbType.Int32, targetPage);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Copies the Schema(Column Names,Types,Size etc.) from an existing Catalog
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;fromNodeID&quot;&gt;Node ID of the Existing Catalog&lt;/param&gt;
        /// &lt;param name=&quot;toNodeID&quot;&gt;Node ID of the newly creating record&lt;/param&gt;
        internal DataTable CopyExistingSchema(int fromNodeID, int toNodeID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYCopyExistingSchema&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramFromNodeID&quot;, DbType.Int32, fromNodeID);
                    conn.DB.AddInParameter(cmd, &quot;paramToNodeID&quot;, DbType.Int32, toNodeID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Gets the List of Records which matches with the Keyword
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;Unique name of a Catalog&lt;/param&gt;
        /// &lt;param name=&quot;searchfield&quot;&gt;Comma Separated Column Names&lt;/param&gt;
        /// &lt;param name=&quot;keyword&quot;&gt;The KeyWord to Search for.&lt;/param&gt;
        /// &lt;returns&gt;A DataTable that contains the List of Records which matches with the Keyword&lt;/returns&gt;
        internal DataTable GetSearchResults(string nodeName, string searchfield, string keyword)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetSearchResults&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, nodeName);
                    conn.DB.AddInParameter(cmd, &quot;paramSearchField&quot;, DbType.String, searchfield);
                    conn.DB.AddInParameter(cmd, &quot;paramKeyWord&quot;, DbType.String, keyword);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        internal string SaveImportedRecordsFromExcel(int catalogID, string xmlRecordsStr)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYTestImportFromExcel&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    conn.DB.AddInParameter(cmd, &quot;paramMyXml&quot;, DbType.String, xmlRecordsStr);
                    conn.DB.AddOutParameter(cmd, &quot;Errorstr&quot;, DbType.String, 800);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;Errorstr&quot;).ToString2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }


        internal DataTable GetRecordsInTableFormat(int catalogID, string sortOrder)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetRecInTblFormat&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    if (sortOrder != null)
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
                    else
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, &quot;\&quot;RecordID\&quot; asc&quot;);
                    conn.DB.AddInParameter(cmd, &quot;whereClause&quot;, DbType.String, &quot;&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Returns a Record matching the links Search Criteria
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeName&quot;&gt;Unique name to a Catalog(Internal)&lt;/param&gt;
        /// &lt;param name=&quot;catalogRowID&quot;&gt;The Row Id of the record&lt;/param&gt;
        /// &lt;returns&gt;records in XML format&lt;/returns&gt;
        internal string ViewSearchResults(string nodeName, int catalogRowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYViewSearchResults&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, nodeName);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, catalogRowID);

                    return &quot;&lt;SearchResults&gt;&quot; + conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2() +
                           &quot;&lt;/SearchResults&gt;&quot;;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        public bool IsCatalogRecordUnique_Edit(string catalogValue, int nodeID, int catalogRowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYIsCatRecUniq_Edit&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogValue&quot;, DbType.String, catalogValue);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, nodeID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, catalogRowID);
                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? false : (rd.ToInt32_2() == 0);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }


        internal bool IsCatEmptyBeforeSettingUnique(int catalogID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYIsCatEmptyB4Uniq&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramCatalogID&quot;, DbType.Int32, catalogID);
                    object rd = conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0];

                    return (rd == DBNull.Value) ? false : (rd.ToInt32_2() == 0);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the records for a particular rowid(for a catalog) 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;rowID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetRecordsForEditing(int nodeID, int rowID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetRec4Editing&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeID&quot;, DbType.Int32, nodeID);
                    conn.DB.AddInParameter(cmd, &quot;paramCatalogRowID&quot;, DbType.Int32, rowID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        internal string[] GetCatalogAttributes(string nodeName)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    string[] columnNames;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetCatAttribs&quot;);

                    conn.DB.AddInParameter(cmd, &quot;paramNodeName&quot;, DbType.String, nodeName);
                    conn.DB.AddOutParameter(cmd, &quot;paramColumnCount&quot;, DbType.Int32, 4);

                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        columnNames =
                            new string[conn.DB.GetParameterValue(cmd, &quot;paramColumnCount&quot;).ToString2().ToInt32_2()];
                        int index = 0;
                        while (dr.Read())
                            columnNames[index++] = dr.GetString(0);
                    }
                    return columnNames;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Returns all the catalog names
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal string[] GetAllTypeNames()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    string[] typeNames;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetAllTypeNames&quot;);
                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        typeNames = new string[1]; // Initialize with a default size
                        int index = 0;
                        while (dr.Read())
                            typeNames[index++] = dr.GetString(0);
                    }
                    return typeNames;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        ///// &lt;summary&gt;
        ///// Imports the standard items from data table
        ///// &lt;/summary&gt;
        ///// &lt;param name=&quot;dsItems&quot;&gt;&lt;/param&gt;
        ///// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        ///// &lt;returns&gt;&lt;/returns&gt;
        //internal int ImportStandardItems(string sItems, int standardTableID)
        //{
        //    try
        //    {
        //        DbCommand cmd = amp3conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYImportStandardItems&quot;);
        //        amp3conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, standardTableID);
        //        amp3conn.DB.AddInParameter(cmd, &quot;in_ItemsXML&quot;, DbType.String, sItems);
        //        amp3conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
        //        amp3conn.DB.ExecuteNonQuery(cmd);

        //        //DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTImportStandardItems&quot;, new object[] { standardTableID, dsItems.GetXml(), null });
        //        //conn.DB.ExecuteNonQuery(cmd);

        //        return BrixDatatypeHelper.ToInt32_2(amp3conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToString2());
        //    }
        //    catch (Exception ex)
        //    {
        //        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
        //        throw;
        //    }
        //}

        internal DataTable GetResourceCatalogsForMobile(string tableName)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetResourcesInTblFormat&quot;);
                    conn.DB.AddInParameter(cmd, &quot;tableName&quot;, DbType.String, tableName);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        internal int CUDStages(LandManagement landDTO, string operation, string multipleIDS)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTCUDStages&quot;);

                if (operation != &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;STAGEID&quot;, DbType.Int32, landDTO.StageID);
                    conn.DB.AddInParameter(cmd, &quot;NAME&quot;, DbType.String, landDTO.StageName);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, landDTO.StageDescription);
                }

                conn.DB.AddInParameter(cmd, &quot;OPERATION&quot;, DbType.String, operation);

                if (operation == &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;MULTIPLEIDS&quot;, DbType.String, multipleIDS);
                }

                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetStages(object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string returnAllRows)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetStages&quot;);

                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;SORTORDER&quot;, DbType.String, sortOrder);
                if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                if (returnAllRows == &quot;Y&quot;)
                    conn.DB.AddInParameter(cmd, &quot;ReturnAllRows&quot;, DbType.String, returnAllRows);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int GetStagesCount(string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetStages&quot;);

                if (filterSearch != null)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                conn.DB.AddInParameter(cmd, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2().Parse2();
            }
        }

        internal DataTable GetStage(int stageID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetStage&quot;);
                conn.DB.AddInParameter(cmd, &quot;STAGEID&quot;, DbType.Int32, stageID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int CUDActivities(LandManagement landDTO, string operation, string multipleIDS)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = landDTO.ModuleID == &quot;LIBRARY&quot;
                    ? conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTCUDActivities&quot;)
                    : conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTCUDActivities&quot;);

                if (operation != &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;ACTIVITYID&quot;, DbType.Int32, landDTO.ActivityID);
                    conn.DB.AddInParameter(cmd, &quot;NAME&quot;, DbType.String, landDTO.ActivityName);
                    conn.DB.AddInParameter(cmd, &quot;NOTES&quot;, DbType.String, landDTO.ActivityNotes);
                }

                conn.DB.AddInParameter(cmd, &quot;OPERATION&quot;, DbType.String, operation);

                if (operation == &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;MULTIPLEIDS&quot;, DbType.String, multipleIDS);
                }

                if (landDTO.ModuleID == &quot;LIBRARY&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;MODULEID&quot;, DbType.String, landDTO.ModuleID);
                    conn.DB.AddInParameter(cmd, &quot;PARENTINSTANCEID&quot;, DbType.Int32, landDTO.ParentInstanceID);
                }

                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetActivities(object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string returnAllRows)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetActivities&quot;);

                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;SORTORDER&quot;, DbType.String, sortOrder);
                if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                if (returnAllRows == &quot;Y&quot;)
                    conn.DB.AddInParameter(cmd, &quot;ReturnAllRows&quot;, DbType.String, returnAllRows);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int GetActivitiesCount(string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetActivities&quot;);

                if (filterSearch != null)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                conn.DB.AddInParameter(cmd, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2().Parse2();
            }
        }

        internal int GetCheckListActivitiesCount(string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTGetActivities&quot;);

                if (filterSearch != null)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                conn.DB.AddInParameter(cmd, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2().Parse2();
            }
        }

        internal DataTable GetChecklistActivities(object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string returnAllRows)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTGetActivities&quot;);

                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;SORTORDER&quot;, DbType.String, sortOrder);
                if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                if (returnAllRows == &quot;Y&quot;)
                    conn.DB.AddInParameter(cmd, &quot;ReturnAllRows&quot;, DbType.String, returnAllRows);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }


        internal DataTable GetActivity(int activityID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetActivity&quot;);
                conn.DB.AddInParameter(cmd, &quot;ACTIVITYID&quot;, DbType.Int32, activityID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetCheckListActivity(int activityID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTGetActivity&quot;);
                conn.DB.AddInParameter(cmd, &quot;ACTIVITYID&quot;, DbType.Int32, activityID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int CUDCheckListLinking(LandManagement landDTO, string operation, string multipleIDS)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTCUDLinking&quot;);

                if (operation != &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;NAME&quot;, DbType.String, landDTO.Name);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, landDTO.Description);
                    conn.DB.AddInParameter(cmd, &quot;LINKINGID&quot;, DbType.Int32, landDTO.LinkingID);
                    conn.DB.AddInParameter(cmd, &quot;CHKLISTID&quot;, DbType.Int32, landDTO.CheckListID);
                    conn.DB.AddInParameter(cmd, &quot;LANDMANAGEMENTXml&quot;, DbType.String, landDTO.LangMgtXML);
                }

                conn.DB.AddInParameter(cmd, &quot;OPERATION&quot;, DbType.String, operation);

                if (operation == &quot;D&quot;)
                {
                    conn.DB.AddInParameter(cmd, &quot;MULTIPLEIDS&quot;, DbType.String, multipleIDS);
                }

                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetCheckLists(object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string returnAllRows)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetCheckLists&quot;);

                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;SORTORDER&quot;, DbType.String, sortOrder);
                if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                if (returnAllRows == &quot;Y&quot;)
                    conn.DB.AddInParameter(cmd, &quot;ReturnAllRows&quot;, DbType.String, returnAllRows);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int GetCheckListsCount(string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetCheckLists&quot;);

                if (filterSearch != null)
                    conn.DB.AddInParameter(cmd, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                conn.DB.AddInParameter(cmd, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2().Parse2();
            }
        }

        internal DataTable[] GetCheckList(int checkListID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LANDMGTGetCheckList&quot;);
                conn.DB.AddInParameter(cmd, &quot;CHECKLISTID&quot;, DbType.Int32, checkListID);

                DataSet ds = conn.DB.ExecuteDataSet(cmd);

                return (new[] { ds.Tables[0], ds.Tables.Count == 0 ? null : ds.Tables[1] });
            }
        }

        internal int DeleteChecklistStage(string multipleIDS)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTDeleteStages&quot;);

                conn.DB.AddInParameter(cmd, &quot;MULTIPLEIDS&quot;, DbType.String, multipleIDS);
                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetChecklistStages(string moduleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTGetStages&quot;);
                conn.DB.AddInParameter(cmd, &quot;MODULEID&quot;, DbType.String, moduleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int DeleteChecklistFromLibrary(string checklistIDs)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTDeleteChecklists&quot;);

                conn.DB.AddInParameter(cmd, &quot;CHECKLISTIDS&quot;, DbType.String, checklistIDs);
                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        internal int ChecklistCUDStages(int stageID, string name, string description, string modeuleID, string mode)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CHKLISTCUDStages&quot;);

                conn.DB.AddInParameter(cmd, &quot;STAGEID&quot;, DbType.Int32, stageID);
                conn.DB.AddInParameter(cmd, &quot;NAME&quot;, DbType.String, name);
                conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, description);
                conn.DB.AddInParameter(cmd, &quot;MODULEID&quot;, DbType.String, modeuleID);
                conn.DB.AddInParameter(cmd, &quot;OPERATION&quot;, DbType.String, mode);
                conn.DB.AddInParameter(cmd, &quot;MULTIPLEIDS&quot;, DbType.String, &quot;NONE&quot;);
                conn.DB.AddOutParameter(cmd, &quot;RETURNVALUE&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;RETURNVALUE&quot;).ToString2().ToInt32_2();
            }
        }

        public DataTable GetOverheadGroups(int? type)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetOverheadGroups, null, type).Tables
                    [0];
        }

        public DataTable GetOverheadGroupDetails(int ID, string ModuleID, int ParentInstanceID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetOverheadGroupDetails, null,
                    new object[] { ID, ModuleID, ParentInstanceID }).Tables[0];
        }

        public string CUDOverheadGroups(int ID, string opn, string GroupName, string GroupDescription,
            string ParentGrpName, string ModuleID, int ParentInstanceID)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_LIBRARYCUDOverheadGroups, dic,
                new object[]
                {
                    ID, opn, GroupName, GroupDescription, ParentGrpName, ModuleID,
                    ParentInstanceID
                });
            return dic[&quot;@errorMsg&quot;].ToString2();
        }

        //Added for Prepayment Recovery Rules
        internal DataTable GetPrepaymentType()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetPrepaymentTypes&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Adds a new record to the selected PrepayRecoveryRule
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;nodeID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;Value&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;CatalogColumnID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;catalogRowID&quot;&gt;&lt;/param&gt;
        internal void AddPrepayRecoveryRules(int recoveryId, string recoveryRuleName, string description, int prepayMode,
            double percent, double amount, string mode)
        {
            try
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_LIBRARYCUDPrepaymentRecoveryRules, null, 0, recoveryRuleName, description,
                    prepayMode, percent, amount, mode);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }
        }

        #region State and City

        /// &lt;summary&gt;
        /// CUDG State from Library
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;StateID&quot;&gt;StateID. Pass 0 to get entire List with OP-G&lt;/param&gt;
        /// &lt;param name=&quot;State&quot;&gt;State&lt;/param&gt;
        /// &lt;param name=&quot;Description&quot;&gt;City Description&lt;/param&gt;
        /// &lt;param name=&quot;OP&quot;&gt;C-Create,U-Update,D-Delete,G-GetList&lt;/param&gt;
        /// &lt;returns&gt;DataSet&lt;/returns&gt;
        public DataSet CUDGLIBState(int StateID, string State, string Description, string OP)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYCUDGState, null,
                new object[] { StateID, State, Description, OP });
        }

        /// &lt;summary&gt;
        /// CUDG City from Library
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;StateID&quot;&gt;StateID&lt;/param&gt;
        /// &lt;param name=&quot;CityID&quot;&gt;CityID. Pass 0 to get entire List with OP-G&lt;/param&gt;
        /// &lt;param name=&quot;City&quot;&gt;City-Mandatory&lt;/param&gt;
        /// &lt;param name=&quot;Description&quot;&gt;City Description&lt;/param&gt;
        /// &lt;param name=&quot;OP&quot;&gt;C-Create,U-Update,D-Delete,G-GetList&lt;/param&gt;
        /// &lt;returns&gt;DataSet&lt;/returns&gt;
        public DataSet CUDGLIBCity(int StateID, int CityID, string City, string Description, string OP)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYCUDGCity, null,
                new object[] { StateID, CityID, City, Description, OP });
        }

        #endregion

        #region Land Type and Owner Type

        public DataSet GetLandTypes()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetLandTypes, null, null);
        }

        public DataSet GetOwnerTypes()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetOwnerTypes, null, null);
        }

        #endregion

        #region Submittals

        #endregion

        #region Resource Items

        /// &lt;summary&gt;
        /// Gets all Standard Items
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetResourceItems(string strAdditionalInfo, string resType, int MeasSysID, int startRowIdx,
            int maxRows, string sortOrder, string filterSearch)
        {
            try
            {
                //ConnectorParameters connectorParameters =
                //                  new ConnectorParameters(MethodInfo.GetCurrentMethod().DeclaringType.ToString2(), MethodInfo.GetCurrentMethod().Name.ToString2() + &quot;_&quot; + resType, AMP3ObjectType.Unknown,
                //                 new ConnectionFilter(EISPageDataManager.GetFilter(resType, filterSearch), sortOrder, startRowIdx, maxRows, null), null);


                /* MethodName and ClassName are hardcoded to coincide with the AX listmodel design */
                var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);

                switch (resType)
                {
                    case &quot;Material&quot;:
                        ClassNameForResType = &quot;LIBMATL&quot;;
                        break;
                    case &quot;Equipment&quot;:
                        ClassNameForResType = &quot;LIBEQMT&quot;;
                        break;
                    case &quot;manpower&quot;:
                    case &quot;Labour&quot;:
                        ClassNameForResType = &quot;LIBLABR&quot;;
                        break;
                    case &quot;SubContract&quot;:
                        ClassNameForResType = &quot;LIBSUBC&quot;;
                        break;
                }

                var connectorParameters =
                    new ConnectorParameters(dictAdditionalInfo, ClassNameForResType,
                        &quot;GetResourceList&quot;, AMP3ObjectType.Unknown,
                        new ConnectionFilter(filterSearch, sortOrder, startRowIdx, maxRows, null),
                        null);


                DataSet ds = new BrixDataSet();
                int count = 0;
                if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true))
                {
                    if (ds.Tables.Count &gt; 0)
                        return ds.Tables[0];
                    else
                        return null;
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetResourceItems&quot;);
                        conn.DB.AddInParameter(cmd, &quot;@in_resType&quot;, DbType.String, resType);
                        if (!string.IsNullOrEmpty(filterSearch))
                            conn.DB.AddInParameter(cmd, &quot;@filterText&quot;, DbType.String, filterSearch);
                        if (!string.IsNullOrEmpty(sortOrder))
                            conn.DB.AddInParameter(cmd, &quot;@sortOrder&quot;, DbType.String, sortOrder);
                        conn.DB.AddInParameter(cmd, &quot;@MeasSysID&quot;, DbType.Int32, MeasSysID);
                        conn.DB.AddInParameter(cmd, &quot;@rowStartIdx&quot;, DbType.Int32, startRowIdx);
                        conn.DB.AddInParameter(cmd, &quot;@maxRowsInPage&quot;, DbType.Int32, maxRows);
                        return conn.DB.ExecuteDataSet(cmd).Tables[0];
                    }
                }
            }

            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw ex;
                // return null; //TODO : Check if this statement is needed
            }
        }


        internal double GetResourceItemsCount(string strAdditionalInfo, string resType, int measSysID, string sortOrder,
            string filterSearch)
        {
            try
            {
                //ConnectorParameters connectorParameters =
                //             new ConnectorParameters(MethodInfo.GetCurrentMethod().DeclaringType.ToString2(), MethodInfo.GetCurrentMethod().Name.ToString2() + &quot;_&quot; + resType, AMP3ObjectType.Unknown,
                //            new ConnectionFilter(EISPageDataManager.GetFilter(resType, filterSearch), sortOrder, null, null, null), null);

                /* MethodName and ClassName are hardcoded to coincide with the AX listmodel design */
                var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);

                switch (resType)
                {
                    case &quot;Material&quot;:
                        ClassNameForResType = &quot;LIBMATL&quot;;
                        break;
                    case &quot;Equipment&quot;:
                        ClassNameForResType = &quot;LIBEQMT&quot;;
                        break;
                    case &quot;manpower&quot;:
                    case &quot;Labour&quot;:
                        ClassNameForResType = &quot;LIBLABR&quot;;
                        break;
                    case &quot;SubContract&quot;:
                        ClassNameForResType = &quot;LIBSUBC&quot;;
                        break;
                }

                var connectorParameters =
                    new ConnectorParameters(dictAdditionalInfo, ClassNameForResType,
                        &quot;GetResourcePageCount&quot;, AMP3ObjectType.Unknown,
                        new ConnectionFilter(filterSearch, sortOrder, null, null, null), null);
                DataSet ds = new BrixDataSet();
                int count = 0;
                if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true))
                {
                    return count;
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetResourceItems&quot;);
                        conn.DB.AddInParameter(cmd, &quot;@in_resType&quot;, DbType.String, resType);
                        if (!string.IsNullOrEmpty(filterSearch))
                            conn.DB.AddInParameter(cmd, &quot;@filterText&quot;, DbType.String, filterSearch);
                        if (!string.IsNullOrEmpty(sortOrder))
                            conn.DB.AddInParameter(cmd, &quot;@sortOrder&quot;, DbType.String, sortOrder);
                        conn.DB.AddInParameter(cmd, &quot;@MeasSysID&quot;, DbType.Int32, measSysID);
                        conn.DB.AddInParameter(cmd, &quot;@getCount&quot;, DbType.String, &quot;Y&quot;);

                        return conn.DB.ExecuteScalar(cmd).ToString2().Parse2();
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }


        internal DataSet GetLibraryResources(string resourceType)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetResources, null, resourceType);
        }

        /// &lt;summary&gt;
        /// Creates a Standard Table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CreateResourceItem(ResourceItem resDTO, string resType)
        {
            int resourceItemID;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYCreateResourceItem&quot;);

                        conn.DB.AddInParameter(cmd, &quot;@in_Description&quot;, DbType.String, resDTO.Description);
                        conn.DB.AddInParameter(cmd, &quot;@in_ResItemID&quot;, DbType.String, resDTO.ResItemID);
                        conn.DB.AddInParameter(cmd, &quot;@in_Unit&quot;, DbType.String, resDTO.Unit);
                        conn.DB.AddInParameter(cmd, &quot;@in_Rate&quot;, DbType.Decimal, resDTO.Rate);
                        conn.DB.AddInParameter(cmd, &quot;@in_Size&quot;, DbType.String, resDTO.Size);
                        conn.DB.AddInParameter(cmd, &quot;@in_Color&quot;, DbType.String, resDTO.Color);
                        conn.DB.AddInParameter(cmd, &quot;@in_Configuration&quot;, DbType.String, resDTO.Configuration);
                        conn.DB.AddInParameter(cmd, &quot;@in_resType&quot;, DbType.String, resType);

                        conn.DB.AddOutParameter(cmd, &quot;@out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        resourceItemID = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (resourceItemID &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                throw;
            }

            return resourceItemID;
        }

        /// &lt;summary&gt;
        /// Updates a Standard item for a standard table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;siDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int UpdateResourceItem(ResourceItem resDTO, string resType)
        {
            int resItemID;
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                try
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYUpdateResourceItem&quot;);
                        conn.DB.AddInParameter(cmd, &quot;@in_ID&quot;, DbType.String, resDTO.ID);
                        conn.DB.AddInParameter(cmd, &quot;@in_Description&quot;, DbType.String, resDTO.Description);
                        conn.DB.AddInParameter(cmd, &quot;@in_Unit&quot;, DbType.String, resDTO.Unit);
                        conn.DB.AddInParameter(cmd, &quot;@in_Rate&quot;, DbType.Decimal, resDTO.Rate);
                        conn.DB.AddInParameter(cmd, &quot;@in_resType&quot;, DbType.String, resType);

                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);
                        resItemID = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();

                        if (resItemID &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_LIBRARY);
                    throw;
                }
            }

            return resItemID;
        }

        /// &lt;summary&gt;
        /// Deletes the Standard item
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardItemID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteResourceItem(int resourceItemID, string resType)
        {
            int result;
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                try
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYDeleteResourceItem&quot;);

                        conn.DB.AddInParameter(cmd, &quot;@in_ID&quot;, DbType.Int32, resourceItemID);
                        conn.DB.AddInParameter(cmd, &quot;@in_resType&quot;, DbType.String, resType);
                        conn.DB.AddOutParameter(cmd, &quot;@out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);
                        result = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();

                        if (result &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                    throw;
                }
            }

            return result;
        }

        #endregion

        internal DataSet GetActivities(int measSysID, int startRowIdx, int maxRows, string sortOrder,
            string filterSearch)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetActivities, null, measSysID,
                filterSearch, startRowIdx, maxRows, sortOrder);
        }

        public DataSet GetCalendarList()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetCalendar, null);
        }

        public DataSet GetForecastCalendarList()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetForecastCalendar, null);
        }

        internal DataSet GetCalendarDetails(int calendarID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetCalendarDetails, null, calendarID);
        }

        internal DataSet GetForecastCalendarDetails(int calendarID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetForecastCalendarDetails, null, calendarID);
        }

        internal DataSet GetAuthorisedLibraryForms(int userID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_LIBRARYGetAuthorisedForms, null, userID);
        }

    }

    [Context(Name = Constants.MODID_LIBRARY)]
    public class LibraryBreadCrumb : BreadCrumbBase
    {
        public override string Title
        {
            get { return &quot;Library&quot;; }
        }

        public override string URL
        {
            get { return &quot;#&quot;; }
        }


        public override BreadCrumbBase parent
        {
            get { return new RootBreadCrumb(); }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[28,9,28,35,1],[29,9,29,10,1],[30,9,30,10,1],[32,9,32,48,1],[35,9,35,10,0],[36,13,36,44,0],[38,13,38,20,0],[38,22,38,38,0],[38,39,38,41,0],[38,42,38,50,0],[39,13,39,14,0],[40,17,40,72,0],[41,17,41,50,0],[43,17,43,47,0],[45,17,45,50,0],[46,17,46,61,0],[47,17,47,69,0],[48,17,48,73,0],[49,17,49,44,0],[50,21,50,75,0],[52,17,52,69,0],[53,17,53,18,0],[54,26,54,35,0],[54,37,54,60,0],[54,62,54,65,0],[55,21,55,22,0],[56,25,56,73,0],[57,25,57,48,0],[58,29,58,35,0],[60,25,60,54,0],[61,25,61,79,0],[62,30,62,39,0],[62,41,62,61,0],[62,63,62,66,0],[63,25,63,26,0],[64,29,64,61,0],[65,29,65,78,0],[66,29,66,51,0],[67,25,67,26,0],[68,25,68,47,0],[69,21,69,22,0],[70,17,70,18,0],[71,17,71,39,0],[73,17,73,39,0],[75,17,75,29,0],[76,17,76,53,0],[77,17,77,29,0],[83,17,84,87,0],[87,17,87,45,0],[88,21,88,60,0],[89,17,89,72,0],[92,22,92,31,0],[92,33,92,56,0],[92,58,92,61,0],[93,21,93,60,0],[97,13,97,14,0],[98,13,98,23,0],[99,9,99,10,0],[106,9,106,10,0],[108,13,108,14,0],[109,24,109,89,0],[110,17,110,18,0],[111,21,111,95,0],[112,21,112,66,0],[115,13,115,33,0],[116,13,116,14,0],[117,17,117,93,0],[118,17,118,23,0],[120,9,120,10,0],[123,9,123,10,0],[125,13,125,14,0],[126,24,126,89,0],[127,17,127,18,0],[128,21,128,66,0],[129,21,129,100,0],[131,21,131,95,0],[133,28,133,71,0],[134,21,134,22,0],[135,25,135,42,0],[136,29,136,75,0],[137,21,137,22,0],[138,21,138,37,0],[141,13,141,33,0],[142,13,142,14,0],[143,17,143,93,0],[144,17,144,23,0],[146,9,146,10,0],[153,9,153,10,0],[155,13,155,14,0],[156,24,156,89,0],[157,17,157,18,0],[158,21,158,98,0],[160,21,160,66,0],[163,13,163,33,0],[164,13,164,14,0],[165,17,165,93,0],[166,17,166,23,0],[168,9,168,10,0],[175,9,175,10,0],[177,13,177,14,0],[178,24,178,89,0],[179,17,179,18,0],[180,21,180,95,0],[182,21,182,86,0],[183,21,183,80,0],[185,21,185,50,0],[186,17,186,18,0],[187,13,187,14,0],[188,13,188,33,0],[189,13,189,14,0],[190,17,190,93,0],[191,17,191,23,0],[193,9,193,10,0],[200,9,200,10,0],[202,13,202,14,0],[203,24,203,89,0],[204,17,204,18,0],[205,21,205,95,0],[206,21,206,66,0],[208,28,208,71,0],[209,21,209,22,0],[210,25,210,42,0],[211,29,211,75,0],[212,21,212,22,0],[213,21,213,37,0],[216,13,216,33,0],[217,13,217,14,0],[218,17,218,93,0],[219,17,219,23,0],[221,9,221,10,0],[229,9,229,10,0],[231,13,231,14,0],[232,24,232,89,0],[233,17,233,18,0],[234,21,234,98,0],[236,21,236,92,0],[237,21,237,82,0],[239,21,239,70,0],[242,13,242,33,0],[243,13,243,14,0],[244,17,244,93,0],[245,17,245,23,0],[247,9,247,10,0],[255,9,255,10,0],[257,13,257,14,0],[258,24,258,89,0],[259,17,259,18,0],[260,21,260,95,0],[262,21,262,92,0],[264,21,264,82,0],[266,21,266,70,0],[269,13,269,33,0],[270,13,270,14,0],[271,17,271,93,0],[272,17,272,23,0],[274,9,274,10,0],[282,9,282,10,0],[284,13,284,14,0],[285,24,285,89,0],[286,17,286,18,0],[287,21,287,97,0],[289,21,289,89,0],[290,21,290,89,0],[292,21,292,66,0],[295,13,295,33,0],[296,13,296,14,0],[297,17,297,93,0],[298,17,298,23,0],[300,9,300,10,0],[308,9,308,10,0],[310,13,310,14,0],[311,24,311,89,0],[312,17,312,18,0],[313,21,313,97,0],[315,21,315,85,0],[316,21,316,91,0],[318,21,318,66,0],[321,13,321,33,0],[322,13,322,14,0],[323,17,323,93,0],[324,17,324,23,0],[326,9,326,10,0],[342,9,342,10,0],[344,13,344,14,0],[345,24,345,89,0],[346,17,346,18,0],[347,21,347,85,0],[348,21,348,100,0],[350,21,350,92,0],[351,21,351,95,0],[352,21,352,95,0],[353,21,353,96,0],[354,21,354,82,0],[355,21,355,92,0],[356,21,356,102,0],[357,21,357,94,0],[358,21,358,98,0],[359,21,359,50,0],[361,21,361,98,0],[364,13,364,33,0],[365,13,365,14,0],[366,17,366,93,0],[367,17,367,23,0],[369,9,369,10,0],[378,9,378,10,0],[380,13,380,14,0],[381,24,381,89,0],[382,17,382,18,0],[383,21,383,93,0],[385,21,385,99,0],[386,21,386,92,0],[387,21,387,82,0],[389,21,389,81,0],[392,13,392,33,0],[393,13,393,14,0],[394,17,394,93,0],[395,17,395,23,0],[397,9,397,10,0],[412,9,412,10,0],[414,13,414,14,0],[415,24,415,89,0],[416,17,416,18,0],[417,21,417,100,0],[419,21,419,104,0],[420,21,420,95,0],[421,21,421,95,0],[422,21,422,92,0],[423,21,423,102,0],[424,21,424,98,0],[425,21,425,94,0],[426,21,426,87,0],[427,21,427,50,0],[429,21,429,103,0],[432,13,432,33,0],[433,13,433,14,0],[434,17,434,93,0],[435,17,435,23,0],[437,9,437,10,0],[440,9,440,10,0],[442,13,442,14,0],[443,24,443,89,0],[444,17,444,18,0],[445,21,445,98,0],[447,21,447,104,0],[448,21,448,90,0],[450,21,450,50,0],[451,17,451,18,0],[452,13,452,14,0],[453,13,453,33,0],[454,13,454,14,0],[455,17,455,93,0],[456,17,456,23,0],[458,9,458,10,0],[466,9,466,10,0],[468,13,468,14,0],[469,24,469,89,0],[470,17,470,18,0],[471,21,471,100,0],[473,21,473,104,0],[474,21,474,92,0],[475,21,475,50,0],[476,17,476,18,0],[477,13,477,14,0],[478,13,478,33,0],[479,13,479,14,0],[480,17,480,93,0],[481,17,481,23,0],[483,9,483,10,0],[491,9,491,10,0],[493,13,493,14,0],[494,24,494,89,0],[495,17,495,18,0],[496,21,496,98,0],[498,21,498,86,0],[500,21,500,66,0],[503,13,503,33,0],[504,13,504,14,0],[505,17,505,93,0],[506,17,506,23,0],[508,9,508,10,0],[518,9,518,10,0],[520,13,520,14,0],[521,24,521,89,0],[522,17,522,18,0],[523,21,523,93,0],[525,21,525,104,0],[526,21,526,86,0],[527,21,527,92,0],[528,21,528,98,0],[529,21,529,50,0],[530,17,530,18,0],[531,13,531,14,0],[532,13,532,33,0],[533,13,533,14,0],[534,17,534,93,0],[535,17,535,23,0],[537,9,537,10,0],[545,9,545,10,0],[547,13,547,14,0],[548,24,548,89,0],[549,17,549,18,0],[550,21,550,97,0],[552,21,552,92,0],[553,21,553,82,0],[555,21,555,81,0],[558,13,558,33,0],[559,13,559,14,0],[560,17,560,93,0],[561,17,561,23,0],[563,9,563,10,0],[573,9,573,10,0],[575,13,575,14,0],[576,24,576,89,0],[577,17,577,18,0],[578,21,578,91,0],[580,21,580,104,0],[581,21,581,92,0],[582,21,582,99,0],[583,21,583,98,0],[584,21,584,50,0],[585,17,585,18,0],[586,13,586,14,0],[587,13,587,33,0],[588,13,588,14,0],[589,17,589,93,0],[590,17,590,23,0],[592,9,592,10,0],[600,9,600,10,0],[602,13,602,14,0],[603,24,603,89,0],[604,17,604,18,0],[605,21,605,93,0],[607,21,607,92,0],[608,21,608,98,0],[609,21,609,50,0],[610,17,610,18,0],[611,13,611,14,0],[612,13,612,33,0],[613,13,613,14,0],[614,17,614,93,0],[615,17,615,23,0],[617,9,617,10,0],[625,9,625,10,0],[627,13,627,14,0],[628,24,628,89,0],[629,17,629,18,0],[630,21,630,97,0],[632,21,632,92,0],[634,21,634,66,0],[637,13,637,33,0],[638,13,638,14,0],[639,17,639,93,0],[640,17,640,23,0],[642,9,642,10,0],[651,9,651,10,0],[653,13,653,14,0],[654,24,654,89,0],[655,17,655,18,0],[656,21,656,95,0],[658,21,658,92,0],[659,21,659,104,0],[660,21,660,85,0],[661,21,661,50,0],[663,21,663,101,0],[666,13,666,33,0],[667,13,667,14,0],[668,17,668,93,0],[669,17,669,23,0],[671,9,671,10,0],[678,9,678,10,0],[680,13,680,14,0],[681,24,681,89,0],[682,17,682,18,0],[683,21,683,97,0],[685,21,685,92,0],[686,21,686,50,0],[687,17,687,18,0],[688,13,688,14,0],[689,13,689,33,0],[690,13,690,14,0],[691,17,691,93,0],[692,17,692,23,0],[694,9,694,10,0],[702,9,702,10,0],[704,13,704,14,0],[705,24,705,89,0],[706,17,706,18,0],[707,21,707,90,0],[709,21,709,91,0],[711,21,711,89,0],[714,13,714,33,0],[715,13,715,14,0],[716,17,716,93,0],[717,17,717,23,0],[719,9,719,10,0],[728,9,728,10,0],[730,13,730,14,0],[731,24,731,89,0],[732,17,732,18,0],[733,21,733,97,0],[735,21,735,104,0],[736,21,736,94,0],[737,21,737,50,0],[738,17,738,18,0],[739,13,739,14,0],[740,13,740,33,0],[741,13,741,14,0],[742,17,742,93,0],[743,17,743,23,0],[745,9,745,10,0],[753,9,753,10,0],[755,13,755,14,0],[756,24,756,89,0],[757,17,757,18,0],[758,21,758,100,0],[760,21,760,86,0],[761,21,761,80,0],[762,21,762,50,0],[763,17,763,18,0],[764,13,764,14,0],[765,13,765,33,0],[766,13,766,14,0],[767,17,767,93,0],[768,17,768,23,0],[770,9,770,10,0],[777,9,777,10,0],[779,13,779,14,0],[780,24,780,89,0],[781,17,781,18,0],[782,21,782,98,0],[784,21,784,89,0],[786,21,786,66,0],[789,13,789,33,0],[790,13,790,14,0],[791,17,791,93,0],[792,17,792,23,0],[794,9,794,10,0],[802,9,802,10,0],[804,13,804,14,0],[805,24,805,89,0],[806,17,806,18,0],[807,21,807,99,0],[809,21,809,94,0],[810,21,810,90,0],[812,21,812,66,0],[815,13,815,33,0],[816,13,816,14,0],[817,17,817,93,0],[818,17,818,23,0],[820,9,820,10,0],[831,9,831,10,0],[833,13,833,14,0],[834,24,834,89,0],[835,17,835,18,0],[836,21,836,97,0],[838,21,838,91,0],[839,21,839,97,0],[840,21,840,89,0],[842,21,842,66,0],[845,13,845,33,0],[846,13,846,14,0],[847,17,847,93,0],[848,17,848,23,0],[850,9,850,10,0],[853,9,853,10,0],[855,13,855,14,0],[856,24,856,89,0],[857,17,857,18,0],[858,21,858,100,0],[860,21,860,92,0],[861,21,861,93,0],[862,21,862,82,0],[863,21,863,50,0],[865,21,865,83,0],[868,13,868,33,0],[869,13,869,14,0],[870,17,870,93,0],[871,17,871,23,0],[873,9,873,10,0],[877,9,877,10,0],[879,13,879,14,0],[880,24,880,89,0],[881,17,881,18,0],[882,21,882,98,0],[884,21,884,92,0],[885,21,885,43,0],[886,25,886,92,0],[888,25,888,101,0],[889,21,889,83,0],[891,21,891,66,0],[894,13,894,33,0],[895,13,895,14,0],[896,17,896,93,0],[897,17,897,23,0],[899,9,899,10,0],[908,9,908,10,0],[910,13,910,14,0],[911,24,911,89,0],[912,17,912,18,0],[913,21,913,98,0],[915,21,915,91,0],[916,21,916,98,0],[918,21,919,47,0],[922,13,922,33,0],[923,13,923,14,0],[924,17,924,93,0],[925,17,925,23,0],[927,9,927,10,0],[930,9,930,10,0],[932,13,932,14,0],[933,24,933,89,0],[934,17,934,18,0],[935,21,935,98,0],[937,21,937,99,0],[938,21,938,89,0],[939,21,939,98,0],[940,21,940,82,0],[942,21,942,81,0],[945,13,945,33,0],[946,13,946,14,0],[947,17,947,93,0],[948,17,948,23,0],[950,9,950,10,0],[954,9,954,10,0],[956,13,956,14,0],[957,24,957,89,0],[958,17,958,18,0],[959,21,959,97,0],[961,21,961,92,0],[962,21,962,82,0],[964,21,964,81,0],[967,13,967,33,0],[968,13,968,14,0],[969,17,969,93,0],[970,17,970,23,0],[972,9,972,10,0],[981,9,981,10,0],[983,13,983,14,0],[984,24,984,89,0],[985,17,985,18,0],[986,21,986,95,0],[988,21,988,86,0],[989,21,989,91,0],[991,21,991,66,0],[994,13,994,33,0],[995,13,995,14,0],[996,17,996,93,0],[997,17,997,23,0],[999,9,999,10,0],[1002,9,1002,10,0],[1004,13,1004,14,0],[1005,24,1005,89,0],[1006,17,1006,18,0],[1008,21,1008,94,0],[1010,21,1010,91,0],[1011,21,1011,87,0],[1013,28,1013,71,0],[1014,21,1014,22,0],[1015,25,1016,116,0],[1017,25,1017,39,0],[1018,25,1018,42,0],[1019,29,1019,68,0],[1020,21,1020,22,0],[1021,21,1021,40,0],[1024,13,1024,33,0],[1025,13,1025,14,0],[1026,17,1026,93,0],[1027,17,1027,23,0],[1029,9,1029,10,0],[1037,9,1037,10,0],[1039,13,1039,14,0],[1040,24,1040,89,0],[1041,17,1041,18,0],[1043,21,1043,96,0],[1044,28,1044,71,0],[1045,21,1045,22,0],[1046,25,1046,51,0],[1047,25,1047,39,0],[1048,25,1048,42,0],[1049,29,1049,66,0],[1050,21,1050,22,0],[1051,21,1051,38,0],[1054,13,1054,33,0],[1055,13,1055,14,0],[1056,17,1056,93,0],[1057,17,1057,23,0],[1059,9,1059,10,0],[1090,9,1090,10,0],[1092,13,1092,14,0],[1093,24,1093,89,0],[1094,17,1094,18,0],[1095,21,1095,104,0],[1096,21,1096,88,0],[1097,21,1097,66,0],[1100,13,1100,33,0],[1101,13,1101,14,0],[1102,17,1102,93,0],[1103,17,1103,23,0],[1105,9,1105,10,0],[1108,9,1108,10,0],[1109,20,1109,85,0],[1110,13,1110,14,0],[1111,17,1111,86,0],[1113,17,1113,38,0],[1114,17,1114,18,0],[1115,21,1115,91,0],[1116,21,1116,91,0],[1117,21,1117,105,0],[1118,17,1118,18,0],[1120,17,1120,84,0],[1122,17,1122,38,0],[1123,17,1123,18,0],[1124,21,1124,92,0],[1125,17,1125,18,0],[1127,17,1127,78,0],[1128,17,1128,46,0],[1130,17,1130,94,0],[1132,9,1132,10,0],[1136,9,1136,10,0],[1137,20,1137,85,0],[1138,13,1138,14,0],[1139,17,1139,86,0],[1141,17,1141,73,0],[1142,17,1142,72,0],[1143,21,1143,91,0],[1144,17,1144,68,0],[1145,21,1145,89,0],[1146,17,1146,39,0],[1147,21,1147,88,0],[1148,17,1148,73,0],[1149,21,1149,92,0],[1150,17,1150,42,0],[1151,21,1151,96,0],[1153,17,1153,62,0],[1155,9,1155,10,0],[1158,9,1158,10,0],[1159,20,1159,85,0],[1160,13,1160,14,0],[1161,17,1161,86,0],[1163,17,1163,42,0],[1164,21,1164,92,0],[1166,17,1166,77,0],[1167,17,1167,73,0],[1169,17,1169,94,0],[1171,9,1171,10,0],[1174,9,1174,10,0],[1175,20,1175,85,0],[1176,13,1176,14,0],[1177,17,1177,85,0],[1178,17,1178,79,0],[1180,17,1180,62,0],[1182,9,1182,10,0],[1185,9,1185,10,0],[1186,20,1186,85,0],[1187,13,1187,14,0],[1188,17,1190,80,0],[1192,17,1192,38,0],[1193,17,1193,18,0],[1194,21,1194,97,0],[1195,21,1195,94,0],[1196,21,1196,96,0],[1197,17,1197,18,0],[1199,17,1199,84,0],[1201,17,1201,38,0],[1202,17,1202,18,0],[1203,21,1203,92,0],[1204,17,1204,18,0],[1206,17,1206,51,0],[1207,17,1207,18,0],[1208,21,1208,94,0],[1209,21,1209,109,0],[1210,17,1210,18,0],[1212,17,1212,78,0],[1213,17,1213,46,0],[1215,17,1215,94,0],[1217,9,1217,10,0],[1221,9,1221,10,0],[1222,20,1222,85,0],[1223,13,1223,14,0],[1224,17,1224,90,0],[1226,17,1226,73,0],[1227,17,1227,72,0],[1228,21,1228,91,0],[1229,17,1229,68,0],[1230,21,1230,89,0],[1231,17,1231,39,0],[1232,21,1232,88,0],[1233,17,1233,73,0],[1234,21,1234,92,0],[1235,17,1235,42,0],[1236,21,1236,96,0],[1238,17,1238,62,0],[1240,9,1240,10,0],[1243,9,1243,10,0],[1244,20,1244,85,0],[1245,13,1245,14,0],[1246,17,1246,90,0],[1248,17,1248,42,0],[1249,21,1249,92,0],[1251,17,1251,77,0],[1252,17,1252,73,0],[1254,17,1254,94,0],[1256,9,1256,10,0],[1259,9,1259,10,0],[1260,20,1260,85,0],[1261,13,1261,14,0],[1262,17,1262,90,0],[1264,17,1264,42,0],[1265,21,1265,92,0],[1267,17,1267,77,0],[1268,17,1268,73,0],[1270,17,1270,94,0],[1272,9,1272,10,0],[1276,9,1276,10,0],[1277,20,1277,85,0],[1278,13,1278,14,0],[1279,17,1279,90,0],[1281,17,1281,73,0],[1282,17,1282,72,0],[1283,21,1283,91,0],[1284,17,1284,68,0],[1285,21,1285,89,0],[1286,17,1286,39,0],[1287,21,1287,88,0],[1288,17,1288,73,0],[1289,21,1289,92,0],[1290,17,1290,42,0],[1291,21,1291,96,0],[1293,17,1293,62,0],[1295,9,1295,10,0],[1299,9,1299,10,0],[1300,20,1300,85,0],[1301,13,1301,14,0],[1302,17,1302,88,0],[1303,17,1303,85,0],[1305,17,1305,62,0],[1307,9,1307,10,0],[1310,9,1310,10,0],[1311,20,1311,85,0],[1312,13,1312,14,0],[1313,17,1313,88,0],[1314,17,1314,85,0],[1316,17,1316,62,0],[1318,9,1318,10,0],[1321,9,1321,10,0],[1322,20,1322,85,0],[1323,13,1323,14,0],[1324,17,1324,87,0],[1326,17,1326,38,0],[1327,17,1327,18,0],[1328,21,1328,86,0],[1329,21,1329,100,0],[1330,21,1330,95,0],[1331,21,1331,97,0],[1332,21,1332,105,0],[1333,17,1333,18,0],[1335,17,1335,84,0],[1337,17,1337,38,0],[1338,17,1338,18,0],[1339,21,1339,92,0],[1340,17,1340,18,0],[1342,17,1342,78,0],[1343,17,1343,46,0],[1345,17,1345,94,0],[1347,9,1347,10,0],[1351,9,1351,10,0],[1352,20,1352,85,0],[1353,13,1353,14,0],[1354,17,1354,90,0],[1356,17,1356,73,0],[1357,17,1357,72,0],[1358,21,1358,91,0],[1359,17,1359,68,0],[1360,21,1360,89,0],[1361,17,1361,39,0],[1362,21,1362,88,0],[1363,17,1363,73,0],[1364,21,1364,92,0],[1365,17,1365,42,0],[1366,21,1366,96,0],[1368,17,1368,62,0],[1370,9,1370,10,0],[1373,9,1373,10,0],[1374,20,1374,85,0],[1375,13,1375,14,0],[1376,17,1376,90,0],[1378,17,1378,42,0],[1379,21,1379,92,0],[1381,17,1381,77,0],[1382,17,1382,73,0],[1384,17,1384,94,0],[1386,9,1386,10,0],[1389,9,1389,10,0],[1390,20,1390,85,0],[1391,13,1391,14,0],[1392,17,1392,89,0],[1393,17,1393,87,0],[1395,17,1395,58,0],[1397,17,1397,93,0],[1399,9,1399,10,0],[1402,9,1402,10,0],[1403,20,1403,85,0],[1404,13,1404,14,0],[1405,17,1405,89,0],[1407,17,1407,88,0],[1408,17,1408,78,0],[1409,17,1409,46,0],[1411,17,1411,94,0],[1413,9,1413,10,0],[1416,9,1416,10,0],[1417,20,1417,85,0],[1418,13,1418,14,0],[1419,17,1419,86,0],[1420,17,1420,82,0],[1421,17,1421,62,0],[1423,9,1423,10,0],[1426,9,1426,10,0],[1427,20,1427,85,0],[1428,13,1428,14,0],[1429,17,1429,93,0],[1431,17,1431,90,0],[1432,17,1432,78,0],[1433,17,1433,46,0],[1435,17,1435,94,0],[1437,9,1437,10,0],[1440,9,1440,10,0],[1441,20,1441,85,0],[1442,13,1442,14,0],[1443,17,1443,86,0],[1445,17,1445,79,0],[1446,17,1446,74,0],[1447,17,1447,88,0],[1448,17,1448,83,0],[1449,17,1449,79,0],[1450,17,1450,83,0],[1451,17,1451,78,0],[1452,17,1452,46,0],[1454,17,1454,94,0],[1456,9,1456,10,0],[1459,9,1459,10,0],[1460,13,1462,25,0],[1463,9,1463,10,0],[1466,9,1466,10,0],[1467,13,1469,80,0],[1470,9,1470,10,0],[1474,9,1474,10,0],[1475,13,1475,56,0],[1476,13,1481,20,0],[1482,13,1482,49,0],[1483,9,1483,10,0],[1487,9,1487,10,1],[1488,20,1488,85,1],[1489,13,1489,14,1],[1490,17,1490,95,1],[1491,17,1491,62,1],[1493,9,1493,10,1],[1504,9,1504,10,0],[1506,13,1506,14,0],[1507,17,1509,56,0],[1510,13,1510,14,0],[1511,13,1511,33,0],[1512,13,1512,14,0],[1513,17,1513,93,0],[1514,17,1514,23,0],[1516,9,1516,10,0],[1529,9,1529,10,0],[1530,13,1531,67,0],[1532,9,1532,10,0],[1544,9,1544,10,0],[1545,13,1546,74,0],[1547,9,1547,10,0],[1554,9,1554,10,0],[1555,13,1555,113,0],[1556,9,1556,10,0],[1559,9,1559,10,0],[1560,13,1560,114,0],[1561,9,1561,10,0],[1577,9,1577,10,0],[1579,13,1579,14,0],[1586,17,1586,78,0],[1587,17,1587,90,0],[1588,17,1588,93,0],[1589,17,1589,74,0],[1591,17,1591,33,0],[1594,25,1594,57,0],[1595,25,1595,31,0],[1597,25,1597,57,0],[1598,25,1598,31,0],[1601,25,1601,57,0],[1602,25,1602,31,0],[1604,25,1604,57,0],[1605,25,1605,31,0],[1608,17,1612,31,0],[1615,17,1615,48,0],[1616,17,1616,31,0],[1617,17,1617,113,0],[1618,17,1618,18,0],[1619,21,1619,45,0],[1620,25,1620,45,0],[1622,25,1622,37,0],[1625,17,1625,18,0],[1626,28,1626,93,0],[1627,21,1627,22,0],[1628,25,1628,101,0],[1629,25,1629,92,0],[1630,25,1630,65,0],[1631,29,1631,101,0],[1632,25,1632,62,0],[1633,29,1633,97,0],[1634,25,1634,92,0],[1635,25,1635,96,0],[1636,25,1636,94,0],[1637,25,1637,70,0],[1642,13,1642,33,0],[1643,13,1643,14,0],[1644,17,1644,93,0],[1645,17,1645,26,0],[1648,9,1648,10,0],[1653,9,1653,10,0],[1655,13,1655,14,0],[1661,17,1661,78,0],[1662,17,1662,90,0],[1663,17,1663,93,0],[1664,17,1664,74,0],[1666,17,1666,33,0],[1669,25,1669,57,0],[1670,25,1670,31,0],[1672,25,1672,57,0],[1673,25,1673,31,0],[1676,25,1676,57,0],[1677,25,1677,31,0],[1679,25,1679,57,0],[1680,25,1680,31,0],[1683,17,1686,96,0],[1687,17,1687,48,0],[1688,17,1688,31,0],[1689,17,1689,113,0],[1690,17,1690,18,0],[1691,21,1691,34,0],[1694,17,1694,18,0],[1695,28,1695,93,0],[1696,21,1696,22,0],[1697,25,1697,101,0],[1698,25,1698,92,0],[1699,25,1699,65,0],[1700,29,1700,101,0],[1701,25,1701,62,0],[1702,29,1702,97,0],[1703,25,1703,92,0],[1704,25,1704,86,0],[1706,25,1706,80,0],[1710,13,1710,33,0],[1711,13,1711,14,0],[1712,17,1712,26,0],[1714,9,1714,10,0],[1718,9,1718,10,0],[1719,13,1719,121,0],[1720,9,1720,10,0],[1728,9,1728,10,0],[1731,13,1731,14,0],[1732,24,1732,89,0],[1733,17,1733,18,0],[1734,21,1734,70,0],[1735,21,1735,35,0],[1736,21,1736,68,0],[1739,21,1739,22,0],[1740,25,1740,103,0],[1742,25,1742,107,0],[1743,25,1743,103,0],[1744,25,1744,93,0],[1745,25,1745,94,0],[1746,25,1746,93,0],[1747,25,1747,95,0],[1748,25,1748,111,0],[1749,25,1749,92,0],[1751,25,1751,86,0],[1752,25,1752,60,0],[1754,25,1754,99,0],[1755,25,1755,48,0],[1756,29,1756,43,0],[1758,29,1758,45,0],[1759,21,1759,22,0],[1760,21,1760,41,0],[1761,21,1761,22,0],[1762,25,1762,41,0],[1763,25,1763,101,0],[1764,25,1764,31,0],[1767,21,1767,22,0],[1768,25,1768,40,0],[1769,25,1769,42,0],[1770,21,1770,22,0],[1771,17,1771,18,0],[1772,13,1772,14,0],[1773,13,1773,33,0],[1774,13,1774,14,0],[1775,17,1775,93,0],[1776,17,1776,23,0],[1779,13,1779,35,0],[1780,9,1780,10,0],[1788,9,1788,10,0],[1790,20,1790,85,0],[1791,13,1791,14,0],[1793,17,1793,18,0],[1794,21,1794,70,0],[1795,21,1795,35,0],[1796,21,1796,68,0],[1799,21,1799,22,0],[1800,25,1800,103,0],[1801,25,1801,89,0],[1802,25,1802,107,0],[1803,25,1803,93,0],[1804,25,1804,94,0],[1805,25,1805,92,0],[1807,25,1807,85,0],[1808,25,1808,60,0],[1809,25,1809,94,0],[1811,25,1811,43,0],[1812,29,1812,43,0],[1814,29,1814,45,0],[1815,21,1815,22,0],[1816,21,1816,41,0],[1817,21,1817,22,0],[1818,25,1818,41,0],[1819,25,1819,101,0],[1820,25,1820,31,0],[1823,21,1823,22,0],[1824,25,1824,40,0],[1825,25,1825,42,0],[1826,21,1826,22,0],[1827,17,1827,18,0],[1828,17,1828,37,0],[1829,17,1829,18,0],[1830,21,1830,97,0],[1831,21,1831,27,0],[1833,13,1833,14,0],[1835,13,1835,30,0],[1836,9,1836,10,0],[1844,9,1844,10,0],[1846,20,1846,85,0],[1847,13,1847,14,0],[1849,17,1849,18,0],[1850,21,1850,70,0],[1851,21,1851,35,0],[1852,21,1852,68,0],[1855,21,1855,22,0],[1856,25,1856,103,0],[1858,25,1858,93,0],[1859,25,1859,92,0],[1860,25,1860,86,0],[1861,25,1861,60,0],[1862,25,1862,91,0],[1864,25,1864,40,0],[1865,29,1865,43,0],[1867,29,1867,45,0],[1868,21,1868,22,0],[1869,21,1869,41,0],[1870,21,1870,22,0],[1871,25,1871,41,0],[1872,25,1872,101,0],[1873,25,1873,31,0],[1876,21,1876,22,0],[1877,25,1877,40,0],[1878,25,1878,42,0],[1879,21,1879,22,0],[1880,17,1880,18,0],[1881,17,1881,37,0],[1882,17,1882,18,0],[1883,21,1883,97,0],[1884,21,1884,27,0],[1886,13,1886,14,0],[1888,13,1888,27,0],[1889,9,1889,10,0],[1895,9,1895,10,0],[1896,13,1897,64,0],[1898,9,1898,10,0],[1901,9,1901,10,1],[1902,13,1902,106,1],[1903,9,1903,10,1],[1906,9,1906,10,0],[1907,13,1907,114,0],[1908,9,1908,10,0],[1911,9,1911,10,1],[1912,13,1912,125,1],[1913,9,1913,10,1],[1916,9,1916,10,0],[1917,13,1917,133,0],[1918,9,1918,10,0],[1921,9,1921,10,0],[1922,13,1922,166,0],[1923,9,1923,10,0],[1932,17,1932,18,1],[1932,19,1932,36,1],[1932,37,1932,38,1],[1937,17,1937,18,1],[1937,19,1937,30,1],[1937,31,1937,32,1],[1943,17,1943,18,1],[1943,19,1943,47,1],[1943,48,1943,49,1]]);
    </script>
  </body>
</html>