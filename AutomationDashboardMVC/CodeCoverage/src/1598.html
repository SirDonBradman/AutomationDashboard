<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Equipment Hiring\ConcreateModels\EquipHiringReportModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.AMP3.WORKORDDTO;
using Aurigo.AMP3.ContractManager.BusinessLayer.DAC;
using Aurigo.AMP3.WORKORDBL;

namespace Aurigo.Brix.Construction.ContractManager.EquipmentHiringUI
{
    [ReportModelContext(Name = &quot;HIREQUP&quot;, HasFilter = true, ModuleId = &quot;EQUPHIR&quot;)]
    public class WorkOrderReportModel : ReportModel
    {
        private readonly string equipment = LocalizationManager.GetString(KeyConstants.LOC_ICA_EQUIPMENT).ToString2();
        private readonly string manpower = LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString2();

        public string WorkOrderIDFromAXReportModel = &quot;&quot;;

        public bool fromWorkOrderListModel;

        public Report reportObject;
        public string reportPathForAX = &quot;&quot;;

        public override string ReportPath
        {
            get
            {
                if (ReportCode.Equals(&quot;WO&quot;))
                    return &quot;../Modules/CONTMGT/Reports/WOBudgeReport.rpx&quot;;
                else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                    return &quot;../Modules/EQUPHIR/EHReqForQuotReport.rpx&quot;;
                else
                    return &quot;../Modules/EQUPHIR/EquipHiringReport.rpx&quot;;
            }
        }

        public string workOrderID
        {
            get { return WorkOrderIDFromAXReportModel; }
            set { WorkOrderIDFromAXReportModel = value; }
        }

        public bool FromWorkOrderListModel
        {
            get { return fromWorkOrderListModel; }
            set { fromWorkOrderListModel = value; }
        }

        public Report ReportObject
        {
            get { return reportObject; }
            set { reportObject = value; }
        }


        public override string Header
        {
            get
            {
                if (ReportCode.Equals(&quot;WO&quot;))
                    return &quot;Project Budget Status Summary Report&quot;;
                else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                    return &quot;Request For Quotation Report&quot;;
                else
                    return &quot;Work Order Report&quot;;
            }
        }

        public override string ReturnURL
        {
            get
            {
                if (Request[&quot;MODID&quot;].Equals(&quot;WORKORD&quot;))
                    return @&quot;~/Common/BrixListPage.aspx?context=WORKORD&amp;PID=&quot; + Request[&quot;PID&quot;] + &quot;&amp;ContractID=&quot; +
                           Request[&quot;ParentID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ParentID&quot;];
                else
                    return base.ReturnURL;
            }
        }

        public string WorkOrderID
        {
            get { return Request.QueryString[WOConstants.QRY_WORKORDERID]; }
        }

        public override BrixFilter[] GetApplyFilterLabels()
        {
            string purchId = &quot;&quot;;
            BrixFilter[] flr = null;
            DataTable dtPurchId = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(Request[&quot;WOID&quot;],
                                                                                           AMP3Object.WORKORD, ParentID,
                                                                                           AMP3Object.CONTMGT,
                                                                                           RegisteredEIS.AX);
            if (dtPurchId.Rows.Count &gt; 0)
            {
                purchId = dtPurchId.Rows[0][&quot;ERPId&quot;].ToString();
                DataTable poPostingJournalID =
                    AMP3.WORKORDBL.WOManager.Instance.GetAXPurchaseOrderJournals(
                        AdditionalInfo[&quot;AXCompany&quot;].ToString(), Request.QueryString[WOConstants.QRY_WORKORDERID],
                        Convert.ToString(ParentID));
                if (poPostingJournalID.Rows.Count &gt; 0)
                {
                    flr = new BrixFilter[2];
                    // AX Purchase Order
                    flr[0] = SetFilterAttributes(BrixFilter.Type.Text, &quot;txtAXPOID&quot;, &quot;Purchase Order&quot;);
                    flr[0].DataTextField = purchId;
                    //AX Purchase order Posting Journals
                    flr[1] = SetFilterAttributes(BrixFilter.Type.Combo, &quot;ddlAXPOPostingIds&quot;, &quot;Purchase Order Journal&quot;);
                    var filterValues = new string[poPostingJournalID.Rows.Count + 1];
                    filterValues[0] = &quot;Select,0&quot;;
                    for (int count = 1; count &lt;= poPostingJournalID.Rows.Count; count++)
                    {
                        filterValues[count] = poPostingJournalID.Rows[count - 1][&quot;PurchOrderDocNum&quot;] + &quot;,&quot; +
                                              poPostingJournalID.Rows[count - 1][&quot;PurchOrderDocNum&quot;];
                    }
                    flr[1].DataSource = GetComboDataSourceWithValues(filterValues);
                }
            }
            return flr;
        }

        public override Report GetReportObject(Dictionary&lt;string, string&gt; dicFilter)
        {
            if (ReportCode.Equals(&quot;WO&quot;))
                return GetProjectBudgetSummaryReport(dicFilter);
            else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                return GetRequestForQuotationReport(dicFilter);
            else
                return GetWorkOrderReport(dicFilter);
        }

        private Report GetProjectBudgetSummaryReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            Report[] subrpt;
            repObj.ReportPath = ReportPath;
            Report.RptControl[] rptctl;
            string path;

            subrpt = new Report[2];

            var subrptctl_0 = new Report.RptControl[6];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Date, ControlType.TextBox,
                                                        StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            path = &quot;../Modules/CONTMGT/Reports/subReportWO.rpx&quot;;
            subrpt[0] = SetSubReportAttributes(&quot;WOsHeader&quot;, &quot;subWorkOrders&quot;, subrptctl_0, path);
            subrpt[0].DataSource = ContMgtComponent.Instance.GetPBSSSubReport1(ParentID.ToInt32_2());

            var subrptctl_1 = new Report.RptControl[6];
            subrptctl_1[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);

            path = &quot;../Modules/CONTMGT/Reports/subReportGroups.rpx&quot;;
            subrpt[1] = SetSubReportAttributes(&quot;BudgetHeader&quot;, &quot;subGroupEstimate&quot;, subrptctl_1, path);
            subrpt[1].DataSource = ContMgtComponent.Instance.GetPBSSSubReport2(ParentID.ToInt32_2());

            rptctl = new Report.RptControl[32];
            rptctl[0] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox1&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[1] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox2&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[2] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox3&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[5] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[6] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.Header);           
            rptctl[7] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name&quot;, FormatType.None, ControlType.Label,
                                                 StyleType.HeaderDetails);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[11] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.Caption);
            rptctl[12] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label3&quot;, ControlType.Label, StyleType.Caption);
            rptctl[13] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label4&quot;, ControlType.Label, StyleType.Caption);
            rptctl[14] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label5&quot;, ControlType.Label, StyleType.Caption);
            rptctl[15] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Caption);
            rptctl[16] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label7&quot;, ControlType.Label, StyleType.Caption);
            rptctl[17] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);
            rptctl[18] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.Caption);
            rptctl[19] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label10&quot;, ControlType.Label, StyleType.Caption);
            rptctl[20] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);           
            rptctl[21] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label12&quot;, LocalizationManager.GetString(&quot;Contract&quot;), FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label13&quot;, ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;Label14&quot;, ControlType.Label, StyleType.Caption);
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);            
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[31] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.Caption);

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = ContMgtComponent.Instance.GetPBSSReport(ParentID.ToInt32_2());
            return repObj;
        }

        internal Report GetWorkOrderReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            var dt = new DataTable();
            if (ReportObject == null)
            {
                if (!string.IsNullOrEmpty(ReportPath))
                    repObj.ReportPath = ReportPath;
                if (!string.IsNullOrEmpty(Request.QueryString[WOConstants.QRY_WORKORDERID]))
                {
                    WorkOrderIDFromAXReportModel = Request.QueryString[WOConstants.QRY_WORKORDERID];
                }
            }
            else
                repObj = ReportObject;

            int subRptCount = 1;
            DataTable dtWOData = WORKORDManager.Instance.GetWOMainReport(ParentID.ToInt32_2(), workOrderID.ToInt32_2());
            if (dtWOData.Rows.Count &gt; 0)
            {
                dt = GetTaxesDataTable(dicFilter);
                if (dt.Rows.Count &gt; 0)
                    subRptCount++;
            }

            var subrpt = new Report[subRptCount];
            subRptCount = 0;
            Report.RptControl[] rptctl;
            string path;


            DataTable dtWOReport = WORKORDManager.Instance.GetWOMainReport(ParentID.ToInt32_2(),
                                                                           WorkOrderIDFromAXReportModel.ToInt32_2());
            DataTable dtEHWO =
                EquipmentHireOrderManager.Instance.GetEquipHireOrder(WorkOrderIDFromAXReportModel.ToInt32_2());
            if (dtWOReport.Rows[0][&quot;Status&quot;].Equals(&quot;Draft&quot;) || dtWOReport.Rows[0][&quot;Status&quot;].Equals(&quot;Approved&quot;))
            {
                dtEHWO.Columns[&quot;EstimatedUnitCost&quot;].ColumnName = &quot;UnitCost&quot;;
                dtEHWO.Columns[&quot;EstimatedAmount&quot;].ColumnName = &quot;Amount&quot;;
            }
            else
            {
                dtEHWO.Columns[&quot;ActualUnitCost&quot;].ColumnName = &quot;UnitCost&quot;;
                dtEHWO.Columns[&quot;WorkOrderAmount&quot;].ColumnName = &quot;Amount&quot;;
            }

            var subrptctl_0 = new Report.RptControl[8];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.UnitPrice,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, null, FormatType.Quantity,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtContractor&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[6] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[7] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, FormatType.Quantity, ControlType.TextBox,
                                                        StyleType.Detail);
            path = &quot;../Modules/EQUPHIR/EquipHiringItems.rpx&quot;;
            subrpt[subRptCount] = SetSubReportAttributes(&quot;GrpHeader&quot;, &quot;subRptItems&quot;, subrptctl_0, path);
            subrpt[subRptCount].DataSource = dtEHWO;
            subRptCount++;


            rptctl = new Report.RptControl[69];
            rptctl[0] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, null, FormatType.Amount, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[1] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label7&quot;, ControlType.Label, StyleType.Caption);
            rptctl[2] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtEndDate&quot;, null, FormatType.Date, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtStartDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[5] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblIssuedDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[6] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[7] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Header);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, ControlType.Label,
                                                   StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[11] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[12] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label3&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[13] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label4&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[14] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label5&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[15] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[16] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[17] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[18] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[19] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label21&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[20] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label22&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[21] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label12&quot;, ControlType.Label, StyleType.Caption);            
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label10&quot;, LocalizationManager.GetString(&quot;Unit&quot;), FormatType.None, ControlType.Label, StyleType.Caption);            
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label13&quot;, &quot;Unit Cost&quot;, FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label14&quot;, ControlType.Label, StyleType.Caption);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtProjectInspector&quot;, ControlType.TextBox,
                                                    StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtWorkDate&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[31] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[32] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[33] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[34] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblStatus&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[35] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[36] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label23&quot;, ControlType.Label, StyleType.HeaderDetails);           
            rptctl[37] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label24&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);           
            rptctl[38] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label25&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[39] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[40] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox5&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[41] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox6&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[42] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox7&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[43] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label26&quot;, &quot;No &quot; + ItemNameAbbr + &quot;s exist&quot;,
                                                    FormatType.None, ControlType.Label, StyleType.Detail);
            rptctl[44] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[45] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label27&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[46] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot; With &quot; + LocalizationManager.GetString(manpower), FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            rptctl[47] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label29&quot;, &quot; With &quot; + equipment, FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            rptctl[48] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[49] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox10&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[50] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label30&quot;, ControlType.Label, StyleType.Caption);
            rptctl[51] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblMaxPrepaymentValue&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[52] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtMaxPrepaymentValue&quot;, null, FormatType.Amount,
                                                    ControlType.TextBox, StyleType.Detail);
            rptctl[53] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionPercentagePerRABill&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[54] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionPercentagePerRABill&quot;, null,
                                                    FormatType.Quantity, ControlType.TextBox, StyleType.Detail);
            rptctl[55] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionCeilingPercentage&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[56] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionCeilingPercentage&quot;, null,
                                                    FormatType.Quantity, ControlType.TextBox, StyleType.Detail);
            rptctl[57] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionCeilingAmount&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[58] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionCeilingAmount&quot;, null, FormatType.Amount,
                                                    ControlType.TextBox, StyleType.Detail);
            rptctl[59] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionReleaseDate&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[60] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionReleaseDate&quot;, null, FormatType.Date,
                                                    ControlType.TextBox, StyleType.Detail);

            rptctl[61] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblPreparedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[62] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtPreparedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[63] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblApprovedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[64] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtApprovedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[65] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblIssuedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[66] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtIssuedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[67] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblExtReference&quot;, ControlType.Label, StyleType.Caption);
            rptctl[68] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtExtReference&quot;, ControlType.TextBox, StyleType.Detail);

            # region Work Order Taxes from Supreme

            if (dt.Rows.Count &gt; 0 &amp;&amp; dtWOData.Rows.Count &gt; 0)
            {
                var woTaxesrpt1_0 = new Report.RptControl[13];
                woTaxesrpt1_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxCode&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxBaseAmount&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxAmount&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[3] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxCode&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[4] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxBaseAmount&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[5] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxAmount&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[6] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblTaxCaption&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[7] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalAXTaxAmount&quot;, null,
                                                              FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[8] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalAXTaxAmount&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[9] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalWOAmount&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[10] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalWOAmount&quot;, null,
                                                               FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[11] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalAmountInclTax&quot;,
                                                               ControlType.Label, StyleType.Caption);
                woTaxesrpt1_0[12] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalAmountInclTax&quot;, null,
                                                               FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                path = &quot;../Modules/WORKORD/AXWOTaxes.rpx&quot;;
                subrpt[subRptCount] = SetSubReportAttributes(&quot;ReportFooter&quot;, &quot;subWOAXTaxes&quot;, woTaxesrpt1_0, path);
                dt.Columns.Add(&quot;WOAmount&quot;, typeof (Double));
                dt.Columns.Add(&quot;TotalAmount&quot;, typeof (Double));
                string amount =
                    Convert.ToDecimal(dt.Compute(&quot;sum(SourceTaxAmountCur)&quot;, &quot;&quot;)).ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                                                                                          CultureInfo.CurrentCulture);
                foreach (DataRow dr in dt.Rows)
                {
                    dr[&quot;TotalAmount&quot;] = Convert.ToDouble(amount) + Convert.ToDouble(dtWOData.Rows[0][&quot;EstimatedValue&quot;]);
                    dr[&quot;WOAmount&quot;] = Convert.ToDouble(dtWOData.Rows[0][&quot;EstimatedValue&quot;]);
                }
                subrpt[subRptCount].DataSource = dt;
            }

            # endregion

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = dtWOReport;
            return repObj;
        }

        // This method is created to call this method with parameters from Work Order project. This is only used for AX Connector for WO Issue.             This method is invoked from the EISWorkOrderListModel
        public Report GetWorkOrderReportWithParameters(Dictionary&lt;string, string&gt; dicFilter, string WOID,
                                                       string reportPath, string contractID)
        {
            //Set Report Path for AX COnnector
            var repObj = new Report();
            if (!string.IsNullOrEmpty(reportPath))
            {
                repObj.ReportPath = reportPath;
            }
            else
                repObj.ReportPath = ReportPath;

            ReportObject = repObj;
            //Set WorkOrderID
            if (!string.IsNullOrEmpty(WOID))
            {
                WorkOrderIDFromAXReportModel = WOID;
            }
            fromWorkOrderListModel = true;

            //Set ContractID
            ParentID = contractID;
            return GetWorkOrderReport(dicFilter);
        }

        public DataTable GetTaxesDataTable(Dictionary&lt;string, string&gt; dicFilter)
        {
            var dtWOTaxes = new DataTable();
            if (dicFilter != null)
            {
                if (dicFilter.ContainsKey(&quot;ddlAXPOPostingIds&quot;))
                {
                    string POJournalID = Convert.ToString(dicFilter[&quot;ddlAXPOPostingIds&quot;], CultureInfo.CurrentCulture);
                    if (!POJournalID.Equals(&quot;Select&quot;))
                    {
                        DataTable dtPurchId = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(Request[&quot;WOID&quot;],
                                                                                                       AMP3Object.
                                                                                                           WORKORD,
                                                                                                       ParentID,
                                                                                                       AMP3Object.
                                                                                                           CONTMGT,
                                                                                                       RegisteredEIS.AX);
                        string POID = &quot;&quot;;
                        if (dtPurchId.Rows.Count &gt; 0)
                        {
                            POID = dtPurchId.Rows[0][&quot;ERPId&quot;].ToString();
                        }

                        dtWOTaxes = AMP3.WORKORDBL.WOManager.Instance.GetTaxes(AdditionalInfo[&quot;AXCompany&quot;].ToString(),
                                                                               POID, POJournalID,
                                                                               Convert.ToString(ParentID));
                    }
                    else
                        return dtWOTaxes;
                }
            }
            else
                return dtWOTaxes;
            return dtWOTaxes;
        }


        public DataTable GetComboDataSourceWithValues(string[] values)
        {
            DataTable dtTemp = new BrixDataTable();
            dtTemp.Columns.Add(&quot;Value&quot;);
            dtTemp.Columns.Add(&quot;Name&quot;);
            dtTemp.AcceptChanges();

            foreach (string value in values)
            {
                DataRow dr = dtTemp.NewRow();
                dr[0] = value.Split(&#39;,&#39;)[1];
                dr[1] = value.Split(&#39;,&#39;)[0];
                dtTemp.Rows.Add(dr);
            }
            return dtTemp;
        }

        private Report GetRequestForQuotationReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            Report[] subrpt;

            repObj.ReportPath = ReportPath;
            Report.RptControl[] rptctl;
            string path;

            subrpt = new Report[1];
            var subrptctl_0 = new Report.RptControl[6];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, null, FormatType.Quantity,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtContractor&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            path = &quot;../Modules/EQUPHIR/EHReqForQuotItems.rpx&quot;;
            subrpt[0] = SetSubReportAttributes(&quot;GrpHeader&quot;, &quot;subRptItems&quot;, subrptctl_0, path);
            subrpt[0].DataSource = EquipmentHireOrderManager.Instance.GetEquipHireOrder(WorkOrderID.ToInt32_2());

            rptctl = new Report.RptControl[46];
            rptctl[0] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label7&quot;, null, FormatType.None, ControlType.Label,
                                                   StyleType.Caption);
            rptctl[1] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtEndDate&quot;, null, FormatType.Date, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[2] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtStartDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[5] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Header);
            rptctl[6] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, ControlType.Label,
                                                   StyleType.HeaderDetails);
            rptctl[7] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[11] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[12] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[13] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[14] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label21&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[15] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label22&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[16] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);
            rptctl[17] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.Caption);
            rptctl[18] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);           
            rptctl[19] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label10&quot;, LocalizationManager.GetString(&quot;Unit&quot;), FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[20] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label12&quot;, ControlType.Label, StyleType.Caption);
            rptctl[21] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label13&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Unit Cost&quot;, false),
                                                    FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label14&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Amount&quot;, false), FormatType.None,
                                                    ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label3&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Total Amount&quot;, false),
                                                    FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtProjectInspector&quot;, ControlType.TextBox,
                                                    StyleType.Detail);
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtWorkDate&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[31] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label23&quot;, ControlType.Label, StyleType.HeaderDetails);           
            rptctl[32] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label24&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);            
            rptctl[33] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label25&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[34] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[35] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox5&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[36] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox6&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[37] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox7&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[38] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label26&quot;, &quot;No &quot; + ItemNameAbbr + &quot;s exist&quot;,
                                                    FormatType.None, ControlType.Label, StyleType.Detail);
            rptctl[39] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[40] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label27&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[41] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label5&quot;, &quot; With &quot; + LocalizationManager.GetString(manpower), FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            rptctl[42] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot; With &quot; + equipment, FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            rptctl[43] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[44] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[45] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label29&quot;, ControlType.Label, StyleType.Caption);

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = WORKORDManager.Instance.GetWOMainReport(ParentID.ToInt32_2(),
                                                                        BrixDatatypeHelper.ToInt32_2(
                                                                            Request.QueryString[
                                                                                WOConstants.QRY_WORKORDERID]));
            return repObj;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,9,20,119,0],[21,9,21,117,0],[23,9,23,57,0],[28,9,28,44,0],[33,13,33,14,0],[34,17,34,45,0],[35,21,35,75,0],[36,22,36,58,0],[37,21,37,72,0],[39,21,39,71,0],[40,13,40,14,0],[45,17,45,18,0],[45,19,45,55,0],[45,56,45,57,0],[46,17,46,18,0],[46,19,46,56,0],[46,57,46,58,0],[51,17,51,18,0],[51,19,51,49,0],[51,50,51,51,0],[52,17,52,18,0],[52,19,52,50,0],[52,51,52,52,0],[57,17,57,18,0],[57,19,57,39,0],[57,40,57,41,0],[58,17,58,18,0],[58,19,58,40,0],[58,41,58,42,0],[65,13,65,14,0],[66,17,66,45,0],[67,21,67,67,0],[68,22,68,58,0],[69,21,69,59,0],[71,21,71,48,0],[72,13,72,14,0],[78,13,78,14,0],[79,17,79,56,0],[80,21,81,85,0],[83,21,83,43,0],[84,13,84,14,0],[89,17,89,18,0],[89,19,89,75,0],[89,76,89,77,0],[93,9,93,10,0],[94,13,94,33,0],[95,13,95,37,0],[96,13,99,110,0],[100,13,100,42,0],[101,13,101,14,0],[102,17,102,65,0],[103,17,106,53,0],[107,17,107,55,0],[108,17,108,18,0],[109,21,109,45,0],[111,21,111,103,0],[112,21,112,52,0],[114,21,114,120,0],[115,21,115,86,0],[116,21,116,50,0],[117,26,117,39,0],[117,41,117,79,0],[117,81,117,88,0],[118,21,118,22,0],[119,25,120,102,0],[121,21,121,22,0],[122,21,122,84,0],[123,17,123,18,0],[124,13,124,14,0],[125,13,125,24,0],[126,9,126,10,0],[129,9,129,10,0],[130,13,130,41,0],[131,17,131,65,0],[132,18,132,54,0],[133,17,133,64,0],[135,17,135,54,0],[136,9,136,10,0],[139,9,139,10,0],[140,13,140,39,0],[142,13,142,44,0],[146,13,146,36,0],[148,13,148,56,0],[149,13,150,96,0],[151,13,152,75,0],[153,13,153,118,0],[154,13,154,118,0],[155,13,155,118,0],[156,13,156,117,0],[157,13,157,65,0],[158,13,158,97,0],[159,13,159,102,0],[161,13,161,56,0],[162,13,163,96,0],[164,13,165,96,0],[166,13,167,96,0],[168,13,169,96,0],[170,13,171,96,0],[172,13,172,117,0],[174,13,174,69,0],[175,13,175,103,0],[176,13,176,102,0],[178,13,178,48,0],[179,13,180,91,0],[181,13,182,91,0],[183,13,184,91,0],[185,13,186,91,0],[187,13,188,91,0],[189,13,189,118,0],[190,13,190,114,0],[191,13,192,75,0],[193,13,193,118,0],[194,13,195,70,0],[196,13,196,120,0],[197,13,197,114,0],[198,13,198,114,0],[199,13,199,114,0],[200,13,200,114,0],[201,13,201,114,0],[202,13,202,117,0],[203,13,203,117,0],[204,13,204,117,0],[205,13,205,118,0],[206,13,206,118,0],[207,13,207,178,0],[208,13,208,118,0],[209,13,209,118,0],[210,13,210,119,0],[211,13,211,121,0],[212,13,212,120,0],[213,13,213,196,0],[214,13,214,117,0],[215,13,215,116,0],[216,13,216,117,0],[217,13,217,115,0],[219,13,219,41,0],[220,13,220,40,0],[221,13,221,95,0],[222,13,222,27,0],[223,9,223,10,0],[226,9,226,10,0],[227,13,227,39,0],[228,13,228,38,0],[229,13,229,38,0],[230,13,230,14,0],[231,17,231,55,0],[232,21,232,52,0],[233,17,233,93,0],[234,17,234,18,0],[235,21,235,101,0],[236,17,236,18,0],[237,13,237,14,0],[239,17,239,39,0],[241,13,241,33,0],[242,13,242,121,0],[243,13,243,41,0],[244,13,244,14,0],[245,17,245,51,0],[246,17,246,39,0],[247,21,247,35,0],[248,13,248,14,0],[250,13,250,50,0],[251,13,251,29,0],[256,13,257,118,0],[258,13,259,112,0],[260,13,260,113,0],[261,13,261,14,0],[262,17,262,77,0],[263,17,263,73,0],[264,13,264,14,0],[266,13,266,14,0],[267,17,267,74,0],[268,17,268,73,0],[269,13,269,14,0],[271,13,271,56,0],[272,13,273,96,0],[274,13,275,96,0],[276,13,277,96,0],[278,13,278,123,0],[279,13,279,117,0],[280,13,280,118,0],[281,13,281,118,0],[282,13,283,75,0],[284,13,284,62,0],[285,13,285,105,0],[286,13,286,53,0],[287,13,287,27,0],[290,13,290,48,0],[291,13,292,70,0],[293,13,293,113,0],[294,13,295,70,0],[296,13,297,91,0],[298,13,299,91,0],[300,13,301,91,0],[302,13,302,118,0],[303,13,303,113,0],[304,13,305,77,0],[306,13,306,118,0],[307,13,307,120,0],[308,13,308,120,0],[309,13,309,120,0],[310,13,310,120,0],[311,13,311,120,0],[312,13,312,121,0],[313,13,313,121,0],[314,13,314,121,0],[315,13,315,121,0],[316,13,316,121,0],[317,13,317,121,0],[318,13,318,115,0],[319,13,319,115,0],[320,13,320,114,0],[321,13,321,115,0],[322,13,322,171,0],[323,13,323,145,0],[324,13,324,115,0],[325,13,325,120,0],[326,13,327,71,0],[328,13,328,120,0],[329,13,329,117,0],[330,13,330,117,0],[331,13,331,117,0],[332,13,332,118,0],[333,13,333,120,0],[334,13,334,121,0],[335,13,335,197,0],[336,13,336,197,0],[337,13,337,117,0],[338,13,338,117,0],[339,13,339,117,0],[340,13,340,117,0],[341,13,342,107,0],[343,13,343,117,0],[344,13,344,121,0],[345,13,346,97,0],[347,13,348,97,0],[349,13,349,117,0],[350,13,350,118,0],[351,13,351,115,0],[352,13,353,72,0],[354,13,355,92,0],[356,13,357,72,0],[358,13,359,113,0],[360,13,361,72,0],[362,13,363,113,0],[364,13,365,72,0],[366,13,367,92,0],[368,13,369,72,0],[370,13,371,92,0],[373,13,373,124,0],[374,13,374,125,0],[375,13,375,124,0],[376,13,376,125,0],[377,13,377,122,0],[378,13,378,123,0],[379,13,379,123,0],[380,13,380,124,0],[384,13,384,62,0],[385,13,385,14,0],[386,17,386,63,0],[387,17,388,102,0],[389,17,390,102,0],[391,17,392,102,0],[393,17,394,82,0],[395,17,396,82,0],[397,17,398,82,0],[399,17,400,82,0],[401,17,402,121,0],[403,17,404,82,0],[405,17,406,82,0],[407,17,408,122,0],[409,17,410,102,0],[411,17,412,122,0],[413,17,413,59,0],[414,17,414,115,0],[415,17,415,61,0],[416,17,416,64,0],[417,17,419,119,0],[420,17,420,24,0],[420,26,420,36,0],[420,37,420,39,0],[420,40,420,47,0],[421,17,421,18,0],[422,21,422,121,0],[423,21,423,91,0],[424,17,424,18,0],[425,17,425,53,0],[426,13,426,14,0],[430,13,430,41,0],[431,13,431,40,0],[432,13,432,44,0],[433,13,433,27,0],[434,9,434,10,0],[439,9,439,10,0],[441,13,441,39,0],[442,13,442,51,0],[443,13,443,14,0],[444,17,444,48,0],[445,13,445,14,0],[447,17,447,48,0],[449,13,449,35,0],[451,13,451,45,0],[452,13,452,14,0],[453,17,453,53,0],[454,13,454,14,0],[455,13,455,43,0],[458,13,458,35,0],[459,13,459,50,0],[460,9,460,10,0],[463,9,463,10,0],[464,13,464,45,0],[465,13,465,35,0],[466,13,466,14,0],[467,17,467,64,0],[468,17,468,18,0],[469,21,469,119,0],[470,21,470,55,0],[471,21,471,22,0],[472,25,478,122,0],[479,25,479,42,0],[480,25,480,54,0],[481,25,481,26,0],[482,29,482,74,0],[483,25,483,26,0],[485,25,487,108,0],[488,21,488,22,0],[490,25,490,42,0],[491,17,491,18,0],[492,13,492,14,0],[494,17,494,34,0],[495,13,495,30,0],[496,9,496,10,0],[500,9,500,10,0],[501,13,501,52,0],[502,13,502,41,0],[503,13,503,40,0],[504,13,504,36,0],[506,13,506,20,0],[506,22,506,34,0],[506,35,506,37,0],[506,38,506,44,0],[507,13,507,14,0],[508,17,508,46,0],[509,17,509,45,0],[510,17,510,45,0],[511,17,511,37,0],[512,13,512,14,0],[513,13,513,27,0],[514,9,514,10,0],[517,9,517,10,0],[518,13,518,39,0],[521,13,521,44,0],[525,13,525,36,0],[526,13,526,56,0],[527,13,528,96,0],[529,13,529,123,0],[530,13,530,117,0],[531,13,531,118,0],[532,13,532,118,0],[533,13,533,118,0],[534,13,534,63,0],[535,13,535,95,0],[536,13,536,114,0],[538,13,538,48,0],[539,13,540,71,0],[541,13,542,70,0],[543,13,544,91,0],[545,13,546,91,0],[547,13,547,118,0],[548,13,548,113,0],[549,13,550,77,0],[551,13,551,118,0],[552,13,552,119,0],[553,13,553,119,0],[554,13,554,121,0],[555,13,555,121,0],[556,13,556,121,0],[557,13,557,121,0],[558,13,558,121,0],[559,13,559,121,0],[560,13,560,115,0],[561,13,561,115,0],[562,13,562,114,0],[563,13,563,171,0],[564,13,564,115,0],[565,13,567,108,0],[568,13,570,91,0],[571,13,573,108,0],[574,13,574,120,0],[575,13,576,71,0],[577,13,577,120,0],[578,13,578,117,0],[579,13,579,117,0],[580,13,580,117,0],[581,13,581,120,0],[582,13,582,121,0],[583,13,583,197,0],[584,13,584,197,0],[585,13,585,117,0],[586,13,586,117,0],[587,13,587,117,0],[588,13,588,117,0],[589,13,590,107,0],[591,13,591,117,0],[592,13,592,121,0],[593,13,594,97,0],[595,13,596,97,0],[597,13,597,117,0],[598,13,598,116,0],[599,13,599,115,0],[601,13,601,41,0],[602,13,602,40,0],[603,13,606,112,0],[607,13,607,27,0],[608,9,608,10,0]]);
    </script>
  </body>
</html>