<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Land Manager\UI\ParcelDetails.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Web.UI;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.LandMangement.BusinessLayer.BL;
using Aurigo.AMP3.LandMangement.BusinessLayer.DTO;
using Aurigo.AMP3.LibraryBL;
using Aurigo.AMP3.LibraryDAC;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.DataAccess.Core;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebDataInput;

namespace Aurigo.AMP3.LandMangement.UI
{
    public partial class ParcelDetails : BrixPageBase, ICallbackEventHandler
    {
        private string callback;
        private bool enterpriseLevel;
        private Mode mode = Mode.View;
        protected ModalPopupExtender mpItems;

        /// &lt;summary&gt;
        /// attachments control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::Aurigo.AMP3.Core.UserControls.AttachmentsControl attachments;

        protected UltraWebGrid uwgAttr;
        protected UltraWebGrid uwgResource;
        protected WebNumericEdit wneFinalRate;
        protected WebNumericEdit wneAskingRate;
        protected WebNumericEdit wneMarketRate;
        protected UltraWebGrid grdStagesAndActivities;

        #region ICallbackEventHandler Members

        public override string GetCallbackResult()
        {
            return callback;
        }

        void ICallbackEventHandler.RaiseCallbackEvent(string eventArgument)
        {
            var dt = new DateTime();
            try
            {
                dt = DateTime.Parse(eventArgument, DateFormatCulture.GetDateFormatCulture());
                callback = &quot;1&quot;;
            }
            catch (Exception)
            {
                callback = &quot;0&quot;;
            }
        }

        #endregion

        protected override void OnPreInit(EventArgs e)
        {
            int projectID = 0;
            projectID = (String.IsNullOrEmpty(Request[&quot;PID&quot;])) ? 0 : Request[&quot;PID&quot;].ToInt32_2();

            ModuleId = (projectID == 0) ? &quot;LANDMGT&quot; : &quot;PROJECT&quot;;

            base.OnPreInit(e);
        }


        protected override void CreateChildControls()
        {
            var menus = new MenuArray();

            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;Icn_Edit.png&quot;, 55));
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));

            CreateToolBarMenu(menus, null);
        }


        protected override void CustomizeToolBar()
        {

            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;

            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += btnSave_Click;
                    lnkSave.OnClientClick = &quot;return Validate();&quot;;
                }
            }

            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Click += btnEdit_Click;
            }


        }


        protected void Page_Load(object sender, EventArgs e)
        {
            try
            {
                // Disabling the role combo box
                UIHelper.DisableRoleSelection(Page);

                if (!string.IsNullOrEmpty(Request[&quot;Mode&quot;]))
                    mode = Request[&quot;Mode&quot;].Equals(Mode.New.ToString2())
                               ? Mode.New
                               : Request[&quot;Mode&quot;].Equals(Mode.Edit.ToString2()) ? Mode.Edit : Mode.View;

                List&lt;string&gt; featurelist = ModuleManager.Instance.GetPermissionByUserOrRole(&quot;LANDMGT&quot;, UserDetail.GetCurrentUserDetail().UID,
                                                                                      UserDetail.GetCurrentUserDetail().RID, 0);
                switch (mode)
                {
                    case Mode.New:
                        if (!featurelist.Contains(&quot;Create&quot;))
                            mode = Mode.View;
                        break;
                    case Mode.Edit:
                        if (!(featurelist.Contains(&quot;Edit&quot;) || featurelist.Contains(&quot;EditRate&quot;)))
                            mode = Mode.View;
                        break;
                }


                if (!IsPostBack)
                {
                    //DataTable landDetails =
                    //    ComponentHelper.Instance.ExecuteDataSet(
                    //        &quot;SELECT LANDNAME,DESCRIPTION FROM LANDMGTMaster WHERE MasterID = &quot; +
                    //        Convert.ToInt32(Request[&quot;LMID&quot;])).Tables[0];
                    DataTable landDetails = LandMangementManager.Instance.GetLandDetails(Request[&quot;LMID&quot;].ToInt32_2());
                    if (landDetails.Rows.Count &gt; 0)
                    {
                        txtName.Text = landDetails.Rows[0][&quot;LANDNAME&quot;].ToString();
                        txtDescription.Text = landDetails.Rows[0][&quot;DESCRIPTION&quot;].ToString();
                    }

                    ddlStatus.DataSource = CoreDatabaseHelper.GenericLibraryGetData(&quot;LANDMGTStatus&quot;, &quot;&quot;, 0);
                    ddlStatus.DataTextField = ddlStatus.DataValueField = &quot;Name&quot;;
                    ddlStatus.DataBind();

                    DataTable dtCheckList = LibraryInterface.Instance.GetCheckLists(null, null, String.Empty,
                                                                                    String.Empty, &quot;Y&quot;);

                    ddlCheckList.DataSource = dtCheckList;
                    ddlCheckList.DataTextField = &quot;Name&quot;;
                    ddlCheckList.DataValueField = &quot;RegisterID&quot;;
                    ddlCheckList.DataBind();

                    ddlCheckList.Items.Insert(0, new ListItem(&quot;Select One&quot;, &quot;0&quot;));

                    ddlLandType.DataSource = LibraryComponent.Instance.GetLandTypes();
                    ddlLandType.DataTextField = &quot;LandType&quot;;
                    ddlLandType.DataValueField = &quot;LandTypeID&quot;;
                    ddlLandType.DataBind();
                    ddlLandType.Items.Insert(0, new ListItem(&quot;Select&quot;, &quot;-1&quot;));

                    ddlOwnerType.DataSource = LibraryComponent.Instance.GetOwnerTypes();
                    ddlOwnerType.DataTextField = &quot;OwnerType&quot;;
                    ddlOwnerType.DataValueField = &quot;OwnerTypeID&quot;;
                    ddlOwnerType.DataBind();
                    ddlOwnerType.Items.Insert(0, new ListItem(&quot;Select&quot;, &quot;-1&quot;));

                    BindToMainGrid();

                    attachments.InstanceID = Request[&quot;ParcelID&quot;];
                    attachments.SrcType = &quot;LANDPAR&quot;;
                    attachments.ReadOnly = false;


                    txtNotes.Attributes.Add(&quot;MaxLength&quot;, &quot;1000&quot;);
                    if (mode == Mode.Edit || mode == Mode.View)
                    {
                        DataTable dt = LandMangementManager.Instance.GetParcel(Request[&quot;ParcelID&quot;].ToInt32_2());


                        if (dt.Rows.Count &gt; 0)
                        {
                            DataRow dr = dt.Rows[0];
                            txtArea.Text = dr[LMConstants.COL_AREA].ToString2();
                            txtContactInfo.Text = dr[LMConstants.COL_CONTACTINFO].ToString2();
                            txtDescription.Text = dr[LMConstants.COL_DESCRIPTION].ToString2();
                            ddlLandType.Text = dr[LMConstants.COL_LANDTYPE].ToString2();
                            txtName.Text = dr[LMConstants.COL_NAME].ToString2();
                            txtNotes.Text = dr[LMConstants.COL_NOTES].ToString2();
                            ddlOwnerType.Text = dr[LMConstants.COL_OWNERTYPE].ToString2();
                            txtOwnerDetails.Text = dr[LMConstants.COL_OWNERDETAILS].ToString2();
                            wneAskingRate.ValueDecimal = dr[LMConstants.COL_ASKINGRATE].ToString2().ToDecimal2();
                            wneFinalRate.ValueDecimal = dr[LMConstants.COL_FINALRATE].ToString2().ToDecimal2();
                            wneMarketRate.ValueDecimal = dr[LMConstants.COL_MARKETRATE].ToString2().ToDecimal2();
                            hdnMode.Value = mode.ToString2();
                            PopulateAttributesGrid();

                            tdMarket.Visible =
                                lblMarketRate.Visible =
                                tdAsking.Visible =
                                lblAskingRate.Visible =
                                tdFinaRate.Visible = lblFinalRate.Visible = featurelist.Contains(&quot;ViewRate&quot;);
                            if (mode == Mode.Edit &amp;&amp; featurelist.Contains(&quot;EditRate&quot;))
                            {
                                wneMarketRate.ReadOnly = wneAskingRate.ReadOnly = wneFinalRate.ReadOnly = false;
                                tdMarket.Visible = tdAsking.Visible = tdFinaRate.Visible = true;
                            }
                            else if (mode == Mode.Edit &amp;&amp; featurelist.Contains(&quot;ViewRate&quot;) &amp;&amp;
                                     !featurelist.Contains(&quot;EditRate&quot;))
                            {
                                wneMarketRate.ReadOnly = wneAskingRate.ReadOnly = wneFinalRate.ReadOnly = true;
                            }
                            else if (mode == Mode.Edit)
                                tdMarket.Visible =
                                    tdAsking.Visible =
                                    tdFinaRate.Visible =
                                    wneMarketRate.Visible = wneAskingRate.Visible = wneFinalRate.Visible = false;

                            ddlStatus.SelectedValue = dr[LMConstants.COL_STATUS].ToString2();
                        }

                        if (mode == Mode.View)
                        {

                            txtNotes.CssClass = txtName.CssClass =
                                                txtDescription.CssClass =
                                                txtContactInfo.CssClass =
                                                txtArea.CssClass = txtOwnerDetails.CssClass = &quot;readonlytext&quot;;

                            lblErrName.Visible =
                                txtNotes.Visible =
                                txtDescription.Visible =
                                wneAskingRate.Visible = wneFinalRate.Visible = wneMarketRate.Visible =
                                                                               !(lblNotes.Visible =
                                                                                 lblDescription.Visible =
                                                                                 lblAskingRate.Visible =
                                                                                 lblMarketRate.Visible =
                                                                                 lblFinalRate.Visible = true);
                            lblNotes.Text = txtNotes.Text;
                            lblDescription.Text = txtDescription.Text;
                            lblAskingRate.Text =
                                Convert.ToDouble(wneAskingRate.Value, CultureInfo.CurrentCulture).ToString(
                                    AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                            lblFinalRate.Text =
                                Convert.ToDouble(wneFinalRate.Value, CultureInfo.CurrentCulture).ToString(
                                    AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                            lblMarketRate.Text =
                                Convert.ToDouble(wneMarketRate.Value, CultureInfo.CurrentCulture).ToString(
                                    AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                            ddlLandType.Enabled = ddlOwnerType.Enabled = ddlStatus.Enabled = false;
                            ((AttachmentsControl)attachments).ReadOnly = true;
                            tdMarket.Visible =
                                lblMarketRate.Visible =
                                tdAsking.Visible =
                                lblAskingRate.Visible =
                                tdFinaRate.Visible = lblFinalRate.Visible = featurelist.Contains(&quot;ViewRate&quot;);
                        }
                        else if (mode == Mode.New)
                        {
                            txtNotes.Text = txtName.Text =
                                            txtDescription.Text =
                                            txtContactInfo.Text = txtArea.Text = txtOwnerDetails.Text = String.Empty;
                        }
                    }
                    if (mode == Mode.Edit || mode == Mode.New)
                    {
                        btnBack.Visible = false;

                        txtNotes.ReadOnly = txtName.ReadOnly =
                                            txtDescription.ReadOnly = txtContactInfo.ReadOnly =
                                                                      txtArea.ReadOnly =
                                                                      txtOwnerDetails.ReadOnly = false;
                    }

                    if (Request[&quot;Mode&quot;] == &quot;New&quot;)
                    {
                        lnkNew.Enabled = lnkDelete.Enabled = btnMainSave.Enabled = false;
                        hdnMode.Value = ModeTypes.New.ToString2();
                        PopulateAttributesGrid();
                    }
                }

                enterpriseLevel = (!String.IsNullOrEmpty(Request[&quot;ENTPRSE_LM&quot;]) &amp;&amp; Request[&quot;ENTPRSE_LM&quot;] == &quot;Y&quot;)
                                      ? true
                                      : false;
                RegisterCallBackScript();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
                lblError.Text = ex.Message;
            }
        }

        private void PopulateAttributesGrid()
        {
            try
            {
                if (Request[&quot;Mode&quot;].Equals(ModeTypes.New.ToString2()))
                {
                    uwgAttr.DataSource = ProjectManager.Instance.GetAttributes(&quot;LANDMGT&quot;, false, true);
                    uwgAttr.DataBind();
                }
                IQueryable&lt;AttributesMaster&gt; parcelAttribs = ProjectManager.Instance.GetAttributes(&quot;LANDMGT&quot;, false,
                                                                                                   null);


                if (parcelAttribs.Count() &gt; 0 &amp;&amp; !Request[&quot;Mode&quot;].Equals(ModeTypes.View.ToString2()))
                {
                    btnAddAttributes.Disabled = btnEditAttributes.Disabled = btnDeleteAttributes.Disabled = false;
                    ddlAttributes.Items.Clear();
                    foreach (AttributesMaster attribute in parcelAttribs)
                    {
                        ddlAttributes.Items.Add(new ListItem(attribute.AttributeName,
                                                             attribute.AttributeId + &quot;,&quot; + attribute.AttributeType + &quot;,&quot; +
                                                             attribute.IsMandatory));
                    }
                }
                else
                {
                    btnAddAttributes.Disabled = btnEditAttributes.Disabled = btnDeleteAttributes.Disabled = true;
                }

                if (!Request[&quot;Mode&quot;].Equals(ModeTypes.New.ToString2()))
                {
                    if (Request[&quot;Mode&quot;].Equals(ModeTypes.View.ToString2()))
                    {
                        uwgAttr.DataSource = LandMangementManager.Instance.GetLandAttribs(Request[&quot;LMID&quot;].ToInt32_2(),
                                                                                          Request[&quot;ParcelID&quot;].ToInt32_2());
                        uwgAttr.DataBind();
                    }
                    else
                    {
                        uwgAttr.DataSource = LandMangementManager.Instance.GetLandAttributes(
                            Request[&quot;LMID&quot;].ToInt32_2(), Request[&quot;ParcelID&quot;].ToInt32_2());
                        uwgAttr.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                lblError.Text = ex.Message;
            }
        }


        protected override void OnPreRender(EventArgs e)
        {

            if (Request[&quot;Mode&quot;].Equals(ModeTypes.View.ToString2()))
            {
                PageTitle = &quot;View Parcel Details&quot;;
                MainToolBar.HideMenu(&quot;lnkSave&quot;);

            }

            else if (Request[&quot;Mode&quot;].Equals(ModeTypes.New.ToString2()))
            {
                MainToolBar.HideMenu(&quot;lnkEdit&quot;);
                PageTitle = &quot;New Parcel Details&quot;;
            }
            else
            {
                PageTitle = &quot;Edit Parcel Details&quot;;
                MainToolBar.HideMenu(&quot;lnkEdit&quot;);
            }
            base.OnPreRender(e);
        }

        protected void btnSave_Click(object sender, EventArgs e)
        {
            try
            {
                var attributeList = new Dictionary&lt;string, string&gt;();
                var dto = new LandMangementParcelDTO();

                dto.Area = txtArea.Text;
                dto.ContactInfo = txtContactInfo.Text;
                dto.Description = txtDescription.Text;
                dto.LandType = (ddlLandType.SelectedIndex &gt; 0) ? ddlLandType.SelectedValue.ToInt32_2() : 0;
                dto.Name = txtName.Text;
                dto.Notes = txtNotes.Text;
                dto.OwnerType = (ddlOwnerType.SelectedIndex &gt; 0) ? ddlOwnerType.SelectedValue.ToInt32_2() : 0;
                dto.ParcelID = (mode == Mode.New) ? 0 : Request[&quot;ParcelID&quot;].ToInt32_2();
                dto.LMID = Request[LMConstants.KEY_LMID].ToInt32_2();
                dto.OwnerDetails = txtOwnerDetails.Text.Trim();
                dto.MarketRate = wneMarketRate.ValueDecimal;
                dto.AskingRate = wneAskingRate.ValueDecimal;
                dto.FinalRate = wneFinalRate.ValueDecimal;
                dto.Status = ddlStatus.SelectedValue;

                int rtnVal = LandMangementManager.Instance.SaveParcel(mode, dto);

                if (rtnVal &gt; 0)
                {
                    foreach (UltraGridRow row in uwgAttr.Rows)
                    {
                        attributeList.Add(
                            Convert.ToString(row.Cells.FromKey(&quot;AttributeId&quot;).Value, CultureInfo.CurrentCulture),
                            Convert.ToString(row.Cells.FromKey(&quot;AttributeValue&quot;).Value, CultureInfo.CurrentCulture) +
                            &#39;^&#39; +
                            Convert.ToString(row.Cells.FromKey(&quot;AttributeNotes&quot;).Value, CultureInfo.CurrentCulture));
                    }
                    int resAttr = LandMangementManager.Instance.AddLandAttributes(attributeList,
                                                                                  Request[LMConstants.KEY_LMID].
                                                                                      ToInt32_2(), rtnVal);
                    if (resAttr == -1)
                        lblError.Text = LMConstants.ATTR_ERROR;

                    bool bUploadAttch = ((AttachmentsControl)attachments).SaveAttachments(rtnVal.ToString2(),
                                                                                           &quot;LANDPAR&quot;,
                                                                                           UserDetail.
                                                                                               GetCurrentUserDetail().
                                                                                               UID,
                                                                                           UserDetail.
                                                                                               GetCurrentUserDetail().
                                                                                               UserName,
                                                                                           &quot;Land Management Parcel Attachments.&quot;);
                }

                switch (rtnVal)
                {
                    case -3:
                        break;
                    case -1:
                        break;
                    default:

                        Response.Redirect(String.Format(CultureInfo.CurrentCulture,
                                                    &quot;~/Common/BrixListPage.aspx?Context=LANDMGTPCL&amp;PID={0}&amp;LMID={1}&amp;nt=1&quot;,
                                                    Request[&quot;PID&quot;], Request[&quot;LMID&quot;]));

                        //Response.Redirect(String.Format(CultureInfo.CurrentCulture,
                        //                                &quot;ParcelDetails.aspx?Mode={0}&amp;Context=LANDMGT&amp;ParcelID={1}&amp;LMID={2}&amp;PID={3}&quot; +
                        //                                (enterpriseLevel ? &quot;&amp;ENTPRSE_LM=Y&quot; : String.Empty),
                        //                                Mode.View.ToString2(), rtnVal, Request[&quot;LMID&quot;], Request[&quot;PID&quot;]));
                        break;
                }

            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
                lblError.Text = ex.Message;
            }
        }

        protected void btnEdit_Click(object sender, EventArgs e)
        {
            Response.Redirect(String.Format(CultureInfo.CurrentCulture,
                                            &quot;ParcelDetails.aspx?Mode={0}&amp;Context=LANDMGT&amp;ParcelID={1}&amp;LMID={2}&amp;PID={3}&quot; +
                                            (enterpriseLevel ? &quot;&amp;ENTPRSE_LM=Y&quot; : String.Empty), Mode.Edit.ToString2(),
                                            Request[&quot;ParcelID&quot;], Request[&quot;LMID&quot;], Request[&quot;PID&quot;]));
        }


        protected void btnCancel_Click(object sender, EventArgs e)
        {

            Response.Redirect(String.Format(CultureInfo.CurrentCulture,
                                               &quot;~/Common/BrixListPage.aspx?Context=LANDMGTPCL&amp;PID={0}&amp;LMID={1}&amp;nt=1&quot;,
                                               Request[&quot;PID&quot;], Request[&quot;LMID&quot;]), false);

        }

        protected void btnBack_Click(object sender, EventArgs e)
        {
            Response.Redirect(
                String.Format(CultureInfo.CurrentCulture,
                              &quot;LandDetails.aspx?PID={0}&amp;LMID={1}&amp;Mode=Edit&quot; +
                              (enterpriseLevel ? &quot;&amp;ENTPRSE_LM=Y&quot; : String.Empty), Request[&quot;PID&quot;], Request[&quot;LMID&quot;]),
                false);
        }

        private void RegisterCallBackScript()
        {
            var sb = new StringBuilder();
            sb.Append(&quot;&lt;script language=\&quot;javascript\&quot; type=\&quot;text/javascript\&quot;&gt;&quot;);
            sb.Append(&quot;function SendServerRequestPM(arguments,context){&quot;);
            sb.Append(Page.ClientScript.GetCallbackEventReference(this, &quot;arguments&quot;, &quot;HandleServerResponsePM&quot;, &quot;context&quot;,
                                                                  false));
            sb.Append(&quot;}&quot;);
            sb.Append(&quot;&lt;/script&gt;&quot;);
            Page.ClientScript.RegisterStartupScript(GetType(), &quot;DateCheckScript&quot;, sb.ToString2());
        }

        #region &quot;Parcel Check List&quot;

        // Functions to format the grids in the page
        protected void grdItemsList_InitializeGroupByRow(object sender, RowEventArgs e)
        {
            e.Row.Expanded = true;

            try
            {
                if (((GroupByRow) e.Row).Column.ToString2().Equals(&quot;CheckListName&quot;))
                {
                    e.Row.Style.BackColor = Color.LightGray;
                    e.Row.Style.Font.Bold = true;
                    ((GroupByRow) e.Row).Text = ((GroupByRow) e.Row).Value + &quot;( &quot;
                                                + e.Row.Rows.Count.ToString2() + &quot; Stage(s))&quot;;
                }
                else if (((GroupByRow) e.Row).Column.ToString2().Equals(&quot;StageName&quot;))
                {
                    ((GroupByRow) e.Row).Text = ((GroupByRow) e.Row).Value + &quot;( &quot;
                                                + e.Row.Rows.Count.ToString2() + &quot; (Activity/Activities))&quot;;
                    e.Row.Style.BorderDetails.ColorBottom =
                        e.Row.Style.BorderDetails.ColorLeft =
                        e.Row.Style.BorderDetails.ColorRight =
                        e.Row.Style.BorderDetails.ColorTop = Color.LightGray;
                }
            }
            catch
            {
                e.Row.Style.BackColor = Color.LightGray;
                (e.Row).ShowExpand = false;
            }
        }

        protected void grdItemsList_InitializeLayout(object sender, LayoutEventArgs e)
        {
            try
            {
                e.Layout.IndentationDefault = 05;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
            }
        }

        protected void grdStagesAndActivities_InitializeGroupByRow(object sender, RowEventArgs e)
        {
            e.Row.Expanded = true;
        }

        protected void grdItemsList_InitializeRow(object sender, RowEventArgs e)
        {
            e.Row.Style.BorderStyle = BorderStyle.Solid;

            e.Row.Style.BorderDetails.WidthLeft =
                e.Row.Style.BorderDetails.WidthRight =
                e.Row.Style.BorderDetails.WidthBottom = Unit.Pixel(1);
            e.Row.Style.BorderDetails.WidthTop = Unit.Pixel(0);

            string queryString = &quot;ActivityID=&quot; + e.Row.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString2();
            queryString += &quot;&amp;PID=&quot; + Request[&quot;PID&quot;];
            queryString += &quot;&amp;ParcelID=&quot; + Request[&quot;ParcelID&quot;];
            queryString += &quot;&amp;LMID=&quot; + Request[&quot;LMID&quot;];
            queryString += &quot;&amp;ATID=&quot; + e.Row.Cells.FromKey(&quot;AttachmentID&quot;).Value.ToString2();

            e.Row.Cells.FromKey(&quot;Attachments&quot;).TargetURL = &quot;Attachments.aspx?&quot; + queryString;

            e.Row.Cells.FromKey(&quot;Notes&quot;).Style.BackColor = Color.Yellow;
        }

        // Functions to format the grids in the page

        protected void ddlCheckList_Changed(object sender, EventArgs e)
        {
            DataTable dtStagesandActivities =
                LandMangementManager.Instance.GetStagesActForCheckList(ddlCheckList.SelectedItem.Value.ToInt32_2());

            if (dtStagesandActivities.Rows.Count == 0)
                dtStagesandActivities = null;

            grdStagesAndActivities.DataSource = dtStagesandActivities;
            grdStagesAndActivities.DataBind();

            if (dtStagesandActivities != null)
                FormatPopupGrid();
        }

        // Adds the checklist
        protected void btnCheckListAdd_Click(object sender, EventArgs e)
        {
            try
            {
                DataTable dtTemp = BringSelectedRows();

                if (dtTemp.Rows.Count == 0)
                    throw new Exception(&quot;Please select atleast one activity to add.&quot;);

                DataTable dtOriginalRows = GetGridData();

                DataRow row;
                DataRow[] dr;
                string query = String.Empty;
                for (int i = 0; i &lt; dtTemp.Rows.Count; i++)
                {
                    query = &quot;CheckListID=&quot; + dtTemp.Rows[i][&quot;CheckListID&quot;].ToString2();
                    query += &quot; AND StageID=&quot; + dtTemp.Rows[i][&quot;StageID&quot;].ToString2();
                    query += &quot; AND ActivityID=&quot; + dtTemp.Rows[i][&quot;ActivityID&quot;].ToString2();

                    dr = dtOriginalRows.Select(query);
                    if (dr.Length == 0)
                    {
                        row = dtOriginalRows.NewRow();
                        row[LMConstants.COL_LINKINGID] =
                            dtTemp.Rows[i][LMConstants.COL_LINKINGID].ToString2().ToInt32_2();
                        row[LMConstants.COL_STAGEID] = dtTemp.Rows[i][LMConstants.COL_STAGEID].ToString2().ToInt32_2();
                        row[LMConstants.COL_CHECKLISTID] =
                            dtTemp.Rows[i][LMConstants.COL_CHECKLISTID].ToString2().ToInt32_2();
                        row[LMConstants.COL_ACTIVITYID] =
                            dtTemp.Rows[i][LMConstants.COL_ACTIVITYID].ToString2().ToInt32_2();
                        row[LMConstants.COL_STAGENAME] = dtTemp.Rows[i][LMConstants.COL_STAGENAME].ToString2();
                        row[LMConstants.COL_ACTIVITYNAME] = dtTemp.Rows[i][LMConstants.COL_ACTIVITYNAME].ToString2();
                        row[LMConstants.COL_CHECKLISTNAME] = dtTemp.Rows[i][LMConstants.COL_CHECKLISTNAME].ToString2();
                        row[LMConstants.COL_NOTES] = dtTemp.Rows[i][LMConstants.COL_NOTES].ToString2();
                        row[LMConstants.COL_ATTACHMENTS] = LMConstants.COL_ATTACHMENTS;
                        row[LMConstants.COL_ATTACHMENTID] = dtTemp.Rows[i][LMConstants.COL_ATTACHMENTID].ToString2();
                        dtOriginalRows.Rows.Add(row);
                    }
                }


                if (dtOriginalRows.Rows.Count &gt; 0)
                {
                    uwgResource.DataSource = dtOriginalRows;
                    uwgResource.DataBind();

                    FormatMainGrid();
                }

                MasterSave();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
                lblError.Text = ex.Message;
            }
        }

        // Deletes the checklist
        protected void btnCheckListDelete_Click(object sender, EventArgs e)
        {
            try
            {
                DataTable dtTemp = GetGridData();

                string queryDelete = String.Empty;

                switch (hdnMode.Value)
                {
                    case &quot;C&quot;:
                        queryDelete = &quot;CheckListName=&#39;&quot; + hdnChkList.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot;;
                        break;
                    case &quot;S&quot;:
                        queryDelete = &quot;CheckListName=&#39;&quot; + hdnChkList.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot; +
                                      &quot; AND StageName = &#39;&quot; + hdnStage.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot;;
                        break;
                    case &quot;A&quot;:
                        queryDelete = &quot;CheckListName=&#39;&quot; + hdnChkList.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot; +
                                      &quot; AND StageName = &#39;&quot; + hdnStage.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot; +
                                      &quot; AND ActivityID = &quot; + hdnActivity.Value;
                        break;
                }


                DataRow[] dr = dtTemp.Select(queryDelete);

                foreach (DataRow row in dr)
                    dtTemp.Rows.Remove(row);

                if (dtTemp.Rows.Count == 0)
                    dtTemp = null;

                uwgResource.DataSource = dtTemp;
                uwgResource.DataBind();

                if (dtTemp != null)
                    FormatMainGrid();

                MasterSave();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
                lblError.Text = ex.Message;
            }
        }

        // Saves the completed flag of the checklist
        protected void btnMainSave_Click(object sender, EventArgs e)
        {
            try
            {
                MasterSave();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, LMConstants.MODULENAME);
                lblError.Text = ex.Message;
            }
        }

        private void FormatPopupGrid()
        {
            ColumnsCollection cols = grdStagesAndActivities.Bands[0].Columns;

            cols.FromKey(LMConstants.COL_STAGENAME).IsGroupByColumn = true;

            cols.FromKey(LMConstants.COL_LINKINGID).Hidden =
                cols.FromKey(LMConstants.COL_STAGEID).Hidden =
                cols.FromKey(LMConstants.COL_ACTIVITYID).Hidden =
                cols.FromKey(LMConstants.COL_CHECKLISTID).Hidden =
                cols.FromKey(LMConstants.COL_NOTES).Hidden =
                cols.FromKey(LMConstants.COL_CHECKLISTNAME).Hidden = true;

            cols.FromKey(&quot;Include&quot;).AllowUpdate = AllowUpdate.Yes;

            cols.FromKey(LMConstants.COL_ACTIVITYNAME).Header.Caption = &quot;Activity Name&quot;;
        }

        private void FormatMainGrid()
        {
            ColumnsCollection cols = uwgResource.Bands[0].Columns;

            cols.FromKey(LMConstants.COL_CHECKLISTNAME).IsGroupByColumn = true;
            cols.FromKey(LMConstants.COL_STAGENAME).IsGroupByColumn = true;

            cols.FromKey(LMConstants.COL_LINKINGID).Hidden =
                cols.FromKey(LMConstants.COL_STAGEID).Hidden =
                cols.FromKey(LMConstants.COL_ACTIVITYID).Hidden =
                cols.FromKey(LMConstants.COL_CHECKLISTID).Hidden = true;

            if (cols.Exists(LMConstants.COL_ATTACHMENTID))
                cols.FromKey(LMConstants.COL_ATTACHMENTID).Hidden = true;

            cols.FromKey(LMConstants.COL_COMPLETED).AllowUpdate = AllowUpdate.Yes;
            cols.FromKey(LMConstants.COL_NOTES).AllowUpdate = AllowUpdate.Yes;
            cols.FromKey(LMConstants.COL_NOTES).FieldLen = 1000;

            cols.FromKey(LMConstants.COL_ACTIVITYNAME).Header.Caption = &quot;Activity Name&quot;;
        }

        private DataTable BringSelectedRows()
        {
            if (grdStagesAndActivities.Rows.Count &gt; 0)
                grdStagesAndActivities.Bands[0].Columns.FromKey(&quot;StageName&quot;).IsGroupByColumn = false;

            DataTable dtTemp = DataTableWithSchema();

            DataRow row;
            if (grdStagesAndActivities.Rows.Count &gt; 0)
            {
                UltraGridRowsEnumerator enParentRow = grdStagesAndActivities.Bands[0].GetRowsEnumerator();

                while (enParentRow.MoveNext())
                {
                    CellsCollection cells = enParentRow.Current.Cells;

                    if (cells.FromKey(&quot;Include&quot;).Value.ToBoolean2())
                    {
                        row = dtTemp.NewRow();
                        row[LMConstants.COL_LINKINGID] =
                            cells.FromKey(LMConstants.COL_LINKINGID).Value.ToString2().ToInt32_2();
                        row[LMConstants.COL_STAGEID] =
                            cells.FromKey(LMConstants.COL_STAGEID).Value.ToString2().ToInt32_2();
                        row[LMConstants.COL_CHECKLISTID] =
                            cells.FromKey(LMConstants.COL_CHECKLISTID).Value.ToString2().ToInt32_2();
                        row[LMConstants.COL_ACTIVITYID] =
                            cells.FromKey(LMConstants.COL_ACTIVITYID).Value.ToString2().ToInt32_2();
                        row[LMConstants.COL_STAGENAME] = cells.FromKey(LMConstants.COL_STAGENAME).Value;
                        row[LMConstants.COL_ACTIVITYNAME] = cells.FromKey(LMConstants.COL_ACTIVITYNAME).Text;
                        row[LMConstants.COL_CHECKLISTNAME] = cells.FromKey(LMConstants.COL_CHECKLISTNAME).Text;
                        row[LMConstants.COL_NOTES] = cells.FromKey(LMConstants.COL_NOTES).Text;
                        row[LMConstants.COL_COMPLETED] = false;
                        row[LMConstants.COL_ATTACHMENTID] = Guid.NewGuid().ToString2();
                        dtTemp.Rows.Add(row);
                    }
                }
            }

            if (dtTemp.Rows.Count &gt; 0)
                FormatPopupGrid();

            return dtTemp;
        }

        private DataTable GetGridData()
        {
            if (uwgResource.Rows.Count &gt; 0)
            {
                uwgResource.Bands[0].Columns.FromKey(&quot;StageName&quot;).IsGroupByColumn = false;
                uwgResource.Bands[0].Columns.FromKey(&quot;CheckListName&quot;).IsGroupByColumn = false;
            }

            DataTable dtTemp = DataTableWithSchema();

            DataRow row;
            if (uwgResource.Rows.Count &gt; 0)
            {
                UltraGridRowsEnumerator enParentRow = uwgResource.Bands[0].GetRowsEnumerator();

                while (enParentRow.MoveNext())
                {
                    CellsCollection cells = enParentRow.Current.Cells;

                    row = dtTemp.NewRow();
                    row[LMConstants.COL_LINKINGID] =
                        cells.FromKey(LMConstants.COL_LINKINGID).Value.ToString2().ToInt32_2();
                    row[LMConstants.COL_STAGEID] = cells.FromKey(LMConstants.COL_STAGEID).Value.ToString2().ToInt32_2();
                    row[LMConstants.COL_CHECKLISTID] =
                        cells.FromKey(LMConstants.COL_CHECKLISTID).Value.ToString2().ToInt32_2();
                    row[LMConstants.COL_ACTIVITYID] =
                        cells.FromKey(LMConstants.COL_ACTIVITYID).Value.ToString2().ToInt32_2();
                    row[LMConstants.COL_STAGENAME] = cells.FromKey(LMConstants.COL_STAGENAME).Value;
                    row[LMConstants.COL_ACTIVITYNAME] = cells.FromKey(LMConstants.COL_ACTIVITYNAME).Text;
                    row[LMConstants.COL_CHECKLISTNAME] = cells.FromKey(LMConstants.COL_CHECKLISTNAME).Text;
                    row[LMConstants.COL_NOTES] = cells.FromKey(LMConstants.COL_NOTES).Text;
                    row[LMConstants.COL_COMPLETED] = cells.FromKey(LMConstants.COL_COMPLETED).Text.ToBoolean2();
                    row[LMConstants.COL_ATTACHMENTS] = LMConstants.COL_ATTACHMENTS;
                    row[LMConstants.COL_ATTACHMENTID] = cells.FromKey(LMConstants.COL_ATTACHMENTID).Text;

                    dtTemp.Rows.Add(row);
                }
            }

            return dtTemp;
        }

        private void BindToMainGrid()
        {
            DataTable dtTemp = LandMangementManager.Instance.GetMainCheckList(Request[&quot;ParcelID&quot;].ToInt32_2());

            if (dtTemp.Rows.Count &gt; 0)
            {
                uwgResource.DataSource = dtTemp;
                uwgResource.DataBind();

                FormatMainGrid();
            }
        }

        private void MasterSave()
        {
            DataTable dtAllDetails = GetGridData();

            DataSet ds = new BrixDataSet();
            ds.Tables.Add(dtAllDetails);
            LandMangementManager.Instance.SaveMainChecklist(Mode.New.ToString2(), Request[&quot;ParcelID&quot;].ToInt32_2(),
                                                            ds.GetXml());
            BindToMainGrid();
        }

        private DataTable DataTableWithSchema()
        {
            DataTable dtTemp = new BrixDataTable();

            dtTemp.Columns.Add(LMConstants.COL_LINKINGID, Type.GetType(LMConstants.TYPE_INT));
            dtTemp.Columns.Add(LMConstants.COL_STAGEID, Type.GetType(LMConstants.TYPE_INT));
            dtTemp.Columns.Add(LMConstants.COL_CHECKLISTID, Type.GetType(LMConstants.TYPE_INT));
            dtTemp.Columns.Add(LMConstants.COL_ACTIVITYID, Type.GetType(LMConstants.TYPE_INT));
            dtTemp.Columns.Add(LMConstants.COL_STAGENAME, Type.GetType(LMConstants.TYPE_STRING));
            dtTemp.Columns.Add(LMConstants.COL_ACTIVITYNAME, Type.GetType(LMConstants.TYPE_STRING));
            dtTemp.Columns.Add(LMConstants.COL_CHECKLISTNAME, Type.GetType(LMConstants.TYPE_STRING));
            dtTemp.Columns.Add(LMConstants.COL_NOTES, Type.GetType(LMConstants.TYPE_STRING));
            dtTemp.Columns.Add(LMConstants.COL_COMPLETED, Type.GetType(LMConstants.TYPE_BOOL));
            dtTemp.Columns.Add(LMConstants.COL_ATTACHMENTS, Type.GetType(LMConstants.TYPE_STRING));
            dtTemp.Columns.Add(LMConstants.COL_ATTACHMENTID, Type.GetType(LMConstants.TYPE_STRING));

            return dtTemp;
        }

        #endregion &quot;Parcel Check List&quot;
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[35,9,35,39,0],[57,9,57,10,0],[58,13,58,29,0],[59,9,59,10,0],[62,9,62,10,0],[63,13,63,37,0],[65,13,65,14,0],[66,17,66,94,0],[67,17,67,32,0],[68,13,68,14,0],[69,13,69,30,0],[70,13,70,14,0],[71,17,71,32,0],[72,13,72,14,0],[73,9,73,10,0],[78,9,78,10,0],[79,13,79,31,0],[80,13,80,97,0],[82,13,82,65,0],[84,13,84,31,0],[85,9,85,10,0],[89,9,89,10,0],[90,13,90,41,0],[92,13,92,34,0],[93,13,93,76,0],[94,13,94,82,0],[96,13,96,44,0],[97,9,97,10,0],[101,9,101,10,0],[103,13,103,67,0],[104,17,104,84,0],[106,13,106,31,0],[107,13,107,14,0],[108,17,108,78,0],[109,17,109,37,0],[110,17,110,18,0],[111,21,111,52,0],[112,21,112,66,0],[113,17,113,18,0],[114,13,114,14,0],[116,13,116,65,0],[117,13,117,14,0],[118,17,118,80,0],[119,13,119,14,0],[122,9,122,10,0],[126,9,126,10,0],[128,13,128,14,0],[130,17,130,53,0],[132,17,132,60,0],[133,21,135,104,0],[137,17,138,129,0],[139,17,139,30,0],[142,25,142,61,0],[143,29,143,46,0],[144,25,144,31,0],[146,25,146,97,0],[147,29,147,46,0],[148,25,148,31,0],[152,17,152,33,0],[153,17,153,18,0],[158,21,158,119,0],[159,21,159,52,0],[160,21,160,22,0],[161,25,161,83,0],[162,25,162,93,0],[163,21,163,22,0],[165,21,165,109,0],[166,21,166,81,0],[167,21,167,42,0],[169,21,170,104,0],[172,21,172,59,0],[173,21,173,57,0],[174,21,174,64,0],[175,21,175,45,0],[177,21,177,83,0],[179,21,179,87,0],[180,21,180,60,0],[181,21,181,63,0],[182,21,182,44,0],[183,21,183,79,0],[185,21,185,89,0],[186,21,186,62,0],[187,21,187,65,0],[188,21,188,45,0],[189,21,189,80,0],[191,21,191,38,0],[193,21,193,66,0],[194,21,194,53,0],[195,21,195,50,0],[198,21,198,66,0],[199,21,199,64,0],[200,21,200,22,0],[201,25,201,113,0],[204,25,204,47,0],[205,25,205,26,0],[206,29,206,53,0],[207,29,207,81,0],[208,29,208,95,0],[209,29,209,95,0],[210,29,210,89,0],[211,29,211,81,0],[212,29,212,83,0],[213,29,213,91,0],[214,29,214,97,0],[215,29,215,114,0],[216,29,216,112,0],[217,29,217,114,0],[218,29,218,62,0],[219,29,219,54,0],[221,29,225,110,0],[226,29,226,87,0],[227,29,227,30,0],[228,33,228,113,0],[229,33,229,97,0],[230,29,230,30,0],[231,34,232,72,0],[233,29,233,30,0],[234,33,234,112,0],[235,29,235,30,0],[236,34,236,56,0],[237,33,240,114,0],[242,29,242,94,0],[243,25,243,26,0],[245,25,245,47,0],[246,25,246,26,0],[248,29,251,110,0],[253,29,261,111,0],[262,29,262,59,0],[263,29,263,71,0],[264,29,266,113,0],[267,29,269,113,0],[270,29,272,113,0],[273,29,273,100,0],[274,29,274,79,0],[275,29,279,110,0],[280,25,280,26,0],[281,30,281,51,0],[282,25,282,26,0],[283,29,285,118,0],[286,25,286,26,0],[287,21,287,22,0],[288,21,288,63,0],[289,21,289,22,0],[290,25,290,49,0],[292,25,295,104,0],[296,21,296,22,0],[298,21,298,50,0],[299,21,299,22,0],[300,25,300,90,0],[301,25,301,67,0],[302,25,302,50,0],[303,21,303,22,0],[304,17,304,18,0],[306,17,308,47,0],[309,17,309,42,0],[310,13,310,14,0],[311,13,311,33,0],[312,13,312,14,0],[313,17,313,92,0],[314,17,314,44,0],[315,13,315,14,0],[316,9,316,10,0],[319,9,319,10,0],[321,13,321,14,0],[322,17,322,71,0],[323,17,323,18,0],[324,21,324,104,0],[325,21,325,40,0],[326,17,326,18,0],[327,17,328,106,0],[331,17,331,102,0],[332,17,332,18,0],[333,21,333,115,0],[334,21,334,49,0],[335,21,335,28,0],[335,30,335,56,0],[335,57,335,59,0],[335,60,335,73,0],[336,21,336,22,0],[337,25,339,86,0],[340,21,340,22,0],[341,17,341,18,0],[343,17,343,18,0],[344,21,344,114,0],[345,17,345,18,0],[347,17,347,72,0],[348,17,348,18,0],[349,21,349,76,0],[350,21,350,22,0],[351,25,352,124,0],[353,25,353,44,0],[354,21,354,22,0],[356,21,356,22,0],[357,25,358,91,0],[359,25,359,44,0],[360,21,360,22,0],[361,17,361,18,0],[362,13,362,14,0],[363,13,363,33,0],[364,13,364,14,0],[365,17,365,44,0],[366,13,366,14,0],[367,9,367,10,0],[371,9,371,10,0],[373,13,373,68,0],[374,13,374,14,0],[375,17,375,51,0],[376,17,376,49,0],[378,13,378,14,0],[380,18,380,72,0],[381,13,381,14,0],[382,17,382,49,0],[383,17,383,50,0],[384,13,384,14,0],[386,13,386,14,0],[387,17,387,51,0],[388,17,388,49,0],[389,13,389,14,0],[390,13,390,33,0],[391,9,391,10,0],[394,9,394,10,0],[396,13,396,14,0],[397,17,397,70,0],[398,17,398,56,0],[400,17,400,41,0],[401,17,401,55,0],[402,17,402,55,0],[403,17,403,108,0],[404,17,404,41,0],[405,17,405,43,0],[406,17,406,111,0],[407,17,407,89,0],[408,17,408,70,0],[409,17,409,64,0],[410,17,410,61,0],[411,17,411,61,0],[412,17,412,59,0],[413,17,413,54,0],[415,17,415,82,0],[417,17,417,32,0],[418,17,418,18,0],[419,21,419,28,0],[419,30,419,46,0],[419,47,419,49,0],[419,50,419,62,0],[420,21,420,22,0],[421,25,425,118,0],[426,21,426,22,0],[427,21,429,108,0],[430,21,430,39,0],[431,25,431,64,0],[433,21,441,131,0],[442,17,442,18,0],[444,17,444,32,0],[447,25,447,31,0],[449,25,449,31,0],[452,25,454,87,0],[460,25,460,31,0],[463,13,463,14,0],[464,13,464,33,0],[465,13,465,14,0],[466,17,466,92,0],[467,17,467,44,0],[468,13,468,14,0],[469,9,469,10,0],[472,9,472,10,0],[473,13,476,100,0],[477,9,477,10,0],[481,9,481,10,0],[483,13,485,89,0],[487,9,487,10,0],[490,9,490,10,0],[491,13,495,24,0],[496,9,496,10,0],[499,9,499,10,0],[500,13,500,42,0],[501,13,501,84,0],[502,13,502,75,0],[503,13,504,75,0],[505,13,505,28,0],[506,13,506,36,0],[507,13,507,99,0],[508,9,508,10,0],[514,9,514,10,0],[515,13,515,35,0],[518,13,518,14,0],[519,17,519,85,0],[520,17,520,18,0],[521,21,521,61,0],[522,21,522,50,0],[523,21,524,95,0],[525,17,525,18,0],[526,22,526,86,0],[527,17,527,18,0],[528,21,529,108,0],[530,21,533,78,0],[534,17,534,18,0],[535,13,535,14,0],[536,13,536,18,0],[537,13,537,14,0],[538,17,538,57,0],[539,17,539,44,0],[540,13,540,14,0],[541,9,541,10,0],[544,9,544,10,0],[546,13,546,14,0],[547,17,547,50,0],[548,13,548,14,0],[549,13,549,33,0],[550,13,550,14,0],[551,17,551,92,0],[552,13,552,14,0],[553,9,553,10,0],[556,9,556,10,0],[557,13,557,35,0],[558,9,558,10,0],[561,9,561,10,0],[562,13,562,57,0],[564,13,566,71,0],[567,13,567,64,0],[569,13,569,102,0],[570,13,570,53,0],[571,13,571,63,0],[572,13,572,55,0],[573,13,573,93,0],[575,13,575,94,0],[577,13,577,73,0],[578,9,578,10,0],[583,9,583,10,0],[584,13,585,117,0],[587,13,587,55,0],[588,17,588,46,0],[590,13,590,71,0],[591,13,591,47,0],[593,13,593,47,0],[594,17,594,35,0],[595,9,595,10,0],[599,9,599,10,0],[601,13,601,14,0],[602,17,602,56,0],[604,17,604,44,0],[605,21,605,87,0],[607,17,607,58,0],[611,17,611,45,0],[612,22,612,31,0],[612,33,612,54,0],[612,56,612,59,0],[613,17,613,18,0],[614,21,614,88,0],[615,21,615,86,0],[616,21,616,92,0],[618,21,618,55,0],[619,21,619,40,0],[620,21,620,22,0],[621,25,621,55,0],[622,25,623,95,0],[624,25,624,120,0],[625,25,626,97,0],[627,25,628,96,0],[629,25,629,112,0],[630,25,630,118,0],[631,25,631,120,0],[632,25,632,104,0],[633,25,633,88,0],[634,25,634,118,0],[635,25,635,54,0],[636,21,636,22,0],[637,17,637,18,0],[640,17,640,51,0],[641,17,641,18,0],[642,21,642,61,0],[643,21,643,44,0],[645,21,645,38,0],[646,17,646,18,0],[648,17,648,30,0],[649,13,649,14,0],[650,13,650,33,0],[651,13,651,14,0],[652,17,652,92,0],[653,17,653,44,0],[654,13,654,14,0],[655,9,655,10,0],[659,9,659,10,0],[661,13,661,14,0],[662,17,662,50,0],[664,17,664,51,0],[666,17,666,39,0],[669,25,669,101,0],[670,25,670,31,0],[672,25,673,102,0],[674,25,674,31,0],[676,25,678,80,0],[679,25,679,31,0],[683,17,683,59,0],[685,17,685,24,0],[685,26,685,37,0],[685,38,685,40,0],[685,41,685,43,0],[686,21,686,45,0],[688,17,688,44,0],[689,21,689,35,0],[691,17,691,49,0],[692,17,692,40,0],[694,17,694,36,0],[695,21,695,38,0],[697,17,697,30,0],[698,13,698,14,0],[699,13,699,33,0],[700,13,700,14,0],[701,17,701,92,0],[702,17,702,44,0],[703,13,703,14,0],[704,9,704,10,0],[708,9,708,10,0],[710,13,710,14,0],[711,17,711,30,0],[712,13,712,14,0],[713,13,713,33,0],[714,13,714,14,0],[715,17,715,92,0],[716,17,716,44,0],[717,13,717,14,0],[718,9,718,10,0],[721,9,721,10,0],[722,13,722,78,0],[724,13,724,76,0],[726,13,731,75,0],[733,13,733,67,0],[735,13,735,89,0],[736,9,736,10,0],[739,9,739,10,0],[740,13,740,67,0],[742,13,742,80,0],[743,13,743,76,0],[745,13,748,73,0],[750,13,750,59,0],[751,17,751,74,0],[753,13,753,83,0],[754,13,754,79,0],[755,13,755,65,0],[757,13,757,89,0],[758,9,758,10,0],[761,9,761,10,0],[762,13,762,55,0],[763,17,763,102,0],[765,13,765,54,0],[768,13,768,55,0],[769,13,769,14,0],[770,17,770,107,0],[772,17,772,47,0],[773,17,773,18,0],[774,21,774,71,0],[776,21,776,69,0],[777,21,777,22,0],[778,25,778,47,0],[779,25,780,100,0],[781,25,782,98,0],[783,25,784,102,0],[785,25,786,101,0],[787,25,787,105,0],[788,25,788,110,0],[789,25,789,112,0],[790,25,790,96,0],[791,25,791,64,0],[792,25,792,88,0],[793,25,793,46,0],[794,21,794,22,0],[795,17,795,18,0],[796,13,796,14,0],[798,13,798,39,0],[799,17,799,35,0],[801,13,801,27,0],[802,9,802,10,0],[805,9,805,10,0],[806,13,806,44,0],[807,13,807,14,0],[808,17,808,91,0],[809,17,809,95,0],[810,13,810,14,0],[812,13,812,54,0],[815,13,815,44,0],[816,13,816,14,0],[817,17,817,96,0],[819,17,819,47,0],[820,17,820,18,0],[821,21,821,71,0],[823,21,823,43,0],[824,21,825,96,0],[826,21,826,121,0],[827,21,828,98,0],[829,21,830,97,0],[831,21,831,101,0],[832,21,832,106,0],[833,21,833,108,0],[834,21,834,92,0],[835,21,835,113,0],[836,21,836,84,0],[837,21,837,106,0],[839,21,839,42,0],[840,17,840,18,0],[841,13,841,14,0],[843,13,843,27,0],[844,9,844,10,0],[847,9,847,10,0],[848,13,848,112,0],[850,13,850,39,0],[851,13,851,14,0],[852,17,852,49,0],[853,17,853,40,0],[855,17,855,34,0],[856,13,856,14,0],[857,9,857,10,0],[860,9,860,10,0],[861,13,861,52,0],[863,13,863,44,0],[864,13,864,41,0],[865,13,866,74,0],[867,13,867,30,0],[868,9,868,10,0],[871,9,871,10,0],[872,13,872,52,0],[874,13,874,95,0],[875,13,875,93,0],[876,13,876,97,0],[877,13,877,96,0],[878,13,878,98,0],[879,13,879,101,0],[880,13,880,102,0],[881,13,881,94,0],[882,13,882,96,0],[883,13,883,100,0],[884,13,884,101,0],[886,13,886,27,0],[887,9,887,10,0]]);
    </script>
  </body>
</html>