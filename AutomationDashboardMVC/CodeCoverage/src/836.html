<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\AbstractModels\ListModelExtension.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.WebSchedule;
using System;
using System.Collections.Generic;
using System.Web;

namespace Aurigo.AMP3.Core.AbstractModels
{
    public abstract partial class ListModel
    {
        public const string GROUP_GENERAL = &quot;General&quot;;
        public const string GROUP_OTHERS = &quot;Others&quot;;
        public const string GROUP_MAILMERGE = &quot;Mail Merge&quot;;
        public const string GROUP_WORKFLOW = &quot;Workflow&quot;;
        public const string MENU_NEW = &quot;New&quot;;
        public const string MENU_NEW_ID = &quot;lnkNew&quot;;
        public const string MENU_EDIT = &quot;Edit&quot;;
        public const string MENU_EDIT_ID = &quot;lnkEdit&quot;;
        public const string MENU_REPORTS = &quot;Reports&quot;;
        public const string MENU_REPORTS_ID = &quot;lnkReports&quot;;
        public const string MENU_APPROVE_ID = &quot;lnkApprove&quot;;
        public const string MENU_APPROVE = &quot;Approve&quot;;
        public const string MENU_UNAPPROVE_ID = &quot;lnkUnApprove&quot;;
        public const string MENU_UNAPPROVE = &quot;Undo Approve&quot;;
        public const string MENU_REJECT_ID = &quot;lnkReject&quot;;
        public const string MENU_REJECT = &quot;Reject&quot;;
        private List&lt;MenuGroup&gt; menuGroups;
        protected string approveDate;
        protected string createDateColumn;

        protected bool disableRoleSelection = true;
        protected bool displayAddDynamicColumns = true;
        protected bool displayAddExistingItem;
        protected bool displayAddMultiple;
        protected bool displayApplyFilter;
        protected bool displayApprove;
        protected bool displayAttachItems;
        protected bool displayBOQ;
        protected bool displayBack;
        protected bool displayChangeStatus;
        protected bool displayCloseOut;
        protected bool displayComplete;
        protected bool displayCopy;
        private bool displayCostManager;
        protected bool displayCreateVersion;

        protected bool displayCrusherReport;
        protected bool displayDelete = true;
        protected bool displayDeleteVieworDB;
        protected bool displayEdit = true;
        protected bool displayErrorLog;
        protected bool displayExport;

        //protected bool displayFetchEIS;
        protected bool displayForecastAX;

        protected bool displayFormattor;
        protected bool displayImport;
        protected bool displayItemCopyPaste;
        protected bool displayItemListReport;
        protected bool displayLabourList;
        protected bool displayListSave;
        protected bool displayLock;
        protected bool displayManageUsers;
        protected bool displayNew = true;
        protected bool displayDocuments = false;
        protected bool displayNewAddendum;
        protected bool displayNewBidLetting;
        protected bool displayNewCO;
        protected bool displayNewContainer;
        protected bool displayOtherDropMenu = true;
        protected bool displayOverheadExpenses;
        protected bool displayMM = false;
        protected bool displayMMgroup = true;
        protected bool displayPermissions;
        protected bool displayRateAnalysis;
        protected bool displayReject;
        protected bool displayReply;
        protected bool displayReport;
        protected bool displayDetailsReport = false;
        protected bool displayReportsLand;
        protected bool displayReportsPE;
        protected bool displayReportsParcel;
        protected bool displayReportsProjects;
        protected bool displayReportsWO;
        protected bool displayReqforQuotation;
        protected bool displayRestore;
        protected bool displaySettings;
        protected bool displayStandardItems;
        protected bool displayStandardTable;
        protected bool displaySubItemCopyPaste;
        protected bool displaySubItems;

        //protected bool displaySyncEIS;
        protected bool displayTabs;

        protected bool displayTemplateExport;
        private bool displayTemplateExportWithData;
        protected bool displayTemplates;
        protected bool displayTransmittal;
        protected bool displayUnApprove;
        protected bool displayUnlock;
        protected bool displayView = true;
        protected bool displayViewPDF;
        protected bool displayWorkFlowHistory;
        protected bool displayWorkFlowUsers;
        protected bool displayAttachWorkflow;
        protected bool displayWorkFlowStatus;
        protected bool enableAttachItems;
        protected bool enableItemCopyPaste = true;
        private bool enableNew = true;
        protected bool enableNewAddendum;
        protected bool enableNewBidLetting;
        private bool enableNewContainer = true;
        protected bool enableSubItemCopyPaste = true;
        protected string instanceIDColumn;
        protected bool isApprovalDateEditable;
        public bool isMenuClickHandled = true;
        protected DateTime maxApproveDate = DateTime.MaxValue;
        protected DateTime minApproveDate = DateTime.MinValue;
        private DateTime submitionDate = MWDateTimeHelper.MWToday;
        protected bool displayWorkFlowAssociation;
        protected bool displayWorkFlowAllAssociations;
        protected bool _displayWorkFlowHelpDescription;
        protected bool showDetailsReport = true;
        protected bool showListPageReport = true;
        protected bool displayWorkFlowActionOnListPage = true;
        protected bool pickerCollectFilter = true;
        protected bool displayCheckList;
        protected bool displayMailMergeManage;
        protected bool displayMailMergeEmailAttach;
        protected bool loadIPC = false;
        protected bool displayAuditLog = true;
        protected bool displayReorder = false;
        protected bool displayImportExport = true;

        protected virtual bool DisplayTemplateExportWithData
        {
            get
            {
                return false; //displayTemplateExportWithData;
            }
        }

        public bool LoadIPC
        {
            get { return loadIPC; }
            set { loadIPC = value; }
        }

        public string ReferenceItemType { get; set; }
        public string PerformModuleSpecificTaskcontext { get; set; }

        public string PickerModuleId { get; set; }
        public int PickerParentId { get; set; }

        public bool PickerCollectFilter
        {
            get { return pickerCollectFilter; }
            set { pickerCollectFilter = value; }
        }

        public bool DisplayApplyFilter
        {
            get { return displayApplyFilter; }
            set { displayApplyFilter = value; }
        }

        public bool DisplayWorkFlowHistory
        {
            get { return displayWorkFlowHistory; }
            set { displayWorkFlowHistory = value; }
        }

        public bool DisplayWorkFlowUsers
        {
            get { return displayWorkFlowUsers; }
            set { displayWorkFlowUsers = value; }
        }

        public bool DisplayAttachWorkflow
        {
            get { return displayAttachWorkflow; }
            set { displayAttachWorkflow = value; }
        }

        public bool DisplayWorkFlowActionOnListPage
        {
            get { return displayWorkFlowActionOnListPage; }
            set { displayWorkFlowActionOnListPage = value; }
        }

        public bool DisplayWorkFlowStatus
        {
            get { return displayWorkFlowStatus; }
            set { displayWorkFlowStatus = value; }
        }

        public bool IsApprovalDateEditable
        {
            get { return isApprovalDateEditable; }
            set { isApprovalDateEditable = value; }
        }

        public DateTime MinApproveDate
        {
            get { return minApproveDate; }
            set { minApproveDate = value; }
        }

        public string InstanceIDColumn
        {
            get { return instanceIDColumn; }
            set { instanceIDColumn = value; }
        }

        public string CreateDateColumn
        {
            get { return createDateColumn; }
            set { createDateColumn = value; }
        }

        public string ApproveDate
        {
            get { return approveDate; }
            set { approveDate = value; }
        }

        public DateTime MaxApproveDate
        {
            get { return maxApproveDate; }
            set { maxApproveDate = value; }
        }

        public bool IsMenuClickHandled
        {
            get { return isMenuClickHandled; }
        }

        public bool DisableRoleSelection
        {
            get { return disableRoleSelection; }
            set { disableRoleSelection = value; }
        }

        public bool DisplayNew
        {
            get { return displayNew; }
            set { displayNew = value; }
        }

        public bool DisplayDocuments
        {
            get { return displayDocuments; }
            set { displayDocuments = value; }
        }

        public bool DisplayNewCO
        {
            get { return displayNewCO; }
        }

        public bool DisplayNewBidLetting
        {
            get { return displayNewBidLetting; }
            set { displayNewBidLetting = value; }
        }

        public bool EnableNewBidLetting
        {
            get { return enableNewBidLetting; }
            set { enableNewBidLetting = value; }
        }

        public bool DisplayNewAddendum
        {
            get { return displayNewAddendum; }
            set { displayNewAddendum = value; }
        }

        public bool EnableNewAddendum
        {
            get { return enableNewAddendum; }
            set { enableNewAddendum = value; }
        }

        public bool DisplayReportsPE
        {
            get { return displayReportsPE; }
        }

        public bool DisplayReportsProjects
        {
            get { return displayReportsProjects; }
        }

        public bool DisplayReportsLand
        {
            get { return displayReportsLand; }
        }

        public bool DisplayReportsParcel
        {
            get { return displayReportsParcel; }
        }

        public bool DisplayCrusherReport
        {
            get { return displayCrusherReport; }
            set { displayCrusherReport = value; }
        }

        public bool DisplayReportsWO
        {
            get { return displayReportsWO; }
            set { displayReportsWO = value; }
        }

        public bool DisplayDetailsReport
        {
            get { return displayDetailsReport; }
            set { displayDetailsReport = value; }
        }

        public bool DisplayEdit
        {
            get { return displayEdit; }
            set { displayEdit = value; }
        }

        public bool DisplayView
        {
            get { return displayView; }
        }

        public bool DisplayDelete
        {
            get { return displayDelete; }
            set { displayDelete = value; }
        }

        public bool DisplayListSave
        {
            get { return displayListSave; }
        }

        public bool DisplayDeleteVieworDB
        {
            get { return displayDeleteVieworDB; }
        }

        public bool DisplayCopy
        {
            get { return displayCopy; }
        }

        public bool DisplayUnlock
        {
            get { return displayUnlock; }
            set { displayUnlock = value; }
        }

        public bool DisplayLock
        {
            get { return displayLock; }
            set { displayLock = value; }
        }

        public bool DisplaySubItems
        {
            get { return displaySubItems; }
            set { displaySubItems = value; }
        }

        public bool DisplayRateAnalysis
        {
            get { return displayRateAnalysis; }
            set { displayRateAnalysis = value; }
        }

        public bool DisplayNewContainer
        {
            get { return displayNewContainer; }
            set { displayNewContainer = value; }
        }

        public bool DisplayMMgroup
        {
            get { return displayMMgroup; }
            set { displayMMgroup = value; }
        }

        public bool DisplayChangeStatus
        {
            get { return displayChangeStatus; }
        }

        public bool DisplayApprove
        {
            get { return displayApprove; }
            set { displayApprove = value; }
        }

        public bool DisplayUnApprove
        {
            get { return displayUnApprove; }
            set { displayUnApprove = value; }
        }

        public bool DisplayReject
        {
            get { return displayReject; }
            set { displayReject = value; }
        }

        public bool DisplayCloseOut
        {
            get { return displayCloseOut; }
        }

        public bool DisplayReply
        {
            get { return displayReply; }
        }

        public bool DisplayRestore
        {
            get { return displayRestore; }
        }

        public bool DisplayStandardItems
        {
            get { return displayStandardItems; }
        }

        public bool DisplayTransmittal
        {
            get { return displayTransmittal; }
        }

        public bool DisplayAddExistingItem
        {
            get { return displayAddExistingItem; }
        }

        public bool DisplayStandardTable
        {
            get { return displayStandardTable; }
        }

        public bool DisplayManageUsers
        {
            get { return displayManageUsers; }
        }

        public bool DisplayPermissions
        {
            get { return displayPermissions; }
        }

        public bool DisplayComplete
        {
            get { return displayComplete; }
        }

        public bool DisplayViewPDF
        {
            get { return displayViewPDF; }
        }

        //public bool DisplaySyncEIS
        //{
        //    get { return displaySyncEIS; }
        //}

        //public bool DisplayFetchEIS
        //{
        //    get { return displayFetchEIS; }
        //}

        public bool DisplayForecastAX
        {
            get { return displayForecastAX; }
        }

        public bool DisplayTemplates
        {
            get { return displayTemplates; }
        }

        public bool DisplayLabourList
        {
            get { return displayLabourList; }
            set { displayLabourList = value; }
        }

        public bool DisplayOtherDropMenu
        {
            get { return displayOtherDropMenu; }
            set { displayOtherDropMenu = value; }
        }

        public bool DisplayImport
        {
            get { return displayImport; }
            set { displayImport = value; }
        }

        public bool DisplayExport
        {
            get { return displayExport; }
            set { displayExport = value; }
        }

        public bool DisplayTemplateExport
        {
            get { return displayTemplateExport; }
            set { displayTemplateExport = value; }
        }

        public bool DisplayAddMultiple
        {
            get { return displayAddMultiple; }
            set { displayAddMultiple = value; }
        }

        public bool DisplaySettings
        {
            get { return displaySettings; }
        }

        public bool DisplayAddDynamicColumns
        {
            get { return displayAddDynamicColumns; }
        }

        public bool DisplayBOQ
        {
            get { return displayBOQ; }
        }

        public bool DisplayErrorLog
        {
            get { return displayErrorLog; }
            set { displayErrorLog = value; }
        }

        public bool DisplayReport
        {
            get { return displayReport; }
            set { displayReport = value; }
        }

        public bool DisplayImportExport
        {
            get { return displayImportExport; }
            set { displayImportExport = value; }
        }

        //public bool DisplayUploadedReport
        //{
        //    get
        //    {
        //        return displayUploadedReport;
        //    }
        //    set
        //    {
        //        this.displayUploadedReport = value;
        //    }
        //}
        public bool DisplayReqforQuotation
        {
            get { return displayReqforQuotation; }
            set { displayReqforQuotation = value; }
        }

        public bool DisplayAttachItems
        {
            get { return displayAttachItems; }
            set { displayAttachItems = value; }
        }

        public bool EnableAttachItems
        {
            get { return enableAttachItems; }
            set { enableAttachItems = value; }
        }

        public bool DisplayCreateVersion
        {
            get { return displayCreateVersion; }
            set { displayCreateVersion = value; }
        }

        public bool DisplayItemListReport
        {
            get { return displayItemListReport; }
            set { displayItemListReport = value; }
        }

        public bool DisplayItemCopyPaste
        {
            get { return displayItemCopyPaste; }
            set { displayItemCopyPaste = value; }
        }

        public bool DisplayOverheadExpenses
        {
            get { return displayOverheadExpenses; }
            set { displayOverheadExpenses = value; }
        }

        public bool EnableItemCopyPaste
        {
            get { return enableItemCopyPaste; }
            set { enableItemCopyPaste = value; }
        }

        public bool DisplaySubItemCopyPaste
        {
            get { return displaySubItemCopyPaste; }
            set { displaySubItemCopyPaste = value; }
        }

        public bool EnableSubItemCopyPaste
        {
            get { return enableSubItemCopyPaste; }
            set { enableSubItemCopyPaste = value; }
        }

        public bool DisplayForecastReport { get; set; }
        public bool DisplayExecutionView { get; set; }
        public bool DisplayContractView { get; set; }

        //public bool DisplayPlanningMenu { get; set; }
        public bool DisplaylnkEditForm { get; set; }

        // OTHER ACTIONS END HERE ----------------------------

        public bool DisplayTabs
        {
            get { return displayTabs; }
        }

        public bool DisplayBack
        {
            get { return displayBack; }
        }

        //public bool DisplayPDFReport
        //{
        //    get
        //    {
        //        return displayPDFReport;
        //    }
        //    set
        //    {
        //        displayPDFReport = value;
        //    }
        //}

        public bool EnableNew
        {
            get { return enableNew; }
            set { enableNew = value; }
        }

        public bool EnableNewContainer
        {
            get { return enableNewContainer; }
            set { enableNewContainer = value; }
        }

        public bool DisplayGlobalGroups { get; set; }

        public bool DisplayNotesforReject { get; set; }

        public bool DisplayWorkOrderIssueWorkflow { get; set; }

        public WebDateChooser SubmitionDatePicker { get; set; }

        public string SubmittionDateControl { get; set; }

        public DateTime SubmitionDate
        {
            get { return submitionDate; }
            set { submitionDate = value; }
        }

        public string SubmitEvent { get; set; }

        public string SubmitionDateLabel { get; set; }

        public bool DisplayCostManager
        {
            get { return displayCostManager; }
            set { displayCostManager = value; }
        }

        public bool DisplayWorkFlowAssociation
        {
            get { return displayWorkFlowAssociation; }
            set { displayWorkFlowAssociation = value; }
        }

        public bool DisplayWorkFlowAllAssociations
        {
            get { return displayWorkFlowAllAssociations; }
            set { displayWorkFlowAllAssociations = value; }
        }

        public bool DisplayWorkFlowHelpDescription
        {
            get { return _displayWorkFlowHelpDescription; }
            set { _displayWorkFlowHelpDescription = value; }
        }

        public bool ShowDetailsReport
        {
            get { return showDetailsReport; }
            set { showDetailsReport = value; }
        }

        public bool ShowListPageReport
        {
            get { return showListPageReport; }
            set { showListPageReport = value; }
        }

        public bool DisplayReorder
        {
            get { return displayReorder; }
            set { displayReorder = value; }
        }

        public bool DisplayCheckList
        {
            get { return displayCheckList; }
            set { displayCheckList = value; }
        }

        public virtual List&lt;MenuGroup&gt; MenuGroups
        {
            get
            {
                SetModulePermissions();
                menuGroups = new List&lt;MenuGroup&gt;();

                #region General Group

                MenuGroup GeneralGroup = new MenuGroup(GROUP_GENERAL);

                if (displayListSave) GeneralGroup.AddMenu(new LargeButton(&quot;lnkListSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;));
                if (displayNew) GeneralGroup.AddMenu(new LargeButton(MENU_NEW_ID, MENU_NEW, &quot;Icn_New.png&quot;));
                if (displayEdit) GeneralGroup.AddMenu(new TextIcon(MENU_EDIT_ID, MENU_EDIT, &quot;Icn_Edit_16.png&quot;));
                if (displayView) GeneralGroup.AddMenu(new TextIcon(&quot;lnkView&quot;, &quot;View&quot;, &quot;Icn_View_16.png&quot;));
                if (displayDelete) GeneralGroup.AddMenu(new TextIcon(&quot;lnkDelete&quot;, &quot;Delete&quot;, &quot;Icn_Delete_16.png&quot;));
                if (displayCheckList) GeneralGroup.AddMenu(new TextIcon(&quot;lnkCheckList&quot;, &quot;CheckList&quot;, &quot;Icn_AttachWorkflow_16.png&quot;));

                if (GeneralGroup.Menus.Count &gt; 0)
                    menuGroups.Add(GeneralGroup);

                #endregion General Group

                #region WorkFlows

                MenuGroup WorkFlowGroup = new MenuGroup(GROUP_WORKFLOW);

                if (displayApprove)
                    WorkFlowGroup.AddMenu(new TextIcon(MENU_APPROVE_ID, MENU_APPROVE, &quot;Icn_Approve_16.png&quot;));
                if (displayUnApprove)
                    WorkFlowGroup.AddMenu(new TextIcon(MENU_UNAPPROVE_ID, MENU_UNAPPROVE, &quot;Icn_Undoapprove_16.png&quot;));
                if (displayReject)
                    WorkFlowGroup.AddMenu(new TextIcon(MENU_REJECT_ID, MENU_REJECT, &quot;Icn_Reject_16.PNG&quot;));

                if (displayReply) WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkReply&quot;, &quot;Reply&quot;, &quot;IcnRespond.gif&quot;));
                if (displayTransmittal)
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkTransmittal&quot;, &quot;Transmittal&quot;, &quot;IcnSetDefault.gif&quot;));

                if (DisplayWorkOrderIssueWorkflow)
                {
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkOrderIssue&quot;, &quot;Issue&quot;, &quot;Icn_Approve_16.png&quot;));
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkIssueHistory&quot;, &quot;Issue History&quot;, &quot;Icn_Settings_16.png&quot;));
                }

                if (displayWorkFlowHistory)
                {
                    WorkFlowGroup.AddMenu(new LargeButton(&quot;lnkWorkFlowHistory&quot;, &quot;History&quot;, &quot;Icn_History.png&quot;));
                    if (displayWorkFlowStatus)
                        WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkFlowStatus&quot;, &quot;Status&quot;, &quot;Progress_16.png&quot;));
                }

                if (displayWorkFlowAssociation)
                {
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkFlowAssociation&quot;, &quot;Associate&quot;, &quot;Icn_wfAssociate.png&quot;));
                }

                if (displayWorkFlowUsers)
                {
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkFlowUserOverriding&quot;, &quot;Workflow User(s)&quot;,
                        &quot;Icn_WorkflowUsers.png&quot;));
                }

                if (displayAttachWorkflow)

                {
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkFlowAttach&quot;, &quot;Attach Workflow&quot;,
                        &quot;Icn_AttachWorkflow_16.png&quot;));
                }

                if (_displayWorkFlowHelpDescription)
                {
                    WorkFlowGroup.AddMenu(new TextIcon(&quot;lnkWorkFlowHelpDescription&quot;, &quot;Help&quot;, &quot;HelpTooltip.png&quot;));
                }
                if (WorkFlowGroup.Menus.Count &gt; 0)
                    menuGroups.Add(WorkFlowGroup);

                #endregion WorkFlows

                #region Others

                MenuGroup OtherGroup = new MenuGroup(GROUP_OTHERS);

                if (displayOtherDropMenu)
                {
                    #region Export/Import

                    List&lt;TextIcon&gt; lstImpExp = new List&lt;TextIcon&gt;();
                    if (displayImport)
                        lstImpExp.Add(new TextIcon(&quot;lnkExcelImport&quot;, &quot;Excel Import&quot;, &quot;Icn_importxl_16.png&quot;,
                            (HttpContext.Current.Handler as System.Web.UI.Page).ResolveUrl(&quot;~/Common/Import.aspx?&quot;) +
                            Request.QueryString));
                    if (displayExport)
                    {
                        lstImpExp.Add(new TextIcon(&quot;lnkExcelExport&quot;, &quot;Excel Export (xls)&quot;, &quot;Icn_export_16.png&quot;));
                        lstImpExp.Add(new TextIcon(&quot;lnkExcelExportXlsx&quot;, &quot;Excel Export (xlsx)&quot;, &quot;Icn_export_16.png&quot;));
                    }
                    if (displayTemplateExport)
                    {
                        lstImpExp.Add(new TextIcon(&quot;lnkTemplateExport&quot;, ExcelHelper.EXCEL_TEMPLATE,
                            &quot;Icn_exceltemplateexport_16.png&quot;));
                        lstImpExp.Add(new TextIcon(&quot;lnkTemplateExportXlsx&quot;, ExcelHelper.EXCEL_TEMPLATE_XLSX,
                            &quot;Icn_exceltemplateexport_16.png&quot;));
                    }

                    if (DisplayTemplateExportWithData &amp;&amp; displayExport)
                    {
                        lstImpExp.Add(new TextIcon(&quot;lnkTemplateExportWithData&quot;, ExcelHelper.EXCEL_TEMPLATE_WITH_DATA,
                    &quot;Icn_exceltemplateexport_16.png&quot;));
                        lstImpExp.Add(new TextIcon(&quot;lnkTemplateExportWithDataXlsx&quot;, ExcelHelper.EXCEL_TEMPLATE_WITH_DATA_XLSX,
                            &quot;Icn_exceltemplateexport_16.png&quot;));
                    }

                    if (DisplayImportExport)
                    {
                        if (lstImpExp.Count &gt; 1)
                        {
                            MenuButton menuImpExp = new MenuButton(&quot;lnkImportExport&quot;, &quot;Excel Import / Export&quot;,
                                &quot;Icn_xl_16.png&quot;);
                            menuImpExp.ButtonSize = ButtonSize.Medium;
                            lstImpExp.ForEach(mnu =&gt; { menuImpExp.AddSubMenu(mnu); });
                            OtherGroup.AddMenu(menuImpExp);
                        }
                        else
                            lstImpExp.ForEach(mnu =&gt; { OtherGroup.AddMenu(mnu); });
                    }

                    #endregion Export/Import

                    if (displayOverheadExpenses)
                        OtherGroup.AddMenu(new TextIcon(&quot;lnkOverheadExpenses&quot;, &quot;Overhead Expenses&quot;,
                            &quot;Icn_Overhead_16.png&quot;));
                    if (displayCloseOut)
                        OtherGroup.AddMenu(new TextIcon(&quot;lnkCloseOut&quot;, &quot;Close Out&quot;, &quot;Icn_ShortClose_16.png&quot;));

                    if (DisplaylnkEditForm)
                        OtherGroup.AddMenu(new TextIcon(&quot;lnkEditForm&quot;, &quot;Modify Form&quot;, &quot;Icn_Modifyform_16.png&quot;));
                }

                if (MailMergeManager.IsMailMergeEnabled &amp;&amp; displayMM)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkMailMerge&quot;, &quot;Mail Merge&quot;, &quot;IcnMailMerge_16.png&quot;)); //Hidden and functionality will be replaced by mail merge group menu

                if (DisplayApplyFilter)
                {
                    if (mwGrid != null)
                    {
                        mwGrid.MasterTableView.AllowFilteringByColumn = true;
                    }
                    else
                    {
                        var newFilter = new SplitButton(&quot;lnkFilterSplitButton&quot;, &quot;Filter&quot;, &quot;Icn_Filter.png&quot;);
                        newFilter.AddSubMenu(new TextIcon(&quot;lnkFilter&quot;, &quot;Filter&quot;, &quot;Icn_Filter.png&quot;));
                        newFilter.AddSubMenu(new TextIcon(&quot;lnkFilterClr&quot;, &quot;Remove Filter&quot;, &quot;Icn_Filterremove_16.png&quot;));
                        OtherGroup.AddMenu(newFilter);
                    }
                }

                if (displayFormattor)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkEditFormatter&quot;, &quot;Format Grid&quot;, &quot;Icn_Itemsdetail_16.png&quot;));
                if (displayComplete) OtherGroup.AddMenu(new TextIcon(&quot;lnkComplete&quot;, &quot;Complete&quot;, &quot;Icn_Complete_16.png&quot;));

                if (displayAddExistingItem)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkAddExistingItem&quot;,
                        &quot;Add Existing &quot; + GlobalizationUtility.SetResource(&quot;Item&quot;, false),
                        &quot;Icn_AddExistingItem_16.png&quot;));

                if (displayForecastAX)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkForecast&quot;, &quot;Forecast&quot;, &quot;Icn_Forecast_16.png&quot;));
                if (displayLabourList)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkLabourList&quot;,
                        LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString() + &quot; List&quot;,
                        &quot;Icn_tables_16.png&quot;));
                if (displayAttachItems)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkItems&quot;,
                        &quot;Attach &quot; + GlobalizationUtility.SetResource(&quot;Item&quot;, false) + &quot;s&quot;,
                        &quot;Icn_Attachboq_16.png&quot;));
                if (DisplayBack) OtherGroup.AddMenu(new TextIcon(&quot;lnkBack&quot;, &quot;Back&quot;, &quot;Icn_Back_16.png&quot;));
                if (DisplayDocuments)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkDocuments&quot;, &quot;Attachments&quot;, &quot;Icn_Editfolder_16.png&quot;));
                if (DisplayForecastReport)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkForecastReport&quot;, &quot;View PDF&quot;, &quot;Icn_ForecastRep_16.png&quot;));

                if (displayErrorLog) OtherGroup.AddMenu(new LargeButton(&quot;lnkViewLog&quot;, &quot;Error Log&quot;, &quot;Icn_Errorlog.png&quot;));

                OtherGroup.AddMenu(new TextIcon(&quot;lnkGridSetting&quot;, &quot;Customize List&quot;, &quot;icn_Customlist_16.png&quot;));
                if (displayAddDynamicColumns &amp;&amp; UserManagementBL.UserManager.Instance.IsUserAdministrator(UserDetail.GetCurrentUserDetail().UID))
                {
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkAddDynamicColumns&quot;, &quot;Expression List&quot;, &quot;Icn_AddColumn_16.png&quot;));
                }
                else
                    displayAddDynamicColumns = false;

                if (displayReorder)
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkReorder&quot;, &quot;Reorder&quot;, &quot;Icn_Reorder_16.png&quot;, showRedirectConfirmMessage: true));

                #region Report

                var newMenuReports = new MenuButton(MENU_REPORTS_ID, MENU_REPORTS, &quot;Icn_Reports.png&quot;);
                //if (displayReport &amp;&amp; ShowListPageReport)
                //    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkListReport&quot;, &quot;List Page Report&quot;, &quot;Icn_Pdf_16.png&quot;));
                //if (displayDetailsReport &amp;&amp; ShowDetailsReport)
                //    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkDetailsReport&quot;, &quot;Details Report&quot;, &quot;Icn_Pdf_16.png&quot;, &quot;&quot;, &quot;&quot;, ValidateSelection.OneItem, true));

                if (displayViewPDF) newMenuReports.AddSubMenu(new TextIcon(&quot;lnkViewPDF&quot;, &quot;View PDF&quot;, &quot;Icn_Pdf_16.png&quot;));

                #region Land Specific

                if (displayReportsLand)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkPendingAcquisition&quot;, &quot;Lands Pending For Acquisition&quot;,
                        &quot;Icn_Pdf_16.png&quot;));
                }

                #endregion Land Specific

                #region BOQ Specific

                if (displayItemListReport)
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkItemListReport&quot;, ItemNameAbbr + &quot; List Report&quot;,
                        &quot;Icn_Pdf_16.png&quot;));

                #endregion BOQ Specific

                #region Adding Applicable Reports (in the layout) as SubMenus

                if (layout != null &amp;&amp; layout.Reports.Count &gt; 0)
                {
                    foreach (ReportDetails report in layout.Reports)
                    {
                        if (report.ModelType.ToLower().Contains(modelType.ToString().ToLower()) &amp;&amp; report.IsActive)
                            AddSubReports(newMenuReports, report);
                    }
                }
                else if (xmlModel != null &amp;&amp; xmlModel.form != null &amp;&amp; xmlModel.form.Reports.Count &gt; 0)
                {
                    foreach (ReportDetails report in xmlModel.form.Reports)
                    {
                        if (report.IsActive)
                            AddSubReports(newMenuReports, report);
                    }
                }

                if (displayCrusherReport)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkCrusherDetails&quot;, &quot;Crusher Details Report&quot;,
                        &quot;Icn_Pdf_16.png&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkCrusherSummary&quot;, &quot;Crusher Summary Report&quot;,
                        &quot;Icn_Pdf_16.png&quot;));
                }

                #endregion Adding Applicable Reports (in the layout) as SubMenus

                //else
                //    displayReport = false;

                #endregion Report

                if (newMenuReports.SubMenus.Count &gt; 0)
                    OtherGroup.AddMenu(newMenuReports);

                #endregion Others

                #region Mail Merge

                MenuGroup MailMerge = new MenuGroup(GROUP_MAILMERGE);
                if (MailMergeManager.IsMailMergeEnabled &amp;&amp; displayMMgroup)
                {
                    if (displayMailMergeManage)
                        MailMerge.AddMenu(new TextIcon(&quot;lnkMailMergeManage&quot;, &quot;Manage&quot;, &quot;IcnMailMerge_16.png&quot;));
                    if (displayMailMergeEmailAttach)
                    {
                        MailMerge.AddMenu(new TextIcon(&quot;lnkMailMergeAttach&quot;, &quot;Merge and Attach&quot;, &quot;Icn_Attachboq_16.png&quot;));
                        MailMerge.AddMenu(new TextIcon(&quot;lnkMailMergeMail&quot;, &quot;Merge and Email&quot;, &quot;Icn_email_16.png&quot;));
                    }

                    // MialMerge.AddMenu(new TextIcon(&quot;lnkMailMergeMailBody&quot;, &quot;Mail Body Template&quot;, &quot;Icn_Quotation_16.png&quot;));
                    if (MailMerge.Menus.Count &gt; 0)
                        menuGroups.Add(MailMerge);
                }

                #endregion

                if (ShowMapView)
                {
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkListView&quot;, &quot;List View&quot;, &quot;Icn_View_16.png&quot;));
                    OtherGroup.AddMenu(new TextIcon(&quot;lnkMapView&quot;, &quot;Map View&quot;, &quot;Icn_View_16.png&quot;));
                }

                if (OtherGroup.Menus.Count &gt; 0)
                    menuGroups.Add(OtherGroup);

                MenuGroup mgFilterManager = GenerateMenuItem_AddFilterManagerMenu();

                if (mgFilterManager != null)
                    menuGroups.Add(mgFilterManager);

                return menuGroups;
            }
        }

        public void DisplayFilterForColumns()
        {
            if (DisplayApplyFilter)
            {
                if (mwGrid != null)
                {
                    mwGrid.MasterTableView.AllowFilteringByColumn = true;
                }
            }
        }

        private static void AddSubReports(MenuButton newMenuReports, ReportDetails report)
        {
            List&lt;string&gt; coreModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            var permissions = new List&lt;string&gt;();
            if (HttpContext.Current.Items.Contains(Constants.MODULE_PERMISSIONS))
            {
                permissions = (List&lt;string&gt;)HttpContext.Current.Items[Constants.MODULE_PERMISSIONS];

                string featureCode = report.Context;

                if (report.ReportType.Equals(ReportHostType.dda.ToString2(), StringComparison.InvariantCultureIgnoreCase))
                    featureCode += &quot;Report&quot; + (string.IsNullOrEmpty(report.Code) ? &quot;&quot; : &quot;-&quot; + report.Code);
                else if (report.ParentModuleID.Equals(&quot;library&quot;, StringComparison.InvariantCultureIgnoreCase) &amp;&amp; coreModuleComponents.Contains(&quot;ShowUnifiedLibraryPermissions&quot;))
                {
                    if (report.Context.EndsWith(&quot;list&quot;, StringComparison.InvariantCultureIgnoreCase))
                        featureCode = &quot;ListReport&quot;;
                    else if (report.Context.EndsWith(&quot;details&quot;, StringComparison.InvariantCultureIgnoreCase))
                        featureCode = &quot;DetailsReport&quot;;
                }

                if (permissions.Contains(featureCode))
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnk&quot; + report.Context, report.Description ?? report.Name,
                        &quot;Icn_Pdf_16.png&quot;, &quot;&quot;, &quot;&quot;, (ValidateSelection)report.SelectRecord));
            }
        }

        public virtual MenuArray Menus
        {
            get
            {
                SetModulePermissions();
                var menus = new MenuArray(); //ToolBarHelper.SetMenu(this);
                //if (menus == null)
                //{
                //menus = new MenuArray();

                if (displayFormattor)
                    menus.Add(new BrixMenu(&quot;lnkEditFormatter&quot;, &quot;Format Grid&quot;, &quot;Icn_BOQDetails.gif&quot;, 55));
                if (displayListSave) menus.Add(new BrixMenu(&quot;lnkListSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;, 55));

                #region BOQ Specific

                if (displayUnlock) menus.Add(new BrixMenu(&quot;lnkUnlock&quot;, &quot;Unlock&quot;, &quot;IcnUnlock.png&quot;, 70));
                if (displayLock) menus.Add(new BrixMenu(&quot;lnkLock&quot;, &quot;Lock&quot;, &quot;IcnLock.png&quot;, 65));

                #endregion BOQ Specific

                if (displayApprove) menus.Add(new BrixMenu(&quot;lnkApprove&quot;, &quot;Approve&quot;, &quot;Icn_Approve.png&quot;, 80));
                if (displayUnApprove) menus.Add(new BrixMenu(&quot;lnkUnApprove&quot;, &quot;Undo Approve&quot;, &quot;Icn_Unapprove.png&quot;, 110));
                if (displayReject) menus.Add(new BrixMenu(&quot;lnkReject&quot;, &quot;Reject&quot;, &quot;Icn_Reject.png&quot;, 75));
                if (displayWorkFlowHistory)
                {
                    menus.Add(new BrixMenu(&quot;lnkWorkFlowHistory&quot;, &quot;History&quot;, &quot;Icn_History.png&quot;, 70));
                    if (displayWorkFlowStatus)
                        menus.Add(new BrixMenu(&quot;lnkWorkFlowStatus&quot;, &quot;Status&quot;, &quot;Progress_16.png&quot;, 70));
                }
                if (displayWorkFlowAssociation)
                    menus.Add(new BrixMenu(&quot;lnkWorkFlowAssociation&quot;, &quot;Associate&quot;, &quot;Icn_wfAssociate.png&quot;, 70));
                if (displayWorkFlowUsers)
                    menus.Add(new BrixMenu(&quot;lnkWorkFlowUserOverriding&quot;, &quot;Workflow User(s)&quot;, &quot;Icn_WorkflowUsers.png&quot;, 70));

                if (displayAttachWorkflow)
                    menus.Add(new BrixMenu(&quot;lnkWorkFlowAttach&quot;, &quot;Attach Workflow&quot;, &quot;Icn_AttachWorkflow_16.png&quot;, 70));

                if (displayReply) menus.Add(new BrixMenu(&quot;lnkReply&quot;, &quot;Reply&quot;, &quot;Icn_Respond.png&quot;, 70));
                if (displayTransmittal)
                    menus.Add(new BrixMenu(&quot;lnkTransmittal&quot;, &quot;Transmittal&quot;, &quot;Icn_SetDefault.png&quot;, 110));
                if (displayStandardItems)
                    menus.Add(new BrixMenu(&quot;lnkStandardItems&quot;, &quot;Standard Items&quot;, &quot;Icn_StandardItems.png&quot;, 120));
                if (displayStandardTable)
                    menus.Add(new BrixMenu(&quot;lnkStandardTables&quot;, &quot;Standard Tables&quot;,
                        &quot;~/Common/BrixListPage.aspx?Context=STDTABS&quot;, &quot;Icn_tables .png&quot;, 130));
                if (displayComplete) menus.Add(new BrixMenu(&quot;lnkComplete&quot;, &quot;Complete&quot;, &quot;Icn_complete .png&quot;, 80));

                if (displayPermissions)
                    menus.Add(new BrixMenu(&quot;lnkPermissions&quot;, &quot;Permissions&quot;, &quot;Icn_permissions.png&quot;, 110));
                if (displayAddExistingItem)
                    menus.Add(new BrixMenu(&quot;lnkAddExistingItem&quot;,
                        &quot;Add Existing &quot; + GlobalizationUtility.SetResource(&quot;Item&quot;, false),
                        &quot;Icn_AddExistingItem.png&quot;, 140));

                //if (DisplayPlanningMenu)
                //{
                //    var planningMenu = new BrixMenu(&quot;lnkPlanning&quot;, &quot;Scheduling&quot;, &quot;Calendar32.png&quot;, 90, 170);
                //    if (displaySyncEIS)
                //        planningMenu.subMenus.Add(new BrixMenu(&quot;lnkSync&quot;, &quot;Synchronise&quot;, &quot;Icn_MSPSync16.png&quot;));
                //    if (displayFetchEIS)
                //        planningMenu.subMenus.Add(new BrixMenu(&quot;lnkFetch&quot;, &quot;Fetch&quot;, &quot;Icn_MSPFetch16.png&quot;));
                //    menus.Add(planningMenu);
                //}
                //else
                //{
                //    if (displaySyncEIS) menus.Add(new BrixMenu(&quot;lnkSync&quot;, &quot;Synchronise&quot;, &quot;Icn_MSPSync.png&quot;, 90));
                //    if (displayFetchEIS) menus.Add(new BrixMenu(&quot;lnkFetch&quot;, &quot;Fetch&quot;, &quot;Icn_MSPFetch.png&quot;, 90));
                //}

                if (DisplayExecutionView)
                    menus.Add(new BrixMenu(&quot;lnkExecutionView&quot;, &quot;Execution View&quot;, &quot;ExecutionView.png&quot;, 90));
                if (DisplayContractView)
                    menus.Add(new BrixMenu(&quot;lnkContractView&quot;, &quot;Contract View&quot;, &quot;ContractView.png&quot;, 90));

                if (displayForecastAX) menus.Add(new BrixMenu(&quot;lnkForecast&quot;, &quot;Forecast&quot;, &quot;Icn_Forecast.png&quot;, 90));
                if (displayLabourList)
                    menus.Add(new BrixMenu(&quot;lnkLabourList&quot;,
                        LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString() + &quot; List&quot;,
                        &quot;Icn_tables .png&quot;, 90));
                if (displayAttachItems)
                    menus.Add(new BrixMenu(&quot;lnkItems&quot;, &quot;Attach &quot; + GlobalizationUtility.SetResource(&quot;Item&quot;, false) + &quot;s&quot;,
                        &quot;Icn_Add.png&quot;, 90));
                if (DisplayBack) menus.Add(new BrixMenu(&quot;lnkBack&quot;, &quot;Back&quot;, &quot;Icn_Back.png&quot;, 90));
                if (DisplayForecastReport)
                    menus.Add(new BrixMenu(&quot;lnkForecastReport&quot;, &quot;View PDF&quot;, &quot;IcnReports.png&quot;, 90));
                if (DisplayWorkOrderIssueWorkflow)
                {
                    menus.Add(new BrixMenu(&quot;lnkWorkOrderIssue&quot;, &quot;Issue&quot;, &quot;Icn_Approve.png&quot;, 80));
                    menus.Add(new BrixMenu(&quot;lnkIssueHistory&quot;, &quot;Issue History&quot;, &quot;Icn_Settings.png&quot;, 70));
                }
                var newMenuReports = new MenuButton(MENU_REPORTS_ID, &quot;Reports&quot;, &quot;IcnReports.png&quot;, &quot;&quot;, &quot;Reports&quot;, true);
                //if (displayReport &amp;&amp; ShowListPageReport)
                //    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkReport&quot;, &quot;List Page Report&quot;, &quot;Icn_viewPDF.gif&quot;));
                //if (displayDetailsReport &amp;&amp; ShowDetailsReport)
                //    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkDetailsReport&quot;, &quot;Details Report&quot;, &quot;Icn_viewPDF.gif&quot;));
                if (displayReportsPE)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkReportOverview&quot;, PayEstimateName + &quot; Overview&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkReportSections&quot;, PayEstimateName + &quot; Detail&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkReportGroups&quot;, PayEstimateName + &quot; by &quot; + Group,
                        &quot;Icn_viewPDF.gif&quot;));
                }
                if (displayReportsProjects)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkActiveProjects&quot;, &quot;Active Projects List&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkInactiveProjects&quot;, &quot;Inactive Projects List&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkProjectStatus&quot;, &quot;Project Status Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkProjectSummary&quot;, &quot;Project Summary Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkProjectDetails&quot;, &quot;Project Details Report&quot;,
                        &quot;Icn_exportxl.gif&quot;));
                }
                if (displayReportsLand)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkPendingAcquisition&quot;, &quot;Lands Pending For Acquisition&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                }
                if (displayReportsParcel)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkParcelReport&quot;, &quot;Parcel Activities Status Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkPendingActivites&quot;, &quot;Parcel Activities Pending Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                }
                if (displayCrusherReport)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkCrusherDetails&quot;, &quot;Crusher Details Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkCrusherSummary&quot;, &quot;Crusher Summary Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));
                }
                if (displayReportsWO)
                {
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkViewPDF&quot;, &quot;Work Order Details&quot;, &quot;Icn_viewPDF.gif&quot;));
                }

                //if (displayPDFReport) othersMenu.subMenus.Add(new BrixMenu(&quot;lnkPDFReport&quot;, &quot;Report&quot;, &quot;Icn_importxlt.gif&quot;));

                if (displayItemListReport)
                    newMenuReports.AddSubMenu(new TextIcon(&quot;lnkItemListReport&quot;, ItemNameAbbr + &quot; List Report&quot;,
                        &quot;Icn_viewPDF.gif&quot;));

                //if (displayReport)
                //{

                #region Adding Applicable Reports (in the layout) as SubMenus

                if (layout != null &amp;&amp; layout.Reports.Count &gt; 0)
                {
                    foreach (ReportDetails report in layout.Reports)
                    {
                        if (report.ModelType.ToLower().Contains(modelType.ToString().ToLower()) &amp;&amp; report.IsActive)
                            newMenuReports.AddSubMenu(new TextIcon(&quot;lnk&quot; + report.Name,
                                report.Description ?? report.Name,
                                &quot;Icn_viewPDF.gif&quot;));
                    }
                }
                else if (xmlModel != null &amp;&amp; xmlModel.form != null &amp;&amp; xmlModel.form.Reports.Count &gt; 0)
                {
                    foreach (ReportDetails report in xmlModel.form.Reports)
                    {
                        if (report.IsActive)
                            newMenuReports.AddSubMenu(new TextIcon(&quot;lnk&quot; + report.Name,
                                report.Description ?? report.Name,
                                &quot;Icn_viewPDF.gif&quot;));
                    }
                }

                #endregion Adding Applicable Reports (in the layout) as SubMenus

                //}
                if (newMenuReports.SubMenus.Count &gt; 0)
                    menus.Add(newMenuReports);
                else
                    displayReport = false;

                var othersMenu = new BrixMenu(&quot;lnkOthers&quot;, &quot;Others&quot;, &quot;IcnOthers.png&quot;, 70, 170);

                if (displayOtherDropMenu)
                {
                    List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                    if (displaySubItems &amp;&amp; ModuleComponents.Contains(&quot;SubItems&quot;) &amp;&amp;
                        ModuleComponents.Contains(&quot;ONGFundMgmt&quot;))
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkSubItems&quot;, &quot;Sub items&quot;, &quot;Icn_Subitems1.png&quot;, 90));

                    if (displayRateAnalysis)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkRateAnalysis&quot;, &quot;Rate Analysis&quot;, &quot;Icn_Rateanalysis1.png&quot;,
                            105));

                    if (displayImport)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkExcelImport&quot;, &quot;Excel Import&quot;,
                            &quot;~/Common/Import.aspx?&quot; + Request.QueryString,
                            &quot;Icn_importxl.gif&quot;));

                    if (displayExport)
                    {
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkExcelExport&quot;, &quot;Excel Export (xls)&quot;, &quot;Icn_exportxl.gif&quot;));
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkExcelExportXlsx&quot;, &quot;Excel Export (xlsx)&quot;,
                            &quot;Icn_exportxl.gif&quot;));
                    }

                    if (displayCopy) othersMenu.subMenus.Add(new BrixMenu(&quot;lnkCopy&quot;, &quot;Copy&quot;, &quot;IcnCopy.png&quot;));

                    List&lt;string&gt; CoreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                    if (displayChangeStatus &amp;&amp; !CoreComponents.Contains(&quot;HideChangeStatus&quot;))
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkChgStatus&quot;, &quot;Change Status&quot;, &quot;Icn_ChangeStatus16.png&quot;));

                    if (displayManageUsers)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkManageUsers&quot;, &quot;Manage Users&quot;, &quot;Icn_ManageUsers16.png&quot;,
                            120));

                    if (displayTemplateExport)
                    {
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkTemplateExport&quot;, ExcelHelper.EXCEL_TEMPLATE,
                            &quot;Icn_importxlt.gif&quot;));
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkTemplateExport&quot;, ExcelHelper.EXCEL_TEMPLATE_XLSX,
                            &quot;Icn_importxlt.gif&quot;));
                    }

                    if (DisplayTemplateExportWithData &amp;&amp; displayTemplateExport)
                    {
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkTemplateExportWithData&quot;, ExcelHelper.EXCEL_TEMPLATE_WITH_DATA,
                         &quot;Icn_importxlt.gif&quot;));
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkTemplateExportWithData&quot;, ExcelHelper.EXCEL_TEMPLATE_WITH_DATA_XLSX,
                            &quot;Icn_importxlt.gif&quot;));
                    }

                    if (displaySettings)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkSettings&quot;, &quot;Settings&quot;, &quot;Icn_Workflow.gif&quot;));

                    if (displayTemplates)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkTemplates&quot;, &quot;Templates&quot;, &quot;IcnTemplates.gif&quot;));

                    if (displayRestore)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkRestore&quot;, &quot;Restore&quot;, &quot;IcnRestore.gif&quot;));

                    if (displayItemCopyPaste)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkItemCopyPaste&quot;, &quot;Copy &quot; + ItemNameAbbr + &quot;s&quot;,
                            &quot;IcnCopy.png&quot;));
                    if (displaySubItemCopyPaste &amp;&amp; ModuleComponents.Contains(&quot;SubItems&quot;) &amp;&amp;
                        ModuleComponents.Contains(&quot;ONGFundMgmt&quot;))
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkSubItemCopyPaste&quot;, &quot;Copy Sub Items&quot;, &quot;IcnCopy.png&quot;));
                    if (displayOverheadExpenses)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkOverheadExpenses&quot;, &quot;Overhead Expenses&quot;,
                            &quot;IcnOverhead.png&quot;));

                    //if (displayBOQ) othersMenu.subMenus.Add(new BrixMenu(&quot;lnkBOQ&quot;, &quot;Balance Contract Bill of Quantities(BOQ)&quot;, &quot;Icn_BOQ.gif&quot;));
                    if (displayCloseOut)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkCloseOut&quot;, &quot;Close Out&quot;, &quot;Icn_Reject16.png&quot;));

                    if (DisplaylnkEditForm)
                        othersMenu.subMenus.Add(new BrixMenu(&quot;lnkEditForm&quot;, &quot;Modify Form&quot;, &quot;IcnCopy.png&quot;, 90));
                }

                othersMenu.subMenus.Add(new BrixMenu(&quot;lnkGridSetting&quot;, &quot;Customize List&quot;, &quot;Icn_Workflow.gif&quot;, 90));
                if (MailMergeManager.IsMailMergeEnabled)
                    othersMenu.subMenus.Add(new BrixMenu(&quot;lnkMailMerge&quot;, &quot;Mail Merge&quot;, &quot;Icn_Workflow.gif&quot;, 90));
                if (displayAddDynamicColumns &amp;&amp; UserManager.Instance.IsUserAdministrator(UserDetail.GetCurrentUserDetail().UID))
                {
                    othersMenu.subMenus.Add(new BrixMenu(&quot;lnkAddDynamicColumns&quot;, &quot;Expression List&quot;, &quot;Icn_AddColumn.png&quot;));
                }
                else
                    displayAddDynamicColumns = false;

                menus.Add(othersMenu);

                #region Project Specific

                //if (displayCostManager)
                //{
                //    menus.Add(new BrixMenu(&quot;lnkCostManager&quot;, &quot;Cost View&quot;, &quot;IcnReports.png&quot;, 70));
                //}

                #endregion Project Specific

                if (displayErrorLog) menus.Add(new BrixMenu(&quot;lnkViewLog&quot;, &quot;Error Log&quot;, &quot;Icn_tables .png&quot;, 90));

                if (DisplayApplyFilter)
                {
                    if (mwGrid != null)
                    {
                        mwGrid.MasterTableView.AllowFilteringByColumn = true;
                    }
                    else
                    {
                        menus.Add(new BrixMenu(&quot;lnkFilter&quot;, &quot;Filter&quot;, &quot;IcnFilterApply.png&quot;, 70));
                        menus.Add(new BrixMenu(&quot;lnkFilterClr&quot;, &quot;Remove Filter&quot;, &quot;IcnFilterRem.png&quot;, 70));
                    }
                }
                return menus;
            }
        }

        public bool DisplayAuditLog
        {
            get { return displayAuditLog; }
            set { displayAuditLog = value; }
        }

        private void SetModulePermissions()
        {
            var permissions = new List&lt;string&gt;();
            if (HttpContext.Current.Items.Contains(Constants.MODULE_PERMISSIONS))
            {
                permissions = (List&lt;string&gt;)HttpContext.Current.Items[Constants.MODULE_PERMISSIONS];
                if (displayNewCO &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displayNewCO = false;
                if (displayNew &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displayNew = false;
                if (displayEdit &amp;&amp; !permissions.Contains(&quot;Edit&quot;)) displayEdit = false;
                if (displayReorder &amp;&amp; !permissions.Contains(&quot;Edit&quot;)) displayReorder = false;// Must have edit permissions to reorder items.
                if (displayView &amp;&amp; !permissions.Contains(&quot;View&quot;)) displayView = false;
                if (displayCopy &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displayCopy = false;
                if (displayDelete &amp;&amp; !permissions.Contains(&quot;Delete&quot;)) displayDelete = false;
                if (displayDeleteVieworDB &amp;&amp; !permissions.Contains(&quot;Delete&quot;)) displayDeleteVieworDB = false;
                if (displaySubItems &amp;&amp; !permissions.Contains(&quot;Edit&quot;)) displaySubItems = false;
                if (displayRateAnalysis &amp;&amp; !permissions.Contains(&quot;Edit&quot;)) displayRateAnalysis = false;
                if (displayNewContainer &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displayNewContainer = false;
                if (displayApprove &amp;&amp; xmlModel == null &amp;&amp; !permissions.Contains(&quot;Approve&quot;)) displayApprove = false;
                if (displayUnApprove
                    &amp;&amp; !(permissions.Contains(&quot;UnApprove&quot;)
                         || permissions.Contains(&quot;Unapprove&quot;)))
                    displayUnApprove = false;
                if (displayReject
                    &amp;&amp; !(permissions.Contains(&quot;Reject&quot;)
                         || permissions.Contains(&quot;Reject&quot;)))
                    displayReject = false;
                if (displayLock &amp;&amp; !permissions.Contains(&quot;LockItems&quot;)) displayLock = false;
                if (displayUnlock &amp;&amp; !permissions.Contains(&quot;LockItems&quot;)) displayUnlock = false;
                if (displayCloseOut &amp;&amp; !permissions.Contains(&quot;CloseOut&quot;)) displayCloseOut = false;
                if (displayReply &amp;&amp; !permissions.Contains(&quot;Reply&quot;)) displayReply = false;
                if (displayTransmittal &amp;&amp; !permissions.Contains(&quot;Transmit&quot;)) displayTransmittal = false;
                if (displayStandardItems &amp;&amp; !permissions.Contains(&quot;Visibility&quot;)) displayStandardItems = false;
                if (displayStandardTable &amp;&amp; !permissions.Contains(&quot;Visibility&quot;)) displayStandardTable = false;
                if (displayComplete &amp;&amp; !permissions.Contains(&quot;Edit&quot;)) displayComplete = false;
                if (displayViewPDF &amp;&amp; !permissions.Contains(&quot;View&quot;)) displayViewPDF = false;
                if (displayManageUsers &amp;&amp; !permissions.Contains(&quot;ManageUsers&quot;)) displayManageUsers = false;
                if (displayAddExistingItem &amp;&amp; !permissions.Contains(&quot;AddendumCreate&quot;)) displayAddExistingItem = false;
                if (displayOtherDropMenu)
                {
                    if (displayImport &amp;&amp; !(permissions.Contains(&quot;Create&quot;) || permissions.Contains(&quot;ImportItems&quot;)))
                        displayImport = false;
                    if (displayAddMultiple &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displayAddMultiple = false;
                    if (displaySettings &amp;&amp; !permissions.Contains(&quot;Create&quot;)) displaySettings = false;
                }
                //if (displaySyncEIS &amp;&amp; !(permissions.Contains(&quot;Create&quot;) || permissions.Contains(&quot;Edit&quot;)))
                //    displaySyncEIS = false;
                //if (displayFetchEIS &amp;&amp; !(permissions.Contains(&quot;Create&quot;) || permissions.Contains(&quot;Edit&quot;)))
                //    displayFetchEIS = false;
                if (displayForecastAX &amp;&amp; !(permissions.Contains(&quot;Create&quot;) || permissions.Contains(&quot;Edit&quot;)))
                    displayForecastAX = false;
                if (displayCostManager &amp;&amp; !(permissions.Contains(&quot;Create&quot;) || permissions.Contains(&quot;ViewCost&quot;)))
                    displayCostManager = false;

                //TO show or hide Workflow user(s) button base on Permission.
                if (displayWorkFlowUsers &amp;&amp;
                    !(ModuleManager.Instance.GetPermissionByUserOrRole(&quot;WORKFLW&quot;, UserDetail.GetCurrentUserDetail().UID,
                        UserDetail.GetCurrentUserDetail().RID,
                        (string.IsNullOrEmpty(Request[&quot;PID&quot;]) ? 0 : Request[&quot;PID&quot;].ToInt32_2()))
                        .Contains(&quot;UserOverriding&quot;)))
                    displayWorkFlowUsers = false;

                SetMailMergePermissions(permissions);
            }

            SetModuleLevelPermissions(permissions);
        }

        private void SetMailMergePermissions(List&lt;string&gt; permissions)
        {
            if (permissions.Contains(&quot;View&quot;) &amp;&amp; permissions.Contains(&quot;Visibility&quot;) &amp;&amp; permissions.Contains(&quot;MailMergeManage&quot;))
                displayMailMergeManage = true;
            if (permissions.Contains(&quot;View&quot;) &amp;&amp; permissions.Contains(&quot;Visibility&quot;) &amp;&amp; permissions.Contains(&quot;MailMergeEmailandAttach&quot;))
                displayMailMergeEmailAttach = true;
        }

        public virtual void SetSubmitionDates(WebDateChooser submitionDate)
        {
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[40,9,40,52,1],[41,9,41,56,1],[57,9,57,45,1],[59,9,59,43,1],[74,9,74,42,1],[75,9,75,49,1],[80,9,80,52,1],[82,9,82,42,1],[83,9,83,46,1],[89,9,89,53,1],[112,9,112,43,1],[119,9,119,51,1],[120,9,120,39,1],[123,9,123,48,1],[124,9,124,54,1],[127,9,127,47,1],[128,9,128,63,1],[129,9,129,63,1],[130,9,130,67,1],[134,9,134,49,1],[135,9,135,50,1],[136,9,136,63,1],[137,9,137,51,1],[141,9,141,40,1],[142,9,142,47,1],[143,9,143,47,1],[144,9,144,51,1],[149,13,149,14,1],[150,17,150,30,1],[151,13,151,14,1],[156,17,156,18,1],[156,19,156,34,1],[156,35,156,36,1],[157,17,157,18,1],[157,19,157,35,1],[157,36,157,37,1],[160,43,160,47,1],[160,48,160,52,1],[161,58,161,62,1],[161,63,161,67,1],[163,40,163,44,1],[163,45,163,49,1],[164,37,164,41,1],[164,42,164,46,1],[168,17,168,18,1],[168,19,168,46,1],[168,47,168,48,1],[169,17,169,18,1],[169,19,169,47,1],[169,48,169,49,1],[174,17,174,18,1],[174,19,174,45,1],[174,46,174,47,1],[175,17,175,18,1],[175,19,175,46,1],[175,47,175,48,1],[180,17,180,18,1],[180,19,180,49,1],[180,50,180,51,1],[181,17,181,18,1],[181,19,181,50,1],[181,51,181,52,1],[186,17,186,18,1],[186,19,186,47,1],[186,48,186,49,1],[187,17,187,18,1],[187,19,187,48,1],[187,49,187,50,1],[192,17,192,18,1],[192,19,192,48,1],[192,49,192,50,1],[193,17,193,18,0],[193,19,193,49,0],[193,50,193,51,0],[198,17,198,18,1],[198,19,198,58,1],[198,59,198,60,1],[199,17,199,18,0],[199,19,199,59,0],[199,60,199,61,0],[204,17,204,18,1],[204,19,204,48,1],[204,49,204,50,1],[205,17,205,18,1],[205,19,205,49,1],[205,50,205,51,1],[210,17,210,18,0],[210,19,210,49,0],[210,50,210,51,0],[211,17,211,18,0],[211,19,211,50,0],[211,51,211,52,0],[216,17,216,18,0],[216,19,216,41,0],[216,42,216,43,0],[217,17,217,18,0],[217,19,217,42,0],[217,43,217,44,0],[222,17,222,18,0],[222,19,222,43,0],[222,44,222,45,0],[223,17,223,18,1],[223,19,223,44,1],[223,45,223,46,1],[228,17,228,18,0],[228,19,228,43,0],[228,44,228,45,0],[229,17,229,18,1],[229,19,229,44,1],[229,45,229,46,1],[234,17,234,18,0],[234,19,234,38,0],[234,39,234,40,0],[235,17,235,18,0],[235,19,235,39,0],[235,40,235,41,0],[240,17,240,18,0],[240,19,240,41,0],[240,42,240,43,0],[241,17,241,18,0],[241,19,241,42,0],[241,43,241,44,0],[246,17,246,18,1],[246,19,246,45,1],[246,46,246,47,1],[251,17,251,18,1],[251,19,251,47,1],[251,48,251,49,1],[252,17,252,18,1],[252,19,252,48,1],[252,49,252,50,1],[257,17,257,18,1],[257,19,257,37,1],[257,38,257,39,1],[258,17,258,18,1],[258,19,258,38,1],[258,39,258,40,1],[263,17,263,18,1],[263,19,263,43,1],[263,44,263,45,1],[264,17,264,18,1],[264,19,264,44,1],[264,45,264,46,1],[269,17,269,18,1],[269,19,269,39,1],[269,40,269,41,1],[274,17,274,18,0],[274,19,274,47,0],[274,48,274,49,0],[275,17,275,18,1],[275,19,275,48,1],[275,49,275,50,1],[280,17,280,18,0],[280,19,280,46,0],[280,47,280,48,0],[281,17,281,18,0],[281,19,281,47,0],[281,48,281,49,0],[286,17,286,18,0],[286,19,286,45,0],[286,46,286,47,0],[287,17,287,18,0],[287,19,287,46,0],[287,47,287,48,0],[292,17,292,18,0],[292,19,292,44,0],[292,45,292,46,0],[293,17,293,18,0],[293,19,293,45,0],[293,46,293,47,0],[298,17,298,18,0],[298,19,298,43,0],[298,44,298,45,0],[303,17,303,18,0],[303,19,303,49,0],[303,50,303,51,0],[308,17,308,18,0],[308,19,308,45,0],[308,46,308,47,0],[313,17,313,18,0],[313,19,313,47,0],[313,48,313,49,0],[318,17,318,18,0],[318,19,318,47,0],[318,48,318,49,0],[319,17,319,18,0],[319,19,319,48,0],[319,49,319,50,0],[324,17,324,18,0],[324,19,324,43,0],[324,44,324,45,0],[325,17,325,18,0],[325,19,325,44,0],[325,45,325,46,0],[330,17,330,18,0],[330,19,330,47,0],[330,48,330,49,0],[331,17,331,18,1],[331,19,331,48,1],[331,49,331,50,1],[336,17,336,18,1],[336,19,336,38,1],[336,39,336,40,1],[337,17,337,18,1],[337,19,337,39,1],[337,40,337,41,1],[342,17,342,18,1],[342,19,342,38,1],[342,39,342,40,1],[347,17,347,18,1],[347,19,347,40,1],[347,41,347,42,1],[348,17,348,18,0],[348,19,348,41,0],[348,42,348,43,0],[353,17,353,18,1],[353,19,353,42,1],[353,43,353,44,1],[358,17,358,18,1],[358,19,358,48,1],[358,49,358,50,1],[363,17,363,18,1],[363,19,363,38,1],[363,39,363,40,1],[368,17,368,18,1],[368,19,368,40,1],[368,41,368,42,1],[369,17,369,18,1],[369,19,369,41,1],[369,42,369,43,1],[374,17,374,18,1],[374,19,374,38,1],[374,39,374,40,1],[375,17,375,18,1],[375,19,375,39,1],[375,40,375,41,1],[380,17,380,18,1],[380,19,380,42,1],[380,43,380,44,1],[381,17,381,18,1],[381,19,381,43,1],[381,44,381,45,1],[386,17,386,18,0],[386,19,386,46,0],[386,47,386,48,0],[387,17,387,18,1],[387,19,387,47,1],[387,48,387,49,1],[392,17,392,18,1],[392,19,392,46,1],[392,47,392,48,1],[393,17,393,18,1],[393,19,393,47,1],[393,48,393,49,1],[398,17,398,18,0],[398,19,398,41,0],[398,42,398,43,0],[399,17,399,18,1],[399,19,399,42,1],[399,43,399,44,1],[404,17,404,18,1],[404,19,404,46,1],[404,47,404,48,1],[409,17,409,18,1],[409,19,409,41,1],[409,42,409,43,1],[410,17,410,18,0],[410,19,410,42,0],[410,43,410,44,0],[415,17,415,18,1],[415,19,415,43,1],[415,44,415,45,1],[416,17,416,18,0],[416,19,416,44,0],[416,45,416,46,0],[421,17,421,18,1],[421,19,421,40,1],[421,41,421,42,1],[422,17,422,18,0],[422,19,422,41,0],[422,42,422,43,0],[427,17,427,18,1],[427,19,427,42,1],[427,43,427,44,1],[432,17,432,18,1],[432,19,432,39,1],[432,40,432,41,1],[437,17,437,18,0],[437,19,437,41,0],[437,42,437,43,0],[442,17,442,18,1],[442,19,442,47,1],[442,48,442,49,1],[447,17,447,18,1],[447,19,447,45,1],[447,46,447,47,1],[452,17,452,18,1],[452,19,452,49,1],[452,50,452,51,1],[457,17,457,18,0],[457,19,457,47,0],[457,48,457,49,0],[462,17,462,18,1],[462,19,462,45,1],[462,46,462,47,1],[467,17,467,18,1],[467,19,467,45,1],[467,46,467,47,1],[472,17,472,18,1],[472,19,472,42,1],[472,43,472,44,1],[477,17,477,18,0],[477,19,477,41,0],[477,42,477,43,0],[492,17,492,18,0],[492,19,492,44,0],[492,45,492,46,0],[497,17,497,18,0],[497,19,497,43,0],[497,44,497,45,0],[502,17,502,18,1],[502,19,502,44,1],[502,45,502,46,1],[503,17,503,18,0],[503,19,503,45,0],[503,46,503,47,0],[508,17,508,18,0],[508,19,508,47,0],[508,48,508,49,0],[509,17,509,18,0],[509,19,509,48,0],[509,49,509,50,0],[514,17,514,18,1],[514,19,514,40,1],[514,41,514,42,1],[515,17,515,18,1],[515,19,515,41,1],[515,42,515,43,1],[520,17,520,18,0],[520,19,520,40,0],[520,41,520,42,0],[521,17,521,18,1],[521,19,521,41,1],[521,42,521,43,1],[526,17,526,18,0],[526,19,526,48,0],[526,49,526,50,0],[527,17,527,18,1],[527,19,527,49,1],[527,50,527,51,1],[532,17,532,18,1],[532,19,532,45,1],[532,46,532,47,1],[533,17,533,18,1],[533,19,533,46,1],[533,47,533,48,1],[538,17,538,18,0],[538,19,538,42,0],[538,43,538,44,0],[543,17,543,18,1],[543,19,543,51,1],[543,52,543,53,1],[548,17,548,18,0],[548,19,548,37,0],[548,38,548,39,0],[553,17,553,18,1],[553,19,553,42,1],[553,43,553,44,1],[554,17,554,18,0],[554,19,554,43,0],[554,44,554,45,0],[559,17,559,18,0],[559,19,559,40,0],[559,41,559,42,0],[560,17,560,18,1],[560,19,560,41,1],[560,42,560,43,1],[565,17,565,18,1],[565,19,565,46,1],[565,47,565,48,1],[566,17,566,18,0],[566,19,566,47,0],[566,48,566,49,0],[582,17,582,18,0],[582,19,582,49,0],[582,50,582,51,0],[583,17,583,18,0],[583,19,583,50,0],[583,51,583,52,0],[588,17,588,18,1],[588,19,588,45,1],[588,46,588,47,1],[589,17,589,18,0],[589,19,589,46,0],[589,47,589,48,0],[594,17,594,18,0],[594,19,594,44,0],[594,45,594,46,0],[595,17,595,18,0],[595,19,595,45,0],[595,46,595,47,0],[600,17,600,18,1],[600,19,600,47,1],[600,48,600,49,1],[601,17,601,18,0],[601,19,601,48,0],[601,49,601,50,0],[606,17,606,18,0],[606,19,606,48,0],[606,49,606,50,0],[607,17,607,18,0],[607,19,607,49,0],[607,50,607,51,0],[612,17,612,18,1],[612,19,612,47,1],[612,48,612,49,1],[613,17,613,18,1],[613,19,613,48,1],[613,49,613,50,1],[618,17,618,18,0],[618,19,618,50,0],[618,51,618,52,0],[619,17,619,18,1],[619,19,619,51,1],[619,52,619,53,1],[624,17,624,18,1],[624,19,624,46,1],[624,47,624,48,1],[625,17,625,18,1],[625,19,625,47,1],[625,48,625,49,1],[630,17,630,18,1],[630,19,630,50,1],[630,51,630,52,1],[631,17,631,18,1],[631,19,631,51,1],[631,52,631,53,1],[636,17,636,18,1],[636,19,636,49,1],[636,50,636,51,1],[637,17,637,18,1],[637,19,637,50,1],[637,51,637,52,1],[640,45,640,49,1],[640,50,640,54,0],[641,44,641,48,1],[641,49,641,53,0],[642,43,642,47,1],[642,48,642,52,0],[645,42,645,46,1],[645,47,645,51,1],[651,17,651,18,1],[651,19,651,38,1],[651,39,651,40,1],[656,17,656,18,1],[656,19,656,38,1],[656,39,656,40,1],[673,17,673,18,1],[673,19,673,36,1],[673,37,673,38,1],[674,17,674,18,1],[674,19,674,37,1],[674,38,674,39,1],[679,17,679,18,1],[679,19,679,45,1],[679,46,679,47,1],[680,17,680,18,1],[680,19,680,46,1],[680,47,680,48,1],[683,43,683,47,1],[683,48,683,52,0],[685,45,685,49,1],[685,50,685,54,0],[687,53,687,57,1],[687,58,687,62,0],[689,53,689,57,0],[689,58,689,62,0],[691,47,691,51,0],[691,52,691,56,0],[695,17,695,18,0],[695,19,695,40,0],[695,41,695,42,0],[696,17,696,18,0],[696,19,696,41,0],[696,42,696,43,0],[699,37,699,41,0],[699,42,699,46,0],[701,44,701,48,0],[701,49,701,53,0],[705,17,705,18,1],[705,19,705,45,1],[705,46,705,47,1],[706,17,706,18,0],[706,19,706,46,0],[706,47,706,48,0],[711,17,711,18,1],[711,19,711,53,1],[711,54,711,55,1],[712,17,712,18,1],[712,19,712,54,1],[712,55,712,56,1],[717,17,717,18,1],[717,19,717,57,1],[717,58,717,59,1],[718,17,718,18,0],[718,19,718,58,0],[718,59,718,60,0],[723,17,723,18,1],[723,19,723,58,1],[723,59,723,60,1],[724,17,724,18,1],[724,19,724,59,1],[724,60,724,61,1],[729,17,729,18,1],[729,19,729,44,1],[729,45,729,46,1],[730,17,730,18,1],[730,19,730,45,1],[730,46,730,47,1],[735,17,735,18,1],[735,19,735,45,1],[735,46,735,47,1],[736,17,736,18,1],[736,19,736,46,1],[736,47,736,48,1],[741,17,741,18,0],[741,19,741,41,0],[741,42,741,43,0],[742,17,742,18,1],[742,19,742,42,1],[742,43,742,44,1],[747,17,747,18,1],[747,19,747,43,1],[747,44,747,45,1],[748,17,748,18,0],[748,19,748,44,0],[748,45,748,46,0],[754,13,754,14,1],[755,17,755,40,1],[756,17,756,52,1],[760,17,760,71,1],[762,17,762,37,1],[762,38,762,115,0],[763,17,763,32,1],[763,33,763,109,1],[764,17,764,33,1],[764,34,764,113,0],[765,17,765,33,1],[765,34,765,107,1],[766,17,766,35,1],[766,36,766,115,1],[767,17,767,38,1],[767,39,767,132,0],[769,17,769,50,1],[770,21,770,50,1],[776,17,776,73,1],[778,17,778,36,1],[779,21,779,110,0],[780,17,780,38,1],[781,21,781,118,0],[782,17,782,35,1],[783,21,783,107,0],[785,17,785,34,1],[785,35,785,110,0],[786,17,786,40,1],[787,21,787,111,0],[789,17,789,51,1],[790,17,790,18,0],[791,21,791,109,0],[792,21,792,116,0],[793,17,793,18,0],[795,17,795,44,1],[796,17,796,18,0],[797,21,797,112,0],[798,21,798,47,0],[799,25,799,111,0],[800,17,800,18,0],[802,17,802,48,1],[803,17,803,18,0],[804,21,804,119,0],[805,17,805,18,0],[807,17,807,42,1],[808,17,808,18,0],[809,21,810,51,0],[811,17,811,18,0],[813,17,813,43,1],[815,17,815,18,0],[816,21,817,55,0],[818,17,818,18,0],[820,17,820,53,1],[821,17,821,18,0],[822,21,822,114,0],[823,17,823,18,0],[824,17,824,51,1],[825,21,825,51,0],[831,17,831,68,1],[833,17,833,42,1],[834,17,834,18,0],[837,21,837,69,0],[838,21,838,39,0],[839,25,841,51,0],[842,21,842,39,0],[843,21,843,22,0],[844,25,844,114,0],[845,25,845,119,0],[846,21,846,22,0],[847,21,847,47,0],[848,21,848,22,0],[849,25,850,64,0],[851,25,852,64,0],[853,21,853,22,0],[855,21,855,72,0],[856,21,856,22,0],[857,25,858,56,0],[859,25,860,64,0],[861,21,861,22,0],[863,21,863,45,0],[864,21,864,22,0],[865,25,865,49,0],[866,25,866,26,0],[867,29,868,50,0],[869,29,869,71,0],[870,29,870,54,0],[870,54,870,55,0],[870,55,870,56,0],[870,56,870,83,0],[870,83,870,84,0],[870,84,870,85,0],[870,85,870,87,0],[870,29,870,87,0],[871,29,871,60,0],[872,25,872,26,0],[874,29,874,54,0],[874,54,874,55,0],[874,55,874,56,0],[874,56,874,80,0],[874,80,874,81,0],[874,81,874,82,0],[874,82,874,84,0],[874,29,874,84,0],[875,21,875,22,0],[879,21,879,49,0],[880,25,881,53,0],[882,21,882,41,0],[883,25,883,111,0],[885,21,885,44,0],[886,25,886,113,0],[887,17,887,18,0],[889,17,889,70,1],[890,21,890,107,0],[892,17,892,40,1],[893,17,893,18,1],[894,21,894,40,1],[895,21,895,22,1],[896,25,896,78,1],[897,21,897,22,1],[899,21,899,22,0],[900,25,900,109,0],[901,25,901,101,0],[902,25,902,120,0],[903,25,903,55,0],[904,21,904,22,0],[905,17,905,18,1],[907,17,907,38,1],[908,21,908,115,0],[909,17,909,37,1],[909,38,909,121,0],[911,17,911,44,1],[912,21,914,56,0],[916,17,916,39,1],[917,21,917,104,0],[918,17,918,39,1],[919,21,921,47,0],[922,17,922,40,1],[923,21,925,50,0],[926,17,926,33,1],[926,34,926,105,0],[927,17,927,38,1],[928,21,928,110,0],[929,17,929,43,1],[930,21,930,113,0],[932,17,932,37,1],[932,38,932,121,0],[934,17,934,111,1],[935,17,935,146,1],[936,17,936,18,1],[937,21,937,121,1],[938,17,938,18,1],[940,21,940,54,0],[942,17,942,36,1],[943,21,943,135,0],[947,17,947,103,1],[953,17,953,36,1],[953,37,953,121,0],[957,17,957,40,1],[958,17,958,18,0],[959,21,960,44,0],[961,17,961,18,0],[967,17,967,43,1],[968,21,969,44,0],[975,17,975,64,1],[976,17,976,18,0],[977,21,977,28,0],[977,30,977,50,0],[977,51,977,53,0],[977,54,977,68,0],[978,21,978,22,0],[979,25,979,116,0],[980,29,980,67,0],[981,21,981,22,0],[982,17,982,18,0],[983,22,983,103,1],[984,17,984,18,0],[985,21,985,28,0],[985,30,985,50,0],[985,51,985,53,0],[985,54,985,75,0],[986,21,986,22,0],[987,25,987,45,0],[988,29,988,67,0],[989,21,989,22,0],[990,17,990,18,0],[992,17,992,42,1],[993,17,993,18,0],[994,21,995,44,0],[996,21,997,44,0],[998,17,998,18,0],[1007,17,1007,55,1],[1008,21,1008,56,0],[1014,17,1014,70,1],[1015,17,1015,75,1],[1016,17,1016,18,0],[1017,21,1017,48,0],[1018,25,1018,112,0],[1019,21,1019,53,0],[1020,21,1020,22,0],[1021,25,1021,123,0],[1022,25,1022,116,0],[1023,21,1023,22,0],[1026,21,1026,51,0],[1027,25,1027,51,0],[1028,17,1028,18,0],[1032,17,1032,33,1],[1033,17,1033,18,0],[1034,21,1034,101,0],[1035,21,1035,99,0],[1036,17,1036,18,0],[1038,17,1038,48,1],[1039,21,1039,48,1],[1041,17,1041,85,1],[1043,17,1043,45,1],[1044,21,1044,53,1],[1046,17,1046,35,1],[1047,13,1047,14,1],[1051,9,1051,10,1],[1052,13,1052,36,1],[1053,13,1053,14,1],[1054,17,1054,36,1],[1055,17,1055,18,1],[1056,21,1056,74,1],[1057,17,1057,18,1],[1058,13,1058,14,1],[1059,9,1059,10,1],[1062,9,1062,10,0],[1063,13,1063,115,0],[1064,13,1064,50,0],[1065,13,1065,82,0],[1066,13,1066,14,0],[1067,17,1067,101,0],[1069,17,1069,53,0],[1071,17,1071,123,0],[1072,21,1072,108,0],[1073,22,1073,177,0],[1074,17,1074,18,0],[1075,21,1075,102,0],[1076,25,1076,52,0],[1077,26,1077,110,0],[1078,25,1078,55,0],[1079,17,1079,18,0],[1081,17,1081,55,0],[1082,21,1083,92,0],[1084,13,1084,14,0],[1085,9,1085,10,0],[1090,13,1090,14,0],[1091,17,1091,40,0],[1092,17,1092,45,0],[1097,17,1097,38,0],[1098,21,1098,106,0],[1099,17,1099,37,0],[1099,38,1099,105,0],[1103,17,1103,35,0],[1103,36,1103,104,0],[1104,17,1104,33,0],[1104,34,1104,96,0],[1108,17,1108,36,0],[1108,37,1108,109,0],[1109,17,1109,38,0],[1109,39,1109,121,0],[1110,17,1110,35,0],[1110,36,1110,105,0],[1111,17,1111,44,0],[1112,17,1112,18,0],[1113,21,1113,101,0],[1114,21,1114,47,0],[1115,25,1115,103,0],[1116,17,1116,18,0],[1117,17,1117,48,0],[1118,21,1118,111,0],[1119,17,1119,42,0],[1120,21,1120,123,0],[1122,17,1122,43,0],[1123,21,1123,118,0],[1125,17,1125,34,0],[1125,35,1125,103,0],[1126,17,1126,40,0],[1127,21,1127,105,0],[1128,17,1128,42,0],[1129,21,1129,113,0],[1130,17,1130,42,0],[1131,21,1132,96,0],[1133,17,1133,37,0],[1133,38,1133,114,0],[1135,17,1135,40,0],[1136,21,1136,106,0],[1137,17,1137,44,0],[1138,21,1140,58,0],[1157,17,1157,42,0],[1158,21,1158,108,0],[1159,17,1159,41,0],[1160,21,1160,105,0],[1162,17,1162,39,0],[1162,40,1162,115,0],[1163,17,1163,39,0],[1164,21,1166,49,0],[1167,17,1167,40,0],[1168,21,1169,45,0],[1170,17,1170,33,0],[1170,34,1170,97,0],[1171,17,1171,43,0],[1172,21,1172,100,0],[1173,17,1173,51,0],[1174,17,1174,18,0],[1175,21,1175,98,0],[1176,21,1176,105,0],[1177,17,1177,18,0],[1178,17,1178,120,0],[1183,17,1183,38,0],[1184,17,1184,18,0],[1185,21,1186,45,0],[1187,21,1188,45,0],[1189,21,1190,45,0],[1191,17,1191,18,0],[1192,17,1192,44,0],[1193,17,1193,18,0],[1194,21,1195,45,0],[1196,21,1197,45,0],[1198,21,1199,45,0],[1200,21,1201,45,0],[1202,21,1203,46,0],[1204,17,1204,18,0],[1205,17,1205,40,0],[1206,17,1206,18,0],[1207,21,1208,45,0],[1209,17,1209,18,0],[1210,17,1210,42,0],[1211,17,1211,18,0],[1212,21,1213,45,0],[1214,21,1215,45,0],[1216,17,1216,18,0],[1217,17,1217,42,0],[1218,17,1218,18,0],[1219,21,1220,45,0],[1221,21,1222,45,0],[1223,17,1223,18,0],[1224,17,1224,38,0],[1225,17,1225,18,0],[1226,21,1226,116,0],[1227,17,1227,18,0],[1231,17,1231,43,0],[1232,21,1233,45,0],[1240,17,1240,64,0],[1241,17,1241,18,0],[1242,21,1242,28,0],[1242,30,1242,50,0],[1242,51,1242,53,0],[1242,54,1242,68,0],[1243,21,1243,22,0],[1244,25,1244,116,0],[1245,29,1247,53,0],[1248,21,1248,22,0],[1249,17,1249,18,0],[1250,22,1250,103,0],[1251,17,1251,18,0],[1252,21,1252,28,0],[1252,30,1252,50,0],[1252,51,1252,53,0],[1252,54,1252,75,0],[1253,21,1253,22,0],[1254,25,1254,45,0],[1255,29,1257,53,0],[1258,21,1258,22,0],[1259,17,1259,18,0],[1264,17,1264,55,0],[1265,21,1265,47,0],[1267,21,1267,43,0],[1269,17,1269,96,0],[1271,17,1271,42,0],[1272,17,1272,18,0],[1273,21,1273,119,0],[1274,21,1275,66,0],[1276,25,1276,116,0],[1278,21,1278,45,0],[1279,25,1280,35,0],[1282,21,1282,39,0],[1283,25,1285,50,0],[1287,21,1287,39,0],[1288,21,1288,22,0],[1289,25,1289,123,0],[1290,25,1291,50,0],[1292,21,1292,22,0],[1294,21,1294,37,0],[1294,38,1294,110,0],[1296,21,1296,117,0],[1297,21,1297,93,0],[1298,25,1298,122,0],[1300,21,1300,44,0],[1301,25,1302,35,0],[1304,21,1304,47,0],[1305,21,1305,22,0],[1306,25,1307,51,0],[1308,25,1309,51,0],[1310,21,1310,22,0],[1312,21,1312,80,0],[1313,21,1313,22,0],[1314,25,1315,48,0],[1316,25,1317,51,0],[1318,21,1318,22,0],[1320,21,1320,41,0],[1321,25,1321,110,0],[1323,21,1323,42,0],[1324,25,1324,112,0],[1326,21,1326,40,0],[1327,25,1327,106,0],[1329,21,1329,46,0],[1330,25,1331,45,0],[1332,21,1333,66,0],[1334,25,1334,119,0],[1335,21,1335,49,0],[1336,25,1337,49,0],[1340,21,1340,41,0],[1341,25,1341,111,0],[1343,21,1343,44,0],[1344,25,1344,112,0],[1345,17,1345,18,0],[1347,17,1347,115,0],[1348,17,1348,57,0],[1349,21,1349,113,0],[1350,17,1350,129,0],[1351,17,1351,18,0],[1352,21,1352,123,0],[1353,17,1353,18,0],[1355,21,1355,54,0],[1357,17,1357,39,0],[1368,17,1368,37,0],[1368,38,1368,112,0],[1370,17,1370,40,0],[1371,17,1371,18,0],[1372,21,1372,40,0],[1373,21,1373,22,0],[1374,25,1374,78,0],[1375,21,1375,22,0],[1377,21,1377,22,0],[1378,25,1378,98,0],[1379,25,1379,106,0],[1380,21,1380,22,0],[1381,17,1381,18,0],[1382,17,1382,30,0],[1383,13,1383,14,0],[1388,17,1388,18,1],[1388,19,1388,42,1],[1388,43,1388,44,1],[1389,17,1389,18,0],[1389,19,1389,43,0],[1389,44,1389,45,0],[1393,9,1393,10,1],[1394,13,1394,50,1],[1395,13,1395,82,1],[1396,13,1396,14,1],[1397,17,1397,101,1],[1398,17,1398,69,1],[1398,70,1398,91,0],[1399,17,1399,67,1],[1399,68,1399,87,0],[1400,17,1400,66,1],[1400,67,1400,87,0],[1401,17,1401,69,1],[1401,70,1401,93,0],[1402,17,1402,66,1],[1402,67,1402,87,0],[1403,17,1403,68,1],[1403,69,1403,89,0],[1404,17,1404,70,1],[1404,71,1404,93,0],[1405,17,1405,78,1],[1405,79,1405,109,0],[1406,17,1406,70,1],[1406,71,1406,95,0],[1407,17,1407,74,1],[1407,75,1407,103,0],[1408,17,1408,76,1],[1408,77,1408,105,0],[1409,17,1409,92,1],[1409,93,1409,116,0],[1410,17,1412,64,1],[1413,21,1413,46,0],[1414,17,1416,61,1],[1417,21,1417,43,0],[1418,17,1418,71,1],[1418,72,1418,92,0],[1419,17,1419,73,1],[1419,74,1419,96,0],[1420,17,1420,74,1],[1420,75,1420,99,0],[1421,17,1421,68,1],[1421,69,1421,90,0],[1422,17,1422,77,1],[1422,78,1422,105,0],[1423,17,1423,81,1],[1423,82,1423,111,0],[1424,17,1424,81,1],[1424,82,1424,111,0],[1425,17,1425,70,1],[1425,71,1425,95,0],[1426,17,1426,69,1],[1426,70,1426,93,0],[1427,17,1427,80,1],[1427,81,1427,108,0],[1428,17,1428,87,1],[1428,88,1428,119,0],[1429,17,1429,42,1],[1430,17,1430,18,0],[1431,21,1431,115,0],[1432,25,1432,47,0],[1433,21,1433,79,0],[1433,80,1433,107,0],[1434,21,1434,76,0],[1434,77,1434,101,0],[1435,17,1435,18,0],[1440,17,1440,108,1],[1441,21,1441,47,0],[1442,17,1442,113,1],[1443,21,1443,48,0],[1446,17,1450,54,1],[1451,21,1451,50,0],[1453,17,1453,54,1],[1454,13,1454,14,1],[1456,13,1456,52,1],[1457,9,1457,10,1],[1460,9,1460,10,1],[1461,13,1461,127,1],[1462,17,1462,47,0],[1463,13,1463,135,1],[1464,17,1464,52,0],[1465,9,1465,10,1],[1468,9,1468,10,0],[1469,9,1469,10,0]]);
    </script>
  </body>
</html>