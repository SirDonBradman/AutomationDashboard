<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\XmlForm Framework\Renderers\RendererHTML._.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.ChartBuilder;
using Aurigo.Brix.Platform.BusinessLayer.CustomControls;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework.FormComponents;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework.XMLControls;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Aurigo.Workflow;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebDataInput;
using Infragistics.WebUI.WebSchedule;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.Common;
using System.Data.SqlTypes;
using System.Drawing;
using System.Globalization;
using System.Linq;
using System.Reflection;
using System.Runtime.Serialization;
using System.Text;
using System.Threading;
using System.Web;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Xml;
using Telerik.Web.UI;
using X = Aurigo.Brix.Platform.BusinessLayer.XMLForm;

namespace Aurigo.AMP3.Common
{
    public partial class HtmlRenderer : X.Renderer
    {
        private readonly Page page;
        public string currentStageRole = string.Empty;
        public string currentStageUser = string.Empty;
        private string currentStageVisibility = &quot;Edit&quot;;
        public string currentStatus = string.Empty;
        public int stageCompleted;

        /// &lt;summary&gt;
        /// ControlIdFormat = &quot;{Parent database container name}_{control name}_id&quot; 
        /// &lt;/summary&gt;
        private const string ControlIdFormat = &quot;{0}_{1}_Id&quot;;
        /// &lt;summary&gt;
        /// ActualControlIdFormat = &quot;{Parent database container name}_{control name}_ControlId&quot; 
        /// eg:- in DateTimeControl - ControlIdFormat is used by the panel &amp; ActualControlIdFormat is used by the XMLDateTimeControl
        /// &lt;/summary&gt;
        private const string ActualControlIdFormat = &quot;{0}_{1}_ControlId&quot;;
        /// &lt;summary&gt;
        ///  ControlIdFormat for EmbeddedForm &quot;{FormName}_{DbContainer}_{control name}_id&quot;
        /// &lt;/summary&gt;
        private const string ControlIdFormatEmbeddedForm = &quot;{0}_{1}_{2}_Id&quot;;

        public HtmlRenderer(BrixFormModel model)
            : base(model)
        {
            page = HttpContext.Current.CurrentHandler as Page;

            SetCellRenderers();
            SetCellGetServerValues();
            SetControlApplyChanges();
            SetContainerRenderers();
            //SetRowGetters();
            SetDBContainerCellGetters(); // To get a cell&#39;s value from a DB Container
            SetCellServerValue();
            SetContainerApplyChanges();
        }

        #region Cell Renderer Functions

        // third parameter passes the actual webcontrol where we cant pass it in second parameter, in such cases second param is a parent control.
        private WebControl PostProcessControl(X.xControl ctrl, WebControl wc, WebControl wcCtrl = null)
        {
            if (ctrl.DGridAttribute)
            {
                WebControl wcId = wcCtrl ?? wc;
                if (ctrl.Type == X.ControlType.Numeric || ctrl.Type == X.ControlType.TimeInput ||
                    ctrl.Type == X.ControlType.Date)
                    wcId.Attributes.Add(&quot;BGrid&quot;, &quot;1&quot;);
                wcId.Attributes.Add(&quot;BrixKN&quot;, ctrl.Name);

                if (ctrl.Type == X.ControlType.RadioButtonList)
                {
                    ListItemCollection listItems = (wcId as ListControl).Items;

                    foreach (ListItem li in listItems)
                    {
                        li.Attributes.Add(&quot;BrixKN&quot;, ctrl.Name);
                    }
                }
                //If a control has to be validated for uniqueness a new attribute is added &quot;BrixUnique&quot; to the control. - Client side validation
                if (ctrl.ValidationTypes.Contains(X.ValidationType.Unique))
                    wcId.Attributes.Add(&quot;BrixUnique&quot;, &quot;1&quot;);

                if (ctrl.PrimaryKey)
                    wcId.Attributes.Add(&quot;PrimaryKey&quot;, &quot;true&quot;);
            }

            X.Section sec = ctrl.section;
            WebControl webcontrolID = wcCtrl ?? wc;

            if ((ctrl.form.engine.IsViewMode || (sec != null &amp;&amp; sec.IsSectionDisabled) ||
                 currentStageVisibility == &quot;View&quot; || (ctrl.ReadOnly &amp;&amp; !ctrl.IsPickerControlAttached)) &amp;&amp; //bug fix: make all readonly ctrls RenderAsLabel = true except if it is a picker
                ctrl.Type != X.ControlType.Display || (ctrl.form.engine.IsEditMode &amp;&amp; ctrl.EditMode == X.EditMode.View))
            {
                if (ctrl.Type == X.ControlType.Link)
                    webcontrolID.Attributes.Add(&quot;Readonly&quot;, &quot;true&quot;);
                else if (webcontrolID is IControl)
                    (webcontrolID as IControl).RenderAsLabel = true;
                else if (webcontrolID is XMLPanel)
                {
                    XMLPanel panel = (webcontrolID as XMLPanel);
                    if (panel.ControlReference.Count &gt; 0)
                        (panel.ControlReference[0] as IControl).RenderAsLabel = true;
                }
                else
                    webcontrolID.Enabled = false;
            }

            if (ctrl.ReadOnly)
            {
                if (ctrl.Type == X.ControlType.Numeric &amp;&amp; wc is WebNumericEdit)
                    (wc as WebNumericEdit).ReadOnly = true;
                else if ((ctrl.Type == X.ControlType.DropDownList &amp;&amp; wc is DropDownList) ||
                         (ctrl.Type == X.ControlType.CheckBox &amp;&amp;
                          (wc is CheckBox || (wcCtrl != null &amp;&amp; wcCtrl is CheckBox))) ||
                          /*added Readonly condition for RadioButtonList*/
                          (ctrl.Type == X.ControlType.RadioButtonList &amp;&amp; wc is RadioButtonList))
                    (wc as WebControl).Enabled = false;
                else if (ctrl.Type == X.ControlType.Listbox &amp;&amp; wc is ListBox)
                    wc.Attributes.Add(&quot;disabled&quot;, &quot;true&quot;);
                else if (ctrl.Type == X.ControlType.TimeInput)
                    (wc as WebMaskEdit).ReadOnly = true;
                else
                    wc.Attributes.Add(&quot;Readonly&quot;, &quot;true&quot;);

                //if (webcontolID is IControl) //this causes problem hencing commenting it: bug 57831
                //    (webcontolID as IControl).RenderAsLabel = true;
            }

            if (ctrl.Hidden || (ctrl.form.engine.IsEditMode &amp;&amp; ctrl.EditMode == X.EditMode.Hidden))
                wc.Attributes.Add(&quot;display&quot;, &quot;none&quot;);

            // set the client ID so we can play with it later. amd alow make sure the
            // controls have a consistent ID specified.
            SetUniqueContainerName(ref ctrl); // give the control a name if it does not have one

            //Todo: find out from Kevin why we are adding _id in the end , I think it is not required and if we do so we need to remember this funda everywhere we use ID property.
            webcontrolID.ID = GetControlIdFormat(ctrl);
            webcontrolID.ClientIDMode = ClientIDMode.Static;

            if (!string.IsNullOrEmpty(ctrl.Value) &amp;&amp; ctrl.Value.ToLower2().Contains(&quot;{_picker&quot;))
            {
                string pickerColumn = ctrl.Value.Replace(&quot;{&quot;, &quot;&quot;).Replace(&quot;}&quot;, &quot;&quot;);
                string[] temp = pickerColumn.Split(&#39;.&#39;);
                if (temp.Length &gt; 1)
                {
                    pickerColumn = temp[1];
                    string pickerName = temp[0].Substring(temp[0].IndexOf(&quot;:&quot;) + 1);
                    // KK: Recoded because it was using case sensitive &quot;_Picker&quot;
                    webcontrolID.Attributes.Add(&quot;PickerColumn&quot;, pickerColumn);
                    webcontrolID.Attributes.Add(&quot;PickerName&quot;, pickerName);
                }
            }

            if (!string.IsNullOrEmpty(ctrl.PickerControl))
            {
                string[] vals = ctrl.PickerControl.Split(new char[] { &#39;:&#39; });
                webcontrolID.Attributes.Add(&quot;PickerColumn&quot;, vals[1]);
                webcontrolID.Attributes.Add(&quot;PickerName&quot;, vals[0]);
            }

            foreach (var t in ctrl.DicCustomAttributes)
            {
                webcontrolID.Attributes.Add(t.Key, t.Value);
            }

            webcontrolID.Attributes.Add(&quot;aria-label&quot;, ctrl.ParseDynamicString(ctrl.Caption));
            webcontrolID.Attributes.Add(&quot;ControlType&quot;, ctrl.Type.ToString());
            webcontrolID.Attributes.Add(&quot;ClntId&quot;, webcontrolID.ClientID);

            if (ctrl.ForeignKey || ctrl.FilterKey)
                webcontrolID.Attributes.Add(&quot;ForeignKey&quot;, &quot;true&quot;);

            return (wc);
        }

        private string GetControlIdFormat(X.xControl ctrl)
        {
            string retControlId = &quot;&quot;;
            if (ctrl.form.IsInsideEmbeddedForm)
                retControlId = ControlIdFormatEmbeddedForm.Format2(ctrl.form.Name, X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(ctrl).Name, ctrl.Name);
            else
                retControlId = ControlIdFormat.Format2(X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(ctrl).Name, ctrl.Name);
            return retControlId;
        }

        public object RenderHidden(X.xControl ctrl, object parent, object valueObj)
        {
            var hdnTB = new TextBox();
            if (!ctrl.form.DesignMode)
                hdnTB.Attributes.Add(&quot;display&quot;, &quot;none&quot;);

            if (valueObj != null)
            {
                if (ctrl.IsTimezoneApplicable)
                    hdnTB.Text = valueObj.ToString_MWCulture();
                else
                hdnTB.Text = valueObj.ToString();
            }
            //else
            //    hdnTB.Text = ctrl.EvaluateControlValue();

            return (PostProcessControl(ctrl, hdnTB));
        }

        public object RenderImage(X.xControl ctrl, object parent, object valueObj)
        {
            var img = new System.Web.UI.WebControls.Image();
            if (valueObj != null)
                img.ImageUrl = valueObj.ToString();

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                img.Attributes.Add(&quot;style&quot;, ctrl.Attributes);
            img.Width = ParseHTMLUnitValue(ctrl.Width);
            img.Height = ParseHTMLUnitValue(ctrl.Height);
            return (PostProcessControl(ctrl, img));
        }

        private object RenderInsertHide(X.xControl ctrl, object parent, object valueObj)
        {
            var txtInsertHide = new TextBox();
            txtInsertHide.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(ctrl.Width).ToString());
            txtInsertHide.Enabled = false;
            if (valueObj != null)
                txtInsertHide.Text = valueObj.ToString();

            return (PostProcessControl(ctrl, txtInsertHide));
        }

        private object RenderDisplay(X.xControl ctrl, object parent, object valueObj)
        {
            var lbl = new Label();
            lbl.Width = ParseHTMLUnitValue(ctrl.Width);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                lbl.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            string text = string.Empty;
            if (valueObj == null)
                text = ctrl.EvaluateControlValue();
            else
            {
                if (ctrl.IsTimezoneApplicable)
                {
                    string out_stringDate;
                    if (valueObj.TryParseObjectAsDateTimeStringNullable(out out_stringDate, DateFormatCulture.MWDateFormatCulture))
                        text = out_stringDate;
                }
                else
                {
                text = valueObj.ToString();
                }
            }

            //IF format is given for display control, then try to format the data
            if (!string.IsNullOrEmpty(ctrl.Format))
            {
                string format = ctrl.GetControlFormat();
                //If the text needs to formatted as date then we will convert to datetime
                if (ctrl.Format.IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;date&quot;, &quot;datetime&quot;, &quot;year&quot;))
                {
                    DateTime? outDateTime;
                    if (valueObj.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture) &amp;&amp; outDateTime.HasValue)
                        text = outDateTime.Value.ToString(format);
                }
                //If the text needs to formatted as numeric then we will convert to decimal
                else if (ctrl.Format.IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;unitprice&quot;, &quot;quantity&quot;, &quot;amount&quot;, &quot;percentage&quot;))
                {
                    Decimal number;
                    if (Decimal.TryParse(text, out number))
                        text = number.ToString(format);
                }
            }
            lbl.Text = text;
            return (PostProcessControl(ctrl, lbl));
        }

        private object RenderFormula(X.xControl ctrl, object parent, object valueObj)
        {
            var txt1 = new TextBox();
            txt1.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(ctrl.Width).ToString());
            string value = ctrl.EvaluateControlValue();

            // set the value object so it is available for all other calls            
            ctrl.valueObj = value;
            txt1.Enabled = false; // testing to see if the reson we dont get events fired is beause it is disabled

            txt1.Text = ctrl.valueObj == null ? string.Empty : ctrl.valueObj.ToString();

            // numerics are right justified.
            if (ctrl.DestinationType == &quot;Numeric&quot;)
                txt1.Style.Add(HtmlTextWriterStyle.TextAlign, &quot;right&quot;);

            return (PostProcessControl(ctrl, txt1));
        }

        private object RenderMultiPicker(X.xControl ctrl, object parent, object valueObj)
        {
            if (ctrl.form != null &amp;&amp; ctrl.form.DesignMode &amp;&amp; string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp;
                string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }

            var tbl = new HtmlTable();
            tbl.Attributes.Add(&quot;class&quot;, &quot;xmlFormInnerRowControlTable&quot;);
            tbl.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(ctrl.Width, 400).ToString());

            HtmlGenericControl div = CreateContainingDivControl(ctrl.Name, &quot;MultiPicker&quot;, &quot;100%&quot;, false);
            div.Controls.Add(tbl);

            // We need titles for controls that are contained inside of another control
            // so create a title row and add the title text.  This should be an option that can
            // be turned on/off from the XML file.  That still needs to be done.
            var row = new HtmlTableRow();
            tbl.Rows.Add(row);

            HtmlTableCell leftbox = new HtmlTableCell(),
                middlebox = new HtmlTableCell(),
                rightbox = new HtmlTableCell();
            leftbox.Width = &quot;42%&quot;;
            middlebox.Width = &quot;13%&quot;;
            rightbox.Width = &quot;42%&quot;;
            rightbox.Style.Add(&quot;padding-left&quot;, &quot;12px&quot;);

            row.Cells.Add(leftbox);
            row.Cells.Add(middlebox);
            row.Cells.Add(rightbox);

            ListBox lbleft = new ListBox(), lbright = new ListBox();
            lbleft.Width = new Unit(&quot;100%&quot;);
            lbleft.Height = new Unit(&quot;100%&quot;);
            lbright.Width = new Unit(&quot;100%&quot;);
            lbright.Height = new Unit(&quot;100%&quot;);

            lbleft.SelectionMode = ListSelectionMode.Multiple;
            lbright.SelectionMode = ListSelectionMode.Multiple;
            lbleft.ID = ctrl.Name + &quot;_lbleft&quot;;
            lbright.ID = ctrl.Name + &quot;_lbright&quot;;

            Button btnadd = new Button(), btndel = new Button();
            btnadd.Width = new Unit(&quot;98%&quot;);
            btndel.Width = new Unit(&quot;98%&quot;);

            btnadd.Text = &quot;Add&gt;&gt;&quot;;
            btndel.Text = &quot;&lt;&lt;Remove&quot;;

            var hdn = new HiddenField();
            hdn.ID = ctrl.Name + &quot;_hdnSelected&quot;;

            leftbox.Controls.Add(lbleft);
            rightbox.Controls.Add(lbright);
            middlebox.Controls.Add(btnadd);
            middlebox.Controls.Add(btndel);
            middlebox.Controls.Add(hdn);

            List&lt;X.FormListItem&gt; lbis = ctrl.GetFormList();
            var values = new string[0];
            if (valueObj != null)
            {
                values = valueObj.ToString().Split(&#39;,&#39;);
                hdn.Value = valueObj.ToString();
            }

            foreach (X.FormListItem fli in lbis)
            {
                int i;
                for (i = 0; i &lt; values.Length; i++)
                    if (fli.value == values[i])
                        break;
                if (i &lt; values.Length)
                    lbright.Items.Add(new ListItem(fli.display, fli.value));
                else
                    lbleft.Items.Add(new ListItem(fli.display, fli.value));
            }

            return (div);
        }

        private object RenderSet(X.xControl ctrl, object parent, object valueObj)
        {
            var innertbl = new HtmlTable();
            innertbl.Attributes.Add(&quot;class&quot;, &quot;xmlFormInnerRowControlTable&quot;);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                innertbl.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            // we need a div to surround the entire inner table so we can have
            // form editing work
            SetUniqueContainerName(ref ctrl);
            HtmlGenericControl div = new HtmlGenericControl(&quot;DIV&quot;);
            // KK: recoded CreateContainingDiv() caused two formdesignernames to be the Set 
            div.Controls.Add(innertbl);

            // if this set to true the captions go to left otherwise they go on top.
            HtmlTableRow titleRow = null;
            if (!ctrl.SetTitlesToLeft)
            {
                titleRow = new HtmlTableRow();
                // We need titles for controls that are contained inside of another control
                // so create a title row and add the title text.  This should be an option that can
                // be turned on/off from the XML file.  That still needs to be done.
                innertbl.Rows.Add(titleRow);
            }

            var innertr = new HtmlTableRow();
            innertbl.Rows.Add(innertr);

            foreach (X.xControl innerctrl in ctrl.Controls)
            {
                var innercell = new HtmlTableCell();
                var innertitlecell = new HtmlTableCell();

                // either add the caption to the left or to the title row depending on the
                // settting
                if (!ctrl.SetTitlesToLeft &amp;&amp; titleRow != null)
                    titleRow.Cells.Add(innertitlecell);
                else
                    innertr.Cells.Add(innertitlecell);

                innertr.Cells.Add(innercell);


                innercell.Attributes.Add(&quot;FormDesignerName&quot;, innerctrl.Name);
                // KK: moved form designer name to title to allow easier clicking in formdesigner

                //if (ctrl.SetTitlesToLeft)
                //    innertitlecell.Attributes.Add(&quot;FormDesignerName&quot;, innerctrl.Name);

                if (ctrl.engine.IsViewOrEditMode() &amp;&amp; !string.IsNullOrEmpty(innerctrl.DBType) &amp;&amp; ctrl.form.Table != null &amp;&amp;
                    ctrl.form.Table.Rows.Count &gt; 0)
                    valueObj = ctrl.form.Table.Rows[0].Field&lt;object&gt;(innerctrl.Name);
                else
                    valueObj = innerctrl.EvaluateControlValue();
                // KK intialize the value object from the value field if it is specified

                //add a title row to the innter controls
                // this should be optional and specified by the outer control but i dont want to do that now
                innertitlecell.InnerHtml = innerctrl.Caption == null
                    ? innerctrl.Name
                    : innerctrl.ParseDynamicString(innerctrl.Caption);

                object o = innerctrl.RenderSingleFormControl(valueObj, X.RenderFormat.RenderHtml);
                if (o != null)
                {
                    innercell.Controls.Add(o as Control);
                    innercell.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;middle&quot;); // KK: made sets middle align
                }

                if (innerctrl.ValidationTypes.Contains(X.ValidationType.Required))
                {
                    if (!string.IsNullOrEmpty(innertitlecell.InnerHtml))
                        innertitlecell.InnerHtml += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;
                    //else
                    //    innercell.InnerHtml += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                    var rfv = new RequiredFieldValidator();
                    // string[] tempArr = (ctrl.ControlReference[0] as WebControl).ClientID.Split(&quot;_&quot;.ToCharArray());
                    //(ctrl.ControlReference[0] as WebControl).ID = tempArr[tempArr.Length - 2];

                    if (innerctrl.Type == X.ControlType.DateTime)
                        rfv.ControlToValidate = ActualControlIdFormat.Format2(X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(innerctrl).Name, innerctrl.Name);
                    else
                        rfv.ControlToValidate = X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(innerctrl).Name + &quot;_&quot; +
                                            innerctrl.Name +
                                            &quot;_id&quot;; // this is the id of the control


                    rfv.ErrorMessage = (model.form.ShowValidationSummary
                        ? GenerateValidationMessage(innerctrl)
                        : &quot;Required!&quot;).Replace(&quot;:&quot;, &quot;&quot;);
                    rfv.CssClass = &quot;required&quot;;
                    if (model.form.ShowValidationSummary)
                        rfv.Display = ValidatorDisplay.None;
                    else
                        rfv.Display = ValidatorDisplay.Dynamic;
                    if (innerctrl.Type == X.ControlType.DropDownList)
                        (rfv as RequiredFieldValidator).InitialValue = &quot;_DBNULL_&quot;;
                    //Akila: Removed this br to align controls with validations inside a set neatly
                    //innercell.Controls.Add(new HtmlGenericControl(&quot;br&quot;));

                    string validationGroup = &quot;Master&quot;;
                    string _stage = string.Empty;
                    //bool hasRequiredValidation = false;
                    if (!string.IsNullOrEmpty(innerctrl.ValidateOnAction))
                    {
                        validationGroup = AssignValidationGroup(innerctrl.ValidateOnAction,
                            innerctrl.form.engine.currentState);
                        //Add RequiredFieldValidator if validateOnAction specifies currentstate
                        if (validationGroup != &quot;Master&quot;)
                        {
                            rfv.ValidationGroup = validationGroup;
                            innercell.Controls.Add(rfv);
                        }
                    }
                    else
                    {
                        rfv.ValidationGroup = validationGroup;
                        innercell.Controls.Add(rfv);
                    }
                }

                if (innerctrl.ValidationTypes.Contains(X.ValidationType.RegularExpression)
                    || innerctrl.ValidationTypes.Contains(X.ValidationType.Email)
                    || innerctrl.Type == X.ControlType.TimeInput
                    )
                {
                    var rev = new RegularExpressionValidator();
                    //string[] tempArr = (ctrl.ControlReference[0] as WebControl).ClientID.Split(&quot;_&quot;.ToCharArray());
                    //(ctrl.ControlReference[0] as WebControl).ID = tempArr[tempArr.Length - 2];

                    rev.ControlToValidate = X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(innerctrl).Name + &quot;_&quot; +
                                            innerctrl.Name +
                                            &quot;_id&quot;; // this is the id of the control
                    rev.ValidationGroup = &quot;Master&quot;;
                    if (innerctrl.ValidationTypes.Contains(X.ValidationType.Email))
                    {
                        rev.ErrorMessage = &quot;Invalid Email ID in &quot; +
                                           (string.IsNullOrEmpty(innerctrl.Caption)
                                               ? innerctrl.Name
                                               : model.form.ParseDynamicString(innerctrl.Caption)).Replace(&quot;:&quot;, &quot;&quot;);
                        rev.ValidationExpression = @&quot;^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$&quot;;
                    }
                    else if (innerctrl.Type == X.ControlType.TimeInput)
                    {
                        rev.ErrorMessage = &quot;Invalid time (hh:mm) in &quot; +
                                           (string.IsNullOrEmpty(innerctrl.Caption)
                                               ? &quot;Time field&quot;
                                               : model.form.ParseDynamicString(innerctrl.Caption)).Replace(&quot;:&quot;, &quot;&quot;);
                        rev.ValidationExpression = @&quot;([01]\d|2[0-3])[0-5]\d&quot;;
                    }
                    else
                    {
                        rev.Text = innerctrl.ErrorMessage;
                        rev.ValidationExpression = innerctrl.ValidationExpression;
                        rev.CssClass = &quot;required&quot;;
                    }
                    rev.Display = ValidatorDisplay.Dynamic;

                    //Akila: Removed this br to align controls with validations inside a set neatly
                    //innercell.Controls.Add(new HtmlGenericControl(&quot;br&quot;));
                    innercell.Controls.Add(rev);
                }
            }

            return (div);
        }

        private string AssignValidationGroup(string validateOnAction, IState currentWfState)
        {
            string validationGroup = &quot;Master&quot;;
            string _stage = string.Empty;
            if (!string.IsNullOrEmpty(validateOnAction))
            {
                if (validateOnAction.EndsWith(&quot;;&quot;)) validateOnAction = validateOnAction.TrimEnd(&#39;;&#39;);
                string[] stages = validateOnAction.Split(&#39;;&#39;);
                foreach (string stage in stages)
                {
                    if (stage.EndsWith(&quot;:&quot;)) _stage = stage.TrimEnd(&#39;:&#39;);
                    else _stage = stage;
                    string[] actionDetails = _stage.Split(&#39;:&#39;);
                    if (currentWfState != null)
                    {
                        if (actionDetails[0].Equals(currentWfState.DisplayName))
                        {
                            validationGroup = actionDetails[0] + &quot;_&quot; + actionDetails[1];
                            validationGroup = validationGroup.Replace(&#39; &#39;, &#39;_&#39;);
                            // hasRequiredValidation = true;
                            break;
                        }
                    }
                }
            }

            return validationGroup;
        }

        private object RenderPlaceHolder(X.xControl ctrl, object parent, object valueObj)
        {
            var pHodler = new Panel();
            pHodler.ID = ctrl.Name;

            return (PostProcessControl(ctrl, pHodler));
        }

        private object RenderPictureTaker(X.xControl ctrl, object parent, object valueobj)
        {
            HtmlGenericControl divControl = CreateContainingDivControl(ctrl.Name, &quot;&quot;, null, false);
            divControl.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(ctrl.Width, 200).ToString());
            divControl.Style.Add(HtmlTextWriterStyle.Height, ParseHTMLUnitValue(ctrl.Height, 300).ToString());
            Control pCtrl = page.LoadControl(&quot;~/Modules/UserControls/PictureTakerControl.ascx&quot;);
            divControl.Controls.Add(pCtrl);

            PictureTakerControl PictureTaker = pCtrl as PictureTakerControl;
            if (PictureTaker != null)
                PictureTaker.ImageValue = valueobj.ToString();

            return divControl;
        }

        private object RenderMap(X.xControl ctrl, object parent, object valueObj)
        {
            HtmlGenericControl divControl = CreateContainingDivControl(ctrl.Name, &quot;&quot;, null, false);

            divControl.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(ctrl.Width, 800).ToString());
            divControl.Style.Add(HtmlTextWriterStyle.Height, ParseHTMLUnitValue(ctrl.Height, 400).ToString());

            Control ctMap = page.LoadControl(&quot;~/Modules/UserControls/ESRIMapControl.ascx&quot;);

            ESRIMapControl esriMap = (ESRIMapControl)ctMap;
            esriMap.MapAutoSave = true;
            if (valueObj != null || (valueObj != null &amp;&amp; !string.IsNullOrEmpty(valueObj.ToString())))
            {
                string[] vals = valueObj.ToString().Split(new string[] { &quot;~~&quot; }, StringSplitOptions.RemoveEmptyEntries);
                if (vals.Length &gt; 1)
                {
                    esriMap.MapGraphics = vals[0];
                    esriMap.MapOptions = vals[1];
                }
            }

            esriMap.KMZURL = ConfigurationManager.AppSettings[&quot;SiteRoot&quot;] + &quot;/esri/&quot; + &quot;PROJECT_&quot; +
                             ctrl.form.FromRequest(&quot;PID&quot;) + &quot;.kmz&quot;;

            divControl.Controls.Add(esriMap);
            return divControl;
        }

        private object RenderTextBoxWithMode(X.xControl ctrl, object parent, object valueObj, TextBoxMode mode)
        {
            var txt = new XMLTextBox();

            SetTextBoxProperties(ctrl, mode, txt);
            string text = (valueObj == null) ? string.Empty : valueObj.ToString();//DateToStringMustCheck

            if (ctrl.IsTimezoneApplicable)
            {
                DateTime? outDateTime;
                if (valueObj.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture) &amp;&amp; outDateTime.HasValue)
                {
                    if (ctrl.Format.IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;date&quot;, &quot;datetime&quot;, &quot;year&quot;))
                    {
                        string format = ctrl.GetControlFormat();
                        text = outDateTime.Value.ToString(format);
                    }
                    else
                    {
                        //TODO: Must verify tester&#39;s statement : As per the tester when no format is defined then we must consider the format based on the Type of the control
                        if (ctrl.Type == X.ControlType.Date)
                            text = outDateTime.Value.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE);
                        else if (ctrl.Type == X.ControlType.DateTime)
                            text = outDateTime.Value.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATETIME);
                        else
                            text = outDateTime.Value.ToString_MWCulture();//DateToStringMustCheck//Default value incase no format found
                    }
                }
            }
            else
            {
                if (!string.IsNullOrEmpty(ctrl.Format) &amp;&amp; ctrl.Format.IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;date&quot;, &quot;datetime&quot;, &quot;year&quot;))
                {
                    DateTime? outDateTime;
                    if (valueObj.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.GetDateFormatCulture()) &amp;&amp; outDateTime.HasValue)
                    {
                        string format = ctrl.GetControlFormat();
                        text = outDateTime.Value.ToString(format);
                    }
                    else
                    {
                        //TODO: Must verify tester&#39;s statement : As per the tester when no format is defined then we must consider the format based on the Type of the control
                        if (ctrl.Type == X.ControlType.Date)
                            text = outDateTime.Value.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                        else if (ctrl.Type == X.ControlType.DateTime)
                            text = outDateTime.Value.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATETIME, CultureInfo.CurrentCulture);
                        else
                            text = outDateTime.Value.ToString_MWCulture();//DateToStringMustCheck//Default value incase no format found
                    }
                }
            }
            txt.Text = text;

            return (PostProcessControl(ctrl, txt));
        }

        // ParseHTMLUnitValue: this routine will take a HTML unit speicifcation (px, %) and convert it into a Unit
        // this will replace all of the crazy width and height parsing with something that cant crash.  Current methods
        // crash with malformed strings.
        private static Unit ParseHTMLUnitValue(string htmlUnit, int defValue = 200)
        {
            if (!string.IsNullOrWhiteSpace(htmlUnit))
            {
                var width = htmlUnit.ToCharArray();
                int nIndex;
                for (nIndex = 0; nIndex &lt; width.Length; nIndex++)
                {
                    if (!char.IsNumber(width[nIndex]))
                        break;
                }

                var format = htmlUnit.Substring(nIndex);
                var sNumber = htmlUnit.Substring(0, nIndex);
                int number;

                if (int.TryParse(sNumber, out number))
                {
                    // KK: range validate the number of pixels.  Numbers over 32K or under -32K crash
                    number = number &gt; 10000 ? 10000 : number;
                    number = number &lt; 5 ? 5 : number;

                    switch (format)
                    {
                        case &quot;px&quot;:
                        default:
                            return Unit.Pixel(number);
                        case &quot;%&quot;:
                            return Unit.Percentage(number);
                    }
                }
            }

            // the default is 200 pixels
            return Unit.Pixel(defValue);
        }

        private static void SetTextBoxProperties(X.xControl ctrl, TextBoxMode mode, TextBox txt)
        {
            txt.Width = ParseHTMLUnitValue(ctrl.Width);

            if (ctrl.MaxLength &gt; 0)
            {
                txt.MaxLength = ctrl.MaxLength;
            }
            else if (!string.IsNullOrEmpty(ctrl.DBType) &amp;&amp; ctrl.DBType.Contains(&quot;(&quot;))
            {
                int maxlength;
                string tempType = ctrl.DBType;
                string expLength = ctrl.DBType.Substring(tempType.IndexOf(&#39;(&#39;) + 1,
                    tempType.IndexOf(&#39;)&#39;) - tempType.IndexOf(&#39;(&#39;) - 1);

                if (Int32.TryParse(expLength, out maxlength))
                    txt.MaxLength = maxlength;
            }
            if (!string.IsNullOrEmpty(ctrl.Enabled) &amp;&amp; ctrl.Enabled == &quot;false&quot;)
            {
                txt.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
            }
            txt.TextMode = mode;

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                txt.Attributes.Add(&quot;style&quot;, ctrl.Attributes);
        }

        private object RenderPassword(X.xControl ctrl, object parent, object valueObj)
        {
            TextBox pwd = RenderTextBoxWithMode(ctrl, parent, valueObj, TextBoxMode.Password) as TextBox;
            string value = &quot;&quot;;
            if (valueObj != null) value = new string(&#39;*&#39;, valueObj.ToString().Length);
            pwd.Attributes.Add(&quot;value&quot;, value);
            return pwd;
        }

        private object RenderTextBox(X.xControl ctrl, object parent, object valueObj)
        {
            return RenderTextBoxWithMode(ctrl, parent, valueObj, TextBoxMode.SingleLine);
        }

        private object RenderTextArea(X.xControl ctrl, object parent, object valueObj)
        {
            var txtArea = new XMLTextBox();

            txtArea.Width = ParseHTMLUnitValue(ctrl.Width);
            txtArea.Height = ParseHTMLUnitValue(ctrl.Height, 50);

            txtArea.TextMode = TextBoxMode.MultiLine;
            txtArea.Rows = 3;
            txtArea.Columns = 35;
            if (valueObj != null)
                txtArea.Text = valueObj.ToString().Replace(&quot;\n&quot;, &quot;\r\n&quot;);

            if (!string.IsNullOrEmpty(ctrl.DBType))
            {
                int maxlengthTA;
                string tempTypeTA = ctrl.DBType;

                // if DBType is malformed then this code can crash badly.  I make sure we dont crash
                try
                {
                    string expLengthTA = ctrl.DBType.Substring(tempTypeTA.IndexOf(&#39;(&#39;) + 1,
                        tempTypeTA.IndexOf(&#39;)&#39;) - tempTypeTA.IndexOf(&#39;(&#39;) - 1);

                    if (Int32.TryParse(expLengthTA, out maxlengthTA))
                    {
                        txtArea.Attributes.Add(&quot;maxLength&quot;, maxlengthTA.ToString());
                        txtArea.Style.Add(&quot;BEHAVIOR&quot;, &quot;url(&#39;&quot; + ctrl.page.ResolveClientUrl(&quot;~/maxlength.htc&quot;) + &quot;&#39;)&quot;);
                    }
                }
                catch
                {
                }
            }
            return (PostProcessControl(ctrl, txtArea));
        }

        public static DataTable GetDataTableWithStringDate(DataTable dt)
        {
            DataTable newDt = dt.Clone();

            foreach (DataColumn c in newDt.Columns)
            {
                if (c.DataType == typeof(DateTime))
                    c.DataType = typeof(String);
            }


            foreach (DataRow r in dt.Rows)
            {
                DataRow newRow = newDt.NewRow();
                foreach (DataColumn c in dt.Columns)
                {
                    if (c.DataType == typeof(DateTime))
                        newRow[c.ColumnName] = r[c.ColumnName].ToString_MWCulture();// .ToMWDateTimeString_FormatDateTime();
                    else
                        newRow[c.ColumnName] = r[c.ColumnName];
                }
                newDt.Rows.Add(newRow);
            }

            return newDt;
        }

        public static void BindDynamicGrid(X.DynamicGrid grid, DataTable dt, bool convertDatetimeColumnsToString = false)
        {
            RadGrid radGrid = (grid.ControlReference[0] as RadGrid);

            IEnumerable&lt;X.xControl&gt; xControlList = grid.Controls.Where(xc =&gt; xc.Type == X.ControlType.AttachmentControl);
            bool isExistsAttachmentControl = xControlList.Count() &gt; 0;

            if (isExistsAttachmentControl &amp;&amp; !dt.Columns.Contains($&quot;{grid.Name}RowGuid&quot;))
            {
                var guidColumn = new DataColumn($&quot;{grid.Name}RowGuid&quot;);
                guidColumn.DefaultValue = Guid.NewGuid();
                dt.Columns.Add(guidColumn);
            }
            radGrid.DataSource = dt;
            radGrid.DataBind();
            DataTable dtDateTimeAsString = null;
            if (convertDatetimeColumnsToString)
                dtDateTimeAsString = GetDataTableWithStringDate(dt);
            string json = convertDatetimeColumnsToString == false ? dt.DataTableToJSON() : dtDateTimeAsString.DataTableToJSON();
            (grid.ControlReference[1] as HiddenField).Value = json;
        }

        public static void SetDynamicGridColumnsEditable(X.DynamicGrid grid, List&lt;string&gt; columnNames)
        {
            RadGrid radGrid = (grid.ControlReference[0] as RadGrid);
            foreach (string col in columnNames)
            {
                GridColumn column = radGrid.MasterTableView.GetColumnSafe(col);
                if (column != null)
                {
                    column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                }
                radGrid.MasterTableView.EditMode = GridEditMode.Batch;
                radGrid.MasterTableView.BatchEditingSettings.EditType = GridBatchEditingType.Cell;
                radGrid.ClientSettings.ClientEvents.OnKeyPress = &quot;GridInlineEditorKeyPress&quot;;
            }
        }

        public static DataTable GetDynamicGridDataSource(X.DynamicGrid grid)
        {
            RadGrid radGrid = (grid.ControlReference[0] as RadGrid);
            return radGrid.DataSource as DataTable;
        }

        public static void BindDropDown(X.xControl ctrl, WebControl wc)
        {
            if (ctrl.form != null &amp;&amp; ctrl.engine != null &amp;&amp; ctrl.form.DesignMode &amp;&amp;
                string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp; string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }

            var ddl = wc as DropDownList;
            if (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
            {
                try
                {
                    List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                    foreach (X.FormListItem fli in lbis)
                    {
                        ListItem li = new ListItem(fli.display, fli.value);
                        if (!string.IsNullOrEmpty(ctrl.GroupBy))
                        {
                            li.Attributes.Add(&quot;DataGroupField&quot;, fli.groupBy);
                        }
                        ddl.Items.Add(li);
                    }
                }
                catch
                {
                    // this is chained dropdown - datasource depends on other controls value.
                    //added additional checks for cdc audit. Engine in null in that case
                    if (ctrl != null &amp;&amp; ctrl.form != null &amp;&amp; ctrl.form.engine != null &amp;&amp; ctrl.form.engine.IsNewMode)
                        wc.Enabled = false;
                }
            }
            else if (ctrl.DataSource != null &amp;&amp; ctrl.DataSource.StartsWith(&quot;{&quot;))
            {
                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);
                foreach (X.FormListItem fli in lbis)
                {
                    ListItem li = new ListItem(fli.display, fli.value);
                    ddl.Items.Add(li);
                }
            }
            else
            {
                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                foreach (X.FormListItem fli in lbis)
                {
                    ListItem li = new ListItem(fli.display, fli.value);
                    //In order to have a grouped drop down list, the custom sontrol requires DataGroupField attribute hence assigning that here
                    if (!string.IsNullOrEmpty(ctrl.GroupBy))
                    {
                        li.Attributes.Add(&quot;DataGroupField&quot;, fli.groupBy);
                    }
                    ddl.Items.Add(li);
                }
            }
            if (!string.IsNullOrEmpty(ctrl.Value) &amp;&amp;
                (ctrl != null &amp;&amp; ctrl.form != null &amp;&amp; ctrl.form.engine != null &amp;&amp; ctrl.form.engine.IsNewMode))
            {
                ListItem li = ddl.Items.FindByValue(ctrl.ParseDynamicString(ctrl.Value));
                if (li != null)
                {
                    li.Selected = true;
                }
            }
        }

        public static void BindDropDown(X.xControl ctrl, WebControl wc, DataRow dr)
        {
            if (ctrl.form != null &amp;&amp; ctrl.engine != null &amp;&amp; ctrl.form.DesignMode &amp;&amp; string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp; string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }

            var ddl = wc as DropDownList;
            if (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
            {
                try
                {
                    List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl, dr);

                    foreach (X.FormListItem fli in lbis)
                    {
                        ListItem li = new ListItem(fli.display, fli.value);
                        if (!string.IsNullOrEmpty(ctrl.GroupBy))
                        {
                            li.Attributes.Add(&quot;DataGroupField&quot;, fli.groupBy);
                        }
                        ddl.Items.Add(li);
                    }

                }
                catch
                {
                    // this is chained dropdown - datasource depends on other controls value.
                    //added additional checks for cdc audit. Engine in null in that case
                    if (ctrl != null &amp;&amp; ctrl.form != null &amp;&amp; ctrl.form.engine != null &amp;&amp; ctrl.form.engine.IsNewMode) wc.Enabled = false;
                }
            }
            else if (ctrl.DataSource != null &amp;&amp; ctrl.DataSource.StartsWith(&quot;{&quot;))
            {

                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);
                foreach (X.FormListItem fli in lbis)
                {
                    ListItem li = new ListItem(fli.display, fli.value);
                    ddl.Items.Add(li);
                }
            }
            else
            {
                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                foreach (X.FormListItem fli in lbis)
                {
                    ListItem li = new ListItem(fli.display, fli.value);
                    //In order to have a grouped drop down list, the custom sontrol requires DataGroupField attribute hence assigning that here
                    if (!string.IsNullOrEmpty(ctrl.GroupBy))
                    {
                        li.Attributes.Add(&quot;DataGroupField&quot;, fli.groupBy);
                    }
                    ddl.Items.Add(li);
                }
            }
            if (!string.IsNullOrEmpty(ctrl.Value) &amp;&amp; (ctrl != null &amp;&amp; ctrl.form != null &amp;&amp; ctrl.form.engine != null &amp;&amp; ctrl.form.engine.IsNewMode))
            {
                ListItem li = ddl.Items.FindByValue(ctrl.ParseDynamicString(ctrl.Value));
                if (li != null)
                {
                    li.Selected = true;
                }
            }
        }

        public static void BindGridDropDown(X.xControl ctrl, RadComboBox wc)
        {
            if (ctrl.form != null &amp;&amp; ctrl.engine != null &amp;&amp; ctrl.form.DesignMode &amp;&amp;
                string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp; string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }

            var ddl = wc as RadComboBox;

            if (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
            {
                try
                {
                    List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                    foreach (X.FormListItem fli in lbis)
                    {
                        RadComboBoxItem li = new RadComboBoxItem(fli.display, fli.value);
                        ddl.Items.Add(li);
                    }
                }
                catch
                {
                    // this is chained dropdown - datasource depends on other controls value.
                    //added additional checks for cdc audit. Engine in null in that case
                    if (ctrl != null &amp;&amp; ctrl.form != null &amp;&amp; ctrl.form.engine != null &amp;&amp; ctrl.form.engine.IsNewMode)
                        wc.Enabled = false;
                }
            }
            else if (ctrl.DataSource != null &amp;&amp; ctrl.DataSource.StartsWith(&quot;{&quot;))
            {
                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                foreach (X.FormListItem fli in lbis)
                {
                    RadComboBoxItem li = new RadComboBoxItem(fli.display, fli.value);
                    ddl.Items.Add(li);
                }
            }
            else
            {
                List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(ctrl);

                foreach (X.FormListItem fli in lbis)
                {
                    RadComboBoxItem li = new RadComboBoxItem(fli.display, fli.value);
                    if (!string.IsNullOrEmpty(ctrl.GroupBy))
                    {
                        li.Attributes.Add(&quot;DataGroupField&quot;, fli.groupBy);
                    }
                    ddl.Items.Add(li);
                }
            }

            ddl.CssClass = &quot;ddlControls&quot;;
        }

        public static List&lt;X.FormListItem&gt; GetDropDownListValues(X.xControl ctrl)
        {
            if (ctrl.form != null &amp;&amp; ctrl.engine != null &amp;&amp; ctrl.form.DesignMode &amp;&amp;
                string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp; string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }


            if (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
            {
                // get the variable&#39;s value replaced in the datasource value (Edit or view mode)
                string bindProperties = X.xControl.ReplaceVariablesWithValues(ref ctrl.DataSource, null, ctrl.form,
                    null, null);
                var xc = new X.xControl
                {
                    Name = ctrl.Name,
                    DataSource = bindProperties,
                    ListItems = ctrl.ListItems,
                    //TODO:We need to check the channing in the existing forms and this change should not break the existing funtionality or validation for any specific form
                    ParentObject = ctrl.ParentObject,
                    Type = ctrl.Type
                };

                List&lt;X.FormListItem&gt; lbis = xc.GetFormList();
                return lbis;
            }
            else
            {
                List&lt;X.FormListItem&gt; lbis = ctrl.GetFormList();
                return lbis;
            }
        }

        public static List&lt;X.FormListItem&gt; GetDropDownListValues(X.xControl ctrl, DataRow dr)
        {
            if (ctrl.form != null &amp;&amp; ctrl.engine != null &amp;&amp; ctrl.form.DesignMode &amp;&amp; string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp; string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }


            if (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
            {

                // get the variable&#39;s value replaced in the datasource value (Edit or view mode)
                string bindProperties = X.xControl.ReplaceVariablesWithValues(ref ctrl.DataSource, null, ctrl.form, dr, null);
                var xc = new X.xControl
                {
                    Name = ctrl.Name,
                    DataSource = bindProperties,
                    ListItems = ctrl.ListItems,//TODO:We need to check the channing in the existing forms and this change should not break the existing funtionality or validation for any specific form
                    ParentObject = ctrl.ParentObject,
                    Type = ctrl.Type
                };

                List&lt;X.FormListItem&gt; lbis = xc.GetFormList();
                return lbis;

            }
            else
            {
                List&lt;X.FormListItem&gt; lbis = ctrl.GetFormList();
                return lbis;
            }

        }

        public static void BindRadioButtonList(X.xControl ctrl, WebControl wc)
        {
            var rbl = wc as ListControl;
            rbl.Attributes.Add(&quot;role&quot;, &quot;radiogroup&quot;);
            List&lt;X.FormListItem&gt; lbis = ctrl.GetFormList();

            foreach (X.FormListItem fli in lbis)
                rbl.Items.Add(new ListItem(fli.display, fli.value));
        }

        private object RenderCheckBox(X.xControl ctrl, object parent, object valueObj)
        {
            Panel div = new Panel();

            var cb = new XMLCheckBox();
            div.Controls.Add(cb);
            cb.Text = ctrl.Value;
            cb.Checked = ctrl.IsSelected;

            // KK: This should be compatible with what we are doing now.  If width is set then it modifies the 
            // width of containing div.  It never modifies width of control itself for checkboxes 
            var localWidth = ParseHTMLUnitValue(ctrl.Width);
            div.Style.Add(&quot;width&quot;, localWidth.ToString());

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                div.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            if (valueObj != null &amp;&amp; !string.IsNullOrWhiteSpace(valueObj.ToString()))
            {
                // ensure we dont crash if the valueObj is not valid
                try
                {
                    cb.Checked = Convert.ToBoolean(valueObj);
                }
                catch
                {
                }
            }

            // passing actual web control in last parameter
            return (PostProcessControl(ctrl, div, cb));
        }

        private object RenderRadioButtonList(X.xControl ctrl, object parent, object valueObj)
        {
            ListControl rbl;
            if (ctrl.Type == X.ControlType.RadioButtonList)
            {
                //if (ctrl.form.engine.IsViewMode)
                //    rbl = new XMLRadioButtonList();
                //else
                //{
                rbl = new XMLRadioButtonList();
                (rbl as XMLRadioButtonList).RepeatDirection = ctrl.RepeatDirection;
                if (ctrl.RepeatColumns &gt; 0)
                    (rbl as XMLRadioButtonList).RepeatColumns = ctrl.RepeatColumns;

                //}
            }
            else
            {
                //if (ctrl.form.engine.IsViewMode)
                //    rbl = new XMLCheckBoxList();
                //else
                //{
                rbl = new XMLCheckBoxList();
                (rbl as XMLCheckBoxList).RepeatDirection = ctrl.RepeatDirection;
                (rbl as XMLCheckBoxList).RepeatLayout = ctrl.RepeatLayout;
                if (ctrl.RepeatColumns &gt; 0)
                    (rbl as XMLCheckBoxList).RepeatColumns = ctrl.RepeatColumns;
                //}
            }


            BindRadioButtonList(ctrl, rbl);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                rbl.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            rbl.Width = ParseHTMLUnitValue(ctrl.Width);

            if (valueObj != null &amp;&amp; !string.IsNullOrEmpty(valueObj.ToString()))
            {
                if (rbl is XMLRadioButtonList)
                {
                    ListItem selectedItem = rbl.Items.FindByValue(valueObj.ToString());
                    if (selectedItem == null &amp;&amp; ctrl.DBType.ToLower() == &quot;bit&quot;) //&amp;&amp; !ctrl.AllowNull)
                        selectedItem = rbl.Items.FindByValue(valueObj.ToString() == &quot;True&quot; ? &quot;1&quot; : &quot;0&quot;);
                    if (selectedItem != null)
                        selectedItem.Selected = true;
                }
                else
                {
                    valueObj.ToString().Split(&#39;,&#39;).ForEach(val =&gt;
                    {
                        ListItem selectedItem = rbl.Items.FindByValue(val);
                        if (selectedItem == null &amp;&amp; ctrl.DBType.ToLower() == &quot;bit&quot;)
                            selectedItem = rbl.Items.FindByValue(val == &quot;True&quot; ? &quot;1&quot; : &quot;0&quot;);
                        if (selectedItem != null)
                            selectedItem.Selected = true;
                    });
                }
            }
            else if (ctrl.Type == X.ControlType.RadioButtonList)
            {
                if (!ctrl.AllowNull)
                    rbl.SelectedIndex = 0;
            }
            if (ctrl.CausesPostback)
                rbl.AutoPostBack = true;


            return (PostProcessControl(ctrl, rbl));
        }

        private object RenderInteger(X.xControl ctrl, object parent, object valueObj)
        {
            var txt = new XMLIntegerBox();

            txt.Width = ParseHTMLUnitValue(ctrl.Width);

            if (!string.IsNullOrEmpty(ctrl.MinValue))
            {
                try
                {
                    txt.MinValue = Int32.Parse(ctrl.MinValue);
                }
                catch (Exception)
                {
                } // suppress the error if not valid value
            }

            if (!string.IsNullOrEmpty(ctrl.MaxValue))
            {
                try
                {
                    txt.MaxValue = Int32.Parse(ctrl.MaxValue);
                }
                catch (Exception)
                {
                } // suppress the error if not valid value
            }

            //Integer box will take 10 digits by default. 

            if (ctrl.MaxLength &gt; 0)
                txt.MaxLength = ctrl.MaxLength;
            else
                txt.MaxLength = 10;

            if (valueObj != null)
                txt.Text = valueObj.ToString();

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                txt.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            return (PostProcessControl(ctrl, txt));
        }

        private object RenderNumeric(X.xControl ctrl, object parent, object valueObj)
        {
            var wne = new XMLNumericControl();
            //if (ctrl.form.engine.IsViewMode)
            //    wne = new XMLNumericControl();
            wne.Nullable = ctrl.AllowNull;

            //Numeric Controls should take negative values in XML form
            //TODO: See if it creates any problem - Akila
            //wne.MinValue = 0;
            if (!string.IsNullOrEmpty(ctrl.MinValue))
                try
                {
                    wne.MinValue = double.Parse(ctrl.MinValue);
                }
                catch (Exception)
                {
                } // suppress the error if not valid value
            if (!string.IsNullOrEmpty(ctrl.MaxValue))
                try
                {
                    wne.MaxValue = double.Parse(ctrl.MaxValue);
                }
                catch (Exception)
                {
                } // suppress the error if not valid value
            wne.CssClass = &quot;tbC&quot;;
            wne.Enabled = true;
            wne.ReadOnly = false;
            wne.Width = ParseHTMLUnitValue(ctrl.Width);

            MinDecimalPlaces mdp = ctrl.Type == X.ControlType.Integer ? MinDecimalPlaces.None : MinDecimalPlaces.Two;

            if (!string.IsNullOrEmpty(ctrl.MinDecimalPlaces))
            {
                Enum.TryParse(ctrl.MinDecimalPlaces, out mdp);
            }
            wne.MinDecimalPlaces = mdp;
            wne.Culture = Thread.CurrentThread.CurrentCulture;

            if (!string.IsNullOrEmpty(ctrl.MaxDecimalPlaces))
            {
                int maxDecPlaces = 0;
                if (int.TryParse(ctrl.MaxDecimalPlaces, out maxDecPlaces))
                {
                    NumberFormatInfo nfi = new NumberFormatInfo();
                    nfi = (NumberFormatInfo)wne.NumberFormat.Clone();
                    nfi.NumberDecimalDigits = maxDecPlaces;
                    wne.NumberFormat = nfi;
                }
            }
            if (ctrl.Type == X.ControlType.Integer)
            {
                wne.DataMode = NumericDataMode.Int;
            }

            if (!string.IsNullOrEmpty(ctrl.Format))
            {
                string format;
                if (!String.IsNullOrEmpty(format = ctrl.Format))
                {
                    format = ctrl.GetControlFormat();
                }
                ApplyFormattoWne(wne, format);
            }


            if (!ctrl.AllowNull)
                wne.NullText = (0.00).ToString();
            else
                wne.NullText = &quot;&quot;;

            //var info = new NumberFormatInfo();
            //info.CurrencySymbol = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
            ////info.NumberGroupSizes = new int[] { 3, 2, 2 };
            //wne.NumberFormat = info;

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                wne.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            if (valueObj != null)
                wne.Value = valueObj.ToString();
            else
                wne.Value = ctrl.AllowNull ? null : &quot;0.00&quot;;

            ctrl.valueObj = wne.Value;

            return (PostProcessControl(ctrl, wne));
        }

        private void ApplyFormattoWne(WebNumericEdit wne, String format)
        {
            int DecimalLength = format.Length -
                                (format.LastIndexOf(&#39;.&#39;) == -1 ? format.Length - 1 : format.LastIndexOf(&#39;.&#39;)) - 1;

            wne.MinDecimalPlaces = (MinDecimalPlaces)(Enum.ToObject(typeof(MinDecimalPlaces), DecimalLength));

            wne.NumberFormat.NumberDecimalDigits = DecimalLength;
            wne.NumberFormat.CurrencyDecimalDigits = DecimalLength;
            wne.NumberFormat.PercentDecimalDigits = DecimalLength;
        }

        private object RenderDate(X.xControl ctrl, object parent, object valueObj)
        {
            string dateFormat = ctrl.GetControlFormat();
            string clientDateTimeFormat = GetClientDateFormatForMomentJs(dateFormat);

            Panel div = new Panel();
            div.Style.Add(&quot;width&quot;, &quot;200px&quot;);

            var dte = new XMLDateControl();
            div.Controls.Add(dte);

            CultureInfo c = DateFormatCulture.GetDateFormatCulture();
            dte.CalendarLayout.Culture = c;
            dte.AllowNull = ctrl.AllowNull;

            dte.Attributes.Add(&quot;DateFormat&quot;, clientDateTimeFormat);

            if (!string.IsNullOrEmpty(ctrl.MaxDate))
            {
                if (ctrl.MaxDate == &quot;{CURRENTDATE}&quot;)
                    dte.MaxDate = Brix.Platform.BusinessLayer.ResolveCurrentDateTime.CurrentDateTime;
                else
                {
                    DateTime dtMaxDate;
                    if (DateTime.TryParse(ctrl.MaxDate, out dtMaxDate))
                    {
                        dte.MaxDate = dtMaxDate;
                    }
                }
            }

            dte.MinDate = (DateTime)SqlDateTime.MinValue;

            if (!dte.AllowNull)
            {
                DateTime currentDate = MWDateTimeHelper.MWNow;
                string currentDateFormatted = currentDate.ToCustomFormat(dateFormat);
                dte.NullDateLabel = currentDateFormatted;
                dte.Value = currentDate;
            }
            else
                dte.NullDateLabel = &quot;None&quot;;

            dte.ReadOnly = ctrl.ReadOnly;

            var width = ParseHTMLUnitValue(ctrl.Width);
            div.Style.Add(&quot;width&quot;, width.ToString());
            dte.Width = width;

            string outDateTimeText;
            if (valueObj.TryParseObjectAsDateTimeString(out outDateTimeText, DateFormatCulture.GetDateFormatCulture()))
                dte.Value = outDateTimeText;

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                dte.Attributes.Add(&quot;style&quot;, ctrl.Attributes);


            if (!string.IsNullOrEmpty(ctrl.Enabled))
            {
                dte.Enabled = ctrl.Enabled.ToBoolean2();
            }
            // passing actual control in last parameter
            return (PostProcessControl(ctrl, div, dte));
        }

        private object RenderFormattedInput(X.xControl ctrl, object parent, object valueObj)
        {
            XMLMaskedTextBox radMaskedTextBox = new XMLMaskedTextBox();

            radMaskedTextBox.CssClass = &quot;tbC&quot;;
            radMaskedTextBox.Mask = (String.IsNullOrEmpty(ctrl.Format)) ? &quot;&quot; : ctrl.Format;
            radMaskedTextBox.Enabled = true;
            radMaskedTextBox.Width = ParseHTMLUnitValue(ctrl.Width);
            radMaskedTextBox.MaxLength = ctrl.MaxLength;

            radMaskedTextBox.ReadOnly = ctrl.ReadOnly;

            if (valueObj != null)
                radMaskedTextBox.Text = valueObj.ToString();

            return (PostProcessControl(ctrl, radMaskedTextBox));
        }

        private object RenderRichTextBox(X.xControl ctrl, object parent, object valueObj)
        {
            XMLRichTextBox radRichTextBox = new XMLRichTextBox();

            radRichTextBox.Width = 450;
            radRichTextBox.Height = 350;
            radRichTextBox.Enabled = true;
            radRichTextBox.NewLineMode = EditorNewLineModes.Br;

            radRichTextBox.ToolsFile = &quot;~/Common/ToolsFile.xml&quot;;
            radRichTextBox.OnClientSelectionChange = &quot;OnClientRichTextBoxSelectionChange&quot;;
            radRichTextBox.OnClientLoad = &quot;OnClientRichTextBoxLoad&quot;;

            if (ctrl.Width != null)
                radRichTextBox.Width = ParseHTMLUnitValue(ctrl.Width);
            if (ctrl.Height != null)
                radRichTextBox.Height = ParseHTMLUnitValue(ctrl.Height);

            if (valueObj != null)
                radRichTextBox.Content = valueObj.ToString();

            return (PostProcessControl(ctrl, radRichTextBox));
        }

        private object RenderTimeInput(X.xControl ctrl, object parent, object valueObj)
        {
            var wme = new XMLTimeInput();

            wme.CssClass = &quot;tbC&quot;;
            wme.InputMask = &quot;##:##&quot;;
            wme.RawText = &quot;##:##&quot;;
            wme.DataMode = MaskDataMode.RawText;
            wme.Enabled = true;
            wme.ReadOnly = false;
            wme.Width = ParseHTMLUnitValue(ctrl.Width);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                wme.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            if (valueObj != null)
                wme.Text = valueObj.ToString();
            else
            {
                string stime = ctrl.EvaluateControlValue();
                if (!string.IsNullOrEmpty(stime))
                    wme.Text = stime;
            }

            return (PostProcessControl(ctrl, wme));
        }

        private object RenderDropDownList(X.xControl ctrl, object parent, object valueObj)
        {
            DropDownList ddl;
            //if (ctrl.form.engine.IsViewMode || ctrl.EditMode == EditMode.View)
            //    ddl = new XMLDropDownList();
            //If group by is given then we are creating an instance of GroupDropDownList
            if (!string.IsNullOrEmpty(ctrl.GroupBy))
            {
                ddl = new GroupDropDownList();
                ddl.CssClass = &quot;ddlControls&quot;;
                (ddl as GroupDropDownList).DataGroupField = ctrl.GroupBy;
            }
            else
                ddl = new XMLDropDownList();

            ddl.Width = ParseHTMLUnitValue(ctrl.Width);
            BindDropDown(ctrl, ddl);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                ddl.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            if (valueObj != null)
                try
                {
                    ddl.Attributes.Add(&quot;InitialValue&quot;, valueObj.ToString());
                    if (ddl.Items.FindByValue(valueObj.ToString()) != null)
                        ddl.Items.FindByValue(valueObj.ToString()).Selected = true;
                }
                catch (Exception)
                {
                }
            else
                ddl.SelectedIndex = 0;

            if (ctrl.CausesPostback)
                ddl.AutoPostBack = true;

            return (PostProcessControl(ctrl, ddl));
        }

        private object RenderListbox(X.xControl ctrl, object parent, object valueObj)
        {
            if (ctrl.form != null &amp;&amp; ctrl.form.DesignMode &amp;&amp; string.IsNullOrEmpty(ctrl.DataSource) &amp;&amp;
                string.IsNullOrEmpty(ctrl.ListItems))
            {
                ctrl.ListItems = &quot;Option 1:Option 1;Option 2:Option 2&quot;;
            }

            var lb = new XMLListBox();
            lb.Width = ParseHTMLUnitValue(ctrl.Width);
            lb.Height = ParseHTMLUnitValue(ctrl.Height, 50);

            List&lt;X.FormListItem&gt; lbis = ctrl.GetFormList();
            foreach (X.FormListItem fli in lbis)
                lb.Items.Add(new ListItem(fli.display, fli.value));

            lb.SelectionMode = ListSelectionMode.Multiple;

            if (valueObj != null)
                try
                {
                    string[] values = valueObj.ToString().Split(&#39;,&#39;);
                    values.ForEach(
                        val =&gt;
                        {
                            if (lb.Items.FindByValue(val) != null)
                                lb.Items.FindByValue(val).Selected = true;
                        });
                }
                catch (Exception)
                {
                }

            return (PostProcessControl(ctrl, lb));
        }

        private object RenderPickerTrigger(X.xControl ctrl, object parent, object valueObj)
        {
            PickerGrid objGrid = null;
            X.Picker picker = model.form.GetContainer(ctrl.PickerName) as X.Picker;
            if (picker != null)
            {
                objGrid = InitializePicker(picker, ctrl.Name, ctrl.EnableMultiSelect, ctrl.PickerButtonText,
                    ctrl.PickerName, ctrl.PickerButtonWidth, ctrl.AfterSelectScript, ctrl.BeforePickerLoadScript, ctrl.PickerAllowClear);
                if (!string.IsNullOrEmpty(ctrl.Attributes))
                    objGrid.TriggerButton.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

                objGrid.TriggerButton.Attributes.Add(&quot;ControlType&quot;, &quot;PickerTrigger&quot;);
                objGrid.TriggerButton.Attributes.Add(&quot;aria-label&quot;, ctrl.PickerName);
                objGrid.TriggerButton.Enabled = (model.form.engine.IsViewMode || currentStageVisibility == &quot;View&quot;) ? false : true;
            }

            return objGrid;
        }

        private PickerGrid InitializePicker(X.Picker picker, string controlName, bool enableMultiSelect,
            string pickerButtonText, string pickerName, string PickerButtonWidth, string afterSelectScript,
            string beforePickerLoad, bool allowClear = false, string gridID = null, string pickerIdColumn = null)
        {
            Control ct = page.LoadControl(&quot;~/Modules/UserControls/PickerGrid.ascx&quot;);
            string ctrlName = controlName + &quot;_&quot; + picker.Name;

            PickerGrid objGrid = (PickerGrid)ct;
            objGrid.InitializePicker(
                (string.IsNullOrEmpty(picker.DataSourceURL) ? &quot;/api/GenericXMLPicker/&quot; : picker.DataSourceURL),
                GetGridColumns(picker), picker.KeyColumn, picker.DataSourceMethodType);
            objGrid.ID = ctrlName;
            objGrid.EnableMultiSelect = enableMultiSelect;
            objGrid.ButtonText = pickerButtonText;
            objGrid.PageSize = (string.IsNullOrEmpty(picker.PageSize) ? &quot;20&quot; : picker.PageSize).ToInt32_2();

            objGrid.TriggerButton.Style.Add(&quot;width&quot;,
                Unit.Pixel(string.IsNullOrEmpty(PickerButtonWidth)
                    ? 200
                    : Convert.ToInt32(PickerButtonWidth.Contains(&quot;px&quot;)
                        ? PickerButtonWidth.Substring(0, PickerButtonWidth.Length - 2)
                        : PickerButtonWidth)).ToString());

            objGrid.Attributes.Add(&quot;ControlName&quot;, ctrlName);
            objGrid.Attributes.Add(&quot;PickerName&quot;, pickerName);
            objGrid.AfterPickerSelectScript = &quot;ConsumeSelectedValues({0},&#39;&quot; + ctrlName + &quot;&#39;,&#39;&quot; + afterSelectScript +
                                              &quot;&#39;)&quot;;
            objGrid.ClearSelectionScript = &quot;return ClearSelectedValue(&#39;&quot; + ctrlName + &quot;&#39;,&#39;&quot; + afterSelectScript +
                                            &quot;&#39;)&quot;;
            objGrid.ExternalReference = picker;

            string beforePickerLoadScript = string.IsNullOrEmpty(beforePickerLoad) ? &quot;&quot; : beforePickerLoad;

           // if (!string.IsNullOrEmpty(gridID) &amp;&amp; !string.IsNullOrEmpty(pickerIdColumn))
                objGrid.BeforePickerLoadScript = &quot;XMLPickerLaunchParam(&#39;&quot; + picker.Name + &quot;&#39;,&#39;&quot; + pickerIdColumn + &quot;&#39;,&#39;&quot; +
                                                 gridID + &quot;&#39;,&#39;&quot; + picker.KeyColumn + &quot;&#39;,&#39;&quot; + beforePickerLoadScript +
                                                 &quot;&#39;)&quot;;
            //else if (!string.IsNullOrEmpty(beforePickerLoad))
            //    objGrid.BeforePickerLoadScript = beforePickerLoad + &quot;(&#39;&quot; + picker.Name + &quot;&#39;,&#39;&quot; + pickerIdColumn + &quot;&#39;,&#39;&quot; +
            //                                     gridID + &quot;&#39;,&#39;&quot; + picker.KeyColumn + &quot;&#39;,&#39;&#39;)&quot;;
            objGrid.OnGridLoad += new PickerGrid.GridLoad(objGrid_OnGridLoad);
            if (objGrid.EnableMultiSelect) objGrid.ShowSelectAllButton = true;
            objGrid.Title = picker.Caption;

            if (allowClear)
                objGrid.ShowClearButton = true;
            return objGrid;
        }

        void objGrid_OnGridLoad(PickerGrid grid)
        {
            X.Picker picker = (grid.ExternalReference as X.Picker);

            string WhereCond = string.Empty;
            picker.Controls.ForEach
                (xc =&gt;
                {
                    if (xc.FilterKey)
                    {
                        if ((xc as X.xColumn).Value != null &amp;&amp; (xc as X.xColumn).Value.StartsWith(&quot;$&quot;))
                        {
                            string value = X.xControl.ReplaceVariablesWithValues(ref xc.Value, null, xc.form, null, null);
                            WhereCond += (xc as X.xColumn).ColumnName + &quot;@^&#39;&quot; + value + &quot;&#39; and &quot;;
                        }
                        else if ((xc as X.xColumn) != null &amp;&amp; !string.IsNullOrEmpty((xc as X.xColumn).FilterExpression))
                        {
                            WhereCond += xc.ParseDynamicString((xc as X.xColumn).FilterExpression.Replace(&quot;=&quot;, &quot;@^&quot;)) +
                                         &quot; and &quot;;
                        }
                        else
                            WhereCond += (xc as X.xColumn).ColumnName + &quot;@^&#39;&quot; + xc.EvaluateControlValue() + &quot;&#39; and &quot;;
                    }
                });

            StringBuilder parameters = new StringBuilder();
            parameters.Append(&quot;{&quot;);
            parameters.AppendFormat(&quot;\&quot;DataSource\&quot; : \&quot;{0}\&quot;,&quot;,
                picker.ParseDynamicString(picker.DataSource).Replace(&quot;{&quot;, &quot;&quot;).Replace(&quot;}&quot;, &quot;&quot;).Replace(&quot;=&quot;, &quot;@^&quot;));
            parameters.AppendFormat(&quot;\&quot;WhereCond\&quot; : \&quot;{0}\&quot;&quot;, WhereCond);
            parameters.Append(&quot;}&quot;);

            grid.OptionalParamaters = grid.BuildOptionalParameters(parameters.ToString());
        }

        private List&lt;PickerColumnDetails&gt; GetGridColumns(X.Picker objPicker)
        {
            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();

            foreach (X.xColumn col in objPicker.Controls)
            {
                PickerColumnDetails tCol = new PickerColumnDetails
                {
                    Caption = col.ParseDynamicString(col.Caption),
                    ColumnName = col.ColumnName,
                    Hidden = col.Type == X.ControlType.Hidden,
                    Type = col.DBType
                };

                tCol.Width = (int)ParseHTMLUnitValue(col.Width, 100).Value;

                if (!string.IsNullOrEmpty(col.Format))
                {
                    tCol.Format = col.GetControlFormat();
                }
                if (!string.IsNullOrEmpty(col.Type.ToString()))
                {
                    switch (col.Type)
                    {
                        case X.ControlType.Date:
                            tCol.Type = &quot;date&quot;;
                            break;
                        case X.ControlType.Numeric:
                            tCol.Type = &quot;number&quot;;
                            break;
                        default:
                            tCol.Type = &quot;string&quot;;
                            break;
                    }
                }

                gridColumns.Add(tCol);
            }

            return gridColumns;
        }


        private object RenderAttachmentControl(X.xControl ctrl, object parent, object valueObj)
        {
            // PBI 24489.  Dont fail if the derived control is not allocated correctly
            // this is just another case of AttachmentControl
            var attachControl = (ctrl as X.AttachmentControl);
            if (attachControl == null)
            {
                var errDiv = new HtmlGenericControl(&quot;DIV&quot;);
                errDiv.InnerHtml = &quot;Error Rendering Attachment Control&quot;;
                return errDiv;
            }

            AttachmentsControl xmlFormAttachmentCtrl =
                (AttachmentsControl)page.LoadControl(&quot;~/Modules/UserControls/AttachmentsControl.ascx&quot;);

            if (ctrl.ParentObject is X.DynamicGrid)
            {
                var dg = (ctrl.ParentObject as X.DynamicGrid);
                if (dg != null &amp;&amp; dg.Table != null &amp;&amp; dg.Table.Rows.Count &gt; 0)
                {
                    xmlFormAttachmentCtrl.InstanceID = string.Join(&quot;,&quot;,
                        dg.Table.AsEnumerable().Select(row =&gt; row.Field&lt;int&gt;(dg.PrimaryKeyName).ToString()));
                }
            }
            else
            {
                xmlFormAttachmentCtrl.InstanceID = model.form.instanceID.ToString2();
            }

            bool isDynamicGrid = (attachControl.ParentObject is X.DynamicGrid);
            if (isDynamicGrid)
            {
                xmlFormAttachmentCtrl.AfterAttachmentAddedToGridScript = &quot;FilterAttachmentsInGrid&quot;;
                xmlFormAttachmentCtrl.CheckAttachmentOnSelectScript = &quot;CheckAttachmentOnSelectScript&quot;;
            }

            //Add additional cols to the grid inside the attachment control 
            foreach (var c in ctrl.Controls)
            {
                MetaDataCols mdCols;
                mdCols.colName = c.Name;
                mdCols.colCaption = c.Caption;
                mdCols.readOnly = c.ReadOnly;
                mdCols.controlType = c.Type.ToString();
                ValueList vallist = new ValueList();

                if (c.Type.ToString().ToLower() == &quot;dropdownlist&quot;)
                {
                    List&lt;X.FormListItem&gt; lbis = GetDropDownListValues(c);

                    foreach (X.FormListItem fli in lbis)
                    {
                        vallist.ValueListItems.Add(fli.value, fli.display);
                    }
                }
                mdCols.valueList = vallist;
                if (xmlFormAttachmentCtrl.MetaDataCols == null)
                    xmlFormAttachmentCtrl.MetaDataCols = new List&lt;MetaDataCols&gt;();
                xmlFormAttachmentCtrl.MetaDataCols.Add(mdCols);
            }

            xmlFormAttachmentCtrl.SrcType = (ctrl as X.AttachmentControl).ModuleId;

            //Caption should not be specified for attachment control. 
            //Otherwise it will render as a control&#39;s caption on the left

            {
                if (!string.IsNullOrEmpty((ctrl as X.AttachmentControl).AttachmentCaption))
                {
                    xmlFormAttachmentCtrl.Caption = (ctrl as X.AttachmentControl).AttachmentCaption;
                }
                else
                {
                    xmlFormAttachmentCtrl.Caption = &quot;Attachments&quot;;
                }
                xmlFormAttachmentCtrl.ShowAttachmentCaption = true;
                if (model.form.AttachmentsVisibility != X.ControlVisibility.None)
                    xmlFormAttachmentCtrl.Visibility =
                        (AttachmentsVisibility)Enum.Parse(typeof(AttachmentsVisibility), ctrl.Visibility.ToString());
            }

            xmlFormAttachmentCtrl.AllowedFileTypes = (ctrl as X.AttachmentControl).AllowedFileTypes;

            Panel divControl = new Panel();
            string wd = (!string.IsNullOrEmpty(model.form.Width) &amp;&amp; model.form.Width != &quot;100%&quot;)
                ? model.form.Width
                : &quot;800px&quot;;
            divControl.Style.Add(&quot;width&quot;, wd);
            divControl.Style.Add(&quot;padding-left&quot;, &quot;10px;&quot;);
            divControl.Style.Add(&quot;padding-bottom&quot;, &quot;10px;&quot;);
            divControl.Controls.Add(xmlFormAttachmentCtrl);

            if ((!string.IsNullOrEmpty(ctrl.HelpToolTip) || !string.IsNullOrEmpty(ctrl.HelpDescription)) &amp;&amp;
                xmlFormAttachmentCtrl.ControlCaptionRow.Cells.Count &gt; 0)
            {
                HtmlGenericControl divDesc = RenderHelpdescription(ctrl);
                divDesc.Style.Add(&quot;display&quot;, &quot;inline-block&quot;);
                xmlFormAttachmentCtrl.ControlCaptionRow.Cells[0].Controls.Add(divDesc);
            }
            return divControl;
        }


        private object RenderAutoIncrement(X.xControl ctrl, object parent, object valueObj)
        {
            // Defect 204489:  If the type of a control is set to autoincrement and it is actually a base control then
            // rendering crashes.  Fix is to check for ai != null and fall into else case.
            X.AutoIncrement ai = ctrl as X.AutoIncrement;
            if (ai == null)
            {
                var errDiv = new HtmlGenericControl(&quot;DIV&quot;);
                errDiv.InnerHtml = &quot;Error rendering auto increment control&quot;;
                return errDiv;
            }

            Panel div = new Panel();
            div.Style.Add(&quot;width&quot;, &quot;200px&quot;);
            Label lbl = new Label();
            div.Controls.Add(lbl);

            if ((valueObj == null || (string.IsNullOrEmpty(valueObj.ToString()))) &amp;&amp;
                (model.form.engine.IsNewMode || model.form.DesignMode))
            {
                lbl.Text = ai.NewModeText ?? &quot;&amp;lt;Auto Generated&amp;gt;&quot;;
            }
            else
            {
                lbl.Text = valueObj == null ? string.Empty : valueObj.ToString();
            }
            // passing actual control in last parameter
            return (PostProcessControl(ctrl, div));
        }


        private void SetCellRenderers()
        {
            CellRenderers[(int)X.ControlType.Hidden] = new X.xControl.RenderControl(RenderHidden);
            CellRenderers[(int)X.ControlType.InsertHide] = new X.xControl.RenderControl(RenderInsertHide);
            CellRenderers[(int)X.ControlType.Display] = new X.xControl.RenderControl(RenderDisplay);
            CellRenderers[(int)X.ControlType.TextBox] = new X.xControl.RenderControl(RenderTextBox);
            CellRenderers[(int)X.ControlType.Password] = new X.xControl.RenderControl(RenderPassword);
            CellRenderers[(int)X.ControlType.TextArea] = new X.xControl.RenderControl(RenderTextArea);
            CellRenderers[(int)X.ControlType.Date] = new X.xControl.RenderControl(RenderDate);
            CellRenderers[(int)X.ControlType.Numeric] = new X.xControl.RenderControl(RenderNumeric);
            CellRenderers[(int)X.ControlType.Integer] = new X.xControl.RenderControl(RenderInteger);
            CellRenderers[(int)X.ControlType.TimeInput] = new X.xControl.RenderControl(RenderTimeInput);
            CellRenderers[(int)X.ControlType.CheckBox] = new X.xControl.RenderControl(RenderCheckBox);
            CellRenderers[(int)X.ControlType.DropDownList] = new X.xControl.RenderControl(RenderDropDownList);
            CellRenderers[(int)X.ControlType.DropDownTreeDataControl] = new X.xControl.RenderControl(RenderDropDownTreeDataControl);
            CellRenderers[(int)X.ControlType.RadioButtonList] = new X.xControl.RenderControl(RenderRadioButtonList);
            CellRenderers[(int)X.ControlType.Formula] = new X.xControl.RenderControl(RenderFormula);
            CellRenderers[(int)X.ControlType.Formatted] = new X.xControl.RenderControl(RenderFormattedInput);
            CellRenderers[(int)X.ControlType.Listbox] = new X.xControl.RenderControl(RenderListbox);
            CellRenderers[(int)X.ControlType.Set] = new X.xControl.RenderControl(RenderSet);
            CellRenderers[(int)X.ControlType.MultiPicker] = new X.xControl.RenderControl(RenderMultiPicker);
            CellRenderers[(int)X.ControlType.Link] = new X.xControl.RenderControl(RenderLink);
            CellRenderers[(int)X.ControlType.CheckBoxList] = new X.xControl.RenderControl(RenderRadioButtonList);
            CellRenderers[(int)X.ControlType.PickerTrigger] = new X.xControl.RenderControl(RenderPickerTrigger);
            CellRenderers[(int)X.ControlType.AutoIncrement] = new X.xControl.RenderControl(RenderAutoIncrement);
            CellRenderers[(int)X.ControlType.AttachmentControl] = new X.xControl.RenderControl(RenderAttachmentControl);
            CellRenderers[(int)X.ControlType.Button] = new X.xControl.RenderControl(RenderButton);
            CellRenderers[(int)X.ControlType.PlaceHolder] = new X.xControl.RenderControl(RenderPlaceHolder);
            CellRenderers[(int)X.ControlType.Map] = new X.xControl.RenderControl(RenderMap);
            CellRenderers[(int)X.ControlType.Picture] = new X.xControl.RenderControl(RenderImage);
            CellRenderers[(int)X.ControlType.FileUpload] = new X.xControl.RenderControl(RenderFileUpload);
            CellRenderers[(int)X.ControlType.DateTime] = new X.xControl.RenderControl(RenderDateTime);
            CellRenderers[(int)X.ControlType.PictureTaker] = new X.xControl.RenderControl(RenderPictureTaker);

            CellRenderers[(int)X.ControlType.RichTextBox] = new X.xControl.RenderControl(RenderRichTextBox);


        }

        private void RenderBorderInDesignMode(HtmlControl hgc, bool isContainer)
        {
            if (string.IsNullOrWhiteSpace(hgc.Attributes[&quot;class&quot;]))
                hgc.Attributes[&quot;class&quot;] = &quot;formDesignerContainerHighlight&quot;;
            else
                hgc.Attributes[&quot;class&quot;] += &quot; formDesignerContainerHighlight&quot;;

            // hgc.Style.Add(&quot;border&quot;, &quot;Dotted 1px &quot; + (isContainer ? &quot;#dddddd&quot; : &quot;#eeeeee&quot;));
        }

        private object RenderDateTime(X.xControl ctrl, object parent, object valueObj)
        {
            //this control should be included inside a panel as they don&#39;t support ClientIDMode = Static

            string dateFormat = ctrl.GetControlFormat();
            string clientDateTimeFormat = GetClientDateFormatForMomentJs(dateFormat);

            CultureInfo c = DateFormatCulture.GetDateFormatCulture();

            XMLPanel dateTimePickerPanel = new XMLPanel();
            XMLDateTimeControl dateTimePicker = new XMLDateTimeControl();
            dateTimePicker.ID = ActualControlIdFormat.Format2(X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(ctrl).Name, ctrl.Name);
            dateTimePicker.Skin = &quot;Office2007&quot;;
            dateTimePicker.DateInput.ClientEvents.OnError = &quot;DateTimeControl_HandleError&quot;;

            dateTimePicker.Culture = c;
            dateTimePicker.DateInput.DateFormat = dateFormat;
            dateTimePicker.DateInput.DisplayDateFormat = dateFormat;

            dateTimePickerPanel.Attributes.Add(&quot;DateFormat&quot;, clientDateTimeFormat);
            dateTimePickerPanel.Controls.Add(dateTimePicker);

            if (!string.IsNullOrEmpty(ctrl.MaxDate))
            {
                if (ctrl.MaxDate == &quot;{CURRENTDATE}&quot;)
                    dateTimePicker.MaxDate = Brix.Platform.BusinessLayer.ResolveCurrentDateTime.CurrentDateTime;
                else
                {
                    DateTime dtMaxDate;
                    if (DateTime.TryParse(ctrl.MaxDate, out dtMaxDate))
                        dateTimePicker.MaxDate = dtMaxDate;
                }
            }

            dateTimePicker.MinDate = (DateTime)SqlDateTime.MinValue;

            if (!ctrl.AllowNull)
            {
                DateTime currentDate = MWDateTimeHelper.MWNow;
                dateTimePicker.DateInput.EmptyMessage = currentDate.Date.ToCustomFormat(dateFormat);
                dateTimePicker.DateInput.SelectedDate = currentDate.Date;
            }
            else
            {
                dateTimePicker.DateInput.EmptyMessage = &quot;None&quot;;
                dateTimePicker.DateInput.SelectedDate = null;
            }

            dateTimePicker.DateInput.ReadOnly = ctrl.ReadOnly;
            dateTimePicker.TimeView.Enabled = !ctrl.ReadOnly;

            var width = ParseHTMLUnitValue(ctrl.Width);
            dateTimePickerPanel.Style.Add(&quot;width&quot;, width.ToString());
            dateTimePicker.Width = width;

            DateTime? outDateTime;
            if (valueObj.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.GetDateFormatCulture()))
                dateTimePicker.SelectedDate = outDateTime;

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                dateTimePicker.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            if (!string.IsNullOrEmpty(ctrl.Enabled))
            {
                dateTimePicker.Enabled = ctrl.Enabled.ToBoolean2();
            }

            // passing actual control in last parameter
            return (PostProcessControl(ctrl, dateTimePickerPanel));
        }

        private static string GetClientDateFormatForMomentJs(string format)
        {
            string clientDateTimeFormat = format;
            clientDateTimeFormat = clientDateTimeFormat.Replace(AMP3ApplicationSettings.Instance.FORMAT_DATE, AMP3ApplicationSettings.Instance.FORMAT_DATE.ToUpper());
            //clientDateTimeFormat = clientDateTimeFormat.Replace(&quot;h&quot;, &quot;H&quot;);
            clientDateTimeFormat = clientDateTimeFormat.Replace(&quot;tt&quot;, &quot;A&quot;);
            return clientDateTimeFormat;
        }

        #endregion

        internal override bool IsCurrentStage(X.Section sec)
        {
            return !(!String.IsNullOrWhiteSpace(sec.Stage) &amp;&amp;
                     (
                         sec.Stage != (stageCompleted + 1).ToString()
                         ||
                         (!string.IsNullOrEmpty(currentStageUser) &amp;&amp; currentStageUser != &quot;NA&quot; &amp;&amp;
                          currentStageUser.ToLower() != (page.Session[&quot;UserDetail&quot;] as UserDetail).UserID.ToLower())
                         ||
                         (!string.IsNullOrEmpty(currentStageRole) &amp;&amp; currentStageRole != &quot;NA&quot; &amp;&amp;
                          currentStageRole.ToLower() != (page.Session[&quot;UserDetail&quot;] as UserDetail).RoleName.ToLower())
                         )
                );
        }

        internal override string GetServerValue(X.xControl control)
        {
            if (ServerGetters[(int)control.Type] != null)
            {
                // get the delegate that actuall renders the control from the registered renderers.  For now we hard
                // code htmlrender since reports dont work through this model yet.
                X.xControl.GetServerSideValue d = ServerGetters[(int)control.Type];

                // call the renderer to render the control and add it to the control reference
                if (d != null)
                    return (d(control));
                else
                    return (string.Empty);
            }
            else
                return (string.Empty);
        }

        internal override void SetServerValue(X.xControl control, object value)
        {
            if (ServerSetters[(int)control.Type] != null)
            {
                X.xControl.SetServerSideValue d = ServerSetters[(int)control.Type];
                if (d != null)
                    d(control, value);
            }
        }

        private object GetDynamicGridCell(X.DataBaseContainer dbContainer, int rowIndex, int columnIndex)
        {
            var dGrid = dbContainer as X.DynamicGrid;
            int colCount = dGrid.Controls.Count;
            //xControl xc = new xControl();
            //xc.Type = dGrid.Controls[columnIndex].Type;
            //xc.Name = dGrid.Controls[columnIndex].Name;
            //xc.ParentObject = dGrid.Controls[columnIndex].ParentObject;
            var grid = dGrid.ControlReference[0] as RadGrid;
            if (grid.MasterTableView.AutoGenerateColumns)
            {
                if (rowIndex &lt; MWGrid.GetRows(grid).Count &amp;&amp;
                    columnIndex &lt; grid.MasterTableView.AutoGeneratedColumns.Length)
                {
                    //Get value from datatable 
                    object toReturn =
                        ((System.Data.DataRowView)grid.MasterTableView.Items[rowIndex].DataItem).Row[
                            grid.MasterTableView.AutoGeneratedColumns[columnIndex].UniqueName];
                    //If value holds DBNull or &quot;&amp;nbsp;&quot;, set System.Null 
                    //(Telerik adds &amp;nbsp; for empty table cells. so while fetching cell value convert the html space back to empty string)
                    toReturn = ((toReturn == DBNull.Value) ||
                                (System.Net.WebUtility.HtmlDecode(Convert.ToString(toReturn)) == string.Empty))
                        ? null
                        : toReturn;

                    //TODO : TBC 
                    //IF grid has inline editing, and if the column is not editied  Then it returns null  and we need to skip control value evaluation and return null
                    string editorControlID = &quot;&quot;;
                    //uwg.MasterTableView.AutoGeneratedColumns[columnIndex].EditorControlID;
                    bool skipValueEvaluationForInlineEditing = toReturn == null
                                                               &amp;&amp; dGrid.AllowInlineEdit
                                                               &amp;&amp; !(string.IsNullOrEmpty(editorControlID));

                    if (!skipValueEvaluationForInlineEditing &amp;&amp; toReturn == null)
                    {
                        X.xControl xc =
                            dbContainer.GetControl(grid.MasterTableView.AutoGeneratedColumns[columnIndex].UniqueName);
                        if (xc != null)
                            toReturn = xc.EvaluateControlValue();
                        if (toReturn != null)
                        {
                            //If value is empty and the corresponding database type is non-string, then null should be inserted. 
                            if (
                                !dbContainer.GetControl(
                                    grid.MasterTableView.AutoGeneratedColumns[columnIndex].UniqueName)
                                    .DBType.Contains(&quot;char&quot;) &amp;&amp;
                                (toReturn.ToString() == &quot;&quot; ||
                                 toReturn.ToString().Equals(&quot;nan&quot;, StringComparison.CurrentCultureIgnoreCase)))
                                toReturn = &quot;_DBNULL_&quot;;
                            return toReturn;
                        }
                        else
                            return &quot;&quot;;
                    }
                    else return toReturn;
                }
                else
                    return null; // to stop the loop 
            }
            else
            {
                if (rowIndex &lt; MWGrid.GetRows(grid).Count &amp;&amp; columnIndex &lt; grid.MasterTableView.Columns.Count)
                {
                    // Skip multi select column.
                    if (grid.AllowMultiRowSelection)
                        columnIndex++;

                    // Skip drag- drop column also. When multi select column is there, then dragdrop will be at second position. Hence, increment columnIndex.
                    if (grid.ClientSettings.AllowRowsDragDrop)
                        columnIndex++;

                    //Get value from datatable 
                    object toReturn =
                        ((System.Data.DataRowView)grid.MasterTableView.Items[rowIndex].DataItem).Row[
                            grid.MasterTableView.Columns[columnIndex].UniqueName];
                    //If value holds DBNull or &quot;&amp;nbsp;&quot;, set System.Null 
                    //(Telerik adds &amp;nbsp; for empty table cells. so while fetching cell value convert the html space back to empty string)
                    toReturn = ((toReturn == DBNull.Value) ||
                                (System.Net.WebUtility.HtmlDecode(Convert.ToString(toReturn)) == string.Empty))
                        ? null
                        : toReturn;

                    //TODO : TBC 
                    //IF grid has inline editing, and if the column is not editied  Then it returns null  and we need to skip control value evaluation and return null
                    string GridColumnType = grid.MasterTableView.Columns[columnIndex].ColumnType;
                    if (GridColumnType == &quot;GridTemplateColumn&quot; &amp;&amp; !string.IsNullOrEmpty(Convert.ToString(toReturn)))
                    {
                        X.xControl xc = dbContainer.GetControl(grid.MasterTableView.Columns[columnIndex].UniqueName);
                        List&lt;X.FormListItem&gt; lbis = xc.GetFormList();
                        X.FormListItem selectedItem =
                            lbis.FirstOrDefault(
                                item =&gt;
                                    item.display.ToString2() == toReturn.ToString2());
                        if (selectedItem != null) toReturn = selectedItem.value;
                    }
                    string editorControlID = &quot;&quot;;
                    //uwg.MasterTableView.AutoGeneratedColumns[columnIndex].EditorControlID;
                    bool skipValueEvaluationForInlineEditing = toReturn == null
                                                               &amp;&amp; dGrid.AllowInlineEdit
                                                               &amp;&amp; !(string.IsNullOrEmpty(editorControlID));

                    if (!skipValueEvaluationForInlineEditing &amp;&amp; toReturn == null)
                    {
                        X.xControl xc = dbContainer.GetControl(grid.MasterTableView.Columns[columnIndex].UniqueName);
                        if (xc != null)
                            toReturn = xc.EvaluateControlValue();
                        if (toReturn != null)
                        {
                            //If value is empty and the corresponding database type is non-string, then null should be inserted. 
                            if (toReturn.ToString() == &quot;&quot; &amp;&amp;
                                !dbContainer.GetControl(grid.MasterTableView.Columns[columnIndex].UniqueName)
                                    .DBType.Contains(&quot;char&quot;))
                                toReturn = &quot;_DBNULL_&quot;;
                            return toReturn;
                        }
                        else
                            return &quot;&quot;;
                    }
                    else return toReturn;
                }
                else
                    return null; // to stop the loop 
            }
        }

        private object GetStaticGridCell(X.DataBaseContainer dbContainer, int rowIndex, int columnIndex)
        {
            var sGrid = dbContainer as X.StaticGrid;
            var h = (sGrid.Containers[0] as X.Header);
            X.xControl xctrl = h.Controls[columnIndex];
            int colCount = h.Controls.Count;

            //TODO:  we need to change the logic here to allow more than one foreign key and it may come from another parent other than the form
            if (xctrl.ForeignKey)
                return sGrid.form.instanceID;
            else
            {
                X.xControl clone;
                if (xctrl.Type == X.ControlType.Hidden)
                {
                    // Clone the header xcontrol object, set the web control reference from the controlreference array and get the server value.
                    clone = new X.xControl();
                    clone.Name = xctrl.Name;
                    clone.Type = xctrl.Type;
                    clone.ParentObject = xctrl.ParentObject;
                    clone.DBType = xctrl.DBType;//this determines if Timezone applicable hence we need to add this field to clone obj
                }
                else
                {
                    // set the web control reference from the controlreference array of static grid and get the server value.
                    int visibleColIndex = columnIndex;
                    for (int i = 0; i &lt; columnIndex; i++)
                        if (h.Controls[i].Type == X.ControlType.Hidden) visibleColIndex--;
                    clone = sGrid.Containers.OfType&lt;X.Row&gt;().ToArray()[rowIndex].Controls[visibleColIndex];
                }
                var cellIndex = (rowIndex * colCount) + columnIndex;

                if (cellIndex &lt; sGrid.ControlReference.Count)
                    clone.ControlReference.Add(sGrid.ControlReference[cellIndex]);
                return clone.GetServerValue();
            }
        }

        private object GetMatrixGridCell(X.DataBaseContainer dbContainer, int rowIndex, int columnIndex)
        {
            try
            {
                var matrixGrid = dbContainer as X.MatrixGrid;
                if (matrixGrid.Containers.OfType&lt;X.DataControls&gt;().Any())
                {
                    var dataControls = matrixGrid.Containers.OfType&lt;X.DataControls&gt;().FirstOrDefault();
                    Dictionary&lt;string, string&gt; values = new Dictionary&lt;string, string&gt;();
                    foreach (X.xControl control in dataControls.Controls)
                    {
                        if (!string.IsNullOrEmpty(control.DBType) &amp;&amp; control.ControlReference.Count &gt;= columnIndex)
                        {
                            if (!control.PrimaryKey &amp;&amp;
                                !(control.Name.Equals(matrixGrid.PrimaryKeyName,
                                    StringComparison.CurrentCultureIgnoreCase)))
                            {
                                if (control.ForeignKey)
                                {
                                    values.Add(control.Name, control.EvaluateControlValue());
                                }
                                else
                                {
                                    X.xControl clone = new X.xControl();
                                    clone.Name = control.Name;
                                    clone.Type = control.Type;
                                    clone.DBType = control.DBType;
                                    clone.DataSource = control.DataSource;
                                    clone.ListItems = control.ListItems;
                                    clone.Value = control.Value;
                                    clone.ParentObject = control.ParentObject;

                                    clone.ControlReference.Add(control.ControlReference[columnIndex]);
                                    object value = clone.CheckForDateAndSetFormat(clone, clone.GetServerValue());
                                    values.Add(clone.Name, value.ToString());
                                }
                            }
                        }
                    }
                    return values;
                }
            }

            catch
            {
            }
            return null;
        }

        private object GetCheckListGroupCell(X.DataBaseContainer dbContainer, int rowIndex, int columnIndex)
        {
            var clg = dbContainer as X.CheckListGroup;
            X.CheckList cl = GetCheckList(clg, rowIndex);
            var xc = new X.xControl();
            if (columnIndex == 0)
            {
                // this is a hack we need to fix this by starting the indexing from in place of doing it with 1
                xc.Type = X.ControlType.Hidden;
                xc.ParentObject = clg;
                xc.IsRunTimeControl = true;
            }
            else
            {
                X.xControl overridenOpt = null;
                if (cl.Controls.Count &gt; 0)
                {
                    object tempObj = cl.Controls.Find(o =&gt; o.Name == clg.Controls[columnIndex - 1].Name);
                    if (tempObj != null)
                        overridenOpt = tempObj as X.xControl;
                }

                xc.Type = overridenOpt != null ? overridenOpt.Type : clg.Controls[columnIndex - 1].Type;
                xc.ParentObject = clg.Controls[columnIndex - 1].ParentObject;

                bool reEvaluate = overridenOpt != null
                    ? overridenOpt.ReEvaluate
                    : clg.Controls[columnIndex - 1].ReEvaluate;

                if (reEvaluate)
                {
                    xc.ReEvaluate = true;
                    xc.Value = overridenOpt != null ? overridenOpt.Value : clg.Controls[columnIndex - 1].Value;
                }
            }
            xc.ControlReference.Add(cl.ControlReference[columnIndex]);
            if (xc.ReEvaluate)
                return xc.EvaluateControlValue();
            else
                return xc.GetServerValue();
        }

        /// &lt;summary&gt;
        /// This function returns the reference of the checklist object based on the row index
        /// The index works across all the groups in the checklistGroup
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;clg&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;rowIndex&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private X.CheckList GetCheckList(X.CheckListGroup clg, int rowIndex)
        {
            int checkedCL = 0;
            foreach (X.Group grp in clg.Containers.OfType&lt;X.Group&gt;())
            {
                if (grp.Containers.OfType&lt;X.CheckList&gt;().Count() + checkedCL &lt;= rowIndex)
                {
                    checkedCL += grp.Containers.OfType&lt;X.CheckList&gt;().Count();
                    continue;
                }
                else
                    return grp.Containers.OfType&lt;X.CheckList&gt;().ToArray()[rowIndex - checkedCL];
            }
            return null;
        }

        public override object BeginRendering(X.Form form)
        {
            ContainerIndex = 0;
            base.BeginRendering(form);

            CheckForWorkflow();

            // In case of HTML Rendering, the parent div control will be passed to the engine to tell it where it has to render the form
            // If the RenderParent of the engine is null - create a div control, add it to the page in the end and return it as RenderParent
            if (form.theengine.RenderParent == null)
            {
                var divControl = new HtmlGenericControl(&quot;DIV&quot;);
                form.page.Form.Controls.Add(divControl);
                AddValidationSummary(divControl);
                return divControl;
            }
            else
            {
                AddValidationSummary(form.theengine.RenderParent);
                return (form.theengine.RenderParent);
            }
        }

        private void AddValidationSummary(object divControl)
        {
            if (model.form.ShowValidationSummary)
            {
                if (divControl is HtmlGenericControl)
                {
                    var parentDiv = (divControl as HtmlGenericControl);

                    ValidationSummary summary = new ValidationSummary();
                    parentDiv.Controls.Add(summary);
                    summary.ShowMessageBox = true;
                    summary.HeaderText = &quot;Please enter a value in the following fields:&quot;;
                    summary.EnableClientScript = true;
                    summary.ValidationGroup = &quot;Master&quot;;
                    summary.ShowSummary = false;
                }
            }
        }

        public override void EndRendering(X.Form form)
        {
            //EvaluateControlValues(form);
            HandleClientScript();
            InjectControlIdFormat();
            if (form != null &amp;&amp; !string.IsNullOrEmpty(form.IncludeScriptFiles))
            {
                int index = 0;
                foreach (
                    string scriptFile in
                        form.IncludeScriptFiles.Split(new string[] { &quot;,&quot; }, StringSplitOptions.RemoveEmptyEntries))
                {
                    if (scriptFile.Trim() != &quot;&quot;)
                    {
                        page.ClientScript.RegisterClientScriptInclude(
                            model.form.Name + model.form.ModuleID + &quot;_&quot; + index.ToString(),
                            VirtualPathUtility.ToAbsolute(scriptFile));
                        index++;
                    }
                }
            }
            base.EndRendering(form);
        }

        private void InjectControlIdFormat()
        {
            page.ClientScript.RegisterHiddenField(&quot;ControlIdFormat&quot;, ControlIdFormat);

            page.ClientScript.RegisterHiddenField(&quot;ControlIdFormatEmbeddedForm&quot;, ControlIdFormatEmbeddedForm);
        }

        private void SetContainerApplyChanges()
        {
            ApplyChangesToContainer[(int)X.ContainerTypes.DynamicGrid] =
                new X.ControlContainer.ApplyChangesToContainer(ApplyChangesToDynamicGrid);
        }

        private void SetControlApplyChanges()
        {
            ApplyChangesToControl[(int)X.ControlType.TextBox] = new X.xControl.ApplyChangesToControl(ApplyChangesToTextBox);
        }

        private void EvaluateControlValues(X.ControlContainer container)
        {
            container.Controls.ForEach(ctrl =&gt;
            {
                ctrl.valueObj = ctrl.EvaluateControlValue();
                ctrl.Controls.ForEach(
                    innerCtrl =&gt; innerCtrl.valueObj = innerCtrl.EvaluateControlValue());
            });
            container.Containers.ForEach(c =&gt; EvaluateControlValues(c));
        }

        /// &lt;summary&gt;
        /// This Evaluates a Datasource which is in the form of a keyword
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;xc&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static DataTable EvaluateControlDataSource(X.xControl xc)
        {
            //Assuming the Header information and records in a string are stored. 
            //And the header and content are seperated by ^#|
            //And every record in content is seperated by ^*|
            //And every column in a record is seperated by ^@|

            string headerContentSeperator = &quot;^#|&quot;;
            string rowSeperator = &quot;^*|&quot;;
            string columnSeperator = &quot;^@|&quot;;

            var newXc = new X.xControl();
            newXc.Value = xc.DataSource;
            string values = newXc.EvaluateControlValue();
            if (string.IsNullOrEmpty(values)) return null;
            string headerString =
                values.Split(new string[] { headerContentSeperator }, StringSplitOptions.RemoveEmptyEntries)[0];

            string[] header = headerString.Split(&quot;,&quot;.ToCharArray());
            var dtItems = new DataTable();
            foreach (string headr in header)
                dtItems.Columns.Add(headr);

            string contentString;
            if (values.Split(new string[] { headerContentSeperator }, StringSplitOptions.RemoveEmptyEntries).Length &gt;= 2)
                contentString =
                    values.Split(new string[] { headerContentSeperator }, StringSplitOptions.RemoveEmptyEntries)[1];
            else
                return dtItems;

            string[] items = contentString.Split(new string[] { rowSeperator }, StringSplitOptions.RemoveEmptyEntries);


            foreach (string itemRecord in items)
            {
                if (!string.IsNullOrEmpty(itemRecord))
                {
                    string[] listItem = itemRecord.Split(new string[] { columnSeperator }, StringSplitOptions.RemoveEmptyEntries);
                    dtItems.Rows.Add(listItem[0], listItem[1]);
                }
            }

            return dtItems;
        }

        private void CheckForWorkflow()
        {
            //if (File.Exists(page.Server.MapPath(@&quot;~/Modules/WORKFLW/&quot; + model.form.ModuleID + &quot;.xml&quot;)))
            //{
            //    WFitem item = new WFitem(model.form.instanceID, model.form.ModuleID, null, null);
            //    DataTable dt = new WorkflowFactory(null, null).GetWorkflowUsersHistory(item.Id, model.form.instanceID, model.form.ModuleID);
            //    stageCompleted = dt.Select(&quot;Completed=true&quot;).Length;
            //    if (stageCompleted &lt; dt.Rows.Count)
            //    {
            //        currentStageUser = dt.Rows[stageCompleted].Field&lt;string&gt;(&quot;User&quot;);
            //        currentStageRole = dt.Rows[stageCompleted].Field&lt;string&gt;(&quot;Role&quot;);
            //    }
            //}
        }

        private void HandleClientScript()
        {
            var Script = new StringBuilder();

            Script.Append(InjectControlScripts());

            Script.Append(InjectDestinations());

            Script.Append(&quot;;&quot;);

            Script.Append(
                @&quot;
                var pendingServerReqs = 0;
                var btnSaveID = &#39;&#39;;
                function SetSaveButtonId(id)
                {
                    btnSaveID = id;
                    pendingServerReqs = 0;
                }

                function EnableDisableSaveButton()
                {
                   try{
		                if((pendingServerReqs &gt; 0) &amp;&amp; btnSaveID) {
		                $(&#39;#&#39; + btnSaveID).prop(&#39;disabled&#39;,true);	
		                }
		                else
		                {
			                $(&#39;#&#39; + btnSaveID).prop(&#39;disabled&#39;,false);
		                }		
	                }
	                catch (ex) {
	                }
                }
            &quot;);

            Script.Append(
                @&quot;function updateDestinations(id,sourceElement)
                            {
                            var elem = $(&#39;#&#39; + sourceElement);
                            if(elem != null &amp;&amp; elem != &#39;&#39;)
                            {
                            var data = {action:&#39;calc&#39;,dests:[],srcs:[]}
                            var k = 0;
                                for(var i=0;i&lt;destinations.length;i++)
                                {
                                    if(destinations[i].dependsOn(sourceElement))
                                    {
                                        data.dests[data.dests.length]= {name:destinations[i].name,value:&#39;&#39;};
                                        for(var j=0;j&lt;destinations[i].sources.length;j++ )
                                        {
                                            data.srcs[k]= {name:destinations[i].sources[j].name,value:destinations[i].sources[j].getValue()};
                                            k = k + 1;
                                        }
                                    }
                                }
                                XMLFormSendServerRequest(JSON.stringify(data),&#39;calc&#39;)
                            }
                            }&quot;);

            Script.Append(@&quot;
                            function updateDateDestinations(oDateChooser,newValue,oEvent)
                            {   
                                updateDestinations(&#39;&#39;,oDateChooser.ID);
                                    
                            }    
                &quot;);

            Script.Append(
                @&quot;
                            function XMLFormHandleServerResponse(response,context)
                            {
                                try {pendingServerReqs = pendingServerReqs -1; EnableDisableSaveButton();  CloseOnReturnCall(); } catch (ex) { }
                            
                                var values =JSON.parse(EscapeIllegalJsonCharacters(response));
                                for(var i=0;i&lt;values.length;i++)
                                {
                                    var target = values[i].name;
                                    var newValue = values[i].value;

                                    for(j=0;j&lt;destinations.length;j++)
                                    {
                                        if(destinations[j].name==target)
                                        {
                                            if(destinations[j].type==&#39;Select&#39; &amp;&amp; typeof(newValue)==&#39;object&#39; )   
                                                UpdateDropdownItems(destinations[j].id,newValue)
                                            else                                
                                            {    
                                                newValue = newValue.replace(/&amp;#39;/g,&#39;\&#39;&#39;);
                                                newValue = newValue.replace(/&amp;#92;/g,&#39;\\&#39;);
                                                newValue = newValue.replace(/&amp;#34;/g,&#39;&quot;&quot;&#39;);
                                                destinations[j].setValue(newValue);
                                            }

                                            break;
                                        }
                                    }
                            }
                            }&quot;);

            Script.Append(@&quot;
                function ShowHideSectionWithTitle(eventDetails, togglerObj, isPostback)
                {
                    var defaultVisibility = undefined;
                    if(eventDetails == undefined &amp;&amp; togglerObj != undefined)
                    {
                        if(isPostback)
                            defaultVisibility = togglerStatus(togglerObj[0].id);
                        else                            
                        defaultVisibility = togglerObj.closest(&#39;table&#39;).attr(&#39;defaultVisibility&#39;);
                    }
                    else
                    {
                        togglerObj = $(this);
                    }

                    // Flag that will be used to change the toggler&#39;s image(+/-)
                    var toggleStatus = &#39;unchanged&#39;;

                    // Level 1 : Find the first table with class &#39;xmlFormSectionTable&#39; and toggle all it&#39;s rows except the first
                    var level1Table = togglerObj.closest(&#39;table.xmlFormSectionTable&#39;);
                    var rows = level1Table.children().children();
                    for(var i = 1; i &lt; rows.length; i++)
                    {
                        var currentRow = $(rows)[i];

                        var currentVisibility = ($(currentRow).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);
                        if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                        {
                            $(currentRow).toggle();
                            if(toggleStatus == &#39;unchanged&#39;)
                            {
                                if($(currentRow).css(&#39;display&#39;) == &#39;none&#39;)
                                    toggleStatus = &#39;collapsed&#39;;
                                else
                                    toggleStatus = &#39;expanded&#39;;
                            }
                        }
                    }

                    // Level 2 : Find the first div above Level 1 table and toggle all tables and divs in it except the first
                    var level2Div = level1Table.closest(&#39;div&#39;);
                    var divChildren = level2Div.children();
                    for(var i = 1; i &lt; divChildren.length; i++)
                    {
                        var currentChild = $(divChildren)[i];

                        var currentVisibility = ($(currentChild).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);
                        if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                        {
                            $(currentChild).toggle();
                            if(toggleStatus == &#39;unchanged&#39;)
                            {
                                if($(currentChild).css(&#39;display&#39;) == &#39;none&#39;)
                                    toggleStatus = &#39;collapsed&#39;;
                                else
                                    toggleStatus = &#39;expanded&#39;;
                            }
                        }
                    }

                    // Level 3 : Find the first table with attribute &#39;formdesignername&#39; above Level 2 div and toggle all it&#39;s rows except the first
                    var level3Table = level2Div.closest(&#39;table[formdesignername]&#39;);
                    var rows = level3Table.children().children();
                    for(var i = 1; i &lt; rows.length; i++)
                    {
                        var currentRow = $(rows)[i];

                        var currentVisibility = ($(currentRow).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);
                        if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                        {
                            $(currentRow).toggle();
                            if(toggleStatus == &#39;unchanged&#39;)
                            {
                                if($(currentRow).css(&#39;display&#39;) == &#39;none&#39;)
                                    toggleStatus = &#39;collapsed&#39;;
                                else
                                    toggleStatus = &#39;expanded&#39;;
                            }
                        }
                    }

                    if(toggleStatus == &#39;collapsed&#39;)
                    {
                        togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPPlus.GIF&#39;);
                        togglerObj.find(&#39;img&#39;).attr(&#39;alt&#39;,&#39;expand&#39;);
                        togglerObj.find(&#39;a&#39;).attr(&#39;aria-expanded&#39;,&#39;false&#39;);
                        togglerStatus(togglerObj[0].id, &#39;collapsed&#39;);
                    }
                    else if(toggleStatus == &#39;expanded&#39;)
                    {
                        togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPMinus.GIF&#39;);
                        togglerObj.find(&#39;img&#39;).attr(&#39;alt&#39;,&#39;collapse&#39;);
                        togglerObj.find(&#39;a&#39;).attr(&#39;aria-expanded&#39;,&#39;true&#39;);
                        togglerStatus(togglerObj[0].id, &#39;expanded&#39;);
                }
                }

                function ShowHideDynamicGrid(eventDetails, togglerObj, isPostback)
                {
                    var defaultVisibility = undefined;
                    if(eventDetails == undefined &amp;&amp; togglerObj != undefined)
                    {
                        if(isPostback)
                            defaultVisibility = togglerStatus(togglerObj[0].id);
                        else                            
                        defaultVisibility = togglerObj.closest(&#39;table&#39;).attr(&#39;defaultVisibility&#39;);
                    }
                    else
                    {
                        togglerObj = $(this);
                    }

                    var mainDiv = togglerObj.closest(&#39;div[formdesignername]&#39;);
                    var gridDiv = $(&#39;div:first&#39;,$(mainDiv));
                    var currentVisibility = ($(gridDiv).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);

                    if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                    {
                        gridDiv.toggle();
                        var buttonsTable = $(mainDiv).children(&#39;table&#39;).eq(1);
                        buttonsTable.toggle();
                        if($(gridDiv).css(&#39;display&#39;) == &#39;none&#39;)
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPPlus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;collapsed&#39;);
                        }
                        else
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPMinus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;expanded&#39;);
                    }
                }
                }

                function ShowHideStaticGrid(eventDetails, togglerObj, isPostback)
                {
                    var defaultVisibility = undefined;
                    if(eventDetails == undefined &amp;&amp; togglerObj != undefined)
                    {
                        if(isPostback)
                            defaultVisibility = togglerStatus(togglerObj[0].id);
                        else                            
                        defaultVisibility = togglerObj.closest(&#39;table&#39;).attr(&#39;defaultVisibility&#39;);
                    }
                    else
                    {
                        togglerObj = $(this);
                    }

                    var mainDiv = togglerObj.closest(&#39;div[formdesignername]&#39;);
                    var gridTable = $(&#39;table:nth-child(2)&#39;,$(mainDiv));
                    var currentVisibility = ($(gridTable).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);

                    if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                    {
                        gridTable.toggle();
                        if($(gridTable).css(&#39;display&#39;) == &#39;none&#39;)
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPPlus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;collapsed&#39;);
                        }
                        else
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPMinus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;expanded&#39;);
                        }
                    }
                }

                function ShowHideCheckListGroup(eventDetails, togglerObj, isPostback)
                {
                    var defaultVisibility = undefined;
                    if(eventDetails == undefined &amp;&amp; togglerObj != undefined)
                    {
                        if(isPostback)
                            defaultVisibility = togglerStatus(togglerObj[0].id);
                        else                            
                        defaultVisibility = togglerObj.closest(&#39;table&#39;).attr(&#39;defaultVisibility&#39;);
                    }
                    else
                    {
                        togglerObj = $(this);
                    }

                    var mainDiv = togglerObj.closest(&#39;div[formdesignername]&#39;);
                    var gridTable = $(&#39;table:nth-child(2)&#39;,$(mainDiv));
                    var currentVisibility = ($(gridTable).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);

                    if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                    {
                        gridTable.toggle();
                        if($(gridTable).css(&#39;display&#39;) == &#39;none&#39;)
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPPlus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;collapsed&#39;);
                        }
                        else
                        {
                            togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPMinus.GIF&#39;);
                            togglerStatus(togglerObj[0].id, &#39;expanded&#39;);
                        }
                    }
                }

                function ShowHideHTMLSection(eventDetails, togglerObj, isPostback)
                {
                    var defaultVisibility = undefined;
                    if(eventDetails == undefined &amp;&amp; togglerObj != undefined)
                    {
                        if(isPostback)
                            defaultVisibility = togglerStatus(togglerObj[0].id);
                        else                            
                        defaultVisibility = togglerObj.closest(&#39;table&#39;).attr(&#39;defaultVisibility&#39;);
                    }
                    else
                    {
                        togglerObj = $(this);
                    }

                    // Flag that will be used to change the toggler&#39;s image(+/-)
                    var toggleStatus = &#39;unchanged&#39;;

                    // Find the first div above and toggle all tables and divs in it except the first two
                    var mainDiv = togglerObj.closest(&#39;div&#39;);
                    var divChildren = mainDiv.children();
                    for(var i = 2; i &lt; divChildren.length; i++)
                    {
                        var currentChild = $(divChildren)[i];

                        var currentVisibility = ($(currentChild).css(&#39;display&#39;) == &#39;none&#39; ? &#39;collapsed&#39; : &#39;expanded&#39;);
                        if(defaultVisibility == undefined || defaultVisibility != currentVisibility)
                        {
                            $(currentChild).toggle();
                            if(toggleStatus == &#39;unchanged&#39;)
                            {
                                if($(currentChild).css(&#39;display&#39;) == &#39;none&#39;)
                                    toggleStatus = &#39;collapsed&#39;;
                                else
                                    toggleStatus = &#39;expanded&#39;;
                            }
                        }
                    }

                    if(toggleStatus == &#39;collapsed&#39;)
                    {
                        togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPPlus.GIF&#39;);
                        togglerStatus(togglerObj[0].id, &#39;collapsed&#39;);
                    }
                    else if(toggleStatus == &#39;expanded&#39;)
                    {
                        togglerObj.find(&#39;img&#39;).attr(&#39;src&#39;,&#39;../../Images/ig_treeXPMinus.GIF&#39;);
                        togglerStatus(togglerObj[0].id, &#39;expanded&#39;);
                    }
                }
            &quot;);

            Script.Append(@&quot;
                function togglerStatus(togglerId, newStatus)
                {
                    var consTogglerStatuses = JSON.parse($.cookie(&#39;togglerStatuses&#39;) || &#39;{}&#39;);
                    var XMLFormId = GetQueryStringParams(&#39;Context&#39;);
                    var formTogglerStatuses = consTogglerStatuses[XMLFormId] || new Object();

                    if(newStatus)
                    {
                        formTogglerStatuses[togglerId] = newStatus;
                        consTogglerStatuses[XMLFormId] = formTogglerStatuses;
                        $.cookie(&#39;togglerStatuses&#39;, JSON.stringify(consTogglerStatuses), { path: &#39;/&#39; });
                        return null;
                }
                    else
                    {
                        return formTogglerStatuses[togglerId] || &#39;expanded&#39;;
                    }
                }
            &quot;);

            Script.Append(@&quot;
                $(document).ready(function(){
                    &quot;);

            Script.Append(&quot;var isPostBack = &quot; + page.IsPostBack.ToString().ToLower() + &quot;;&quot;);

            Script.Append(@&quot;
                    var togglerIndex = 1;
                    $(&#39;table.Section_ContainerCaption &gt;&gt; tr&#39;)
                        .prepend(function() {
                            return &#39;&lt;td width=&quot;&quot;20px&quot;&quot;&gt;&lt;span class=&quot;&quot;SectionToggler&quot;&quot; id=&quot;&quot;toggler&#39; + togglerIndex++ + &#39;&quot;&quot;&gt;&lt;a href=&quot;&quot;#&quot;&quot;  aria-expanded = &quot;&quot;true&quot;&quot; role = &quot;&quot;button&quot;&quot;\&gt;\&lt;img src=&quot;&quot;../../Images/ig_treeXPMinus.GIF&quot;&quot; alt=&quot;&quot;collapse&quot;&quot;\&gt;\&lt;/img&gt;&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&#39;
                        });
                    $(&#39;span.SectionToggler&#39;).each(function() {
                        ShowHideSectionWithTitle(undefined, $(this), isPostBack);
                        $(this).click(ShowHideSectionWithTitle);
                    });

                    $(&#39;table.DynamicGrid_ContainerCaption &gt;&gt; tr&#39;)
                        .prepend(function() {
                            return &#39;&lt;td width=&quot;&quot;20px&quot;&quot;&gt;&lt;span class=&quot;&quot;DynamicGridToggler&quot;&quot; id=&quot;&quot;toggler&#39; + togglerIndex++ + &#39;&quot;&quot;&gt;&lt;img src=&quot;&quot;../../Images/ig_treeXPMinus.GIF&quot;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#39;
                        });
                    $(&#39;span.DynamicGridToggler&#39;).each(function() {
                        ShowHideDynamicGrid(undefined, $(this), isPostBack);
                        $(this).click(ShowHideDynamicGrid);
                    });

                    $(&#39;table.StaticGrid_ContainerCaption &gt;&gt; tr&#39;)
                        .prepend(function() {
                            return &#39;&lt;td width=&quot;&quot;20px&quot;&quot;&gt;&lt;span class=&quot;&quot;StaticGridToggler&quot;&quot; id=&quot;&quot;toggler&#39; + togglerIndex++ + &#39;&quot;&quot;&gt;&lt;img src=&quot;&quot;../../Images/ig_treeXPMinus.GIF&quot;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#39;
                        });
                    $(&#39;span.StaticGridToggler&#39;).each(function() {
                        ShowHideStaticGrid(undefined, $(this), isPostBack);
                        $(this).click(ShowHideStaticGrid);
                    });

                    $(&#39;table.CheckListGroup_ContainerCaption &gt;&gt; tr&#39;)
                        .prepend(function() {
                            return &#39;&lt;td width=&quot;&quot;20px&quot;&quot;&gt;&lt;span class=&quot;&quot;CheckListGroupToggler&quot;&quot; id=&quot;&quot;toggler&#39; + togglerIndex++ + &#39;&quot;&quot;&gt;&lt;img src=&quot;&quot;../../Images/ig_treeXPMinus.GIF&quot;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#39;
                        });
                    $(&#39;span.CheckListGroupToggler&#39;).each(function() {
                        ShowHideCheckListGroup(undefined, $(this), isPostBack);
                        $(this).click(ShowHideCheckListGroup);
                    });

                    $(&#39;table.HTMLSection_ContainerCaption &gt;&gt; tr&#39;)
                        .prepend(function() {
                            return &#39;&lt;td width=&quot;&quot;20px&quot;&quot;&gt;&lt;span class=&quot;&quot;HTMLSectionToggler&quot;&quot; id=&quot;&quot;toggler&#39; + togglerIndex++ + &#39;&quot;&quot;&gt;&lt;img src=&quot;&quot;../../Images/ig_treeXPMinus.GIF&quot;&quot;&gt;&lt;/span&gt;&lt;/td&gt;&#39;
                        });
                    $(&#39;span.HTMLSectionToggler&#39;).each(function() {
                        ShowHideHTMLSection(undefined, $(this), isPostBack);
                        $(this).click(ShowHideHTMLSection);
                    });
                                      
                     $(&#39;div[HelpToolTip]&#39;).kendoTooltip({
                            showOn: &#39;click&#39;,
                            filter: &#39;a&#39;,
                            content: {
                                url: &#39;/api/gettooltip&#39;
                            },
                          
                           
                            //content: kendo.template($(&#39;#template&#39;).html()),
                            position: &#39;right&#39;,
                            width: &#39;initial&#39;,
                            height : &#39;auto&#39;,
                            
                            animation: {
                                close: { effects: &#39;fadeOut zoom:out&#39;, duration: 300 },
                                open: { effects: &#39;fadeIn zoom:in&#39;, duration: 300 }
                                    },
                            
                            show: function(e){
                                   this.popup.wrapper.width(&#39;500px&#39;);
                                   this.popup.wrapper.css(&#39;padding-bottom&#39;, &#39;0px&#39;);
                                   this.popup.wrapper.css(&#39;padding-top&#39;, &#39;0px&#39;);
                            },
                            autoHide: false,
                            requestStart: function (e) {
                                var XMLFormId = GetQueryStringParams(&#39;Context&#39;);
                                var PID = GetQueryStringParams(&#39;PID&#39;);
                                var ParentID = GetQueryStringParams(&#39;ParentID&#39;);
                                e.options.url = &#39;/api/GetToolTip?moduleId=&#39; + XMLFormId + &#39;&amp;controlName=&#39; + $(e.target).attr(&#39;controlReference&#39;) +&#39;&amp;pid=&#39; +PID+&#39;&amp;parentId=&#39; +ParentID;
                                //e.options.url = &#39;/api/GetToolTip?moduleId=&#39; + XMLFormId + &#39;&amp;controlName=&#39; + $(e.target).attr(&#39;controlReference&#39;);
                                //e.options.url = &#39;/api/GetToolTip?moduleId=&#39; + XMLFormId + &#39;&amp;controlName=&#39; + $(e.target).attr(&#39;controlReference&#39;) +&#39;&amp;PID=&#39; +PID+&#39;&amp;ParentID=&#39; +ParentID;
                            }

                       });
                   
                 });
            &quot;);

            // register the startup script for all java script.  Currently all java script is inserted in one big StringBuilder.
            if (!page.ClientScript.IsStartupScriptRegistered(&quot;Form_Injected_script&quot;))
                page.ClientScript.RegisterStartupScript(GetType(), &quot;Form_Injected_script&quot;, Script.ToString(), true);

            // TODO: move this peice of code to BRIXForm.aspx
            // This will raise error when getting called for an xmlcontrol -- this peice should get out of here.);
            try
            {
                var sb = new StringBuilder();
                sb.Append(&quot;&lt;script language=\&quot;javascript\&quot; type=\&quot;text/javascript\&quot;&gt;&quot;);
                sb.Append(&quot;function XMLFormSendServerRequest(arguments,context){&quot;);
                sb.Append(&quot;try{ pendingServerReqs = pendingServerReqs +1; EnableDisableSaveButton(); ShowLoadingOnRequest(); }catch(ex){ }&quot;);
                sb.Append(page.ClientScript.GetCallbackEventReference(page, &quot;arguments&quot;, &quot;XMLFormHandleServerResponse&quot;,
                    &quot;context&quot;, true));
                sb.Append(&quot;}&quot;);
                sb.Append(&quot;&lt;/script&gt;&quot;);
                page.ClientScript.RegisterStartupScript(GetType(), &quot;BRIXFormCallBackScript&quot;, sb.ToString2());
                page.ClientScript.RegisterClientScriptInclude(&quot;JSONFile&quot;, page.ResolveClientUrl(&quot;~/Scripts/json2.js&quot;));
            }
            catch
            {
            }
        }

        private String InjectControlScripts()
        {
            var Script = new StringBuilder();
            model.form.ProcessAllControlsDeeply(ctrl =&gt; Script.Append(CheckSingleControlForScript(ctrl)));
            return (Script.ToString());
        }

        private String CheckSingleControlForScript(X.xControl xctrl)
        {
            var s = new StringBuilder();

            bool enableScript = false, visibleScript = false;
            if (!string.IsNullOrEmpty(xctrl.EnableIf))
                enableScript = true;

            if (!string.IsNullOrEmpty(xctrl.VisibleIf))
                visibleScript = true;

            if (visibleScript)
                s.Append(InjectEnableOrVisibleScript(xctrl, true));

            if (enableScript)
                s.Append(InjectEnableOrVisibleScript(xctrl, false));

            if (xctrl.Type == X.ControlType.MultiPicker)
                s.Append(InjectMultiPickerScript(xctrl));

            return (s.ToString());
        }

        private String InjectMultiPickerScript(X.xControl xctrl)
        {
            if (xctrl.ControlReference.Count &gt; 0)
            {
                var c = xctrl.ControlReference[0] as HtmlGenericControl;
                var t = c.Controls[0] as HtmlTable;
                Button btnadd = t.Rows[0].Cells[1].Controls[0] as Button,
                    btnrem = t.Rows[0].Cells[1].Controls[1] as Button;
                ListBox lbleft = t.Rows[0].Cells[0].Controls[0] as ListBox,
                    lbright = t.Rows[0].Cells[2].Controls[0] as ListBox;
                var hdn = t.Rows[0].Cells[1].Controls[2] as HiddenField;

                btnadd.OnClientClick = &quot;javascript:return DoMultiMove( $(&#39;#&quot; + lbleft.ClientID + &quot;&#39;), $(&#39;#&quot; +
                                       lbright.ClientID +
                                       &quot;&#39;), $(&#39;#&quot; + hdn.ClientID + &quot;&#39;), $(&#39;#&quot; + lbright.ClientID + &quot;&#39;));&quot;;
                btnrem.OnClientClick = &quot;javascript:return DoMultiMove( $(&#39;#&quot; + lbright.ClientID + &quot;&#39;), $(&#39;#&quot; +
                                       lbleft.ClientID +
                                       &quot;&#39;), $(&#39;#&quot; + hdn.ClientID + &quot;&#39;), $(&#39;#&quot; + lbright.ClientID + &quot;&#39;));&quot;;

                var doMultiMove = new StringBuilder();

                doMultiMove.Append(&quot;function DoMultiMove(lbFrom, lbTo, hdn, lbFinal) {\n&quot;);
                doMultiMove.Append(&quot;      $(&#39;option:selected&#39;, $(lbFrom)).appendTo(&#39;#&#39;+ $(lbTo).attr(&#39;id&#39;));\n&quot;);
                doMultiMove.Append(&quot;      var values = &#39;&#39;;\n&quot;);
                doMultiMove.Append(&quot;      $(&#39;option&#39;,$(lbFinal)).each(function(){\n&quot;);
                doMultiMove.Append(&quot;        values += $(this).val() + &#39;,&#39;;\n&quot;);
                doMultiMove.Append(&quot;      });\n&quot;);
                doMultiMove.Append(&quot;      if(values != &#39;&#39;)\n&quot;);
                doMultiMove.Append(&quot;        values = values.substr(0,values.length-1); \n&quot;);
                doMultiMove.Append(&quot;      $(hdn).val(values);\n&quot;);
                doMultiMove.Append(&quot;      return (false);\n&quot;);
                doMultiMove.Append(&quot;}\n&quot;);

                return (doMultiMove.ToString());
            }
            return &quot;&quot;;
        }

        private String InjectEnableOrVisibleScript(X.xControl xctrl, bool visibleScript)
        {
            var sb = new StringBuilder();

            // ============================== SET THESE VARIABLES TO BE UNIQUE ON THE PAGE AS THEY ARE 
            //CONTROLLER --- controller
            //CONTROLLED --  xctrl
            //CONDITION ---  info.Split(&quot;=&quot;.ToCharArray())[1]

            // IF THE CONTROLLER IS DROPDOWN USE EVENT ONCHANGE (NOT ONCLICK) -EVENT BASED ON CONTROLLER TYPE

            string info = visibleScript ? xctrl.VisibleIf : xctrl.EnableIf;
            X.xControl controller = null;
            if (info.Contains(&quot;;&quot;))
            {
                controller = GetControl(info.Split(&quot;;&quot;.ToCharArray())[0].Trim(&quot;$&quot;.ToCharArray()));
            }
            else controller = GetControl(info.Split(&quot;=&quot;.ToCharArray())[0].Trim(&quot;$&quot;.ToCharArray()));

            bool isDynamicGrid = (xctrl.ParentObject is X.DynamicGrid);

            List&lt;string&gt; functions = new List&lt;string&gt;();
            String strOperator = string.Empty;
            String strCondVar = string.Empty;
            String strCondVal = string.Empty;
            if (info.Contains(&quot;;&quot;))
            {
                strCondVar = info.Split(&quot;;&quot;.ToCharArray())[0];
                strOperator = info.Split(&quot;;&quot;.ToCharArray())[1];
                strCondVal = info.Split(&quot;;&quot;.ToCharArray())[2] == &quot;&#39;&#39;&quot; ? string.Empty : info.Split(&quot;;&quot;.ToCharArray())[2];
            }
            else if (info.Contains(&quot;=&quot;))
            {
                strOperator = &quot;==&quot;;
                strCondVal = info.Split(&quot;=&quot;.ToCharArray())[1] == &quot;&#39;&#39;&quot; ? string.Empty : info.Split(&quot;=&quot;.ToCharArray())[1];
            }

            string variableNamePrefix = visibleScript ? &quot;VS_&quot; : &quot;ES_&quot;;

            if (controller.Type == X.ControlType.RadioButtonList || controller.Type == X.ControlType.DropDownList
                || xctrl.Type == X.ControlType.RadioButtonList || xctrl.Type == X.ControlType.DropDownList ||
                xctrl.Type == X.ControlType.Numeric)
            {
                if (xctrl.form.engine.IsNewMode || xctrl.form.engine.Mode.Equals(&quot;New&quot;, StringComparison.InvariantCultureIgnoreCase) || (xctrl.form.engine.IsEditMode &amp;&amp; xctrl.EditMode == X.EditMode.Edit))
                {
                    if (xctrl.Type == X.ControlType.Numeric || xctrl.Type == X.ControlType.TimeInput)
                    {
                        sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =$(&#39;input[clntid = \&quot;&quot; +
                                  (xctrl.ControlReference[0] as Control).ClientID + &quot;\&quot;]&#39;);&quot;);
                    }

                    else if (xctrl.Type == X.ControlType.RadioButtonList)
                    {
                        sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =$(&#39;#&quot; +
                                  (xctrl.ControlReference[0] as Control).ClientID + &quot; input:radio&#39;);&quot;);
                    }
                    else
                    {
                        sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =$(&#39;#&quot; +
                                  (xctrl.ControlReference[0] as Control).ClientID + &quot;&#39;);&quot;);
                    }

                    sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot; =$(&#39;#&quot; +
                              (controller.ControlReference[0] as Control).ClientID + &quot;&#39;);&quot;);
                    if (visibleScript)
                        sb.Append(&quot;&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot;=$(&quot; + variableNamePrefix +
                                  &quot;controlled_&quot; + xctrl.Name + &quot;).closest(&#39;table&#39;);&quot;);

                    if (controller.Type == X.ControlType.RadioButtonList)
                        sb.Append(&quot;$(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).bind(&#39;click&#39;,f1_&quot; +
                                  variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;);&quot;);
                    else
                        sb.Append(&quot;$(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).bind(&#39;change&#39;,f1_&quot; +
                                  variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;);&quot;);

                    sb.Append(&quot;function f1_&quot; + variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;(){&quot;);
                    sb.Append(&quot;var result=false;if($(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name +
                              &quot;).is(&#39;input&#39;) || $(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name +
                              &quot;).is(&#39;select&#39;)){ if($(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).val()&quot;);
                    sb.Append(strOperator);
                    //sb.Append(&quot;&#39;&quot; + strCondVal + &quot;&#39;)result=true;}else {var array = $(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).children(&#39;input&#39;);for(var i=0;i&lt;array.length;i++)if(array[i].value&quot;);
                    //Akila - Reading the Child Controls correctly
                    sb.Append(&quot;&#39;&quot; + strCondVal + &quot;&#39;)result=true;}else {var array = $(&#39;input&#39;,$(&quot; + variableNamePrefix +
                              &quot;controller_&quot; + xctrl.Name + &quot;));for(var i=0;i&lt;array.length;i++)if(array[i].value&quot;);
                    sb.Append(strOperator);
                    sb.Append(&quot;&#39;&quot; + strCondVal + &quot;&#39; &amp;&amp; array[i].checked==true)result=true;}&quot;);
                    sb.Append(&quot;if(result)&quot;);
                    InjectVisibleEnableScript(xctrl.Name, visibleScript, sb, variableNamePrefix);
                    sb.Append(&quot;} \r\n&quot;);
                    if (!isDynamicGrid)
                    {
                        if (controller.Type == X.ControlType.RadioButtonList)
                            sb.AppendFormat(&quot;&quot; + variableNamePrefix + &quot;controller_{0}.click();&quot;, xctrl.Name);
                        else
                            sb.AppendFormat(&quot;&quot; + variableNamePrefix + &quot;controller_{0}.change();&quot;, xctrl.Name);
                    }
                    else
                        functions.Add(&quot;&#39;f1_&quot; + variableNamePrefix + &quot;{0}&#39;&quot;.Format2(xctrl.Name));
                }
                else
                {
                    //Read the _Value label and put it in one variable
                    //match the value
                    //Hide the correspoding controls.
                    string controlledName = string.Empty;
                    if (xctrl.Type == X.ControlType.DropDownList || xctrl.Type == X.ControlType.RadioButtonList ||
                        xctrl.Type == X.ControlType.Numeric) //xctrl.Type == ControlType.Date || 
                        controlledName = xctrl.Name + &quot;_Text&quot;;
                    else
                        controlledName = xctrl.Name;

                    sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName + &quot; = $(&#39;#&quot; +
                              (xctrl.ControlReference[0] as Control).ClientID +
                              (controlledName.Contains(&quot;_Text&quot;) ? &quot;_Text&quot; : &quot;&quot;) + &quot;&#39;);&quot;);

                    sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controller_&quot; + controlledName + &quot; = $(&#39;#&quot; +
                              (controller.ControlReference[0] as Control).ClientID +
                              ((controller.Type == X.ControlType.RadioButtonList ||
                                controller.Type == X.ControlType.DropDownList)
                                  ? &quot;_Value&quot;
                                  : ((controller.Type == X.ControlType.Date || controller.Type == X.ControlType.Numeric)
                                      ? &quot;_Text&quot;
                                      : &quot;&quot;)) + &quot;&#39;);&quot;);

                    if (visibleScript)
                        sb.Append(&quot;if($(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).parent().length &gt; 0 &amp;&amp; $(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).parent().get(0).tagName!=&#39;TABLE&#39;)&quot; + variableNamePrefix + &quot;controlled_&quot; +
                                  controlledName +
                                  &quot;=$(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).parents(&#39;TABLE:first&#39;);&quot;);

                    sb.Append(&quot;function f1_&quot; + variableNamePrefix + &quot;&quot; + controlledName + &quot;(){ &quot;);
                    sb.Append(&quot;if($(&quot; + variableNamePrefix + &quot;controller_&quot; + controlledName + &quot;).html() &quot; + strOperator +
                              &quot;&#39;&quot; + strCondVal + &quot;&#39; || $(&quot; + variableNamePrefix + &quot;controller_&quot; + controlledName +
                              &quot;).val() &quot; + strOperator + &quot;&#39;&quot; + strCondVal + &quot;&#39;)&quot;);

                    if (visibleScript)
                    {
                        sb.Append(&quot;{$(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).css(&#39;display&#39;,&#39;inline&#39;);}&quot;);
                        sb.Append(&quot;else {$(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).css(&#39;display&#39;,&#39;none&#39;);}&quot;);
                    }
                    else
                    {
                        sb.Append(&quot;{ $(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).attr(&#39;disabled&#39;,&#39;&#39;);} &quot;);
                        sb.Append(&quot;else {$(&quot; + variableNamePrefix + &quot;controlled_&quot; + controlledName +
                                  &quot;).attr(&#39;disabled&#39;,&#39;disabled&#39;);}&quot;);
                    }

                    sb.Append(&quot;} \r\n&quot;);
                    if (!isDynamicGrid)
                        sb.AppendFormat(&quot;f1_&quot; + variableNamePrefix + &quot;{0}();&quot;, controlledName);
                    else
                        functions.Add(&quot;&#39;f1_&quot; + variableNamePrefix + &quot;{0}&#39;&quot;.Format2(xctrl.Name));
                }
            }
            else if (
                controller.Type == X.ControlType.TextBox || controller.Type == X.ControlType.TextArea)
            {
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (xctrl.ControlReference[0] as WebControl).ClientID + &quot;&#39;);&quot;);
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (controller.ControlReference[0] as WebControl).ClientID + &quot;&#39;);&quot;);
                if (visibleScript)
                    sb.Append(&quot;while(&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;.parentNode.tagName!=&#39;TABLE&#39;)&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;=&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot;.parentNode;&quot;);
                sb.Append(&quot;$(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).bind(&#39;blur&#39;,f1_&quot; +
                          variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;);function f1_&quot; + variableNamePrefix + &quot;&quot; +
                          xctrl.Name + &quot;(){&quot;);
                sb.Append(&quot;if(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;.value &quot; + strOperator + &quot;&#39;&quot; +
                          strCondVal + &quot;&#39;)&quot;);
                InjectVisibleEnableScript(xctrl.Name, visibleScript, sb, variableNamePrefix);

                sb.Append(&quot;} \r\n&quot;);
                if (!isDynamicGrid)
                    sb.AppendFormat(
                        &quot;try{{&quot; + variableNamePrefix + &quot;controller_{0}}}catch(e){{}}.focus();try{{&quot; + variableNamePrefix +
                        &quot;controller_{0}.blur();}}catch(e){{}}&quot;, xctrl.Name);
                else
                    functions.Add(&quot;&#39;f1_&quot; + variableNamePrefix + &quot;{0}&#39;&quot;.Format2(xctrl.Name));
            }
            else if (controller.Type == X.ControlType.CheckBox)
            {
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (xctrl.ControlReference[0] as WebControl).ClientID + &quot;&#39;);&quot;);
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (((controller.ControlReference[0] as Panel).Controls[0] as WebControl).ClientID + &quot;&#39;);&quot;));
                if (visibleScript)
                    sb.Append(&quot;while(&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;.parentNode.tagName!=&#39;TABLE&#39;)&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;=&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot;.parentNode;&quot;);
                sb.Append(&quot;$(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).bind(&#39;change&#39;,f1_&quot; +
                          variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;);function f1_&quot; + variableNamePrefix + &quot;&quot; +
                          xctrl.Name + &quot;(){&quot;);
                sb.Append(&quot;if(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;.checked==&quot; +
                          info.Split(&quot;=&quot;.ToCharArray())[1] + &quot;)&quot;);
                InjectVisibleEnableScript(xctrl.Name, visibleScript, sb, variableNamePrefix);

                sb.Append(&quot;} \r\n&quot;);

                if (!isDynamicGrid)
                    //sb.AppendFormat(&quot;try{{&quot; + variableNamePrefix + &quot;controller_{0}.focus();}}catch(e){{}}try{{&quot; + variableNamePrefix + &quot;controller_{0}.blur();}}catch(e){{}}&quot;, xctrl.Name);
                    //Enable if and visible if is not working in case of checkbox
                    sb.AppendFormat(&quot;f1_&quot; + variableNamePrefix + &quot;{0}();&quot;.Format2(xctrl.Name));
                else
                    functions.Add(&quot;&#39;f1_&quot; + variableNamePrefix + &quot;{0}&#39;&quot;.Format2(xctrl.Name));
            }
            else
            {
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (xctrl.ControlReference[0] as WebControl).ClientID + &quot;&#39;);&quot;);
                sb.Append(&quot;var &quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot; =document.getElementById(&#39;&quot; +
                          (controller.ControlReference[0] as WebControl).ClientID + &quot;&#39;);&quot;);
                if (visibleScript)
                    sb.Append(&quot;while(&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;.parentNode.tagName!=&#39;TABLE&#39;)&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name +
                              &quot;=&quot; + variableNamePrefix + &quot;controlled_&quot; + xctrl.Name + &quot;.parentNode;&quot;);
                sb.Append(&quot;$(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;).bind(&#39;click&#39;,f1_&quot; +
                          variableNamePrefix + &quot;&quot; + xctrl.Name + &quot;);function f1_&quot; + variableNamePrefix + &quot;&quot; +
                          xctrl.Name + &quot;(){&quot;);
                //sb.Append(&quot;if(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;.value==&#39;&quot; + info.Split(&quot;=&quot;.ToCharArray())[1] + &quot;&#39;)&quot;);
                sb.Append(&quot;if(&quot; + variableNamePrefix + &quot;controller_&quot; + xctrl.Name + &quot;.value&quot; + strOperator + &quot;&#39;&quot; +
                          strCondVal + &quot;&#39;)&quot;);

                InjectVisibleEnableScript(xctrl.Name, visibleScript, sb, variableNamePrefix);

                sb.Append(&quot;} \r\n&quot;);
                if (!isDynamicGrid)
                    sb.AppendFormat(&quot;&quot; + variableNamePrefix + &quot;controller_{0}.click();&quot;, xctrl.Name);
                else
                    functions.Add(&quot;&#39;f1_&quot; + variableNamePrefix + &quot;{0}&#39;&quot;.Format2(xctrl.Name));
            }

            if (isDynamicGrid)
            {
                sb.AppendFormat(
                    &quot;if (typeof(VisibleEnableFunctions) === &#39;undefined&#39;) var VisibleEnableFunctions = new Array();&quot;);
                sb.AppendFormat(&quot;VisibleEnableFunctions.push({0});&quot;, string.Join(&quot;,&quot;, functions.ToArray()));

                if ((xctrl.ParentObject as X.DynamicGrid).AllowInlineEdit)
                {
                    sb.Append(
                        &quot;if (typeof VisibleEnableFunctions != &#39;undefined&#39;) $(VisibleEnableFunctions).each(EvaluateFunctions);&quot;);
                }
            }

            return (sb.ToString());
        }

        private static void InjectVisibleEnableScript(string name, bool visibleScript, StringBuilder sb,
            string variableNamePrefix)
        {
            if (visibleScript)
            {
                sb.Append(&quot;{ &quot;);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).css(&#39;display&#39;,&#39;inline&#39;); &quot;, name);
                sb.Append(&quot;} &quot;);
                sb.Append(&quot;else {&quot;);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).css(&#39;display&#39;,&#39;none&#39;);&quot;, name);
                sb.Append(&quot;}&quot;);
            }
            else
            {
                sb.Append(&quot;{  &quot;);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).removeAttr(&#39;disabled&#39;); &quot;, name);
                sb.Append(&quot;} &quot;);
                sb.Append(&quot;else {&quot;);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).attr(&#39;disabled&#39;,&#39;disabled&#39;);&quot;, name);
                sb.AppendFormat(&quot;if($(&quot; + variableNamePrefix + &quot;controlled_{0}).prop(&#39;type&#39;)==&#39;radio&#39;)&quot;, name);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).prop(&#39;checked&#39;,false);&quot;, name);
                sb.Append(&quot; else &quot;);
                sb.AppendFormat(&quot;$(&quot; + variableNamePrefix + &quot;controlled_{0}).val(&#39;&#39;);&quot;, name);
                sb.Append(&quot;}&quot;);
            }
        }

        #region CLIENT FORMULAE EVALUATION

        private string InjectDestinations()
        {
            var Save = new DestinationList();

            // Prepareing list of destinations (targets) and their source controls
            model.form.ProcessAllControlsDeeply(ctrl =&gt;
            {
                if (
                    (
                        (!string.IsNullOrEmpty(ctrl.Value) &amp;&amp;
                         (
                             ctrl.Value.ToLower2().Contains(X.xControl.FORMULAPREFIX.ToLower2())
                             ||
                             ctrl.Value.StartsWith(&quot;{_DB:&quot;,
                                 StringComparison.
                                     InvariantCultureIgnoreCase)
                             )
                            )
                        ||
                        (ctrl.DataSource != null &amp;&amp;
                         (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;)))
                        // means this datasource depends on a control and should be updated on client side change of the source
                        )
                    &amp;&amp; !Save.Destinations.Any(dest =&gt; dest.Name == ctrl.Name))
                {
                    var dest = new Destination();
                    dest.Name = ctrl.Name;
                    //todo: Make this control readonly

                    X.xControl temp = GetControl(ctrl.Name);
                    if (temp.ControlReference.Count &gt; 0)
                    {
                        dest.ID =
                            (GetControl(ctrl.Name).ControlReference[0] as WebControl)
                                .ClientID;
                        //(GetControl(ctrl.Name).ControlReference[0] as WebControl).Enabled = false; // disabled controls are not posted back to the server.
                        if (ctrl.ReadOnly)
                        {
                            (GetControl(ctrl.Name).ControlReference[0] as WebControl).Attributes.Add(&quot;Readonly&quot;, &quot;true&quot;);
                            (GetControl(ctrl.Name).ControlReference[0] as WebControl).Attributes.Add(&quot;onkeydown&quot;,
                                &quot;if(event.keyCode==8){event.cancelBubble = true;event.returnValue = false;}&quot;);
                        }
                        //if (ctrl.Type == ControlType.Numeric || ctrl.Type == ControlType.Integer)
                        if (ctrl.Type == X.ControlType.Numeric)
                            dest.Type = &quot;Numeric&quot;;
                        else if (ctrl.Type == X.ControlType.DropDownList || ctrl.Type == X.ControlType.Listbox)
                            dest.Type = &quot;Select&quot;;
                        else if (ctrl.Type == X.ControlType.Date)
                        {
                            dest.Type = &quot;Date&quot;;
                            if ((GetControl(ctrl.Name).ControlReference[0] as WebControl).Controls.Count &gt; 0)
                                dest.ID =
                                    ((GetControl(ctrl.Name).ControlReference[0] as WebControl).Controls[0] as WebControl)
                                        .ID;
                        }
                        else if (ctrl.Type == X.ControlType.Link)
                            dest.Type = &quot;Link&quot;;
                        else if (ctrl.Type == X.ControlType.Display)
                            dest.Type = &quot;Display&quot;;
                        else
                            dest.Type = &quot;Text&quot;;
                        dest.Sources = new List&lt;Source&gt;();
                        if (!string.IsNullOrEmpty(ctrl.Value))
                            ctrl.ParseFormulaToGetSources(ctrl.Value, dest.Sources,
                                null);
                        if (!string.IsNullOrEmpty(ctrl.DataSource))
                            ctrl.ParseFormulaToGetSources(ctrl.DataSource,
                                dest.Sources, null);
                        Save.Destinations.Add(dest);
                    }
                }
            });

            // Creating client side destinations array
            var sb = new StringBuilder();
            sb.Append(&quot;var destinations = [&quot;);
            Save.Destinations.ForEach(dest =&gt; sb.Append(CreateDestinationJSON(dest) + &quot;,&quot;));
            return sb.ToString().Trim(&quot;, &quot;.ToCharArray()) + &quot;]&quot;;
        }

        private string CreateDestinationJSON(Destination dest)
        {
            var sb = new StringBuilder();
            sb.Append(&quot;{\n&quot;);
            sb.Append(&quot;name:\&quot;&quot; + dest.Name + &quot;\&quot;\n&quot;);
            sb.Append(&quot;,id:\&quot;&quot; + dest.ID + &quot;\&quot;\n&quot;);
            sb.Append(&quot;,type:\&quot;&quot; + dest.Type + &quot;\&quot;\n&quot;);
            sb.Append(&quot;,value:\&quot;\&quot;\n&quot;);
            sb.Append(&quot;,sources:[&quot; + GetSourceList(dest) + &quot;]\n&quot;);
            sb.AppendFormat(
                @&quot;,dependsOn:function(sourceName){{
                        for(var i=0;i&lt;this.sources.length;i++)
                        {{
                            if(this.sources[i].id==sourceName)
                            return true;
                        }}
                        return false;
                        }}
                        ,setValue:function(value){{
                        if(this.type==&#39;Numeric&#39;)
                        {{
                            var retValue;
                            var  numericControl = igedit_getById(this.id);
                            if(numericControl)
                                numericControl.setValue(value);
                            else // Numeric Controls are rendered as labels in VIEW mode.                           
                                document.getElementById(this.id).innerHTML = value;
                        }}
                        else if(this.type==&#39;Select&#39;)
                        {{
                            var objSelect =document.getElementById(this.id);
                            for(var i=0;i&lt;objSelect.options.length;i++)
                            {{
                                if(objSelect.options[i].value==value)
                                {{ objSelect.selectedIndex=i;break; }}
                            }}
                        }}
                        else if(this.type==&#39;Date&#39;)
                        {{
                           var validdate = new Date(CheckDateFormat(value,&#39;{0}&#39;,false));
                           if (!isNaN(validdate) &amp;&amp; validdate != &#39;Invalid Date&#39;) 
                               igdrp_getComboById(this.id).setValue(validdate);
                        }}
                        else if(this.type==&#39;Link&#39;)
                        {{
                           document.getElementById(this.id).href=value;
                        }}
                        else if(this.type==&#39;Display&#39;)
                        {{
                            document.getElementById(this.id).innerHTML=value;
                        }}
                        else if(this.type==&#39;Text&#39;) 
                        {{
                            var ele =  document.getElementById(this.id)
                            ele.value=value;
                           
                            if(ele.getAttribute(&#39;readOnly&#39;) ==&#39;&#39; || ele.getAttribute(&#39;readOnly&#39;).toLowerCase() == &#39;true&#39;)
                           {{
                                var eleLbl = document.getElementById(this.id + &#39;_Text&#39;);
                                    if(eleLbl != null)
                                        eleLbl.innerHTML = JavascriptEncodeNew(value);
                            }}
                        }}
                        else 
                            document.getElementById(this.id).value=value;
                        }}
                        }}&quot;, AMP3ApplicationSettings.Instance.FORMAT_DATE);
            return sb.ToString();
        }

        private string GetSourceList(Destination dest)
        {
            var sb = new StringBuilder();
            dest.Sources.ForEach(src =&gt; sb.Append(GetSourceJSON(src) + &quot;,&quot;));
            return sb.ToString().Trim(&quot;,&quot;.ToCharArray());
        }

        private string GetSourceJSON(Source src)
        {
            var sb = new StringBuilder();
            sb.Append(&quot;{name:\&quot;&quot; + src.name + &quot;\&quot;,id:\&quot;&quot; + src.id + &quot;\&quot;,type:\&quot;&quot; + src.type + &quot;\&quot;,value:\&quot;\&quot;\n&quot;);
            sb.AppendFormat(
                @&quot; ,getValue:function(){{
                        if(this.type==&#39;Numeric&#39;)
                        {{
                            var retValue;
                            var  numericControl = igedit_getById(this.id);
                            if(numericControl)
                                retValue=  numericControl.getValue();
                            else // Numeric Controls are rendered as labels in VIEW mode.
                                retValue =  $(&#39;#&#39; + this.id + &#39;_Text&#39;).text(); 
                            return retValue;
                        }}
                        if(this.type==&#39;Date&#39;)
                        {{
                            var dateObject = igdrp_getComboById(this.id);
                            if(dateObject)
                                return CheckDateFormat(dateObject.getText(),&#39;{0}&#39;,true);
                            else 
                                return &quot;&quot;&quot;&quot;;
                        }}
                        if(this.type==&#39;Radio&#39;)
                         return $(&#39;#&#39; + this.id + &#39; input[type=radio]:checked&#39;).val();   
                        else
                           return document.getElementById(this.id).value;
                        }} }}&quot;, AMP3ApplicationSettings.Instance.FORMAT_DATE);
            return sb.ToString();
        }

        private X.xControl GetControl(string var)
        {
            return model.form.GetControl(var);
        }

        private class DestinationList
        {
            internal readonly List&lt;Destination&gt; Destinations;

            internal DestinationList()
            {
                Destinations = new List&lt;Destination&gt;();
            }
        }

        #endregion

        #region Container Renderer Functions

        private int ContainerIndex;

        private void SetUniqueContainerName(ref X.xControl c)
        {
            X.ControlContainer cc = c;

            SetUniqueContainerName(ref cc);
        }

        private void SetUniqueContainerName(ref X.ControlContainer c)
        {
            if (string.IsNullOrEmpty(c.Name))
            {
                string prefix = c.GetType().ToString();
                int lastdot = prefix.LastIndexOf(&#39;.&#39;);
                if (lastdot &gt;= 0)
                    prefix = prefix.Substring(lastdot + 1);

                c.Name = prefix + ContainerIndex;
                ContainerIndex++;
            }
        }

        private void SetControlID(HtmlGenericControl xc)
        {
            string controlname = xc.GetType().ToString();
        }

        private HtmlTableCell NewCell(Control obj)
        {
            var htc = new HtmlTableCell();
            htc.Controls.Add(obj);
            return htc;
        }

        public HtmlGenericControl RenderHelpdescription(X.ControlContainer ctrl)
        {
            var stagetitlediv = new HtmlGenericControl(&quot;div&quot;)
            {
                InnerHtml =
                    &quot;&lt;a href=&#39;#&#39; controlReference=&#39;&quot; + ctrl.Name + &quot;&#39;  &gt;&lt;img src=&#39;../../Images/HelpTooltip.png&#39; title=&#39;&quot; +
                    ctrl.ParseDynamicString(ctrl.HelpToolTip).Replace(&quot;&#39;&quot;, &quot;&amp;#39&quot;) + &quot;&#39;/&gt;&lt;/a&gt;&quot;
            };
            stagetitlediv.Attributes.Add(&quot;HelpToolTip&quot;, &quot;HelpToolTip&quot;);
            return stagetitlediv;
        }

        public Control RenderRowControl(X.xControl ctrl, object valueObj, Control holder, bool isDynamicGrid = false)
        {
            string validationGroup = &quot;Master&quot;;
            string _stage = string.Empty;

            bool hasRequiredValidation = false;

            if (!string.IsNullOrEmpty(ctrl.ValidateOnAction))
            {
                validationGroup = AssignValidationGroup(ctrl.ValidateOnAction, ctrl.form.engine.currentState);
                if (!validationGroup.Equals(&quot;Master&quot;))
                    hasRequiredValidation = true;
            }
            else
            {
                hasRequiredValidation = true;
            }

            if (isDynamicGrid)
            {
                validationGroup = ctrl.ParentObject.Name + &quot;_GridValidate&quot;;
            }

            var tbl = new HtmlTable();
            tbl.Attributes.Add(&quot;class&quot;, &quot;xmlFormRowControlTable&quot;);
            tbl.Attributes.Add(&quot;FormDesignerName&quot;, ctrl.Name);

            holder.Controls.Add(tbl);
            var tr = new HtmlTableRow();

            tbl.Rows.Add(tr);
            var htc1 = new HtmlTableCell();
            var htc2 = new HtmlTableCell();

            object objCtrl;

            if (String.IsNullOrEmpty(ctrl.Caption))
            {
                tr.Cells.Add(htc2);
                htc2.ColSpan = 2;

                objCtrl = ctrl.RenderSingleFormControl(valueObj, X.RenderFormat.RenderHtml);
                if (objCtrl != null) // KK: dont crash
                    htc2.Controls.Add(objCtrl as Control);
            }
            else
            {
                tr.Cells.Add(htc1);
                tr.Cells.Add(htc2);
                objCtrl = ctrl.RenderSingleFormControl(valueObj, X.RenderFormat.RenderHtml);
                if (objCtrl != null)
                {
                    htc2.Controls.Add(objCtrl as Control);
                    if (!string.IsNullOrEmpty(ctrl.HelpToolTip) || !string.IsNullOrEmpty(ctrl.HelpDescription))
                    {
                        htc2.Controls.Add(NewCell(RenderHelpdescription(ctrl)));
                    }
                }

                htc1.InnerHtml = ctrl.Caption == null ? ctrl.Name : ctrl.ParseDynamicString(ctrl.Caption);
                if (ctrl.ValidationTypes.Contains(X.ValidationType.Required))
                    htc1.InnerHtml += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                htc1.Style.Add(&quot;width&quot;, ctrl.form.ControlCaptionWidth);
                htc1.Attributes.Add(&quot;class&quot;, &quot;tdTextAlignRgt&quot;);

                //If it is a multi line control then align the label vertically on top. (other wise in view details mode the text and the label alignment does not seem correct.
                if (ctrl.Type.IsEqualToAny(X.ControlType.TextArea, X.ControlType.Listbox, X.ControlType.MultiPicker, X.ControlType.AttachmentControl))
                    htc1.Attributes.Add(&quot;valign&quot;, &quot;top&quot;);
            }

            //Adding the attributes to the control so that it can accessed in the javascript
            if (isDynamicGrid &amp;&amp; ctrl.Type == X.ControlType.AutoIncrement &amp;&amp; objCtrl != null)
            {
                X.AutoIncrement aiCtrl = (ctrl as X.AutoIncrement);
                (objCtrl as WebControl).Attributes.Add(&quot;AutoIncrement&quot;, &quot;true&quot;);
                (objCtrl as WebControl).Attributes.Add(&quot;Prefix&quot;, ctrl.ParseDynamicString(aiCtrl.Prefix));
                (objCtrl as WebControl).Attributes.Add(&quot;Suffix&quot;, ctrl.ParseDynamicString(aiCtrl.Suffix));
                var seed = model.form.engine.IsDesignMode
                    ? 1
                    : (aiCtrl.ScopeFilter != &quot;&quot;) ? GetMaxValue(aiCtrl, isDynamicGrid) : aiCtrl.Seed;
                (objCtrl as WebControl).Attributes.Add(&quot;Seed&quot;, seed.ToString());
                (objCtrl as WebControl).Attributes.Add(&quot;Interval&quot;, aiCtrl.Interval.ToString());
            }

            // YOU CAN CHECK FOR VALIDATION AND ADD IT IN THIRD CELL IF REQUIRED


            if (ctrl.ValidationTypes.Contains(X.ValidationType.Required) &amp;&amp; hasRequiredValidation)
            {
                var rfv = new RequiredFieldValidator();
                // string[] tempArr = (ctrl.ControlReference[0] as WebControl).ClientID.Split(&quot;_&quot;.ToCharArray());
                //(ctrl.ControlReference[0] as WebControl).ID = tempArr[tempArr.Length - 2];
                if (ctrl.Type == X.ControlType.DateTime)
                    rfv.ControlToValidate = ActualControlIdFormat.Format2(X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(ctrl).Name, ctrl.Name);
                else
                {
                    rfv.ControlToValidate = GetControlIdFormat(ctrl);
                }
                rfv.ValidationGroup = validationGroup;
                rfv.ErrorMessage = (model.form.ShowValidationSummary
                    ? GenerateValidationMessage(ctrl)
                    : &quot;Required!&quot;).Replace(&quot;:&quot;, &quot;&quot;);
                rfv.CssClass = &quot;required&quot;;
                if (model.form.ShowValidationSummary)
                    rfv.Display = ValidatorDisplay.None;
                else
                    rfv.Display = ValidatorDisplay.Dynamic;

                //If its a drop down list and its a required field then add Initial value so that select doesnt get saved.
                if (ctrl.Type == X.ControlType.DropDownList)
                    rfv.InitialValue = &quot;_DBNULL_&quot;;

                htc2.Controls.Add(NewCell(rfv));
            }

            if (ctrl.ValidationTypes.Contains(X.ValidationType.RegularExpression)
                || ctrl.ValidationTypes.Contains(X.ValidationType.Email)
                || ctrl.Type == X.ControlType.TimeInput
                )
            {
                if (isDynamicGrid)
                {
                    string ctrlId = GetControlIdFormat(ctrl);
                    var rev = AddRegularExpressionValidator(ctrl, validationGroup, ctrlId);
                    htc2.Controls.Add(NewCell(rev));
                }
                else
                {
                    string ctrlId = GetControlIdFormat(ctrl);
                    var rev = AddRegularExpressionValidator(ctrl, &quot;Master&quot;, ctrlId);
                    htc2.Controls.Add(NewCell(rev));
                }
            }

            if (ctrl.form.DesignMode)
                RenderBorderInDesignMode(tbl, false);


            return tbl;
        }

        private RegularExpressionValidator AddRegularExpressionValidator(X.xControl ctrl, string validationGroup,
            string controlToValidate)
        {
            var rev = new RegularExpressionValidator();

            rev.ControlToValidate = controlToValidate;
            rev.CssClass = &quot;required&quot;;
            rev.ValidationGroup = validationGroup;
            if (ctrl.ValidationTypes.Contains(X.ValidationType.Email))
            {
                rev.ErrorMessage = &quot;Invalid Email ID in &quot; +
                                   (string.IsNullOrEmpty(ctrl.Caption)
                                       ? ctrl.Name
                                       : model.form.ParseDynamicString(ctrl.Caption)).Replace(&quot;:&quot;, &quot;&quot;);
                rev.ValidationExpression = @&quot;^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$&quot;;
            }
            else if (ctrl.Type == X.ControlType.TimeInput)
            {
                rev.ErrorMessage = &quot;Invalid time (hh:mm) in &quot; +
                                   (string.IsNullOrEmpty(ctrl.Caption)
                                       ? ctrl.Name
                                       : model.form.ParseDynamicString(ctrl.Caption)).Replace(&quot;:&quot;, &quot;&quot;);
                rev.ValidationExpression = @&quot;([01]\d|2[0-3])[0-5]\d&quot;;
            }
            else
            {
                rev.Text = ctrl.ErrorMessage;
                rev.ValidationExpression = ctrl.ValidationExpression;
            }
            if (model.form.ShowValidationSummary)
                rev.Display = ValidatorDisplay.None;
            else
                rev.Display = ValidatorDisplay.Dynamic;
            return rev;
        }

        private BaseValidator AddRequiredFieldValidator(X.xControl ctrl, string validationGroup,
            string controlToValidate)
        {
            BaseValidator rfv = new RequiredFieldValidator();

            if (ctrl.Type == X.ControlType.CheckBoxList || ctrl.Type == X.ControlType.CheckBox)
                rfv = new RequiredFieldValidatorForCheckBoxLists();


            rfv.ControlToValidate = controlToValidate;
            rfv.ValidationGroup = validationGroup;
            rfv.ErrorMessage = (model.form.ShowValidationSummary
                ? GenerateValidationMessage(ctrl)
                : &quot;Required!&quot;).Replace(&quot;:&quot;, &quot;&quot;);
            rfv.CssClass = &quot;required&quot;;
            if (model.form.ShowValidationSummary)
                rfv.Display = ValidatorDisplay.None;
            else
                rfv.Display = ValidatorDisplay.Dynamic;

            //If its a drop down list and its a required field then add Initial value so that select doesnt get saved.
            if (ctrl.Type == X.ControlType.DropDownList)
                (rfv as RequiredFieldValidator).InitialValue = &quot;_DBNULL_&quot;;
            return rfv;
        }

        private string GenerateValidationMessage(X.xControl ctrl)
        {
            string message = (string.IsNullOrEmpty(ctrl.Caption)
                ? ctrl.Name
                : model.form.ParseDynamicString(ctrl.Caption));
            X.xTab tab = X.ControlContainer.GetParent&lt;X.xTab&gt;(ctrl);
            if (tab != null)
            {
                message = (string.IsNullOrEmpty(tab.Caption) ? tab.Name : model.form.ParseDynamicString(tab.Caption)) +
                          &quot; =&gt; &quot; + message;
            }
            return message;
        }


        // simpleExpression = &quot;string [_loc:string] string&quot;
        //public static string GetLocalisedCaption(string simpleExpression)
        //{
        //    try
        //    {
        //        if (simpleExpression.StartsWith(&quot;_loc:&quot;, StringComparison.CurrentCultureIgnoreCase))
        //        {
        //            simpleExpression = simpleExpression.Substring(&quot;_loc:&quot;.Length);
        //            return LocalizationManager.GetString(simpleExpression);
        //        }
        //        else
        //            return simpleExpression;
        //    }
        //    catch (Exception)
        //    {
        //        return simpleExpression;
        //    }
        //}


        private Control RenderCaption(string CaptionStyle, string caption, X.ContainerTypes containerType,
            X.ControlVisibility containerVisibility, X.ControlContainer ctrl)
        {
            string style = String.IsNullOrEmpty(CaptionStyle) ? &quot;margin-right:20px;margin-bottom:5px;&quot; : CaptionStyle;
            string classname = containerVisibility != X.ControlVisibility.None
                ? containerType + &quot;_ContainerCaption&quot;
                : &quot;&quot;;
            string defaultVisibilityAttribute = containerVisibility != X.ControlVisibility.None
                ? &quot;defaultVisibility=&#39;&quot; + containerVisibility.ToString().ToLower() + &quot;&#39; &quot;
                : &quot;&quot;;

            var SecCaption = new Literal();
            SecCaption.Text = &quot;&lt;table class=&#39;&quot; + classname + &quot;&#39; &quot; + defaultVisibilityAttribute +
                              &quot;border=&#39;0&#39; width=&#39;100%&#39; cellpadding=&#39;0&#39; cellspacing=&#39;0&#39; &quot;;
            SecCaption.Text += &quot;style=&#39;&quot; + style + &quot;&#39;&gt;&quot;;
            SecCaption.Text +=
                &quot;&lt;tr height=20px;&gt;&lt;td class=&#39;pageSubHeaders&#39; colspan=&#39;4&#39; id=&#39;td1&#39; runat=&#39;server&#39;&gt;&quot;;
            if (!string.IsNullOrEmpty(ctrl.HelpToolTip) || !string.IsNullOrEmpty(ctrl.HelpDescription))
            {
                SecCaption.Text += &quot;&lt;div HelpToolTip=&#39;HelpToolTip&#39;&gt;&lt;strong&gt;&quot; + caption + &quot;&lt;/strong&gt;&amp;nbsp;&quot; +
                                   RenderHelpdescription(ctrl).InnerHtml + &quot;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;;
            }
            else
                SecCaption.Text += &quot;&lt;strong&gt;&quot; + caption + &quot;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;;
            return SecCaption;
        }

        private HtmlGenericControl RenderSectionHeader(X.Section sec, HtmlContainerControl pageDiv)
        {
            var divControl = new HtmlGenericControl(&quot;div&quot;);

            pageDiv.Controls.Add(divControl);

            //this if statement tests if the section is tagged with a workflow stage.  In that case it disables the seciton
            //if the proper section of the workflow is not enabled.
            if (!String.IsNullOrWhiteSpace(sec.Stage) &amp;&amp;
                (sec.Stage != (stageCompleted + 1).ToString() ||
                 (!string.IsNullOrEmpty(currentStageUser) &amp;&amp; currentStageUser != &quot;NA&quot; &amp;&amp;
                  currentStageUser.ToLower() != (page.Session[&quot;UserDetail&quot;] as UserDetail).UserID.ToLower())
                 ||
                 (!string.IsNullOrEmpty(currentStageRole) &amp;&amp; currentStageRole != &quot;NA&quot; &amp;&amp;
                  currentStageRole.ToLower() != (page.Session[&quot;UserDetail&quot;] as UserDetail).RoleName.ToLower()))
                )
            {
                divControl.Attributes.Add(&quot;disabled&quot;, &quot;disabled&quot;);
                sec.IsSectionDisabled = true;
            }

            if (sec.level == 0)
                divControl.Style.Add(&quot;clear&quot;, &quot;both&quot;);

            return (divControl);
        }

        private void RenderSectionTitle(X.Section sec, HtmlTable tableControl)
        {
            if (string.IsNullOrEmpty(sec.Caption) &amp;&amp; sec.Visibility != X.ControlVisibility.None)
                sec.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(sec.Caption))
            {
                var htr = new HtmlTableRow();
                htr.Controls.Add(
                    NewCell(RenderCaption(sec.form.CaptionStyle, sec.ParseDynamicString(sec.Caption),
                        X.ContainerTypes.Section, sec.Visibility, sec)));
                tableControl.Rows.Add(htr);
            }
            SetControlVisibility(tableControl);
        }

        private void RenderSectionRow(X.Section sec, X.xControl ctrl, HtmlTable tableControl)
        {
            var htr = new HtmlTableRow();
            tableControl.Rows.Add(htr);
            var htc = new HtmlTableCell();

            htr.Cells.Add(htc);

            // Always try to get the value from the evaluatecontrol function, after that get it from DB if it is coming from there
            ctrl.valueObj = ctrl.EvaluateControlValue(); // returns null if there is not info to evaluate the value

            // If a controls value has to be evaluated everytime instead of fetching from DB. Assign this to true.
            // This is mainly used for Modified on and Modified By columns.
            if (!ctrl.ReEvaluate)
            {
                // if the value is supposed to come from db , take it from there
                // KK: Fixed whitepace strings in DBType causes crash, also fixed issue if column is not in DB for some reason it crashed.
                //     Now ignores columns that are not in database.
                if (sec.engine.IsViewOrEditMode() &amp;&amp; !string.IsNullOrWhiteSpace(ctrl.DBType) &amp;&amp;
                    sec.form.Table != null &amp;&amp; sec.form.Table.Rows.Count &gt; 0 &amp;&amp;
                    sec.form.Table.Columns.Contains(ctrl.Name))
                {
                    ctrl.valueObj = sec.form.Table.Rows[0].Field&lt;object&gt;(ctrl.Name);
                }
            }
            RenderRowControl(ctrl, ctrl.valueObj, htc);

            if (ctrl.Type == X.ControlType.Hidden &amp;&amp; !ctrl.form.DesignMode)
                htr.Style.Add(&quot;display&quot;, &quot;none&quot;);

            //ADD VALIDATION IF IT IS THERE
            if (ctrl.PrimaryKey) sec.form.PrimaryKeyName = ctrl.Name;
        }

        private void RenderStage(X.ControlContainer cont, object parent)
        {
            // find out if this stage we need to render in which mode - edit, view  or hidden
            if (model.form.engine.currentState != null)
            {
                Sections sections =
                    Sections.DeserializeSections(
                        HttpContext.Current.Server.UrlDecode(
                            (model.form.engine.currentState as StateInfo).SectionDisplayInfo));
                foreach (Aurigo.Common.Section sec in sections.Secs)
                {
                    if (sec.SectionName == cont.Name)
                    {
                        currentStageVisibility = sec.Visibility;
                        //Get Permssions if the SetPermission attribute is set to true
                        //Check the permissions and set the currentStageVisibility 
                        if ((cont is X.Stage) &amp;&amp; (cont as X.Stage).SetPermission &amp;&amp;
                            !currentStageVisibility.Equals(&quot;hidden&quot;, StringComparison.CurrentCultureIgnoreCase))
                        {
                            //If the current stage is not hidden, and the SetPermssion attribute is set to true, then check for permssion 
                            int rid = (page.Session[&quot;UserDetail&quot;] as UserDetail).RID;
                            int uid = (page.Session[&quot;UserDetail&quot;] as UserDetail).UID;
                            List&lt;string&gt; perms =
                                ModuleManagementBL.ModuleManager.Instance.GetPermissionByUserOrRole(cont.form.Name, uid, rid, 0);
                            if (sec.Visibility.Equals(&quot;Edit&quot;, StringComparison.CurrentCultureIgnoreCase) &amp;&amp;
                                perms.Contains(&quot;Edit&quot; + cont.Name))
                                currentStageVisibility = &quot;Edit&quot;;
                            //If the role has edit permission then set the stage visibility to edit
                            else if (sec.Visibility.Equals(&quot;Edit&quot;, StringComparison.CurrentCultureIgnoreCase) &amp;&amp;
                                     perms.Contains(&quot;View&quot; + cont.Name))
                                currentStageVisibility = &quot;View&quot;;
                            //If the role has view permission then set the stage visibility to view
                            else if (sec.Visibility.Equals(&quot;View&quot;, StringComparison.CurrentCultureIgnoreCase) &amp;&amp;
                                     perms.Contains(&quot;View&quot; + cont.Name))
                                currentStageVisibility = &quot;View&quot;;
                            //If the roles doesnt have edit permission then check for view,  if its there then set it to View
                            else
                                currentStageVisibility = &quot;Hidden&quot;; //Else hide the section
                        }
                        break;
                    }
                }
            }

            var div = CreateContainingDivControl(cont.Name, &quot;Stage&quot;, cont.Width, false);
            var p = parent as HtmlContainerControl;
            if (model.form.DesignMode)
            {
                RenderBorderInDesignMode(div, true);
                var stagetitlediv = new HtmlGenericControl(&quot;div&quot;)
                {
                    InnerHtml = &quot;&lt;b&gt;&quot; + cont.Name + &quot;&lt;/b&gt;&quot;,
                };
                stagetitlediv.Style.Add(&quot;margin-bottom&quot;, &quot;5px;&quot;);
                div.Controls.Add(stagetitlediv);
            }

            if (p != null)
            {
                p.Controls.Add(div);
                foreach (var c in cont.Containers)
                {
                    c.Render(div, X.RenderFormat.RenderHtml);
                }
            }
        }

        private void RenderHtmlSection(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            var hSec = cont as X.HTMLSection;
            if (string.IsNullOrEmpty(hSec.Caption) &amp;&amp; hSec.Visibility != X.ControlVisibility.None)
                hSec.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(hSec.Caption))
                (parent as HtmlContainerControl).Controls.Add(RenderCaption(hSec.form.CaptionStyle,
                    hSec.ParseDynamicString(hSec.Caption), X.ContainerTypes.HTMLSection, hSec.Visibility, hSec));

            Literal ltSec = new Literal();
            (parent as HtmlContainerControl).Controls.Add(ltSec);

            foreach (XmlElement element in (cont as X.HTMLSection).AllElements)
            {
                string text = element.InnerText;

                XmlDocument doc = new XmlDocument();
                doc.LoadXml(text);

                foreach (XmlElement ele in doc.SelectNodes(&quot;//*[contains(text(),&#39;_CONTROL&#39;)]&quot;))
                {
                    string controlId = ele.InnerXml.Replace(&quot;{_CONTROL:&quot;, &quot;&quot;).Replace(&quot;}&quot;, &quot;&quot;).Trim();
                    ele.InnerXml = &quot;&lt;span ID=&#39;ph_&quot; + controlId + &quot;&#39; class=&#39;controlPlaceHolder&#39;&gt;&lt;/span&gt;&quot;;
                }

                ltSec.Text += doc.InnerXml;
            }
        }

        private void RenderSection(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);


            var sec = cont as X.Section;
            bool isTableFormat = sec.Orientation == X.Orientation.Horizontal;


            var secTable = new HtmlTable();
            secTable.Attributes.Add(&quot;FormDesignerName&quot;, cont.Name);
            var row1 = new HtmlTableRow();
            secTable.Rows.Add(row1);

            (parent as HtmlContainerControl).Controls.Add(secTable);

            if (!string.IsNullOrEmpty(cont.TabName))
            {
                X.xTab tab = cont.form.GetContainer(cont.TabName) as X.xTab;
                if (tab != null)
                    secTable.Attributes.Add(&quot;TabName&quot;, cont.TabName);
            }

            var controlCell = new HtmlTableCell();
            row1.Cells.Add(controlCell);
            controlCell.ColSpan = sec.Containers.Count;
            controlCell.VAlign = &quot;top&quot;;

            if (!string.IsNullOrEmpty(sec.Attributes))
                secTable.Attributes.Add(&quot;style&quot;, sec.Attributes);


            foreach (var t in sec.DicCustomAttributes)
            {
                secTable.Attributes.Add(t.Key, t.Value);
            }

            HtmlGenericControl Container = RenderSectionHeader(sec, controlCell);

            if (!string.IsNullOrEmpty(cont.Width))
                secTable.Width = ParseHTMLUnitValue(cont.Width, 200).ToString();

            if (!string.IsNullOrEmpty(cont.Height))
                secTable.Height = ParseHTMLUnitValue(cont.Width, 50).ToString();

            var tableControl = new HtmlTable();
            tableControl.Attributes.Add(&quot;class&quot;, &quot;xmlFormSectionTable&quot;);
            Container.Controls.Add(tableControl);

            RenderSectionTitle(sec, tableControl);

            foreach (X.xControl ctrl in sec.Controls)
            {
                RenderSectionRow(sec, ctrl, tableControl);
            }


            // IF ORIENTATION IS SET TO HORIZONTAL
            // NOW CREATE NEW TR AND FOR EACH CONTAINER PASS A NEW CELL AS PARENT AND SET THE WIDTH OF THE CELL (PX AND % BOTH)

            if (isTableFormat)
            {
                var row2 = new HtmlTableRow();
                secTable.Rows.Add(row2);
                //TODO: This is a hack - Need to find a better solution - Akila
                //set row height to 40 only in multi column layout to the first row
                if (!string.IsNullOrEmpty(sec.Caption))
                    row1.Height = &quot;40px&quot;;

                foreach (X.ControlContainer c in sec.Containers)
                {
                    // sec.level = sec.level + 1;
                    var cell = new HtmlTableCell();
                    row2.Cells.Add(cell);
                    cell.Width = string.IsNullOrWhiteSpace(c.Width) ? null : ParseHTMLUnitValue(cell.Width).ToString();
                    cell.VAlign = &quot;top&quot;;
                    c.Render(cell, X.RenderFormat.RenderHtml);
                }
            }
            else
            {
                foreach (X.ControlContainer c in sec.Containers)
                {
                    // sec.level = sec.level + 1;
                    c.Render(Container, X.RenderFormat.RenderHtml);
                }
            }
            if (sec.form.DesignMode)
                RenderBorderInDesignMode(secTable, true);
        }

        private void RenderTreeChart(X.ControlContainer chartControl, object parentContainer)
        {
            TreeChart treeChartControl = chartControl as TreeChart;
            HtmlGenericControl treeChartControlContainer = new HtmlGenericControl(&quot;div&quot;);

            treeChartControlContainer.ClientIDMode = ClientIDMode.Static;
            treeChartControlContainer.ID = treeChartControl.Name;
            treeChartControlContainer.Attributes.Add(&quot;FormDesignerName&quot;, treeChartControl.Name);

            (parentContainer as HtmlContainerControl).Controls.Add(treeChartControlContainer);

            string formName = chartControl.form.Name;
            string sp_parameters = GetTreeChartDataSourceParameters(treeChartControl);

            Dictionary&lt;string, object&gt; tree = new Dictionary&lt;string, object&gt;();

            tree.Add(&quot;FormID&quot;, formName);
            tree.Add(&quot;ChartName&quot;, treeChartControlContainer.ID);
            tree.Add(&quot;chartContainerID&quot;, treeChartControlContainer.ID);
            tree.Add(&quot;Title&quot;, treeChartControl.Title);
            tree.Add(&quot;BackColor&quot;, treeChartControl.BackColor);
            tree.Add(&quot;DataSource&quot;, treeChartControl.DataSource);
            tree.Add(&quot;DataSourceType&quot;, treeChartControl.DataSourceType);
            tree.Add(&quot;IDColumnName&quot;, treeChartControl.IDColumnName);
            tree.Add(&quot;TextColumnName&quot;, treeChartControl.TextColumnName);
            tree.Add(&quot;ParentIDColumnName&quot;, treeChartControl.ParentIDColumnName);
            tree.Add(&quot;TitleColumnName&quot;, treeChartControl.TitleColumnName);
            tree.Add(&quot;BeforeRenderScript&quot;, treeChartControl.BeforeRenderScript);
            tree.Add(&quot;Parameters&quot;, sp_parameters);

            string json = JsonConvert.SerializeObject(tree);
            page.ClientScript.RegisterStartupScript(this.GetType(), treeChartControlContainer.ID, &quot;$(document).ready(function() {  PrepareChart(&#39;&quot; + json + &quot;&#39;);});&quot;, true);

        }

        /// &lt;summary&gt;
        ///  Tree Chart Controller accepts Datasource parameters in the format &quot;&lt;variable name1&gt;:&lt;value&gt;, &lt;variable name2&gt;:&lt;value&gt;, ...&quot;   
        ///  This function accpets the DataSourceParameters specified in the corresponding XML form, evaluates them and returns them in the above format. 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;container&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private string GetTreeChartDataSourceParameters(TreeChart container)
        {
            StringBuilder sp_parameters = new StringBuilder(&quot;&quot;);
            string[] parameters = container.Parameters.Split(new[] { &#39;;&#39; });
            int length = parameters.Length;
            for (int i = 0; i &lt; length; i++)
            {
                string parameter = parameters[i];
                string[] args = parameter.Split(new[] { &#39;,&#39; });
                if (args.Length &gt; 0)
                {
                    DbType typ;
                    if (Enum.TryParse&lt;DbType&gt;(args[1], out typ))
                    {
                        string value = string.Empty;
                        if (args[2].StartsWith(&quot;$&quot;))
                        {
                            string ctrlName = args[2].Trim().Replace(&quot;$&quot;, &quot;&quot;);
                            X.xControl xc = model.form.GetControl(ctrlName);
                            value =
                                xc.form.page.Request.Form[
                                    (xc.ControlReference[0] as WebControl).UniqueID];
                        }
                        value = container.ParseDynamicString(args[2]);
                        sp_parameters.Append(i.ToString() + &quot;:&quot; + value);
                    }
                }
                if (i != length - 1)
                    sp_parameters.Append(&#39;;&#39;);
            }
            return sp_parameters.ToString();
        }

        private void RenderPicker(X.ControlContainer cont, object parent)
        {
            var picker = cont as X.Picker;
            if (picker != null)
            {
                if (picker.form.DesignMode)
                {
                    var pageDiv = parent as HtmlGenericControl;
                    SetUniqueContainerName(ref cont);
                    HtmlGenericControl divControl = CreateContainingDivControl(picker.Name, &quot;Picker&quot;, picker.Width, false, &quot;&quot;);

                    RenderBorderInDesignMode(divControl, true);

                    pageDiv.Controls.Add(divControl);

                    var nameDiv = new HtmlGenericControl(&quot;DIV&quot;);
                    nameDiv.InnerHtml = &quot;Picker: &quot; + cont.Name;
                    divControl.Controls.Add(nameDiv);

                    foreach (var control in cont.Controls)
                    {
                        var col = control as X.xColumn;
                        if (col != null)
                        {
                            var div = CreateContainingDivControl(col.Name ?? col.ColumnName, &quot;Column&quot;, col.Width, false, &quot;&quot;);
                            div.ID = string.Format(&quot;{0}_{1}&quot;, picker.Name, div.ID);
                            div.InnerHtml = col.Name ?? col.ColumnName;
                            divControl.Controls.Add(div);
                        }
                    }
                }
            }
        }

        private void RenderTabs(X.ControlContainer cont, object parent)
        {
            HtmlGenericControl divControl = CreateContainingDivControl(cont.Name, &quot;&quot;, cont.Width, false);
            (parent as HtmlContainerControl).Controls.Add(divControl);

            Control tb = page.LoadControl(&quot;~/Modules/UserControls/TabControl.ascx&quot;);
            string ctrlName = cont.Name;
            TabControlContainer objTabBar = (TabControlContainer)tb;
            cont.ControlReference.Add(objTabBar);
            divControl.Controls.Add(tb);

            if (cont.form.DesignMode)
                RenderBorderInDesignMode(divControl, true);

            foreach (X.ControlContainer c in cont.Containers)
            {
                c.Render(cont, X.RenderFormat.RenderHtml);
            }
        }

        private void RenderTab(X.ControlContainer cont, object parent)
        {
            TabControlContainer objTab = (TabControlContainer)(parent as X.xTabs).ControlReference[0];


            //if (!string.IsNullOrEmpty(objTab.SelectedTab))
            //    (cont as xTab).IsSelected = objTab.SelectedTab == cont.Name;
            string TabCaption = cont.ParseDynamicString((cont as X.xTab).Caption);
            objTab.AddTab(TabCaption ?? cont.Name, (cont as X.xTab).IsSelected);
            TabControl tb = objTab.GetTab(TabCaption ?? cont.Name);
            tb.link.Attributes.Add(&quot;FormDesignerName&quot;, cont.Name);
            (tb.ContainerDiv as HtmlGenericControl).ID = cont.Name;
            (tb.ContainerDiv as HtmlGenericControl).ClientIDMode = ClientIDMode.Static;
            (tb.ContainerDiv as HtmlGenericControl).Attributes.Add(&quot;FormDesignerName&quot;, cont.Name);

            cont.ControlReference.Add(objTab.Tabs.Find(x =&gt; x.Title == TabCaption).ContainerDiv);

            foreach (X.ControlContainer c in cont.Containers)
            {
                //HtmlGenericControl divControl = CreateContainingDivControl(c.Name, &quot;&quot;, cont.Width, false);
                //objTab.GetTab(cont.Name).ContainerDiv.Controls.Add(divControl);
                c.Render(tb.ContainerDiv, X.RenderFormat.RenderHtml);
            }

            if (cont.form.DesignMode)
                RenderBorderInDesignMode(tb.ContainerDiv as HtmlGenericControl, true);
        }

        private void RenderChart(X.ControlContainer cont, object parent)
        {
            ChartRenderer.Instance.RenderChart(parent, (cont as Chart));
        }

        private void RenderMatrixGrid(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            X.MatrixGrid mGrid = (cont as X.MatrixGrid);
            var parentDiv = parent as HtmlGenericControl;

            var divControl = CreateContainingDivControl(mGrid.Name, &quot;MatrixGrid&quot;, mGrid.Width, false);
            parentDiv.Controls.Add(divControl);

            if (string.IsNullOrEmpty(mGrid.Caption) &amp;&amp; mGrid.Visibility != X.ControlVisibility.None)
                mGrid.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(mGrid.Caption))
                divControl.Controls.Add(RenderCaption(mGrid.form.CaptionStyle, mGrid.ParseDynamicString(mGrid.Caption),
                    X.ContainerTypes.StaticGrid, mGrid.Visibility, mGrid));

            if (!string.IsNullOrEmpty(mGrid.Attributes))
                divControl.Attributes.Add(&quot;style&quot;, mGrid.Attributes);

            if (!string.IsNullOrEmpty(cont.TabName))
            {
                X.xTab tab = cont.form.GetContainer(cont.TabName) as X.xTab;
                if (tab != null)
                    divControl.Attributes.Add(&quot;TabName&quot;, cont.TabName);
            }

            //Evaluate the datasource
            DataTable dt = mGrid.GetDataSource();

            if (dt != null)
            {
                int noOfColumns = 0;
                //Assumption is that the datatable is sorted by row group by column
                List&lt;string&gt; columnGroupHeader = new List&lt;string&gt;();
                List&lt;string&gt; rowGroupByColumnValues = new List&lt;string&gt;();

                X.ColumnControls columnControls = new X.ColumnControls();
                X.RowControls rowControls = new X.RowControls();
                X.DataControls dataControls = new X.DataControls();

                if (mGrid.Containers.OfType&lt;X.ColumnControls&gt;().Any())
                    columnControls = mGrid.Containers.OfType&lt;X.ColumnControls&gt;().FirstOrDefault();
                if (mGrid.Containers.OfType&lt;X.RowControls&gt;().Any())
                    rowControls = mGrid.Containers.OfType&lt;X.RowControls&gt;().FirstOrDefault();
                if (mGrid.Containers.OfType&lt;X.DataControls&gt;().Any())
                    dataControls = mGrid.Containers.OfType&lt;X.DataControls&gt;().FirstOrDefault();

                //Get data 
                var query = new StringBuilder();
                query.Append(&quot;select &quot;);
                X.DataBaseContainer.ProcessControlsForDBContainer(dataControls,
                    ctrl =&gt;
                    {
                        if (!string.IsNullOrEmpty(ctrl.DBType))
                            query.AppendFormat(&quot;[{0}],&quot;, ctrl.Name);
                    },
                    true);
                string dbquery = query.ToString();
                dbquery = dbquery.Trim(&#39;,&#39;) + &quot; from &quot; + mGrid.TableName + mGrid.BuildForeignKeyFilter();

                var dtData = new DataTable();
                //dtData = dt;
                try
                {
                    var tmp_dtData = ComponentHelper.Instance.ExecuteDataSet(dbquery).Tables[0];
                    dtData = tmp_dtData.ToMWDateTime();
                }
                catch (Exception)
                {
                }

                for (int i = 0; i &lt; dt.Rows.Count;)
                {
                    string rowGroupByValue = dt.Rows[i][mGrid.RowGroupBy].ToString();
                    DataRow[] rows = dt.Select(mGrid.RowGroupBy + &quot; = &#39;&quot; + rowGroupByValue + &quot;&#39;&quot;);
                    noOfColumns = Math.Max(noOfColumns, rows.Length);

                    if (!rowGroupByColumnValues.Contains(rowGroupByValue))
                        rowGroupByColumnValues.Add(rowGroupByValue);

                    if (columnControls.Controls.Count &lt;= 0)
                    {
                        foreach (DataRow row in rows)
                        {
                            string headerText = row[mGrid.ColumnGroupBy].ToString();
                            if (!columnGroupHeader.Contains(headerText))
                                columnGroupHeader.Add(headerText);
                        }
                    }

                    i += rows.Length;
                }

                HtmlTable tblMatrixGrid = new HtmlTable();
                divControl.Controls.Add(tblMatrixGrid);

                //The first row is for column headers
                //If the column controls is given then render them in first row 
                //IF not render the column group by name

                HtmlTableRow headerRow = new HtmlTableRow();
                tblMatrixGrid.Rows.Add(headerRow);

                //Need to leave empty space in the header row for row controls
                int noOfRowColumns = 1;
                if (rowControls.Controls.Count &gt; 0)
                    noOfRowColumns = rowControls.Controls.Count;

                for (int i = 0; i &lt; noOfRowColumns; i++)
                {
                    HtmlTableCell headerCell = new HtmlTableCell();
                    headerRow.Cells.Add(headerCell);
                    headerCell.InnerHtml = &quot;&amp;nbsp;&quot;;
                }

                if (noOfColumns &gt; 0)
                {
                    //Header Row
                    if (columnControls.Controls.Count &lt;= 0 &amp;&amp; columnGroupHeader.Count &gt; 0)
                    {
                        foreach (string headerText in columnGroupHeader)
                        {
                            HtmlTableCell headerCell = new HtmlTableCell();
                            headerRow.Cells.Add(headerCell);
                            headerCell.InnerHtml = headerText;
                        }
                    }
                    else
                    {
                        for (int i = 0; i &lt; noOfColumns; i++)
                        {
                            HtmlTableCell headerCell = new HtmlTableCell();
                            headerRow.Cells.Add(headerCell);

                            for (int j = 0; j &lt; columnControls.Controls.Count; j++)
                            {
                                X.xControl xc = columnControls.Controls[j];
                                string value = xc.EvaluateControlValue();
                                var wc = RenderControlForMatrixGrid(xc, value, mGrid.Name + &quot;_&quot; + i + &quot;_&quot; + j,
                                    headerCell);
                                xc.ControlReference.Clear();
                                headerCell.Controls.Add(wc);
                            }
                        }
                    }
                    //Other rows
                    int rowCounter = 0;
                    int actualRowCount = 0;
                    foreach (string rowGroupBy in rowGroupByColumnValues)
                    {
                        HtmlTableRow tbRow = new HtmlTableRow();
                        tblMatrixGrid.Rows.Add(tbRow);
                        DataRow[] rows = dt.Select(mGrid.RowGroupBy + &quot; = &#39;&quot; + rowGroupBy + &quot;&#39;&quot;);
                        DataRow row = null;
                        if (rows.Length &gt; 0)
                            row = rows[0];

                        if (row != null)
                        {
                            //Row Controls

                            #region Row Controls

                            if (rowControls.Controls.Count &gt; 0)
                            {
                                foreach (X.xControl rowCtrl in rowControls.Controls)
                                {
                                    HtmlTableCell tbCell = new HtmlTableCell();
                                    tbRow.Cells.Add(tbCell);

                                    string value = mGrid.GetValueFromDataSource(row, rowCtrl);

                                    var rowWc = RenderControlForMatrixGrid(rowCtrl, value,
                                        mGrid.Name + &quot;_Row_&quot; + rowCounter + &quot;_&quot; + rowCtrl.Name, tbCell);
                                    rowCtrl.ControlReference.Clear();
                                    tbCell.Controls.Add(rowWc);
                                }
                            }
                            else
                            {
                                string rowText = row[mGrid.RowGroupBy].ToString();
                                HtmlTableCell tbCell = new HtmlTableCell();
                                tbRow.Cells.Add(tbCell);
                                tbCell.InnerHtml = rowText;
                            }

                            #endregion Row Controls

                            //Data Controls

                            #region Data Controls

                            int columnCounter = 0;
                            foreach (DataRow dataRow in rows)
                            {
                                foreach (X.xControl dCtrl in dataControls.Controls)
                                {
                                    HtmlTableCell cellData = new HtmlTableCell();
                                    tbRow.Cells.Add(cellData);

                                    string value = string.Empty;
                                    if (dtData != null &amp;&amp; dtData.Columns.Contains(dCtrl.Name) &amp;&amp;
                                        dtData.Rows.Count &gt; actualRowCount)
                                    {
                                        object val = dtData.Rows[actualRowCount][dCtrl.Name];
                                        if (val != null)
                                            value = val.ToString();
                                    }
                                    else
                                        value = mGrid.GetValueFromDataSource(dataRow, dCtrl);

                                    object[] tempRefArray = dCtrl.ControlReference.ToArray();
                                    var webCtrl = RenderControlForMatrixGrid(dCtrl, value,
                                        mGrid.Name + &quot;_Row_&quot; + rowCounter + &quot;_Column_&quot; + columnCounter + dCtrl.Name,
                                        cellData);
                                    dCtrl.ControlReference = new List&lt;object&gt;(tempRefArray);
                                    dCtrl.ControlReference.Add(webCtrl);
                                    cellData.Controls.Add(webCtrl);
                                }
                                columnCounter++;
                                actualRowCount++;
                            }
                            while (columnCounter &lt; noOfColumns)
                            {
                                HtmlTableCell cellData = new HtmlTableCell();
                                tbRow.Cells.Add(cellData);

                                cellData.InnerHtml = &quot;&amp;nbsp;&quot;;
                                columnCounter++;
                            }

                            #endregion Data Controls
                        }
                        rowCounter++;
                    }
                }
            }
        }


        private static WebControl RenderControlForMatrixGrid(X.xControl dCtrl, string value, string controlId,
            HtmlTableCell tbCell)
        {
            var webCtrl = dCtrl.RenderSingleFormControl(value, X.RenderFormat.RenderHtml) as WebControl;
            if (webCtrl is Panel &amp;&amp; webCtrl.Controls.Count &gt; 0)
            {
                var innerwebCtrl = webCtrl.Controls[0] as WebControl;
                innerwebCtrl.ID = controlId;
            }
            else
                webCtrl.ID = controlId;

            webCtrl.ClientIDMode = ClientIDMode.Static;

            if (dCtrl.Type == X.ControlType.Hidden || dCtrl.Type == X.ControlType.DDLDisplayControl)
            {
                webCtrl.Style.Add(&quot;display&quot;, &quot;none&quot;);
                tbCell.Style.Add(&quot;display&quot;, &quot;none&quot;);
            }

            return webCtrl;
        }

        private string CreateEditTemplate(X.DynamicGrid dg, HtmlGenericControl parentDiv, string gridClientID,
            string gridDataClientID, out string cancelClientID, out string saveClientID)
        {
            HtmlGenericControl templateDiv = CreateContainingDivControl(dg.Name + &quot;_&quot; + &quot;EditTemplate&quot;,
                &quot;xmlEditTemplate&quot;, null, true);
            parentDiv.Controls.Add(templateDiv);
            var templateTable = new HtmlTable();
            templateDiv.Controls.Add(templateTable);
            templateDiv.Style.Add(&quot;display&quot;, &quot;none&quot;);
            List&lt;dynamic&gt; mandatoryFieldsList = new List&lt;dynamic&gt;();
            foreach (X.xControl ctrl in dg.Controls)
            {
                var temphtr = new HtmlTableRow();
                templateTable.Rows.Add(temphtr);
                var temphtc = new HtmlTableCell();
                temphtr.Cells.Add(temphtc);
                ctrl.DGridAttribute = true;

                // Always try to get the value from the evaluatecontrol function
                object valueObj = ctrl.EvaluateControlValue();
                // returns null if there is not info to evaluate the value
                RenderRowControl(ctrl, valueObj, temphtc, true);

                if (ctrl.ValidationTypes.Contains(X.ValidationType.Required))
                {
                    mandatoryFieldsList.Add(new { Name = ctrl.Name, Caption = ctrl.Caption });
                }

                if (ctrl.Type == X.ControlType.Hidden || ctrl.Type == X.ControlType.DDLDisplayControl)
                    temphtr.Style.Add(&quot;display&quot;, &quot;none&quot;);
            }
            var gridMandatoryFieldCtrl = dg.ControlReference[2] as HiddenField;
            if (mandatoryFieldsList.Count &gt; 0)
                gridMandatoryFieldCtrl.Value = JsonConvert.SerializeObject(mandatoryFieldsList);
            else
                gridMandatoryFieldCtrl.Value = &quot;[]&quot;;

            var buttonhtr = new HtmlTableRow();
            templateTable.Rows.Add(buttonhtr);
            var htcButtons = new HtmlTableCell();
            buttonhtr.Cells.Add(htcButtons);

            var BtnSave = new Button();
            BtnSave.Style.Add(&quot;margin-right&quot;, &quot;5px&quot;);
            htcButtons.Controls.Add(BtnSave);
            string onClientClickScript = string.Empty;
            BtnSave.Text = &quot;Save&quot;;

            var BtnCancel = new Button();
            htcButtons.Controls.Add(BtnCancel);
            BtnCancel.Text = &quot;Cancel&quot;;
            //BtnCancel.OnClientClick = &quot;return HideTemplate(&#39;&quot; + templateDiv.ClientID + &quot;&#39;)&quot;;

            string validationGroup = dg.Name + &quot;_GridValidate&quot;;

            BtnSave.CausesValidation = true;
            BtnSave.ValidationGroup = validationGroup;

            //if (!page.ClientScript.IsStartupScriptRegistered(&quot;SaveBtnIDScript&quot;))
            //    page.ClientScript.RegisterStartupScript(GetType(), &quot;SaveBtnIDScript&quot;, &quot; function SetSaveButtonId() { btnSaveID =&#39;&quot; + BtnSave.ClientID + &quot;&#39;;} &quot;, true);
            //Required and Time Input validation
            if (
                dg.Controls.Any(
                    xc =&gt;
                        (xc.ValidationTypes.Contains(Aurigo.Brix.Platform.BusinessLayer.XMLForm.ValidationType.Required) ||
                         xc.Type == X.ControlType.TimeInput)))
                onClientClickScript = &quot;return UpdateGrid(&#39;&quot; + templateDiv.ClientID + &quot;&#39;,&#39;&quot; + gridClientID + &quot;&#39;,&#39;&quot; +
                                      gridDataClientID + &quot;&#39;, true,&#39;&quot; + BtnCancel.ClientID + &quot;&#39;,&#39;&quot; + validationGroup +
                                      &quot;&#39;,&#39;&quot; + dg.AfterRowUpdateScript + &quot;&#39;,&#39;&quot; + dg.BeforeRowUpdateScript + &quot;&#39;);&quot;;
            else
                onClientClickScript = &quot;return UpdateGrid(&#39;&quot; + templateDiv.ClientID + &quot;&#39;,&#39;&quot; + gridClientID + &quot;&#39;,&#39;&quot; +
                                      gridDataClientID + &quot;&#39;, false,&#39;&quot; + BtnCancel.ClientID + &quot;&#39;,&#39;&quot; + validationGroup +
                                      &quot;&#39;,&#39;&quot; + dg.AfterRowUpdateScript + &quot;&#39;,&#39;&quot; + dg.BeforeRowUpdateScript + &quot;&#39;);&quot;;

            BtnSave.OnClientClick = onClientClickScript;

            htcButtons.Align = &quot;center&quot;;
            cancelClientID = BtnCancel.ClientID;
            saveClientID = BtnSave.ClientID;
            return templateDiv.ClientID;
        }

        private HtmlGenericControl CreateContainingDivControl(string name, string ccsClass, string width,
            bool addPadding, string divWidth = &quot;100%&quot;)
        {
            var divControl = new HtmlGenericControl(&quot;DIV&quot;);
            divControl.ClientIDMode = ClientIDMode.Static;

            // set the client ID so we can play with it later.
            divControl.Attributes.Add(&quot;FormDesignerName&quot;, name);

            // sections MUST have a name for editing to work correctly
            if (!string.IsNullOrEmpty(name))
                divControl.ID = name;

            string DGWidth = divWidth;
            if (addPadding)
            {
                divControl.Style.Add(&quot;padding-left&quot;, &quot;10px;&quot;);
            }

            divControl.Attributes.Add(&quot;class&quot;, ccsClass);

            if (!string.IsNullOrEmpty(width))
                DGWidth = ParseHTMLUnitValue(width).ToString();

            if (!string.IsNullOrEmpty(DGWidth))
                divControl.Style.Add(&quot;width&quot;, DGWidth);

            SetControlVisibility(divControl);

            return (divControl);
        }

        private void SetControlVisibility(HtmlControl divControl)
        {
            if (currentStageVisibility.Equals(&quot;hidden&quot;, StringComparison.CurrentCultureIgnoreCase))
                divControl.Style.Add(&quot;display&quot;, &quot;none&quot;);

            //No need to do this as the controls are renderd as Label. 
            //If we do this, then some of the control&#39;s data is not getting saved like CheckBox,CheckBoxList and ListBox. 

            //else if (currentStageVisibility.Equals(&quot;view&quot;, StringComparison.CurrentCultureIgnoreCase))
            //    page.ClientScript.RegisterStartupScript(GetType(), &quot;hideDiv_1&quot; + divControl.ClientID, &quot;SetControlVisibility(&#39;&quot; + divControl.ClientID + &quot;&#39;);&quot;, true);
        }

        private void SetControlVisibility(WebControl divControl)
        {
            if (currentStageVisibility.Equals(&quot;hidden&quot;, StringComparison.CurrentCultureIgnoreCase))
                divControl.Style.Add(&quot;display&quot;, &quot;none&quot;);

            //No need to do this as the controls are renderd as Label. 
            //If we do this, then some of the control&#39;s data is not getting saved like CheckBox,CheckBoxList and ListBox. 

            //else if (currentStageVisibility.Equals(&quot;view&quot;, StringComparison.CurrentCultureIgnoreCase))
            //    page.ClientScript.RegisterStartupScript(GetType(), &quot;hideDiv_2&quot; + divControl.ClientID, &quot;SetControlVisibility(&#39;&quot; + divControl.ClientID + &quot;&#39;);&quot;, true);
        }

        private void InitializeGrid(X.ControlContainer c, X.DynamicGrid dg)
        {
            RadGrid grid = new RadGrid();

            // KK: BugFix for Form Generator::: All controls MUST have an unchanging unique name
            grid.ID = X.ControlContainer.GetParent&lt;X.DataBaseContainer&gt;(c).Name + &quot;_&quot; + c.Name + &quot;_id&quot;;
            grid.Skin = &quot;Office2007&quot;;
            grid.EnableViewState = false;
            grid.AutoGenerateColumns = false;
            grid.MasterTableView.TableLayout = GridTableLayout.Fixed;
            grid.ClientSettings.Selecting.AllowRowSelect = true;
            grid.MasterTableView.HeaderStyle.Height = Unit.Pixel(20);
            grid.MasterTableView.HeaderStyle.Wrap = false;
            grid.MasterTableView.ItemStyle.Height = Unit.Pixel(28);
            grid.MasterTableView.ItemStyle.Wrap = false;
            grid.ClientSettings.Resizing.AllowColumnResize = true;
            UserDetail userDetail = UserDetail.GetCurrentUserDetail();
            if (userDetail != null &amp;&amp; userDetail.IsADACompliant)
            {
                grid.ClientSettings.Scrolling.AllowScroll = false;
                grid.Attributes.Add(&quot;summary&quot;, c.ParseDynamicString(dg.Caption));
            }
            else
                grid.ClientSettings.Scrolling.AllowScroll = true;
            grid.ClientSettings.EnableRowHoverStyle = true;
            grid.ClientSettings.EnableAlternatingItems = true;
            grid.MasterTableView.ItemStyle.Wrap = false;
            grid.MasterTableView.AlternatingItemStyle.Wrap = false;
            grid.MasterTableView.AlternatingItemStyle.BackColor = ColorTranslator.FromHtml(&quot;#EDEDED&quot;);
            grid.AllowSorting = true;
            grid.MasterTableView.AllowMultiColumnSorting = false;

            if (dg.AllowFiltering &amp;&amp; this.model.form.engine.IsViewMode)
            {
                grid.AllowFilteringByColumn = true;
                grid.ClientSettings.ClientEvents.OnFilterMenuShowing = &quot;dynamicGrid_FilterMenuShowing&quot;;
                grid.FilterMenu.OnClientShowing = &quot;dynamicGrid_MenuShowing&quot;;
                grid.ClientSettings.ClientEvents.OnCommand = &quot;dynamicGrid_RaiseCommand&quot;;
                grid.EnableTheming = false;
            }

            grid.SortingSettings.EnableSkinSortStyles = true;
            grid.ClientSettings.Scrolling.SaveScrollPosition = true;
            grid.ClientSettings.Scrolling.UseStaticHeaders = true;
            grid.EnableLinqExpressions = false;
            if (dg.AllowMultiSelect) grid.AllowMultiRowSelection = true;

            grid.ClientSettings.ClientEvents.OnRowSelecting = &quot;dynamicGrid_OnRowSelecting&quot;;
            grid.ClientSettings.ClientEvents.OnRowDeselecting = &quot;dynamicGrid_OnRowDeselecting&quot;;
            grid.ClientSettings.ClientEvents.OnRowClick = &quot;dynamicGrid_OnRowClick&quot;;

            grid.DataSource = new Object[0];
            if (dg.AllowInlineEdit &amp;&amp; !currentStageVisibility.Equals(&quot;view&quot;, StringComparison.CurrentCultureIgnoreCase))
            {
                grid.PreRender += grid_PreRender;
            }
            HiddenField hiddenField = new HiddenField();
            hiddenField.ID = grid.ID + &quot;_data&quot;;
            hiddenField.ClientIDMode = ClientIDMode.Static;
            grid.Attributes.Add(&quot;ClientDataControlId&quot;, hiddenField.ID);

            //hidden field to store json string containing name and caption 
            //of mandatory fields for validation on workflow
            HiddenField hdnMandatoryFields = new HiddenField();
            hdnMandatoryFields.ID = grid.ID + &quot;_mandatoryFields&quot;;
            hdnMandatoryFields.ClientIDMode = ClientIDMode.Static;
            grid.Attributes.Add(&quot;ClientMandatoryFieldsControlId&quot;, hdnMandatoryFields.ID);

            grid.Attributes.Add(&quot;DynamicGridReference&quot;, dg.Name);
            grid.ItemDataBound += grid_ItemDataBound;

            if (dg.MinimumNumberOfRows &gt; 0)
            {
                if (!string.IsNullOrEmpty(dg.ValidateOnAction))
                {
                    string validationGroup = AssignValidationGroup(dg.ValidateOnAction, dg.form.engine.currentState);
                    grid.Attributes.Add(&quot;ValidationGroup&quot;, validationGroup);
                }
                grid.Attributes.Add(&quot;MinimumNumberOfRows&quot;, dg.MinimumNumberOfRows.ToString());
            }

            if (dg.AllowInlineEdit &amp;&amp; !currentStageVisibility.Equals(&quot;view&quot;, StringComparison.CurrentCultureIgnoreCase))
                grid.Attributes.Add(&quot;GridEditingMode&quot;, &quot;Inline&quot;);

            c.ControlReference.Clear();
            c.ControlReference.Add(grid);
            c.ControlReference.Add(hiddenField);
            c.ControlReference.Add(hdnMandatoryFields);
        }

        void grid_ItemDataBound(object sender, GridItemEventArgs e)
        {
            RadGrid grid = (sender as RadGrid);
            string dgName = string.Empty;
            X.DynamicGrid dgObject = null;

            if (grid.Attributes[&quot;DynamicGridReference&quot;] != null)
            {
                dgName = grid.Attributes[&quot;DynamicGridReference&quot;];
                dgObject = model.form.GetContainer(dgName) as X.DynamicGrid;
            }

            if (dgObject == null)
                return;

            if (e.Item is GridDataItem)
            {
                string linkColumnName = string.Empty;
                string linkUrl = string.Empty;
                X.ControlType? linkColumnType = null;
                GridDataItem dataItem = e.Item as GridDataItem;

                foreach (X.xControl xc in dgObject.Controls)
                {
                    X.xColumn col = (xc as X.xColumn);
                    if (col == null)
                        continue;

                    if (!string.IsNullOrEmpty(col.LinkURL))
                    {
                        linkColumnName = xc.Name;
                        linkUrl = xc.ParseDynamicString(col.LinkURL);
                        linkColumnType = col.Type;
                    }
                }

                if (linkUrl.Contains(&quot;$&quot;))
                {
                    GridDataItem rowItem = (GridDataItem)e.Item;
                    char[] separators =
                    {
                                &#39;+&#39;, &#39;-&#39;, &#39;*&#39;, &#39;/&#39;, &#39;=&#39;, &#39;;&#39;, &#39;:&#39;, &#39;{&#39;, &#39;}&#39;, &#39;[&#39;, &#39;]&#39;, &#39;(&#39;, &#39;)&#39;, &#39;&quot;&#39;,
                                &#39;?&#39;, &#39;&amp;&#39;, &#39;\&#39;&#39;, &#39;(&#39;, &#39;)&#39;, &#39;.&#39;, &#39;&lt;&#39;, &#39;&gt;&#39;
                            };
                    string[] operands = linkUrl.Split(separators);

                    operands.ForEach(operand =&gt;
                    {
                        if (operand.Trim().StartsWith(&quot;$&quot;))
                        {
                            string columnName = operand.Replace(&quot;$&quot;, &quot;&quot;);
                            try
                            {
                                linkUrl = linkUrl.Replace(operand, rowItem[columnName].Text.ToString());
                            }
                            catch
                            {
                                //Invalid Column name
                            }
                        }
                    });
                }
                GridDataItem item = (GridDataItem)e.Item;
                if (!string.IsNullOrEmpty(linkColumnName))
                {
                    HyperLink hl = new HyperLink();
                    hl.NavigateUrl = linkUrl;
                    hl.Attributes.Add(&quot;target&quot;, &quot;_blank&quot;);
                    if (linkColumnType != null &amp;&amp; linkColumnType == X.ControlType.DropDownList)
                    {
                        //If the column is of type drop down list then we need to set the link to _Disp column
                        hl.Text = item[linkColumnName + &quot;_Disp&quot;].Text.ToString();
                        item[linkColumnName + &quot;_Disp&quot;].Controls.Add(hl);
                    }
                    else
                    {
                        hl.Text = item[linkColumnName].Text.ToString();
                        item[linkColumnName].Controls.Add(hl);
                    }
                }
                string attachmentColumn = &quot;img_DataHasAttachments&quot;;
                if (Aurigo.Brix.Platform.BusinessLayer.Utility.MWGrid.ColumnExists(item, attachmentColumn))
                {
                    string value = Convert.ToString(item[attachmentColumn].Text, CultureInfo.CurrentCulture);
                    if (value.ToUpper() == &quot;TRUE&quot;)
                    {
                        item[attachmentColumn].Style.Add(&quot;background-image&quot;,
                            &quot;url(&#39;&quot; + string.Format(CultureInfo.CurrentCulture,
                                &quot;/Images/toolbar/IcnAttachmentBW.png&quot;) + &quot;&#39;)&quot;);
                        item[attachmentColumn].Style.Add(&quot;Background-repeat&quot;, &quot;no-repeat&quot;);
                        item[attachmentColumn].Style.Add(&quot;background-position&quot;, &quot;center center&quot;);
                        item[attachmentColumn].ForeColor = Color.White;
                        item[attachmentColumn].Font.Size = FontUnit.Point(1);
                    }
                }

                //Provided tooltip for the grid column if valid data is there.Other than &amp;nbsp(space) and empty string. 
                foreach (GridColumn column in grid.MasterTableView.RenderColumns)
                {
                    if (column is GridBoundColumn)
                    {
                        FormatColumnCell(column as GridBoundColumn, e.Item as GridDataItem);
                    }
                }

            }
        }

        private void FormatColumnCell(GridBoundColumn column, GridDataItem item)
        {
            if (column != null &amp;&amp; item != null)
            {
                if (item[column.UniqueName].Text.Trim() != &quot;&amp;nbsp;&quot; &amp;&amp; item[column.UniqueName].Text.Trim() != string.Empty)
                    item[column.UniqueName].ToolTip = HttpUtility.HtmlDecode(item[column.UniqueName].Text.Replace(&quot;&amp;amp;&quot;, &quot;&amp;&quot;));
            }
        }

        private void grid_PreRender(object sender, EventArgs e)
        {
            RadGrid grid = (sender as RadGrid);
            string dgName = string.Empty;
            X.DynamicGrid dgObject = null;

            if (grid.Attributes[&quot;DynamicGridReference&quot;] != null)
            {
                dgName = grid.Attributes[&quot;DynamicGridReference&quot;];
                dgObject = model.form.GetContainer(dgName) as X.DynamicGrid;
            }

            if (dgObject == null)
                return;

            GridTableView masterTable = (sender as RadGrid).MasterTableView;
            foreach (GridColumn c in grid.Columns)
            {
                if (c.ColumnType == &quot;GridTemplateColumn&quot;)
                {
                    if (this.model.form.engine.IsViewMode)
                        continue;

                    X.xControl xc = model.form.GetControl(c.UniqueName);
                    if (!xc.ReadOnly &amp;&amp; xc.Type == X.ControlType.DropDownList)
                    {
                        RadComboBox combo = (RadComboBox)(((masterTable.GetBatchColumnEditor(xc.Name)).ContainerControl.Controls[0]) as RadComboBox);
                        HtmlRenderer.BindGridDropDown(xc, combo);
                    }
                }
                else if (c.ColumnType == &quot;GridNumericColumn&quot; &amp;&amp; !model.form.engine.IsViewMode)
                {
                    X.xControl xc = model.form.GetControl(c.UniqueName);

                    if (xc == null || xc.ReadOnly)
                        continue;

                    GridNumericColumnEditor gridNumericColumnEditor = null;
                    gridNumericColumnEditor = masterTable.GetBatchColumnEditor(xc.Name) as GridNumericColumnEditor;

                    if (gridNumericColumnEditor != null)
                    {
                        if (xc.Type.ToString2().ToLower2() == &quot;integer&quot;)
                        {
                            gridNumericColumnEditor.NumericTextBox.NumberFormat.DecimalDigits = 0;
                        }

                        gridNumericColumnEditor.NumericTextBox.IncrementSettings.InterceptArrowKeys = false;
                    }
                }
                else if (!model.form.engine.IsViewMode &amp;&amp; dgObject.AllowInlineEdit)
                {
                   
                    X.xControl textAreaControl = dgObject.GetControl(MWGrid.GetDatabaseFriendlyExpression(c.UniqueName));

                    if (textAreaControl == null || textAreaControl.ReadOnly)
                        continue;

                    if (textAreaControl != null &amp;&amp; textAreaControl.Type == X.ControlType.TextArea)
                    {
                        GridTextBoxColumnEditor textAreaEditor = masterTable.GetBatchColumnEditor(c) as GridTextBoxColumnEditor;
                        if (textAreaEditor != null)
                        {
                            int maxlength = 0;
                            string tempType = textAreaControl.DBType;
                            string expLength = textAreaControl.DBType.Substring(tempType.IndexOf(&#39;(&#39;) + 1,
                                tempType.IndexOf(&#39;)&#39;) - tempType.IndexOf(&#39;(&#39;) - 1);

                            if (Int32.TryParse(expLength, out maxlength))
                                textAreaEditor.TextBoxControl.Attributes.Add(&quot;maxlength&quot;, maxlength.ToString());
                            textAreaEditor.TextBoxControl.TextMode = TextBoxMode.MultiLine;
                            textAreaEditor.TextBoxControl.Height = new Unit(ParseHTMLUnitValue(textAreaControl.Height, 100).Value - 30);
                            textAreaEditor.TextBoxControl.Width = ParseHTMLUnitValue(&quot;100%&quot;);
                        }
                    }
                }
            }
        }

        /// &lt;summary&gt;
        /// THIS DOES NOT BELONG HERE AT ALL BUT.
        /// &lt;/summary&gt;
        public void BindDynamicGridControl(X.DynamicGrid dg)
        {
            if (!dg.bGridBound)
            {
                dg.bGridBound = true;

                bool showFooter = false;

                var grid = dg.ControlReference[0] as RadGrid;
                grid.Columns.Clear();

                ////////////////////////////////////////////////////////////////////////////////////////////////////////////
                // KK: I think this code should be replaced with a call to GetInstanceData()
                //
                // lets only query the fields that are specified.  This will optimize dynamic grids 
                // that overlay tables created outside of forms.
                var isExistsAttachmentControl = false;
                var query = new StringBuilder();
                query.Append(&quot;select &quot;); // * from &quot; + TableName + BuildForeignKeyFilter();
                X.DataBaseContainer.ProcessControlsForDBContainer(dg,
                    ctrl =&gt;
                    {
                        if (!string.IsNullOrEmpty(ctrl.DBType) &amp;&amp; ctrl.Type != X.ControlType.AttachmentControl)
                            query.Append(&quot;[&quot; + ctrl.Name + &quot;]&quot; + &quot;,&quot;);
                    },
                    true);
                string dbquery = query.ToString();
                dbquery = dbquery.Trim(&#39;,&#39;) + &quot; from &quot; + dg.TableName + dg.BuildForeignKeyFilter();
                /////////////////////////////////////////////////////////////////////////////////////////////////////////////

                // we need to fix this - creating column explicitly is not working somehow when data are there.
                var table = new DataTable();
                try
                {
                    var tmptable = ComponentHelper.Instance.ExecuteDataSet(dbquery).Tables[0];
                    table = tmptable.ToMWDateTime();

                    //Asheesh: Below code will not be required since we need to translate datetime for only those fields which are datetime dataype from database
                    //IEnumerable&lt;X.xControl&gt; xDateTimeControlList =
                    //dg.Controls.Where(xc =&gt; xc.IsTimezoneApplicable);//xc.DBType.Equals(&quot;datetime&quot;, StringComparison.CurrentCultureIgnoreCase));
                    //foreach (DataRow row in table.Rows)
                    //{
                    //    foreach (X.xControl dtCntrl in xDateTimeControlList)
                    //    {
                    //        if (row[dtCntrl.Name] != null)
                    //            row[dtCntrl.Name] = Convert.ToDateTime(row[dtCntrl.Name]).ToMWDateTimeString_Unformatted();
                    //    }
                    //}
                }
                catch (Exception)
                {
                    //throw; suppress the error as this may throw error while designing the forms if tables are not present in the DB
                }

                IEnumerable&lt;X.xControl&gt; xControlList = dg.Controls.Where(xc =&gt; xc.Type == X.ControlType.AttachmentControl);
                isExistsAttachmentControl = xControlList.Count() &gt; 0;

                if (isExistsAttachmentControl)
                {
                    xControlList.ForEach(aCtrl =&gt;
                        AddAttachmentColumns(dg.PrimaryKeyName, (aCtrl as X.AttachmentControl).ModuleId, ref table));
                    var guidColumn = new DataColumn($&quot;{dg.Name}RowGuid&quot;);
                    guidColumn.DefaultValue = Guid.NewGuid();
                    table.Columns.Add(guidColumn);
                }


                for (int i = 0; i &lt; dg.Controls.Count; i++)
                {
                    X.xControl xc = dg.Controls[i];
                    if (xc.Footer != X.Footer.None)
                        showFooter = showFooter || true;
                    if ((xc.Type == X.ControlType.DropDownList &amp;&amp; !dg.AllowInlineEdit) || (xc.Type == X.ControlType.DropDownTreeDataControl))
                    {
                        dg.Controls.Insert(i++ + 1, new X.xColumn
                        {
                            Name = xc.Name + &quot;_Disp&quot;,
                            Caption = xc.ParseDynamicString(xc.Caption),
                            DBType = &quot;varchar(max)&quot;,
                            ReadOnly = xc.ReadOnly,
                            ShowInGrid = xc.ShowInGrid,
                            Type = X.ControlType.DDLDisplayControl,
                            Width = string.IsNullOrWhiteSpace(xc.Width) ? null : ParseHTMLUnitValue(xc.Width).ToString(),
                            ColumnGroup = xc.ColumnGroup
                        });
                    }
                }

                //TODO: This block may not be useful. Revist this and delet if not required.
                if (table != null &amp;&amp; table.Columns.Count &gt; 0 &amp;&amp; !dg.AllowInlineEdit)
                {
                    grid.AutoGenerateColumns = true;
                }
                else
                {
                    // This section is for form builder 
                    foreach (X.xControl xc in dg.Controls)
                    {
                        GridColumn controlColumn = grid.MasterTableView.GetColumnSafe(xc.Name);

                        if (controlColumn != null)
                            continue;

                        if (xc.Type == X.ControlType.DropDownList)
                        {
                            var column = new GridTemplateColumn();
                            column.ItemTemplate = new RadGridCustomTemplate(xc.Name, xc, &quot;I&quot;);
                            column.EditItemTemplate = new RadGridCustomTemplate(xc.Name, xc, &quot;E&quot;);
                            column.DataField = xc.Name;
                            column.UniqueName = xc.Name;
                            column.HeaderText = string.IsNullOrEmpty(xc.Caption)
                                ? xc.Name
                                : xc.ParseDynamicString(xc.Caption);
                            if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;
                            column.HeaderStyle.Font.Bold = true;
                            grid.MasterTableView.Columns.Add(column);

                        }
                        else if (xc.Type.IsEqualToAny(X.ControlType.Date, X.ControlType.DateTime))
                        {
                            string dateFormat = xc.GetControlFormat();
                            if (string.IsNullOrEmpty(dateFormat))
                                dateFormat = xc.Type == X.ControlType.Date ? AMP3ApplicationSettings.Instance.FORMAT_DATE : AMP3ApplicationSettings.Instance.FORMAT_DATETIME;

                            var column = new GridDateTimeColumn
                            {
                                DataField = xc.Name,
                                UniqueName = xc.Name,
                                HeaderText =
                                    string.IsNullOrEmpty(xc.Caption) ? xc.Name : xc.ParseDynamicString(xc.Caption),
                                Visible = (xc.Type != X.ControlType.Hidden &amp;&amp; xc.Hidden != true),
                                DataFormatString = string.Format(&quot;{{0:{0}}}&quot;, dateFormat)
                            };

                            if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                            grid.MasterTableView.Columns.Add(column);

                        }

                        else if (xc.Type == X.ControlType.Integer || xc.Type == X.ControlType.Numeric)
                        {
                            var column = new GridNumericColumn
                            {
                                DataField = xc.Name,
                                UniqueName = xc.Name,
                                HeaderText =
                                    string.IsNullOrEmpty(xc.Caption) ? xc.Name : xc.ParseDynamicString(xc.Caption),
                                Visible = (xc.Type != X.ControlType.Hidden &amp;&amp; xc.Hidden != true)
                            };

                            if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                            grid.MasterTableView.Columns.Add(column);

                        }
                        else if (xc.Type == X.ControlType.CheckBox)
                        {
                            var column = new GridTemplateColumn();
                            column.ItemTemplate = new RadGridCustomTemplate(xc.Name, xc, &quot;B&quot;);
                            column.EditItemTemplate = new RadGridCustomTemplate(xc.Name, xc, &quot;B&quot;);
                            column.ClientItemTemplate = &quot;&lt;span class=\&quot;cbC\&quot; data-control-name=\&quot;&quot; + xc.Name + &quot;\&quot;&gt;&lt;input type=\&quot;checkbox\&quot; onclick=\&quot;BindGridValuesforPost($(this).closest(&#39;div.RadGrid&#39;).attr(&#39;id&#39;)); \&quot;&gt;&lt;/span&gt;&quot;;

                            column.DataField = xc.Name;
                            column.UniqueName = xc.Name;
                            column.HeaderText = string.IsNullOrEmpty(xc.Caption)
                                ? xc.Name
                                : xc.ParseDynamicString(xc.Caption);

                            if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                            column.HeaderStyle.Font.Bold = true;
                            grid.MasterTableView.Columns.Add(column);

                        }
                        else if (xc.Type == X.ControlType.DropDownTreeDataControl)
                        {
                            var column = new GridBoundColumn();
                            //column.ItemTemplate = new RadGridDropDownTreeTemplate(xc.Name, xc, DynamicGridTemplateType.ItemTemplate);
                           // column.EditItemTemplate = new RadGridDropDownTreeTemplate(xc.Name, xc, DynamicGridTemplateType.EditItemTemplate);
                            column.DataField = xc.Name;
                            column.UniqueName = xc.Name;
                            column.HeaderText = string.IsNullOrEmpty(xc.Caption)
                                ? xc.Name
                                : xc.ParseDynamicString(xc.Caption);
                            if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;
                            column.HeaderStyle.Font.Bold = true;
                            column.ReadOnly = false;
                            grid.MasterTableView.Columns.Add(column);

                        }
                        else
                        {
                            if (!xc.Type.IsEqualToAny(dg.ControlTypesNotToBeShownOnList))
                            {
                                var column = new GridBoundColumn
                                {
                                    DataField = xc.Name,
                                    UniqueName = xc.Name,
                                    HeaderText = string.IsNullOrEmpty(xc.Caption) ? xc.Name : xc.ParseDynamicString(xc.Caption),
                                    //Visible = (xc.Type != ControlType.Hidden &amp;&amp; xc.Hidden != true)
                                };

                                if (xc.ValidationTypes.Contains(X.ValidationType.Required))
                                    column.HeaderText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                                grid.MasterTableView.Columns.Add(column);
                            }
                        }
                    }
                }

                try
                {
                    // before assigning the table, we need to create formula derived columns and columns for ddlValueControl in the grid
                    string data =
                        (dg.ControlReference[1] as HiddenField).Page.Request.Form[
                            (dg.ControlReference[1] as HiddenField).UniqueID];
                    if (!string.IsNullOrEmpty(data))
                    {
                        DataTable dt = dg.CreateDerivedColumns(table);
                        DataTable dtClientData = (DataTable)JsonConvert.DeserializeObject(data, (typeof(DataTable)));
                        dt.Rows.Clear();
                        //remove the column multi if present
                        //this column is used for row selection checkbox
                        //this name is not supposed to be used for any other column
                        if (dtClientData.Columns.Contains(&quot;Multi&quot;))
                            dtClientData.Columns.Remove(&quot;Multi&quot;);


                        IEnumerable&lt;DataColumn&gt; columnList = dt.Columns.OfType&lt;DataColumn&gt;();
                        IEnumerable&lt;DataRow&gt; rowList = dtClientData.Rows.OfType&lt;DataRow&gt;();

                        string CONST_StringType = typeof(string).FullName;
                        string CONST_DateTimeType = typeof(DateTime).FullName;
                        foreach (DataRow r in rowList)
                        {
                            object[] colValueObjectList = new object[columnList.Count()];
                            int curPointer = 0;

                            foreach (DataColumn c in columnList)
                            {
                                object colValueObject = DBNull.Value;


                                if ((r.Table.Columns.Contains(c.ColumnName)) &amp;&amp; (r[c.ColumnName] == DBNull.Value || r[c.ColumnName] == null || string.IsNullOrEmpty(r[c.ColumnName].ToString()) || r[c.ColumnName].ToString2().Trim().IsEqualToAny(string.Empty, &quot;_DBNULL_&quot;)))
                                {
                                    if (c.DataType.FullName != CONST_StringType)
                                        colValueObject = DBNull.Value;
                                else
                                        colValueObject = r[c.ColumnName];
                                }
                                else if (!(r.Table.Columns.Contains(c.ColumnName)))
                                {
                                    colValueObject = DBNull.Value;
                                }
                                else
                                {
                                    if (c.DataType.FullName != CONST_DateTimeType)
                                        colValueObject = r[c.ColumnName];
                                    else
                                    {
                                        DateTime? outDateTime;
                                        if (r[c.ColumnName].TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture))
                                        {
                                            if (outDateTime.HasValue)
                                                colValueObject = outDateTime;
                                            else
                                                colValueObject = DBNull.Value;
                        }
                                    }
                                }

                                colValueObjectList[curPointer++] = colValueObject;
                        }
                            dt.Rows.Add(colValueObjectList);
                        }

                        grid.DataSource = dt;
                        grid.DataBind();
                    }
                    else if (data == &quot;[]&quot;)
                    {
                        DataTable dt = dg.CreateDerivedColumns(table);
                        dt.Rows.Clear();
                        grid.DataSource = dt;
                        grid.DataBind();
                    }
                    else
                    {
                        DataTable dt = dg.CreateDerivedColumns(table);
                        grid.DataSource = dt;
                        grid.DataBind();
                    }

                    if (dg.AllowMultiSelect)
                    {
                        grid.AllowMultiRowSelection = true;
                        GridClientSelectColumn multiSelect = new GridClientSelectColumn();
                        multiSelect.UniqueName = &quot;Multi&quot;;
                        multiSelect.Resizable = false;
                        multiSelect.Reorderable = false;
                        multiSelect.HeaderStyle.Width = new Unit(32, UnitType.Pixel);
                        grid.Columns.Insert(0, multiSelect);
                    }

                    // Subscribe event to handle drag drop. And also create drag drop column.
                    if (!string.IsNullOrEmpty(dg.OnRowDropping))
                    {
                        grid.ClientSettings.AllowRowsDragDrop = true;
                        grid.ClientSettings.Selecting.AllowRowSelect = true;
                        grid.ClientSettings.ClientEvents.OnRowDropping = dg.OnRowDropping;

                        GridDragDropColumn dragDropColumn = new GridDragDropColumn();
                        dragDropColumn.UniqueName = &quot;DragDrop&quot;;
                        dragDropColumn.Resizable = false;
                        dragDropColumn.Reorderable = false;
                        dragDropColumn.HeaderStyle.Width = new Unit(20, UnitType.Pixel);

                        // If multi select checkbox is there then create column at 2nd position else at 1st itself.
                        if (dg.AllowMultiSelect)
                            grid.Columns.Insert(1, dragDropColumn);
                        else
                            grid.Columns.Insert(0, dragDropColumn);
                    }

                    if (grid.AutoGenerateColumns)
                    {
                        #region AutoGenerateColumns
                        foreach (X.xControl xc in dg.Controls)
                        {
                            GridColumn col = grid.MasterTableView.GetColumnSafe(xc.Name);

                            if (col == null)
                                continue;

                            if (xc != null &amp;&amp; !string.IsNullOrEmpty(xc.Caption))
                            {
                                col.HeaderText = xc.ParseDynamicString(xc.Caption);
                            }
                        }
                        #endregion AutoGenerateColumns
                    }

                    //Change HeaderText 
                    if (grid.MasterTableView.GetItems(GridItemType.Header).Length &gt; 0)
                    {
                        #region Change HeaderText

                        GridHeaderItem header = grid.MasterTableView.GetItems(GridItemType.Header)[0] as GridHeaderItem;
                        if (header != null &amp;&amp; grid.MasterTableView.GetColumnSafe(&quot;img_DataHasAttachments&quot;) != null)
                        {
                            grid.MasterTableView.GetColumnSafe(&quot;img_DataHasAttachments&quot;).HeaderStyle.Width = new Unit(
                                32, System.Web.UI.WebControls.UnitType.Pixel);
                            (grid.MasterTableView.GetColumnSafe(&quot;img_DataHasAttachments&quot;) as GridBoundColumn).HeaderText
                                =
                                &quot;&lt;img src=\&quot;../../Images/Toolbar/IcnAttachment.gif\&quot; alt=\&quot;Attachments\&quot; Title=\&quot;Attachments\&quot; /&gt;&quot;;
                            (grid.MasterTableView.GetColumnSafe(&quot;img_DataHasAttachments&quot;) as GridBoundColumn)
                                .AllowFiltering = false;
                        }
                        grid.Rebind();
                        #endregion Change HeaderText
                    }


                    foreach (X.xControl xc in dg.Controls)
                    {
                        GridColumn column = grid.MasterTableView.GetColumnSafe(xc.Name);
                        if (column == null)
                            continue;

                        #region Handle controls

                        if (xc.Type == X.ControlType.Hidden || !(xc.ShowInGrid))
                            column.Display = false;

                        if ((xc.Type == X.ControlType.DropDownList &amp;&amp; !dg.AllowInlineEdit) 
                            || (xc.Type == X.ControlType.DropDownTreeDataControl))
                            column.Display = false;

                        //Set Header and Column style
                        if (!String.IsNullOrEmpty(xc.Width))
                            column.ItemStyle.Width = column.HeaderStyle.Width = ParseHTMLUnitValue(xc.Width);

                        string format;
                        if (!string.IsNullOrEmpty(format = xc.Format))
                        {
                            format = xc.GetControlFormat();
                            if (!string.IsNullOrEmpty(format) &amp;&amp; column is GridBoundColumn)
                            {
                                (column as GridBoundColumn).DataFormatString = &quot;{0:&quot; + format + &quot;}&quot;;
                            }
                        }

                        if (xc.Type == X.ControlType.Numeric || xc.Type == X.ControlType.Integer)
                        {
                            if (grid.MasterTableView.Columns.Count &gt; 0 &amp;&amp;
                                column.UniqueName == grid.MasterTableView.Columns[grid.MasterTableView.Columns.Count - 1].UniqueName)
                            {
                                MWGrid.SetHeaderStyle(grid, column.UniqueName, &quot;padding-right&quot;, &quot;25px&quot;);
                                MWGrid.SetColumnStyle(grid, column.UniqueName, &quot;padding-right&quot;, &quot;25px&quot;);
                            }

                            MWGrid.Property property = new MWGrid.Property();
                            property.HorizontalAlign = HorizontalAlign.Right;

                            MWGrid.SetHeaderProperties(grid, column.UniqueName, property);
                            MWGrid.SetColumnProperties(grid, column.UniqueName, property);
                        }

                        //If Line editing is enabled, make all the columns editable leaving all read only columns
                        if (column is GridBoundColumn) (column as GridBoundColumn).ReadOnly = true;
                        else if (column is GridTemplateColumn) (column as GridTemplateColumn).ReadOnly = true;
                        else if (column is GridNumericColumn) (column as GridNumericColumn).ReadOnly = true;
                        else if (column is GridDateTimeColumn) (column as GridDateTimeColumn).ReadOnly = true;
                        else if (column is GridCheckBoxColumn) (column as GridCheckBoxColumn).ReadOnly = true;
                        //Wrapping the column headers. 
                        column.HeaderStyle.Wrap = true;
                        
                        if (xc.Type == X.ControlType.TextArea)
                        {
                            column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;textAreaLineBreaks&quot; : column.ItemStyle.CssClass + &quot; textAreaLineBreaks&quot;;
                            if (!dg.AllowInlineEdit || this.model.form.engine.IsViewMode)
                            {
                                column.ItemStyle.Height = string.IsNullOrEmpty(dg.RowHeight) ? new Unit(&quot;28px&quot;) : new Unit(dg.RowHeight);
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;textAreaViewMode&quot; : column.ItemStyle.CssClass + &quot; textAreaViewMode&quot;;
                            }
                            else
                            {
                                column.ItemStyle.Height = string.IsNullOrEmpty(xc.Height) ? new Unit(&quot;100px&quot;) : new Unit(xc.Height);
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;textAreaEditMode&quot; : column.ItemStyle.CssClass + &quot; textAreaEditMode&quot;;
                            }
                        }

                        bool canEdit = true;
                        if (xc.Type == X.ControlType.DDLDisplayControl)
                        {
                            X.xControl xcDisp = dg.form.GetControl(xc.Name.Substring(0, xc.Name.Length - (&quot;_Disp&quot;).Length));
                            if (xcDisp.Type == X.ControlType.DropDownTreeDataControl)
                                canEdit = false;
                        }

                        if (canEdit &amp;&amp; !this.model.form.engine.IsViewMode &amp;&amp; dg.AllowInlineEdit &amp;&amp; !currentStageVisibility.Equals(&quot;view&quot;, StringComparison.CurrentCultureIgnoreCase) &amp;&amp; !xc.ReadOnly &amp;&amp; xc.Type != X.ControlType.DropDownTreeDataControl)
                        {
                            #region Make ReadOnly False
                            //ToDo: Make columns updateable 
                            if (column is GridBoundColumn)
                            {
                                (column as GridBoundColumn).ReadOnly = false;
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                            }
                            else if (column is GridTemplateColumn)
                            {
                                (column as GridTemplateColumn).ReadOnly = false;
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                            }
                            else if (column is GridDateTimeColumn)
                            {
                                (column as GridDateTimeColumn).ReadOnly = false;
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                            }
                            else if (column is GridNumericColumn)
                            {
                                (column as GridNumericColumn).ReadOnly = false;
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                            }
                            else if (column is GridCheckBoxColumn)
                            {
                                (column as GridCheckBoxColumn).ReadOnly = false;
                                column.ItemStyle.CssClass = string.IsNullOrEmpty(column.ItemStyle.CssClass) ? &quot;gridInlineEditing&quot; : column.ItemStyle.CssClass + &quot; gridInlineEditing&quot;;
                            }

                            if (xc.Type == X.ControlType.Date || xc.Type == X.ControlType.Numeric)
                            {
                                //ToDo: Make the column editable with proper input control 
                                //uwg.Columns[counter].Type = ColumnType.Custom;
                                //Name of the control
                                //uwg.Columns[counter].EditorControlID = ControlContainer.GetParent&lt;DataBaseContainer&gt;(xc).Name + &quot;_&quot; + xc.Name + &quot;_id&quot;;
                            }
                            #endregion Make ReadOnly False
                        }
                        // to avoid XSS attack
                        if (column is GridBoundColumn &amp;&amp; string.IsNullOrEmpty((column as GridBoundColumn).DataFormatString))
                            (column as GridBoundColumn).HtmlEncode = true;

                        #endregion Handle controls
                    }


                    grid.MasterTableView.EditMode = GridEditMode.Batch;
                    grid.MasterTableView.BatchEditingSettings.EditType = GridBatchEditingType.Cell;

                    grid.ClientSettings.ClientEvents.OnKeyPress = &quot;GridInlineEditorKeyPress&quot;;
                    grid.ClientSettings.ClientEvents.OnBatchEditClosed = &quot;GridBatchEditClosed&quot;;
                    grid.ClientSettings.AllowKeyboardNavigation = true;
                    grid.ClientSettings.ClientEvents.OnBatchEditGetCellValue = &quot;getCellValue&quot;;

                    grid.AllowSorting = dg.AllowSorting;

                    if (!string.IsNullOrEmpty(dg.OnEditCellValueChanged))
                        grid.ClientSettings.ClientEvents.OnBatchEditCellValueChanged = dg.OnEditCellValueChanged;

                    if (showFooter)
                    {
                        grid.ShowFooter = showFooter;
                        RenderDynamicGridFooter(grid, dg);
                    }

                    //If the columns have column group specified, then assign the column groups to columns
                    if (dg.ColumnGroups != null &amp;&amp; dg.ColumnGroups.ColumnGroup.Count &gt; 0)
                    {
                        foreach (X.xColumnGroup group in dg.ColumnGroups.ColumnGroup)
                        {
                            GridColumnGroup grp = new GridColumnGroup();
                            grp.Name = group.Name;
                            grp.HeaderText = group.Caption;
                            if (!string.IsNullOrEmpty(group.ParentColumnGroup))
                                grp.ParentGroupName = group.ParentColumnGroup;

                            if (group.Align != X.GridHeaderAlignment.NotSet)
                                grp.HeaderStyle.HorizontalAlign =
                                    (HorizontalAlign)Enum.Parse(typeof(HorizontalAlign), group.Align.ToString());
                            else
                                grp.HeaderStyle.HorizontalAlign = HorizontalAlign.Center;

                            grp.HeaderStyle.Font.Bold = true;

                            grid.MasterTableView.ColumnGroups.Add(grp);
                        }

                        foreach (X.xColumn col in dg.Controls)
                        {
                            if (!string.IsNullOrEmpty(col.ColumnGroup))
                            {
                                GridColumn column = grid.MasterTableView.GetColumnSafe(col.Name);
                                column.ColumnGroupName = col.ColumnGroup;
                            }
                        }
                    }

                    grid.Rebind();
                }
                catch (Exception ex)
                {
                    // ignore errors on the bind but must log the error
                    Logging.Logger.Log(&quot;RendererHtml&quot;, ex);
                }
            }
        }

        private void RenderDynamicGridFooter(RadGrid grid, X.DynamicGrid dg)
        {
            int counter = 0;
            grid.ClientSettings.ClientEvents.OnGridCreated = &quot;SetFooter&quot;;
            foreach (X.xControl ctrl in dg.Controls)
            {
                if (ctrl.Footer != X.Footer.None)
                {
                    string format;
                    if (!String.IsNullOrEmpty(format = ctrl.Format))
                    {
                        format = ctrl.GetControlFormat();
                        (grid.MasterTableView.GetColumnSafe(ctrl.Name) as GridBoundColumn).DataFormatString = &quot;{0:&quot; +
                                                                                                              format +
                                                                                                              &quot;}&quot;;
                    }
                    //ToDo: Add footer to columns 
                    //grid.MasterTableView.GetColumnSafe(ctrl.Name) = GetSummaryInfo(ctrl.Footer);
                    grid.MasterTableView.GetColumnSafe(ctrl.Name).FooterStyle.HorizontalAlign = HorizontalAlign.Right;
                    if (counter == grid.MasterTableView.AutoGeneratedColumns.Length - 1)
                    {
                        GridItem footer = grid.MasterTableView.GetItems(GridItemType.Footer).Length &gt; 0
                            ? grid.MasterTableView.GetItems(GridItemType.Footer)[0]
                            : null;
                        if (footer is GridFooterItem)
                        {
                            MWGrid.SetCellStyle(footer, ctrl.Name, &quot;padding-right&quot;, &quot;25px&quot;);
                        }
                    }
                }
                counter++;
            }
        }

        private SummaryInfo GetSummaryInfo(X.Footer footer)
        {
            switch (footer)
            {
                case X.Footer.Avg:
                    return SummaryInfo.Avg;
                case X.Footer.Count:
                    return SummaryInfo.Count;
                case X.Footer.Max:
                    return SummaryInfo.Max;
                case X.Footer.Min:
                    return SummaryInfo.Min;
                case X.Footer.Sum:
                    return SummaryInfo.Sum;
                default:
                    return SummaryInfo.Sum;
            }
        }

        private void RenderEmbeddedForm(X.ControlContainer cont, object parent)
        {
            SetUniqueContainerName(ref cont);
            var pageDiv = parent as HtmlGenericControl;
            var ef = cont as X.EmbeddedForm;
            HtmlGenericControl divControl = CreateContainingDivControl(ef.Name, &quot;Text&quot;, ef.Width, false, &quot;&quot;);
            pageDiv.Controls.Add(divControl);
            bool isTabbedLayout = ef.Layout.Equals(X.EFLayout.Tab);

            string[] moduleIds = ef.GetQueryFromDataSource();

            if (moduleIds != null &amp;&amp; moduleIds.Length &gt; 0)
            {
                List&lt;Tuple&lt;string, object, BrixFormModel&gt;&gt; parentContainerList = new List&lt;Tuple&lt;string, object, BrixFormModel&gt;&gt;();

                X.xTabs parentTabContainer = new X.xTabs();
                if(isTabbedLayout)
                    ef.Containers.Add(parentTabContainer);

                for (int i = 0; i &lt; moduleIds.Length; i++)
                {
                    string formN = moduleIds[i];
                    BrixFormModel model = new BrixFormModel(formN, formN + &quot;.xml&quot;, XMLType.Form);

                    if (model.form == null) continue;

                    model.form.IsInsideEmbeddedForm = true;
                    if (ef.form.instanceID != null)
                    {
                        int formInstance = EmbeddedFormHelper.GetEmbeddedFormInstance(model, ef.form.Name, ef.form.instanceID.ToInt32_2());
                        if (formInstance &gt; 0)
                        {
                            model.form.instanceID = formInstance.ToString();
                        }
                    }
                    if (isTabbedLayout)
                    {
                        X.xTab tab = new X.xTab();
                        tab.Caption = model.form.Header;
                        tab.IsSelected = parentTabContainer.Containers.Count == 0;
                        parentTabContainer.Containers.Add(tab);

                        parentContainerList.Add(new Tuple&lt;string, object, BrixFormModel&gt;(model.form.Name, null, model));
                        tab.Containers.Add(model.form);
                    }

                    else
                    {
                        XMLRenderingEngine engine = new XMLRenderingEngine(ef.page, model, divControl);
                        engine.InstanceId = model.form.instanceID ?? &quot;&quot;;
                        engine.Render(X.RenderFormat.RenderHtml);
                        ef.Containers.Add(model.form);
                    }

                }
                if (isTabbedLayout)
                {
                    parentTabContainer.Render(divControl, X.RenderFormat.RenderHtml);

                    int j = 0;
                    foreach (Tuple&lt;string, object, BrixFormModel&gt; row in parentContainerList)
                    {
                        XMLRenderingEngine engine = new XMLRenderingEngine(ef.page, row.Item3, parentTabContainer.Containers[j++].ControlReference[0]);
                        engine.InstanceId = row.Item3.form.instanceID ?? &quot;&quot;;
                        engine.Render(X.RenderFormat.RenderHtml);
                    }
                }
            }



        }

        private void RenderDynamicGrid(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            if (model.form.engine.IsDesignMode)
            {
                RenderGridForFormBuilder(cont, parent);
                return;
            }

            var pageDiv = parent as HtmlGenericControl;
            var dg = cont as X.DynamicGrid;

            if (dg.Controls.Where(xc =&gt; xc.Type == X.ControlType.AttachmentControl).Any())
            {
                var guidControl = new X.xControl();
                guidControl.Name = $&quot;{dg.Name}RowGuid&quot;;
                guidControl.Hidden = true;
                dg.Controls.Add(guidControl);
            }

            InitializeGrid(cont, dg);

            //If the conatiner is ajax enabled, then this div should go inside a update panel
            HtmlGenericControl divControl;
            if (dg.EnableAjax)
            {
                UpdatePanel uPanel = new UpdatePanel();
                pageDiv.Controls.Add(uPanel);
                divControl = CreateContainingDivControl(dg.Name, &quot;DynamicGrid&quot;, dg.Width, false);
                uPanel.ContentTemplateContainer.Controls.Add(divControl);
            }
            else
            {
                divControl = CreateContainingDivControl(dg.Name, &quot;DynamicGrid&quot;, dg.Width, false);
                pageDiv.Controls.Add(divControl);
            }

            if (!string.IsNullOrEmpty(dg.Attributes))
                divControl.Attributes.Add(&quot;style&quot;, dg.Attributes);

            if (!string.IsNullOrEmpty(cont.TabName))
            {
                X.xTab tab = cont.form.GetContainer(cont.TabName) as X.xTab;
                if (tab != null)
                    divControl.Attributes.Add(&quot;TabName&quot;, cont.TabName);
            }

            if (string.IsNullOrEmpty(dg.Caption) &amp;&amp; dg.Visibility != X.ControlVisibility.None)
                dg.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(dg.Caption))
                divControl.Controls.Add(RenderCaption(dg.form.CaptionStyle, dg.ParseDynamicString(dg.Caption),
                    X.ContainerTypes.DynamicGrid, dg.Visibility, dg));

            var gridCtrl = dg.ControlReference[0] as RadGrid;
            var gridDataCtrl = dg.ControlReference[1] as HiddenField;
            var gridMandatoryFieldsCtrl = dg.ControlReference[2] as HiddenField;

            if (!string.IsNullOrEmpty(dg.Height))
                gridCtrl.Height = ParseHTMLUnitValue(dg.Height);

            divControl.Controls.Add(gridCtrl);
            divControl.Controls.Add(gridDataCtrl);
            divControl.Controls.Add(gridMandatoryFieldsCtrl);

            //if (!dg.page.IsPostBack)
            BindDynamicGridControl(dg);

            string footerDetails = string.Empty;

            dg.Controls.ForEach(
                xc =&gt;
                {
                    if (xc.Footer != X.Footer.None || !string.IsNullOrEmpty(xc.FooterCaption))
                    {
                        int decimalDigits = 4;
                        string format = string.Empty;
                        if (!string.IsNullOrEmpty(xc.Format))
                        {
                            format = xc.GetControlFormat();
                            decimalDigits = CoreDatabaseHelper.GetDigitsAfterDecimal(format);
                        }
                        footerDetails += xc.Name + &quot;|#&quot; + xc.Footer.ToString() + &quot;|#&quot; + decimalDigits + &quot;|#&quot; +
                                         (string.IsNullOrEmpty(xc.FooterCaption) ? &quot;&quot; : xc.FooterCaption.ToString()) +
                                         &quot;|#&quot; +
                                         (string.IsNullOrEmpty(xc.FooterAlignment) ? &quot;&quot; : xc.FooterAlignment) +
                                         &quot;|#&quot; +
                                         (string.IsNullOrEmpty(format) ? &quot;&quot; : format) + &quot;^*&quot;;
                    }
                });

            footerDetails = footerDetails.TrimEnd(&quot;^*&quot;.ToCharArray());

            if (!string.IsNullOrEmpty(footerDetails))
            {
                divControl.Attributes.Add(&quot;FooterDetails&quot;, footerDetails);
            }

            if (!dg.ReadOnly &amp;&amp; currentStageVisibility.Equals(&quot;Edit&quot;, StringComparison.CurrentCultureIgnoreCase))
            {
                var buttonsTable = new HtmlTable();
                var buttonhtr = new HtmlTableRow();
                buttonsTable.Rows.Add(buttonhtr);

                buttonsTable.CellSpacing = 0;
                buttonsTable.Style.Add(HtmlTextWriterStyle.MarginTop, &quot;5px&quot;);

                divControl.Controls.Add(buttonsTable);
                string cancelClientID = string.Empty;
                string saveClientID = string.Empty;
                string editTemplateClientID = CreateEditTemplate(dg, divControl, gridCtrl.ClientID,
                    gridDataCtrl.ClientID, out cancelClientID, out saveClientID);

                var BtnAdd = new Button();
                BtnAdd.Text = &quot;Add&quot;;
                BtnAdd.Enabled = model.form.engine.IsViewMode ? false : true;
                if (dg.ShowAddButton)
                {
                    HtmlTableCell tdAdd = NewCell(BtnAdd);
                    tdAdd.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;top&quot;);
                    tdAdd.Style.Add(HtmlTextWriterStyle.PaddingRight, &quot;3px&quot;);
                    buttonhtr.Cells.Add(tdAdd);
                }

                //TODO: Temporary fix for picker cntrol while modifying a form
                if (!dg.form.DesignMode &amp;&amp; !string.IsNullOrEmpty(dg.PickerName))
                {
                    X.Picker picker = model.form.GetContainer(dg.PickerName) as X.Picker;
                    if (!model.form.engine.IsViewMode)
                    {
                        HtmlTableCell tdPicker =
                            NewCell(InitializePicker(picker, dg.Name, dg.EnableMultiSelect, dg.PickerButtonText,
                                dg.PickerName, dg.PickerButtonWidth, dg.AfterSelectScript, dg.BeforePickerLoadScript,
                                gridID: gridCtrl.ClientID, pickerIdColumn: dg.PickerIdColumn));
                        tdPicker.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;top&quot;);
                        tdPicker.Style.Add(HtmlTextWriterStyle.PaddingRight, &quot;3px&quot;);
                        buttonhtr.Cells.Add(tdPicker);
                    }
                }

                var BtnEdit = new Button();
                BtnEdit.Text = (string.IsNullOrEmpty(dg.EditButtonText) ? &quot;Edit&quot; : dg.EditButtonText);
                BtnEdit.Enabled = model.form.engine.IsViewMode ? false : true;
                if (dg.ShowEditButton)
                {
                    HtmlTableCell tdEdit = NewCell(BtnEdit);
                    tdEdit.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;top&quot;);
                    tdEdit.Style.Add(HtmlTextWriterStyle.PaddingRight, &quot;3px&quot;);
                    buttonhtr.Cells.Add(tdEdit);
                }

                var BtnView = new Button();
                BtnView.Text = &quot;View&quot;;
                if (dg.ShowViewButton)
                {
                    HtmlTableCell tdView = NewCell(BtnView);
                    tdView.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;top&quot;);
                    tdView.Style.Add(HtmlTextWriterStyle.PaddingRight, &quot;3px&quot;);
                    buttonhtr.Cells.Add(tdView);
                }


                var BtnEditGhost = new Button();
                BtnEditGhost.Text = (string.IsNullOrEmpty(dg.EditButtonText) ? &quot;Edit&quot; : dg.EditButtonText);
                BtnEditGhost.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                buttonhtr.Cells.Add(NewCell(BtnEditGhost));

                var BtnViewGhost = new Button();
                BtnViewGhost.Text = &quot;View&quot;;
                BtnViewGhost.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                buttonhtr.Cells.Add(NewCell(BtnViewGhost));

                var BtnDelete = new Button();
                BtnDelete.Text = &quot;Delete&quot;;
                BtnDelete.OnClientClick = &quot;return DeleteRow(&#39;&quot; + gridCtrl.ClientID + &quot;&#39;,&#39;&quot; + gridDataCtrl.ClientID +
                                          &quot;&#39;,&#39;&quot; + dg.AfterRowDeleteScript + &quot;&#39;,&#39;&quot; + dg.BeforeRowDeleteScript + &quot;&#39;,&#39;&quot; +
                                          editTemplateClientID + &quot;&#39;)&quot;;
                BtnDelete.Enabled = model.form.engine.IsViewMode ? false : true;
                if (dg.ShowDeleteButton)
                {
                    HtmlTableCell tdDelete = NewCell(BtnDelete);
                    tdDelete.Style.Add(HtmlTextWriterStyle.VerticalAlign, &quot;top&quot;);
                    tdDelete.Style.Add(HtmlTextWriterStyle.PaddingRight, &quot;3px&quot;);
                    buttonhtr.Cells.Add(tdDelete);
                }

                divControl.Controls.Add(buttonsTable);

                string afterDynamicGridCloseScript = $&quot;ClearAttachmentsOnDynamicGridCancel(&#39;{editTemplateClientID}&#39;)&quot;;

                if (dg.ShowAddButton)
                {
                    ModalPopupExtender addPopup = new ModalPopupExtender();
                    divControl.Controls.Add(addPopup);
                    addPopup.AddNewPopup(editTemplateClientID, BtnAdd.ClientID, cancelClientID, 200, 200,
                        &quot;New &quot; + (string.IsNullOrEmpty(dg.Caption) ? &quot;&quot; : dg.ParseDynamicString(dg.Caption)), afterDialogCloseScript: afterDynamicGridCloseScript);
                }

                ModalPopupExtender editPopup = new ModalPopupExtender();
                divControl.Controls.Add(editPopup);
                editPopup.AddNewPopup(editTemplateClientID, BtnEditGhost.ClientID, cancelClientID, 200, 200,
                    &quot;Edit &quot; + (string.IsNullOrEmpty(dg.Caption) ? &quot;&quot; : dg.ParseDynamicString(dg.Caption)), afterDialogCloseScript: afterDynamicGridCloseScript);

                ModalPopupExtender viewPopup = new ModalPopupExtender();
                divControl.Controls.Add(viewPopup);
                viewPopup.AddNewPopup(editTemplateClientID, BtnViewGhost.ClientID, cancelClientID,
                    &quot;View &quot; + (string.IsNullOrEmpty(dg.Caption) ? &quot;&quot; : dg.ParseDynamicString(dg.Caption)));

                if (dg.ShowAddButton)
                {
                    BtnAdd.OnClientClick = &quot;SetSaveButtonId(&#39;&quot; + saveClientID + &quot;&#39;); return ShowTemplate(&#39;&quot; + editTemplateClientID + &quot;&#39;,&#39;&quot; + gridCtrl.ClientID +
                                           &quot;&#39;,&#39;Add&#39;,&#39;&quot; + BtnEditGhost.ClientID + &quot;&#39;,&#39;&quot; + dg.BeforeRowAddScript + &quot;&#39;)&quot;;
                }
                BtnEdit.OnClientClick = &quot;SetSaveButtonId(&#39;&quot; + saveClientID + &quot;&#39;); return ShowTemplate(&#39;&quot; + editTemplateClientID + &quot;&#39;,&#39;&quot; + gridCtrl.ClientID +
                                        &quot;&#39;,&#39;Edit&#39;,&#39;&quot; + BtnEditGhost.ClientID + &quot;&#39;,&#39;&#39;,&#39;&quot; + dg.BeforeRowEditScript +
                                        &quot;&#39;,&#39;&#39;,&#39;&quot; + dg.EditButtonText + &quot;&#39;)&quot;;
                BtnView.OnClientClick = &quot;return ShowTemplate(&#39;&quot; + editTemplateClientID + &quot;&#39;,&#39;&quot; + gridCtrl.ClientID +
                                        &quot;&#39;,&#39;View&#39;,&#39;&quot; + BtnViewGhost.ClientID + &quot;&#39;,&#39;&#39;,&#39;&quot; + dg.BeforeRowEditScript + &quot;&#39;)&quot;;

                if (dg.form.DesignMode)
                    RenderBorderInDesignMode(divControl, true);
            }

            if (!string.IsNullOrEmpty(dg.PickerName))
            {
                divControl.Attributes.Add(&quot;PickerName&quot;, dg.PickerName);
                divControl.Attributes.Add(&quot;ControlName&quot;, dg.Name + &quot;_&quot; + dg.PickerName);
                divControl.Attributes.Add(&quot;ClntId&quot;, gridCtrl.ClientID);
            }
        }

        private void RenderInclude(X.ControlContainer cont, object parent)
        {
            var include = cont as X.Include;
            if (include != null)
            {
                if (include.form.DesignMode)
                {
                    var pageDiv = parent as HtmlGenericControl;
                    SetUniqueContainerName(ref cont);
                    var container = CreateContainingDivControl(include.Name, &quot;Include&quot;, include.Width, false, &quot;&quot;);
                    RenderBorderInDesignMode(container, true);
                    container.Style.Add(&quot;height&quot;, ParseHTMLUnitValue(include.Height, 100).ToString());

                    pageDiv.Controls.Add(container);

                    var nameDiv = new HtmlGenericControl(&quot;DIV&quot;);
                    nameDiv.InnerHtml = &quot;Include: &quot; + cont.Name;
                    container.Controls.Add(nameDiv);
                }
            }
        }


        private void RenderGridForFormBuilder(X.ControlContainer cont, object parent)
        {
            SetUniqueContainerName(ref cont);  // make sure the container has a name

            var pageDiv = parent as HtmlGenericControl;
            var dg = cont as X.DynamicGrid;

            var container = CreateContainingDivControl(dg.Caption ?? dg.Name, &quot;DynamicGrid&quot;, dg.Width, false, &quot;&quot;);
            RenderBorderInDesignMode(container, true);
            if (!string.IsNullOrEmpty(dg.Attributes))
                container.Attributes.Add(&quot;style&quot;, dg.Attributes);

            container.Style.Add(&quot;height&quot;, ParseHTMLUnitValue(dg.Height, 200).ToString());

            if (string.IsNullOrEmpty(dg.Caption) &amp;&amp; dg.Visibility != X.ControlVisibility.None)
                dg.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(dg.Caption))
                container.Controls.Add(RenderCaption(dg.form.CaptionStyle, dg.ParseDynamicString(dg.Caption),
                    X.ContainerTypes.DynamicGrid, dg.Visibility, dg));
            else
                container.Controls.Add(RenderCaption(dg.form.CaptionStyle, dg.Name, X.ContainerTypes.DynamicGrid, dg.Visibility, dg));

            var columns = dg.Controls.Count();

            foreach (var column in dg.Controls)
            {
                var col = CreateContainingDivControl(column.Name, &quot;Column header&quot;, column.Width, false, &quot;&quot;);

                // ensure that names are unique.
                col.ID = GetControlIdFormat(column);

                col.Style.Add(&quot;width&quot;, (99 / columns).ToString() + &quot;%&quot;);
                col.Style.Add(&quot;height&quot;, &quot;25px&quot;);
                col.Style.Add(&quot;line-height&quot;, &quot;24px&quot;);
                col.Style.Add(&quot;text-align&quot;, &quot;center&quot;);
                col.Style.Add(&quot;overflow&quot;, &quot;hidden&quot;);
                col.Style.Add(&quot;text-overflow&quot;, &quot;ellipsis&quot;);

                col.Style.Add(&quot;background-color&quot;, &quot;#C3D8F1&quot;);
                col.Style.Add(&quot;border&quot;, &quot;Solid 1px #5D8CC9&quot;);
                col.Style.Add(&quot;color&quot;, &quot;#00156E&quot;);

                col.InnerText = string.IsNullOrEmpty(column.Caption)
                        ? column.Name
                        : column.ParseDynamicString(column.Caption);
                if (column.ValidationTypes.Contains(X.ValidationType.Required))
                    col.InnerText += &quot;&lt;span class=&#39;required&#39;&gt; *&lt;/span&gt;&quot;;

                //if (column.Type == X.ControlType.Hidden)
                //    col.Style.Add(&quot;display&quot;, &quot;none&quot;);
                //else
                col.Style.Add(&quot;display&quot;, &quot;inline-block&quot;);

                RenderBorderInDesignMode(col, true);
                container.Controls.Add(col);
            }

            pageDiv.Controls.Add(container);
        }

        private void RenderSpacer(X.ControlContainer cont, object parent)
        {
            var pageDiv = parent as HtmlGenericControl;
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            var sp = cont as X.Spacer;

            HtmlGenericControl divControl = CreateContainingDivControl(sp.Name, &quot;Spacer&quot;, sp.Width, false, &quot;&quot;);
            pageDiv.Controls.Add(divControl);

            if (sp.LineAtTop)
            {
                var lit = new Literal();
                lit.Text = &quot;&lt;hr&gt;&quot;;
                divControl.Controls.Add(lit);
            }

            var InnerDivControl = new HtmlGenericControl(&quot;DIV&quot;);
            InnerDivControl.Style.Add(&quot;height&quot;, ParseHTMLUnitValue(sp.Height, 20).ToString());
            InnerDivControl.Style.Add(&quot;clear&quot;, &quot;both&quot;);
            InnerDivControl.Style.Add(&quot;width&quot;, &quot;1px&quot;);
            divControl.Controls.Add(InnerDivControl);

            if (sp.LineAtBottom)
            {
                var lit = new Literal();
                lit.Text = &quot;&lt;hr&gt;&quot;;
                divControl.Controls.Add(lit);
            }

            if (sp.form.DesignMode)
                RenderBorderInDesignMode(divControl, true);
        }

        private void RenderText(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            var pageDiv = parent as HtmlGenericControl;
            var tc = cont as X.Text;

            HtmlGenericControl divControl = CreateContainingDivControl(tc.Name, &quot;Text&quot;, tc.Width, false, &quot;&quot;);

            pageDiv.Controls.Add(divControl);
            if (!String.IsNullOrEmpty(tc.Width))
                divControl.Style.Add(HtmlTextWriterStyle.Width, ParseHTMLUnitValue(tc.Width).ToString());

            if (!string.IsNullOrWhiteSpace(tc.Attributes))
            {
                var styles = tc.Attributes.Split(&#39;;&#39;);
                foreach (var style in styles)
                {
                    var keyattr = style.Split(&#39;:&#39;);
                    if (keyattr.Count() == 2)
                        divControl.Style.Add(keyattr[0], keyattr[1]);
                }
            }

            var lit = new Literal();
            var sb = new StringBuilder();

            if (tc.AllElements != null)
                foreach (XmlElement xe in tc.AllElements)
                {
                    sb.Append(xe.InnerXml);
                }

            //sb.Append(tc.Markup); ;
            lit.Text = sb.ToString();

            if (model.form.DesignMode)
            {
                RenderBorderInDesignMode(divControl, true);
                divControl.Style.Add(&quot;min-height&quot;, &quot;10px;&quot;);
                if (string.IsNullOrWhiteSpace(lit.Text))
                    lit.Text = &quot;Enter text through Markup attribute&quot;;
            }

            divControl.Controls.Add(lit);
        }

        class CellDetails
        {
            public string Name { get; set; }
            public string ParentGroupName;
            public int Level;
            public HtmlTableCell TableCell;
            public bool IsColumn;
        }

        public void RenderStaticGridHeaderRow(X.StaticGrid sg, HtmlTable tbl)
        {
            int noOfHeaderRows = 1;
            bool hasMultiRowHeader = false;
            Dictionary&lt;int, HtmlTableRow&gt; rows = new Dictionary&lt;int, HtmlTableRow&gt;();
            Dictionary&lt;string, CellDetails&gt; cellDetails = new Dictionary&lt;string, CellDetails&gt;();

            //var mainHeaderRow = new HtmlTableRow();
            if (sg.ColumnGroups != null &amp;&amp; sg.ColumnGroups.ColumnGroup.Count &gt; 0)
            {
                hasMultiRowHeader = true;
                Dictionary&lt;string, int&gt; groupDetails = new Dictionary&lt;string, int&gt;();
                foreach (X.xControl colHeader in sg.Containers[0].Controls)
                {
                    if (!string.IsNullOrEmpty(colHeader.ColumnGroup))
                    {
                        if (groupDetails.ContainsKey(colHeader.ColumnGroup))
                            groupDetails[colHeader.ColumnGroup] = groupDetails[colHeader.ColumnGroup] + 1;
                        else
                            groupDetails.Add(colHeader.ColumnGroup, 1);
                    }

                    cellDetails.Add(colHeader.Name,
                        new CellDetails
                        {
                            Name = colHeader.Name,
                            ParentGroupName = string.IsNullOrEmpty(colHeader.ColumnGroup) ? &quot;NA&quot; : colHeader.ColumnGroup,
                            Level = 1,
                            IsColumn = true
                        });
                }

                bool hasGroups = groupDetails.Count &gt; 0;

                while (hasGroups)
                {
                    Dictionary&lt;string, int&gt; parentGroupDetails = new Dictionary&lt;string, int&gt;();

                    foreach (KeyValuePair&lt;string, int&gt; grp in groupDetails)
                    {
                        X.xColumnGroup group = sg.ColumnGroups.ColumnGroup.Find(g =&gt; g.Name == grp.Key);
                        if (group != null)
                        {
                            if (!string.IsNullOrEmpty(group.ParentColumnGroup))
                            {
                                if (parentGroupDetails.ContainsKey(group.ParentColumnGroup))
                                    parentGroupDetails[group.ParentColumnGroup] =
                                        parentGroupDetails[group.ParentColumnGroup] + grp.Value;
                                else
                                    parentGroupDetails.Add(group.ParentColumnGroup, grp.Value);
                            }

                            var htc = new HtmlTableCell(&quot;th&quot;);
                            htc.InnerHtml = sg.ParseDynamicString(group.Caption);
                            htc.ColSpan = grp.Value;
                            htc.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
                            if (group.Align == X.GridHeaderAlignment.NotSet)
                                htc.Align = &quot;Center&quot;;
                            else
                                htc.Align = group.Align.ToString();
                            RenderStaticGridRowHeaderStyle(htc);

                            KeyValuePair&lt;string, CellDetails&gt;? childCell =
                                cellDetails.First(cd =&gt; cd.Value.ParentGroupName == group.Name);
                            cellDetails.Add(group.Name, new CellDetails
                            {
                                Name = group.Name,
                                ParentGroupName =
                                    string.IsNullOrEmpty(group.ParentColumnGroup) ? &quot;NA&quot; : group.ParentColumnGroup,
                                Level = (childCell == null ? 1 : childCell.Value.Value.Level + 1),
                                TableCell = htc
                            });
                        }
                    }
                    hasGroups = parentGroupDetails.Count &gt; 0;
                    groupDetails = parentGroupDetails;
                    noOfHeaderRows++;
                }
            }

            foreach (X.xControl colHeader in sg.Containers[0].Controls)
            {
                var htc = new HtmlTableCell(&quot;th&quot;);
                if (!string.IsNullOrEmpty(colHeader.Caption))
                    htc.InnerHtml = colHeader.ParseDynamicString(colHeader.Caption);
                htc.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
                htc.Attributes.Add(&quot;FormDesignerName&quot;, colHeader.Name);
                RenderStaticGridRowHeaderStyle(htc);
                if (colHeader.Type == X.ControlType.Hidden)
                    htc.Style.Add(&quot;display&quot;, &quot;none&quot;);

                if (!string.IsNullOrEmpty(colHeader.Width))
                    htc.Style.Add(&quot;width&quot;, ParseHTMLUnitValue(colHeader.Width).ToString());

                if (hasMultiRowHeader &amp;&amp; string.IsNullOrEmpty(colHeader.ColumnGroup))
                    htc.RowSpan = noOfHeaderRows;

                if (!cellDetails.ContainsKey(colHeader.Name))
                {
                    cellDetails.Add(colHeader.Name,
                        new CellDetails
                        {
                            Name = colHeader.Name,
                            ParentGroupName = string.IsNullOrEmpty(colHeader.ColumnGroup) ? &quot;NA&quot; : colHeader.ColumnGroup,
                            IsColumn = true,
                            Level = 1
                        });
                }

                KeyValuePair&lt;string, CellDetails&gt;? cell = cellDetails.First(c =&gt; c.Key == colHeader.Name);
                if (cell != null)
                    cell.Value.Value.TableCell = htc;
            }

            HtmlTableRow baseRow = new HtmlTableRow();
            cellDetails.Where(c =&gt; c.Value.Level == 1).ForEach(cell =&gt;
            {
                if ((hasMultiRowHeader &amp;&amp; cell.Value.ParentGroupName != &quot;NA&quot;) || (!hasMultiRowHeader))
                    baseRow.Cells.Add(cell.Value.TableCell);
            });
            rows.Add(1, baseRow);

            if (hasMultiRowHeader)
            {
                int lastRowIndex = cellDetails.Max(c =&gt; c.Value.Level);
                int rowIndex = 2;
                bool addRow = cellDetails.Count(c =&gt; c.Value.Level == rowIndex) &gt; 0;
                while (addRow)
                {
                    HtmlTableRow row = new HtmlTableRow();
                    cellDetails.Where(c =&gt; c.Value.Level == rowIndex - 1).ForEach(cell =&gt;
                    {
                        if (cell.Value.ParentGroupName != &quot;NA&quot; &amp;&amp; cellDetails.ContainsKey(cell.Value.ParentGroupName))
                            row.Cells.Add(cellDetails[cell.Value.ParentGroupName].TableCell);
                        else if (rowIndex == lastRowIndex)
                            row.Cells.Add(cell.Value.TableCell);
                    });
                    rows.Add(rowIndex, row);
                    rowIndex++;
                    addRow = cellDetails.Count(c =&gt; c.Value.Level == rowIndex) &gt; 0;
                }
            }
            for (int i = rows.Count; i &gt; 0; i--)
            {
                tbl.Rows.Add(rows[i]);
            }
        }

        private void RenderStaticGridRowHeaderStyle(HtmlTableCell htc)
        {
            htc.Style.Add(&quot;background-color&quot;, &quot;#C3D8F1&quot;);
            htc.Style.Add(&quot;border&quot;, &quot;Solid 1px #5D8CC9&quot;);
            htc.Style.Add(&quot;color&quot;, &quot;#00156E&quot;);
            htc.Style.Add(&quot;height&quot;, &quot;22px&quot;);
            htc.Style.Add(&quot;font-size&quot;, &quot;12px&quot;);
            htc.Style.Add(&quot;font-family&quot;, &quot;&#39;Segoe UI&#39;, Arial, Helvetica, sans-serif&quot;);
        }

        private void RenderStaticGrid(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            var pageDiv = parent as HtmlGenericControl;
            var sg = cont as X.StaticGrid;


            HtmlGenericControl divControl = CreateContainingDivControl(sg.Name, &quot;StaticGrid&quot;, sg.Width, false);
            pageDiv.Controls.Add(divControl);

            if (!string.IsNullOrEmpty(sg.Attributes))
                divControl.Attributes.Add(&quot;style&quot;, sg.Attributes);

            if (!string.IsNullOrEmpty(cont.TabName))
            {
                X.xTab tab = cont.form.GetContainer(cont.TabName) as X.xTab;
                if (tab != null)
                    divControl.Attributes.Add(&quot;TabName&quot;, cont.TabName);
            }
            if (string.IsNullOrEmpty(sg.Caption) &amp;&amp; sg.Visibility != X.ControlVisibility.None)
                sg.Caption = &quot;Expand/Collapse&quot;;
            if (!string.IsNullOrEmpty(sg.Caption))
                divControl.Controls.Add(RenderCaption(sg.form.CaptionStyle, sg.ParseDynamicString(sg.Caption),
                    X.ContainerTypes.StaticGrid, sg.Visibility, sg));

            var tbl = new HtmlTable();
            //tbl.Border = 1;
            tbl.CellSpacing = 0;
            tbl.CellPadding = 2;
            tbl.Attributes.Add(&quot;class&quot;, &quot;xmlFormSectionTable&quot;);
            //tbl.Attributes.Add(&quot;bordercolor&quot;, &quot;#dddddd;&quot;);
            tbl.Style.Add(&quot;border-collapse&quot;, &quot;collapse&quot;);
            tbl.Style.Add(&quot;border&quot;, &quot;solid 1px #5D8CC9&quot;);
            divControl.Controls.Add(tbl);

            // make sure that the static grid has at least one row and that the first element is a
            // header
            if (sg.Containers.Count &lt; 1 || sg.Containers[0].GetType() != typeof(X.Header))
                return;

            RenderStaticGridHeaderRow(sg, tbl);

            int rowCount = 0;

            var h = sg.Containers[0] as X.Header;
            sg.ControlReference.Clear();

            foreach (var row in sg.Containers.OfType&lt;X.Row&gt;())
            {
                X.ControlContainer itemRow = row;
                SetUniqueContainerName(ref itemRow);

                var htr = new HtmlTableRow();
                // KK: rows need names also. Create one if it is not there already
                htr.Attributes.Add(&quot;FormDesignerName&quot;, itemRow.Name);

                int visibleControlIndex = 0;

                for (int i = 0; i &lt; h.Controls.Count; i++)
                {
                    bool skipRendering = false;
                    bool isHeaderControl = false;

                    // dont crash if there is something wrong with the item row.  This can easily
                    // happen if the form definition has more controls in the item row than the header.
                    if (visibleControlIndex &gt;= itemRow.Controls.Count)
                        continue;

                    X.xControl renderingCtrl;

                    if (h.Controls[i].Type == X.ControlType.Hidden)
                    {
                        renderingCtrl = h.Controls[i];
                        isHeaderControl = true;
                    }
                    else
                        renderingCtrl = itemRow.Controls[visibleControlIndex];

                    var htc = new HtmlTableCell();
                    htc.Style.Add(&quot;border&quot;, &quot;solid 1px #cccccc&quot;);

                    if (!isHeaderControl &amp;&amp;
                        (sg.RowSpanDetails.ContainsKey(renderingCtrl.Name) &amp;&amp;
                         sg.RowSpanDetails[renderingCtrl.Name].counter &gt; 0 &amp;&amp;
                         sg.RowSpanDetails[renderingCtrl.Name].counter &lt;= sg.RowSpanDetails[renderingCtrl.Name].rowSpan))
                    //Column Span
                    {
                        if (sg.RowSpanDetails[renderingCtrl.Name].counter == 1)
                            htc.RowSpan = sg.RowSpanDetails[renderingCtrl.Name].rowSpan;
                        else
                            skipRendering = true;
                    }

                    if (!isHeaderControl &amp;&amp;
                        (sg.ColumnSpanDetails.ContainsKey(renderingCtrl.Name) &amp;&amp;
                         sg.ColumnSpanDetails[renderingCtrl.Name].counter &gt; 0 &amp;&amp;
                         sg.ColumnSpanDetails[renderingCtrl.Name].counter &lt;=
                         sg.ColumnSpanDetails[renderingCtrl.Name].colSpan)) //Column Span
                    {
                        if (sg.ColumnSpanDetails[renderingCtrl.Name].counter == 1)
                            htc.ColSpan = sg.ColumnSpanDetails[renderingCtrl.Name].colSpan;
                        else
                            skipRendering = true;
                    }

                    //if (!sg.page.IsPostBack &amp;&amp; sg.engine.IsViewOrEditMode())
                    if (sg.engine.IsViewOrEditMode() &amp;&amp; !string.IsNullOrEmpty(h.Controls[i].DBType) &amp;&amp; sg.Table != null &amp;&amp;
                        sg.Table.Rows.Count &gt; 0 &amp;&amp; sg.Table.Rows.Count &gt; rowCount)
                    {
                        var objVal = sg.Table.Rows[rowCount].Field&lt;object&gt;(h.Controls[i].Name);

                        if (objVal != null &amp;&amp; renderingCtrl.IsTimezoneApplicable &amp;&amp; h.Controls[i].Type == X.ControlType.Column)
                        {
                            //if Header column type was nvarchar/varchar ie not datetime then we must parse this value as string

                            DateTime utcDate;
                            if (!objVal.TryParseObjectAsDateTime(out utcDate, DateFormatCulture.MWDateFormatCulture))
                                sg.valueObj = null;
                            else
                            {
                                DateTime dtInMWTimezone = utcDate.ToMWDateTime();
                                sg.valueObj = dtInMWTimezone.ToString_MWCulture(); //Need to check if we have to put this valueObj as string OR as datetime object

                                //OLD Code commented for reference purpose
                                //DateTime dt = X.StaticGrid.Get_DateTimeObject_ForStaticGrid(objVal.ToString().Trim());
                                //DateTime utcDate = dt.ToMWDateTime();
                                //sg.valueObj = utcDate.ToString_MWCulture();
                            }
                        }
                        else
                        {
                            sg.valueObj = objVal;
                        }

                    }
                    else
                        sg.valueObj = renderingCtrl.EvaluateControlValue();

                    if (h.Controls[i].Type == X.ControlType.Hidden) htc.Style.Add(&quot;display&quot;, &quot;none&quot;);

                    var wc = renderingCtrl.RenderSingleFormControl(sg.valueObj, X.RenderFormat.RenderHtml) as WebControl;

                    // dont crash.  This can happen if you drag a set into a static grid.
                    if (wc == null) continue;

                    wc.ID = sg.Name + &quot;_&quot; + rowCount + &quot;_&quot; + i;
                    wc.ClientIDMode = ClientIDMode.Static;

                    if (sg.engine.IsViewMode &amp;&amp; h.Controls[i].Type == X.ControlType.Numeric)
                        htc.Style.Add(&quot;text-align&quot;, &quot;right&quot;);

                    sg.ControlReference.Add(wc);
                    //Add it to the tr only if the rowspan and colum span is not set
                    if (!skipRendering)
                    {
                        if (h.Controls[i].Type != X.ControlType.Hidden)
                            htc.Attributes.Add(&quot;FormDesignerName&quot;, renderingCtrl.Name);
                        htc.Controls.Add(wc);

                        if (renderingCtrl is X.xColumn &amp;&amp;
                            !string.IsNullOrEmpty((renderingCtrl as X.xColumn).ParentAttributes))
                            htc.Attributes.Add(&quot;style&quot;, (renderingCtrl as X.xColumn).ParentAttributes);
                        htr.Cells.Add(htc);
                    }
                    else
                        htr.Cells.Add(htc);

                    if (!string.IsNullOrEmpty(h.Controls[i].Width))
                        htc.Style.Add(&quot;width&quot;, ParseHTMLUnitValue(h.Controls[i].Width).ToString());

                    if (!skipRendering &amp;&amp; h.Controls[i].Type != X.ControlType.Hidden)
                        if (renderingCtrl.ValidationTypes.Contains(X.ValidationType.Required))
                        {
                            HtmlGenericControl spanCtrl = new HtmlGenericControl(&quot;span&quot;);
                            spanCtrl.Attributes.Add(&quot;class&quot;, &quot;required&quot;);
                            spanCtrl.InnerHtml = &quot;*&quot;;

                            htc.Controls.Add(spanCtrl);

                            string validationGroup = &quot;Master&quot;;
                            string _stage = string.Empty;
                            //bool hasRequiredValidation = false;
                            if (!string.IsNullOrEmpty(renderingCtrl.ValidateOnAction))
                            {
                                validationGroup = AssignValidationGroup(renderingCtrl.ValidateOnAction,
                                    sg.form.engine.currentState);
                                //Add RequiredFieldValidator if validateOnAction specifies currentstate
                                if (validationGroup != &quot;Master&quot;)
                                {
                                    var rfv = AddRequiredFieldValidator(renderingCtrl, validationGroup, wc.ID);
                                    htc.Controls.Add(rfv);
                                }
                            }
                            else
                            {
                                var rfv = AddRequiredFieldValidator(renderingCtrl, validationGroup, wc.ID);
                                htc.Controls.Add(rfv);
                            }
                        }

                    if (!skipRendering &amp;&amp; (renderingCtrl.ValidationTypes.Contains(X.ValidationType.RegularExpression)
                                           || renderingCtrl.ValidationTypes.Contains(X.ValidationType.Email)
                                           || renderingCtrl.Type == X.ControlType.TimeInput
                        ))
                    {
                        var rev = AddRegularExpressionValidator(renderingCtrl, &quot;Master&quot;, wc.ID);
                        htc.Controls.Add(rev);
                    }
                    if (h.Controls[i].Type != X.ControlType.Hidden)
                        visibleControlIndex++;
                }

                tbl.Rows.Add(htr);
                rowCount++;
            }

            if (sg.form.DesignMode)
                RenderBorderInDesignMode(divControl, true);
        }

        private void RenderCheckListGroupHeader(X.CheckListGroup clg, HtmlTable tbl, out HtmlTableCell idCell)
        {
            int noOfHeaderRows = 1;
            bool hasMultiRowHeader = false;
            Dictionary&lt;int, HtmlTableRow&gt; rows = new Dictionary&lt;int, HtmlTableRow&gt;();
            Dictionary&lt;string, CellDetails&gt; cellDetails = new Dictionary&lt;string, CellDetails&gt;();

            // If any CheckList Option has &#39;ColumnGroup&#39; attribute set.
            if (clg.ColumnGroups != null &amp;&amp; clg.ColumnGroups.ColumnGroup.Count &gt; 0)
            {
                hasMultiRowHeader = true;
                Dictionary&lt;string, int&gt; groupDetails = new Dictionary&lt;string, int&gt;();

                foreach (X.xControl option in clg.Controls)
                {
                    // Find number of columns mapped to each group
                    if (!string.IsNullOrEmpty(option.ColumnGroup))
                    {
                        if (groupDetails.ContainsKey(option.ColumnGroup))
                            groupDetails[option.ColumnGroup] = groupDetails[option.ColumnGroup] + 1;
                        else
                            groupDetails.Add(option.ColumnGroup, 1);
                    }

                    // Add each Option&#39;s details to cellDetails
                    cellDetails.Add(option.Name,
                        new CellDetails
                        {
                            Name = option.Name,
                            ParentGroupName = string.IsNullOrEmpty(option.ColumnGroup) ? &quot;NA&quot; : option.ColumnGroup,
                            Level = 1
                        });
                }

                bool hasGroups = groupDetails.Count &gt; 0;
                while (hasGroups)
                {
                    Dictionary&lt;string, int&gt; parentGroupDetails = new Dictionary&lt;string, int&gt;();

                    foreach (KeyValuePair&lt;string, int&gt; grp in groupDetails)
                    {
                        X.xColumnGroup group = clg.ColumnGroups.ColumnGroup.Find(g =&gt; g.Name == grp.Key);
                        if (group != null)
                        {
                            // Find number of groups mapped to each parent group
                            if (!string.IsNullOrEmpty(group.ParentColumnGroup))
                            {
                                if (parentGroupDetails.ContainsKey(group.ParentColumnGroup))
                                    parentGroupDetails[group.ParentColumnGroup] =
                                        parentGroupDetails[group.ParentColumnGroup] + grp.Value;
                                else
                                    parentGroupDetails.Add(group.ParentColumnGroup, grp.Value);
                            }

                            // Build the Group Header Cell
                            var htc = new HtmlTableCell(&quot;th&quot;);
                            htc.InnerHtml = clg.ParseDynamicString(group.Caption);
                            htc.ColSpan = grp.Value;
                            htc.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
                            if (group.Align == X.GridHeaderAlignment.NotSet)
                                htc.Align = &quot;Center&quot;;
                            else
                                htc.Align = group.Align.ToString();
                            RenderStaticGridRowHeaderStyle(htc);

                            // Get the first child cell of this group - to find out which header row we are building
                            KeyValuePair&lt;string, CellDetails&gt;? childCell =
                                cellDetails.First(cd =&gt; cd.Value.ParentGroupName == group.Name);
                            cellDetails.Add(group.Name, new CellDetails
                            {
                                Name = group.Name,
                                ParentGroupName =
                                    string.IsNullOrEmpty(group.ParentColumnGroup) ? &quot;NA&quot; : group.ParentColumnGroup,
                                Level = (childCell == null ? 1 : childCell.Value.Value.Level + 1),
                                TableCell = htc
                            });
                        }
                    }

                    // Repeat the same for next level of Grouping
                    groupDetails = parentGroupDetails;
                    hasGroups = groupDetails.Count &gt; 0;
                    noOfHeaderRows++;
                }
            }


            // CheckListGroup has some mandatory cells which have to added at the top of the table header
            HtmlTableRow topRow = new HtmlTableRow();
            idCell = new HtmlTableCell();
            idCell.Style.Add(&quot;display&quot;, &quot;none&quot;);
            idCell.InnerText = &quot;&quot;;
            if (hasMultiRowHeader)
                idCell.RowSpan = noOfHeaderRows;
            topRow.Cells.Add(idCell);

            var snCell = new HtmlTableCell();
            snCell.InnerText = clg.SlNo;
            snCell.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
            if (!clg.SerialNoColumn)
                snCell.Style.Add(&quot;display&quot;, &quot;none&quot;);
            RenderStaticGridRowHeaderStyle(snCell);
            if (hasMultiRowHeader)
                snCell.RowSpan = noOfHeaderRows;
            topRow.Cells.Add(snCell);

            var descCell = new HtmlTableCell();
            descCell.InnerText = clg.Description;
            descCell.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
            if (!string.IsNullOrEmpty(clg.ItemAttributes))
                descCell.Attributes.Add(&quot;style&quot;, clg.ItemAttributes);
            RenderStaticGridRowHeaderStyle(descCell);
            if (hasMultiRowHeader)
                descCell.RowSpan = noOfHeaderRows;
            topRow.Cells.Add(descCell);


            // Build the &#39;TableCell&#39; for each Option
            foreach (X.xControl option in clg.Controls)
            {
                var htc = new HtmlTableCell();
                htc.InnerText = option.Caption == null ? option.Name : option.ParseDynamicString(option.Caption);
                htc.Attributes.Add(&quot;FormDesignerName&quot;, option.Name);
                htc.Attributes.Add(&quot;class&quot;, &quot;header&quot;);
                if (option.Type == X.ControlType.Hidden)
                    htc.Style.Add(&quot;display&quot;, &quot;none&quot;);
                if (!string.IsNullOrEmpty(option.Attributes))
                    htc.Attributes.Add(&quot;style&quot;, option.Attributes);
                RenderStaticGridRowHeaderStyle(htc);

                if (hasMultiRowHeader &amp;&amp; string.IsNullOrEmpty(option.ColumnGroup))
                    htc.RowSpan = noOfHeaderRows;

                if (!cellDetails.ContainsKey(option.Name))
                {
                    cellDetails.Add(option.Name,
                        new CellDetails
                        {
                            Name = option.Name,
                            ParentGroupName = string.IsNullOrEmpty(option.ColumnGroup) ? &quot;NA&quot; : option.ColumnGroup,
                            Level = 1
                        });
                }

                KeyValuePair&lt;string, CellDetails&gt;? cell = cellDetails.First(c =&gt; c.Key == option.Name);
                if (cell != null)
                    cell.Value.Value.TableCell = htc;
            }


            // The row which contains column headings
            HtmlTableRow baseRow = new HtmlTableRow();
            cellDetails.Where(c =&gt; c.Value.Level == 1).ForEach(cell =&gt;
            {
                if ((hasMultiRowHeader &amp;&amp; cell.Value.ParentGroupName != &quot;NA&quot;) || (!hasMultiRowHeader))
                    baseRow.Cells.Add(cell.Value.TableCell);
            });
            rows.Add(1, baseRow);

            int topRowIndex = cellDetails.Max(c =&gt; c.Value.Level);
            if (hasMultiRowHeader)
            {
                // For cells that dont have a parent, but are not in the top row, set rowspan so that they expand across rows
                cellDetails.Where(c =&gt; c.Value.ParentGroupName == &quot;NA&quot;
                                       &amp;&amp; c.Value.Level != topRowIndex
                                       &amp;&amp; c.Value.TableCell.RowSpan != topRowIndex - c.Value.Level + 1)
                    .ForEach(cell =&gt; cell.Value.TableCell.RowSpan = topRowIndex - cell.Value.Level + 1);

                int rowIndex = 2;
                bool addRow = cellDetails.Count(c =&gt; c.Value.Level == rowIndex) &gt; 0;
                while (addRow)
                {
                    // Add Group Name row for each option, and parent groups for each group
                    HtmlTableRow row = new HtmlTableRow();
                    cellDetails.Where(c =&gt; c.Value.Level == rowIndex - 1).ForEach(cell =&gt;
                    {
                        if (cell.Value.ParentGroupName != &quot;NA&quot; &amp;&amp; cellDetails.ContainsKey(cell.Value.ParentGroupName))
                            row.Cells.Add(cellDetails[cell.Value.ParentGroupName].TableCell);
                        else if (rowIndex == topRowIndex)
                        {
                            row.Cells.Add(cell.Value.TableCell);
                        }
                    });
                    rows.Add(rowIndex, row);
                    rowIndex++;
                    addRow = cellDetails.Count(c =&gt; c.Value.Level == rowIndex) &gt; 0;
                }
            }

            // Add the mandatory cells to the top-most row of the table
            int position = 0;
            while (topRow.Cells.Count &gt; 0)
            {
                HtmlTableCell topRowCell = topRow.Cells[0];
                rows[topRowIndex].Cells.Insert(position, topRowCell);
                position++;
            }

            for (int i = rows.Count; i &gt; 0; i--)
            {
                tbl.Rows.Add(rows[i]);
            }
        }

        private void RenderCheckListGroup(X.ControlContainer cont, object parent)
        {
            // make sure the container name is unique and not null
            SetUniqueContainerName(ref cont);

            var pageDiv = parent as HtmlGenericControl;
            var clg = cont as X.CheckListGroup;

            HtmlGenericControl divControl = CreateContainingDivControl(clg.Name, &quot;CheckListGroup&quot;, clg.Width, false);
            pageDiv.Controls.Add(divControl);

            if (!string.IsNullOrEmpty(cont.TabName))
            {
                X.xTab tab = cont.form.GetContainer(cont.TabName) as X.xTab;
                if (tab != null)
                {
                    divControl.Attributes.Add(&quot;TabName&quot;, cont.TabName);
                    if (!tab.IsSelected)
                        divControl.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }
            }

            if (!string.IsNullOrEmpty(clg.Attributes))
                divControl.Attributes.Add(&quot;style&quot;, clg.Attributes);

            int groupCount = 0;
            int checkListCounter = 1;
            // clg.ControlReference.Clear();
            foreach (X.Group grp in cont.Containers.OfType&lt;X.Group&gt;())
            {
                //Group grp = c as Group;

                HtmlGenericControl grpDiv = CreateContainingDivControl(grp.Name, &quot;&quot;, grp.Width, false);
                divControl.Controls.Add(grpDiv);

                if (string.IsNullOrEmpty(grp.Caption) &amp;&amp; grp.Visibility != X.ControlVisibility.None)
                    grp.Caption = &quot;Expand/Collapse&quot;;
                if (!string.IsNullOrEmpty(grp.Caption))
                    grpDiv.Controls.Add(RenderCaption(grp.form.CaptionStyle, grp.ParseDynamicString(grp.Caption),
                        X.ContainerTypes.CheckListGroup, grp.Visibility, grp));

                var Chklsts = grp.Containers.OfType&lt;X.CheckList&gt;();

                if (Chklsts.Count() &gt; 0)
                {
                    var tbl = new HtmlTable();
                    tbl.Border = 1;
                    tbl.CellPadding = 0;
                    tbl.CellSpacing = 0;
                    tbl.Style.Add(&quot;border-collapse&quot;, &quot;collapse&quot;);
                    tbl.Style.Add(&quot;padding-left&quot;, &quot;2px&quot;);
                    grpDiv.Controls.Add(tbl);

                    string DGWidth = &quot;&quot;;
                    if (!string.IsNullOrEmpty(grp.Width))
                        DGWidth = ParseHTMLUnitValue(grp.Width).ToString();
                    if (!string.IsNullOrEmpty(DGWidth))
                        tbl.Style.Add(&quot;width&quot;, DGWidth);

                    HtmlTableCell idCell;
                    RenderCheckListGroupHeader(clg, tbl, out idCell);


                    // we need to change the name of the control for each row so we dont get duplicate names
                    // this temp control is used to hold the modified control information.

                    foreach (X.CheckList checklist in Chklsts)
                    {
                        //CheckList checklist = clc as CheckList;
                        var htr = new HtmlTableRow();

                        var idCellRow = new HtmlTableCell();
                        idCellRow.Style.Add(&quot;display&quot;, &quot;none&quot;);

                        // SET THE VALUES FOR DEFAULT PKControl column of checklist

                        checklist.PKControl.Type = X.ControlType.Hidden;
                        checklist.PKControl.Name = clg.PrimaryKeyName + &quot;PK_&quot; + groupCount + &quot;_&quot; + checkListCounter;
                        // we need to make sure the controls are unique
                        checklist.PKControl.DBType = &quot;Int Identity(1,1)&quot;;
                        checklist.PKControl.ParentObject = clg;

                        if (clg.engine.IsViewOrEditMode() &amp;&amp; !string.IsNullOrEmpty(checklist.PKControl.DBType) &amp;&amp;
                            clg.Table != null)
                            clg.valueObj = clg.Table.Rows[checkListCounter - 1].Field&lt;object&gt;(clg.PrimaryKeyName);
                        else
                            clg.valueObj = null;

                        var wc =
                            checklist.PKControl.RenderSingleFormControl(clg.valueObj, X.RenderFormat.RenderHtml) as
                                WebControl;
                        if (wc == null) continue;  // dont crash

                        idCell.Controls.Add(wc); // create a control in each check list and pass that here
                        checklist.ControlReference.Add(wc);
                        htr.Cells.Add(idCellRow);

                        var snCellRow = new HtmlTableCell();
                        snCellRow.InnerText = checkListCounter.ToString();
                        if (!clg.SerialNoColumn)
                            snCellRow.Style.Add(&quot;display&quot;, &quot;none&quot;);
                        htr.Cells.Add(snCellRow);

                        var descCell = new HtmlTableCell();
                        var spanDesc = new HtmlGenericControl(&quot;span&quot;);
                        spanDesc.InnerText = checklist.Description;
                        if (!string.IsNullOrEmpty(clg.ItemAttributes))
                            spanDesc.Attributes.Add(&quot;style&quot;, clg.ItemAttributes);
                        spanDesc.Attributes.Add(&quot;FormDesignerName&quot;, checklist.Name);
                        descCell.Controls.Add(spanDesc);
                        htr.Cells.Add(descCell);

                        string descWith = &quot;&quot;;
                        if (!string.IsNullOrEmpty(checklist.Width))
                            descWith = ParseHTMLUnitValue(checklist.Width).ToString();
                        if (!string.IsNullOrEmpty(descWith))
                            descCell.Style.Add(&quot;width&quot;, descWith);

                        foreach (X.xControl opt in clg.Controls)
                        {
                            var htc = new HtmlTableCell();
                            var descControls = new HtmlGenericControl(&quot;div&quot;);
                            descControls.Style.Add(&quot;display&quot;, &quot;inline-block&quot;);
                            bool renderControlInline = (opt is X.xOption &amp;&amp; (opt as X.xOption).RenderWithDescription);

                            if (renderControlInline)
                                spanDesc.InnerHtml += &quot;&amp;nbsp;&quot;;

                            // hide it if it is hidden
                            if (opt.Type == X.ControlType.Hidden)
                            {
                                if (renderControlInline)
                                    descControls.Style.Add(&quot;display&quot;, &quot;none&quot;);
                                else
                                    htc.Style.Add(&quot;display&quot;, &quot;none&quot;);
                            }


                            X.xControl overridenOpt = null;
                            if (checklist.Controls.Count &gt; 0)
                            {
                                object tempObj = checklist.Controls.Find(o =&gt; o.Name == opt.Name);
                                if (tempObj != null)
                                    overridenOpt = tempObj as X.xControl;
                            }

                            //TODO: Should copy all the properties
                            var tmpctrl = new X.xControl()
                            {
                                Name = opt.Name + groupCount + &quot;_&quot; + checkListCounter,
                                Type = overridenOpt != null ? overridenOpt.Type : opt.Type,
                                Value = overridenOpt != null ? overridenOpt.Value : opt.Value,
                                ParentObject = overridenOpt != null ? overridenOpt.ParentObject : opt.ParentObject,
                                Validations = overridenOpt != null ? overridenOpt.Validations : opt.Validations,
                                Width = overridenOpt != null ? overridenOpt.Width : opt.Width,
                                ListItems = overridenOpt != null ? overridenOpt.ListItems : opt.ListItems,
                                DataSource = overridenOpt != null ? overridenOpt.DataSource : opt.DataSource,
                                RepeatDirection =
                                    overridenOpt != null ? overridenOpt.RepeatDirection : opt.RepeatDirection,
                                RepeatLayout = overridenOpt != null ? overridenOpt.RepeatLayout : opt.RepeatLayout,
                                DBType = opt.DBType,
                                AllowNull = opt.AllowNull
                            };


                            if (clg.engine.IsViewOrEditMode() &amp;&amp; !string.IsNullOrEmpty(opt.DBType) &amp;&amp; clg.Table != null)
                                clg.valueObj = clg.Table.Rows[checkListCounter - 1].Field&lt;object&gt;(opt.Name);
                            else
                                clg.valueObj = null;

                            var wc1 =
                                tmpctrl.RenderSingleFormControl(clg.valueObj, X.RenderFormat.RenderHtml) as WebControl;
                            if (wc1 == null)  // dont crash
                                continue;

                            checklist.ControlReference.Add(wc1);
                            if (renderControlInline)
                            {
                                descControls.Controls.Add(wc1);
                                descCell.Controls.Add(descControls);
                            }
                            else
                            {
                                htc.Controls.Add(wc1);
                                htr.Cells.Add(htc);
                            }

                            if (opt.Type != X.ControlType.Hidden)
                            {
                                if (renderControlInline)
                                    descControls.Attributes.Add(&quot;FormDesignerName&quot;, opt.Name);
                                else
                                    htc.Attributes.Add(&quot;FormDesignerName&quot;, opt.Name);
                            }

                            if (!string.IsNullOrEmpty(opt.Attributes))
                            {
                                if (renderControlInline)
                                    descControls.Attributes.Add(&quot;style&quot;, opt.Attributes);
                                else
                                    htc.Attributes.Add(&quot;style&quot;, opt.Attributes);
                            }

                            string cellWith = &quot;&quot;;
                            if (!string.IsNullOrEmpty(opt.Width))
                                cellWith = ParseHTMLUnitValue(opt.Width).ToString();

                            if (!string.IsNullOrEmpty(cellWith))
                            {
                                if (renderControlInline)
                                    descControls.Style.Add(&quot;width&quot;, cellWith);
                                else
                                    htc.Style.Add(&quot;width&quot;, cellWith);
                            }

                            if (opt.ValidationTypes.Contains(X.ValidationType.Required))
                            {
                                HtmlGenericControl spanCtrl = new HtmlGenericControl(&quot;span&quot;);
                                spanCtrl.Attributes.Add(&quot;class&quot;, &quot;required&quot;);
                                spanCtrl.InnerHtml = &quot;*&quot;;

                                htc.Controls.Add(spanCtrl);

                                string validationGroup = &quot;Master&quot;;
                                string _stage = string.Empty;
                                //bool hasRequiredValidation = false;
                                if (!string.IsNullOrEmpty(opt.ValidateOnAction))
                                {
                                    validationGroup = AssignValidationGroup(opt.ValidateOnAction,
                                        opt.form.engine.currentState);
                                    //Add RequiredFieldValidator if validateOnAction specifies currentstate 
                                    if (validationGroup != &quot;Master&quot;)
                                    {
                                        var rfv = AddRequiredFieldValidator(opt, validationGroup, wc1.ID);
                                        htc.Controls.Add(rfv);
                                    }
                                }
                                else
                                {
                                    var rfv = AddRequiredFieldValidator(opt, validationGroup, wc1.ID);
                                    htc.Controls.Add(rfv);
                                }
                            }

                            if (opt.ValidationTypes.Contains(X.ValidationType.RegularExpression)
                                || opt.ValidationTypes.Contains(X.ValidationType.Email)
                                || opt.Type == X.ControlType.TimeInput
                                )
                            {
                                var rev = AddRegularExpressionValidator(opt, &quot;Master&quot;, wc1.ID);
                                htc.Controls.Add(rev);
                            }
                        }
                        tbl.Rows.Add(htr);
                        checkListCounter++;
                    }
                    groupCount++;
                }
            }

            if (clg.form.DesignMode)
                RenderBorderInDesignMode(divControl, true);
        }

        private object RenderLink(X.xControl ctrl, object parent, object valueObj)
        {
            var lnk = new HyperLink();
            lnk.CssClass = &quot;HeaderloginLinks&quot;;

            if (!ctrl.form.engine.IsNewMode &amp;&amp; valueObj != null)
            {
                //Akila - TODO: Add PID and Parent ID always to the URL. But we should control this using another property
                string pid = (!string.IsNullOrEmpty(page.Request[&quot;PID&quot;]) ? page.Request[&quot;PID&quot;] : &quot;&quot;);
                string parentid = (!string.IsNullOrEmpty(page.Request[&quot;ParentID&quot;]) ? page.Request[&quot;ParentID&quot;] : &quot;&quot;);
                lnk.NavigateUrl = valueObj.ToString() + (!string.IsNullOrEmpty(pid) ? &quot;&amp;PID=&quot; + pid : &quot;&quot;) +
                                  (!string.IsNullOrEmpty(parentid) ? &quot;&amp;ParentID=&quot; + parentid : &quot;&quot;);
                lnk.Target = &quot;_blank&quot;;
                lnk.Text = ctrl.ControlText;
            }


            return (PostProcessControl(ctrl, lnk));
        }

        private object RenderFileUpload(X.xControl ctrl, object parent, object valueObj)
        {
            var uploadCtrl = new FileUpload();
            return (PostProcessControl(ctrl, uploadCtrl));
        }

        private object RenderButton(X.xControl ctrl, object parent, object valueObj)
        {
            var btn = new Button();
            btn.CssClass = &quot;btnC&quot;;
            btn.Text = ctrl.Value;
            btn.ID = ctrl.Name;
            btn.Attributes.Add(&quot;showConfirmMessage&quot;, &quot;0&quot;);

            if (!string.IsNullOrEmpty(ctrl.Attributes))
                btn.Attributes.Add(&quot;style&quot;, ctrl.Attributes);

            return (PostProcessControl(ctrl, btn));
        }


        private void SetContainerRenderers()
        {
            ContainerRenderers[(int)X.ContainerTypes.Section] = new X.ControlContainer.RenderContainer(RenderSection);
            ContainerRenderers[(int)X.ContainerTypes.DynamicGrid] = new X.ControlContainer.RenderContainer(RenderDynamicGrid);
            ContainerRenderers[(int)X.ContainerTypes.Spacer] = new X.ControlContainer.RenderContainer(RenderSpacer);
            ContainerRenderers[(int)X.ContainerTypes.Text] = new X.ControlContainer.RenderContainer(RenderText);
            ContainerRenderers[(int)X.ContainerTypes.StaticGrid] = new X.ControlContainer.RenderContainer(RenderStaticGrid);
            ContainerRenderers[(int)X.ContainerTypes.CheckListGroup] = new X.ControlContainer.RenderContainer(RenderCheckListGroup);
            ContainerRenderers[(int)X.ContainerTypes.Stage] = new X.ControlContainer.RenderContainer(RenderStage);
            ContainerRenderers[(int)X.ContainerTypes.Picker] = new X.ControlContainer.RenderContainer(RenderPicker);
            ContainerRenderers[(int)X.ContainerTypes.Tabs] = new X.ControlContainer.RenderContainer(RenderTabs);
            ContainerRenderers[(int)X.ContainerTypes.Tab] = new X.ControlContainer.RenderContainer(RenderTab);
            ContainerRenderers[(int)X.ContainerTypes.Chart] = new X.ControlContainer.RenderContainer(RenderChart);
            ContainerRenderers[(int)X.ContainerTypes.HTMLSection] = new X.ControlContainer.RenderContainer(RenderHtmlSection);
            ContainerRenderers[(int)X.ContainerTypes.MatrixGrid] = new X.ControlContainer.RenderContainer(RenderMatrixGrid);
            ContainerRenderers[(int)X.ContainerTypes.Include] = new X.ControlContainer.RenderContainer(RenderInclude);
            ContainerRenderers[(int)X.ContainerTypes.EmbeddedForm] = new X.ControlContainer.RenderContainer(RenderEmbeddedForm);
            ContainerRenderers[(int)X.ContainerTypes.TreeChart] = new X.ControlContainer.RenderContainer(RenderTreeChart);
        }

        #endregion

        #region Server Side Get Value Routines

        private string GetIntegerValue(X.xControl ctrl)
        {
            var ibox = ctrl.ControlReference[0] as IntegerBox;
            if (string.IsNullOrEmpty(ibox.Text))
                return &quot;_DBNULL_&quot;;
            else
                return ibox.Text;
        }

        private string GetNumericValue(X.xControl ctrl)
        {
            var wne = ctrl.ControlReference[0] as WebNumericEdit;
            Decimal value = wne.ValueDecimal;
            return double.IsNaN(wne.ValueDouble) ? &quot;_DBNULL_&quot; : value.ToString();
        }

        private string GetDateValue(X.xControl ctrl)
        {
            WebDateChooser wdc;

            var pnl = ctrl.ControlReference[0] as Panel;
            wdc = pnl.Controls[0] as WebDateChooser;

            string toreturn = &quot;_DBNULL_&quot;;

            DateTime? outDateTime;
            if (wdc.Value.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture)) //ASHEESH_TOUTC_HERE
            {
                if (outDateTime.HasValue)
                    toreturn = outDateTime.Value.ToUtc().ToString_MWCulture();
            }

            if (string.IsNullOrEmpty(toreturn))
                toreturn = &quot;_DBNULL_&quot;;

            return toreturn;
        }

        private string GetImageValue(X.xControl ctrl)
        {
            System.Web.UI.WebControls.Image img;

            img = ctrl.ControlReference[0] as System.Web.UI.WebControls.Image;

            string toreturn = string.Empty;
            if (!string.IsNullOrEmpty(img.ImageUrl))
            {
                try
                {
                    toreturn = img.ImageUrl;
                }
                catch (Exception)
                {
                    toreturn = string.Empty;
                }
            }
            else
                toreturn = &quot;_DBNULL_&quot;;

            return toreturn;
        }

        private string GetTimeInputValue(X.xControl ctrl)
        {
            var wdi = ctrl.ControlReference[0] as WebMaskEdit;
            var returnValue = wdi.Text.ToString();
            if (!string.IsNullOrEmpty(returnValue))
                returnValue = returnValue.Trim();
            return (returnValue == &quot;:&quot; ? string.Empty : returnValue);
        }

        private string GetFormattedValue(X.xControl ctrl)
        {
            XMLMaskedTextBox radMaskedTextBox = ctrl.ControlReference[0] as XMLMaskedTextBox;

            if (radMaskedTextBox != null)
                return radMaskedTextBox.Text;
            else
                return &quot;&quot;;
        }

        private string GetRichTextBoxValues(X.xControl ctrl)
        {
            XMLRichTextBox radRichTextBox = ctrl.ControlReference[0] as XMLRichTextBox;

            if (radRichTextBox != null)
                return radRichTextBox.Content;
            else
                return &quot;&quot;;
        }

        private string GetTextHiddenTextBoxValue(X.xControl ctrl)
        {
            TextBox tb = ctrl.ControlReference[0] as TextBox;

            string retValue = string.Empty;

            if (tb != null)
            {
                DateTime? outDateTime;
                if (ctrl.IsTimezoneApplicable &amp;&amp; tb.Text.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture)) //ASHEESH_TOUTC_HERE //Do not use culture here as for hidden field we are not setting any culture
                {
                    if (outDateTime.HasValue)
                        retValue = outDateTime.Value.ToUtc().ToString_MWCulture();
                    else
                        retValue = tb.Text;
                }
                else
                    retValue = tb.Text;
            }

            return retValue;
        }

        private string GetPictureTakerValues(X.xControl ctrl)
        {
            PictureTakerControl pCtrl = ((ctrl.ControlReference[0] as HtmlGenericControl).Controls[0] as PictureTakerControl);
            if (pCtrl != null)
            {
                return pCtrl.ImageValue;
            }

            return string.Empty;
        }

        private string GetMapValues(X.xControl ctrl)
        {
            ESRIMapControl esriMap = ((ctrl.ControlReference[0] as HtmlGenericControl).Controls[0] as ESRIMapControl);
            string val = esriMap.MapGraphics + &quot;~~&quot; + esriMap.MapOptions;
            return val;
        }

        private string GetFileUploadValue(X.xControl ctrl)
        {
            FileUpload uploadControl = (ctrl.ControlReference[0] as FileUpload);
            return uploadControl.PostedFile.FileName;
        }

        private string GetDropDownListValue(X.xControl ctrl)
        {
            var ddl = ctrl.ControlReference[0] as DropDownList;
            bool hasListItems = false;
            if (!string.IsNullOrEmpty(ctrl.ListItems))
            {
                string[] listItems = ctrl.ListItems.Split(&quot;;&quot;.ToCharArray());
                hasListItems = (listItems != null &amp;&amp; listItems.Count() == 1 &amp;&amp; listItems[0].Contains(&quot;_DBNULL_&quot;))
                    ? false
                    : true;
            }

            if ((ddl.SelectedValue.Equals(&quot;_DBNULL_&quot;) &amp;&amp; hasListItems) ||
                (ctrl.DataSource != null &amp;&amp; (ctrl.DataSource.Contains(&quot;=$&quot;) || ctrl.DataSource.Contains(&quot;=&#39;$&quot;))))
            {
                object val = ctrl.form.page.Request.Form[ddl.UniqueID];
                // CASE 1. when dropdown does not have any items 
                // CASE 2. when the dropdown is disabled on client from the code on server before event handlers
                //This is will not work if somebody is disabling the drop down after event handlers like PreRender
                if (val == null)
                {
                    return (!ddl.Enabled) ? ddl.SelectedValue : &quot;_DBNULL_&quot;;
                }
                return val.ToString2();
            }
            return ddl.SelectedValue;
        }

        private string GetRadioButtonListValue(X.xControl ctrl)
        {
            var rbl = ctrl.ControlReference[0] as ListControl;

            if (rbl != null &amp;&amp; rbl.SelectedItem != null)
                return rbl.SelectedItem.Value;
            else
                return &quot;_DBNULL_&quot;;
        }

        private string GetCheckBoxValue(X.xControl ctrl)
        {
            var pnl = ctrl.ControlReference[0] as Panel;
            var cb = pnl.Controls[0] as CheckBox;

            if (cb.Checked)
                return &quot;true&quot;;
            else
                return &quot;false&quot;;
        }

        private string GetMultiPickerValue(X.xControl ctrl)
        {
            var c = ctrl.ControlReference[0] as HtmlGenericControl;
            var t = c.Controls[0] as HtmlTable;
            var hdn = t.Rows[0].Cells[1].Controls[2] as HiddenField;

            string retvalue = hdn.Value;
            return (retvalue);
        }

        private string GetLinkValue(X.xControl ctrl)
        {
            var hyp = ctrl.ControlReference[0] as HyperLink;
            return hyp.NavigateUrl;
        }

        private string GetListBoxValue(X.xControl ctrl)
        {
            var list = ctrl.ControlReference[0] as ListBox;
            int[] index = list.GetSelectedIndices();
            string selectedValues = string.Empty;
            index.ForEach(
                i =&gt; { selectedValues += list.Items[i].Value + &quot;,&quot;; });
            selectedValues = selectedValues.TrimEnd(&#39;,&#39;);
            return selectedValues;
        }

        private string GetCheckBoxListValue(X.xControl ctrl)
        {
            var list = ctrl.ControlReference[0] as CheckBoxList;
            string selectedValues = string.Empty;
            foreach (ListItem listitem in list.Items)
                if (listitem.Selected)
                    selectedValues += listitem.Value + &quot;,&quot;;
            selectedValues = selectedValues.TrimEnd(&#39;,&#39;);
            return selectedValues;
        }

        private string GetPickerTriggerValue(X.xControl ctrl)
        {
            return &quot;&quot;;
        }

        private string GetDisplayText(X.xControl ctrl)
        {
            //If the control&#39;s ReEvaluate property is set to true,
            //Then evaluate the value
            //Else the get the value from the valueobj property
            if (ctrl.ReEvaluate)
            {
                string valueObj = ctrl.EvaluateControlValue();

                if (ctrl.IsTimezoneApplicable || (!string.IsNullOrEmpty(ctrl.DBType) &amp;&amp; ctrl.DBType.ToLower().IsEqualToAny(&quot;datetime&quot;, &quot;date&quot;)))
                {
                    DateTime dtCtrl;
                    if (DateTime.TryParse(valueObj.ToString(), out dtCtrl))
                        return dtCtrl.ToUtc().ToDateTimeString_ForDatabaseOpenXml();
                    else
                        return valueObj;
                }
                else
                    return valueObj;
            }
            else
            {
                object valueObj = ctrl.valueObj;
                if (valueObj == null || (valueObj != null &amp;&amp; (string.IsNullOrEmpty(valueObj.ToString()))))
                    return ctrl.EvaluateControlValue();
                else
                {
                    if (ctrl.IsTimezoneApplicable || (!string.IsNullOrEmpty(ctrl.DBType) &amp;&amp; ctrl.DBType.ToLower().IsEqualToAny(&quot;datetime&quot;, &quot;date&quot;)))
                    {
                        DateTime dtCtrl;
                        if (DateTime.TryParse(valueObj.ToString(), out dtCtrl))
                            return dtCtrl.ToUtc().ToDateTimeString_ForDatabaseOpenXml();
                        else
                            return ctrl.valueObj.ToString();
                    }
                    else
                        return ctrl.valueObj.ToString();
                }
            }
        }

        private string GetAttachmentControlValue(X.xControl ctrl)
        {
            X.AttachmentControl aCtrl = (ctrl as X.AttachmentControl);
            string Module = aCtrl.ModuleId;
            var parentInstanceId = ctrl.form.FromRequest(&quot;ParentID&quot;);

            parentInstanceId = string.IsNullOrEmpty(parentInstanceId) ? &quot;0&quot; : parentInstanceId;

            AttachmentsControl xmlFormAttachmentCtrl =
                (ctrl.ControlReference[0] as WebControl).Controls[0] as AttachmentsControl;

            xmlFormAttachmentCtrl.CreateFolderForModule(Module, model.form.ParentModuleID, parentInstanceId.ToInt32_2());

            var ud = UserDetail.GetCurrentUserDetail();
            xmlFormAttachmentCtrl.ParentModuleID = model.form.ParentModuleID;
            xmlFormAttachmentCtrl.ParentInstanceID = parentInstanceId.ToInt32_2();

            if (String.IsNullOrEmpty(aCtrl.InstanceID))
            {
                aCtrl.InstanceID = model.form.instanceID;
            }

            bool isSaved = xmlFormAttachmentCtrl.SaveAttachments(aCtrl.InstanceID, Module, ud.UID,
                ud.UserID, &quot;Attachments&quot;);
            return isSaved.ToString();
        }

        private string GetAutoIncrementValue(X.xControl ctrl)
        {
            X.AutoIncrement ai = ctrl as X.AutoIncrement;
            if (ctrl.form.engine.IsNewMode || ctrl.form.IsInjectionType == &quot;New&quot;)
            {
                return GetAutoGeneratedText(ctrl, ai);
            }
            else
            {
                string value = string.Empty;
                Panel pnl = ctrl.ControlReference[0] as Panel;
                Label lbl = pnl.Controls[0] as Label;
                value = lbl.Text;
                if (string.IsNullOrEmpty(value))
                    value = GetAutoGeneratedText(ctrl, ai);
                return value;
            }
        }

        private string GetAutoGeneratedText(X.xControl ctrl, X.AutoIncrement ai)
        {
            int maxValue = GetMaxValue(ai);
            (ai.ValueControlReference.ControlReference[0] as TextBox).Text = maxValue.ToString();
            //ctrl.form.GetControl(ai.Name + &quot;&quot;).valueObj = ctrl.form.GetControl(ai.Name + &quot;&quot;).Value = maxValue.ToString();
            string prefix = ctrl.ParseDynamicString(ai.Prefix);
            string suffix = ctrl.ParseDynamicString(ai.Suffix);
            string incText = string.Empty;
            if (ai.PadLeft &gt; 0)
                incText = (prefix ?? string.Empty) + maxValue.ToString(&quot;D&quot; + ai.PadLeft) + (suffix ?? string.Empty);
            else
                incText = (prefix ?? string.Empty) + maxValue.ToString() + (suffix ?? string.Empty);
            Panel pnl = ctrl.ControlReference[0] as Panel;
            Label lbl = pnl.Controls[0] as Label;
            lbl.Text = incText;
            return incText;
        }

        private int GetMaxValue(X.AutoIncrement c, bool isDynamicGrid = false)
        {
            string columnName = c.Name;
            string query = &quot;&quot;;
            if (isDynamicGrid)
                query = &quot;select max(&quot; + c.Name + &quot;_VCRef) from &quot; + (c.ParentObject as X.DataBaseContainer).TableName;

            else
                query = &quot;select max(&quot; + c.Name + &quot;_VCRef&quot; + &quot;) from &quot; + c.form.ActualTableNameInDatabase;

            if (!string.IsNullOrEmpty(c.ScopeFilter))
            {
                string whrCond = &quot; where &quot; + c.ParseDynamicString(c.ScopeFilter);
                query = query + whrCond;
            }

            object objMaxValue = ComponentHelper.Instance.ExecuteScalar(query);
            int maxValue = c.Seed;
            if (objMaxValue != System.DBNull.Value)
                maxValue = objMaxValue.ToInt32_2() + c.Interval;

            return maxValue;
        }

        private string GetDateTimeControlValue(X.xControl ctrl)
        {
            RadDateTimePicker dateTimePicker = null;
            XMLPanel dateTimePanel = ctrl.ControlReference[0] as XMLPanel;

            if (dateTimePanel != null)
                dateTimePicker = dateTimePanel.ControlReference[0] as RadDateTimePicker;

            string toreturn = null;

            if (dateTimePicker != null)
            {
                DateTime? outDateTime = null;
                if (dateTimePicker.SelectedDate.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture))//ASHEESH_TOUTC_HERE
                {
                    if (outDateTime.HasValue)
                        toreturn = outDateTime.ToUtc().ToString_MWCulture();
                }

                if (!outDateTime.HasValue &amp;&amp; !ctrl.AllowNull &amp;&amp; dateTimePicker.DateInput.EmptyMessage != &quot;None&quot;)
                {
                    if (dateTimePicker.DateInput.EmptyMessage.TryParseObjectAsDateTime(out outDateTime, DateFormatCulture.MWDateFormatCulture))//ASHEESH_TOUTC_HERE
                    {
                        if (outDateTime.HasValue)
                            toreturn = outDateTime.ToUtc().ToString_MWCulture();
                    }
                }

            }

            if (string.IsNullOrEmpty(toreturn))
                toreturn = &quot;_DBNULL_&quot;;

            return toreturn;
        }

        private void SetCellGetServerValues()
        {
            ServerGetters[(int)X.ControlType.Hidden] = new X.xControl.GetServerSideValue(GetTextHiddenTextBoxValue);
            ServerGetters[(int)X.ControlType.TextBox] = new X.xControl.GetServerSideValue(GetTextHiddenTextBoxValue);
            ServerGetters[(int)X.ControlType.TextArea] = new X.xControl.GetServerSideValue(GetTextHiddenTextBoxValue);
            ServerGetters[(int)X.ControlType.Password] = new X.xControl.GetServerSideValue(GetTextHiddenTextBoxValue);
            ServerGetters[(int)X.ControlType.Date] = new X.xControl.GetServerSideValue(GetDateValue);
            ServerGetters[(int)X.ControlType.Numeric] = new X.xControl.GetServerSideValue(GetNumericValue);
            ServerGetters[(int)X.ControlType.Integer] = new X.xControl.GetServerSideValue(GetIntegerValue);
            ServerGetters[(int)X.ControlType.TimeInput] = new X.xControl.GetServerSideValue(GetTimeInputValue);
            ServerGetters[(int)X.ControlType.CheckBox] = new X.xControl.GetServerSideValue(GetCheckBoxValue);
            ServerGetters[(int)X.ControlType.DropDownList] = new X.xControl.GetServerSideValue(GetDropDownListValue);
            ServerGetters[(int)X.ControlType.DropDownTreeDataControl] = new X.xControl.GetServerSideValue(GetDropDownTreeDataValue);

            ServerGetters[(int)X.ControlType.RadioButtonList] = new X.xControl.GetServerSideValue(GetRadioButtonListValue);
            ServerGetters[(int)X.ControlType.Formatted] = new X.xControl.GetServerSideValue(GetFormattedValue);
            ServerGetters[(int)X.ControlType.MultiPicker] = new X.xControl.GetServerSideValue(GetMultiPickerValue);
            ServerGetters[(int)X.ControlType.Link] = new X.xControl.GetServerSideValue(GetLinkValue);
            ServerGetters[(int)X.ControlType.Listbox] = new X.xControl.GetServerSideValue(GetListBoxValue);
            ServerGetters[(int)X.ControlType.CheckBoxList] = new X.xControl.GetServerSideValue(GetCheckBoxListValue);
            ServerGetters[(int)X.ControlType.PickerTrigger] = new X.xControl.GetServerSideValue(GetPickerTriggerValue);
            ServerGetters[(int)X.ControlType.Display] = new X.xControl.GetServerSideValue(GetDisplayText);
            ServerGetters[(int)X.ControlType.AutoIncrement] = new X.xControl.GetServerSideValue(GetAutoIncrementValue);
            ServerGetters[(int)X.ControlType.AttachmentControl] = new X.xControl.GetServerSideValue(GetAttachmentControlValue);
            ServerGetters[(int)X.ControlType.Map] = new X.xControl.GetServerSideValue(GetMapValues);
            ServerGetters[(int)X.ControlType.Picture] = new X.xControl.GetServerSideValue(GetImageValue);
            ServerGetters[(int)X.ControlType.FileUpload] = new X.xControl.GetServerSideValue(GetFileUploadValue);
            ServerGetters[(int)X.ControlType.DateTime] = new X.xControl.GetServerSideValue(GetDateTimeControlValue);
            ServerGetters[(int)X.ControlType.PictureTaker] = new X.xControl.GetServerSideValue(GetPictureTakerValues);
            ServerGetters[(int)X.ControlType.RichTextBox] = new X.xControl.GetServerSideValue(GetRichTextBoxValues);
        }



        #endregion

        #region Server Side Row Getter Routines

        private void SetDBContainerCellGetters()
        {
            CellGetters[(int)X.ContainerTypes.DynamicGrid] = new X.DataBaseContainer.GetCellInformation(GetDynamicGridCell);
            CellGetters[(int)X.ContainerTypes.StaticGrid] = new X.DataBaseContainer.GetCellInformation(GetStaticGridCell);
            CellGetters[(int)X.ContainerTypes.CheckListGroup] = new X.DataBaseContainer.GetCellInformation(GetCheckListGroupCell);
            CellGetters[(int)X.ContainerTypes.MatrixGrid] = new X.DataBaseContainer.GetCellInformation(GetMatrixGridCell);

            CellGetters[(int)X.ContainerTypes.Section] = null;
            CellGetters[(int)X.ContainerTypes.Spacer] = null;
            CellGetters[(int)X.ContainerTypes.Text] = null;
        }

        #endregion

        #region Server Side Value Setters

        private void SetCellServerValue()
        {
            ServerSetters[(int)X.ControlType.Hidden] = SetServerTextBoxValue;
            ServerSetters[(int)X.ControlType.TextBox] = SetServerTextBoxValue;
            ServerSetters[(int)X.ControlType.TextArea] = SetServerTextBoxValue;
            ServerSetters[(int)X.ControlType.Password] = SetServerTextBoxValue;
            ServerSetters[(int)X.ControlType.Date] = SetServerDateValue;
            ServerSetters[(int)X.ControlType.Numeric] = SetServerNumericValue;
            ServerSetters[(int)X.ControlType.Integer] = SetServerTextBoxValue;
            ServerSetters[(int)X.ControlType.TimeInput] = SetServerTimeValue;
            ServerSetters[(int)X.ControlType.CheckBox] = SetServerCheckBoxValue;
            ServerSetters[(int)X.ControlType.DropDownList] = SetServerListBoxValueSingleSelect;
            ServerSetters[(int)X.ControlType.DropDownTreeDataControl] = SetServerDropDownTreeDataValueSingleSelect;
            ServerSetters[(int)X.ControlType.RadioButtonList] = SetServerListBoxValueSingleSelect;
            ServerSetters[(int)X.ControlType.Formatted] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.MultiPicker] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.Link] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.Listbox] = SetServerListBoxValue;
            ServerSetters[(int)X.ControlType.CheckBoxList] = SetServerListBoxValue;
            ServerSetters[(int)X.ControlType.PickerTrigger] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.Display] = SetServerDisplayControlValue;
            ServerSetters[(int)X.ControlType.AutoIncrement] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.AttachmentControl] = SetServerAttachmentControlValue;
            ServerSetters[(int)X.ControlType.Picture] = SetServerControlValue;
            ServerSetters[(int)X.ControlType.DateTime] = SetServerDateTimeControlValue;
            ServerSetters[(int)X.ControlType.PictureTaker] = SetServerPictureTakerControlValue;
            ServerSetters[(int)X.ControlType.RichTextBox] = SetServerRichTextBoxControlValue;
        }

        protected void SetServerAttachmentControlValue(X.xControl control, object value)
        {
            Type valueType = value.GetType();

            PropertyInfo[] properties = valueType.GetProperties();

            var rowIndex = properties.First(x =&gt; x.Name == &quot;RowIndex&quot;).GetValue(value, null);

            var instanceId = properties.First(x =&gt; x.Name == &quot;InstanceID&quot;).GetValue(value, null);

            (control as X.AttachmentControl).InstanceID = instanceId.ToString();

            AttachmentsControl xmlFormAttachmentCtrl =
                (control.ControlReference[0] as WebControl).Controls[0] as AttachmentsControl;

            var fileAttachments = xmlFormAttachmentCtrl.GetAttachmentGridDataSource();

            foreach (var file in fileAttachments)
            {
                if (file.SrcID == rowIndex.ToString())
                    file.SrcID = &quot;I-&quot; + instanceId.ToString();
            }
            xmlFormAttachmentCtrl.SetAttachmentGridDataSource(fileAttachments);
        }

        protected void SetServerControlValue(X.xControl control, object value)
        {
        }

        protected void SetServerDisplayControlValue(X.xControl control, object value)
        {
            if (value != null &amp;&amp; control.ControlReference[0] is Label)
                (control.ControlReference[0] as Label).Text = value.ToString();
        }

        protected void SetServerFormattedInputValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as XMLMaskedTextBox).Text = value.ToString();
        }

        protected void SetServerTextBoxValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as TextBox).Text = value.ToString();
        }

        protected void SetServerDateValue(X.xControl control, object value)
        {
            if ((value != null &amp;&amp; value != System.DBNull.Value) || control.AllowNull)
                ((control.ControlReference[0] as Panel).Controls[0] as WebDateChooser).Value = value;
        }

        protected void SetServerNumericValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as WebNumericEdit).Value = value;
        }
        protected void SetServerRichTextBoxControlValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as RadEditor).Content = value.ToString();
        }

        protected void SetServerTimeValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as WebMaskEdit).Value = value.ToString().Replace(&quot;:&quot;, &quot;&quot;);
        }

        protected void SetServerCheckBoxValue(X.xControl control, object value)
        {
            if (value != null)
            {
                ((control.ControlReference[0] as Panel).Controls[0] as CheckBox).Checked = value.ToBoolean2();
            }
        }

        protected void SetServerListBoxValue(X.xControl control, object value)
        {
            if (value != null)
                (control.ControlReference[0] as ListControl).SelectedValue = value.ToString();
        }

        protected void SetServerListBoxValueSingleSelect(X.xControl control, object value)
        {
            if (value != null)
            {
                foreach (ListItem li in (control.ControlReference[0] as ListControl).Items)
                {
                    li.Selected = false;
                    if (li.Value.Equals(value.ToString(), StringComparison.CurrentCultureIgnoreCase))
                        li.Selected = true;
                }
            }
        }

        public void AddAttachmentColumns(string keyColumn, string srcModule, ref DataTable bindingTable)
        {
            string instanceIDs = string.Empty;
            foreach (DataRow dr in bindingTable.Rows)
                instanceIDs += dr[keyColumn] + &quot;,&quot;;
            instanceIDs = instanceIDs.TrimEnd(&#39;,&#39;);

            DataColumn img_HasAttachments = new DataColumn(&quot;img_DataHasAttachments&quot;,
                System.Type.GetType(&quot;System.String&quot;));
            bindingTable.Columns.Add(img_HasAttachments);
            //img_HasAttachments.SetOrdinal(0);

            DataTable mappingDetails =
                Aurigo.AMP3.LinksBL.LinksManager.Instance.GetModuleInstancesHasAttachments(instanceIDs, srcModule)
                    .Tables[0];

            foreach (DataRow dr in bindingTable.Rows)
            {
                DataRow[] statusDetails = mappingDetails.Select(&quot;FormInstanceID = &#39;&quot; + dr[keyColumn] + &quot;&#39;&quot;);
                if (statusDetails.Length &gt; 0)
                {
                    if ((bool)statusDetails[0][&quot;HasAttachments&quot;])
                        dr[&quot;img_DataHasAttachments&quot;] = &quot;True&quot;;
                }
            }
        }


        private void SetServerPictureTakerControlValue(X.xControl ctrl, object value)
        {
            // ToDo: add setter
        }

        private void SetServerDateTimeControlValue(X.xControl ctrl, object value)
        {
            if ((value != null &amp;&amp; value != System.DBNull.Value) || ctrl.AllowNull)
                (ctrl.ControlReference[0] as RadDateTimePicker).SelectedDate = value as DateTime?;
        }

        #endregion

        #region APPLY CHANGES ROUTINES

        private void ApplyChangesToDynamicGrid(X.ControlContainer cont)
        {
            var dg = (X.DynamicGrid)cont;
            if (dg != null &amp;&amp; dg.DataSource != null &amp;&amp; dg.DataSource.DataSourceRow.Count != 0 &amp;&amp; !page.IsPostBack &amp;&amp;
                model.form.engine.IsNewMode)
            {
                BindDynamicGrid(dg, dg.BuildDataTable());
                ;
            }
        }

        private void ApplyChangesToTextBox(X.xControl control)
        {
            var textBox = (X.xControl)control;
            if (textBox.ControlReference.Count != 0)
            {
                TextBox t = textBox.ControlReference[0] as TextBox;
                if (t != null)
                    SetTextBoxProperties(control, TextBoxMode.SingleLine, t);
            }
        }

        #endregion
    }

    internal class Destination
    {
        internal string ID;
        internal string Name;
        internal List&lt;Source&gt; Sources;
        internal string Type;
    }

    [DataContract]
    public class Source
    {
        public X.ControlType controlType;
        public string id;
        [DataMember]
        public string name;
        public string type;
        [DataMember]
        public string value = string.Empty;

        public Source()
        {
        }

        public Source(string name, string value)
        {
            this.name = name;
            this.value = value;
        }
    }

    [DataContract]
    public class ajaxData
    {
        [DataMember]
        public string action = string.Empty;
        [DataMember]
        public List&lt;KVPair&gt; dests;
        [DataMember]
        public List&lt;Source&gt; srcs;

        public ajaxData()
        {
            dests = new List&lt;KVPair&gt;();
            srcs = new List&lt;Source&gt;();
        }
    }

    [DataContract]
    public class KVPair
    {
        [DataMember]
        public string name;
        [DataMember]
        public string value;

        public KVPair(string name, string value)
        {
            this.name = name;
            this.value = value;
        }
    }

    [DataContract]
    public class PickerParamsFromClient
    {
        [DataMember]
        public string PickerName;
        [DataMember]
        public string ColumnName;
        [DataMember]
        public string Filter;
    }

    // ITemplate implementation for the Grid, This is used to add DropDownList for DynamicGrid Inline Edititng
    class RadGridCustomTemplate : ITemplate
    {
        protected RadComboBox dControl;
        protected LiteralControl lControl;
        protected CheckBox cbControl;
        private string colname;
        X.xControl c;
        string type;

        public RadGridCustomTemplate(string cName, X.xControl c, string t)
        {
            colname = cName;
            this.c = c;
            type = t;
        }

        //Instantiate the Templates
        public void InstantiateIn(System.Web.UI.Control container)
        {
            // &quot;E&quot; -&gt; Edit Item Template CheckBox
            if (type == &quot;B&quot;)
            {
                cbControl = new CheckBox();
                cbControl.ID = &quot;cbControl&quot; + this.c.Name;
                cbControl.Attributes.Add(&quot;data-control-name&quot;, this.c.Name);//do not change &quot;data-control-name&quot; name ..because this is used in javascript
                cbControl.Attributes.Add(&quot;onclick&quot;, &quot;BindGridValuesforPost($(this).closest(&#39;div.RadGrid&#39;).attr(&#39;id&#39;));&quot;);
                if (this.c.form.engine.IsViewMode)
                    cbControl.InputAttributes.Add(&quot;disabled&quot;, &quot;disabled&quot;);
                cbControl.DataBinding += new EventHandler(cbControl_DataBinding);
                container.Controls.Add(cbControl);
            }
            // &quot;E&quot; -&gt; Edit Item Template ComboBox
            else if (type == &quot;E&quot;)
            {
                dControl = new RadComboBox();
                dControl.ID = &quot;dControl&quot; + this.c.Name;
                container.Controls.Add(dControl);
            }
            // &quot;I&quot; -&gt; Item Template literalControl
            else
            {
                lControl = new LiteralControl();
                lControl.ID = &quot;lControl&quot; + this.c.Name;
                lControl.DataBinding += new EventHandler(lControl_DataBinding);
                container.Controls.Add(lControl);
            }
        }

        private void cbControl_DataBinding(object sender, EventArgs e)
        {
            CheckBox cb = (CheckBox)sender;
            GridDataItem di = (GridDataItem)cb.NamingContainer;

            if (((DataRowView)di.DataItem)[colname].GetType() == System.Type.GetType(&quot;System.Boolean&quot;))
            {
                cb.Checked = ((DataRowView)di.DataItem)[colname] == null
                    ? false
                    : (Convert.ToBoolean(((DataRowView)di.DataItem)[colname]));
            }
        }

        // On DataBinding of the Literal Control , get the ID and replace the Value 
        public void lControl_DataBinding(object sender, EventArgs e)
        {
            LiteralControl l = (LiteralControl)sender;
            GridDataItem container = (GridDataItem)l.NamingContainer;
            List&lt;X.FormListItem&gt; lbis = c.GetFormList();
            X.FormListItem selectedItem =
                lbis.FirstOrDefault(
                    item =&gt;
                        item.value.ToString2() == ((DataRowView)container.DataItem)[colname].ToString());
            if (selectedItem != null)
            {
                l.Text = selectedItem.display;
            }
            else
            {
                l.Text = ((DataRowView)container.DataItem)[colname].ToString();
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[44,9,44,55,1],[45,9,45,55,1],[46,9,46,56,1],[47,9,47,52,1],[65,15,65,26,1],[66,9,66,10,1],[67,13,67,63,1],[69,13,69,32,1],[70,13,70,38,1],[71,13,71,38,1],[72,13,72,37,1],[74,13,74,41,1],[75,13,75,34,1],[76,13,76,40,1],[77,9,77,10,1],[83,9,83,10,1],[84,13,84,37,1],[85,13,85,14,1],[86,17,86,48,1],[87,17,88,53,1],[89,21,89,55,1],[90,17,90,58,1],[92,17,92,64,1],[93,17,93,18,0],[94,21,94,80,0],[96,21,96,28,0],[96,30,96,41,0],[96,42,96,44,0],[96,45,96,54,0],[97,21,97,22,0],[98,25,98,64,0],[99,21,99,22,0],[100,17,100,18,0],[102,17,102,76,1],[103,21,103,60,0],[105,17,105,37,1],[106,21,106,63,1],[107,13,107,14,1],[109,13,109,42,1],[110,13,110,52,1],[112,13,114,121,1],[115,13,115,14,1],[116,17,116,53,1],[117,21,117,69,1],[118,22,118,51,1],[119,21,119,69,1],[120,22,120,51,1],[121,17,121,18,0],[122,21,122,65,0],[123,21,123,58,0],[124,25,124,86,0],[125,17,125,18,0],[127,21,127,50,1],[128,13,128,14,1],[130,13,130,31,1],[131,13,131,14,1],[132,17,132,80,1],[133,21,133,60,1],[134,22,138,97,1],[139,21,139,56,1],[140,22,140,78,1],[141,21,141,59,0],[142,22,142,63,1],[143,21,143,57,0],[145,21,145,59,1],[149,13,149,14,1],[151,13,151,100,1],[152,17,152,54,1],[156,13,156,46,1],[159,13,159,56,1],[160,13,160,61,1],[162,13,162,97,1],[163,13,163,14,1],[164,17,164,84,1],[165,17,165,57,1],[166,17,166,37,1],[167,17,167,18,1],[168,21,168,44,1],[169,21,169,85,1],[171,21,171,79,1],[172,21,172,75,1],[173,17,173,18,1],[174,13,174,14,1],[176,13,176,59,1],[177,13,177,14,0],[178,17,178,78,0],[179,17,179,70,0],[180,17,180,68,0],[181,13,181,14,0],[183,13,183,20,1],[183,22,183,27,0],[183,28,183,30,1],[183,31,183,55,1],[184,13,184,14,0],[185,17,185,61,0],[186,13,186,14,0],[188,13,188,94,1],[189,13,189,78,1],[190,13,190,74,1],[192,13,192,51,1],[193,17,193,67,1],[195,13,195,25,1],[196,9,196,10,1],[199,9,199,10,1],[200,13,200,38,1],[201,13,201,48,1],[202,17,202,157,0],[204,17,204,129,1],[205,13,205,33,1],[206,9,206,10,1],[209,9,209,10,1],[210,13,210,39,1],[211,13,211,39,1],[212,17,212,57,1],[214,13,214,34,1],[215,13,215,14,1],[216,17,216,47,1],[217,21,217,64,1],[219,17,219,50,1],[220,13,220,14,1],[224,13,224,54,1],[225,9,225,10,1],[228,9,228,10,0],[229,13,229,61,0],[230,13,230,34,0],[231,17,231,52,0],[233,13,233,56,0],[234,17,234,62,0],[235,13,235,56,0],[236,13,236,58,0],[237,13,237,52,0],[238,9,238,10,0],[241,9,241,10,0],[242,13,242,47,0],[243,13,243,107,0],[244,13,244,43,0],[245,13,245,34,0],[246,17,246,58,0],[248,13,248,62,0],[249,9,249,10,0],[252,9,252,10,1],[253,13,253,35,1],[254,13,254,56,1],[256,13,256,56,1],[257,17,257,62,1],[259,13,259,40,1],[260,13,260,34,1],[261,17,261,52,0],[263,13,263,14,1],[264,17,264,47,1],[265,17,265,18,0],[267,21,267,132,0],[268,25,268,47,0],[269,17,269,18,0],[271,17,271,18,1],[272,17,272,44,1],[273,17,273,18,1],[274,13,274,14,1],[277,13,277,52,1],[278,13,278,14,0],[279,17,279,57,0],[281,17,281,117,0],[282,17,282,18,0],[284,21,284,139,0],[285,25,285,67,0],[286,17,286,18,0],[288,22,288,143,0],[289,17,289,18,0],[291,21,291,60,0],[292,25,292,56,0],[293,17,293,18,0],[294,13,294,14,0],[295,13,295,29,1],[296,13,296,52,1],[297,9,297,10,1],[300,9,300,10,0],[301,13,301,38,0],[302,13,302,98,0],[303,13,303,56,0],[306,13,306,35,0],[307,13,307,34,0],[309,13,309,89,0],[312,13,312,51,0],[313,17,313,72,0],[315,13,315,53,0],[316,9,316,10,0],[319,9,319,10,0],[320,13,321,54,0],[322,13,322,14,0],[323,17,323,72,0],[324,13,324,14,0],[326,13,326,39,0],[327,13,327,72,0],[328,13,328,102,0],[330,13,330,106,0],[331,13,331,35,0],[336,13,336,42,0],[337,13,337,31,0],[339,13,339,56,0],[340,17,340,48,0],[341,17,341,47,0],[342,13,342,35,0],[343,13,343,37,0],[344,13,344,36,0],[345,13,345,56,0],[347,13,347,36,0],[348,13,348,38,0],[349,13,349,37,0],[351,13,351,43,0],[351,45,351,68,0],[352,13,352,45,0],[353,13,353,46,0],[354,13,354,46,0],[355,13,355,47,0],[357,13,357,63,0],[358,13,358,64,0],[359,13,359,47,0],[360,13,360,49,0],[362,13,362,41,0],[362,43,362,64,0],[363,13,363,44,0],[364,13,364,44,0],[366,13,366,35,0],[367,13,367,38,0],[369,13,369,41,0],[370,13,370,49,0],[372,13,372,42,0],[373,13,373,44,0],[374,13,374,44,0],[375,13,375,44,0],[376,13,376,41,0],[378,13,378,60,0],[379,13,379,40,0],[380,13,380,34,0],[381,13,381,14,0],[382,17,382,57,0],[383,17,383,49,0],[384,13,384,14,0],[386,13,386,20,0],[386,22,386,40,0],[386,41,386,43,0],[386,44,386,48,0],[387,13,387,14,0],[389,22,389,27,0],[389,29,389,46,0],[389,48,389,51,0],[390,21,390,48,0],[391,25,391,31,0],[392,17,392,39,0],[393,21,393,77,0],[395,21,395,76,0],[396,13,396,14,0],[398,13,398,26,0],[399,9,399,10,0],[402,9,402,10,1],[403,13,403,44,1],[404,13,404,77,1],[406,13,406,56,1],[407,17,407,67,1],[411,13,411,46,1],[412,13,412,68,1],[414,13,414,40,1],[417,13,417,42,1],[418,13,418,39,1],[419,13,419,14,1],[420,17,420,47,1],[424,17,424,45,1],[425,13,425,14,1],[427,13,427,46,1],[428,13,428,40,1],[430,13,430,20,1],[430,22,430,42,1],[430,43,430,45,1],[430,46,430,59,1],[431,13,431,14,1],[432,17,432,53,1],[433,17,433,58,1],[437,17,437,63,1],[438,21,438,56,1],[440,21,440,55,1],[442,17,442,46,1],[445,17,445,78,1],[451,17,452,52,1],[453,21,453,86,1],[455,21,455,65,1],[460,17,462,71,1],[464,17,464,99,1],[465,17,465,31,1],[466,17,466,18,1],[467,21,467,58,1],[468,21,468,86,1],[469,17,469,18,1],[471,17,471,83,1],[472,17,472,18,1],[473,21,473,73,1],[474,25,474,88,1],[478,21,478,60,1],[482,21,482,66,1],[483,25,483,162,0],[485,25,487,51,1],[490,21,492,57,1],[493,21,493,47,1],[494,21,494,58,1],[495,25,495,61,0],[497,25,497,64,1],[498,21,498,70,1],[499,25,499,83,0],[503,21,503,55,1],[504,21,504,50,1],[506,21,506,75,1],[507,21,507,22,0],[508,25,509,65,0],[511,25,511,57,0],[512,25,512,26,0],[513,29,513,67,0],[514,29,514,57,0],[515,25,515,26,0],[516,21,516,22,0],[518,21,518,22,1],[519,25,519,63,1],[520,25,520,53,1],[521,21,521,22,1],[522,17,522,18,1],[524,17,527,22,1],[528,17,528,18,1],[529,21,529,64,1],[533,21,535,51,1],[536,21,536,52,1],[537,21,537,84,1],[538,21,538,22,0],[539,25,542,117,0],[543,25,543,88,0],[544,21,544,22,0],[545,26,545,72,1],[546,21,546,22,0],[547,25,550,117,0],[551,25,551,78,0],[552,21,552,22,0],[554,21,554,22,1],[555,25,555,59,1],[556,25,556,83,1],[557,25,557,51,1],[558,21,558,22,1],[559,21,559,60,1],[563,21,563,49,1],[564,17,564,18,1],[565,13,565,14,1],[567,13,567,26,1],[568,9,568,10,1],[571,9,571,10,0],[572,13,572,47,0],[573,13,573,42,0],[574,13,574,57,0],[575,13,575,14,0],[576,17,576,52,0],[576,53,576,102,0],[577,17,577,63,0],[578,17,578,24,0],[578,26,578,38,0],[578,39,578,41,0],[578,42,578,48,0],[579,17,579,18,0],[580,21,580,45,0],[580,46,580,74,0],[581,26,581,41,0],[582,21,582,64,0],[583,21,583,48,0],[584,21,584,22,0],[585,25,585,81,0],[586,25,586,26,0],[587,29,587,89,0],[588,29,588,81,0],[590,29,590,35,0],[592,21,592,22,0],[593,17,593,18,0],[594,13,594,14,0],[596,13,596,36,0],[597,9,597,10,0],[600,9,600,10,1],[601,13,601,39,1],[602,13,602,36,1],[604,13,604,56,1],[605,9,605,10,1],[608,9,608,10,0],[609,13,609,100,0],[610,13,610,109,0],[611,13,611,111,0],[612,13,612,97,0],[613,13,613,44,0],[615,13,615,77,0],[616,13,616,38,0],[617,17,617,63,0],[619,13,619,31,0],[620,9,620,10,0],[623,9,623,10,0],[624,13,624,100,0],[626,13,626,109,0],[627,13,627,111,0],[629,13,629,92,0],[631,13,631,60,0],[632,13,632,40,0],[633,13,633,102,0],[634,13,634,14,0],[635,17,635,121,0],[636,17,636,37,0],[637,17,637,18,0],[638,21,638,51,0],[639,21,639,50,0],[640,17,640,18,0],[641,13,641,14,0],[643,13,644,68,0],[646,13,646,46,0],[647,13,647,31,0],[648,9,648,10,0],[651,9,651,10,1],[652,13,652,40,1],[654,13,654,51,1],[655,13,655,83,1],[657,13,657,43,1],[658,13,658,14,1],[660,17,660,135,1],[661,17,661,18,1],[662,21,662,121,1],[663,21,663,22,1],[664,25,664,65,1],[665,25,665,67,1],[666,21,666,22,1],[668,21,668,22,0],[670,25,670,61,0],[671,29,671,109,0],[672,30,672,70,0],[673,29,673,113,0],[675,29,675,75,0],[676,21,676,22,0],[677,17,677,18,1],[678,13,678,14,1],[680,13,680,14,1],[681,17,681,155,1],[682,17,682,18,0],[684,21,684,142,0],[685,21,685,22,0],[686,25,686,65,0],[687,25,687,67,0],[688,21,688,22,0],[690,21,690,22,0],[692,25,692,61,0],[693,29,693,137,0],[694,30,694,70,0],[695,29,695,141,0],[697,29,697,75,0],[698,21,698,22,0],[699,17,699,18,0],[700,13,700,14,1],[701,13,701,29,1],[703,13,703,52,1],[704,9,704,10,1],[710,9,710,10,1],[711,13,711,54,1],[712,13,712,14,1],[713,17,713,52,1],[715,22,715,32,1],[715,34,715,55,1],[715,57,715,65,1],[716,17,716,18,1],[717,21,717,55,1],[718,25,718,31,1],[719,17,719,18,1],[721,17,721,57,1],[722,17,722,61,1],[725,17,725,55,1],[726,17,726,18,1],[728,21,728,62,1],[729,21,729,54,1],[731,21,731,36,1],[735,29,735,55,1],[737,29,737,60,0],[740,13,740,14,0],[743,13,743,41,1],[744,9,744,10,1],[747,9,747,10,1],[748,13,748,56,1],[750,13,750,36,1],[751,13,751,14,1],[752,17,752,48,1],[753,13,753,14,1],[754,18,754,86,1],[755,13,755,14,1],[757,17,757,47,1],[758,17,759,72,1],[761,17,761,62,1],[762,21,762,47,1],[763,13,763,14,1],[764,13,764,80,1],[765,13,765,14,0],[766,17,766,60,0],[767,13,767,14,0],[768,13,768,33,1],[770,13,770,56,1],[771,17,771,62,1],[772,9,772,10,1],[775,9,775,10,0],[776,13,776,106,0],[777,13,777,31,0],[778,13,778,34,0],[778,35,778,87,0],[779,13,779,48,0],[780,13,780,24,0],[781,9,781,10,0],[784,9,784,10,1],[785,13,785,90,1],[786,9,786,10,1],[789,9,789,10,1],[790,13,790,44,1],[792,13,792,60,1],[793,13,793,66,1],[795,13,795,54,1],[796,13,796,30,1],[797,13,797,34,1],[798,13,798,34,1],[799,17,799,74,1],[801,13,801,52,1],[802,13,802,14,1],[804,17,804,49,1],[808,17,808,18,1],[809,21,810,80,1],[812,21,812,70,1],[813,21,813,22,1],[814,25,814,85,1],[815,25,815,119,1],[816,21,816,22,1],[817,17,817,18,1],[818,17,818,22,0],[819,17,819,18,0],[820,17,820,18,0],[821,13,821,14,1],[822,13,822,56,1],[823,9,823,10,1],[826,9,826,10,0],[827,13,827,42,0],[829,13,829,20,0],[829,22,829,34,0],[829,35,829,37,0],[829,38,829,51,0],[830,13,830,14,0],[831,17,831,52,0],[832,21,832,49,0],[833,13,833,14,0],[836,13,836,20,0],[836,22,836,31,0],[836,32,836,34,0],[836,35,836,42,0],[837,13,837,14,0],[838,17,838,49,0],[839,17,839,24,0],[839,26,839,38,0],[839,39,839,41,0],[839,42,839,52,0],[840,17,840,18,0],[841,21,841,56,0],[842,25,842,85,0],[844,25,844,64,0],[845,17,845,18,0],[846,17,846,40,0],[847,13,847,14,0],[849,13,849,26,0],[850,9,850,10,0],[853,9,853,10,0],[854,13,854,69,0],[856,13,856,78,0],[856,78,856,120,0],[856,120,856,122,0],[856,13,856,122,0],[857,13,857,71,0],[859,13,859,90,0],[860,13,860,14,0],[861,17,861,72,0],[862,17,862,58,0],[863,17,863,44,0],[864,13,864,14,0],[865,13,865,37,0],[866,13,866,32,0],[867,13,867,49,0],[868,13,868,48,0],[869,17,869,69,0],[870,13,870,129,0],[871,13,871,68,0],[872,9,872,10,0],[875,9,875,10,0],[876,13,876,69,0],[877,13,877,20,0],[877,22,877,32,0],[877,33,877,35,0],[877,36,877,47,0],[878,13,878,14,0],[879,17,879,80,0],[880,17,880,36,0],[881,17,881,18,0],[882,21,882,170,0],[883,17,883,18,0],[884,17,884,71,0],[885,17,885,99,0],[886,17,886,93,0],[887,13,887,14,0],[888,9,888,10,0],[891,9,891,10,0],[892,13,892,69,0],[893,13,893,52,0],[894,9,894,10,0],[897,9,897,10,1],[898,13,899,95,1],[900,13,900,14,0],[901,17,901,72,0],[902,13,902,14,0],[904,13,904,42,1],[905,13,905,112,1],[906,13,906,14,1],[908,17,908,18,1],[909,21,909,77,1],[911,21,911,28,1],[911,30,911,48,1],[911,49,911,51,1],[911,52,911,56,1],[912,21,912,22,1],[913,25,913,76,1],[914,25,914,65,1],[915,25,915,26,0],[916,29,916,78,0],[917,25,917,26,0],[918,25,918,43,1],[919,21,919,22,1],[920,17,920,18,1],[921,17,921,22,0],[922,17,922,18,0],[925,21,925,117,0],[926,25,926,44,0],[927,17,927,18,0],[928,13,928,14,1],[929,18,929,81,1],[930,13,930,14,1],[931,17,931,73,1],[932,17,932,24,1],[932,26,932,44,1],[932,45,932,47,1],[932,48,932,52,1],[933,17,933,18,1],[934,21,934,72,1],[935,21,935,39,1],[936,17,936,18,1],[937,13,937,14,1],[939,13,939,14,1],[940,17,940,73,1],[942,17,942,24,1],[942,26,942,44,1],[942,45,942,47,1],[942,48,942,52,1],[943,17,943,18,1],[944,21,944,72,1],[946,21,946,61,1],[947,21,947,22,1],[948,25,948,74,1],[949,21,949,22,1],[950,21,950,39,1],[951,17,951,18,1],[952,13,952,14,1],[953,13,954,111,1],[955,13,955,14,1],[956,17,956,90,1],[957,17,957,32,1],[958,17,958,18,0],[959,21,959,40,0],[960,17,960,18,0],[961,13,961,14,1],[962,9,962,10,1],[965,9,965,10,0],[966,13,966,163,0],[967,13,967,14,0],[968,17,968,72,0],[969,13,969,14,0],[971,13,971,42,0],[972,13,972,112,0],[973,13,973,14,0],[975,17,975,18,0],[976,21,976,81,0],[978,21,978,28,0],[978,30,978,48,0],[978,49,978,51,0],[978,52,978,56,0],[979,21,979,22,0],[980,25,980,76,0],[981,25,981,65,0],[982,25,982,26,0],[983,29,983,78,0],[984,25,984,26,0],[985,25,985,43,0],[986,21,986,22,0],[988,17,988,18,0],[989,17,989,22,0],[990,17,990,18,0],[993,21,993,117,0],[993,118,993,137,0],[994,17,994,18,0],[995,13,995,14,0],[996,18,996,81,0],[997,13,997,14,0],[999,17,999,73,0],[1000,17,1000,24,0],[1000,26,1000,44,0],[1000,45,1000,47,0],[1000,48,1000,52,0],[1001,17,1001,18,0],[1002,21,1002,72,0],[1003,21,1003,39,0],[1004,17,1004,18,0],[1005,13,1005,14,0],[1007,13,1007,14,0],[1008,17,1008,73,0],[1010,17,1010,24,0],[1010,26,1010,44,0],[1010,45,1010,47,0],[1010,48,1010,52,0],[1011,17,1011,18,0],[1012,21,1012,72,0],[1014,21,1014,61,0],[1015,21,1015,22,0],[1016,25,1016,74,0],[1017,21,1017,22,0],[1018,21,1018,39,0],[1019,17,1019,18,0],[1020,13,1020,14,0],[1021,13,1021,148,0],[1022,13,1022,14,0],[1023,17,1023,90,0],[1024,17,1024,32,0],[1025,17,1025,18,0],[1026,21,1026,40,0],[1027,17,1027,18,0],[1028,13,1028,14,0],[1029,9,1029,10,0],[1032,9,1032,10,0],[1033,13,1034,95,0],[1035,13,1035,14,0],[1036,17,1036,72,0],[1037,13,1037,14,0],[1039,13,1039,41,0],[1041,13,1041,112,0],[1042,13,1042,14,0],[1044,17,1044,18,0],[1045,21,1045,77,0],[1047,21,1047,28,0],[1047,30,1047,48,0],[1047,49,1047,51,0],[1047,52,1047,56,0],[1048,21,1048,22,0],[1049,25,1049,90,0],[1050,25,1050,43,0],[1051,21,1051,22,0],[1052,17,1052,18,0],[1053,17,1053,22,0],[1054,17,1054,18,0],[1057,21,1057,117,0],[1058,25,1058,44,0],[1059,17,1059,18,0],[1060,13,1060,14,0],[1061,18,1061,81,0],[1062,13,1062,14,0],[1063,17,1063,73,0],[1065,17,1065,24,0],[1065,26,1065,44,0],[1065,45,1065,47,0],[1065,48,1065,52,0],[1066,17,1066,18,0],[1067,21,1067,86,0],[1068,21,1068,39,0],[1069,17,1069,18,0],[1070,13,1070,14,0],[1072,13,1072,14,0],[1073,17,1073,73,0],[1075,17,1075,24,0],[1075,26,1075,44,0],[1075,45,1075,47,0],[1075,48,1075,52,0],[1076,17,1076,18,0],[1077,21,1077,86,0],[1078,21,1078,61,0],[1079,21,1079,22,0],[1080,25,1080,74,0],[1081,21,1081,22,0],[1082,21,1082,39,0],[1083,17,1083,18,0],[1084,13,1084,14,0],[1086,13,1086,42,0],[1087,9,1087,10,0],[1090,9,1090,10,1],[1091,13,1092,95,1],[1093,13,1093,14,0],[1094,17,1094,72,0],[1095,13,1095,14,0],[1098,13,1098,112,1],[1099,13,1099,14,1],[1101,17,1102,33,1],[1103,17,1111,19,1],[1113,17,1113,62,1],[1114,17,1114,29,1],[1117,13,1117,14,1],[1118,17,1118,64,1],[1119,17,1119,29,1],[1121,9,1121,10,1],[1124,9,1124,10,0],[1125,13,1125,163,0],[1126,13,1126,14,0],[1127,17,1127,72,0],[1128,13,1128,14,0],[1131,13,1131,112,0],[1132,13,1132,14,0],[1135,17,1135,127,0],[1136,17,1143,19,0],[1145,17,1145,62,0],[1146,17,1146,29,0],[1150,13,1150,14,0],[1151,17,1151,64,0],[1152,17,1152,29,0],[1155,9,1155,10,0],[1158,9,1158,10,1],[1159,13,1159,41,1],[1160,13,1160,54,1],[1161,13,1161,60,1],[1163,13,1163,20,1],[1163,22,1163,40,1],[1163,41,1163,43,1],[1163,44,1163,48,1],[1164,17,1164,69,1],[1165,9,1165,10,1],[1168,9,1168,10,1],[1169,13,1169,37,1],[1171,13,1171,40,1],[1172,13,1172,34,1],[1173,13,1173,34,1],[1174,13,1174,42,1],[1178,13,1178,61,1],[1179,13,1179,59,1],[1181,13,1181,56,1],[1182,17,1182,62,0],[1184,13,1184,85,1],[1185,13,1185,14,1],[1188,17,1188,18,1],[1189,21,1189,62,1],[1190,17,1190,18,1],[1191,17,1191,22,0],[1192,17,1192,18,0],[1193,17,1193,18,0],[1194,13,1194,14,1],[1197,13,1197,56,1],[1198,9,1198,10,1],[1201,9,1201,10,1],[1203,13,1203,60,1],[1204,13,1204,14,1],[1209,17,1209,48,1],[1210,17,1210,84,1],[1211,17,1211,44,1],[1212,21,1212,84,0],[1215,13,1215,14,1],[1217,13,1217,14,0],[1222,17,1222,45,0],[1223,17,1223,81,0],[1224,17,1224,75,0],[1225,17,1225,44,0],[1226,21,1226,81,0],[1228,13,1228,14,0],[1231,13,1231,44,1],[1233,13,1233,56,1],[1234,17,1234,62,1],[1236,13,1236,56,1],[1238,13,1238,80,1],[1239,13,1239,14,1],[1240,17,1240,47,1],[1241,17,1241,18,1],[1242,21,1242,88,1],[1243,21,1243,80,1],[1244,25,1244,105,1],[1245,21,1245,46,1],[1246,25,1246,54,1],[1247,17,1247,18,1],[1249,17,1249,18,0],[1250,21,1251,21,0],[1251,21,1251,22,0],[1251,22,1252,25,0],[1252,25,1252,76,0],[1252,76,1253,25,0],[1253,25,1253,84,0],[1253,84,1254,29,0],[1254,29,1254,93,0],[1254,93,1255,25,0],[1255,25,1255,50,0],[1255,50,1256,29,0],[1256,29,1256,58,0],[1256,58,1257,21,0],[1257,21,1257,22,0],[1257,22,1257,24,0],[1250,21,1257,24,0],[1258,17,1258,18,0],[1259,13,1259,14,1],[1260,18,1260,65,1],[1261,13,1261,14,1],[1262,17,1262,37,1],[1263,21,1263,43,1],[1264,13,1264,14,1],[1265,13,1265,37,1],[1266,17,1266,41,0],[1269,13,1269,52,1],[1270,9,1270,10,1],[1273,9,1273,10,1],[1274,13,1274,43,1],[1276,13,1276,56,1],[1278,13,1278,54,1],[1279,13,1279,14,0],[1281,17,1281,18,0],[1282,21,1282,63,0],[1283,17,1283,18,0],[1284,17,1284,34,0],[1285,17,1285,18,0],[1286,17,1286,18,0],[1287,13,1287,14,0],[1289,13,1289,54,1],[1290,13,1290,14,0],[1292,17,1292,18,0],[1293,21,1293,63,0],[1294,17,1294,18,0],[1295,17,1295,34,0],[1296,17,1296,18,0],[1297,17,1297,18,0],[1298,13,1298,14,0],[1302,13,1302,36,1],[1303,17,1303,48,0],[1305,17,1305,36,1],[1307,13,1307,34,1],[1308,17,1308,48,1],[1310,13,1310,56,1],[1311,17,1311,62,1],[1313,13,1313,52,1],[1314,9,1314,10,1],[1317,9,1317,10,1],[1318,13,1318,47,1],[1321,13,1321,43,1],[1326,13,1326,54,1],[1328,17,1328,18,1],[1329,21,1329,64,1],[1330,17,1330,18,1],[1331,17,1331,34,0],[1332,17,1332,18,0],[1333,17,1333,18,0],[1334,13,1334,54,1],[1336,17,1336,18,1],[1337,21,1337,64,1],[1338,17,1338,18,1],[1339,17,1339,34,0],[1340,17,1340,18,0],[1341,17,1341,18,0],[1342,13,1342,34,1],[1343,13,1343,32,1],[1344,13,1344,34,1],[1345,13,1345,56,1],[1347,13,1347,118,1],[1349,13,1349,62,1],[1350,13,1350,14,1],[1351,17,1351,63,1],[1352,13,1352,14,1],[1353,13,1353,40,1],[1354,13,1354,63,1],[1356,13,1356,62,1],[1357,13,1357,14,0],[1358,17,1358,38,0],[1359,17,1359,75,0],[1360,17,1360,18,0],[1361,21,1361,67,0],[1362,21,1362,70,0],[1363,21,1363,60,0],[1364,21,1364,44,0],[1365,17,1365,18,0],[1366,13,1366,14,0],[1367,13,1367,52,1],[1368,13,1368,14,0],[1369,17,1369,52,0],[1370,13,1370,14,0],[1372,13,1372,52,1],[1373,13,1373,14,1],[1375,17,1375,65,1],[1376,17,1376,18,1],[1377,21,1377,54,1],[1378,17,1378,18,1],[1379,17,1379,47,1],[1380,13,1380,14,1],[1383,13,1383,33,1],[1384,17,1384,50,1],[1386,17,1386,35,1],[1393,13,1393,56,1],[1394,17,1394,62,1],[1396,13,1396,34,1],[1397,17,1397,49,1],[1399,17,1399,60,1],[1401,13,1401,39,1],[1403,13,1403,52,1],[1404,9,1404,10,1],[1407,9,1407,10,1],[1408,13,1409,115,1],[1411,13,1411,111,1],[1413,13,1413,66,1],[1414,13,1414,68,1],[1415,13,1415,67,1],[1416,9,1416,10,1],[1419,9,1419,10,1],[1420,13,1420,57,1],[1421,13,1421,86,1],[1423,13,1423,37,1],[1424,13,1424,45,1],[1426,13,1426,44,1],[1427,13,1427,35,1],[1429,13,1429,70,1],[1430,13,1430,44,1],[1431,13,1431,44,1],[1433,13,1433,68,1],[1435,13,1435,53,1],[1436,13,1436,14,0],[1437,17,1437,53,0],[1438,21,1438,102,0],[1440,17,1440,18,0],[1442,21,1442,72,0],[1443,21,1443,22,0],[1444,25,1444,49,0],[1445,21,1445,22,0],[1446,17,1446,18,0],[1447,13,1447,14,0],[1449,13,1449,58,1],[1451,13,1451,32,1],[1452,13,1452,14,1],[1453,17,1453,63,1],[1454,17,1454,86,1],[1455,17,1455,58,1],[1456,17,1456,41,1],[1457,13,1457,14,1],[1459,17,1459,44,1],[1461,13,1461,42,1],[1463,13,1463,56,1],[1464,13,1464,54,1],[1465,13,1465,31,1],[1468,13,1468,120,1],[1469,17,1469,45,1],[1471,13,1471,56,1],[1472,17,1472,62,0],[1475,13,1475,53,1],[1476,13,1476,14,0],[1477,17,1477,57,0],[1478,13,1478,14,0],[1480,13,1480,57,1],[1481,9,1481,10,1],[1484,9,1484,10,0],[1485,13,1485,72,0],[1487,13,1487,47,0],[1488,13,1488,92,0],[1489,13,1489,45,0],[1490,13,1490,69,0],[1491,13,1491,57,0],[1493,13,1493,55,0],[1495,13,1495,34,0],[1496,17,1496,61,0],[1498,13,1498,65,0],[1499,9,1499,10,0],[1502,9,1502,10,0],[1503,13,1503,66,0],[1505,13,1505,40,0],[1506,13,1506,41,0],[1507,13,1507,43,0],[1508,13,1508,64,0],[1510,13,1510,65,0],[1511,13,1511,91,0],[1512,13,1512,69,0],[1514,13,1514,36,0],[1515,17,1515,71,0],[1516,13,1516,37,0],[1517,17,1517,73,0],[1519,13,1519,34,0],[1520,17,1520,62,0],[1522,13,1522,63,0],[1523,9,1523,10,0],[1526,9,1526,10,1],[1527,13,1527,42,1],[1529,13,1529,34,1],[1530,13,1530,37,1],[1531,13,1531,35,1],[1532,13,1532,49,1],[1533,13,1533,32,1],[1534,13,1534,34,1],[1535,13,1535,56,1],[1537,13,1537,56,1],[1538,17,1538,62,0],[1540,13,1540,34,1],[1541,17,1541,48,1],[1543,13,1543,14,0],[1544,17,1544,60,0],[1545,17,1545,50,0],[1546,21,1546,38,0],[1547,13,1547,14,0],[1549,13,1549,52,1],[1550,9,1550,10,1],[1553,9,1553,10,1],[1558,13,1558,53,1],[1559,13,1559,14,1],[1560,17,1560,47,1],[1561,17,1561,46,1],[1562,17,1562,74,1],[1563,13,1563,14,1],[1565,17,1565,45,1],[1567,13,1567,56,1],[1568,13,1568,37,1],[1570,13,1570,56,1],[1571,17,1571,62,0],[1573,13,1573,34,1],[1575,17,1575,18,1],[1576,21,1576,77,1],[1577,21,1577,76,1],[1578,25,1578,84,1],[1579,17,1579,18,1],[1580,17,1580,34,0],[1581,17,1581,18,0],[1582,17,1582,18,0],[1584,17,1584,39,1],[1586,13,1586,37,1],[1587,17,1587,41,0],[1589,13,1589,52,1],[1590,9,1590,10,1],[1593,9,1593,10,0],[1594,13,1595,54,0],[1596,13,1596,14,0],[1597,17,1597,72,0],[1598,13,1598,14,0],[1600,13,1600,39,0],[1601,13,1601,55,0],[1602,13,1602,61,0],[1604,13,1604,60,0],[1605,13,1605,20,0],[1605,22,1605,40,0],[1605,41,1605,43,0],[1605,44,1605,48,0],[1606,17,1606,68,0],[1608,13,1608,59,0],[1610,13,1610,34,0],[1612,17,1612,18,0],[1613,21,1613,70,0],[1614,21,1616,25,0],[1616,25,1616,26,0],[1616,26,1617,29,0],[1617,29,1617,67,0],[1617,67,1618,33,0],[1618,33,1618,75,0],[1618,75,1619,25,0],[1619,25,1619,26,0],[1619,26,1619,28,0],[1614,21,1619,28,0],[1620,17,1620,18,0],[1621,17,1621,34,0],[1622,17,1622,18,0],[1623,17,1623,18,0],[1625,13,1625,51,0],[1626,9,1626,10,0],[1629,9,1629,10,1],[1630,13,1630,39,1],[1631,13,1631,84,1],[1632,13,1632,32,1],[1633,13,1633,14,1],[1634,17,1635,138,1],[1636,17,1636,60,1],[1637,21,1637,84,1],[1639,17,1639,86,1],[1640,17,1640,85,1],[1641,17,1641,131,1],[1642,13,1642,14,1],[1644,13,1644,28,1],[1645,9,1645,10,1],[1650,9,1650,10,1],[1651,13,1651,85,1],[1652,13,1652,63,1],[1654,13,1654,49,1],[1655,13,1657,88,1],[1658,13,1658,35,1],[1659,13,1659,59,1],[1660,13,1660,51,1],[1661,13,1661,109,1],[1663,13,1668,59,1],[1670,13,1670,61,1],[1671,13,1671,62,1],[1672,13,1673,52,1],[1674,13,1675,50,1],[1676,13,1676,48,1],[1678,13,1678,108,1],[1681,17,1683,55,1],[1687,13,1687,79,1],[1688,13,1688,43,1],[1688,44,1688,79,1],[1689,13,1689,44,1],[1691,13,1691,28,1],[1692,17,1692,48,0],[1693,13,1693,28,1],[1694,9,1694,10,1],[1697,9,1697,10,1],[1698,13,1698,68,1],[1700,13,1700,45,1],[1701,13,1703,17,1],[1703,17,1703,18,1],[1703,18,1704,21,1],[1704,21,1704,38,1],[1704,38,1705,21,1],[1705,21,1705,22,1],[1705,22,1706,25,1],[1706,25,1706,104,1],[1706,104,1707,25,1],[1707,25,1707,26,0],[1707,26,1708,29,1],[1708,29,1708,123,0],[1708,123,1709,29,1],[1709,29,1709,98,0],[1709,98,1710,25,1],[1710,25,1710,26,0],[1710,26,1711,30,1],[1711,30,1711,121,1],[1711,121,1712,25,1],[1712,25,1712,26,0],[1712,26,1713,29,1],[1713,29,1714,50,0],[1714,50,1715,25,1],[1715,25,1715,26,0],[1715,26,1717,29,1],[1717,29,1717,118,1],[1717,118,1718,21,1],[1718,21,1718,22,1],[1718,22,1719,17,1],[1719,17,1719,18,1],[1719,18,1719,20,1],[1701,13,1719,20,1],[1721,13,1721,60,1],[1722,13,1722,36,1],[1723,13,1724,116,1],[1725,13,1725,75,1],[1726,13,1726,36,1],[1728,13,1728,91,1],[1729,9,1729,10,1],[1732,9,1732,10,1],[1733,13,1733,85,1],[1735,13,1735,20,1],[1735,22,1735,35,1],[1735,36,1735,38,1],[1735,39,1735,57,1],[1736,13,1736,14,1],[1737,17,1743,19,1],[1745,17,1745,76,1],[1747,17,1747,55,1],[1748,17,1748,18,1],[1749,21,1749,58,1],[1750,17,1750,18,1],[1751,17,1751,64,1],[1752,17,1752,18,1],[1753,21,1753,38,1],[1756,29,1756,48,0],[1757,29,1757,35,0],[1759,29,1759,50,1],[1760,29,1760,35,1],[1762,29,1762,50,1],[1763,29,1763,35,1],[1765,17,1765,18,1],[1767,17,1767,39,1],[1768,13,1768,14,1],[1770,13,1770,32,1],[1771,9,1771,10,1],[1775,9,1775,10,0],[1778,13,1778,63,0],[1779,13,1779,39,0],[1780,13,1780,14,0],[1781,17,1781,60,0],[1782,17,1782,73,0],[1783,17,1783,31,0],[1786,13,1787,104,0],[1789,13,1789,52,0],[1790,13,1790,14,0],[1791,17,1791,63,0],[1792,17,1792,79,0],[1793,17,1793,18,0],[1794,21,1795,63,0],[1795,63,1795,107,0],[1795,107,1795,110,0],[1794,21,1795,110,0],[1796,17,1796,18,0],[1797,13,1797,14,0],[1799,13,1799,14,0],[1800,17,1800,86,0],[1801,13,1801,14,0],[1803,13,1803,80,0],[1804,13,1804,31,0],[1805,13,1805,14,0],[1806,17,1806,100,0],[1807,17,1807,103,0],[1808,13,1808,14,0],[1811,13,1811,20,0],[1811,22,1811,27,0],[1811,28,1811,30,0],[1811,31,1811,44,0],[1812,13,1812,14,0],[1814,17,1814,41,0],[1815,17,1815,47,0],[1816,17,1816,46,0],[1817,17,1817,56,0],[1818,17,1818,53,0],[1820,17,1820,67,0],[1821,17,1821,18,0],[1822,21,1822,74,0],[1824,21,1824,28,0],[1824,30,1824,48,0],[1824,49,1824,51,0],[1824,52,1824,56,0],[1825,21,1825,22,0],[1826,25,1826,76,0],[1827,21,1827,22,0],[1828,17,1828,18,0],[1829,17,1829,44,0],[1830,17,1830,64,0],[1831,21,1831,83,0],[1832,17,1832,64,0],[1833,13,1833,14,0],[1835,13,1835,84,0],[1840,13,1840,14,0],[1841,17,1841,92,0],[1842,17,1842,18,0],[1843,21,1843,101,0],[1844,17,1844,18,0],[1846,17,1846,18,0],[1847,21,1847,67,0],[1848,17,1848,18,0],[1849,17,1849,68,0],[1850,17,1850,82,0],[1851,21,1852,118,0],[1853,13,1853,14,0],[1855,13,1855,101,0],[1857,13,1857,44,0],[1858,13,1860,27,0],[1861,13,1861,47,0],[1862,13,1862,59,0],[1863,13,1863,61,0],[1864,13,1864,60,0],[1866,13,1867,73,0],[1868,13,1868,14,0],[1869,17,1869,74,0],[1870,17,1870,62,0],[1871,17,1871,88,0],[1872,13,1872,14,0],[1873,13,1873,31,0],[1874,9,1874,10,0],[1878,9,1878,10,1],[1881,13,1881,58,1],[1882,13,1882,28,1],[1883,13,1883,14,0],[1884,17,1884,60,0],[1885,17,1885,77,0],[1886,17,1886,31,0],[1889,13,1889,37,1],[1890,13,1890,45,1],[1891,13,1891,37,1],[1892,13,1892,35,1],[1894,13,1895,72,1],[1896,13,1896,14,1],[1897,17,1897,71,1],[1898,13,1898,14,1],[1900,13,1900,14,1],[1901,17,1901,82,1],[1902,13,1902,14,1],[1904,13,1904,52,1],[1905,9,1905,10,1],[1909,9,1909,10,1],[1910,13,1910,99,1],[1911,13,1911,107,1],[1912,13,1912,101,1],[1913,13,1913,101,1],[1914,13,1914,103,1],[1915,13,1915,103,1],[1916,13,1916,95,1],[1917,13,1917,101,1],[1918,13,1918,101,1],[1919,13,1919,105,1],[1920,13,1920,103,1],[1921,13,1921,111,1],[1922,13,1922,133,1],[1923,13,1923,117,1],[1924,13,1924,101,1],[1925,13,1925,110,1],[1926,13,1926,101,1],[1927,13,1927,93,1],[1928,13,1928,109,1],[1929,13,1929,95,1],[1930,13,1930,114,1],[1931,13,1931,113,1],[1932,13,1932,113,1],[1933,13,1933,121,1],[1934,13,1934,99,1],[1935,13,1935,109,1],[1936,13,1936,93,1],[1937,13,1937,99,1],[1938,13,1938,107,1],[1939,13,1939,103,1],[1940,13,1940,111,1],[1942,13,1942,109,1],[1945,9,1945,10,1],[1948,9,1948,10,0],[1949,13,1949,68,0],[1950,17,1950,76,0],[1952,17,1952,78,0],[1955,9,1955,10,0],[1958,9,1958,10,1],[1961,13,1961,57,1],[1962,13,1962,86,1],[1964,13,1964,70,1],[1966,13,1966,59,1],[1967,13,1967,74,1],[1968,13,1968,136,1],[1969,13,1969,48,1],[1970,13,1970,91,1],[1972,13,1972,40,1],[1973,13,1973,62,1],[1974,13,1974,69,1],[1976,13,1976,84,1],[1977,13,1977,62,1],[1979,13,1979,53,1],[1980,13,1980,14,0],[1981,17,1981,53,0],[1982,21,1982,113,0],[1984,17,1984,18,0],[1986,21,1986,72,0],[1987,25,1987,60,0],[1988,17,1988,18,0],[1989,13,1989,14,0],[1991,13,1991,69,1],[1993,13,1993,33,1],[1994,13,1994,14,1],[1995,17,1995,63,1],[1996,17,1996,101,1],[1997,17,1997,74,1],[1998,13,1998,14,1],[2000,13,2000,14,0],[2001,17,2001,64,0],[2002,17,2002,62,0],[2003,13,2003,14,0],[2005,13,2005,63,1],[2006,13,2006,62,1],[2008,13,2008,56,1],[2009,13,2009,70,1],[2010,13,2010,42,1],[2013,13,2013,110,1],[2014,17,2014,59,1],[2016,13,2016,56,1],[2017,17,2017,73,0],[2019,13,2019,53,1],[2020,13,2020,14,0],[2021,17,2021,68,0],[2022,13,2022,14,0],[2025,13,2025,68,1],[2026,9,2026,10,1],[2029,9,2029,10,1],[2030,13,2030,50,1],[2031,13,2031,167,1],[2033,13,2033,76,1],[2034,13,2034,41,1],[2035,9,2035,10,1],[2040,9,2040,10,1],[2041,13,2051,19,1],[2052,9,2052,10,1],[2055,9,2055,10,1],[2056,13,2056,58,1],[2057,13,2057,14,1],[2060,17,2060,84,1],[2063,17,2063,31,1],[2064,21,2064,41,1],[2066,21,2066,43,0],[2069,17,2069,39,0],[2070,9,2070,10,1],[2073,9,2073,10,1],[2074,13,2074,58,1],[2075,13,2075,14,1],[2076,17,2076,84,1],[2077,17,2077,31,1],[2078,21,2078,39,1],[2079,13,2079,14,1],[2080,9,2080,10,1],[2083,9,2083,10,1],[2084,13,2084,54,1],[2085,13,2085,49,1],[2090,13,2090,61,1],[2091,13,2091,58,1],[2092,13,2092,14,1],[2093,17,2094,84,1],[2095,17,2095,18,1],[2097,21,2099,96,1],[2102,21,2105,36,1],[2109,21,2109,49,1],[2111,21,2113,108,1],[2115,21,2115,82,1],[2116,21,2116,22,1],[2117,25,2118,119,1],[2119,25,2119,40,1],[2120,29,2120,66,1],[2121,25,2121,46,1],[2122,25,2122,26,1],[2124,29,2129,112,1],[2130,33,2130,55,1],[2131,29,2131,45,1],[2134,29,2134,39,0],[2136,26,2136,42,1],[2139,21,2139,33,1],[2142,13,2142,14,1],[2143,17,2143,111,1],[2144,17,2144,18,1],[2146,21,2146,53,1],[2147,25,2147,39,0],[2150,21,2150,63,1],[2151,25,2151,39,0],[2154,21,2156,83,1],[2159,21,2162,36,1],[2166,21,2166,98,1],[2167,21,2167,117,1],[2168,21,2168,22,0],[2169,25,2169,118,0],[2170,25,2170,70,0],[2171,25,2174,37,0],[2174,37,2174,85,0],[2174,85,2174,87,0],[2171,25,2174,87,0],[2175,25,2175,50,0],[2175,51,2175,81,0],[2176,21,2176,22,0],[2177,21,2177,49,1],[2179,21,2181,108,1],[2183,21,2183,82,1],[2184,21,2184,22,1],[2185,25,2185,118,1],[2186,25,2186,40,1],[2187,29,2187,66,1],[2188,25,2188,46,1],[2189,25,2189,26,1],[2191,29,2193,62,1],[2194,33,2194,55,1],[2195,29,2195,45,1],[2198,29,2198,39,0],[2200,26,2200,42,1],[2203,21,2203,33,1],[2205,9,2205,10,1],[2208,9,2208,10,0],[2209,13,2209,53,0],[2210,13,2210,55,0],[2211,13,2211,56,0],[2212,13,2212,45,0],[2215,13,2215,34,0],[2216,17,2216,46,0],[2218,13,2218,14,0],[2220,17,2220,56,0],[2221,17,2221,18,0],[2223,21,2223,46,0],[2224,21,2224,45,0],[2225,21,2225,45,0],[2226,21,2226,61,0],[2227,21,2227,49,0],[2228,17,2228,18,0],[2230,17,2230,18,0],[2232,21,2232,55,0],[2233,26,2233,35,0],[2233,37,2233,52,0],[2233,54,2233,57,0],[2234,25,2234,72,0],[2234,73,2234,91,0],[2235,21,2235,108,0],[2236,17,2236,18,0],[2237,17,2237,69,0],[2239,17,2239,62,0],[2240,21,2240,83,0],[2241,17,2241,47,0],[2243,9,2243,10,0],[2246,9,2246,10,0],[2248,13,2248,14,0],[2249,17,2249,62,0],[2250,17,2250,74,0],[2251,17,2251,18,0],[2252,21,2252,104,0],[2253,21,2253,90,0],[2254,21,2254,28,0],[2254,30,2254,48,0],[2254,49,2254,51,0],[2254,52,2254,73,0],[2255,21,2255,22,0],[2256,25,2256,116,0],[2257,25,2257,26,0],[2258,29,2260,81,0],[2261,29,2261,30,0],[2262,33,2262,56,0],[2263,33,2263,34,0],[2264,37,2264,94,0],[2265,33,2265,34,0],[2267,33,2267,34,0],[2268,37,2268,73,0],[2269,37,2269,63,0],[2270,37,2270,63,0],[2271,37,2271,67,0],[2272,37,2272,75,0],[2273,37,2273,73,0],[2274,37,2274,65,0],[2275,37,2275,79,0],[2277,37,2277,103,0],[2278,37,2278,114,0],[2279,37,2279,78,0],[2280,33,2280,34,0],[2281,29,2281,30,0],[2282,25,2282,26,0],[2283,21,2283,22,0],[2284,21,2284,35,0],[2286,13,2286,14,0],[2288,13,2288,18,0],[2289,13,2289,14,0],[2290,13,2290,14,0],[2291,13,2291,25,0],[2292,9,2292,10,0],[2295,9,2295,10,0],[2296,13,2296,55,0],[2297,13,2297,58,0],[2298,13,2298,39,0],[2299,13,2299,34,0],[2300,13,2300,14,0],[2302,17,2302,48,0],[2303,17,2303,39,0],[2304,17,2304,44,0],[2305,13,2305,14,0],[2307,13,2307,14,0],[2308,17,2308,48,0],[2309,17,2309,43,0],[2310,17,2310,18,0],[2311,21,2311,60,0],[2311,60,2311,104,0],[2311,104,2311,106,0],[2311,21,2311,106,0],[2312,21,2312,41,0],[2313,25,2313,62,0],[2314,17,2314,18,0],[2316,17,2316,105,0],[2317,17,2317,78,0],[2319,17,2321,64,0],[2323,17,2323,32,0],[2324,17,2324,18,0],[2325,21,2325,42,0],[2326,21,2326,112,0],[2327,17,2327,18,0],[2328,13,2328,14,0],[2329,13,2329,71,0],[2330,13,2330,31,0],[2331,17,2331,50,0],[2333,17,2333,44,0],[2334,9,2334,10,0],[2344,9,2344,10,0],[2345,13,2345,31,0],[2346,13,2346,20,0],[2346,22,2346,33,0],[2346,34,2346,36,0],[2346,37,2346,69,0],[2347,13,2347,14,0],[2348,17,2348,90,0],[2349,17,2349,18,0],[2350,21,2350,79,0],[2351,21,2351,30,0],[2354,21,2354,97,0],[2356,13,2356,25,0],[2357,9,2357,10,0],[2360,9,2360,10,1],[2361,13,2361,32,1],[2362,13,2362,39,1],[2364,13,2364,32,1],[2368,13,2368,53,1],[2369,13,2369,14,0],[2370,17,2370,64,0],[2371,17,2371,57,0],[2372,17,2372,50,0],[2373,17,2373,35,0],[2376,13,2376,14,1],[2377,17,2377,67,1],[2378,17,2378,54,1],[2380,9,2380,10,1],[2383,9,2383,10,1],[2384,13,2384,50,1],[2385,13,2385,14,0],[2386,17,2386,54,0],[2387,17,2387,18,0],[2388,21,2388,72,0],[2390,21,2390,73,0],[2391,21,2391,53,0],[2392,21,2392,51,0],[2393,21,2393,90,0],[2394,21,2394,55,0],[2395,21,2395,56,0],[2396,21,2396,49,0],[2397,17,2397,18,0],[2398,13,2398,14,0],[2399,9,2399,10,1],[2402,9,2402,10,1],[2404,13,2404,34,1],[2405,13,2405,37,1],[2406,13,2406,80,1],[2407,13,2407,14,1],[2408,17,2408,31,1],[2409,17,2409,24,1],[2410,21,2410,38,1],[2410,39,2410,41,1],[2411,25,2411,115,1],[2412,17,2412,18,1],[2413,21,2413,49,1],[2414,21,2414,22,1],[2415,25,2417,72,1],[2418,25,2418,33,1],[2419,21,2419,22,1],[2420,17,2420,18,1],[2421,13,2421,14,1],[2422,13,2422,37,1],[2423,9,2423,10,1],[2426,9,2426,10,1],[2427,13,2427,87,1],[2429,13,2429,111,1],[2430,9,2430,10,1],[2433,9,2433,10,1],[2434,13,2435,91,1],[2436,9,2436,10,1],[2439,9,2439,10,1],[2440,13,2440,125,1],[2441,9,2441,10,1],[2444,9,2444,10,0],[2445,13,2446,13,0],[2446,13,2446,14,0],[2446,14,2447,17,0],[2447,17,2447,61,0],[2447,61,2448,17,0],[2448,17,2449,34,0],[2449,34,2449,87,0],[2449,87,2449,89,0],[2448,17,2449,89,0],[2449,89,2450,13,0],[2450,13,2450,14,0],[2450,14,2450,16,0],[2445,13,2450,16,0],[2451,13,2451,47,0],[2451,47,2451,71,0],[2451,71,2451,73,0],[2451,13,2451,73,0],[2452,9,2452,10,0],[2460,9,2460,10,1],[2466,13,2466,51,1],[2467,13,2467,41,1],[2468,13,2468,44,1],[2470,13,2470,42,1],[2471,13,2471,41,1],[2472,13,2472,58,1],[2473,13,2473,46,1],[2473,47,2473,59,0],[2474,13,2475,113,1],[2477,13,2477,69,1],[2478,13,2478,43,1],[2479,13,2479,20,1],[2479,22,2479,34,1],[2479,35,2479,37,1],[2479,38,2479,44,1],[2480,17,2480,44,1],[2483,13,2483,122,1],[2484,17,2485,117,1],[2487,17,2487,32,1],[2489,13,2489,120,1],[2492,13,2492,20,1],[2492,22,2492,39,1],[2492,40,2492,42,1],[2492,43,2492,48,1],[2493,13,2493,14,1],[2494,17,2494,55,1],[2495,17,2495,18,1],[2496,21,2496,131,1],[2497,21,2497,64,1],[2498,17,2498,18,1],[2499,13,2499,14,1],[2501,13,2501,28,1],[2502,9,2502,10,1],[2505,9,2505,10,1],[2517,9,2517,10,1],[2520,9,2520,10,1],[2521,13,2521,46,1],[2523,13,2523,51,1],[2525,13,2525,49,1],[2527,13,2527,32,1],[2529,13,2553,16,1],[2555,13,2577,33,1],[2579,13,2585,20,1],[2587,13,2617,33,1],[2619,13,2746,16,1],[2876,13,2895,16,1],[2897,13,2899,24,1],[2901,13,2901,93,1],[2903,13,2986,16,1],[2989,13,2989,86,1],[2990,17,2990,117,1],[2995,13,2995,14,1],[2996,17,2996,46,1],[2997,17,2997,88,1],[2998,17,2998,84,1],[2999,17,2999,142,1],[3000,17,3001,39,1],[3002,17,3002,32,1],[3003,17,3003,40,1],[3004,17,3004,110,1],[3005,17,3005,120,1],[3006,13,3006,14,1],[3007,13,3007,18,0],[3008,13,3008,14,0],[3009,13,3009,14,0],[3010,9,3010,10,1],[3013,9,3013,10,1],[3014,13,3014,46,1],[3015,13,3015,57,1],[3015,57,3015,105,1],[3015,105,3015,107,1],[3015,13,3015,107,1],[3016,13,3016,40,1],[3017,9,3017,10,1],[3020,9,3020,10,1],[3021,13,3021,41,1],[3023,13,3023,38,1],[3023,40,3023,61,1],[3024,13,3024,55,1],[3025,17,3025,37,1],[3027,13,3027,56,1],[3028,17,3028,38,1],[3030,13,3030,31,1],[3031,17,3031,68,1],[3033,13,3033,30,1],[3034,17,3034,69,1],[3036,13,3036,57,1],[3037,17,3037,58,0],[3039,13,3039,35,1],[3040,9,3040,10,1],[3043,9,3043,10,0],[3044,13,3044,50,0],[3045,13,3045,14,0],[3046,17,3046,73,0],[3047,17,3047,52,0],[3048,17,3048,73,0],[3049,21,3049,70,0],[3050,17,3050,75,0],[3051,21,3051,72,0],[3052,17,3052,73,0],[3054,17,3056,107,0],[3057,17,3059,107,0],[3061,17,3061,55,0],[3063,17,3063,92,0],[3064,17,3064,114,0],[3065,17,3065,64,0],[3066,17,3066,87,0],[3067,17,3067,80,0],[3068,17,3068,51,0],[3069,17,3069,64,0],[3070,17,3070,93,0],[3071,17,3071,67,0],[3072,17,3072,63,0],[3073,17,3073,43,0],[3075,17,3075,49,0],[3077,13,3077,23,0],[3078,9,3078,10,0],[3081,9,3081,10,1],[3082,13,3082,42,1],[3091,13,3091,76,1],[3092,13,3092,42,1],[3093,13,3093,36,1],[3094,13,3094,14,1],[3095,17,3095,99,1],[3096,13,3096,14,1],[3097,18,3097,100,1],[3099,13,3099,72,1],[3101,13,3101,57,1],[3102,13,3102,47,1],[3103,13,3103,46,1],[3104,13,3104,46,1],[3105,13,3105,36,1],[3106,13,3106,14,1],[3107,17,3107,63,1],[3108,17,3108,64,1],[3109,17,3109,121,1],[3110,13,3110,14,1],[3111,18,3111,41,1],[3112,13,3112,14,1],[3113,17,3113,36,1],[3114,17,3114,121,1],[3115,13,3115,14,1],[3117,13,3117,71,1],[3119,13,3121,53,1],[3122,13,3122,14,1],[3123,17,3123,205,1],[3124,17,3124,18,1],[3125,21,3125,102,1],[3126,21,3126,22,1],[3127,25,3128,95,1],[3129,21,3129,22,1],[3131,26,3131,74,1],[3132,21,3132,22,0],[3133,25,3134,104,0],[3135,21,3135,22,0],[3137,21,3137,22,1],[3138,25,3139,92,1],[3140,21,3140,22,1],[3142,21,3143,93,1],[3144,21,3144,39,1],[3145,25,3146,87,1],[3148,21,3148,74,1],[3149,25,3150,80,1],[3152,25,3153,80,1],[3155,21,3155,94,1],[3156,21,3158,119,1],[3159,21,3159,44,1],[3162,21,3163,115,1],[3164,21,3164,44,1],[3165,21,3165,95,1],[3166,21,3166,45,1],[3167,21,3167,98,1],[3168,21,3168,41,1],[3169,21,3169,40,1],[3170,21,3170,22,1],[3171,25,3171,78,1],[3172,29,3172,110,1],[3174,29,3174,111,1],[3175,21,3175,22,1],[3177,25,3177,97,0],[3178,17,3178,18,1],[3180,17,3180,18,1],[3184,21,3184,58,1],[3185,21,3186,61,1],[3187,25,3187,63,1],[3189,25,3189,53,1],[3191,21,3193,90,1],[3195,21,3202,55,1],[3204,21,3204,39,1],[3205,25,3210,64,1],[3212,21,3212,99,1],[3213,21,3215,83,1],[3217,21,3217,39,1],[3218,21,3218,22,1],[3219,25,3220,66,1],[3221,25,3222,64,1],[3223,21,3223,22,1],[3225,21,3225,22,0],[3226,25,3227,63,0],[3228,25,3229,70,0],[3230,21,3230,22,0],[3232,21,3232,41,1],[3233,21,3233,40,1],[3234,25,3234,96,1],[3236,25,3236,97,0],[3237,17,3237,18,1],[3238,13,3238,14,1],[3239,18,3240,103,1],[3241,13,3241,14,0],[3242,17,3243,87,0],[3244,17,3245,92,0],[3246,17,3246,35,0],[3247,21,3249,103,0],[3250,17,3252,47,0],[3253,17,3254,46,0],[3255,17,3255,94,0],[3257,17,3257,37,0],[3258,17,3258,36,0],[3259,21,3261,77,0],[3263,21,3263,93,0],[3264,13,3264,14,0],[3265,18,3265,64,1],[3266,13,3266,14,0],[3267,17,3268,87,0],[3269,17,3270,117,0],[3271,17,3271,35,0],[3272,21,3274,103,0],[3275,17,3277,47,0],[3278,17,3279,67,0],[3280,17,3280,94,0],[3282,17,3282,37,0],[3284,17,3284,36,0],[3287,21,3287,96,0],[3289,21,3289,93,0],[3290,13,3290,14,0],[3292,13,3292,14,1],[3293,17,3294,87,1],[3295,17,3296,92,1],[3297,17,3297,35,1],[3298,21,3300,103,0],[3301,17,3303,47,1],[3305,17,3306,46,1],[3308,17,3308,94,1],[3310,17,3310,37,1],[3311,17,3311,36,1],[3312,21,3312,102,1],[3314,21,3314,93,1],[3315,13,3315,14,1],[3317,13,3317,31,1],[3318,13,3318,14,1],[3319,17,3320,118,1],[3321,17,3321,109,1],[3323,17,3323,75,1],[3324,17,3324,18,0],[3325,21,3326,129,0],[3327,17,3327,18,0],[3328,13,3328,14,1],[3330,13,3330,36,1],[3331,9,3331,10,1],[3335,9,3335,10,1],[3336,13,3336,31,1],[3337,13,3337,14,1],[3338,17,3338,33,1],[3339,17,3339,112,1],[3340,17,3340,33,1],[3341,17,3341,37,1],[3342,17,3342,109,1],[3343,17,3343,32,1],[3344,13,3344,14,1],[3346,13,3346,14,1],[3347,17,3347,34,1],[3348,17,3348,111,1],[3349,17,3349,33,1],[3350,17,3350,37,1],[3351,17,3351,115,1],[3352,17,3352,112,1],[3353,17,3353,109,1],[3354,17,3354,37,1],[3355,17,3355,95,1],[3356,17,3356,32,1],[3357,13,3357,14,1],[3358,9,3358,10,1],[3363,9,3363,10,1],[3364,13,3364,46,1],[3367,13,3368,13,1],[3368,13,3368,14,1],[3368,14,3369,17,1],[3369,17,3385,55,1],[3385,55,3385,77,1],[3385,77,3385,79,1],[3369,17,3385,79,1],[3385,79,3386,17,1],[3386,17,3386,18,1],[3386,18,3387,21,1],[3387,21,3387,50,1],[3387,50,3388,21,1],[3388,21,3388,43,1],[3388,43,3391,21,1],[3391,21,3391,61,1],[3391,61,3392,21,1],[3392,21,3392,57,1],[3392,57,3393,21,1],[3393,21,3393,22,1],[3393,22,3394,25,1],[3394,25,3396,43,1],[3396,43,3398,25,1],[3398,25,3398,43,1],[3398,43,3399,25,1],[3399,25,3399,26,1],[3399,26,3400,29,1],[3400,29,3400,122,1],[3400,122,3401,29,1],[3401,29,3402,111,1],[3402,111,3403,25,1],[3403,25,3403,26,1],[3403,26,3405,25,1],[3405,25,3405,64,1],[3405,64,3406,29,1],[3406,29,3406,51,1],[3406,51,3407,30,1],[3407,30,3407,112,1],[3407,112,3408,29,1],[3408,29,3408,50,1],[3408,50,3409,30,1],[3409,30,3409,66,1],[3409,66,3410,25,1],[3410,25,3410,26,0],[3410,26,3411,29,1],[3411,29,3411,48,0],[3411,48,3412,29,1],[3412,29,3412,110,0],[3412,110,3413,33,1],[3413,33,3415,45,0],[3415,45,3416,25,1],[3416,25,3416,26,0],[3416,26,3417,30,1],[3417,30,3417,66,1],[3417,66,3418,29,1],[3418,29,3418,48,1],[3418,48,3419,30,1],[3419,30,3419,69,1],[3419,69,3420,29,1],[3420,29,3420,51,1],[3420,51,3422,29,1],[3422,29,3422,48,1],[3422,48,3423,25,1],[3423,25,3423,59,1],[3423,59,3424,25,1],[3424,25,3424,63,1],[3424,63,3425,29,1],[3425,29,3426,39,1],[3426,39,3427,25,1],[3427,25,3427,68,1],[3427,68,3428,29,1],[3428,29,3429,53,1],[3429,53,3430,25,1],[3430,25,3430,53,1],[3430,53,3431,21,1],[3431,21,3431,22,1],[3431,22,3432,17,1],[3432,17,3432,18,1],[3432,18,3433,13,1],[3433,13,3433,14,1],[3433,14,3433,16,1],[3367,13,3433,16,1],[3436,13,3436,42,1],[3437,13,3437,47,1],[3438,13,3438,47,1],[3438,47,3438,91,1],[3438,91,3438,93,1],[3438,13,3438,93,1],[3439,13,3439,65,1],[3440,9,3440,10,1],[3443,9,3443,10,1],[3444,13,3444,42,1],[3445,13,3445,30,1],[3446,13,3446,55,1],[3447,13,3447,52,1],[3448,13,3448,56,1],[3449,13,3449,40,1],[3450,13,3450,67,1],[3451,13,3508,76,1],[3509,13,3509,34,1],[3510,9,3510,10,1],[3513,9,3513,10,1],[3514,13,3514,42,1],[3515,13,3515,41,1],[3515,41,3515,76,1],[3515,76,3515,78,1],[3515,13,3515,78,1],[3516,13,3516,58,1],[3517,9,3517,10,1],[3520,9,3520,10,1],[3521,13,3521,42,1],[3522,13,3522,114,1],[3523,13,3547,79,1],[3548,13,3548,34,1],[3549,9,3549,10,1],[3552,9,3552,10,1],[3553,13,3553,47,1],[3554,9,3554,10,1],[3560,13,3560,39,1],[3561,13,3561,14,1],[3562,17,3562,56,1],[3563,13,3563,14,1],[3573,9,3573,10,1],[3574,13,3574,39,1],[3576,13,3576,44,1],[3577,9,3577,10,1],[3580,9,3580,10,1],[3581,13,3581,46,1],[3582,13,3582,14,1],[3583,17,3583,56,1],[3584,17,3584,55,1],[3585,17,3585,34,1],[3586,21,3586,60,1],[3588,17,3588,50,1],[3589,17,3589,34,1],[3590,13,3590,14,1],[3591,9,3591,10,1],[3594,9,3594,10,0],[3595,13,3595,58,0],[3596,9,3596,10,0],[3599,9,3599,10,1],[3600,13,3600,43,1],[3601,13,3601,35,1],[3602,13,3602,24,1],[3603,9,3603,10,1],[3606,9,3606,10,0],[3607,13,3612,15,0],[3613,13,3613,72,0],[3614,13,3614,34,0],[3615,9,3615,10,0],[3618,9,3618,10,1],[3619,13,3619,47,1],[3620,13,3620,42,1],[3622,13,3622,48,1],[3624,13,3624,62,1],[3625,13,3625,14,0],[3626,17,3626,111,0],[3627,17,3627,55,0],[3628,21,3628,50,0],[3629,13,3629,14,0],[3631,13,3631,14,1],[3632,17,3632,46,1],[3633,13,3633,14,1],[3635,13,3635,31,1],[3636,13,3636,14,1],[3637,17,3637,76,1],[3638,13,3638,14,1],[3640,13,3640,39,1],[3641,13,3641,67,1],[3642,13,3642,63,1],[3644,13,3644,38,1],[3645,13,3645,41,1],[3647,13,3647,30,1],[3648,13,3648,44,1],[3649,13,3649,44,1],[3653,13,3653,52,1],[3654,13,3654,14,1],[3655,17,3655,36,1],[3656,17,3656,34,1],[3658,17,3658,93,1],[3659,17,3659,37,1],[3660,21,3660,59,1],[3661,13,3661,14,1],[3663,13,3663,14,1],[3664,17,3664,36,1],[3665,17,3665,36,1],[3666,17,3666,93,1],[3667,17,3667,37,1],[3668,17,3668,18,1],[3669,21,3669,59,1],[3670,21,3670,112,1],[3671,21,3671,22,0],[3672,25,3672,81,0],[3673,21,3673,22,0],[3674,17,3674,18,1],[3676,17,3676,107,1],[3677,17,3677,78,1],[3678,21,3678,74,1],[3680,17,3680,72,1],[3681,17,3681,64,1],[3684,17,3684,151,1],[3685,21,3685,58,1],[3686,13,3686,14,1],[3689,13,3689,94,1],[3690,13,3690,14,0],[3691,17,3691,68,0],[3692,17,3692,81,0],[3693,17,3693,106,0],[3694,17,3694,106,0],[3695,17,3697,101,0],[3698,17,3698,81,0],[3699,17,3699,96,0],[3700,13,3700,14,0],[3705,13,3705,99,1],[3706,13,3706,14,1],[3707,17,3707,56,1],[3710,17,3710,57,1],[3711,21,3711,148,0],[3713,17,3713,18,1],[3714,21,3714,70,1],[3715,17,3715,18,1],[3716,17,3716,55,1],[3717,17,3719,53,1],[3720,17,3720,43,1],[3721,17,3721,54,1],[3722,21,3722,57,0],[3724,21,3724,60,1],[3727,17,3727,61,1],[3728,21,3728,51,1],[3730,17,3730,49,1],[3731,13,3731,14,1],[3733,13,3736,18,1],[3737,13,3737,14,1],[3738,17,3738,35,1],[3739,17,3739,18,1],[3740,21,3740,62,1],[3741,21,3741,92,1],[3742,21,3742,53,1],[3743,17,3743,18,1],[3745,17,3745,18,1],[3746,21,3746,62,1],[3747,21,3747,85,1],[3748,21,3748,53,1],[3749,17,3749,18,1],[3750,13,3750,14,1],[3752,13,3752,38,1],[3753,17,3753,54,0],[3756,13,3756,24,1],[3757,9,3757,10,1],[3761,9,3761,10,1],[3762,13,3762,56,1],[3764,13,3764,55,1],[3765,13,3765,39,1],[3766,13,3766,51,1],[3767,13,3767,71,1],[3768,13,3768,14,1],[3769,17,3772,104,1],[3773,17,3773,80,1],[3774,13,3774,14,1],[3775,18,3775,59,1],[3776,13,3776,14,1],[3777,17,3780,104,1],[3781,17,3781,70,1],[3782,13,3782,14,1],[3784,13,3784,14,1],[3785,17,3785,46,1],[3786,17,3786,70,1],[3787,13,3787,14,1],[3788,13,3788,50,1],[3789,17,3789,53,0],[3791,17,3791,56,1],[3792,13,3792,24,1],[3793,9,3793,10,1],[3797,9,3797,10,0],[3798,13,3798,62,0],[3800,13,3800,96,0],[3801,17,3801,68,0],[3804,13,3804,55,0],[3805,13,3805,51,0],[3806,13,3808,49,0],[3809,13,3809,39,0],[3810,13,3810,50,0],[3811,17,3811,53,0],[3813,17,3813,56,0],[3816,13,3816,57,0],[3817,17,3817,75,0],[3818,13,3818,24,0],[3819,9,3819,10,0],[3822,9,3822,10,0],[3823,13,3825,64,0],[3826,13,3826,69,0],[3827,13,3827,29,0],[3828,13,3828,14,0],[3829,17,3830,44,0],[3831,13,3831,14,0],[3832,13,3832,28,0],[3833,9,3833,10,0],[3858,9,3858,10,1],[3859,13,3859,119,1],[3860,13,3862,22,1],[3863,13,3865,22,1],[3867,13,3867,44,1],[3868,13,3869,90,1],[3870,13,3870,57,1],[3871,13,3872,100,1],[3873,13,3873,104,1],[3874,13,3874,14,0],[3875,17,3876,103,0],[3877,13,3877,14,0],[3879,17,3879,89,1],[3880,13,3880,31,1],[3881,9,3881,10,1],[3884,9,3884,10,1],[3885,13,3885,60,1],[3887,13,3887,46,1],[3891,13,3898,18,1],[3899,13,3899,14,0],[3900,17,3900,67,0],[3901,17,3901,46,0],[3902,13,3902,14,0],[3904,13,3904,32,1],[3905,17,3905,55,1],[3907,13,3907,33,1],[3908,9,3908,10,1],[3911,9,3911,10,1],[3912,13,3912,97,1],[3913,17,3913,49,0],[3914,13,3914,52,1],[3915,13,3915,14,1],[3916,17,3916,46,1],[3917,17,3919,74,1],[3920,17,3920,44,1],[3921,13,3921,14,1],[3922,13,3922,48,1],[3923,9,3923,10,1],[3926,9,3926,10,1],[3927,13,3927,42,1],[3928,13,3928,40,1],[3929,13,3929,43,1],[3931,13,3931,32,1],[3934,13,3934,57,1],[3938,13,3938,34,1],[3939,13,3939,14,1],[3943,17,3945,64,1],[3946,17,3946,18,1],[3947,21,3947,85,1],[3948,17,3948,18,1],[3949,13,3949,14,1],[3950,13,3950,56,1],[3952,13,3952,76,1],[3953,17,3953,50,1],[3956,13,3956,33,1],[3956,34,3956,70,1],[3957,9,3957,10,1],[3960,9,3960,10,1],[3962,13,3962,56,1],[3963,13,3963,14,1],[3964,17,3967,96,1],[3968,17,3968,24,1],[3968,26,3968,51,1],[3968,52,3968,54,1],[3968,55,3968,68,1],[3969,17,3969,18,1],[3970,21,3970,54,1],[3971,21,3971,22,1],[3972,25,3972,65,1],[3975,25,3976,113,1],[3977,25,3977,26,0],[3979,29,3979,86,0],[3980,29,3980,86,0],[3981,29,3982,130,0],[3983,29,3984,68,0],[3985,33,3985,65,0],[3987,34,3988,73,0],[3989,33,3989,65,0],[3991,34,3992,73,0],[3993,33,3993,65,0],[3996,33,3996,67,0],[3997,25,3997,26,0],[3998,25,3998,31,1],[4000,17,4000,18,1],[4001,13,4001,14,1],[4003,13,4003,89,1],[4004,13,4004,52,1],[4005,13,4005,39,1],[4006,13,4006,14,0],[4007,17,4007,53,0],[4008,17,4011,19,0],[4012,17,4012,66,0],[4013,17,4013,49,0],[4014,13,4014,14,0],[4016,13,4016,27,1],[4017,13,4017,14,1],[4018,17,4018,37,1],[4019,17,4019,24,1],[4019,26,4019,31,1],[4019,32,4019,34,1],[4019,35,4019,50,1],[4020,17,4020,18,1],[4021,21,4021,62,1],[4022,17,4022,18,1],[4023,13,4023,14,1],[4024,9,4024,10,1],[4027,9,4027,10,0],[4029,13,4029,46,0],[4031,13,4031,46,0],[4032,13,4032,99,0],[4033,17,4033,50,0],[4034,13,4034,53,0],[4035,17,4036,114,0],[4038,13,4038,43,0],[4039,13,4039,66,0],[4041,13,4041,20,0],[4041,22,4041,40,0],[4041,41,4041,43,0],[4041,44,4041,79,0],[4042,13,4042,14,0],[4043,17,4043,49,0],[4045,17,4045,53,0],[4046,17,4046,35,0],[4048,17,4048,24,0],[4048,26,4048,40,0],[4048,41,4048,43,0],[4048,44,4048,95,0],[4049,17,4049,18,0],[4050,21,4050,103,0],[4051,21,4051,105,0],[4052,17,4052,18,0],[4054,17,4054,44,0],[4055,13,4055,14,0],[4056,9,4056,10,0],[4059,9,4059,10,1],[4061,13,4061,46,1],[4064,13,4064,41,1],[4065,13,4065,78,1],[4068,13,4068,44,1],[4069,13,4069,68,1],[4070,13,4070,43,1],[4071,13,4071,37,1],[4073,13,4073,69,1],[4075,13,4075,53,1],[4076,13,4076,14,0],[4077,17,4077,77,0],[4078,17,4078,33,0],[4079,21,4079,70,0],[4080,13,4080,14,0],[4082,13,4082,51,1],[4083,13,4083,41,1],[4084,13,4084,56,1],[4085,13,4085,40,1],[4087,13,4087,55,1],[4088,17,4088,66,1],[4091,13,4091,20,1],[4091,22,4091,27,0],[4091,28,4091,30,1],[4091,31,4091,54,1],[4092,13,4092,14,0],[4093,17,4093,57,0],[4094,13,4094,14,0],[4096,13,4096,82,1],[4098,13,4098,51,1],[4099,17,4099,81,1],[4101,13,4101,52,1],[4102,17,4102,81,0],[4104,13,4104,48,1],[4105,13,4105,73,1],[4106,13,4106,50,1],[4108,13,4108,51,1],[4110,13,4110,20,1],[4110,22,4110,37,1],[4110,38,4110,40,1],[4110,41,4110,53,1],[4111,13,4111,14,1],[4112,17,4112,59,1],[4113,13,4113,14,1],[4119,13,4119,31,1],[4120,13,4120,14,1],[4121,17,4121,47,1],[4122,17,4122,41,1],[4125,17,4125,56,1],[4126,21,4126,42,1],[4128,17,4128,24,1],[4128,26,4128,46,1],[4128,47,4128,49,1],[4128,50,4128,64,1],[4129,17,4129,18,1],[4131,21,4131,52,1],[4132,21,4132,42,1],[4133,21,4133,120,1],[4134,21,4134,41,1],[4135,21,4135,63,1],[4136,17,4136,18,1],[4137,13,4137,14,1],[4139,13,4139,14,1],[4140,17,4140,24,1],[4140,26,4140,46,1],[4140,47,4140,49,1],[4140,50,4140,64,1],[4141,17,4141,18,1],[4143,21,4143,68,1],[4144,17,4144,18,1],[4145,13,4145,14,1],[4146,13,4146,37,1],[4147,17,4147,58,0],[4148,9,4148,10,1],[4151,9,4151,10,1],[4152,13,4152,68,1],[4153,13,4153,90,1],[4155,13,4155,74,1],[4156,13,4156,66,1],[4157,13,4157,97,1],[4159,13,4159,95,1],[4161,13,4161,54,1],[4162,13,4162,87,1],[4164,13,4164,80,1],[4166,13,4166,42,1],[4167,13,4167,65,1],[4168,13,4168,72,1],[4169,13,4169,55,1],[4170,13,4170,63,1],[4171,13,4171,65,1],[4172,13,4172,73,1],[4173,13,4173,69,1],[4174,13,4174,73,1],[4175,13,4175,81,1],[4176,13,4176,75,1],[4177,13,4177,81,1],[4178,13,4178,51,1],[4180,13,4180,61,1],[4181,13,4181,173,1],[4183,9,4183,10,1],[4192,9,4192,10,1],[4193,13,4193,65,1],[4194,13,4194,77,1],[4195,13,4195,44,1],[4196,18,4196,27,1],[4196,29,4196,39,1],[4196,41,4196,44,1],[4197,13,4197,14,1],[4198,17,4198,50,1],[4199,17,4199,64,1],[4200,17,4200,37,1],[4201,17,4201,18,1],[4203,21,4203,65,1],[4204,21,4204,22,1],[4205,25,4205,53,1],[4206,25,4206,53,1],[4207,25,4207,26,0],[4208,29,4208,79,0],[4209,29,4209,77,0],[4210,29,4212,86,0],[4213,25,4213,26,0],[4214,25,4214,71,1],[4215,25,4215,74,1],[4216,21,4216,22,1],[4217,17,4217,18,1],[4218,17,4218,37,1],[4219,21,4219,47,0],[4220,13,4220,14,1],[4221,13,4221,45,1],[4222,9,4222,10,1],[4225,9,4225,10,1],[4226,13,4226,43,1],[4227,13,4227,32,1],[4228,13,4228,14,1],[4229,17,4229,44,1],[4230,17,4230,18,0],[4231,21,4231,64,0],[4232,21,4232,54,0],[4233,21,4233,128,0],[4235,21,4235,64,0],[4237,21,4237,54,0],[4239,21,4239,65,0],[4240,21,4240,64,0],[4241,21,4241,54,0],[4243,21,4243,28,0],[4243,30,4243,41,0],[4243,42,4243,44,0],[4243,45,4243,58,0],[4244,21,4244,22,0],[4245,25,4245,56,0],[4246,25,4246,41,0],[4247,25,4247,26,0],[4248,29,4248,126,0],[4249,29,4249,84,0],[4250,29,4250,72,0],[4251,29,4251,58,0],[4252,25,4252,26,0],[4253,21,4253,22,0],[4254,17,4254,18,0],[4255,13,4255,14,1],[4256,9,4256,10,1],[4259,9,4259,10,1],[4260,13,4260,106,1],[4261,13,4261,71,1],[4263,13,4263,85,1],[4264,13,4264,41,1],[4265,13,4265,69,1],[4266,13,4266,50,1],[4267,13,4267,41,1],[4269,13,4269,38,1],[4270,17,4270,60,0],[4272,13,4272,20,1],[4272,22,4272,42,1],[4272,43,4272,45,1],[4272,46,4272,61,1],[4273,13,4273,14,1],[4274,17,4274,59,1],[4275,13,4275,14,1],[4276,9,4276,10,1],[4279,9,4279,10,1],[4280,13,4280,103,1],[4285,13,4285,83,1],[4286,13,4286,81,1],[4287,13,4287,68,1],[4288,13,4288,67,1],[4289,13,4289,68,1],[4290,13,4290,88,1],[4291,13,4291,99,1],[4293,13,4293,61,1],[4293,61,4293,82,1],[4293,82,4293,98,1],[4293,13,4293,98,1],[4295,13,4295,20,1],[4295,22,4295,42,1],[4295,43,4295,45,1],[4295,46,4295,61,1],[4296,13,4296,14,1],[4299,17,4299,70,1],[4300,13,4300,14,1],[4302,13,4302,38,1],[4303,17,4303,87,0],[4304,9,4304,10,1],[4307,9,4307,10,0],[4308,13,4308,73,0],[4309,9,4309,10,0],[4312,9,4312,10,0],[4314,13,4314,46,0],[4316,13,4316,57,0],[4317,13,4317,58,0],[4319,13,4319,103,0],[4320,13,4320,48,0],[4322,13,4322,101,0],[4323,17,4323,51,0],[4324,13,4324,54,0],[4325,17,4326,76,0],[4328,13,4328,57,0],[4329,17,4329,70,0],[4331,13,4331,53,0],[4332,13,4332,14,0],[4333,17,4333,77,0],[4334,17,4334,33,0],[4335,21,4335,72,0],[4336,13,4336,14,0],[4339,13,4339,50,0],[4341,13,4341,28,0],[4342,13,4342,14,0],[4343,17,4343,37,0],[4345,17,4345,69,0],[4346,17,4346,74,0],[4348,17,4348,74,0],[4349,17,4349,65,0],[4350,17,4350,68,0],[4352,17,4352,71,0],[4353,21,4353,99,0],[4354,17,4354,68,0],[4355,21,4355,93,0],[4356,17,4356,69,0],[4357,21,4357,95,0],[4360,17,4360,49,0],[4361,17,4361,41,0],[4362,17,4364,21,0],[4364,21,4364,22,0],[4364,22,4365,25,0],[4365,25,4365,64,0],[4365,64,4366,29,0],[4366,29,4366,69,0],[4366,69,4367,21,0],[4367,21,4367,22,0],[4367,22,4368,27,0],[4362,17,4368,27,0],[4369,17,4369,51,0],[4370,17,4370,106,0],[4372,17,4372,46,0],[4375,17,4375,18,0],[4376,21,4376,97,0],[4377,21,4377,56,0],[4378,17,4378,18,0],[4379,17,4379,34,0],[4380,17,4380,18,0],[4381,17,4381,18,0],[4383,22,4383,31,0],[4383,33,4383,50,0],[4384,17,4384,18,0],[4385,21,4385,86,0],[4386,21,4386,99,0],[4387,21,4387,70,0],[4389,21,4389,75,0],[4390,25,4390,69,0],[4392,21,4392,60,0],[4393,21,4393,22,0],[4394,25,4394,32,0],[4394,34,4394,45,0],[4394,46,4394,48,0],[4394,49,4394,53,0],[4395,25,4395,26,0],[4396,29,4396,85,0],[4397,29,4397,73,0],[4398,33,4398,67,0],[4399,25,4399,26,0],[4400,21,4400,22,0],[4402,21,4402,38,0],[4403,17,4403,18,0],[4405,17,4405,59,0],[4406,17,4406,56,0],[4412,17,4412,61,0],[4413,17,4413,51,0],[4416,17,4416,40,0],[4417,17,4417,52,0],[4418,21,4418,65,0],[4420,22,4420,31,0],[4420,33,4420,51,0],[4420,53,4420,56,0],[4421,17,4421,18,0],[4422,21,4422,68,0],[4423,21,4423,53,0],[4424,21,4424,53,0],[4425,17,4425,18,0],[4427,17,4427,37,0],[4428,17,4428,18,0],[4430,21,4430,91,0],[4431,21,4431,22,0],[4432,25,4432,32,0],[4432,34,4432,51,0],[4432,52,4432,54,0],[4432,55,4432,72,0],[4433,25,4433,26,0],[4434,29,4434,76,0],[4435,29,4435,61,0],[4436,29,4436,63,0],[4437,25,4437,26,0],[4438,21,4438,22,0],[4440,21,4440,22,0],[4441,30,4441,39,0],[4441,41,4441,56,0],[4441,58,4441,61,0],[4442,25,4442,26,0],[4443,29,4443,76,0],[4444,29,4444,61,0],[4446,34,4446,43,0],[4446,45,4446,78,0],[4446,80,4446,83,0],[4447,29,4447,30,0],[4448,33,4448,76,0],[4449,33,4449,74,0],[4450,33,4451,49,0],[4452,33,4452,61,0],[4453,33,4453,61,0],[4454,29,4454,30,0],[4455,25,4455,26,0],[4456,21,4456,22,0],[4458,21,4458,40,0],[4459,21,4459,44,0],[4460,21,4460,28,0],[4460,30,4460,47,0],[4460,48,4460,50,0],[4460,51,4460,73,0],[4461,21,4461,22,0],[4462,25,4462,65,0],[4463,25,4463,55,0],[4464,25,4464,98,0],[4465,25,4465,44,0],[4466,25,4466,45,0],[4467,29,4467,43,0],[4469,25,4469,41,0],[4470,25,4470,26,0],[4475,29,4475,64,0],[4476,29,4476,30,0],[4477,33,4477,40,0],[4477,42,4477,60,0],[4477,61,4477,63,0],[4477,64,4477,84,0],[4478,33,4478,34,0],[4479,37,4479,80,0],[4480,37,4480,61,0],[4482,37,4482,95,0],[4484,37,4485,105,0],[4486,37,4486,70,0],[4487,37,4487,64,0],[4488,33,4488,34,0],[4489,29,4489,30,0],[4491,29,4491,30,0],[4492,33,4492,83,0],[4493,33,4493,76,0],[4494,33,4494,57,0],[4495,33,4495,60,0],[4496,29,4496,30,0],[4504,29,4504,51,0],[4505,29,4505,36,0],[4505,38,4505,53,0],[4505,54,4505,56,0],[4505,57,4505,61,0],[4506,29,4506,30,0],[4507,33,4507,40,0],[4507,42,4507,58,0],[4507,59,4507,61,0],[4507,62,4507,83,0],[4508,33,4508,34,0],[4509,37,4509,82,0],[4510,37,4510,63,0],[4512,37,4512,65,0],[4513,37,4514,76,0],[4515,37,4515,38,0],[4516,41,4516,94,0],[4517,41,4517,57,0],[4518,45,4518,68,0],[4519,37,4519,38,0],[4521,41,4521,94,0],[4523,37,4523,94,0],[4524,37,4526,51,0],[4527,37,4527,93,0],[4528,37,4528,73,0],[4529,37,4529,68,0],[4530,33,4530,34,0],[4531,33,4531,49,0],[4532,33,4532,50,0],[4533,29,4533,30,0],[4534,29,4534,64,0],[4535,29,4535,30,0],[4536,33,4536,78,0],[4537,33,4537,59,0],[4539,33,4539,63,0],[4540,33,4540,49,0],[4541,29,4541,30,0],[4544,25,4544,26,0],[4545,25,4545,38,0],[4546,21,4546,22,0],[4547,17,4547,18,0],[4548,13,4548,14,0],[4549,9,4549,10,0],[4554,9,4554,10,0],[4555,13,4555,105,0],[4556,13,4556,64,0],[4557,13,4557,14,0],[4558,17,4558,70,0],[4559,17,4559,45,0],[4560,13,4560,14,0],[4562,17,4562,40,0],[4564,13,4564,56,0],[4566,13,4566,101,0],[4567,13,4567,14,0],[4568,17,4568,54,0],[4569,17,4569,53,0],[4570,13,4570,14,0],[4572,13,4572,28,0],[4573,9,4573,10,0],[4577,9,4577,10,1],[4578,13,4579,48,1],[4580,13,4580,49,1],[4581,13,4581,49,1],[4582,13,4582,53,1],[4583,13,4583,54,1],[4584,13,4584,69,1],[4585,13,4585,20,1],[4585,22,4585,37,1],[4585,38,4585,40,1],[4585,41,4585,52,1],[4586,13,4586,14,1],[4587,17,4587,50,1],[4588,17,4588,49,1],[4589,17,4589,51,1],[4590,17,4590,44,1],[4591,17,4591,44,1],[4594,17,4594,63,1],[4596,17,4596,65,1],[4598,17,4598,78,1],[4599,17,4599,18,1],[4600,21,4600,95,1],[4601,17,4601,18,1],[4603,17,4603,103,1],[4604,21,4604,58,1],[4605,13,4605,14,1],[4606,13,4606,80,1],[4607,13,4607,47,1],[4608,17,4608,97,1],[4610,17,4610,53,1],[4612,13,4612,48,1],[4613,13,4613,47,1],[4614,13,4614,50,1],[4615,13,4615,45,1],[4617,13,4617,40,1],[4618,13,4618,54,1],[4619,13,4619,46,1],[4620,13,4620,55,1],[4621,13,4621,35,1],[4623,13,4623,42,1],[4624,13,4624,48,1],[4625,13,4625,39,1],[4628,13,4628,64,1],[4630,13,4630,45,1],[4631,13,4631,55,1],[4636,13,4639,25,1],[4639,25,4640,61,1],[4640,61,4640,63,1],[4636,13,4640,63,1],[4641,17,4643,114,1],[4645,17,4647,114,1],[4649,13,4649,57,1],[4651,13,4651,41,1],[4652,13,4652,49,1],[4653,13,4653,45,1],[4654,13,4654,41,1],[4655,9,4655,10,1],[4659,9,4659,10,1],[4660,13,4660,60,1],[4661,13,4661,59,1],[4664,13,4664,65,1],[4667,13,4667,45,1],[4668,17,4668,38,1],[4670,13,4670,39,1],[4671,13,4671,28,1],[4672,13,4672,14,1],[4673,17,4673,63,1],[4674,13,4674,14,1],[4676,13,4676,58,1],[4678,13,4678,46,1],[4679,17,4679,64,1],[4681,13,4681,48,1],[4682,17,4682,56,1],[4684,13,4684,46,1],[4686,13,4686,33,1],[4687,9,4687,10,1],[4690,9,4690,10,1],[4691,13,4691,100,1],[4692,17,4692,57,1],[4699,9,4699,10,1],[4702,9,4702,10,0],[4703,13,4703,100,0],[4704,17,4704,57,0],[4711,9,4711,10,0],[4714,9,4714,10,1],[4715,13,4715,42,1],[4718,13,4718,104,1],[4719,13,4719,38,1],[4720,13,4720,42,1],[4721,13,4721,46,1],[4722,13,4722,70,1],[4723,13,4723,65,1],[4724,13,4724,70,1],[4725,13,4725,59,1],[4726,13,4726,68,1],[4727,13,4727,57,1],[4728,13,4728,67,1],[4729,13,4729,71,1],[4730,13,4730,65,1],[4731,13,4731,14,0],[4732,17,4732,67,0],[4733,17,4733,82,0],[4734,13,4734,14,0],[4736,17,4736,66,1],[4737,13,4737,60,1],[4738,13,4738,63,1],[4739,13,4739,57,1],[4740,13,4740,68,1],[4741,13,4741,103,1],[4742,13,4742,38,1],[4743,13,4743,66,1],[4745,13,4745,72,1],[4746,13,4746,14,0],[4747,17,4747,52,0],[4748,17,4748,104,0],[4749,17,4749,77,0],[4750,17,4750,89,0],[4751,17,4751,44,0],[4752,13,4752,14,0],[4754,13,4754,62,1],[4755,13,4755,69,1],[4756,13,4756,67,1],[4757,13,4757,48,1],[4758,13,4758,37,1],[4758,38,4758,73,1],[4760,13,4760,92,1],[4761,13,4761,96,1],[4762,13,4762,84,1],[4764,13,4764,45,1],[4765,13,4765,121,1],[4766,13,4766,14,1],[4767,17,4767,50,1],[4768,13,4768,14,1],[4769,13,4769,57,1],[4770,13,4770,48,1],[4771,13,4771,60,1],[4772,13,4772,72,1],[4776,13,4776,64,1],[4777,13,4777,66,1],[4778,13,4778,67,1],[4779,13,4779,90,1],[4781,13,4781,66,1],[4782,13,4782,54,1],[4784,13,4784,44,1],[4785,13,4785,14,0],[4786,17,4786,64,0],[4787,17,4787,18,0],[4788,21,4788,118,0],[4789,21,4789,77,0],[4790,17,4790,18,0],[4791,17,4791,95,0],[4792,13,4792,14,0],[4794,13,4794,121,1],[4795,17,4795,66,1],[4797,13,4797,40,1],[4798,13,4798,42,1],[4799,13,4799,49,1],[4800,13,4800,56,1],[4801,9,4801,10,1],[4804,9,4804,10,1],[4805,13,4805,48,1],[4806,13,4806,42,1],[4807,13,4807,43,1],[4809,13,4809,65,1],[4810,13,4810,14,1],[4811,17,4811,66,1],[4812,17,4812,77,1],[4813,13,4813,14,1],[4815,13,4815,34,1],[4816,17,4816,24,0],[4818,13,4818,40,1],[4819,13,4819,14,1],[4820,17,4820,54,1],[4821,17,4821,47,1],[4822,17,4822,54,1],[4823,17,4823,64,1],[4825,17,4825,24,1],[4825,26,4825,39,1],[4825,40,4825,42,1],[4825,43,4825,60,1],[4826,17,4826,18,1],[4827,21,4827,55,1],[4828,21,4828,37,1],[4829,25,4829,34,0],[4831,21,4831,60,1],[4832,21,4832,22,1],[4833,25,4833,50,1],[4834,25,4834,70,1],[4835,25,4835,51,1],[4836,21,4836,22,1],[4837,17,4837,18,1],[4839,17,4839,43,1],[4840,17,4840,18,1],[4841,21,4841,65,1],[4842,21,4846,31,1],[4847,21,4847,67,1],[4849,21,4850,21,1],[4850,21,4850,22,1],[4850,22,4851,25,1],[4851,25,4851,60,1],[4851,60,4852,25,1],[4852,25,4852,26,1],[4852,26,4853,29,1],[4853,29,4853,74,1],[4853,74,4855,29,1],[4855,29,4855,30,1],[4855,30,4856,33,1],[4856,33,4856,105,1],[4856,105,4857,29,1],[4857,29,4857,30,1],[4857,30,4858,29,1],[4858,29,4858,34,0],[4858,34,4859,29,1],[4859,29,4859,30,0],[4859,30,4861,29,1],[4861,29,4861,30,0],[4861,30,4862,25,1],[4862,25,4862,26,1],[4862,26,4863,21,1],[4863,21,4863,22,1],[4863,22,4863,24,1],[4849,21,4863,24,1],[4864,17,4864,18,1],[4865,17,4865,58,1],[4866,17,4866,59,1],[4867,17,4867,18,1],[4868,21,4868,52,1],[4869,21,4869,46,1],[4870,21,4870,59,1],[4871,21,4871,96,1],[4872,21,4872,22,0],[4874,25,4874,82,0],[4875,25,4875,73,0],[4876,21,4876,22,0],[4878,21,4878,22,1],[4879,25,4879,72,1],[4880,25,4880,63,1],[4881,21,4881,22,1],[4882,17,4882,18,1],[4883,17,4883,68,1],[4884,17,4884,108,1],[4885,17,4885,18,0],[4886,21,4886,110,0],[4887,21,4887,51,0],[4888,21,4888,22,0],[4889,25,4891,80,0],[4892,25,4892,92,0],[4893,25,4893,98,0],[4894,25,4894,72,0],[4895,25,4895,78,0],[4896,21,4896,22,0],[4897,17,4897,18,0],[4900,17,4900,24,1],[4900,26,4900,43,1],[4900,44,4900,46,1],[4900,47,4900,81,1],[4901,17,4901,18,1],[4902,21,4902,51,1],[4903,21,4903,22,1],[4904,25,4904,93,1],[4905,21,4905,22,1],[4906,17,4906,18,1],[4908,13,4908,14,1],[4909,9,4909,10,1],[4912,9,4912,10,1],[4913,13,4913,48,1],[4914,13,4914,14,1],[4915,17,4915,124,1],[4916,21,4916,130,1],[4917,13,4917,14,1],[4918,9,4918,10,1],[4921,9,4921,10,1],[4922,13,4922,48,1],[4923,13,4923,42,1],[4924,13,4924,43,1],[4926,13,4926,65,1],[4927,13,4927,14,1],[4928,17,4928,66,1],[4929,17,4929,77,1],[4930,13,4930,14,1],[4932,13,4932,34,1],[4933,17,4933,24,0],[4935,13,4935,77,1],[4936,13,4936,20,1],[4936,22,4936,34,1],[4936,35,4936,37,1],[4936,38,4936,50,1],[4937,13,4937,14,1],[4938,17,4938,58,1],[4939,17,4939,18,0],[4940,21,4940,59,0],[4941,25,4941,34,0],[4943,21,4943,73,0],[4944,21,4944,79,0],[4945,21,4945,22,0],[4946,25,4946,150,0],[4947,25,4947,66,0],[4948,21,4948,22,0],[4949,17,4949,18,0],[4950,22,4950,95,1],[4951,17,4951,18,1],[4952,21,4952,73,1],[4954,21,4954,51,1],[4955,25,4955,34,1],[4957,21,4957,76,1],[4958,21,4958,116,1],[4960,21,4960,57,1],[4961,21,4961,22,1],[4962,25,4962,73,1],[4963,25,4963,26,0],[4964,29,4964,99,0],[4965,25,4965,26,0],[4967,25,4967,109,1],[4968,21,4968,22,1],[4969,17,4969,18,1],[4970,22,4970,84,1],[4971,17,4971,18,1],[4973,21,4973,122,1],[4975,21,4975,77,1],[4976,25,4976,34,1],[4978,21,4978,99,1],[4979,21,4979,22,0],[4980,25,4980,129,0],[4981,25,4981,52,0],[4982,25,4982,26,0],[4983,29,4983,47,0],[4984,29,4984,70,0],[4985,29,4986,84,0],[4988,29,4988,74,0],[4989,33,4989,113,0],[4990,29,4990,92,0],[4991,29,4991,137,0],[4992,29,4992,94,0],[4993,25,4993,26,0],[4994,21,4994,22,0],[4995,17,4995,18,1],[4996,13,4996,14,1],[4997,9,4997,10,1],[5003,9,5003,10,1],[5004,13,5004,32,1],[5005,13,5005,14,1],[5006,17,5006,38,1],[5008,17,5008,41,1],[5010,17,5010,62,1],[5011,17,5011,38,1],[5018,17,5018,55,1],[5019,17,5019,49,1],[5020,17,5020,41,1],[5021,17,5023,21,1],[5023,21,5023,22,1],[5023,22,5024,25,1],[5024,25,5024,112,1],[5024,112,5025,29,1],[5025,29,5025,71,1],[5025,71,5026,21,1],[5026,21,5026,22,1],[5026,22,5027,27,1],[5021,17,5027,27,1],[5028,17,5028,51,1],[5029,17,5029,100,1],[5033,17,5033,45,1],[5035,17,5035,18,1],[5036,21,5036,95,1],[5037,21,5037,53,1],[5050,17,5050,18,1],[5051,17,5051,34,0],[5052,17,5052,18,0],[5054,17,5054,18,0],[5056,17,5056,80,1],[5056,80,5056,122,1],[5056,122,5056,124,1],[5056,17,5056,124,1],[5057,17,5057,70,1],[5059,17,5059,47,1],[5060,17,5060,18,0],[5061,21,5062,25,0],[5062,25,5062,116,0],[5062,116,5062,118,0],[5061,21,5062,118,0],[5063,21,5063,74,0],[5064,21,5064,62,0],[5065,21,5065,51,0],[5066,17,5066,18,0],[5069,22,5069,31,1],[5069,33,5069,54,1],[5069,56,5069,59,1],[5070,17,5070,18,1],[5071,21,5071,52,1],[5072,21,5072,52,1],[5073,25,5073,57,1],[5074,21,5074,142,1],[5075,21,5075,22,1],[5076,25,5086,28,1],[5087,21,5087,22,1],[5088,17,5088,18,1],[5091,17,5091,85,1],[5092,17,5092,18,1],[5093,21,5093,53,1],[5094,17,5094,18,1],[5096,17,5096,18,1],[5098,21,5098,28,1],[5098,30,5098,43,1],[5098,44,5098,46,1],[5098,47,5098,58,1],[5099,21,5099,22,1],[5100,25,5100,96,1],[5102,25,5102,51,1],[5103,29,5103,38,0],[5105,25,5105,67,1],[5106,25,5106,26,0],[5107,29,5107,67,0],[5108,29,5108,95,0],[5109,29,5109,99,0],[5110,29,5110,56,0],[5111,29,5111,57,0],[5112,29,5114,69,0],[5115,29,5115,88,0],[5116,33,5116,89,0],[5117,29,5117,65,0],[5118,29,5118,70,0],[5120,25,5120,26,0],[5121,30,5121,99,1],[5122,25,5122,26,0],[5123,29,5123,71,0],[5124,29,5124,66,0],[5125,33,5125,174,0],[5127,29,5135,31,0],[5137,29,5137,88,0],[5138,33,5138,89,0],[5140,29,5140,70,0],[5142,25,5142,26,0],[5144,30,5144,103,1],[5145,25,5145,26,1],[5146,29,5153,31,1],[5155,29,5155,88,1],[5156,33,5156,89,0],[5158,29,5158,70,1],[5160,25,5160,26,1],[5161,30,5161,68,1],[5162,25,5162,26,0],[5163,29,5163,67,0],[5164,29,5164,95,0],[5165,29,5165,99,0],[5166,29,5166,229,0],[5168,29,5168,56,0],[5169,29,5169,57,0],[5170,29,5172,69,0],[5174,29,5174,88,0],[5175,33,5175,89,0],[5177,29,5177,65,0],[5178,29,5178,70,0],[5180,25,5180,26,0],[5181,30,5181,83,1],[5182,25,5182,26,0],[5183,29,5183,64,0],[5186,29,5186,56,0],[5187,29,5187,57,0],[5188,29,5190,69,0],[5191,29,5191,88,0],[5192,33,5192,89,0],[5193,29,5193,65,0],[5194,29,5194,53,0],[5195,29,5195,70,0],[5197,25,5197,26,0],[5199,25,5199,26,1],[5200,29,5200,90,1],[5201,29,5201,30,1],[5202,33,5208,35,1],[5210,33,5210,92,1],[5211,37,5211,93,0],[5213,33,5213,74,1],[5214,29,5214,30,1],[5215,25,5215,26,1],[5216,21,5216,22,1],[5217,17,5217,18,1],[5220,17,5220,18,1],[5222,21,5224,79,1],[5225,21,5225,53,1],[5226,21,5226,22,1],[5227,25,5227,71,1],[5228,25,5228,118,1],[5229,25,5229,41,1],[5233,25,5233,68,1],[5234,29,5234,66,1],[5237,25,5237,94,1],[5238,25,5238,92,1],[5240,25,5240,75,1],[5241,25,5241,79,1],[5242,25,5242,32,1],[5242,34,5242,43,1],[5242,44,5242,46,1],[5242,47,5242,54,1],[5243,25,5243,26,1],[5244,29,5244,90,1],[5245,29,5245,48,1],[5247,29,5247,36,1],[5247,38,5247,50,1],[5247,51,5247,53,1],[5247,54,5247,64,1],[5248,29,5248,30,1],[5249,33,5249,70,1],[5252,33,5252,271,1],[5253,33,5253,34,1],[5254,37,5254,81,1],[5255,41,5255,71,1],[5257,41,5257,74,1],[5258,33,5258,34,1],[5259,38,5259,84,1],[5260,33,5260,34,0],[5261,37,5261,67,0],[5262,33,5262,34,0],[5264,33,5264,34,1],[5265,37,5265,83,1],[5266,41,5266,74,1],[5268,37,5268,38,1],[5270,41,5270,142,1],[5271,41,5271,42,1],[5272,45,5272,70,1],[5273,49,5273,78,1],[5275,49,5275,79,0],[5276,25,5276,26,1],[5277,37,5277,38,1],[5278,33,5278,34,1],[5280,33,5280,83,1],[5281,25,5281,26,1],[5282,29,5282,61,1],[5283,25,5283,26,1],[5285,25,5285,46,1],[5286,25,5286,41,1],[5287,21,5287,22,1],[5288,26,5288,43,1],[5289,21,5289,22,0],[5290,25,5290,71,0],[5291,25,5291,41,0],[5292,25,5292,46,0],[5293,25,5293,41,0],[5294,21,5294,22,0],[5296,21,5296,22,1],[5297,25,5297,71,1],[5298,25,5298,46,1],[5299,25,5299,41,1],[5300,21,5300,22,1],[5302,21,5302,45,1],[5303,21,5303,22,1],[5304,25,5304,60,1],[5305,25,5305,91,1],[5306,25,5306,58,1],[5307,25,5307,55,1],[5308,25,5308,57,1],[5309,25,5309,86,1],[5310,25,5310,61,1],[5311,21,5311,22,1],[5314,21,5314,65,1],[5315,21,5315,22,0],[5316,25,5316,70,0],[5317,25,5317,77,0],[5318,25,5318,91,0],[5320,25,5320,86,0],[5321,25,5321,64,0],[5322,25,5322,58,0],[5323,25,5323,60,0],[5324,25,5324,89,0],[5327,25,5327,49,0],[5328,29,5328,68,0],[5330,29,5330,68,0],[5331,21,5331,22,0],[5333,21,5333,50,1],[5334,21,5334,22,1],[5336,25,5336,32,1],[5336,34,5336,47,1],[5336,48,5336,50,1],[5336,51,5336,62,1],[5337,25,5337,26,1],[5338,29,5338,90,1],[5340,29,5340,45,1],[5341,33,5341,42,0],[5343,29,5343,81,1],[5344,29,5344,30,1],[5345,33,5345,84,1],[5346,29,5346,30,1],[5347,25,5347,26,1],[5349,21,5349,22,1],[5352,21,5352,87,1],[5353,21,5353,22,1],[5356,25,5356,121,1],[5357,25,5357,116,1],[5358,25,5358,26,0],[5359,29,5360,79,0],[5361,29,5363,132,0],[5364,29,5365,57,0],[5366,25,5366,26,0],[5367,25,5367,39,1],[5369,21,5369,22,1],[5372,21,5372,28,1],[5372,30,5372,43,1],[5372,44,5372,46,1],[5372,47,5372,58,1],[5373,21,5373,22,1],[5374,25,5374,89,1],[5375,25,5375,44,1],[5376,29,5376,38,0],[5380,25,5380,81,1],[5381,29,5381,52,1],[5383,25,5384,83,1],[5385,29,5385,52,1],[5388,25,5388,61,1],[5389,29,5389,110,1],[5392,25,5392,71,1],[5393,25,5393,26,1],[5394,29,5394,60,1],[5395,29,5395,92,1],[5396,29,5396,30,1],[5397,33,5397,101,1],[5398,29,5398,30,1],[5399,25,5399,26,1],[5401,25,5401,98,1],[5402,25,5402,26,1],[5403,29,5404,134,1],[5405,29,5405,30,1],[5406,33,5406,105,1],[5407,33,5407,105,1],[5408,29,5408,30,1],[5410,29,5410,78,1],[5411,29,5411,78,1],[5413,29,5413,91,1],[5414,29,5414,91,1],[5415,25,5415,26,1],[5418,25,5418,55,1],[5418,56,5418,100,1],[5419,30,5419,63,0],[5419,64,5419,111,0],[5420,30,5420,62,0],[5420,63,5420,109,0],[5421,30,5421,63,0],[5421,64,5421,111,0],[5422,30,5422,63,0],[5422,64,5422,111,0],[5424,25,5424,56,1],[5426,25,5426,63,1],[5427,25,5427,26,1],[5428,29,5428,180,1],[5429,29,5429,90,1],[5430,29,5430,30,1],[5431,33,5431,138,1],[5432,33,5432,180,1],[5433,29,5433,30,1],[5435,29,5435,30,0],[5436,33,5436,133,0],[5437,33,5437,180,0],[5438,29,5438,30,0],[5439,25,5439,26,1],[5441,25,5441,45,1],[5442,25,5442,72,1],[5443,25,5443,26,1],[5444,29,5444,125,1],[5445,29,5445,86,1],[5446,33,5446,49,0],[5447,25,5447,26,1],[5449,25,5449,250,1],[5450,25,5450,26,1],[5453,29,5453,59,1],[5454,29,5454,30,1],[5455,33,5455,78,1],[5456,33,5456,182,1],[5457,29,5457,30,1],[5458,34,5458,67,0],[5459,29,5459,30,0],[5460,33,5460,81,0],[5461,33,5461,182,0],[5462,29,5462,30,0],[5463,34,5463,67,0],[5464,29,5464,30,0],[5465,33,5465,81,0],[5466,33,5466,182,0],[5467,29,5467,30,0],[5468,34,5468,66,0],[5469,29,5469,30,0],[5470,33,5470,80,0],[5471,33,5471,182,0],[5472,29,5472,30,0],[5473,34,5473,67,0],[5474,29,5474,30,0],[5475,33,5475,81,0],[5476,33,5476,182,0],[5477,29,5477,30,0],[5479,29,5479,99,1],[5480,29,5480,30,1],[5485,29,5485,30,1],[5487,25,5487,26,1],[5489,25,5489,125,1],[5490,29,5490,75,1],[5493,21,5493,22,1],[5496,21,5496,72,1],[5497,21,5497,100,1],[5499,21,5499,94,1],[5500,21,5500,96,1],[5501,21,5501,72,1],[5502,21,5502,95,1],[5504,21,5504,57,1],[5506,21,5506,74,1],[5507,25,5507,114,0],[5509,21,5509,36,1],[5510,21,5510,22,1],[5511,25,5511,54,1],[5512,25,5512,59,1],[5513,21,5513,22,1],[5516,21,5516,90,1],[5517,21,5517,22,0],[5518,25,5518,32,0],[5518,34,5518,54,0],[5518,55,5518,57,0],[5518,58,5518,85,0],[5519,25,5519,26,0],[5520,29,5520,73,0],[5521,29,5521,51,0],[5522,29,5522,60,0],[5523,29,5523,80,0],[5524,33,5524,79,0],[5526,29,5526,77,0],[5527,33,5528,114,0],[5530,33,5530,90,0],[5532,29,5532,62,0],[5534,29,5534,72,0],[5535,25,5535,26,0],[5537,25,5537,32,0],[5537,34,5537,47,0],[5537,48,5537,50,0],[5537,51,5537,62,0],[5538,25,5538,26,0],[5539,29,5539,72,0],[5540,29,5540,30,0],[5541,33,5541,98,0],[5542,33,5542,74,0],[5543,29,5543,30,0],[5544,25,5544,26,0],[5545,21,5545,22,0],[5547,21,5547,35,1],[5548,17,5548,18,1],[5549,17,5549,37,0],[5550,17,5550,18,0],[5552,21,5552,60,0],[5553,17,5553,18,0],[5554,13,5554,14,1],[5555,9,5555,10,1],[5558,9,5558,10,1],[5559,13,5559,29,1],[5560,13,5560,74,1],[5561,13,5561,20,1],[5561,22,5561,37,1],[5561,38,5561,40,1],[5561,41,5561,52,1],[5562,13,5562,14,1],[5563,17,5563,50,1],[5564,17,5564,18,1],[5566,21,5566,69,1],[5567,21,5567,22,1],[5568,25,5568,58,1],[5569,25,5571,115,1],[5572,21,5572,22,1],[5575,21,5575,119,1],[5576,21,5576,89,1],[5577,21,5577,22,1],[5578,25,5580,36,1],[5581,25,5581,54,1],[5582,25,5582,26,1],[5583,29,5583,93,1],[5584,25,5584,26,1],[5585,21,5585,22,1],[5586,17,5586,18,1],[5587,17,5587,27,1],[5588,13,5588,14,1],[5589,9,5589,10,1],[5592,9,5592,10,0],[5593,13,5593,28,0],[5596,21,5596,44,0],[5598,21,5598,46,0],[5600,21,5600,44,0],[5602,21,5602,44,0],[5604,21,5604,44,0],[5606,21,5606,44,0],[5608,9,5608,10,0],[5611,9,5611,10,0],[5612,13,5612,46,0],[5613,13,5613,56,0],[5614,13,5614,45,0],[5615,13,5615,110,0],[5616,13,5616,46,0],[5617,13,5617,68,0],[5619,13,5619,62,0],[5621,13,5621,59,0],[5622,13,5622,14,0],[5623,17,5623,131,0],[5625,17,5625,60,0],[5626,17,5626,35,0],[5627,21,5627,59,0],[5629,22,5629,31,0],[5629,33,5629,53,0],[5629,55,5629,58,0],[5630,17,5630,18,0],[5631,21,5631,49,0],[5632,21,5632,98,0],[5634,21,5634,44,0],[5634,45,5634,54,0],[5636,21,5636,60,0],[5637,21,5637,52,0],[5638,21,5638,22,0],[5639,25,5639,140,0],[5640,25,5640,46,0],[5641,25,5641,26,0],[5642,29,5642,77,0],[5643,25,5643,26,0],[5644,21,5644,22,0],[5645,21,5645,40,0],[5646,21,5646,22,0],[5647,25,5647,51,0],[5648,25,5648,57,0],[5649,25,5649,83,0],[5650,25,5650,64,0],[5652,25,5652,121,0],[5653,25,5653,56,0],[5654,21,5654,22,0],[5657,21,5657,22,0],[5658,25,5658,104,0],[5659,25,5659,73,0],[5660,25,5660,66,0],[5661,25,5661,55,0],[5662,21,5662,22,0],[5664,17,5664,18,0],[5665,17,5665,36,0],[5666,17,5666,18,0],[5667,21,5667,86,0],[5669,21,5669,31,0],[5670,21,5670,28,0],[5670,30,5670,70,0],[5670,71,5670,73,0],[5670,74,5670,93,0],[5671,21,5671,22,0],[5672,25,5672,152,0],[5673,25,5673,77,0],[5674,25,5674,66,0],[5675,21,5675,22,0],[5676,17,5676,18,0],[5677,13,5677,14,0],[5681,9,5681,10,0],[5684,9,5684,10,1],[5686,13,5686,46,1],[5688,13,5688,48,1],[5689,13,5689,14,0],[5690,17,5690,56,0],[5691,17,5691,24,0],[5694,13,5694,56,1],[5695,13,5695,44,1],[5697,13,5697,41,1],[5697,41,5697,83,1],[5697,83,5697,91,1],[5697,13,5697,91,1],[5698,13,5698,14,0],[5699,17,5699,52,0],[5700,17,5700,56,0],[5701,17,5701,43,0],[5702,17,5702,46,0],[5703,13,5703,14,0],[5705,13,5705,38,1],[5709,13,5709,31,1],[5710,13,5710,14,0],[5711,17,5711,56,0],[5712,17,5712,46,0],[5713,17,5713,98,0],[5714,17,5714,74,0],[5715,13,5715,14,0],[5717,13,5717,14,1],[5718,17,5718,98,1],[5719,17,5719,50,1],[5720,13,5720,14,1],[5722,13,5722,54,1],[5723,17,5723,67,1],[5725,13,5725,53,1],[5726,13,5726,14,0],[5727,17,5727,77,0],[5728,17,5728,33,0],[5729,21,5729,72,0],[5730,13,5730,14,0],[5732,13,5732,95,1],[5733,17,5733,48,0],[5734,13,5734,51,1],[5735,17,5736,71,1],[5738,13,5738,62,1],[5739,13,5739,70,1],[5740,13,5740,81,1],[5742,13,5742,50,1],[5743,17,5743,65,1],[5745,13,5745,47,1],[5746,13,5746,51,1],[5747,13,5747,62,1],[5750,13,5750,40,1],[5752,13,5752,49,1],[5754,13,5756,17,1],[5756,17,5756,18,1],[5756,18,5757,21,1],[5757,21,5757,95,1],[5757,95,5758,21,1],[5758,21,5758,22,1],[5758,22,5759,25,1],[5759,25,5759,47,1],[5759,47,5760,25,1],[5760,25,5760,54,1],[5760,54,5761,25,1],[5761,25,5761,62,1],[5761,62,5762,25,1],[5762,25,5762,26,1],[5762,26,5763,29,1],[5763,29,5763,60,1],[5763,60,5764,29,1],[5764,29,5764,94,1],[5764,94,5765,25,1],[5765,25,5765,26,1],[5765,26,5766,25,1],[5766,25,5771,94,1],[5771,94,5772,21,1],[5772,21,5772,22,1],[5772,22,5773,17,1],[5773,17,5773,18,1],[5773,18,5773,20,1],[5754,13,5773,20,1],[5775,13,5775,71,1],[5777,13,5777,54,1],[5778,13,5778,14,1],[5779,17,5779,75,1],[5780,13,5780,14,1],[5782,13,5782,114,1],[5783,13,5783,14,1],[5784,17,5784,52,1],[5785,17,5785,52,1],[5786,17,5786,50,1],[5788,17,5788,46,1],[5789,17,5789,78,1],[5791,17,5791,55,1],[5792,17,5792,54,1],[5793,17,5793,52,1],[5794,17,5795,82,1],[5797,17,5797,43,1],[5798,17,5798,37,1],[5799,17,5799,78,1],[5800,17,5800,38,1],[5801,17,5801,18,1],[5802,21,5802,59,1],[5803,21,5803,79,1],[5804,21,5804,78,1],[5805,21,5805,48,1],[5806,17,5806,18,1],[5809,17,5809,81,1],[5810,17,5810,18,1],[5811,21,5811,90,1],[5812,21,5812,55,1],[5813,21,5813,22,1],[5814,25,5817,96,1],[5818,25,5818,86,1],[5819,25,5819,85,1],[5820,25,5820,55,1],[5821,21,5821,22,1],[5822,17,5822,18,1],[5824,17,5824,44,1],[5825,17,5825,103,1],[5826,17,5826,79,1],[5827,17,5827,39,1],[5828,17,5828,18,1],[5829,21,5829,61,1],[5830,21,5830,80,1],[5831,21,5831,79,1],[5832,21,5832,49,1],[5833,17,5833,18,1],[5835,17,5835,44,1],[5836,17,5836,39,1],[5837,17,5837,39,1],[5838,17,5838,18,0],[5839,21,5839,61,0],[5840,21,5840,80,0],[5841,21,5841,79,0],[5842,21,5842,49,0],[5843,17,5843,18,0],[5846,17,5846,49,1],[5847,17,5847,108,1],[5848,17,5848,77,1],[5849,17,5849,60,1],[5851,17,5851,49,1],[5852,17,5852,44,1],[5853,17,5853,77,1],[5854,17,5854,60,1],[5856,17,5856,46,1],[5857,17,5857,43,1],[5858,17,5860,71,1],[5861,17,5861,81,1],[5862,17,5862,41,1],[5863,17,5863,18,1],[5864,21,5864,65,1],[5865,21,5865,82,1],[5866,21,5866,81,1],[5867,21,5867,51,1],[5868,17,5868,18,1],[5870,17,5870,55,1],[5872,17,5872,119,1],[5874,17,5874,38,1],[5875,17,5875,18,1],[5876,21,5876,76,1],[5877,21,5877,55,1],[5878,21,5879,164,1],[5880,17,5880,18,1],[5882,17,5882,73,1],[5883,17,5883,52,1],[5884,17,5885,161,1],[5887,17,5887,73,1],[5888,17,5888,52,1],[5889,17,5890,108,1],[5892,17,5892,38,1],[5893,17,5893,18,1],[5894,21,5895,119,1],[5896,17,5896,18,1],[5897,17,5899,77,1],[5900,17,5901,121,1],[5903,17,5903,40,1],[5904,21,5904,64,0],[5905,13,5905,14,1],[5907,13,5907,54,1],[5908,13,5908,14,1],[5909,17,5909,72,1],[5910,17,5910,89,1],[5911,17,5911,72,1],[5912,13,5912,14,1],[5913,9,5913,10,1],[5916,9,5916,10,1],[5917,13,5917,45,1],[5918,13,5918,33,1],[5919,13,5919,14,0],[5920,17,5920,45,0],[5921,17,5921,18,0],[5922,21,5922,64,0],[5923,21,5923,54,0],[5924,21,5924,115,0],[5925,21,5925,63,0],[5926,21,5926,103,0],[5928,21,5928,53,0],[5930,21,5930,65,0],[5931,21,5931,65,0],[5932,21,5932,53,0],[5933,17,5933,18,0],[5934,13,5934,14,0],[5935,9,5935,10,1],[5939,9,5939,10,0],[5940,13,5940,46,0],[5942,13,5942,56,0],[5943,13,5943,44,0],[5945,13,5945,115,0],[5946,13,5946,55,0],[5947,13,5947,54,0],[5948,17,5948,66,0],[5950,13,5950,90,0],[5952,13,5952,95,0],[5953,17,5953,48,0],[5954,13,5954,51,0],[5955,17,5956,71,0],[5958,17,5958,135,0],[5960,13,5960,47,0],[5962,13,5962,20,0],[5962,22,5962,32,0],[5962,33,5962,35,0],[5962,36,5962,47,0],[5963,13,5963,14,0],[5964,17,5964,109,0],[5967,17,5967,53,0],[5969,17,5969,73,0],[5970,17,5970,49,0],[5971,17,5971,54,0],[5972,17,5972,55,0],[5973,17,5973,53,0],[5974,17,5974,60,0],[5976,17,5976,62,0],[5977,17,5977,62,0],[5978,17,5978,51,0],[5980,17,5982,69,0],[5983,17,5983,80,0],[5984,21,5984,73,0],[5989,17,5989,58,0],[5991,17,5991,53,0],[5992,17,5992,45,0],[5993,13,5993,14,0],[5995,13,5995,45,0],[5996,9,5996,10,0],[5999,9,5999,10,1],[6000,13,6000,56,1],[6002,13,6002,46,1],[6004,13,6004,39,1],[6006,13,6006,112,1],[6007,13,6007,46,1],[6009,13,6009,30,1],[6010,13,6010,14,1],[6011,17,6011,41,1],[6012,17,6012,35,1],[6013,17,6013,46,1],[6014,13,6014,14,1],[6016,13,6016,65,1],[6017,13,6017,95,1],[6018,13,6018,56,1],[6019,13,6019,55,1],[6020,13,6020,54,1],[6022,13,6022,33,1],[6023,13,6023,14,1],[6024,17,6024,41,1],[6025,17,6025,35,1],[6026,17,6026,46,1],[6027,13,6027,14,1],[6029,13,6029,36,1],[6030,17,6030,60,0],[6031,9,6031,10,1],[6034,9,6034,10,0],[6036,13,6036,46,0],[6038,13,6038,56,0],[6039,13,6039,37,0],[6041,13,6041,110,0],[6043,13,6043,46,0],[6044,13,6044,49,0],[6045,17,6045,106,0],[6047,13,6047,59,0],[6048,13,6048,14,0],[6049,17,6049,55,0],[6050,17,6050,24,0],[6050,26,6050,35,0],[6050,36,6050,38,0],[6050,39,6050,45,0],[6051,17,6051,18,0],[6052,21,6052,52,0],[6053,21,6053,46,0],[6054,25,6054,70,0],[6055,17,6055,18,0],[6056,13,6056,14,0],[6058,13,6058,37,0],[6059,13,6059,42,0],[6061,13,6061,40,0],[6062,17,6062,24,0],[6062,26,6062,39,0],[6062,40,6062,42,0],[6062,43,6062,57,0],[6063,17,6063,18,0],[6064,21,6064,44,0],[6065,17,6065,18,0],[6068,13,6068,38,0],[6070,13,6070,39,0],[6071,13,6071,14,0],[6072,17,6072,60,0],[6073,17,6073,61,0],[6074,17,6074,57,0],[6075,21,6075,70,0],[6076,13,6076,14,0],[6078,13,6078,42,0],[6079,9,6079,10,0],[6083,34,6083,38,0],[6083,39,6083,43,0],[6091,9,6091,10,0],[6092,13,6092,36,0],[6093,13,6093,44,0],[6094,13,6094,86,0],[6095,13,6095,97,0],[6098,13,6098,82,0],[6099,13,6099,14,0],[6100,17,6100,42,0],[6101,17,6101,86,0],[6102,17,6102,24,0],[6102,26,6102,46,0],[6102,47,6102,49,0],[6102,50,6102,75,0],[6103,17,6103,18,0],[6104,21,6104,70,0],[6105,21,6105,22,0],[6106,25,6106,77,0],[6107,29,6107,107,0],[6109,29,6109,72,0],[6110,21,6110,22,0],[6112,21,6119,28,0],[6120,17,6120,18,0],[6122,17,6122,57,0],[6124,17,6124,34,0],[6125,17,6125,18,0],[6126,21,6126,96,0],[6128,21,6128,28,0],[6128,30,6128,59,0],[6128,60,6128,62,0],[6128,63,6128,75,0],[6129,21,6129,22,0],[6130,25,6130,86,0],[6130,86,6130,103,0],[6130,103,6130,105,0],[6130,25,6130,105,0],[6131,25,6131,43,0],[6132,25,6132,26,0],[6133,29,6133,80,0],[6134,29,6134,30,0],[6135,33,6135,93,0],[6136,37,6137,97,0],[6139,37,6139,96,0],[6140,29,6140,30,0],[6142,29,6142,63,0],[6143,29,6143,82,0],[6144,29,6144,53,0],[6145,29,6145,67,0],[6146,29,6146,77,0],[6147,33,6147,54,0],[6149,33,6149,68,0],[6150,29,6150,65,0],[6152,29,6153,57,0],[6153,57,6153,95,0],[6153,95,6153,97,0],[6152,29,6153,97,0],[6154,29,6161,32,0],[6162,25,6162,26,0],[6163,21,6163,22,0],[6164,21,6164,62,0],[6165,21,6165,55,0],[6166,21,6166,38,0],[6167,17,6167,18,0],[6168,13,6168,14,0],[6170,13,6170,20,0],[6170,22,6170,42,0],[6170,43,6170,45,0],[6170,46,6170,71,0],[6171,13,6171,14,0],[6172,17,6172,51,0],[6173,17,6173,62,0],[6174,21,6174,85,0],[6175,17,6175,55,0],[6176,17,6176,72,0],[6177,17,6177,53,0],[6178,17,6178,60,0],[6179,21,6179,54,0],[6181,17,6181,60,0],[6182,21,6182,92,0],[6184,17,6184,86,0],[6185,21,6185,50,0],[6187,17,6187,62,0],[6188,17,6188,18,0],[6189,21,6196,28,0],[6197,17,6197,18,0],[6199,17,6199,82,0],[6199,82,6199,105,0],[6199,105,6199,107,0],[6199,17,6199,107,0],[6200,17,6200,34,0],[6201,21,6201,54,0],[6202,13,6202,14,0],[6204,13,6204,55,0],[6205,13,6205,36,0],[6205,36,6205,54,0],[6205,54,6206,13,0],[6206,13,6206,14,0],[6206,14,6207,17,0],[6207,17,6207,103,0],[6207,103,6208,21,0],[6208,21,6208,61,0],[6208,61,6209,13,0],[6209,13,6209,14,0],[6209,14,6209,16,0],[6205,13,6209,16,0],[6210,13,6210,34,0],[6212,13,6212,35,0],[6213,13,6213,14,0],[6214,17,6214,57,0],[6214,57,6214,70,0],[6214,70,6214,72,0],[6214,17,6214,72,0],[6215,17,6215,34,0],[6216,17,6216,54,0],[6216,54,6216,79,0],[6216,79,6216,85,0],[6216,17,6216,85,0],[6217,17,6217,31,0],[6218,17,6218,18,0],[6219,21,6219,59,0],[6220,21,6220,44,0],[6220,44,6220,73,0],[6220,73,6221,21,0],[6221,21,6221,22,0],[6221,22,6222,25,0],[6222,25,6222,119,0],[6222,119,6223,29,0],[6223,29,6223,94,0],[6223,94,6224,30,0],[6224,30,6224,59,0],[6224,59,6225,29,0],[6225,29,6225,65,0],[6225,65,6226,21,0],[6226,21,6226,22,0],[6226,22,6226,24,0],[6220,21,6226,24,0],[6227,21,6227,45,0],[6228,21,6228,32,0],[6229,21,6229,53,0],[6229,53,6229,78,0],[6229,78,6229,84,0],[6229,21,6229,84,0],[6230,17,6230,18,0],[6231,13,6231,14,0],[6232,18,6232,36,0],[6232,38,6232,43,0],[6232,45,6232,48,0],[6233,13,6233,14,0],[6234,17,6234,39,0],[6235,13,6235,14,0],[6236,9,6236,10,0],[6239,9,6239,10,0],[6240,13,6240,58,0],[6241,13,6241,58,0],[6242,13,6242,47,0],[6243,13,6243,45,0],[6244,13,6244,48,0],[6245,13,6245,86,0],[6246,9,6246,10,0],[6249,9,6249,10,0],[6251,13,6251,46,0],[6253,13,6253,56,0],[6254,13,6254,43,0],[6257,13,6257,112,0],[6258,13,6258,46,0],[6260,13,6260,54,0],[6261,17,6261,67,0],[6263,13,6263,53,0],[6264,13,6264,14,0],[6265,17,6265,77,0],[6266,17,6266,33,0],[6267,21,6267,72,0],[6268,13,6268,14,0],[6269,13,6269,95,0],[6270,17,6270,48,0],[6271,13,6271,51,0],[6272,17,6273,70,0],[6275,13,6275,39,0],[6277,13,6277,33,0],[6278,13,6278,33,0],[6279,13,6279,64,0],[6281,13,6281,58,0],[6282,13,6282,58,0],[6283,13,6283,42,0],[6287,13,6287,91,0],[6288,17,6288,24,0],[6290,13,6290,48,0],[6292,13,6292,30,0],[6294,13,6294,50,0],[6295,13,6295,41,0],[6297,13,6297,20,0],[6297,22,6297,29,0],[6297,30,6297,32,0],[6297,33,6297,62,0],[6298,13,6298,14,0],[6299,17,6299,50,0],[6300,17,6300,53,0],[6302,17,6302,46,0],[6304,17,6304,70,0],[6306,17,6306,45,0],[6308,22,6308,31,0],[6308,33,6308,53,0],[6308,55,6308,58,0],[6309,17,6309,18,0],[6310,21,6310,48,0],[6311,21,6311,50,0],[6315,21,6315,71,0],[6316,25,6316,34,0],[6320,21,6320,68,0],[6321,21,6321,22,0],[6322,25,6322,55,0],[6323,25,6323,48,0],[6324,21,6324,22,0],[6326,25,6326,79,0],[6328,21,6328,51,0],[6329,21,6329,66,0],[6331,21,6334,122,0],[6336,21,6336,22,0],[6337,25,6337,80,0],[6338,29,6338,89,0],[6340,29,6340,50,0],[6341,21,6341,22,0],[6343,21,6347,76,0],[6348,21,6348,22,0],[6349,25,6349,83,0],[6350,29,6350,92,0],[6352,29,6352,50,0],[6353,21,6353,22,0],[6356,21,6357,83,0],[6358,21,6358,22,0],[6359,25,6359,96,0],[6361,25,6361,128,0],[6362,25,6362,26,0],[6366,29,6366,118,0],[6367,33,6367,52,0],[6369,29,6369,30,0],[6370,33,6370,82,0],[6371,33,6371,83,0],[6377,29,6377,30,0],[6378,25,6378,26,0],[6380,25,6380,26,0],[6381,29,6381,50,0],[6382,25,6382,26,0],[6384,21,6384,22,0],[6386,25,6386,76,0],[6388,21,6388,68,0],[6388,69,6388,102,0],[6390,21,6390,122,0],[6393,21,6393,36,0],[6393,37,6393,46,0],[6395,21,6395,64,0],[6396,21,6396,59,0],[6398,21,6398,93,0],[6399,25,6399,62,0],[6401,21,6401,49,0],[6403,21,6403,40,0],[6404,21,6404,22,0],[6405,25,6405,72,0],[6406,29,6406,88,0],[6407,25,6407,46,0],[6409,25,6410,98,0],[6411,29,6411,104,0],[6412,25,6412,44,0],[6413,21,6413,22,0],[6415,25,6415,44,0],[6417,21,6417,68,0],[6418,25,6418,100,0],[6420,21,6420,86,0],[6421,25,6421,95,0],[6422,25,6422,26,0],[6423,29,6423,90,0],[6424,29,6424,74,0],[6425,29,6425,54,0],[6427,29,6427,56,0],[6429,29,6429,63,0],[6430,29,6430,58,0],[6432,29,6432,87,0],[6433,29,6433,30,0],[6434,33,6435,66,0],[6437,33,6437,65,0],[6438,33,6438,34,0],[6439,37,6439,112,0],[6440,37,6440,59,0],[6441,33,6441,34,0],[6442,29,6442,30,0],[6444,29,6444,30,0],[6445,33,6445,108,0],[6446,33,6446,55,0],[6447,29,6447,30,0],[6448,25,6448,26,0],[6450,21,6453,27,0],[6454,21,6454,22,0],[6455,25,6455,97,0],[6456,25,6456,47,0],[6457,21,6457,22,0],[6458,21,6458,68,0],[6459,25,6459,47,0],[6460,17,6460,18,0],[6462,17,6462,35,0],[6463,17,6463,28,0],[6464,13,6464,14,0],[6466,13,6466,36,0],[6467,17,6467,60,0],[6468,9,6468,10,0],[6471,9,6471,10,0],[6472,13,6472,36,0],[6473,13,6473,44,0],[6474,13,6474,86,0],[6475,13,6475,97,0],[6478,13,6478,84,0],[6479,13,6479,14,0],[6480,17,6480,42,0],[6481,17,6481,86,0],[6483,17,6483,24,0],[6483,26,6483,43,0],[6483,44,6483,46,0],[6483,47,6483,59,0],[6484,17,6484,18,0],[6486,21,6486,67,0],[6487,21,6487,22,0],[6488,25,6488,74,0],[6489,29,6489,101,0],[6491,29,6491,69,0],[6492,21,6492,22,0],[6495,21,6501,28,0],[6502,17,6502,18,0],[6504,17,6504,57,0],[6505,17,6505,34,0],[6506,17,6506,18,0],[6507,21,6507,96,0],[6509,21,6509,28,0],[6509,30,6509,59,0],[6509,60,6509,62,0],[6509,63,6509,75,0],[6510,21,6510,22,0],[6511,25,6511,87,0],[6511,87,6511,104,0],[6511,104,6511,106,0],[6511,25,6511,106,0],[6512,25,6512,43,0],[6513,25,6513,26,0],[6515,29,6515,80,0],[6516,29,6516,30,0],[6517,33,6517,93,0],[6518,37,6519,97,0],[6521,37,6521,96,0],[6522,29,6522,30,0],[6525,29,6525,63,0],[6526,29,6526,83,0],[6527,29,6527,53,0],[6528,29,6528,67,0],[6529,29,6529,77,0],[6530,33,6530,54,0],[6532,33,6532,68,0],[6533,29,6533,65,0],[6536,29,6537,57,0],[6537,57,6537,95,0],[6537,95,6537,97,0],[6536,29,6537,97,0],[6538,29,6545,32,0],[6546,25,6546,26,0],[6547,21,6547,22,0],[6550,21,6550,55,0],[6551,21,6551,56,0],[6552,21,6552,38,0],[6553,17,6553,18,0],[6554,13,6554,14,0],[6558,13,6558,54,0],[6559,13,6559,42,0],[6560,13,6560,49,0],[6561,13,6561,35,0],[6562,13,6562,35,0],[6563,17,6563,49,0],[6564,13,6564,38,0],[6566,13,6566,46,0],[6567,13,6567,41,0],[6568,13,6568,54,0],[6569,13,6569,37,0],[6570,17,6570,53,0],[6571,13,6571,52,0],[6572,13,6572,35,0],[6573,17,6573,49,0],[6574,13,6574,38,0],[6576,13,6576,48,0],[6577,13,6577,50,0],[6578,13,6578,56,0],[6579,13,6579,59,0],[6580,17,6580,70,0],[6581,13,6581,54,0],[6582,13,6582,35,0],[6583,17,6583,51,0],[6584,13,6584,40,0],[6588,13,6588,20,0],[6588,22,6588,39,0],[6588,40,6588,42,0],[6588,43,6588,55,0],[6589,13,6589,14,0],[6590,17,6590,47,0],[6591,17,6591,114,0],[6592,17,6592,69,0],[6593,17,6593,55,0],[6594,17,6594,57,0],[6595,21,6595,54,0],[6596,17,6596,62,0],[6597,21,6597,68,0],[6598,17,6598,53,0],[6600,17,6600,83,0],[6601,21,6601,50,0],[6603,17,6603,59,0],[6604,17,6604,18,0],[6605,21,6611,28,0],[6612,17,6612,18,0],[6614,17,6614,82,0],[6614,82,6614,102,0],[6614,102,6614,104,0],[6614,17,6614,104,0],[6615,17,6615,34,0],[6616,21,6616,54,0],[6617,13,6617,14,0],[6621,13,6621,55,0],[6622,13,6622,36,0],[6622,36,6622,54,0],[6622,54,6623,13,0],[6623,13,6623,14,0],[6623,14,6624,17,0],[6624,17,6624,103,0],[6624,103,6625,21,0],[6625,21,6625,61,0],[6625,61,6626,13,0],[6626,13,6626,14,0],[6626,14,6626,16,0],[6622,13,6626,16,0],[6627,13,6627,34,0],[6629,13,6629,52,0],[6629,52,6629,65,0],[6629,65,6629,67,0],[6629,13,6629,67,0],[6630,13,6630,35,0],[6631,13,6631,14,0],[6633,17,6633,40,0],[6633,40,6635,103,0],[6635,103,6636,38,0],[6636,38,6636,103,0],[6636,103,6636,105,0],[6633,17,6636,105,0],[6638,17,6638,34,0],[6639,17,6639,54,0],[6639,54,6639,79,0],[6639,79,6639,85,0],[6639,17,6639,85,0],[6640,17,6640,31,0],[6641,17,6641,18,0],[6643,21,6643,59,0],[6644,21,6644,44,0],[6644,44,6644,73,0],[6644,73,6645,21,0],[6645,21,6645,22,0],[6645,22,6646,25,0],[6646,25,6646,119,0],[6646,119,6647,29,0],[6647,29,6647,94,0],[6647,94,6648,30,0],[6648,30,6648,58,0],[6648,58,6649,25,0],[6649,25,6649,26,0],[6649,26,6650,29,0],[6650,29,6650,65,0],[6650,65,6651,25,0],[6651,25,6651,26,0],[6651,26,6652,21,0],[6652,21,6652,22,0],[6652,22,6652,24,0],[6644,21,6652,24,0],[6653,21,6653,45,0],[6654,21,6654,32,0],[6655,21,6655,53,0],[6655,53,6655,78,0],[6655,78,6655,84,0],[6655,21,6655,84,0],[6656,17,6656,18,0],[6657,13,6657,14,0],[6660,13,6660,30,0],[6661,13,6661,43,0],[6662,13,6662,14,0],[6663,17,6663,60,0],[6664,17,6664,70,0],[6665,17,6665,28,0],[6666,13,6666,14,0],[6668,18,6668,36,0],[6668,38,6668,43,0],[6668,45,6668,48,0],[6669,13,6669,14,0],[6670,17,6670,39,0],[6671,13,6671,14,0],[6672,9,6672,10,0],[6675,9,6675,10,0],[6677,13,6677,46,0],[6679,13,6679,56,0],[6680,13,6680,48,0],[6682,13,6682,118,0],[6683,13,6683,46,0],[6685,13,6685,53,0],[6686,13,6686,14,0],[6687,17,6687,77,0],[6688,17,6688,33,0],[6689,17,6689,18,0],[6690,21,6690,72,0],[6691,21,6691,41,0],[6692,25,6692,65,0],[6693,17,6693,18,0],[6694,13,6694,14,0],[6696,13,6696,55,0],[6697,17,6697,68,0],[6699,13,6699,32,0],[6700,13,6700,38,0],[6702,13,6702,20,0],[6702,22,6702,33,0],[6702,34,6702,36,0],[6702,37,6702,70,0],[6703,13,6703,14,0],[6706,17,6706,104,0],[6707,17,6707,49,0],[6709,17,6709,101,0],[6710,21,6710,53,0],[6711,17,6711,56,0],[6712,21,6713,80,0],[6715,17,6715,68,0],[6717,17,6717,41,0],[6718,17,6718,18,0],[6719,21,6719,47,0],[6720,21,6720,36,0],[6721,21,6721,41,0],[6722,21,6722,41,0],[6723,21,6723,66,0],[6724,21,6724,58,0],[6725,21,6725,46,0],[6727,21,6727,41,0],[6728,21,6728,58,0],[6729,25,6729,76,0],[6730,21,6730,56,0],[6731,25,6731,57,0],[6734,21,6734,70,0],[6740,21,6740,28,0],[6740,30,6740,51,0],[6740,52,6740,54,0],[6740,55,6740,62,0],[6741,21,6741,22,0],[6743,25,6743,54,0],[6745,25,6745,61,0],[6746,25,6746,64,0],[6750,25,6750,73,0],[6751,25,6751,117,0],[6753,25,6753,74,0],[6754,25,6754,64,0],[6756,25,6757,47,0],[6758,29,6758,115,0],[6760,29,6760,49,0],[6762,25,6764,44,0],[6765,25,6765,40,0],[6765,41,6765,50,0],[6767,25,6767,49,0],[6768,25,6768,60,0],[6769,25,6769,50,0],[6771,25,6771,61,0],[6772,25,6772,75,0],[6773,25,6773,49,0],[6774,29,6774,68,0],[6775,25,6775,50,0],[6777,25,6777,60,0],[6778,25,6778,71,0],[6779,25,6779,68,0],[6780,25,6780,71,0],[6781,29,6781,82,0],[6782,25,6782,85,0],[6783,25,6783,57,0],[6784,25,6784,49,0],[6786,25,6786,46,0],[6787,25,6787,68,0],[6788,29,6788,87,0],[6789,25,6789,61,0],[6790,29,6790,67,0],[6792,25,6792,32,0],[6792,34,6792,48,0],[6792,49,6792,51,0],[6792,52,6792,64,0],[6793,25,6793,26,0],[6794,29,6794,59,0],[6795,29,6795,78,0],[6796,29,6796,79,0],[6797,29,6797,119,0],[6799,29,6799,53,0],[6800,33,6800,64,0],[6803,29,6803,66,0],[6804,29,6804,30,0],[6805,33,6805,57,0],[6806,37,6806,79,0],[6808,37,6808,70,0],[6809,29,6809,30,0],[6812,29,6812,60,0],[6813,29,6813,62,0],[6814,29,6814,30,0],[6815,33,6815,79,0],[6815,79,6815,97,0],[6815,97,6815,99,0],[6815,33,6815,99,0],[6816,33,6816,53,0],[6817,37,6817,74,0],[6818,29,6818,30,0],[6821,29,6836,31,0],[6839,29,6839,121,0],[6840,33,6840,109,0],[6842,33,6842,53,0],[6844,29,6845,120,0],[6846,29,6846,45,0],[6847,33,6847,42,0],[6849,29,6849,65,0],[6850,29,6850,53,0],[6851,29,6851,30,0],[6852,33,6852,64,0],[6853,33,6853,69,0],[6854,29,6854,30,0],[6856,29,6856,30,0],[6857,33,6857,55,0],[6858,33,6858,52,0],[6859,29,6859,30,0],[6861,29,6861,66,0],[6862,29,6862,30,0],[6863,33,6863,57,0],[6864,37,6864,95,0],[6866,37,6866,86,0],[6867,29,6867,30,0],[6869,29,6869,71,0],[6870,29,6870,30,0],[6871,33,6871,57,0],[6872,37,6872,90,0],[6874,37,6874,81,0],[6875,29,6875,30,0],[6877,29,6877,50,0],[6878,29,6878,66,0],[6879,33,6879,85,0],[6881,29,6881,65,0],[6882,29,6882,30,0],[6883,33,6883,57,0],[6884,37,6884,79,0],[6886,37,6886,70,0],[6887,29,6887,30,0],[6889,29,6889,89,0],[6890,29,6890,30,0],[6891,33,6891,94,0],[6892,33,6892,78,0],[6893,33,6893,58,0],[6895,33,6895,60,0],[6897,33,6897,67,0],[6898,33,6898,62,0],[6900,33,6900,81,0],[6901,33,6901,34,0],[6902,37,6903,71,0],[6905,37,6905,69,0],[6906,37,6906,38,0],[6907,41,6907,107,0],[6908,41,6908,63,0],[6909,37,6909,38,0],[6910,33,6910,34,0],[6912,33,6912,34,0],[6913,37,6913,103,0],[6914,37,6914,59,0],[6915,33,6915,34,0],[6916,29,6916,30,0],[6918,29,6921,34,0],[6922,29,6922,30,0],[6923,33,6923,96,0],[6924,33,6924,55,0],[6925,29,6925,30,0],[6926,25,6926,26,0],[6927,25,6927,43,0],[6928,25,6928,44,0],[6929,21,6929,22,0],[6930,21,6930,34,0],[6931,17,6931,18,0],[6932,13,6932,14,0],[6934,13,6934,37,0],[6935,17,6935,60,0],[6936,9,6936,10,0],[6939,9,6939,10,1],[6940,13,6940,39,1],[6941,13,6941,47,1],[6943,13,6943,65,1],[6944,13,6944,14,1],[6946,17,6946,102,1],[6947,17,6947,117,1],[6948,17,6949,100,1],[6950,17,6950,39,1],[6951,17,6951,45,1],[6952,13,6952,14,1],[6955,13,6955,52,1],[6956,9,6956,10,1],[6959,9,6959,10,0],[6960,13,6960,47,0],[6961,13,6961,59,0],[6962,9,6962,10,0],[6965,9,6965,10,1],[6966,13,6966,36,1],[6967,13,6967,35,1],[6968,13,6968,35,1],[6969,13,6969,32,1],[6970,13,6970,59,1],[6972,13,6972,56,1],[6973,17,6973,62,0],[6975,13,6975,52,1],[6976,9,6976,10,1],[6980,9,6980,10,1],[6981,13,6981,119,1],[6982,13,6982,127,1],[6983,13,6983,117,1],[6984,13,6984,113,1],[6985,13,6985,125,1],[6986,13,6986,133,1],[6987,13,6987,115,1],[6988,13,6988,117,1],[6989,13,6989,113,1],[6990,13,6990,111,1],[6991,13,6991,115,1],[6992,13,6992,127,1],[6993,13,6993,125,1],[6994,13,6994,119,1],[6995,13,6995,129,1],[6996,13,6996,123,1],[6997,9,6997,10,1],[7004,9,7004,10,0],[7005,13,7005,63,0],[7006,13,7006,49,0],[7007,17,7007,35,0],[7009,17,7009,34,0],[7010,9,7010,10,0],[7013,9,7013,10,1],[7014,13,7014,66,1],[7015,13,7015,46,1],[7016,13,7016,82,1],[7017,9,7017,10,1],[7020,9,7020,10,1],[7023,13,7023,57,1],[7024,13,7024,53,1],[7026,13,7026,42,1],[7029,13,7029,108,1],[7030,13,7030,14,1],[7031,17,7031,42,1],[7032,21,7032,79,1],[7033,13,7033,14,1],[7035,13,7035,48,1],[7036,17,7036,39,0],[7038,13,7038,29,1],[7039,9,7039,10,1],[7042,9,7042,10,0],[7045,13,7045,79,0],[7047,13,7047,44,0],[7048,13,7048,53,0],[7049,13,7049,14,0],[7051,17,7051,18,0],[7052,21,7052,45,0],[7053,17,7053,18,0],[7054,17,7054,34,0],[7055,17,7055,18,0],[7056,21,7056,45,0],[7057,17,7057,18,0],[7058,13,7058,14,0],[7060,17,7060,39,0],[7062,13,7062,29,0],[7063,9,7063,10,0],[7066,9,7066,10,0],[7067,13,7067,63,0],[7068,13,7068,51,0],[7069,13,7069,52,0],[7070,17,7070,50,0],[7071,13,7071,70,0],[7072,9,7072,10,0],[7075,9,7075,10,0],[7076,13,7076,94,0],[7078,13,7078,42,0],[7079,17,7079,46,0],[7081,17,7081,27,0],[7082,9,7082,10,0],[7085,9,7085,10,0],[7086,13,7086,88,0],[7088,13,7088,40,0],[7089,17,7089,47,0],[7091,17,7091,27,0],[7092,9,7092,10,0],[7095,9,7095,10,1],[7096,13,7096,62,1],[7098,13,7098,44,1],[7100,13,7100,28,1],[7101,13,7101,14,1],[7103,17,7103,139,1],[7104,17,7104,18,1],[7105,21,7105,46,1],[7106,25,7106,83,1],[7108,25,7108,44,1],[7109,17,7109,18,1],[7111,21,7111,40,1],[7112,13,7112,14,1],[7114,13,7114,29,1],[7115,9,7115,10,1],[7118,9,7118,10,0],[7119,13,7119,127,0],[7120,13,7120,31,0],[7121,13,7121,14,0],[7122,17,7122,41,0],[7125,13,7125,33,0],[7126,9,7126,10,0],[7129,9,7129,10,0],[7130,13,7130,119,0],[7131,13,7131,74,0],[7132,13,7132,24,0],[7133,9,7133,10,0],[7136,9,7136,10,0],[7137,13,7137,81,0],[7138,13,7138,54,0],[7139,9,7139,10,0],[7142,9,7142,10,1],[7143,13,7143,64,1],[7144,13,7144,39,1],[7145,13,7145,55,1],[7146,13,7146,14,1],[7147,17,7147,78,1],[7148,17,7150,28,1],[7151,13,7151,14,1],[7153,13,7154,114,1],[7155,13,7155,14,1],[7156,17,7156,72,1],[7160,17,7160,33,1],[7161,17,7161,18,1],[7162,21,7162,76,1],[7164,17,7164,40,1],[7166,13,7166,38,1],[7167,9,7167,10,1],[7170,9,7170,10,1],[7171,13,7171,63,1],[7173,13,7173,57,1],[7174,17,7174,47,1],[7176,17,7176,35,0],[7177,9,7177,10,1],[7180,9,7180,10,1],[7181,13,7181,57,1],[7182,13,7182,50,1],[7184,13,7184,28,1],[7185,17,7185,31,1],[7187,17,7187,32,1],[7188,9,7188,10,1],[7191,9,7191,10,0],[7192,13,7192,68,0],[7193,13,7193,48,0],[7194,13,7194,69,0],[7196,13,7196,41,0],[7197,13,7197,31,0],[7198,9,7198,10,0],[7201,9,7201,10,1],[7202,13,7202,61,1],[7203,13,7203,36,1],[7204,9,7204,10,1],[7207,9,7207,10,0],[7208,13,7208,60,0],[7209,13,7209,53,0],[7210,13,7210,50,0],[7211,13,7212,22,0],[7212,22,7212,23,0],[7212,23,7212,24,0],[7212,24,7212,68,0],[7212,68,7212,69,0],[7212,69,7212,70,0],[7212,70,7212,72,0],[7211,13,7212,72,0],[7213,13,7213,58,0],[7214,13,7214,35,0],[7215,9,7215,10,0],[7218,9,7218,10,0],[7219,13,7219,65,0],[7220,13,7220,50,0],[7221,13,7221,20,0],[7221,22,7221,39,0],[7221,40,7221,42,0],[7221,43,7221,53,0],[7222,17,7222,39,0],[7223,21,7223,60,0],[7224,13,7224,58,0],[7225,13,7225,35,0],[7226,9,7226,10,0],[7229,9,7229,10,1],[7230,13,7230,23,1],[7231,9,7231,10,1],[7234,9,7234,10,1],[7238,13,7238,33,1],[7239,13,7239,14,0],[7240,17,7240,63,0],[7242,17,7242,145,0],[7243,17,7243,18,0],[7245,21,7245,76,0],[7246,25,7246,85,0],[7248,25,7248,41,0],[7251,21,7251,37,0],[7254,13,7254,14,1],[7255,17,7255,49,1],[7256,17,7256,107,1],[7257,21,7257,56,1],[7259,17,7259,18,1],[7260,21,7260,149,1],[7261,21,7261,22,0],[7263,25,7263,80,0],[7264,29,7264,89,0],[7266,29,7266,61,0],[7269,25,7269,57,1],[7272,9,7272,10,1],[7275,9,7275,10,0],[7276,13,7276,71,0],[7277,13,7277,44,0],[7278,13,7278,70,0],[7280,13,7280,96,0],[7282,13,7283,92,0],[7285,13,7285,122,0],[7287,13,7287,56,0],[7288,13,7288,78,0],[7289,13,7289,83,0],[7291,13,7291,56,0],[7292,13,7292,14,0],[7293,17,7293,58,0],[7294,13,7294,14,0],[7296,13,7297,43,0],[7298,13,7298,39,0],[7299,9,7299,10,0],[7302,9,7302,10,1],[7303,13,7303,58,1],[7304,13,7304,82,1],[7305,13,7305,14,1],[7306,17,7306,55,1],[7309,13,7309,14,1],[7310,17,7310,45,1],[7311,17,7311,63,1],[7312,17,7312,54,1],[7313,17,7313,34,1],[7314,17,7314,49,1],[7315,21,7315,60,0],[7316,17,7316,30,1],[7318,9,7318,10,1],[7321,9,7321,10,1],[7322,13,7322,44,1],[7323,13,7323,98,1],[7325,13,7325,64,1],[7326,13,7326,64,1],[7327,13,7327,43,1],[7328,13,7328,32,1],[7329,17,7329,117,1],[7331,17,7331,101,1],[7332,13,7332,59,1],[7333,13,7333,50,1],[7334,13,7334,32,1],[7335,13,7335,28,1],[7336,9,7336,10,1],[7339,9,7339,10,1],[7340,13,7340,40,1],[7341,13,7341,31,1],[7342,13,7342,31,1],[7343,17,7343,118,0],[7346,17,7346,106,1],[7348,13,7348,54,1],[7349,13,7349,14,1],[7350,17,7350,82,1],[7351,17,7351,41,1],[7352,13,7352,14,1],[7354,13,7354,80,1],[7355,13,7355,35,1],[7356,13,7356,52,1],[7357,17,7357,65,1],[7359,13,7359,29,1],[7360,9,7360,10,1],[7363,9,7363,10,0],[7364,13,7364,53,0],[7365,13,7365,75,0],[7367,13,7367,39,0],[7368,17,7368,89,0],[7370,13,7370,36,0],[7372,13,7372,40,0],[7373,13,7373,14,0],[7374,17,7374,46,0],[7375,17,7375,130,0],[7376,17,7376,18,0],[7377,21,7377,46,0],[7378,25,7378,77,0],[7379,17,7379,18,0],[7381,17,7381,113,0],[7382,17,7382,18,0],[7383,21,7383,144,0],[7384,21,7384,22,0],[7385,25,7385,50,0],[7386,29,7386,81,0],[7387,21,7387,22,0],[7388,17,7388,18,0],[7390,13,7390,14,0],[7392,13,7392,48,0],[7393,17,7393,39,0],[7395,13,7395,29,0],[7396,9,7396,10,0],[7399,9,7399,10,1],[7400,13,7400,117,1],[7401,13,7401,118,1],[7402,13,7402,119,1],[7403,13,7403,119,1],[7404,13,7404,102,1],[7405,13,7405,108,1],[7406,13,7406,108,1],[7407,13,7407,112,1],[7408,13,7408,110,1],[7409,13,7409,118,1],[7410,13,7410,133,1],[7412,13,7412,124,1],[7413,13,7413,112,1],[7414,13,7414,116,1],[7415,13,7415,102,1],[7416,13,7416,108,1],[7417,13,7417,118,1],[7418,13,7418,120,1],[7419,13,7419,107,1],[7420,13,7420,120,1],[7421,13,7421,128,1],[7422,13,7422,101,1],[7423,13,7423,106,1],[7424,13,7424,114,1],[7425,13,7425,117,1],[7426,13,7426,119,1],[7427,13,7427,117,1],[7428,9,7428,10,1],[7437,9,7437,10,1],[7438,13,7438,125,1],[7439,13,7439,123,1],[7440,13,7440,131,1],[7441,13,7441,123,1],[7443,13,7443,63,1],[7444,13,7444,62,1],[7445,13,7445,60,1],[7446,9,7446,10,1],[7453,9,7453,10,1],[7454,13,7454,78,1],[7455,13,7455,79,1],[7456,13,7456,80,1],[7457,13,7457,80,1],[7458,13,7458,73,1],[7459,13,7459,79,1],[7460,13,7460,79,1],[7461,13,7461,78,1],[7462,13,7462,81,1],[7463,13,7463,96,1],[7464,13,7464,116,1],[7465,13,7465,99,1],[7466,13,7466,81,1],[7467,13,7467,83,1],[7468,13,7468,76,1],[7469,13,7469,79,1],[7470,13,7470,84,1],[7471,13,7471,85,1],[7472,13,7472,86,1],[7473,13,7473,85,1],[7474,13,7474,99,1],[7475,13,7475,79,1],[7476,13,7476,88,1],[7477,13,7477,96,1],[7478,13,7478,94,1],[7479,9,7479,10,1],[7482,9,7482,10,0],[7483,13,7483,46,0],[7485,13,7485,67,0],[7487,13,7487,50,0],[7487,50,7487,70,0],[7487,70,7487,94,0],[7487,13,7487,94,0],[7489,13,7489,52,0],[7489,52,7489,74,0],[7489,74,7489,98,0],[7489,13,7489,98,0],[7491,13,7491,81,0],[7493,13,7494,95,0],[7496,13,7496,87,0],[7498,13,7498,20,0],[7498,22,7498,30,0],[7498,31,7498,33,0],[7498,34,7498,49,0],[7499,13,7499,14,0],[7500,17,7500,55,0],[7501,21,7501,63,0],[7502,13,7502,14,0],[7503,13,7503,80,0],[7504,9,7504,10,0],[7507,9,7507,10,0],[7508,9,7508,10,0],[7511,9,7511,10,0],[7512,13,7512,71,0],[7513,17,7513,80,0],[7514,9,7514,10,0],[7517,9,7517,10,0],[7518,13,7518,31,0],[7519,17,7519,91,0],[7520,9,7520,10,0],[7523,9,7523,10,1],[7524,13,7524,31,1],[7525,17,7525,82,1],[7526,9,7526,10,1],[7529,9,7529,10,0],[7530,13,7530,86,0],[7531,17,7531,102,0],[7532,9,7532,10,0],[7535,9,7535,10,1],[7536,13,7536,31,1],[7537,17,7537,79,1],[7538,9,7538,10,1],[7540,9,7540,10,0],[7541,13,7541,31,0],[7542,17,7542,87,0],[7543,9,7543,10,0],[7546,9,7546,10,0],[7547,13,7547,31,0],[7548,17,7548,104,0],[7549,9,7549,10,0],[7552,9,7552,10,0],[7553,13,7553,31,0],[7554,13,7554,14,0],[7555,17,7555,111,0],[7556,13,7556,14,0],[7557,9,7557,10,0],[7560,9,7560,10,0],[7561,13,7561,31,0],[7562,17,7562,95,0],[7563,9,7563,10,0],[7566,9,7566,10,1],[7567,13,7567,31,1],[7568,13,7568,14,1],[7569,17,7569,24,1],[7569,26,7569,37,1],[7569,38,7569,40,1],[7569,41,7569,91,1],[7570,17,7570,18,1],[7571,21,7571,41,1],[7572,21,7572,102,1],[7573,25,7573,44,1],[7574,17,7574,18,1],[7575,13,7575,14,1],[7576,9,7576,10,1],[7579,9,7579,10,0],[7580,13,7580,47,0],[7581,13,7581,20,0],[7581,22,7581,32,0],[7581,33,7581,35,0],[7581,36,7581,53,0],[7582,17,7582,52,0],[7583,13,7583,52,0],[7585,13,7586,55,0],[7587,13,7587,58,0],[7590,13,7592,32,0],[7594,13,7594,20,0],[7594,22,7594,32,0],[7594,33,7594,35,0],[7594,36,7594,53,0],[7595,13,7595,14,0],[7596,17,7596,109,0],[7597,17,7597,46,0],[7598,17,7598,18,0],[7599,21,7599,66,0],[7600,25,7600,63,0],[7601,17,7601,18,0],[7602,13,7602,14,0],[7603,9,7603,10,0],[7607,9,7607,10,0],[7609,9,7609,10,0],[7612,9,7612,10,0],[7613,13,7613,83,0],[7614,17,7614,99,0],[7615,9,7615,10,0],[7622,9,7622,10,1],[7623,13,7623,42,1],[7624,13,7625,45,1],[7626,13,7626,14,0],[7627,17,7627,58,0],[7628,17,7628,18,0],[7629,13,7629,14,0],[7630,9,7630,10,1],[7633,9,7633,10,1],[7634,13,7634,47,1],[7635,13,7635,53,1],[7636,13,7636,14,1],[7637,17,7637,68,1],[7638,17,7638,31,1],[7639,21,7639,78,1],[7640,13,7640,14,1],[7641,9,7641,10,1],[7663,9,7663,44,0],[7663,9,7663,44,1],[7665,9,7665,24,1],[7666,9,7666,10,1],[7667,9,7667,10,1],[7669,9,7669,49,0],[7670,9,7670,10,0],[7671,13,7671,30,0],[7672,13,7672,32,0],[7673,9,7673,10,0],[7680,9,7680,45,0],[7686,9,7686,26,0],[7687,9,7687,10,0],[7688,13,7688,40,0],[7689,13,7689,39,0],[7690,9,7690,10,0],[7701,9,7701,49,0],[7702,9,7702,10,0],[7703,13,7703,30,0],[7704,13,7704,32,0],[7705,9,7705,10,0],[7729,9,7729,75,0],[7730,9,7730,10,0],[7731,13,7731,29,0],[7732,13,7732,24,0],[7733,13,7733,22,0],[7734,9,7734,10,0],[7738,9,7738,10,0],[7740,13,7740,29,0],[7741,13,7741,14,0],[7742,17,7742,44,0],[7743,17,7743,58,0],[7744,17,7744,76,0],[7745,17,7745,122,0],[7746,17,7746,51,0],[7747,21,7747,75,0],[7748,17,7748,82,0],[7749,17,7749,51,0],[7750,13,7750,14,0],[7752,18,7752,34,0],[7753,13,7753,14,0],[7754,17,7754,46,0],[7755,17,7755,56,0],[7756,17,7756,50,0],[7757,13,7757,14,0],[7760,13,7760,14,0],[7761,17,7761,49,0],[7762,17,7762,56,0],[7763,17,7763,80,0],[7764,17,7764,50,0],[7765,13,7765,14,0],[7766,9,7766,10,0],[7769,9,7769,10,0],[7770,13,7770,44,0],[7771,13,7771,64,0],[7773,13,7773,104,0],[7774,13,7774,14,0],[7775,17,7777,80,0],[7778,13,7778,14,0],[7779,9,7779,10,0],[7783,9,7783,10,0],[7784,13,7784,55,0],[7785,13,7785,70,0],[7786,13,7786,57,0],[7787,13,7790,25,0],[7790,25,7790,104,0],[7790,104,7790,106,0],[7787,13,7790,106,0],[7791,13,7791,38,0],[7792,13,7792,14,0],[7793,17,7793,47,0],[7794,13,7794,14,0],[7796,13,7796,14,0],[7797,17,7797,80,0],[7798,13,7798,14,0],[7799,9,7799,10,0]]);
    </script>
  </body>
</html>