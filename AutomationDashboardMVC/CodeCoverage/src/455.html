<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Estimator\UI\NewBid.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.IO;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.EstimatorBL;
using Aurigo.AMP3.EstimatorDTO;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using System;
using System.Collections.Generic;
using Aurigo.AMP3.LibraryBL;
using System.Text;
using System.Runtime.Serialization.Json;
using Aurigo.AMP3.ContmgtDTO;
using System.Data;
using System.IO;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.Brix.Construction.Estimator.UI;
using System.Web.Script.Serialization;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.AMP3.Resources.TerminologyResources;

namespace Aurigo.AMP3.EstimatorUI
{
    public partial class NewBid : BrixPageBase
    {
        private static DataTable dtMap;
        protected ModalPopupExtender PopupExtender;
        private EstimateBid dtoObj = new EstimateBid();
        private string mappedCompany;
        private int projectID;
        protected global::Infragistics.WebUI.UltraWebGrid.UltraWebGrid scGrid;
        protected global::Infragistics.WebUI.UltraWebGrid.UltraWebGrid gridContractors;
        protected global::Aurigo.Brix.Platform.BusinessLayer.UserControls.PickerGrid pickerBidItem;

        private int ProjectEstimateID
        {
            get { return Request[&quot;ProjectEstimateID&quot;].ToInt32_2(); }
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += new EventHandler(btnOk_Click);
                    lnkSave.OnClientClick = &quot;return validate();&quot;;
                }
            }
            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += new EventHandler(btnCancel_Click);
            base.CustomizeToolBar();
        }

        protected override void OnPreInit(EventArgs e)
        {
            if (AMP3ApplicationSettings.Instance.IsContractorBidderUser)
                ModuleId = &quot;CONTBID&quot;;
            base.OnPreInit(e);
        }

        protected override void OnInit(EventArgs e)
        {
            if (!AMP3ApplicationSettings.Instance.IsContractorBidderUser &amp;&amp; !string.IsNullOrEmpty(Request.QueryString[&quot;mode&quot;]))
            {
                if (Request.QueryString[&quot;Mode&quot;].Equals(&quot;EDIT&quot;, StringComparison.CurrentCultureIgnoreCase))
                    PermissionsToCheck.Add(Constants.MODFEAT_EDIT);
                else if (Request.QueryString[&quot;Mode&quot;].Equals(&quot;View&quot;, StringComparison.CurrentCultureIgnoreCase))
                    PermissionsToCheck.Add(Constants.MODFEAT_VIEW);
            }

            ShowRedirectConfirm = true;
            ((PagerControl)mypager).ItemClicked += HandlePagerEvent;
            mypager.EnableViewState = true;

            //InitializePicker(pickerPrimeContractor, false);
            InitializeBidItemPicker();
            //PopupExtender.AddNewPopup(aspPnlContractor.ClientID, btnContractor.ClientID, btnCncl.ClientID, 500, 600, &quot;Contractors List&quot;);

            var menus = new MenuArray();
            ViewState[&quot;BidID&quot;] = Request.QueryString.Get(&quot;BidID&quot;);
            if (ViewState[&quot;BidID&quot;] != null)
                dtoObj = EstimateManager.Instance.GetContractorDetails(ViewState[&quot;BidID&quot;].ToInt32_2());

            if (dtoObj.Status == 0 &amp;&amp; Mode != &quot;View&quot;)
                AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));
            CreateToolBarMenu(menus, null);

            if (Mode == &quot;View&quot;)
                (attachments as AttachmentsControl).ReadOnly = true;

            base.OnInit(e);
        }

        private void InitializeBidItemPicker()
        {
            pickerBidItem.InitializePicker(&quot;/api/Estimator&quot;, GetPickerColumns(), &quot;ID&quot;);
            pickerBidItem.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            pickerBidItem.EnableMultiSelect = false;
            pickerBidItem.Title = &quot;Contractors List&quot;;
            pickerBidItem.AfterPickerSelectScript = &quot;AddSelectedContractor({0})&quot;;
            pickerBidItem.OnGridLoad += new PickerGrid.GridLoad(pickerBidItem_OnGridLoad);
        }

        private void pickerBidItem_OnGridLoad(PickerGrid grid)
        {
            PickerData objPg = new PickerData();
            objPg.pickerType = &quot;Contractors&quot;;
            grid.OptionalParamaters = grid.BuildOptionalParameters(new JavaScriptSerializer().Serialize(objPg));
        }

        private List&lt;PickerColumnDetails&gt; GetPickerColumns()
        {

            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();

            List&lt;string&gt; allColumns = new List&lt;string&gt;() {&quot;RecordID&quot;, &quot;Name&quot;, &quot;Contact&quot;, &quot;ID&quot; ,&quot;PhoneNo&quot;, &quot;FaxNo&quot;, &quot;EmailID&quot;,&quot;Address1&quot;,
            &quot;Address2&quot;, &quot;Address3&quot;,&quot;City&quot;, &quot;State&quot;,&quot;ZipCode&quot;,&quot;RowNum&quot;};

            Dictionary&lt;string, string&gt; visibleColumns = new Dictionary&lt;string, string&gt;();
            visibleColumns.Add(&quot;Name&quot;, &quot;Name&quot;);
            visibleColumns.Add(&quot;Contact&quot;, &quot;Contact&quot;);
            visibleColumns.Add(&quot;ID&quot;, &quot;Contractor ID&quot;);
            visibleColumns.Add(&quot;PhoneNo&quot;, &quot;Phone&quot;);
            visibleColumns.Add(&quot;Address1&quot;, &quot;Address 1&quot;);
            visibleColumns.Add(&quot;Address2&quot;, &quot;Address 2&quot;);
            visibleColumns.Add(&quot;Address3&quot;, &quot;Address 3&quot;);
            visibleColumns.Add(&quot;City&quot;, &quot;City&quot;);
            visibleColumns.Add(&quot;State&quot;, &quot;State&quot;);
            visibleColumns.Add(&quot;ZipCode&quot;, &quot;ZipCode&quot;);
            visibleColumns.Add(&quot;FaxNo&quot;, &quot;Fax&quot;);
            visibleColumns.Add(&quot;EmailID&quot;, &quot;Email&quot;);

            foreach (string col in allColumns)
            {
                if (!visibleColumns.ContainsKey(col))
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = col, ColumnName = col, Hidden = true };
                    gridColumns.Add(tCol);
                }
                else
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = visibleColumns[col], ColumnName = col, Hidden = false, Width = 200, Type = &quot;string&quot; };
                    gridColumns.Add(tCol);
                }
            }

            return gridColumns;
        }

        public void HandlePagerEvent(object sender, ItemClickEventArgs e)
        {
            BindGridControl();
            gridContractors.DisplayLayout.Pager.CurrentPageIndex = 1;
        }

        private string Mode
        {
            get
            {
                return Request.QueryString[&quot;Mode&quot;] ?? &quot;New&quot;;
            }
        }
        public Boolean IsNotDraft(int instanceID, int parentID)
        {
            if (instanceID &gt; 0)
            {
                string status = EstimateManager.Instance.GetWorkFlowStatus(instanceID, parentID);
                if (status != &quot;Draft&quot;)
                {
                    return true;
                }
            }
            return false;
        }
        protected override void OnPreRender(EventArgs e)
        {
            if (IsNotDraft(Convert.ToInt32(Request[&quot;BidId&quot;]), Convert.ToInt32(Request[&quot;ParentID&quot;])) &amp;&amp; MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
            {
                MainToolBar.HideMenu(&quot;lnkSave&quot;);
            }
            base.OnPreRender(e);
        }
        protected void Page_Load(object sender, EventArgs e)
        {
            try
            {
                // Resetting the filter when the Reset All button is clicked.
                btnReset.Attributes.Add(&quot;onClick&quot;,
                                        &quot;document.getElementById(&#39;&quot; + btnStdCncl.ClientID +
                                        &quot;&#39;).click();return resetFilters();&quot;);

                // Setting the localized strings
                SetLocalizedStrings();

                // Disabling the role combo box
                UIHelper.DisableRoleSelection(Page);

                // Getting the projectID from the querystring
                if (String.IsNullOrEmpty(Request.QueryString.Get(EstimatorConstants.PID)) ||
                    !int.TryParse(Request.QueryString.Get(EstimatorConstants.PID), out projectID))
                {
                    UIHelper.RedirectURL(&quot;Error loading the requested page.&quot;, ResolveUrl(Constants.URL_PROJECTS), null,
                                         Context);
                }

                if (!Page.IsPostBack)
                {
                    PageTitle = &quot;Create New Bid&quot;;

                    BindGridControl();

                    btnOk.Enabled = !(EstimateManager.Instance.GetBidAwardStatus(ProjectEstimateID) == EstimatorConstants.AWARDED);


                    Form.DefaultButton = btnOk.UniqueID;

                    DataSet dsState = new BrixDataSet();

                    gridContractors.DisplayLayout.Pager.PagerStyle.CustomRules = EstimatorConstants.HTML_DISPLAY_NONE;

                    var li = new ListItem(EstimatorConstants.SELECT_ONE, EstimatorConstants.SELECT_ONE);
                    li.Selected = true;

                    txtContractorID.Focus();

                    if (ViewState[&quot;BidID&quot;] != null)
                    {
                        PageTabBar.Tabs.Add(new Tab(LocalizationManager.GetString(&quot;Bid Items&quot;), string.Format(&quot;~/Modules/ESTMATE/ViewBidDetails.aspx?Mode={0}&amp;BidId={1}&amp;PID={2}&amp;ProjectEstimateID={3}&amp;ParentID={3}&amp;Context=ESTMATE&quot;, Mode, ViewState[&quot;BidID&quot;], projectID, ProjectEstimateID)));
                        PageTabBar.Tabs.Add(new Tab(LocalizationManager.GetString(&quot;Bid Information&quot;), string.Format(&quot;~/Modules/ESTMATE/BidInformation.aspx?BidID={0}&amp;PID={1}&amp;ProjectEstimateID={2}&amp;ParentID={2}&amp;Mode={3}&amp;Context=ESTMATE&quot;, ViewState[&quot;BidID&quot;], projectID, ProjectEstimateID, Mode)));
                        PageTabBar.Tabs.Add(new Tab(LocalizationManager.GetString(&quot;Bidder Information&quot;), &quot;#&quot;, true));

                        if (dtoObj == null)
                        {
                            ShowNotificationMessage(&quot;The record you are trying to edit does not exist in the system.&quot;, NotificationType.Error);
                            return;
                        }


                        MakeReadOnly(true);

                        lblEstimateId.Text = dtoObj.EstimateID;
                        txtAddress1.Text = dtoObj.Address1;
                        txtAddress2.Text = dtoObj.Address2;
                        txtAddress3.Text = dtoObj.Address3;
                        txtCity.Text = dtoObj.City;
                        txtContName.Text = dtoObj.ContractorName;
                        txtContractorID.Text = dtoObj.ContractorID;
                        txtEmail.Text = dtoObj.Email;
                        txtFax.Text = dtoObj.Fax;
                        txtZip.Text = dtoObj.Zip;
                        wneFaxExtn.Value = dtoObj.FaxExtn;
                        wneTelExtn.Value = dtoObj.TelephoneExtn;
                        txtTel.Text = dtoObj.Telephone;
                        txtState.Text = dtoObj.State;
                        txtRemarks.Text = dtoObj.Remarks;
                        //lblHeading.Text =
                        //    UIHelper.GetMessageById(EstimatorConstants.EDIT_CONTRACTOR,
                        //                            EstimatorConstants.EST_ERR_FILENAME)[3].ToString2();
                        btnOk.Text = &quot;Update&quot;;
                        (attachments as AttachmentsControl).InstanceID = ViewState[&quot;BidID&quot;].ToString2();
                        (attachments as AttachmentsControl).SrcType = &quot;ESTMBID&quot;;
                        LinksUserControl.SetInstanceAndType(ViewState[&quot;BidID&quot;].ToString2(), &quot;ESTMBID&quot;);
                    }
                    else
                    {
                        if (ProjectEstimateID &gt; 0)
                        {
                            EstimatorDTO.Estimator dtoobjEst = EstimateManager.Instance.GetEstimateDetails(ProjectEstimateID);
                            lblEstimateId.Text = dtoobjEst.EstimateId;
                        }
                    }

                    if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
                    {
                        txtContractorID.ReadOnly = txtAddress1.ReadOnly = txtAddress2.ReadOnly =
                                                                          txtAddress3.ReadOnly =
                                                                          txtCity.ReadOnly =
                                                                          txtContName.ReadOnly = txtEmail.ReadOnly =
                                                                                                 txtFax.ReadOnly =
                                                                                                 txtZip.ReadOnly =
                                                                                                 txtTel.ReadOnly =
                                                                                                 txtState.ReadOnly =
                                                                                                 wneTelExtn.Disabled =
                                                                                                 wneFaxExtn.Disabled =
                                                                                                 wneTelExtn.
                                                                                                     EnableViewState =
                                                                                                 txtContractorID.
                                                                                                     EnableViewState =
                                                                                                 wneFaxExtn.
                                                                                                     EnableViewState =
                                                                                                 true;
                    }
                }

                if (Mode == &quot;Edit&quot; || Mode == &quot;View&quot;)
                {
                    txtContractorID.ReadOnly = true;
                    btnContractor.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    txtContName.ReadOnly = true;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, EstimatorConstants.ESTIMATOR);
            }
        }

        private void SetLocalizedStrings()
        {
            tdZip.InnerText = &quot;ZipCode :&quot;;
        }

        protected void loadContractors()
        {
            DataSet ds = new BrixDataSet();
            try
            {

                Stream str =
                    EstimateManager.GetIOStream(EstimateManager.Instance.GetLibraryCatalogs(EstimatorConstants.ESTMATE_CONTRACTOR));

                if (str.Length &gt; 0)
                    ds.ReadXml(str);
                // Binding data to the grid only if contractors exists.
                if (ds.Tables.Count &gt; 0)
                {
                    gridContractors.DataSource = ds;
                    gridContractors.DataBind();

                    ViewState[&quot;Contractors&quot;] = ds;

                    ColumnsCollection cols = gridContractors.Columns;

                    if (cols.Exists(&quot;Name&quot;))
                        cols.FromKey(&quot;Name&quot;).Header.Caption = &quot;Contractor Name&quot;;
                    if (cols.Exists(&quot;Code&quot;))
                        cols.FromKey(&quot;Code&quot;).Header.Caption = &quot;Contractor ID&quot;;
                    if (cols.Exists(&quot;RecordID&quot;))
                        cols.FromKey(&quot;RecordID&quot;).Hidden = true;
                    if (cols.Exists(&quot;PhoneNo&quot;))
                        cols.FromKey(&quot;PhoneNo&quot;).Header.Caption = &quot;Phone Number&quot;;
                    if (cols.Exists(&quot;FaxNo&quot;))
                        cols.FromKey(&quot;FaxNo&quot;).Header.Caption = &quot;Fax Number&quot;;
                    if (cols.Exists(&quot;FaxNo&quot;))
                        cols.FromKey(&quot;FaxNo&quot;).Header.Caption = &quot;Fax Number&quot;;
                    if (cols.Exists(&quot;EmailID&quot;))
                        cols.FromKey(&quot;EmailID&quot;).Header.Caption = &quot;Email ID&quot;;
                    if (cols.Exists(&quot;Id&quot;))
                        cols.FromKey(&quot;Id&quot;).Header.Caption = &quot;Contractor ID&quot;;

                    if (cols.Exists(&quot;Name&quot;))
                        cols.FromKey(&quot;Name&quot;).Width = Unit.Pixel(150);
                    if (cols.Exists(&quot;Address1&quot;))
                        cols.FromKey(&quot;Address1&quot;).Width = Unit.Pixel(150);
                    if (cols.Exists(&quot;Address2&quot;))
                        cols.FromKey(&quot;Address2&quot;).Width = Unit.Pixel(150);
                    if (cols.Exists(&quot;Address3&quot;))
                        cols.FromKey(&quot;Address3&quot;).Width = Unit.Pixel(150);
                    if (cols.Exists(&quot;PhoneNo&quot;))
                        cols.FromKey(&quot;PhoneNo&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;FaxNo&quot;))
                        cols.FromKey(&quot;FaxNo&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;EmailID&quot;))
                        cols.FromKey(&quot;EmailID&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;Contact&quot;))
                        cols.FromKey(&quot;Contact&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;Id&quot;))
                        cols.FromKey(&quot;Id&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;City&quot;))
                        cols.FromKey(&quot;City&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;State&quot;))
                        cols.FromKey(&quot;State&quot;).Width = Unit.Pixel(100);
                    if (cols.Exists(&quot;ZipCode&quot;))
                    {
                        cols.FromKey(&quot;ZipCode&quot;).Width = Unit.Pixel(100);
                        cols.FromKey(&quot;ZipCode&quot;).Header.Caption = &quot;ZipCode&quot;;
                    }
                    ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value = &quot;1&quot;;
                    ((HtmlInputHidden)mypager.FindControl(&quot;pageCount&quot;)).Value =
                        gridContractors.DisplayLayout.Pager.PageCount.ToString2();

                    foreach (UltraGridColumn col in cols)
                    {
                        col.HTMLEncodeContent = true;
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, EstimatorConstants.ESTIMATOR);
            }
        }

        protected void btnOk_Click(object sender, EventArgs e)
        {
            int returnValue;
            try
            {
                dtoObj.ContractorID = Request.Form[txtContractorID.UniqueID] != null
                                          ? Request.Form[txtContractorID.UniqueID].ToString2()
                                          : String.Empty; // hdnContractorID.Value;// txtContractorID.Text.Trim();
                dtoObj.ContractorName = Request.Form[txtContName.UniqueID] != null
                                            ? Request.Form[txtContName.UniqueID].ToString2()
                                            : String.Empty; //hdnContName.Value; // txtContName.Text.Trim();
                dtoObj.Address1 = Request.Form[txtAddress1.UniqueID] != null
                                      ? Request.Form[txtAddress1.UniqueID].ToString2()
                                      : String.Empty; //hdnAddress1.Value; // txtAddress1.Text;
                dtoObj.Address2 = Request.Form[txtAddress2.UniqueID] != null
                                      ? Request.Form[txtAddress2.UniqueID].ToString2()
                                      : String.Empty; //hdnAddress2.Value; // txtAddress2.Text;
                dtoObj.Address3 = Request.Form[txtAddress3.UniqueID].ToString2();
                //hdnAddress3.Value; // txtAddress3.Text;
                dtoObj.City = Request.Form[txtCity.UniqueID] != null
                                  ? Request.Form[txtCity.UniqueID].ToString2()
                                  : String.Empty; //hdnCity.Value; //  txtCity.Text;
                dtoObj.State = Request.Form[txtState.UniqueID].ToString2(); //hdnState.Value; // txtState.Text;
                dtoObj.Zip = Request.Form[txtZip.UniqueID] != null
                                 ? Request.Form[txtZip.UniqueID].ToString2()
                                 : String.Empty; //hdnZip.Value;// txtZip.Text;
                dtoObj.Telephone = Request.Form[txtTel.UniqueID] != null
                                       ? Request.Form[txtTel.UniqueID].ToString2()
                                       : String.Empty; //hdnTel.Value; //  txtTel.Text;
                dtoObj.TelephoneExtn = Request.Form[wneTelExtn.UniqueID] != null
                                           ? Request.Form[wneTelExtn.UniqueID].ToString2()
                                           : String.Empty; //wneTelExtn.Value;
                dtoObj.Fax = Request.Form[txtFax.UniqueID] != null
                                 ? Request.Form[txtFax.UniqueID].ToString2()
                                 : String.Empty; //hdnFax.Value; // txtFax.Text;
                dtoObj.FaxExtn = Request.Form[wneFaxExtn.UniqueID] != null
                                     ? Request.Form[wneFaxExtn.UniqueID].ToString2()
                                     : String.Empty; //wneFaxExtn.Value;
                dtoObj.Email = Request.Form[txtEmail.UniqueID] != null
                                   ? Request.Form[txtEmail.UniqueID].ToString2()
                                   : String.Empty; //hdnEmail.Value; // txtEmail.Text;
                dtoObj.Remarks = Request.Form[txtRemarks.UniqueID] != null
                                                  ? Request.Form[txtRemarks.UniqueID].ToString2() : String.Empty;

                if (ViewState[&quot;BidID&quot;] == null)
                {
                    if (ProjectEstimateID &gt; 0)
                        dtoObj.ProjectEstimateID = ProjectEstimateID;
                    returnValue = EstimateManager.Instance.AddBidInfo(dtoObj);
                    if (returnValue == 3)
                    {
                        String errMsg =
                            UIHelper.GetMessageById(EstimatorConstants.CONT_EXISTS, EstimatorConstants.EST_ERR_FILENAME)
                                [3].ToString2();
                        ShowNotificationMessage(errMsg, NotificationType.Error);
                        return;
                    }
                    else if (returnValue == 2)
                    {
                        int bidid = EstimateManager.Instance.GetBidId(Request.Form[txtContractorID.UniqueID].ToString2(),
                                                        Request.Form[txtContName.UniqueID].ToString2(),
                                                        ProjectEstimateID);
                        SaveAttachments(bidid, ProjectEstimateID);
                        Response.Redirect(
                            string.Format(
                                &quot;ViewBidDetails.aspx?Mode=Edit&amp;Type=New&amp;{0}={1}&amp;ProjectEstimateID={2}&amp;ParentID={2}&amp;BidID={3}&amp;Context=ESTMATE&quot;,
                                EstimatorConstants.PID, projectID, ProjectEstimateID, bidid), true);
                    }
                }
                else
                {
                    string sql = @&quot;if exists (select * from ESTMATEBidInformation where id={0})
                      update ESTMATEBidInformation set Remarks = {1} where id={0} 
                  else 
                      insert into ESTMATEBidInformation (ID, PID, ParentID, Remarks, AUR_ModifiedBy, AUR_ModifiedOn)
                      values ({0}, {2}, {3}, {1}, {4}, {5})&quot;;

                    try
                    {
                        ComponentHelper.Instance.ExecuteNonQuery(sql, ViewState[&quot;BidID&quot;].ToInt32_2(), txtRemarks.Text.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;), projectID, ProjectEstimateID, UserDetail.GetCurrentUserDetail().GetUserName(), DateTime.Now.ToMWUtcDateTime());
                    }
                    catch (Exception ex)
                    {
                        Logger.Log(Enumerations.LogType.Error, ex.Message, EstimatorConstants.ESTIMATOR);
                    }
                    dtoObj.BidID = ViewState[&quot;BidID&quot;].ToInt32_2();
                    //ViewState.Remove(&quot;BidID&quot;);
                    int rtnValue = EstimateManager.Instance.UpdateContractorDetails(dtoObj);
                    if (rtnValue == 0)
                    {
                        SaveAttachments(dtoObj.BidID, ProjectEstimateID);
                        //Response.Redirect(string.Format(&quot;ViewAllBids.aspx?{0}={1}&amp;ProjectEstimateID={2}&amp;Context=ESTMATE&quot;, EstimatorConstants.PID, projectID, ProjectEstimateID), true);
                        Response.Redirect(string.Format(&quot;~/Common/BrixListPage.aspx?Context=ESTMBID&amp;{0}={1}&amp;ProjectEstimateID={2}&amp;ParentID={2}&quot;, EstimatorConstants.PID, projectID, ProjectEstimateID), true);
                    }
                    else if (rtnValue == 3)
                    {
                        ShowNotificationMessage(&quot;Contractor ID already exists.&quot;, NotificationType.Error);
                        return;
                    }
                    else
                    {
                        ShowNotificationMessage(&quot;Error updating contractor details.&quot;, NotificationType.Error);
                        return;
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, EstimatorConstants.ESTIMATOR);
            }
        }

        private bool SaveAttachments(int bidID, int estimateID)
        {
            ((AttachmentsControl)attachments).ParentInstanceID = estimateID;
            ((AttachmentsControl)attachments).ParentModuleID = Constants.MODID_ESTMATE;
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            return ((AttachmentsControl)attachments).SaveAttachments(bidID.ToString2(), &quot;ESTMBID&quot;, ud.UID, ud.UserName, LocalizationManager.GetString(&quot;Bidding Attachments&quot;));
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Response.Redirect(string.Format(&quot;~/Common/BrixListPage.aspx?Context=ESTMBID&amp;{0}={1}&amp;ProjectEstimateID={2}&amp;ParentID={2}&quot;, EstimatorConstants.PID, projectID, ProjectEstimateID), true);
            //Response.Redirect(string.Format(&quot;ViewAllBids.aspx?{0}={1}&amp;ProjectEstimateID={2}&amp;Context=ESTMATE&quot;, EstimatorConstants.PID, projectID, ProjectEstimateID), true);
        }

        protected void btnContractor_Click(object sender, EventArgs e)
        {
            loadContractors();
        }

        #region ODS implementation

        public void G1_SortColumn(object sender, SortColumnEventArgs e)
        {
            if (e.ColumnNo == 0)
                return;
            string sortKey = gridContractors.Bands[0].Columns[e.ColumnNo].Key;
            foreach (UltraGridColumn uwgcol in gridContractors.DisplayLayout.Bands[0].Columns)
            {
                if (uwgcol.SortIndicator != SortIndicator.None)
                    uwgcol.SortIndicator = SortIndicator.None;
            }
            if (ViewState[Constants.ODS_SORTORDER] != null &amp;&amp;
                ViewState[Constants.ODS_SORTORDER].ToString2().EndsWith2(&quot;ASC&quot;)
                &amp;&amp;
                ViewState[Constants.ODS_SORTORDER].ToString2().StartsWith(sortKey,
                                                                          StringComparison.CurrentCultureIgnoreCase))
            {
                ViewState[Constants.ODS_SORTORDER] = sortKey + &quot; DESC&quot;;
                gridContractors.Bands[0].Columns[e.ColumnNo].SortIndicator = SortIndicator.Descending;
            }
            else
            {
                ViewState[Constants.ODS_SORTORDER] = sortKey + &quot; ASC&quot;;
                gridContractors.Bands[0].Columns[e.ColumnNo].SortIndicator = SortIndicator.Ascending;
            }
            BindGridControl();
        }

        protected void btnFilterGhost_Click(object sender, EventArgs e)
        {
            ApplyFilter();
        }

        protected void ApplyFilter()
        {
            ViewState[Constants.ODS_FILTER] = UIHelper.GenerateFilterXML(aspPnlFilter);
            BindGridControl();
        }

        private int GetPageCount()
        {
            double rCnt;
            string currentPage;
            string pageCount;

            if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            {
                if (dtMap == null)
                {
                    dtMap = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(Request[&quot;PID&quot;], AMP3Object.PROJECT,
                                                                                     null, AMP3Object.UNKNOWN,
                                                                                     RegisteredEIS.AX);
                }
                if (dtMap.Rows.Count &gt; 0)
                    mappedCompany = dtMap.Rows[0][&quot;ERPCompany&quot;].ToString2();
                else
                    mappedCompany = Session[Constants.EIS_ADDITIONAL_INFO].ToString2();
            }

            rCnt = EstimateManager.Instance.GetContractorsCount(mappedCompany,
                                                  (ViewState[Constants.ODS_FILTER] == null
                                                       ? null
                                                       : ViewState[Constants.ODS_FILTER].ToString2()));

            currentPage = (mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value;
            if (currentPage.ToInt32_2() != 0 &amp;&amp;
                Math.Ceiling(rCnt / gridContractors.DisplayLayout.Pager.PageSize) &gt;= currentPage.ToInt32_2())
                (mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value =
                    currentPage = currentPage.ToInt32_2() &gt; 0 ? currentPage : &quot;0&quot;;
            else
                (mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value = currentPage = rCnt &gt; 0 ? &quot;1&quot; : &quot;0&quot;;

            (mypager.FindControl(&quot;pageCount&quot;) as HtmlInputHidden).Value = pageCount =
                                                                          rCnt &gt;
                                                                          gridContractors.DisplayLayout.Pager.PageSize
                                                                              ? Math.Ceiling(rCnt /
                                                                                             gridContractors.
                                                                                                 DisplayLayout.Pager.
                                                                                                 PageSize).ToString2()
                                                                              : rCnt &gt; 0 ? &quot;1&quot; : &quot;0&quot;;

            (mypager as PagerControl).Set_Page(currentPage.ToInt32_2(), pageCount.ToInt32_2());
            return rCnt.ToInt32_2();
        }

        private DataTable BindGridControl()
        {
            DataTable ContractorDT;
            //try
            //{
            int startIdx = (((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value.ToInt32_2() == 0)
                               ? 0
                               : ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value.ToInt32_2() - 1;
            if (startIdx &gt; 1)
            {
                startIdx = 1 + (gridContractors.DisplayLayout.Pager.PageSize * startIdx);
            }

            int recordCnt = GetPageCount();

            if (dtMap != null &amp;&amp; dtMap.Rows.Count &gt; 0)
                mappedCompany = dtMap.Rows[0][&quot;ERPCompany&quot;].ToString2();
            else
                mappedCompany = Session[Constants.EIS_ADDITIONAL_INFO].ToString2();

            ContractorDT = EstimateManager.Instance.GetContractor(mappedCompany, startIdx,
                                                              recordCnt,
                                                              ViewState[Constants.ODS_SORTORDER] == null
                                                                  ? null
                                                                  : ViewState[Constants.ODS_SORTORDER].ToString2(),
                                                              ViewState[Constants.ODS_FILTER] == null
                                                                  ? null
                                                                  : ViewState[Constants.ODS_FILTER].ToString2());

            return ContractorDT;

            #region ColumnSettings
            // {
            //gridContractors.Columns.Clear();
            //gridContractors.DisplayLayout.NoDataMessage = &quot;No Data To Display&quot;;
            ////BrixDatatypeHelper.ToString2(CommonFunctions.GetMessageById(EstimatorConstants.NO_ITEMS, EstimatorConstants.EST_ERR_FILENAME)[3]);
            //}
            //else
            //{
            //    gridContractors.DataSource = ContractorDT;
            //    gridContractors.DataBind();

            //    gridContractors.Columns.FromKey(&quot;RecordID&quot;).Hidden = true;

            //    ColumnsCollection cols = gridContractors.Columns;

            //    if (cols.Exists(&quot;Name&quot;))
            //        cols.FromKey(&quot;Name&quot;).Header.Caption = &quot;Contractor Name&quot;;
            //    if (cols.Exists(&quot;Code&quot;))
            //        cols.FromKey(&quot;Code&quot;).Header.Caption = &quot;Contractor ID&quot;;
            //    if (cols.Exists(&quot;RecordID&quot;))
            //        cols.FromKey(&quot;RecordID&quot;).Hidden = true;
            //    if (cols.Exists(&quot;PhoneNo&quot;))
            //        cols.FromKey(&quot;PhoneNo&quot;).Header.Caption = &quot;Phone Number&quot;;
            //    if (cols.Exists(&quot;FaxNo&quot;))
            //        cols.FromKey(&quot;FaxNo&quot;).Header.Caption = &quot;Fax Number&quot;;
            //    if (cols.Exists(&quot;FaxNo&quot;))
            //        cols.FromKey(&quot;FaxNo&quot;).Header.Caption = &quot;Fax Number&quot;;
            //    if (cols.Exists(&quot;EmailID&quot;))
            //        cols.FromKey(&quot;EmailID&quot;).Header.Caption = &quot;Email ID&quot;;
            //    if (cols.Exists(&quot;Id&quot;))
            //        cols.FromKey(&quot;Id&quot;).Header.Caption = &quot;Contractor ID&quot;;

            //    if (cols.Exists(&quot;Name&quot;))
            //        cols.FromKey(&quot;Name&quot;).Width = Unit.Pixel(150);
            //    if (cols.Exists(&quot;Address1&quot;))
            //        cols.FromKey(&quot;Address1&quot;).Width = Unit.Pixel(150);
            //    if (cols.Exists(&quot;Address2&quot;))
            //        cols.FromKey(&quot;Address2&quot;).Width = Unit.Pixel(150);
            //    if (cols.Exists(&quot;Address3&quot;))
            //        cols.FromKey(&quot;Address3&quot;).Width = Unit.Pixel(150);
            //    if (cols.Exists(&quot;PhoneNo&quot;))
            //        cols.FromKey(&quot;PhoneNo&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;FaxNo&quot;))
            //        cols.FromKey(&quot;FaxNo&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;EmailID&quot;))
            //        cols.FromKey(&quot;EmailID&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;Contact&quot;))
            //        cols.FromKey(&quot;Contact&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;Id&quot;))
            //        cols.FromKey(&quot;Id&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;City&quot;))
            //        cols.FromKey(&quot;City&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;State&quot;))
            //        cols.FromKey(&quot;State&quot;).Width = Unit.Pixel(100);
            //    if (cols.Exists(&quot;ZipCode&quot;))
            //    {
            //        cols.FromKey(&quot;ZipCode&quot;).Width = Unit.Pixel(100);
            //        cols.FromKey(&quot;ZipCode&quot;).Header.Caption = &quot;ZipCode&quot;;
            //    }
            //}
            #endregion
            //}
            //catch (Exception)
            //{
            //    // lblException.Text = ex.Message;
            //}
            //if (ContractorDT.Rows.Count &gt; 0)
            //return ContractorDT;
            //}
        }

        #endregion

        public void MakeReadOnly(bool readOnly)
        {
            txtContractorID.ReadOnly = readOnly;
            txtContName.ReadOnly = readOnly;
            txtAddress1.ReadOnly = readOnly;
            txtAddress2.ReadOnly = readOnly;
            txtAddress3.ReadOnly = readOnly;
            txtCity.ReadOnly = readOnly;
            txtState.ReadOnly = readOnly;
            txtZip.ReadOnly = readOnly;
            txtTel.ReadOnly = readOnly;
            txtFax.ReadOnly = readOnly;
            txtFax.ReadOnly = readOnly;
            txtEmail.ReadOnly = readOnly;
            wneTelExtn.Disabled = readOnly;
            wneFaxExtn.Disabled = readOnly;
            btnContractor.Enabled = !readOnly;
            (attachments as AttachmentsControl).LinkDocumentVisible = false;
        }

        public override int GetProjectIdFromInstanceId()
        {
            if (!string.IsNullOrEmpty(Request[&quot;ProjectEstimateID&quot;]))
                return EstimateManager.Instance.GetPIDFromEstimateId(Request[&quot;ProjectEstimateID&quot;].ToInt32_2());
            else
                return -1;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[43,9,43,56,1],[52,17,52,18,1],[52,19,52,67,1],[52,68,52,69,1],[56,9,56,10,1],[57,13,57,31,1],[58,13,58,14,1],[59,17,59,78,1],[60,17,60,37,1],[61,17,61,18,1],[62,21,62,68,1],[63,21,63,66,1],[64,17,64,18,1],[65,13,65,14,1],[66,13,66,98,1],[67,13,67,37,1],[68,9,68,10,1],[71,9,71,10,1],[72,13,72,73,1],[73,17,73,38,0],[74,13,74,31,1],[75,9,75,10,1],[78,9,78,10,1],[79,13,79,128,1],[80,13,80,14,1],[81,17,81,107,1],[82,21,82,68,1],[83,22,83,112,1],[84,21,84,68,1],[85,13,85,14,1],[87,13,87,40,1],[88,13,88,69,1],[89,13,89,44,1],[92,13,92,39,1],[95,13,95,41,1],[96,13,96,67,1],[97,13,97,44,1],[98,17,98,104,1],[100,13,100,54,1],[101,17,101,38,1],[102,13,102,82,1],[103,13,103,44,1],[105,13,105,32,1],[106,17,106,69,1],[108,13,108,28,1],[109,9,109,10,1],[112,9,112,10,1],[113,13,113,88,1],[114,13,114,88,1],[115,13,115,53,1],[116,13,116,54,1],[117,13,117,82,1],[118,13,118,91,1],[119,9,119,10,1],[122,9,122,10,0],[123,13,123,49,0],[124,13,124,46,0],[125,13,125,113,0],[126,9,126,10,0],[129,9,129,10,1],[131,13,131,85,1],[133,13,134,72,1],[136,13,136,90,1],[137,13,137,48,1],[138,13,138,54,1],[139,13,139,55,1],[140,13,140,52,1],[141,13,141,57,1],[142,13,142,57,1],[143,13,143,57,1],[144,13,144,48,1],[145,13,145,50,1],[146,13,146,54,1],[147,13,147,48,1],[148,13,148,52,1],[150,13,150,20,1],[150,22,150,32,1],[150,33,150,35,1],[150,36,150,46,1],[151,13,151,14,1],[152,17,152,54,1],[153,17,153,18,1],[154,21,154,123,1],[155,21,155,43,1],[156,17,156,18,1],[158,17,158,18,1],[159,21,159,170,1],[160,21,160,43,1],[161,17,161,18,1],[162,13,162,14,1],[164,13,164,32,1],[165,9,165,10,1],[168,9,168,10,0],[169,13,169,31,0],[170,13,170,70,0],[171,9,171,10,0],[176,13,176,14,1],[177,17,177,61,1],[178,13,178,14,1],[181,9,181,10,1],[182,13,182,32,1],[183,13,183,14,1],[184,17,184,98,1],[185,17,185,39,1],[186,17,186,18,0],[187,21,187,33,0],[189,13,189,14,1],[190,13,190,26,1],[191,9,191,10,1],[193,9,193,10,1],[194,13,194,152,1],[195,13,195,14,0],[196,17,196,49,0],[197,13,197,14,0],[198,13,198,33,1],[199,9,199,10,1],[201,9,201,10,1],[203,13,203,14,1],[205,17,207,78,1],[210,17,210,39,1],[213,17,213,53,1],[216,17,217,99,1],[218,17,218,18,0],[219,21,220,51,0],[221,17,221,18,0],[223,17,223,38,1],[224,17,224,18,1],[225,21,225,50,1],[227,21,227,39,1],[229,21,229,132,1],[232,21,232,57,1],[234,21,234,57,1],[236,21,236,119,1],[238,21,238,105,1],[239,21,239,40,1],[241,21,241,45,1],[243,21,243,52,1],[244,21,244,22,1],[245,25,245,288,1],[246,25,246,294,1],[247,25,247,118,1],[249,25,249,44,1],[250,25,250,26,0],[251,29,251,144,0],[252,29,252,36,0],[256,25,256,44,1],[258,25,258,64,1],[259,25,259,60,1],[260,25,260,60,1],[261,25,261,60,1],[262,25,262,52,1],[263,25,263,66,1],[264,25,264,68,1],[265,25,265,54,1],[266,25,266,50,1],[267,25,267,50,1],[268,25,268,59,1],[269,25,269,65,1],[270,25,270,56,1],[271,25,271,54,1],[272,25,272,58,1],[276,25,276,47,1],[277,25,277,105,1],[278,25,278,81,1],[279,25,279,104,1],[280,21,280,22,1],[282,21,282,22,0],[283,25,283,51,0],[284,25,284,26,0],[285,29,285,127,0],[286,29,286,71,0],[287,25,287,26,0],[288,21,288,22,0],[290,21,290,111,1],[291,21,291,22,0],[292,25,308,103,0],[309,21,309,22,0],[310,17,310,18,1],[312,17,312,54,1],[313,17,313,18,1],[314,21,314,53,1],[315,21,315,64,1],[316,21,316,49,1],[317,17,317,18,1],[318,13,318,14,1],[319,13,319,33,0],[320,13,320,14,0],[321,17,321,98,0],[322,13,322,14,0],[323,9,323,10,1],[326,9,326,10,1],[327,13,327,43,1],[328,9,328,10,1],[331,9,331,10,0],[332,13,332,44,0],[334,13,334,14,0],[336,17,337,133,0],[339,17,339,36,0],[340,21,340,37,0],[342,17,342,41,0],[343,17,343,18,0],[344,21,344,53,0],[345,21,345,48,0],[347,21,347,51,0],[349,21,349,70,0],[351,21,351,45,0],[352,25,352,81,0],[353,21,353,45,0],[354,25,354,79,0],[355,21,355,49,0],[356,25,356,64,0],[357,21,357,48,0],[358,25,358,81,0],[359,21,359,46,0],[360,25,360,77,0],[361,21,361,46,0],[362,25,362,77,0],[363,21,363,48,0],[364,25,364,77,0],[365,21,365,43,0],[366,25,366,77,0],[368,21,368,45,0],[369,25,369,70,0],[370,21,370,49,0],[371,25,371,74,0],[372,21,372,49,0],[373,25,373,74,0],[374,21,374,49,0],[375,25,375,74,0],[376,21,376,48,0],[377,25,377,73,0],[378,21,378,46,0],[379,25,379,71,0],[380,21,380,48,0],[381,25,381,73,0],[382,21,382,48,0],[383,25,383,73,0],[384,21,384,43,0],[385,25,385,68,0],[386,21,386,45,0],[387,25,387,70,0],[388,21,388,46,0],[389,25,389,71,0],[390,21,390,48,0],[391,21,391,22,0],[392,25,392,73,0],[393,25,393,76,0],[394,21,394,22,0],[395,21,395,87,0],[396,21,397,83,0],[399,21,399,28,0],[399,30,399,49,0],[399,50,399,52,0],[399,53,399,57,0],[400,21,400,22,0],[401,25,401,54,0],[402,21,402,22,0],[403,17,403,18,0],[404,13,404,14,0],[405,13,405,33,0],[406,13,406,14,0],[407,17,407,98,0],[408,13,408,14,0],[409,9,409,10,0],[412,9,412,10,1],[415,13,415,14,1],[416,17,418,58,1],[419,17,421,60,1],[422,17,424,54,1],[425,17,427,54,1],[428,17,428,82,1],[430,17,432,50,1],[433,17,433,76,1],[434,17,436,49,1],[437,17,439,55,1],[440,17,442,59,1],[443,17,445,49,1],[446,17,448,53,1],[449,17,451,51,1],[452,17,453,114,1],[455,17,455,48,1],[456,17,456,18,0],[457,21,457,47,0],[458,25,458,70,0],[459,21,459,79,0],[460,21,460,42,0],[461,21,461,22,0],[462,25,464,49,0],[465,25,465,81,0],[466,25,466,32,0],[468,26,468,47,0],[469,21,469,22,0],[470,25,472,76,0],[473,25,473,67,0],[474,25,477,101,0],[478,21,478,22,0],[479,17,479,18,0],[481,17,481,18,1],[482,21,486,62,1],[489,21,489,22,1],[490,25,490,250,1],[491,21,491,22,1],[492,21,492,41,0],[493,21,493,22,0],[494,25,494,106,0],[495,21,495,22,0],[496,21,496,67,1],[498,21,498,93,1],[499,21,499,39,1],[500,21,500,22,1],[501,25,501,74,1],[503,25,503,207,1],[504,21,504,22,0],[505,26,505,44,0],[506,21,506,22,0],[507,25,507,106,0],[508,25,508,32,0],[511,21,511,22,0],[512,25,512,111,0],[513,25,513,32,0],[515,17,515,18,0],[516,13,516,14,0],[517,13,517,33,1],[518,13,518,14,1],[519,17,519,98,1],[520,13,520,14,1],[521,9,521,10,1],[524,9,524,10,1],[525,13,525,77,1],[526,13,526,88,1],[527,13,527,63,1],[528,13,528,175,1],[529,9,529,10,1],[532,9,532,10,1],[533,13,533,195,1],[535,9,535,10,0],[538,9,538,10,0],[539,13,539,31,0],[540,9,540,10,0],[545,9,545,10,0],[546,13,546,33,0],[547,17,547,24,0],[548,13,548,79,0],[549,13,549,20,0],[549,22,549,44,0],[549,45,549,47,0],[549,48,549,94,0],[550,13,550,14,0],[551,17,551,64,0],[552,21,552,63,0],[553,13,553,14,0],[554,13,558,118,0],[559,13,559,14,0],[560,17,560,72,0],[561,17,561,103,0],[562,13,562,14,0],[564,13,564,14,0],[565,17,565,71,0],[566,17,566,102,0],[567,13,567,14,0],[568,13,568,31,0],[569,9,569,10,0],[572,9,572,10,0],[573,13,573,27,0],[574,9,574,10,0],[577,9,577,10,0],[578,13,578,88,0],[579,13,579,31,0],[580,9,580,10,0],[583,9,583,10,1],[588,13,588,103,1],[589,13,589,14,0],[590,17,590,35,0],[591,17,591,18,0],[592,21,594,104,0],[595,17,595,18,0],[596,17,596,42,0],[597,21,597,77,0],[599,21,599,88,0],[600,13,600,14,0],[602,13,605,104,1],[607,13,607,89,1],[608,13,609,110,1],[610,17,611,83,1],[613,17,613,116,0],[615,13,622,102,1],[624,13,624,96,1],[625,13,625,37,1],[626,9,626,10,1],[629,9,629,10,1],[633,13,635,110,1],[636,13,636,30,1],[637,13,637,14,0],[638,17,638,90,0],[639,13,639,14,0],[641,13,641,44,1],[643,13,643,55,1],[644,17,644,73,0],[646,17,646,84,1],[648,13,655,114,1],[657,13,657,33,1],[728,9,728,10,1],[733,9,733,10,1],[734,13,734,49,1],[735,13,735,45,1],[736,13,736,45,1],[737,13,737,45,1],[738,13,738,45,1],[739,13,739,41,1],[740,13,740,42,1],[741,13,741,40,1],[742,13,742,40,1],[743,13,743,40,1],[744,13,744,40,1],[745,13,745,42,1],[746,13,746,44,1],[747,13,747,44,1],[748,13,748,47,1],[749,13,749,77,1],[750,9,750,10,1],[753,9,753,10,1],[754,13,754,69,1],[755,17,755,112,1],[757,17,757,27,0],[758,9,758,10,1]]);
    </script>
  </body>
</html>