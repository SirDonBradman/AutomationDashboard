<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Measurement Book\CreateMBO.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.Globalization;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DataResouces;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebSchedule;
using System.Collections.Generic;
using System.Threading;
using System.Drawing;
using System.Web.Script.Serialization;
namespace Aurigo.Brix.Construction.ContractManager.MBUI
{
    public partial class CreateMBO : BrixPageBase, IWorkflowEnabled, IXMLControl
    {
        protected WebDateChooser dtDate;
        protected UltraWebGrid grdMBODetails;
        private MeasurementEntry userControlMeasurementEntry;
        protected WebDateChooser wdcCreatedOn;
        private GenericPickerControl woItemsPicker;
        protected Attachments MBOAttachments;

        protected global::Infragistics.WebUI.WebDataInput.WebNumericEdit wneSubmittedQuantity;
        protected global::Infragistics.WebUI.WebDataInput.WebNumericEdit wneCertifiedQuantity;

        #region Class Properties

        private int ProjectId { get; set; }
        private int ContractId { get; set; }
        private int InstanceId { get; set; }

        /// &lt;summary&gt;
        /// Gets the Integration Cutoff Date
        /// &lt;/summary&gt;
        private DateTime IntegrationCutoffDate
        {
            get { return ((DateTime)Session[Constants.APP_IntegrationCutoffDate]).AddDays(-1); }
        }

        /// &lt;summary&gt;
        /// Gets the Default Record Date
        /// &lt;/summary&gt;
        private DateTime DefaultRecordDate
        {
            get { return (DateTime)Session[Constants.APP_DefaultRecordDate]; }
        }

        private string PageMode
        {
            get { return Request[&quot;Mode&quot;]; }
        }

        /// &lt;summary&gt;
        /// This hdnInstanceID is used in javascript for giving message on click of Measurement Book button in New mode
        /// Also this is used for tracking wheather Measurement Book button is clicked in New mode or not.
        /// &lt;/summary&gt;
        private int InstanceIDForUpdate
        {
            get { return hdnInstanceID.Value.ToInt32_2(); }
            set { hdnInstanceID.Value = value.ToString(); }
        }

        /// &lt;summary&gt;
        /// Work Order Type is used for selecting schema and M Book Items for a work order.
        /// &lt;/summary&gt;
        private char WorkOrderType
        {
            get { return (Session[&quot;MBWorkOrderType&quot;] == null) ? &#39;W&#39; : (char)Session[&quot;MBWorkOrderType&quot;]; }
            set { Session[&quot;MBWorkOrderType&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for tracking wheather Measurement Book button is clicked in New mode or not.
        /// &lt;/summary&gt;
        private string PageModeForUpdate
        {
            get { return (string)ViewState[&quot;MBPageModeForUpdate&quot;]; }
            set { ViewState[&quot;MBPageModeForUpdate&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for tracking wheather the user will be redirected to Measurement Book List page on click of Save button or not.
        /// &lt;/summary&gt;
        private int IsGoToListPage
        {
            get { return (int)ViewState[&quot;MBIsGoToListPage&quot;]; }
            set { ViewState[&quot;MBIsGoToListPage&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for Measurement Entry.
        /// &lt;/summary&gt;
        private int MBookItemID
        {
            get { return (int)ViewState[&quot;MBMBookItemID&quot;]; }
            set { ViewState[&quot;MBMBookItemID&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for Measurement Entry.
        /// &lt;/summary&gt;
        private int ItemID
        {
            get { return (int)ViewState[&quot;MBItemID&quot;]; }
            set { ViewState[&quot;MBItemID&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for Measurement Entry.
        /// &lt;/summary&gt;
        private int ActivityID
        {
            get { return (int)ViewState[&quot;MBActivityID&quot;]; }
            set { ViewState[&quot;MBActivityID&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used for Measurement Entry.
        /// &lt;/summary&gt;
        private int SubItemID
        {
            get { return (int)ViewState[&quot;MBSubItemID&quot;]; }
            set { ViewState[&quot;MBSubItemID&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used to calculate the WorkOrderType in different scenarios.
        /// &lt;/summary&gt;
        private DataTable DTWorkOrder
        {
            get { return (DataTable)ViewState[&quot;MBDTWorkOrder&quot;]; }
            set { ViewState[&quot;MBDTWorkOrder&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used to store all the M Book Items which are associated with the M Book.
        /// From this the data will be saved to database. Also from this so many manipulations are done at different scenarios.
        /// &lt;/summary&gt;
        private DataTable DTMBookItems
        {
            get { return (DataTable)ViewState[&quot;MBDTMBookItems&quot;]; }
            set { ViewState[&quot;MBDTMBookItems&quot;] = value; }
        }

        /// &lt;summary&gt;
        /// This is used to store the MB status
        /// &lt;/summary&gt;
        private string MBStatus
        {
            get { return (string)ViewState[&quot;MBStatus&quot;]; }
            set { ViewState[&quot;MBStatus&quot;] = value; }
        }

        /// &lt;summary&gt;
        ///This is used to store all the newly inserted, updated and deleted M Book Item Details(Measurement Entry) which are associated with the M Book.
        ///This will not have the records which is not touched(updated/deleted/Sl. No. is not changed) by the user.
        ///Action = Insert, Newly Inserted records; Action = Update, Updated records; Action = Delete, Deleted records
        ///From this the data will be saved to database. Also from this so many manipulations are done at different scenarios.
        /// &lt;/summary&gt;
        private DataTable DTMBookItemsDetail
        {
            get { return (DataTable)ViewState[&quot;MBDTMBookItemsDetail&quot;]; }
            set { ViewState[&quot;MBDTMBookItemsDetail&quot;] = value; }
        }

        private bool IsReadOnly
        {
            get
            {
                if (ViewState[&quot;IsReadOnly&quot;] == null) return false;
                return (bool)ViewState[&quot;IsReadOnly&quot;];
            }
            set { ViewState[&quot;IsReadOnly&quot;] = value; }
        }

        #endregion

        #region Creating Menus

        protected override void CreateChildControls()
        {
            EnsureChildControls();
            CreateControlCollection();

            var menus = new MenuArray();
            //Hiding Save button in View mode
            if (PageMode != &quot;View&quot;)
                AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));

            CreateToolBarMenu(menus, null);
        }

        protected override void CustomizeToolBar()
        {
            // If page mode is not View, then display the Save button.
            if (PageMode != &quot;View&quot;)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        lnkSave.Click += lnkSave_Click;
                        lnkSave.OnClientClick = &quot;WorkflowCurrentAction = &#39;Save&#39;; return ValidateSave();&quot;;
                    }
                }
            }

            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += lnkCancel_Click;

            if ((MBStatus == &quot;2&quot; || IsReadOnly) &amp;&amp; MBStatus != &quot;1&quot;)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;, false);
                    }
                }
            }

        }

        #endregion

        #region Page Events (OnInit, Page_Load)

        protected override void OnInit(EventArgs e)
        {
            woItemsPicker = (ucWOItemsPicker as GenericPickerControl);
            woItemsPicker.IsFilterXml = true;
            woItemsPicker.DisplayFilter = true;
            woItemsPicker.BackClicked += woItemsPicker_BackClicked;
            woItemsPicker.ItemSelected += woItemsPicker_SelectedIndexChanged;
            woItemsPicker.BindData += woItemsPicker_BindData;
            woItemsPicker.DataSourceCommandType = DataSourceType.StoredProcedure;
            woItemsPicker.DefaultSortColumn = &quot;LineNo&quot;;
            woItemsPicker.EnableMultipleSelect = true;

            //For setting the generic picker properties
            SetMBookDetailsColumns();

            btnAdd.Click += btnAdd_Click;

            if (!Page.IsPostBack)
            {
                tdMBookID.InnerText = &quot;&quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; ID :&quot;;
            }

            ((AttachmentsControl)attachments).InstanceID = Request[&quot;InstanceID&quot;].ToString2();
            ((AttachmentsControl)attachments).SrcType = &quot;CONTMBO&quot;;

            base.OnInit(e);
        }

        private void SaveAttachments(int mbiID)
        {
            try
            {
                ((AttachmentsControl)attachments).ParentModuleID = Constants.MODID_CONTMGT;
                ((AttachmentsControl)attachments).ParentInstanceID = ContractId;
                bool bUploadAttch = ((AttachmentsControl)attachments).SaveAttachments(mbiID.ToString(), &quot;CONTMBO&quot;,
                                                                                       UserDetail.GetCurrentUserDetail()
                                                                                           .UID,
                                                                                       UserDetail.GetCurrentUserDetail()
                                                                                           .UserName,
                                                                                       &quot;MBI Attachments&quot;);

                if (bUploadAttch &amp;&amp; IsGoToListPage == 1)
                    IsGoToListPage = 1;
                //Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=CONTRFI&amp;PID=&quot; + PID.ToString() + &quot;&amp;ContractID=&quot; + ContractID.ToString(), false);
                else
                {
                    if (!bUploadAttch)
                        Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error_in_Attachments&quot;,
                                                                &quot;&lt;script&gt;ShowError(&#39;Error in uploading attachments.\\n &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; updated successfully.&#39;); document.location.href=&#39;/Common/BrixListPage.aspx?context=CONTMBO&amp;PID=&quot; +
                                                                PID + &quot;&amp;ContractID=&quot; + UIHelper.UrlEncode(ContractId.ToString()) + &quot;&#39;;&lt;/script&gt;&quot;);
                }
            }
            catch (Exception)
            {
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Error_in_Attachments&quot;,
                                                                &quot;&lt;script&gt;ShowError(&#39;Error in uploading attachments.\\n &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; updated successfully.&#39;); document.location.href=&#39;/Common/BrixListPage.aspx?context=CONTMBO&amp;PID=&quot; +
                                                                PID + &quot;&amp;ContractID=&quot; + UIHelper.UrlEncode(ContractId.ToString()) + &quot;&#39;;&lt;/script&gt;&quot;);
            }
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            InstanceId = Request[&quot;InstanceID&quot;].ToInt32_2();
            ContractId = Request[&quot;ContractID&quot;].ToInt32_2();
            ProjectId = Request[&quot;PID&quot;].ToInt32_2();

            if (!Page.IsPostBack)
            {
                wdcCreatedOn.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();

                if (CacheManager.Instance.IsIntegrated(Request.QueryString[Constants.QRY_PROJECTID].ToInt32_2()))
                {
                    dtDate.MinDate = DefaultRecordDate;
                    dtDate.MaxDate = IntegrationCutoffDate;
                    dtDate.Value = DefaultRecordDate;
                    wdcCreatedOn.MinDate = DefaultRecordDate;
                    wdcCreatedOn.MaxDate = IntegrationCutoffDate;
                    wdcCreatedOn.Value = DefaultRecordDate;
                    wdcCreatedOn.Enabled = true;
                    lblCreatedBy.Text = UserDetail.GetCurrentUserDetail().FirstName + &quot; &quot; +
                                        UserDetail.GetCurrentUserDetail().MiddleName + &quot; &quot; +
                                        UserDetail.GetCurrentUserDetail().LastName;
                    trCreated.Style.Add(&quot;display&quot;, &quot;block&quot;);
                }
                else if (!(CacheManager.Instance.IsIntegrated(Request.QueryString[Constants.QRY_PROJECTID].ToInt32_2())))
                {
                    wdcCreatedOn.MinDate = DateTime.UtcNow;
                    wdcCreatedOn.MaxDate = DateTime.UtcNow;
                    wdcCreatedOn.Value = DateTime.UtcNow;
                    dtDate.MaxDate = DateTime.UtcNow;
                    wdcCreatedOn.Enabled = false;
                }

                //IsGoToListPage = 1 : go to list page on click of save
                IsGoToListPage = 1;
                PageModeForUpdate = PageMode;
                InstanceIDForUpdate = InstanceId;

                //Get the schema for DTMBookItems, DTMBookItemsDetail
                DTMBookItems = GetMBookItemsSchema().Copy();
                DTMBookItemsDetail = (ucMeasurementEntry as MeasurementEntry).GetMBookItemsDetailSchema().Copy();

                DataSet dsMBookDetails = MBManager.Instance.GetMBookDetails(ContractId, InstanceId);

                ddlContractor.DataSource = dsMBookDetails.Tables[0];
                ddlContractor.DataValueField = dsMBookDetails.Tables[0].Columns[0].ToString();
                ddlContractor.DataTextField = dsMBookDetails.Tables[0].Columns[1].ToString();
                ddlContractor.DataBind();
                BindToolTipToDropdown(ddlContractor);

                ddlContractor.Items.Insert(0, &quot;Select&quot;);
                ddlContractor.SelectedIndex = 0;
                ddlWorkOrderNumber.Items.Insert(0, &quot;Select&quot;);
                grdMBODetails.Height = Unit.Pixel(150);

                if (grdMBODetails.Rows.Count == 0)
                    trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;none&quot;);
                else
                    ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = false;

                if (PageMode == &quot;New&quot;)
                {
                    PageTitle = &quot;New &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;
                }

                //If user is being redirected through clicking the Edit or View button, display the data.
                if (PageMode == &quot;View&quot; || PageMode == &quot;Edit&quot;)
                {
                    DataRow drMBookMaster = dsMBookDetails.Tables[1].Rows[0];

                    lblMBookID.Text = drMBookMaster[&quot;MBookID&quot;].ToString();
                    dtDate.Value = drMBookMaster[&quot;MBookDate&quot;].ToDateTime_MWCulture();
                    ddlContractor.SelectedValue = drMBookMaster[&quot;ContractorID&quot;].ToString();
                    ddlContractor_SelectedIndexChanged(sender, e);
                    if (ddlWorkOrderNumber.Items.FindByText(drMBookMaster[&quot;WorkOrderNo&quot;].ToString()) == null)
                    {
                        ddlWorkOrderNumber.Items.Add(new ListItem(drMBookMaster[&quot;WorkOrderNo&quot;].ToString(),
                                                                  drMBookMaster[&quot;WorkOrderID&quot;].ToString()));
                        WorkOrderType = string.IsNullOrEmpty(drMBookMaster[&quot;WorkOrderType&quot;].ToString()) ? &#39;W&#39; : &#39;A&#39;;
                    }
                    ddlWorkOrderNumber.SelectedIndex =
                        ddlWorkOrderNumber.Items.IndexOf(
                            ddlWorkOrderNumber.Items.FindByText(drMBookMaster[&quot;WorkOrderNo&quot;].ToString()));
                    ddlWorkOrderNumber.SelectedValue = drMBookMaster[&quot;WorkOrderID&quot;].ToString();
                    BindToolTipToDropdown(ddlWorkOrderNumber);
                    //ddlWorkOrderNumber_SelectedIndexChanged(sender, e);
                    SetWorkOrderType();
                    if (ddlWorkOrderNumber.SelectedValue != &quot;Select&quot; &amp;&amp; PageMode == &quot;Edit&quot;)
                        trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;block&quot;);
                    txtDescription.Text = drMBookMaster[&quot;Description&quot;].ToString();
                    lblCreatedBy.Text = drMBookMaster[&quot;CreatedUserName&quot;].ToString();
                    wdcCreatedOn.Value = drMBookMaster[&quot;CreatedOn&quot;].ToDateTime_MWCulture();
                    lblSubmittedBy.Text = drMBookMaster[&quot;SubmittedUserName&quot;].ToString();
                    lblSubmittedOn.Text = (drMBookMaster[&quot;SubmittedOn&quot;] == DBNull.Value)
                                              ? &quot;&quot;
                                              : drMBookMaster[&quot;SubmittedOn&quot;].ToDateTime_MWCulture().ToString(
                                                  AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                    MBStatus = drMBookMaster[&quot;Status&quot;].ToString();
                    grdMBODetails.DataSource = dsMBookDetails.Tables[2];
                    grdMBODetails.DataBind();
                    //Set the columns of grdMBODetails 
                    SetMBODetailsColumns();
                    //Add all the M Book Items present in grdMBODetails to DTMBookItems
                    AddMBookItemsToDTMBookItems();

                    dsMBookDetails.Tables[3].TableName = &quot;MBookItemsDetail&quot;;
                    (ucMeasurementEntry as MeasurementEntry).DTExistingMBookItemsDetail =
                        dsMBookDetails.Tables[&quot;MBookItemsDetail&quot;].Copy();

                    if (grdMBODetails.Rows.Count &gt; 0)
                        ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = false;

                    trCreated.Style.Add(&quot;display&quot;, &quot;block&quot;);
                    trSubmitted.Style.Add(&quot;display&quot;, &quot;block&quot;);

                    if (PageMode == &quot;View&quot;)
                    {
                        PageTitle = &quot;View &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;
                        IsReadOnly = true;
                    }
                    else
                        PageTitle = &quot;Edit &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;

                    if (drMBookMaster[&quot;SubmittedOn&quot;] != DBNull.Value)
                        IsReadOnly = true;

                    // setting this value in the viewstate - so that it preserves across post backs
                }
            }

            if (IsReadOnly) SetReadOnly();

            if (MBStatus == &quot;1&quot;)
            {
                ColumnsCollection cols = grdMBODetails.Columns;
                if (cols.FromKey(&quot;CertifiedQuantity&quot;) != null)
                {
                    cols.FromKey(&quot;CertifiedQuantity&quot;).AllowUpdate = AllowUpdate.Yes;
                    cols.FromKey(&quot;CertifiedQuantity&quot;).CellStyle.BackColor = Color.Yellow;
                }
            }

            lblItemDetails.Text = &quot;Details :&quot;;
        }

        protected void Page_LoadComplete(object sender, EventArgs e)
        {
            if (PageMode.Equals(&quot;View&quot;))
            {
                MBOAttachments.ReadOnly = ((AttachmentsControl)attachments).ReadOnly = true;
            }
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (!divMeasurementBook.Style[&quot;display&quot;].ToLower2().Contains(&quot;block&quot;))
                HideWorkflowButtons();

            base.OnPreRender(e);
        }

        #endregion

        #region Contractor and Work Order Number Drop Down Selected Index Changed

        protected void ddlContractor_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (PageMode == &quot;New&quot;)
            {
                PageTitle = &quot;New &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;
            }

            int contractorID = (ddlContractor.SelectedValue == &quot;Select&quot;) ? 0 : ddlContractor.SelectedValue.ToInt32_2();
            DTWorkOrder =
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_WORKORDGetWOforContractor, null, ContractId,
                                                        contractorID).Tables[2];
            ddlWorkOrderNumber.DataSource = DTWorkOrder;
            ddlWorkOrderNumber.DataTextField = DTWorkOrder.Columns[1].ToString();
            ddlWorkOrderNumber.DataValueField = DTWorkOrder.Columns[0].ToString();
            ddlWorkOrderNumber.DataBind();

            ddlWorkOrderNumber.Items.Insert(0, &quot;Select&quot;);
            ddlWorkOrderNumber.SelectedIndex = 0;

            //On change of contractor, reset the grid if user reset the contractor
            if (ddlContractor.SelectedValue == &quot;Select&quot; || ddlWorkOrderNumber.SelectedValue == &quot;Select&quot;)
            {
                grdMBODetails.DataSource = null;
                grdMBODetails.DataBind();
                trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;none&quot;);
            }

            BindToolTipToDropdown(ddlWorkOrderNumber);
        }

        protected void ddlWorkOrderNumber_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (PageMode == &quot;New&quot;)
            {
                PageTitle = &quot;New &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;
            }
            SetWorkOrderType();

            //Set the columns of grid on change of work order number
            if (ddlWorkOrderNumber.SelectedValue != &quot;Select&quot;)
            {
                DataTable dtDetail = MBManager.Instance.GetWOMBookItems(ddlWorkOrderNumber.SelectedValue.ToInt32_2(), WorkOrderType,
                                                       &quot;None&quot;, &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot;);
                for (int rowIndex = 0; rowIndex &lt; dtDetail.Rows.Count; rowIndex++)
                {
                    if (string.IsNullOrEmpty(dtDetail.Rows[rowIndex][&quot;AvailableQuantity&quot;].ToString2()))
                        dtDetail.Rows[rowIndex][&quot;AvailableQuantity&quot;] = dtDetail.Rows[rowIndex][&quot;WorkOrderQuantity&quot;];
                    else
                        dtDetail.Rows[rowIndex][&quot;AvailableQuantity&quot;] = dtDetail.Rows[rowIndex][&quot;AvailableQuantity&quot;];
                }
                grdMBODetails.DataSource = dtDetail;

                grdMBODetails.DataBind();
                SetMBODetailsColumns();
                trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;block&quot;);
                DTMBookItems.Clear();
                //When the WO changes, Bind the MB item master table and put the datatable in viewstate
                AddMBookItemsToDTMBookItems();
                if (grdMBODetails.Rows.Count &gt; 0)
                    ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = false;
            }
            //On change of work order number, reset the grid if user reset the work order number
            else
            {
                grdMBODetails.DataSource = null;
                grdMBODetails.DataBind();
                trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;none&quot;);
            }
        }

        #endregion

        #region Button Click Events

        /// &lt;summary&gt;
        /// When the user clicks the Add button to add M Book Items
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void btnAdd_Click(object sender, EventArgs e)
        {
            SetWorkOrderType();
            divWOItemsPicker.Visible = true;
            woItemsPicker.StateMgmtContext = ((WorkOrderType == &#39;W&#39;)) ? &quot;Items&quot; : &quot;Activities&quot;;
            woItemsPicker.ChangeTableOrViewAndBind(&quot;&quot;);
            divMeasurementBook.Style.Add(&quot;display&quot;, &quot;none&quot;);
            divMeasurementEntry.Style.Add(&quot;display&quot;, &quot;none&quot;);
            PageTitle = &quot;Select &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; Items&quot;;

            MainToolBar.Visible = false;
        }

        /// &lt;summary&gt;
        /// When the user clicks the Delete button to delete M Book Items
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void btnDelete_Click(object sender, EventArgs e)
        {
            UltraGridRow selRow;
            for (int j = grdMBODetails.Rows.Count - 1; j &gt;= 0; j--)
            {
                if (grdMBODetails.Rows[j].Cells.FromKey(&quot;To&quot;).Value.ToString2() == &quot;true&quot; ||
                    grdMBODetails.Rows[j].Cells.FromKey(&quot;To&quot;).Value.ToString2() == &quot;1&quot;)
                {
                    //Delete from DTMBookItems
                    selRow = grdMBODetails.Rows[j];
                    DataRow[] drExistingRow =
                        DTMBookItems.Select(&quot;ID = &quot; +
                                            ((selRow.Cells.FromKey(&quot;ID&quot;).Value == null ||
                                              string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ID&quot;).Value.ToString()))
                                                 ? &quot;-1&quot;
                                                 : selRow.Cells.FromKey(&quot;ID&quot;).Value.ToString())
                                            + &quot; AND ItemID = &quot; +
                                            ((selRow.Cells.FromKey(&quot;ItemID&quot;).Value == null ||
                                              string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString()))
                                                 ? &quot;-1&quot;
                                                 : selRow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString())
                                            + &quot; AND ActivityID = &quot; +
                                            ((selRow.Cells.FromKey(&quot;ActivityID&quot;).Value == null ||
                                              string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString()))
                                                 ? &quot;-1&quot;
                                                 : selRow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString())
                                            + &quot; AND SubItemID = &quot; +
                                            ((selRow.Cells.FromKey(&quot;SubItemID&quot;).Value == null ||
                                              string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString()))
                                                 ? &quot;-1&quot;
                                                 : selRow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString())
                            );
                    if (drExistingRow.Length &gt; 0)
                    {
                        DataRow[] drExistingItemDetailsRow =
                            DTMBookItemsDetail.Select(&quot;MBookItemsID = &quot; +
                                                      ((selRow.Cells.FromKey(&quot;ID&quot;).Value == null ||
                                                        string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ID&quot;).Value.ToString()))
                                                           ? &quot;-1&quot;
                                                           : selRow.Cells.FromKey(&quot;ID&quot;).Value.ToString())
                                                      + &quot; AND ItemID = &quot; +
                                                      ((selRow.Cells.FromKey(&quot;ItemID&quot;).Value == null ||
                                                        string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString()))
                                                           ? &quot;-1&quot;
                                                           : selRow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString())
                                                      + &quot; AND ActivityID = &quot; +
                                                      ((selRow.Cells.FromKey(&quot;ActivityID&quot;).Value == null ||
                                                        string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString()))
                                                           ? &quot;-1&quot;
                                                           : selRow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString())
                                                      + &quot; AND SubItemID = &quot; +
                                                      ((selRow.Cells.FromKey(&quot;SubItemID&quot;).Value == null ||
                                                        string.IsNullOrEmpty(selRow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString()))
                                                           ? &quot;-1&quot;
                                                           : selRow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString())
                                );
                        if (drExistingItemDetailsRow.Length &gt; 0)
                        {
                            for (int i = 0; i &lt; drExistingItemDetailsRow.Length; i++)
                            {
                                if (drExistingItemDetailsRow[i][&quot;MBookItemsID&quot;].ToString() == &quot;-1&quot;)
                                {
                                    drExistingItemDetailsRow[i].Delete();
                                    DTMBookItemsDetail.AcceptChanges();
                                }
                            }
                        }
                        drExistingRow[0].Delete();
                        DTMBookItems.AcceptChanges();
                    }
                    //Delete from grdMBODetails
                    selRow.Delete();
                }
            }

            //If the is no records in the grid, user can change Contractor and Work Order Number
            if (grdMBODetails.Rows.Count == 0)
            {
                ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = true;
            }
        }

        /// &lt;summary&gt;
        /// When the user clicks the Measurement Book button to see the Measurement Entries
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void grdMBODetailsButton_Click(object sender, CellEventArgs e)
        {
            //If the user has clicked the Measurement Book button on New mode
            if (InstanceIDForUpdate == 0)
            {
                IsGoToListPage = 0;
                lnkSave_Click(sender, e);
                IsGoToListPage = 1;
            }

            if (IsReadOnly)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;);
                    }
                }
            }

            PageTitle = &quot;Measurement Entry&quot;;
            divMeasurementBook.Style.Add(&quot;display&quot;, &quot;none&quot;);
            divMeasurementEntry.Style.Add(&quot;display&quot;, &quot;block&quot;);


            UltraGridRow selrow = grdMBODetails.DisplayLayout.ActiveRow;
            DataRow[] drSelectedMBookItem =
                DTMBookItems.Select(&quot;ID = &quot; +
                                    ((selrow.Cells.FromKey(&quot;ID&quot;).Value != null &amp;&amp;
                                      !string.IsNullOrEmpty(selrow.Cells.FromKey(&quot;ID&quot;).Value.ToString()))
                                         ? selrow.Cells.FromKey(&quot;ID&quot;).Value.ToInt32_2()
                                         : -1)
                                    + &quot;AND ItemID = &quot; +
                                    ((selrow.Cells.FromKey(&quot;ItemID&quot;).Value != null &amp;&amp;
                                      !string.IsNullOrEmpty(selrow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString()))
                                         ? selrow.Cells.FromKey(&quot;ItemID&quot;).Value.ToInt32_2()
                                         : -1)
                                    + &quot;AND ActivityID = &quot; +
                                    ((selrow.Cells.FromKey(&quot;ActivityID&quot;).Value != null &amp;&amp;
                                      !string.IsNullOrEmpty(selrow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString()))
                                         ? selrow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToInt32_2()
                                         : -1)
                                    + &quot;AND SubItemID = &quot; +
                                    ((selrow.Cells.FromKey(&quot;SubItemID&quot;).Value != null &amp;&amp;
                                      !string.IsNullOrEmpty(selrow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString()))
                                         ? selrow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToInt32_2()
                                         : -1));
            int noOfMBookItem = drSelectedMBookItem.Length;
            decimal postedCertifiedQty = 0;

            userControlMeasurementEntry = (ucMeasurementEntry as MeasurementEntry);
            userControlMeasurementEntry.DTMBookItems = DTMBookItems;
            userControlMeasurementEntry.DTMBookItemsDetail = DTMBookItemsDetail;
            userControlMeasurementEntry.ParentInstanceID = InstanceIDForUpdate;

            if (drSelectedMBookItem.Length &gt; 0)
            {
                userControlMeasurementEntry.MBookItemID = drSelectedMBookItem[0][&quot;ID&quot;].ToString().ToInt32_2();
                userControlMeasurementEntry.ItemID = drSelectedMBookItem[0][&quot;ItemID&quot;].ToString().ToInt32_2();
                userControlMeasurementEntry.ActivityID = drSelectedMBookItem[0][&quot;ActivityID&quot;].ToString().ToInt32_2();
                userControlMeasurementEntry.SubItemID = drSelectedMBookItem[0][&quot;SubItemID&quot;].ToString().ToInt32_2();
                decimal.TryParse(drSelectedMBookItem[0][&quot;PostedCertifiedQty&quot;].ToString2(), out postedCertifiedQty);
                userControlMeasurementEntry.PostedCertifiedQty = postedCertifiedQty;
            }
            else
            {
                userControlMeasurementEntry.MBookItemID = -1;
                userControlMeasurementEntry.ItemID = -1;
                userControlMeasurementEntry.ActivityID = -1;
                userControlMeasurementEntry.SubItemID = -1;
            }

            userControlMeasurementEntry.PageMode = PageModeForUpdate;
            userControlMeasurementEntry.MEDataBind();
        }

        #endregion

        #region Generic Picker Events

        private void woItemsPicker_BindData(string filter, string sortOrder, out DataSet dsResult, ref int currentPage,
                                            int pageSize, out int pageCount)
        {
            dsResult = new DataSet();
            int workOrderID = (ddlWorkOrderNumber.SelectedValue == &quot;Select&quot;)
                                  ? 0
                                  : ddlWorkOrderNumber.SelectedValue.ToInt32_2();
            DataTable woItems =
                MBManager.Instance.GetWOMBookDetails(workOrderID, WorkOrderType, currentPage, pageSize, sortOrder,
                                                     filter, out pageCount).Copy();
            dsResult.Tables.Add(woItems);
        }

        private void woItemsPicker_BackClicked(object sender, EventArgs e)
        {
            divWOItemsPicker.Visible = false;
            divMeasurementBook.Style.Add(&quot;display&quot;, &quot;block&quot;);
            divMeasurementEntry.Style.Add(&quot;display&quot;, &quot;none&quot;);
            PageTitle = (PageMode.Equals(&quot;New&quot;))
                              ? ((PageModeForUpdate.Equals(&quot;Edit&quot;)) ? &quot;Edit &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot; : &quot;New &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;)
                              : &quot;Edit &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;;

            MainToolBar.Visible = true;
        }

        private void woItemsPicker_SelectedIndexChanged(object sender, ItemSelectedEventArgs e)
        {
            try
            {
                if (AddMBookItemsToGrid(e))
                {
                    woItemsPicker_BackClicked(sender, e);

                    throw new Exception(&quot;Duplicate &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; Items are not added.&quot;);
                }
                woItemsPicker_BackClicked(sender, e);
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        #endregion

        #region Menu Click Events (Save, Cancel)

        private void lnkSave_Click(object sender, EventArgs e)
        {
            //Save Attachments
            (MBOAttachments).SaveAttachments(ContractId, Constants.MODID_CONTMGT);

            //If the user has not clicked the Measurement Book button
            if (IsGoToListPage == 1 &amp;&amp; (divMeasurementBook.Style[&quot;display&quot;].ToLower2().Contains(&quot;block&quot;)))
                WorkflowEnabledSaveHandler();
            else
            {
                try
                {
                    WorkflowEnabledSaveHandler(false);
                }
                catch (Exception ex)
                {
                    JavaScriptSerializer JS = new JavaScriptSerializer();
                    ClientScript.RegisterStartupScript(GetType(), &quot;ShowAlert&quot;, &quot;ShowError(&quot; + JS.Serialize(ex.Message.Replace(&quot;|&quot;, &quot;\\n&quot;)) + &quot;);&quot;, true);
                }
            }
        }

        private void lnkCancel_Click(object sender, EventArgs e)
        {
            //If the user is in Measurement Book redirect the user to list page
            if (divMeasurementBook.Style[&quot;display&quot;].ToLower2().Contains(&quot;block&quot;))
                Response.Redirect(string.Format(CultureInfo.CurrentCulture,
                                                &quot;~/Common/BrixListPage.aspx?context=CONTMBO&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&quot;,
                                                ProjectId, ContractId, false));
            //If the user is in Measurement Entry redirect the user to Measurement Book
            else if (divMeasurementEntry.Style.Value == &quot;display:block;&quot; ||
                     divMeasurementEntry.Style.Value == &quot;display:block&quot;)
            {
                divMeasurementBook.Style.Add(&quot;display&quot;, &quot;block&quot;);
                divMeasurementEntry.Style.Add(&quot;display&quot;, &quot;none&quot;);
                PageTitle = (PageMode.Equals(&quot;New&quot;)) ? &quot;New &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot; : ((PageMode.Equals(&quot;Edit&quot;)) ? &quot;Edit &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot; : &quot;View &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot;&quot;);
            }
        }

        #endregion

        #region Functions

        /// &lt;summary&gt;
        /// Save the Measurement Book to database or meausurement entry to datatable
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        private void SaveMeasurementBook(object sender, EventArgs e)
        {
            try
            {
                //When the user clicks the Save button on Measurement Book page
                if (divMeasurementBook.Style[&quot;display&quot;].ToLower2().Contains(&quot;block&quot;))
                {
                    //Updating the items master viewstate with teh latest grid values
                    DTMBookItems.Clear();
                    AddMBookItemsToDTMBookItems();

                    //Place DTMBookItems inside dsMBookItems DataSet
                    var dsMBookItems = new DataSet();
                    dsMBookItems.Tables.Add(DTMBookItems.Copy());

                    //Place DTMBookItemsDetail inside dsMBookItemsDetail DataSet
                    var dsMBookItemsDetail = new DataSet();
                    dsMBookItemsDetail.Tables.Add(DTMBookItemsDetail.Copy());

                    var mBook = new MBookMaster();
                    mBook.ID = InstanceIDForUpdate;
                    mBook.MBookID = (PageMode == &quot;New&quot;) ? 0 : lblMBookID.Text.ToInt32_2();
                    mBook.MBookDate = dtDate.Value.ToDateTime_MWCulture();
                    mBook.ContractorID = ddlContractor.SelectedValue.ToInt32_2();
                    mBook.WorkOrderID = ddlWorkOrderNumber.SelectedValue.ToInt32_2();
                    mBook.ContractID = ContractId;
                    mBook.Description = txtDescription.Text;
                    mBook.Status = 0;
                    mBook.CreatedBy = UserDetail.GetCurrentUserDetail().UID;
                    mBook.CreatedUserName = UserDetail.GetCurrentUserDetail().FirstName + &quot; &quot; +
                                            UserDetail.GetCurrentUserDetail().MiddleName + &quot; &quot; +
                                            UserDetail.GetCurrentUserDetail().LastName;
                    mBook.CreatedOn = Convert.ToDateTime(wdcCreatedOn.Value, DateFormatCulture.GetDateFormatCulture());
                    mBook.Mode = PageModeForUpdate;
                    mBook.MBookItems = dsMBookItems;
                    mBook.MBookItemsDetail = dsMBookItemsDetail;

                    InstanceId = MBManager.Instance.CUDMBook(mBook);

                    //If there is any error
                    if (InstanceId == -5)
                        throw new Exception(&quot;&quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; Date cannot be less than the WorkOrder Date&quot;);

                    if (InstanceId == -6)
                        throw new Exception(&quot;There exist lines with certified quantity (-ve) going below already posted values. Please reload the page and edit thoes lines.&quot;);

                    //If there is any error
                    if (InstanceId == -1)
                        throw new Exception(&quot;Created unsuccessful&quot;);

                    //Set the InstanceIDForUpdate and PageModeForUpdate properties
                    InstanceIDForUpdate = InstanceId;
                    PageModeForUpdate = &quot;Edit&quot;;
                }
                //When the user clicks the Save button on Measurement Entry page
                else if (divMeasurementEntry.Style.Value == &quot;display:block;&quot; || divMeasurementEntry.Style.Value == &quot;display:block&quot;)
                {
                    userControlMeasurementEntry = (ucMeasurementEntry as MeasurementEntry);
                    userControlMeasurementEntry.lnkSave_Click(sender, e);
                    DTMBookItems = userControlMeasurementEntry.DTMBookItems.Copy();
                    DTMBookItemsDetail = userControlMeasurementEntry.DTMBookItemsDetail.Copy();

                    UltraGridRow selrow = grdMBODetails.DisplayLayout.ActiveRow;
                    selrow.Cells.FromKey(&quot;MBookNo&quot;).Value = userControlMeasurementEntry.MBookNo;
                    selrow.Cells.FromKey(&quot;Quantity&quot;).Value = userControlMeasurementEntry.MBookQuantity.ToString();
                    selrow.Cells.FromKey(&quot;SubmittedQuantity&quot;).Value = userControlMeasurementEntry.MBookQuantity.ToString();
                    //if (selrow.Cells.FromKey(&quot;CertifiedQuantity&quot;).Value == null ||
                    //    string.IsNullOrEmpty(selrow.Cells.FromKey(&quot;CertifiedQuantity&quot;).Value.ToString()))
                    selrow.Cells.FromKey(&quot;CertifiedQuantity&quot;).Value = userControlMeasurementEntry.MBookQuantity.ToString();
                    selrow.Cells.FromKey(&quot;RejectedQuantity&quot;).Value = 0;

                    selrow.Cells.FromKey(&quot;Length&quot;).Value = userControlMeasurementEntry.HasLength;
                    selrow.Cells.FromKey(&quot;Width&quot;).Value = userControlMeasurementEntry.HasWidth;
                    selrow.Cells.FromKey(&quot;Height&quot;).Value = userControlMeasurementEntry.HasHeight;
                    if (selrow.Cells.FromKey(&quot;MBookRequired&quot;) != null)
                        selrow.Cells.FromKey(&quot;MBookRequired&quot;).Value = userControlMeasurementEntry.HasLength || userControlMeasurementEntry.HasWidth || userControlMeasurementEntry.HasHeight;
                    divMeasurementEntry.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    divMeasurementBook.Style.Add(&quot;display&quot;, &quot;block&quot;);
                    InstanceId = InstanceIDForUpdate;
                }
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        /// &lt;summary&gt;
        /// Set all the controls to read only in View mode.
        /// &lt;/summary&gt;
        private void SetReadOnly()
        {
            dtDate.ReadOnly = txtDescription.ReadOnly = true;
            ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = false;
            trMBODetailsButtons.Style.Add(&quot;display&quot;, &quot;none&quot;);

            //Setting these cols as read only in the MBok items grid
            ColumnsCollection cols = grdMBODetails.Columns;
            if (cols.FromKey(&quot;Remarks&quot;) != null)
            {
                cols.FromKey(&quot;Remarks&quot;).AllowUpdate = AllowUpdate.No;
                cols.FromKey(&quot;Remarks&quot;).CellStyle.BackColor = Color.White;
            }
            if (cols.FromKey(&quot;CertifiedQuantity&quot;) != null)
            {
                cols.FromKey(&quot;CertifiedQuantity&quot;).AllowUpdate = AllowUpdate.No;
                cols.FromKey(&quot;CertifiedQuantity&quot;).CellStyle.BackColor = Color.White;
            }
            if (cols.FromKey(&quot;SubmittedQuantity&quot;) != null)
            {
                cols.FromKey(&quot;SubmittedQuantity&quot;).AllowUpdate = AllowUpdate.No;
                cols.FromKey(&quot;SubmittedQuantity&quot;).CellStyle.BackColor = Color.White;
            }
        }

        /// &lt;summary&gt;
        /// Set WorkOrderType property for a Work Order
        /// &lt;/summary&gt;
        private void SetWorkOrderType()
        {
            string workOrderNo = ddlWorkOrderNumber.SelectedItem.Text;
            workOrderNo = workOrderNo.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);
            if (DTWorkOrder != null &amp;&amp; ddlWorkOrderNumber.SelectedValue != &quot;Select&quot; &amp;&amp; DTWorkOrder.Rows.Count &gt; 0)
            {
                DataRow[] drSelectedWO = DTWorkOrder.Select(&quot;WorkOrderNo=&#39;&quot; + workOrderNo + &quot;&#39;&quot;);
                if (drSelectedWO.Length &gt; 0)
                    WorkOrderType = string.IsNullOrEmpty(drSelectedWO[0][&quot;WorkOrderType&quot;].ToString()) ? &#39;W&#39; : &#39;A&#39;;
            }
        }

        /// &lt;summary&gt;
        /// Set M Book Items schema for generic picker
        /// &lt;/summary&gt;
        private void SetMBookDetailsColumns()
        {
            woItemsPicker.ModifyColumnProperties(&quot;ID&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;ParentInstanceID&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;ItemID&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;LineNo&quot;, false, null, null, null, false, &quot;Line No.&quot;);
            woItemsPicker.ModifyColumnProperties(&quot;StandardItemNo&quot;, false, null, null, null, false, &quot;Standard Item No.&quot;);
            woItemsPicker.ModifyColumnProperties(&quot;SubItemID&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;MBookNo&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;Quantity&quot;, true, null, AMP3ApplicationSettings.Instance.FORMAT_QUANTITY, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;MeasurementBook&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;ActivityID&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;Length&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;Width&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;Height&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;WorkOrderQuantity&quot;, false, null, AMP3ApplicationSettings.Instance.FORMAT_QUANTITY, null,
                                                 false, &quot;Work Order Quantity&quot;);
            woItemsPicker.ModifyColumnProperties(&quot;UnitPrice&quot;, false, null, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE, null, false,
                                                 &quot;Unit Price in &quot; +
                                                 LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
            if (WorkOrderType == &#39;W&#39;)
            {
                woItemsPicker.StateMgmtContext = &quot;Items&quot;;
                woItemsPicker.ModifyColumnProperties(&quot;ActivityName&quot;, true, null, null, null, false);
                woItemsPicker.Filters = GetItemsFilters();
                woItemsPicker.ModifyColumnProperties(&quot;SubItem&quot;, true, null, null, null, false, &quot;Sub Item&quot;);
            }
            else
            {
                woItemsPicker.StateMgmtContext = &quot;Activities&quot;;
                woItemsPicker.ModifyColumnProperties(&quot;ActivityName&quot;, false, null, null, null, false, &quot;Activity Name&quot;);
                woItemsPicker.Filters = GetActivitiesFilters();
                woItemsPicker.ModifyColumnProperties(&quot;SubItem&quot;, false, null, null, null, false, &quot;Sub Item&quot;);
            }
            woItemsPicker.ModifyColumnProperties(&quot;AvailableQuantity&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;CerQty&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;SubmittedQuantity&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;CertifiedQuantity&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;RejectedQuantity&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;Remarks&quot;, true, null, null, null, false);
            woItemsPicker.ModifyColumnProperties(&quot;PostedCertifiedQty&quot;, true, null, AMP3ApplicationSettings.Instance.FORMAT_QUANTITY, &quot;150&quot;,
                                                 false, &quot;Approved Certified Quantity&quot;);
            woItemsPicker.ModifyColumnProperties(&quot;MBookRequired&quot;, true, null, null, null, false);
        }

        /// &lt;summary&gt;
        /// For adding tool tips to dropdowns.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ddl&quot;&gt;&lt;/param&gt;
        private void BindToolTipToDropdown(DropDownList ddl)
        {
            if (ddl.Items.Count &gt; 0)
            {
                for (int i = 0; i &lt; ddl.Items.Count; i++)
                {
                    ddl.Items[i].Attributes.Add(&quot;title&quot;, ddl.Items[i].Text);
                }
            }
        }

        #region Setting Schema Columns

        /// &lt;summary&gt;
        /// Formatting the grid columns for M Book Items
        /// &lt;/summary&gt;
        private void SetMBODetailsColumns()
        {
            ColumnsCollection cols = grdMBODetails.Columns;

            if (cols.Exists(&quot;ID&quot;))
                cols.FromKey(&quot;ID&quot;).Hidden = true;

            if (cols.Exists(&quot;ParentInstanceID&quot;))
                cols.FromKey(&quot;ParentInstanceID&quot;).Hidden = true;

            if (cols.Exists(&quot;ItemID&quot;))
                cols.FromKey(&quot;ItemID&quot;).Hidden = true;

            if (cols.Exists(&quot;LineNo&quot;))
            {
                cols.FromKey(&quot;LineNo&quot;).Header.Caption = &quot;Line No.&quot;;
                cols.FromKey(&quot;LineNo&quot;).Width = Unit.Pixel(60);
            }

            if (cols.Exists(&quot;StandardItemNo&quot;))
                cols.FromKey(&quot;StandardItemNo&quot;).Header.Caption = &quot;Standard Item No.&quot;;

            if (cols.Exists(&quot;ActivityID&quot;))
                cols.FromKey(&quot;ActivityID&quot;).Hidden = true;

            if (cols.Exists(&quot;ActivityName&quot;))
            {
                if (WorkOrderType == &#39;A&#39;)
                    cols.FromKey(&quot;ActivityName&quot;).Header.Caption = &quot;Activity Name&quot;;
                else
                    cols.FromKey(&quot;ActivityName&quot;).Hidden = true;
            }

            if (cols.Exists(&quot;SubItemID&quot;))
                cols.FromKey(&quot;SubItemID&quot;).Hidden = true;

            if (WorkOrderType != &#39;W&#39;)
            {
                if (cols.Exists(&quot;SubItem&quot;))
                    cols.FromKey(&quot;SubItem&quot;).Header.Caption = &quot;Sub Item&quot;;
            }
            else
            {
                if (cols.Exists(&quot;SubItem&quot;))
                    cols.FromKey(&quot;SubItem&quot;).Hidden = true;
            }

            if (cols.Exists(&quot;Unit&quot;))
                cols.FromKey(&quot;Unit&quot;).Width = Unit.Pixel(60);

            if (cols.Exists(&quot;MBookNo&quot;))
            {
                cols.FromKey(&quot;MBookNo&quot;).Header.Caption = LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; No.&quot;;
                cols.FromKey(&quot;MBookNo&quot;).Hidden = true;
            }

            if (cols.Exists(&quot;Quantity&quot;))
            {
                cols.FromKey(&quot;Quantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;Quantity&quot;).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(&quot;Quantity&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(&quot;Quantity&quot;).Hidden = true;
            }

            if (cols.Exists(&quot;MeasurementBook&quot;))
            {
                cols.FromKey(&quot;MeasurementBook&quot;).Header.Caption = &quot;LOC_MBook&quot;;
                cols.FromKey(&quot;MeasurementBook&quot;).Type = ColumnType.Button;
                cols.FromKey(&quot;MeasurementBook&quot;).Width = Unit.Pixel(120);
            }

            if (cols.Exists(&quot;MBookRequired&quot;))
                cols.FromKey(&quot;MBookRequired&quot;).Hidden = true;

            if (cols.Exists(&quot;Length&quot;))
                cols.FromKey(&quot;Length&quot;).Hidden = true;

            if (cols.Exists(&quot;Width&quot;))
                cols.FromKey(&quot;Width&quot;).Hidden = true;

            if (cols.Exists(&quot;Height&quot;))
                cols.FromKey(&quot;Height&quot;).Hidden = true;

            if (cols.Exists(&quot;WorkOrderQuantity&quot;))
                cols.FromKey(&quot;WorkOrderQuantity&quot;).Hidden = true;

            if (cols.Exists(&quot;PostedCertifiedQty&quot;))
                cols.FromKey(&quot;PostedCertifiedQty&quot;).Hidden = true;

            if (cols.Exists(&quot;UnitPrice&quot;))
                cols.FromKey(&quot;UnitPrice&quot;).Hidden = true;

            //Make sertified quantity, certified quantity editable
            if (cols.Exists(&quot;SubmittedQuantity&quot;))
            {
                cols.FromKey(&quot;SubmittedQuantity&quot;).EditorControlID = &quot;wneSubmittedQuantity&quot;;
                cols.FromKey(&quot;SubmittedQuantity&quot;).Type = ColumnType.Custom;
                cols.FromKey(&quot;SubmittedQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;SubmittedQuantity&quot;).Header.Caption = &quot;Submitted Qty&quot;;
                cols.FromKey(&quot;SubmittedQuantity&quot;).Width = new Unit(&quot;150&quot;);
                cols.FromKey(&quot;SubmittedQuantity&quot;).AllowUpdate = AllowUpdate.Yes;
                cols.FromKey(&quot;SubmittedQuantity&quot;).CellStyle.BackColor = Color.Yellow;
                cols.FromKey(&quot;SubmittedQuantity&quot;).DataType = &quot;System.Decimal&quot;;

            }

            if (cols.Exists(&quot;CertifiedQuantity&quot;))
            {
                cols.FromKey(&quot;CertifiedQuantity&quot;).EditorControlID = &quot;wneCertifiedQuantity&quot;;
                cols.FromKey(&quot;CertifiedQuantity&quot;).Type = ColumnType.Custom;
                cols.FromKey(&quot;CertifiedQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;CertifiedQuantity&quot;).Header.Caption = &quot;Certified Qty&quot;;
                cols.FromKey(&quot;CertifiedQuantity&quot;).Width = new Unit(&quot;150&quot;);
                cols.FromKey(&quot;CertifiedQuantity&quot;).AllowUpdate = AllowUpdate.No;
                cols.FromKey(&quot;CertifiedQuantity&quot;).CellStyle.BackColor = Color.White;
                cols.FromKey(&quot;CertifiedQuantity&quot;).DataType = &quot;System.Decimal&quot;;

            }

            if (cols.Exists(&quot;RejectedQuantity&quot;))
            {
                cols.FromKey(&quot;RejectedQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;RejectedQuantity&quot;).Header.Caption = &quot;Rejected Qty&quot;;
                cols.FromKey(&quot;RejectedQuantity&quot;).Width = new Unit(&quot;150&quot;);
                cols.FromKey(&quot;RejectedQuantity&quot;).DataType = &quot;System.Decimal&quot;;
            }

            if (cols.Exists(&quot;Remarks&quot;))
            {
                cols.FromKey(&quot;Remarks&quot;).Header.Caption = &quot;Remarks&quot;;
                cols.FromKey(&quot;Remarks&quot;).Width = new Unit(&quot;150&quot;);
                cols.FromKey(&quot;Remarks&quot;).AllowUpdate = AllowUpdate.Yes;
                cols.FromKey(&quot;Remarks&quot;).CellStyle.BackColor = Color.Yellow;
                cols.FromKey(&quot;Remarks&quot;).DataType = &quot;System.String&quot;;
            }

            if (cols.Exists(&quot;CerQty&quot;))
            {
                cols.FromKey(&quot;CerQty&quot;).Hidden = true;
            }

            if (cols.Exists(&quot;AvailableQuantity&quot;))
            {
                cols.FromKey(&quot;AvailableQuantity&quot;).Header.Caption = &quot;Available Quantity&quot;;
                cols.FromKey(&quot;AvailableQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;AvailableQuantity&quot;).DataType = &quot;System.Decimal&quot;;

            }

            if (cols.Exists(&quot;AvailableQuantity&quot;) &amp;&amp; cols.Exists(&quot;Unit&quot;))
                grdMBODetails.Columns.FromKey(&quot;AvailableQuantity&quot;).Move(grdMBODetails.Columns.FromKey(&quot;Unit&quot;).Index + 1);

        }

        #endregion

        #region M Book Items

        //This adds all the existing M Book Items to DTMBookItems on page load in edit mode
        //The records will be copied from grdMBODetails
        private void AddMBookItemsToDTMBookItems()
        {
            for (int i = 0; i &lt; grdMBODetails.Rows.Count; i++)
            {
                DataRow drMBookItems = DTMBookItems.NewRow();

                UltraGridRow currentRow = grdMBODetails.Rows[i];
                drMBookItems[&quot;ID&quot;] = (currentRow.Cells.FromKey(&quot;ID&quot;).Value == null)
                                         ? &quot;-1&quot;
                                         : currentRow.Cells.FromKey(&quot;ID&quot;).Value.ToString();
                drMBookItems[&quot;ParentInstanceID&quot;] = InstanceId;
                drMBookItems[&quot;ItemID&quot;] = (currentRow.Cells.FromKey(&quot;ItemID&quot;).Value == null)
                                             ? &quot;-1&quot;
                                             : currentRow.Cells.FromKey(&quot;ItemID&quot;).Value.ToString();
                drMBookItems[&quot;LineNo&quot;] = (currentRow.Cells.FromKey(&quot;LineNo&quot;).Value == null)
                                             ? -1
                                             : currentRow.Cells.FromKey(&quot;LineNo&quot;).Value.ToInt32_2();
                drMBookItems[&quot;StandardItemNo&quot;] = (currentRow.Cells.FromKey(&quot;StandardItemNo&quot;).Value == null)
                                                     ? string.Empty
                                                     : currentRow.Cells.FromKey(&quot;StandardItemNo&quot;).Value.ToString();
                drMBookItems[&quot;Description&quot;] = (currentRow.Cells.FromKey(&quot;Description&quot;).Value == null)
                                                  ? string.Empty
                                                  : currentRow.Cells.FromKey(&quot;Description&quot;).Value.ToString();
                drMBookItems[&quot;ActivityID&quot;] = (currentRow.Cells.FromKey(&quot;ActivityID&quot;).Value == null)
                                                 ? &quot;-1&quot;
                                                 : currentRow.Cells.FromKey(&quot;ActivityID&quot;).Value.ToString();
                drMBookItems[&quot;ActivityName&quot;] = (currentRow.Cells.FromKey(&quot;ActivityName&quot;).Value == null)
                                                   ? string.Empty
                                                   : currentRow.Cells.FromKey(&quot;ActivityName&quot;).Value.ToString();
                drMBookItems[&quot;SubItemID&quot;] = (currentRow.Cells.FromKey(&quot;SubItemID&quot;).Value == null)
                                                ? &quot;-1&quot;
                                                : currentRow.Cells.FromKey(&quot;SubItemID&quot;).Value.ToString();
                drMBookItems[&quot;SubItem&quot;] = (currentRow.Cells.FromKey(&quot;SubItem&quot;).Value == null)
                                              ? string.Empty
                                              : currentRow.Cells.FromKey(&quot;SubItem&quot;).Value.ToString();
                drMBookItems[&quot;Unit&quot;] = (currentRow.Cells.FromKey(&quot;Unit&quot;).Value == null)
                                           ? string.Empty
                                           : currentRow.Cells.FromKey(&quot;Unit&quot;).Value.ToString();
                drMBookItems[&quot;MBookNo&quot;] = (currentRow.Cells.FromKey(&quot;MBookNo&quot;).Value == null)
                                              ? &quot;-----&quot;
                                              : currentRow.Cells.FromKey(&quot;MBookNo&quot;).Value.ToString();

                drMBookItems[&quot;MBookRequired&quot;] = ((currentRow.Cells.Exists(&quot;MBookRequired&quot;) &amp;&amp;
                                                  currentRow.Cells.FromKey(&quot;MBookRequired&quot;).Value == null) ||
                                                 !currentRow.Cells.Exists(&quot;MBookRequired&quot;))
                                                    ? &quot;false&quot;
                                                    : currentRow.Cells.FromKey(&quot;MBookRequired&quot;).Value.ToString();
                drMBookItems[&quot;Length&quot;] = ((currentRow.Cells.Exists(&quot;Length&quot;) &amp;&amp;
                                           currentRow.Cells.FromKey(&quot;Length&quot;).Value == null) ||
                                          !currentRow.Cells.Exists(&quot;Length&quot;))
                                             ? &quot;false&quot;
                                             : currentRow.Cells.FromKey(&quot;Length&quot;).Value.ToString();
                drMBookItems[&quot;Width&quot;] = ((currentRow.Cells.Exists(&quot;Width&quot;) &amp;&amp;
                                          currentRow.Cells.FromKey(&quot;Width&quot;).Value == null) ||
                                         !currentRow.Cells.Exists(&quot;Width&quot;))
                                            ? &quot;false&quot;
                                            : currentRow.Cells.FromKey(&quot;Width&quot;).Value.ToString();
                drMBookItems[&quot;Height&quot;] = ((currentRow.Cells.Exists(&quot;Height&quot;) &amp;&amp;
                                           currentRow.Cells.FromKey(&quot;Height&quot;).Value == null) ||
                                          !currentRow.Cells.Exists(&quot;Height&quot;))
                                             ? &quot;false&quot;
                                             : currentRow.Cells.FromKey(&quot;Height&quot;).Value.ToString();
                drMBookItems[&quot;SubmittedQuantity&quot;] = (currentRow.Cells.FromKey(&quot;SubmittedQuantity&quot;).Value == null)
                                              ? &quot;0.0&quot;
                                              : currentRow.Cells.FromKey(&quot;SubmittedQuantity&quot;).Value.ToString();
                drMBookItems[&quot;CertifiedQuantity&quot;] = (currentRow.Cells.FromKey(&quot;CertifiedQuantity&quot;).Value == null)
                                              ? &quot;0.0&quot;
                                              : currentRow.Cells.FromKey(&quot;CertifiedQuantity&quot;).Value.ToString();
                drMBookItems[&quot;RejectedQuantity&quot;] = drMBookItems[&quot;SubmittedQuantity&quot;].ToDecimal2() - drMBookItems[&quot;CertifiedQuantity&quot;].ToDecimal2();
                drMBookItems[&quot;PostedCertifiedQty&quot;] = (currentRow.Cells.FromKey(&quot;PostedCertifiedQty&quot;).Value == null)
                                              ? &quot;0.0&quot;
                                              : currentRow.Cells.FromKey(&quot;PostedCertifiedQty&quot;).Value.ToString();
                drMBookItems[&quot;AvailableQuantity&quot;] = (currentRow.Cells.FromKey(&quot;AvailableQuantity&quot;).Value == null)
                                              ? &quot;0.0&quot;
                                              : currentRow.Cells.FromKey(&quot;AvailableQuantity&quot;).Value.ToString();
                drMBookItems[&quot;Remarks&quot;] = (currentRow.Cells.FromKey(&quot;Remarks&quot;).Value == null)
                                             ? &quot;&quot;
                                             : currentRow.Cells.FromKey(&quot;Remarks&quot;).Value.ToString();

                DTMBookItems.Rows.Add(drMBookItems);
            }
        }

        /// &lt;summary&gt;
        /// This adds the M Book Items to grdMBODetails while selecting rows in generic picker
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private bool AddMBookItemsToGrid(ItemSelectedEventArgs e)
        {
            DataTable selectedResources = e.SelectedItems;

            bool isDuplicate = false;

            foreach (UltraGridRow dr in grdMBODetails.Rows)
            {
                if (WorkOrderType == &#39;W&#39;)
                {
                    //If it is BOQ based work order at Sub Item level, check wheather the (Item, Sub Item) combination exists in the grdMBODetails
                    if (!string.IsNullOrEmpty(dr.Cells.FromKey(&quot;SubItemID&quot;).Text) &amp;&amp; dr.Cells.FromKey(&quot;SubItemID&quot;).Text != &quot;-1&quot;)
                    {
                        if (
                            (selectedResources.Select(&quot;ItemID = &quot; + dr.Cells.FromKey(&quot;ItemID&quot;).Text.ToInt32_2() +
                                                      &quot; AND SubItemID = &quot; +
                                                      dr.Cells.FromKey(&quot;SubItemID&quot;).Text.ToInt32_2())).Length &gt; 0)
                        {
                            isDuplicate = true;
                            selectedResources.Rows.Remove(
                                (selectedResources.Select(&quot;ItemID=&quot; + dr.Cells.FromKey(&quot;ItemID&quot;).Text.ToInt32_2() +
                                                          &quot; AND SubItemID = &quot; +
                                                          dr.Cells.FromKey(&quot;SubItemID&quot;).Text.ToInt32_2()))[0]);
                        }
                    }
                    //If it is BOQ based work order at Item level, check wheather the Item exists in the grdMBODetails
                    else
                    {
                        if (
                            (selectedResources.Select(&quot;ItemID = &quot; + dr.Cells.FromKey(&quot;ItemID&quot;).Text.ToInt32_2())).Length &gt;
                            0)
                        {
                            isDuplicate = true;
                            selectedResources.Rows.Remove(
                                (selectedResources.Select(&quot;ItemID=&quot; + dr.Cells.FromKey(&quot;ItemID&quot;).Text.ToInt32_2()))[0]);
                        }
                    }
                }
                else
                {
                    if (!string.IsNullOrEmpty(dr.Cells.FromKey(&quot;SubItemID&quot;).Text))
                    {
                        //If it is Activity based work order at Sub Item level, check wheather the (Activity, Sub Item) combination exists in the grdMBODetails
                        if (
                            (selectedResources.Select(&quot;ActivityID = &quot; + dr.Cells.FromKey(&quot;ActivityID&quot;).Text.ToInt32_2() +
                                                      &quot; AND SubItemID = &quot; +
                                                      dr.Cells.FromKey(&quot;SubItemID&quot;).Text.ToInt32_2())).Length &gt; 0)
                        {
                            isDuplicate = true;
                            selectedResources.Rows.Remove(
                                (selectedResources.Select(&quot;ActivityID = &quot; +
                                                          dr.Cells.FromKey(&quot;ActivityID&quot;).Text.ToInt32_2() +
                                                          &quot; AND SubItemID = &quot; +
                                                          dr.Cells.FromKey(&quot;SubItemID&quot;).Text.ToInt32_2()))[0]);
                        }
                    }
                    //If it is Activity based work order at Item level, check wheather the (Activity, Sub Item) combination exists in the grdMBODetails
                    else
                    {
                        if (
                            (selectedResources.Select(&quot;ActivityID = &quot; + dr.Cells.FromKey(&quot;ActivityID&quot;).Text.ToInt32_2()))
                                .Length &gt; 0)
                        {
                            isDuplicate = true;
                            selectedResources.Rows.Remove(
                                (selectedResources.Select(&quot;ActivityID = &quot; +
                                                          dr.Cells.FromKey(&quot;ActivityID&quot;).Text.ToInt32_2()))[0]);
                        }
                    }
                }
            }

            foreach (DataRow dr in selectedResources.Rows)
            {
                var values = new object[grdMBODetails.Columns.Count];
                values[0] = false;
                values[1] = string.IsNullOrEmpty(dr[&quot;ID&quot;].ToString()) ? null : dr[&quot;ID&quot;].ToString();
                values[2] = dr[&quot;ParentInstanceID&quot;].ToString();
                values[3] = string.IsNullOrEmpty(dr[&quot;ItemID&quot;].ToString()) ? null : dr[&quot;ItemID&quot;].ToString();
                values[4] = string.IsNullOrEmpty(dr[&quot;LineNo&quot;].ToString()) ? null : dr[&quot;LineNo&quot;].ToString();
                values[5] = dr[&quot;StandardItemNo&quot;].ToString();
                values[6] = dr[&quot;Description&quot;].ToString();
                values[7] = string.IsNullOrEmpty(dr[&quot;ActivityID&quot;].ToString()) ? null : dr[&quot;ActivityID&quot;].ToString();
                values[8] = dr[&quot;ActivityName&quot;].ToString();
                values[9] = string.IsNullOrEmpty(dr[&quot;SubItemID&quot;].ToString()) ? null : dr[&quot;SubItemID&quot;].ToString();
                values[10] = dr[&quot;SubItem&quot;].ToString();
                values[11] = dr[&quot;Unit&quot;].ToString();
                if (grdMBODetails.Columns.Exists(&quot;MBookNo&quot;)) values[grdMBODetails.Columns.FromKey(&quot;MBookNo&quot;).Index] = dr[&quot;MBookNo&quot;].ToString();
                if (grdMBODetails.Columns.Exists(&quot;Quantity&quot;)) values[grdMBODetails.Columns.FromKey(&quot;Quantity&quot;).Index] = dr[&quot;Quantity&quot;].ToString();
                if (grdMBODetails.Columns.Exists(&quot;MeasurementBook&quot;)) values[grdMBODetails.Columns.FromKey(&quot;MeasurementBook&quot;).Index] = dr[&quot;MeasurementBook&quot;].ToString();
                if (grdMBODetails.Columns.Exists(&quot;PostedCertifiedQty&quot;)) values[grdMBODetails.Columns.FromKey(&quot;PostedCertifiedQty&quot;).Index] = dr[&quot;PostedCertifiedQty&quot;].ToString();
                if (grdMBODetails.Columns.Exists(&quot;AvailableQuantity&quot;)) values[grdMBODetails.Columns.FromKey(&quot;AvailableQuantity&quot;).Index] = dr[&quot;AvailableQuantity&quot;].ToString();
                var urg = new UltraGridRow(values);
                grdMBODetails.Rows.Add(urg);

                //Disable the Contractor and Work Order Number drop down
                ddlContractor.Enabled = ddlWorkOrderNumber.Enabled = false;

                //Add this M Book Item to DTMBookItems
                AddMBookItemsToDataTable(dr);
            }

            return isDuplicate;
        }

        /// &lt;summary&gt;
        /// This adds the M Book Items to DTMBookItems while selecting rows in generic picker
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;dr&quot;&gt;&lt;/param&gt;
        private void AddMBookItemsToDataTable(DataRow dr)
        {
            DataRow drMBookItems = DTMBookItems.NewRow();
            drMBookItems[&quot;ID&quot;] = (dr[&quot;ID&quot;] == DBNull.Value) ? &quot;-1&quot; : dr[&quot;ID&quot;].ToString();
            drMBookItems[&quot;ParentInstanceID&quot;] = InstanceId;
            drMBookItems[&quot;MBookNo&quot;] = &quot;-----&quot;;
            drMBookItems[&quot;ItemID&quot;] = (dr[&quot;ItemID&quot;] == DBNull.Value) ? &quot;-1&quot; : dr[&quot;ItemID&quot;].ToString();
            drMBookItems[&quot;SubItemID&quot;] = (dr[&quot;SubItemID&quot;] == DBNull.Value) ? &quot;-1&quot; : dr[&quot;SubItemID&quot;].ToString();
            drMBookItems[&quot;ActivityID&quot;] = (WorkOrderType == &#39;W&#39;)
                                             ? &quot;-1&quot;
                                             : ((dr[&quot;ActivityID&quot;] == DBNull.Value) ? &quot;-1&quot; : dr[&quot;ActivityID&quot;].ToString());
            drMBookItems[&quot;MBookRequired&quot;] = &quot;false&quot;;
            drMBookItems[&quot;Length&quot;] = &quot;false&quot;;
            drMBookItems[&quot;Width&quot;] = &quot;false&quot;;
            drMBookItems[&quot;Height&quot;] = &quot;false&quot;;
            drMBookItems[&quot;WorkOrderQuantity&quot;] = -1;
            drMBookItems[&quot;UnitPrice&quot;] = -1;
            drMBookItems[&quot;LineNo&quot;] = (dr[&quot;LineNo&quot;] == DBNull.Value) ? (-1).ToString2() : dr[&quot;LineNo&quot;].ToString();
            drMBookItems[&quot;StandardItemNo&quot;] = (dr[&quot;StandardItemNo&quot;] == DBNull.Value)
                                                 ? string.Empty
                                                 : dr[&quot;StandardItemNo&quot;].ToString();
            drMBookItems[&quot;Description&quot;] = (dr[&quot;Description&quot;] == DBNull.Value)
                                              ? string.Empty
                                              : dr[&quot;Description&quot;].ToString();
            drMBookItems[&quot;ActivityName&quot;] = (dr[&quot;ActivityName&quot;] == DBNull.Value)
                                               ? string.Empty
                                               : dr[&quot;ActivityName&quot;].ToString();
            drMBookItems[&quot;SubItem&quot;] = (dr[&quot;SubItem&quot;] == DBNull.Value) ? string.Empty : dr[&quot;SubItem&quot;].ToString();
            drMBookItems[&quot;Unit&quot;] = (dr[&quot;Unit&quot;] == DBNull.Value) ? string.Empty : dr[&quot;Unit&quot;].ToString();

            drMBookItems[&quot;SubmittedQuantity&quot;] = (dr[&quot;SubmittedQuantity&quot;] == DBNull.Value) ? &quot;0&quot; : dr[&quot;SubmittedQuantity&quot;].ToString();
            drMBookItems[&quot;CertifiedQuantity&quot;] = (dr[&quot;CertifiedQuantity&quot;] == DBNull.Value) ? &quot;0&quot; : dr[&quot;CertifiedQuantity&quot;].ToString();
            drMBookItems[&quot;RejectedQuantity&quot;] = (dr[&quot;RejectedQuantity&quot;] == DBNull.Value) ? &quot;0&quot; : dr[&quot;RejectedQuantity&quot;].ToString();
            drMBookItems[&quot;PostedCertifiedQty&quot;] = (dr[&quot;PostedCertifiedQty&quot;] == DBNull.Value) ? &quot;0&quot; : dr[&quot;PostedCertifiedQty&quot;].ToString();
            drMBookItems[&quot;AvailableQuantity&quot;] = (dr[&quot;AvailableQuantity&quot;] == DBNull.Value) ? &quot;0&quot; : dr[&quot;AvailableQuantity&quot;].ToString();
            drMBookItems[&quot;Remarks&quot;] = (dr[&quot;Remarks&quot;] == DBNull.Value) ? &quot;&quot; : dr[&quot;Remarks&quot;].ToString();

            DTMBookItems.Rows.Add(drMBookItems);
        }

        #endregion

        #region Filters for Generic Picker

        /// &lt;summary&gt;
        /// For BOQ Based Work Order
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private BrixFilter[] GetItemsFilters()
        {
            var filters = new BrixFilter[2];

            filters[0] = new BrixFilter();
            filters[0].Title = &quot;Standard Item No. :&quot;;
            filters[0].Name = &quot;StandardItemNo&quot;;
            filters[0].FilterType = BrixFilter.Type.Text;

            filters[1] = new BrixFilter();
            filters[1].Title = &quot;Description :&quot;;
            filters[1].Name = &quot;Description&quot;;
            filters[1].FilterType = BrixFilter.Type.Text;

            return filters;
        }

        /// &lt;summary&gt;
        /// For Activity Based Work Order
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private BrixFilter[] GetActivitiesFilters()
        {
            var filters = new BrixFilter[3];

            filters[0] = new BrixFilter();
            filters[0].Title = &quot;Standard Item No. :&quot;;
            filters[0].Name = &quot;StandardItemNo&quot;;
            filters[0].FilterType = BrixFilter.Type.Text;

            filters[1] = new BrixFilter();
            filters[1].Title = &quot;Description :&quot;;
            filters[1].Name = &quot;Description&quot;;
            filters[1].FilterType = BrixFilter.Type.Text;

            filters[2] = new BrixFilter();
            filters[2].Title = &quot;Activity Name :&quot;;
            filters[2].Name = &quot;ActivityName&quot;;
            filters[2].FilterType = BrixFilter.Type.Text;

            return filters;
        }

        #endregion

        #region MBookItemsSchem)

        //For M Book Items
        private DataTable GetMBookItemsSchema()
        {
            DataTable dtMBookItems = new BrixDataTable(&quot;MBookItems&quot;);

            dtMBookItems.Columns.AddRange(new[]
                                              {
                                                  new DataColumn(&quot;ID&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;ParentInstanceID&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;ItemID&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;LineNo&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;StandardItemNo&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;Description&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;ActivityID&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;ActivityName&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;SubItemID&quot;, Type.GetType(&quot;System.Int32&quot;)),
                                                  new DataColumn(&quot;SubItem&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;Unit&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;MBookNo&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;Quantity&quot;, Type.GetType(&quot;System.Double&quot;)),
                                                  new DataColumn(&quot;MeasurementBook&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;MBookRequired&quot;, Type.GetType(&quot;System.Boolean&quot;)),
                                                  new DataColumn(&quot;Length&quot;, Type.GetType(&quot;System.Boolean&quot;)),
                                                  new DataColumn(&quot;Width&quot;, Type.GetType(&quot;System.Boolean&quot;)),
                                                  new DataColumn(&quot;Height&quot;, Type.GetType(&quot;System.Boolean&quot;)),
                                                  new DataColumn(&quot;WorkOrderQuantity&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;UnitPrice&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;SubmittedQuantity&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;CertifiedQuantity&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;RejectedQuantity&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;Remarks&quot;, Type.GetType(&quot;System.String&quot;)),
                                                  new DataColumn(&quot;PostedCertifiedQty&quot;, Type.GetType(&quot;System.Decimal&quot;)),
                                                  new DataColumn(&quot;AvailableQuantity&quot;, Type.GetType(&quot;System.Decimal&quot;))
                                              });
            return dtMBookItems;
        }

        #endregion

        #endregion

        #region IWorkflowEnabled Members

        public void CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            sRedirectTo = PostSaveRedirectUrl();
        }

        public string PostCancelRedirectUrl
        {
            get { return PostSaveRedirectUrl(); }
        }

        public string PostSaveRedirectUrl(string sSavedToken = &quot;&quot;)
        {
            return string.Format(CultureInfo.CurrentCulture,
                                 &quot;~/Common/BrixListPage.aspx?context=CONTMBO&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&quot;, ProjectId,
                                 ContractId, false);
        }

        public string ClientValidationFunction
        {
            get { return &quot;ValidateSave()&quot;; }
        }

        public string FormInstanceId
        {
            get
            {
                return (Request[&quot;InstanceID&quot;].ToInt32_2() &gt; 0 || string.IsNullOrEmpty(hdnInstanceID.Value))
                           ? Request[&quot;InstanceID&quot;]
                           : InstanceIDForUpdate.ToString();
            }
        }

        public string FormKey { get { return FormInstanceId; } }

        public string FormName
        {
            get { return &quot;XCONTMB&quot;; }
        }

        public bool IsOldWorkflow
        {
            get { throw new NotImplementedException(); }
        }

        public int PID
        {
            get { return Request[&quot;PID&quot;].ToInt32_2(); }
        }

        public int ParentModuleId
        {
            get { return Request[&quot;ContractID&quot;].ToInt32_2(); }
        }


        public bool SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors,
                                out string sRedirectTo)
        {
            sRedirectTo = string.Format(CultureInfo.CurrentCulture,
                                        &quot;~/Common/BrixListPage.aspx?context=CONTMBO&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&quot;, ProjectId,
                                        ContractId, false);
            sErrors = &quot;&quot;;
            sSavedInstanceToken = &quot;0&quot;;
            try
            {
                SaveMeasurementBook(sender, new EventArgs());

                sSavedInstanceToken = InstanceId.ToString();
                SaveAttachments(InstanceId);
                return true;
            }
            catch (Exception ex)
            {
                JavaScriptSerializer JS = new JavaScriptSerializer();
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;showAlert&quot;,
                                                      &quot;ShowError(&quot; + JS.Serialize(ex.Message) + &quot;);&quot;, true);
                sErrors = ex.Message;
                sSavedInstanceToken = &quot;&quot;;
                return false;
            }
        }

        #endregion

        #region IXMLControl Memebers

        public object[] ParentFormInstanceID
        {
            get
            {
                return new object[]{ (Request[&quot;InstanceID&quot;].ToInt32_2() &gt; 0 || string.IsNullOrEmpty(hdnInstanceID.Value))
                        ? Request[&quot;InstanceID&quot;]
                        : InstanceIDForUpdate.ToString()};
            }
        }

        public System.Web.UI.HtmlControls.HtmlGenericControl XMLContainterDiv
        {
            get
            {
                return divInject;
            }
            set
            { }
        }

        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        { }

        public bool SkipDefaultXMLInjectionSave { get; set; }

        public void HandleInjectionAfterSave(object model, string parentFormInstanceId) { }

        #endregion


    }

    [CustomResourceType(&quot;Forms&quot;, &quot;XCONTMB&quot;)]
    public class PerformMBOperation : FormsCustomResource
    {
        public PerformMBOperation()
        {
            _Namespace = &quot;Forms&quot;;
            _Path = &quot;Forms.Contract.MB&quot;;
            _Name = &quot;PerformMBOperation&quot;;
            _Desc = &quot;Perform MB Operations&quot;;

            _InParameters = new[] { &quot;Operation,System.String&quot; };
            _OutParameters = new[] { &quot;IsSuccessful,System.Boolean&quot;, &quot;Message,System.String&quot; };
        }

        public override void ExecuteDerived()
        {
            string operation = GetInputParam(&quot;Operation&quot;).ToString();
            string culture = GetInputParam(&quot;Culture&quot;).ToString();
            string uiCulture = GetInputParam(&quot;UICulture&quot;).ToString();
            Thread.CurrentThread.CurrentCulture = new CultureInfo(culture);
            Thread.CurrentThread.CurrentUICulture = new CultureInfo(uiCulture);
            try
            {
                switch (operation.ToUpper())
                {
                    case &quot;SUBMIT&quot;:
                        SubmitMB();
                        break;
                    case &quot;REDRAFT&quot;:
                        ReDraftMB();
                        break;
                    case &quot;APPROVE&quot;:
                        ApproveMB();
                        break;
                    case &quot;UNAPPROVE&quot;:
                        UnApproveMB();
                        break;
                    case &quot;REJECT&quot;:
                        RejectMB();
                        break;
                }
            }
            catch (Exception ex)
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, ex.Message, &quot;System.String&quot;);
                throw new Exception(ex.Message);
            }
        }

        private void SubmitMB()
        {
            var selectedMBook = new MBookMaster();
            selectedMBook.ID = InstanceId.ToInt32_2();
            selectedMBook.Mode = &quot;Submit&quot;;
            selectedMBook.Status = 1;
            selectedMBook.SubmittedBy = GetInputParam(&quot;_CurrentUserId&quot;).ToInt32_2();
            selectedMBook.SubmittedUserName = GetInputParam(&quot;_CurrentUser&quot;).ToString();
            selectedMBook.SubmittedOn = DateTime.UtcNow;

            int isSubmitted = MBManager.Instance.CUDMBook(selectedMBook);

            if (isSubmitted == -2)
                throw new Exception(&quot;No &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; line item exists. Request denied.&quot;);
            else if (isSubmitted == -3)
                throw new Exception(
                    &quot;Measurement entry is not done for some &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; line items. Request denied.&quot;);

            if (isSubmitted &gt; 0)
            {
                SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Submit successful.&quot;, &quot;System.String&quot;);
            }
            else
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Submit unsuccessful.&quot;, &quot;System.String&quot;);
            }
        }

        private void ReDraftMB()
        {
            var selectedMBook = new MBookMaster();
            selectedMBook.ID = InstanceId.ToInt32_2();
            selectedMBook.Mode = &quot;UndoSubmit&quot;;
            selectedMBook.Status = 0;

            int isUndoSubmitted = MBManager.Instance.CUDMBook(selectedMBook);

            if (isUndoSubmitted &gt; 0)
            {
                SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Re-Draft successful.&quot;, &quot;System.String&quot;);
            }
            else
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Re-Draft unsuccessful.&quot;, &quot;System.String&quot;);
            }
        }

        private void ApproveMB()
        {
            var selectedMBook = new MBookMaster();
            selectedMBook.ID = InstanceId.ToInt32_2();
            selectedMBook.Mode = &quot;Approve&quot;;
            selectedMBook.Status = 2;
            selectedMBook.ApprovedBy = GetInputParam(&quot;_CurrentUserId&quot;).ToInt32_2();
            selectedMBook.ApprovedUserName = GetInputParam(&quot;_CurrentUser&quot;).ToString();
            selectedMBook.ApprovedOn = DateTime.UtcNow;

            int isApproved = MBManager.Instance.CUDMBook(selectedMBook);

            if (isApproved &gt; 0)
            {
                SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Approve successful.&quot;, &quot;System.String&quot;);
            }
            else
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Approve unsuccessful.&quot;, &quot;System.String&quot;);
            }
        }

        private void UnApproveMB()
        {
            var selectedMBook = new MBookMaster();
            selectedMBook.ID = InstanceId.ToInt32_2();
            selectedMBook.Mode = &quot;UnApprove&quot;;
            selectedMBook.Status = 0;

            int isUnApproved = MBManager.Instance.CUDMBook(selectedMBook);

            if (isUnApproved == -4)
                throw new Exception(LocalizationManager.GetString(KeyConstants.LOC_PAY_ESTIMATE) +
                                    &quot; is already generated for some &quot; + LocalizationManager.GetString(&quot;LOC_MeasurementBook&quot;) + &quot; line items. Request denied.&quot;);

            if (isUnApproved &gt; 0)
            {
                SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Unapprove successful.&quot;, &quot;System.String&quot;);
            }
            else
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Unapprove unsuccessful.&quot;, &quot;System.String&quot;);
            }
        }

        private void RejectMB()
        {
            var selectedMBook = new MBookMaster();
            selectedMBook.ID = InstanceId.ToInt32_2();
            selectedMBook.Mode = &quot;Reject&quot;;
            selectedMBook.Status = 0;

            int isRejected = MBManager.Instance.CUDMBook(selectedMBook);

            if (isRejected &gt; 0)
            {
                SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Reject successful.&quot;, &quot;System.String&quot;);
            }
            else
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, &quot;Reject unsuccessful.&quot;, &quot;System.String&quot;);
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[37,33,37,37,0],[37,38,37,42,0],[38,34,38,38,0],[38,39,38,43,0],[39,34,39,38,0],[39,39,39,43,0],[46,17,46,18,0],[46,19,46,95,0],[46,96,46,97,0],[54,17,54,18,0],[54,19,54,77,0],[54,78,54,79,0],[59,17,59,18,0],[59,19,59,42,0],[59,43,59,44,0],[68,17,68,18,0],[68,19,68,58,0],[68,59,68,60,0],[69,17,69,18,0],[69,19,69,58,0],[69,59,69,60,0],[77,17,77,18,0],[77,19,77,104,0],[77,105,77,106,0],[78,17,78,18,0],[78,19,78,54,0],[78,55,78,56,0],[86,17,86,18,0],[86,19,86,67,0],[86,68,86,69,0],[87,17,87,18,0],[87,19,87,60,0],[87,61,87,62,0],[95,17,95,18,0],[95,19,95,61,0],[95,62,95,63,0],[96,17,96,18,0],[96,19,96,57,0],[96,58,96,59,0],[104,17,104,18,0],[104,19,104,58,0],[104,59,104,60,0],[105,17,105,18,0],[105,19,105,54,0],[105,55,105,56,0],[113,17,113,18,0],[113,19,113,53,0],[113,54,113,55,0],[114,17,114,18,0],[114,19,114,49,0],[114,50,114,51,0],[122,17,122,18,0],[122,19,122,57,0],[122,58,122,59,0],[123,17,123,18,0],[123,19,123,53,0],[123,54,123,55,0],[131,17,131,18,0],[131,19,131,56,0],[131,57,131,58,0],[132,17,132,18,0],[132,19,132,52,0],[132,53,132,54,0],[140,17,140,18,0],[140,19,140,64,0],[140,65,140,66,0],[141,17,141,18,0],[141,19,141,54,0],[141,55,141,56,0],[150,17,150,18,0],[150,19,150,65,0],[150,66,150,67,0],[151,17,151,18,0],[151,19,151,55,0],[151,56,151,57,0],[159,17,159,18,0],[159,19,159,56,0],[159,57,159,58,0],[160,17,160,18,0],[160,19,160,49,0],[160,50,160,51,0],[171,17,171,18,0],[171,19,171,71,0],[171,72,171,73,0],[172,17,172,18,0],[172,19,172,61,0],[172,62,172,63,0],[178,13,178,14,0],[179,17,179,53,0],[179,54,179,67,0],[180,17,180,54,0],[181,13,181,14,0],[182,17,182,18,0],[182,19,182,51,0],[182,52,182,53,0],[190,9,190,10,0],[191,13,191,35,0],[192,13,192,39,0],[194,13,194,41,0],[196,13,196,36,0],[197,17,197,38,0],[198,13,198,82,0],[200,13,200,44,0],[201,9,201,10,0],[204,9,204,10,0],[206,13,206,36,0],[207,13,207,14,0],[208,17,208,35,0],[209,17,209,18,0],[210,21,210,82,0],[211,21,211,41,0],[212,21,212,22,0],[213,25,213,56,0],[214,25,214,106,0],[215,21,215,22,0],[216,17,216,18,0],[217,13,217,14,0],[219,13,219,80,0],[221,13,221,68,0],[222,13,222,14,0],[223,17,223,35,0],[224,17,224,18,0],[225,21,225,82,0],[226,21,226,41,0],[227,21,227,22,0],[228,25,228,64,0],[229,21,229,22,0],[230,17,230,18,0],[231,13,231,14,0],[233,9,233,10,0],[240,9,240,10,0],[241,13,241,71,0],[242,13,242,46,0],[243,13,243,48,0],[244,13,244,68,0],[245,13,245,78,0],[246,13,246,62,0],[247,13,247,82,0],[248,13,248,56,0],[249,13,249,55,0],[252,13,252,38,0],[254,13,254,42,0],[256,13,256,34,0],[257,13,257,14,0],[258,17,258,107,0],[259,13,259,14,0],[261,13,261,94,0],[262,13,262,67,0],[264,13,264,28,0],[265,9,265,10,0],[268,9,268,10,0],[270,13,270,14,0],[271,17,271,92,0],[272,17,272,81,0],[273,17,278,107,0],[280,17,280,57,0],[281,21,281,40,0],[284,17,284,18,0],[285,21,285,39,0],[286,25,288,147,0],[289,17,289,18,0],[290,13,290,14,0],[291,13,291,30,0],[292,13,292,14,0],[293,17,295,147,0],[296,13,296,14,0],[297,9,297,10,0],[300,9,300,10,0],[301,13,301,60,0],[302,13,302,60,0],[303,13,303,52,0],[305,13,305,34,0],[306,13,306,14,0],[307,17,307,96,0],[309,17,309,114,0],[310,17,310,18,0],[311,21,311,56,0],[312,21,312,60,0],[313,21,313,54,0],[314,21,314,62,0],[315,21,315,66,0],[316,21,316,60,0],[317,21,317,49,0],[318,21,320,84,0],[321,21,321,61,0],[322,17,322,18,0],[323,22,323,122,0],[324,17,324,18,0],[325,21,325,60,0],[326,21,326,60,0],[327,21,327,58,0],[328,21,328,54,0],[329,21,329,50,0],[330,17,330,18,0],[333,17,333,36,0],[334,17,334,46,0],[335,17,335,50,0],[338,17,338,61,0],[339,17,339,114,0],[341,17,341,101,0],[343,17,343,69,0],[344,17,344,95,0],[345,17,345,94,0],[346,17,346,42,0],[347,17,347,54,0],[349,17,349,57,0],[350,17,350,49,0],[351,17,351,62,0],[352,17,352,56,0],[354,17,354,51,0],[355,21,355,70,0],[357,21,357,80,0],[359,17,359,39,0],[360,17,360,18,0],[361,21,361,100,0],[362,17,362,18,0],[365,17,365,62,0],[366,17,366,18,0],[367,21,367,78,0],[369,21,369,75,0],[370,21,370,86,0],[371,21,371,92,0],[372,21,372,67,0],[373,21,373,110,0],[374,21,374,22,0],[375,25,376,109,0],[377,25,377,117,0],[378,21,378,22,0],[379,21,381,107,0],[382,21,382,96,0],[383,21,383,63,0],[385,21,385,40,0],[386,21,386,92,0],[387,25,387,75,0],[388,21,388,83,0],[389,21,389,85,0],[390,21,390,92,0],[391,21,391,89,0],[392,21,395,125,0],[396,21,396,67,0],[397,21,397,73,0],[398,21,398,46,0],[400,21,400,44,0],[402,21,402,51,0],[404,21,404,77,0],[405,21,406,74,0],[408,21,408,54,0],[409,25,409,84,0],[411,21,411,61,0],[412,21,412,63,0],[414,21,414,44,0],[415,21,415,22,0],[416,25,416,105,0],[417,25,417,43,0],[418,21,418,22,0],[420,25,420,105,0],[422,21,422,70,0],[423,25,423,43,0],[426,17,426,18,0],[427,13,427,14,0],[429,13,429,28,0],[429,29,429,43,0],[431,13,431,33,0],[432,13,432,14,0],[433,17,433,64,0],[434,17,434,63,0],[435,17,435,18,0],[436,21,436,85,0],[437,21,437,90,0],[438,17,438,18,0],[439,13,439,14,0],[441,13,441,47,0],[442,9,442,10,0],[445,9,445,10,0],[446,13,446,41,0],[447,13,447,14,0],[448,17,448,93,0],[449,13,449,14,0],[450,9,450,10,0],[453,9,453,10,0],[454,13,454,83,0],[455,17,455,39,0],[457,13,457,33,0],[458,9,458,10,0],[465,9,465,10,0],[466,13,466,35,0],[467,13,467,14,0],[468,17,468,96,0],[469,13,469,14,0],[471,13,471,120,0],[472,13,474,81,0],[475,13,475,57,0],[476,13,476,82,0],[477,13,477,83,0],[478,13,478,43,0],[480,13,480,58,0],[481,13,481,50,0],[484,13,484,105,0],[485,13,485,14,0],[486,17,486,49,0],[487,17,487,42,0],[488,17,488,66,0],[489,13,489,14,0],[491,13,491,55,0],[492,9,492,10,0],[495,9,495,10,0],[496,13,496,35,0],[497,13,497,14,0],[498,17,498,96,0],[499,13,499,14,0],[500,13,500,32,0],[503,13,503,62,0],[504,13,504,14,0],[505,17,506,87,0],[507,22,507,38,0],[507,40,507,70,0],[507,72,507,82,0],[508,17,508,18,0],[509,21,509,104,0],[510,25,510,117,0],[512,25,512,117,0],[513,17,513,18,0],[514,17,514,53,0],[516,17,516,42,0],[517,17,517,40,0],[518,17,518,67,0],[519,17,519,38,0],[521,17,521,47,0],[522,17,522,50,0],[523,21,523,80,0],[524,13,524,14,0],[527,13,527,14,0],[528,17,528,49,0],[529,17,529,42,0],[530,17,530,66,0],[531,13,531,14,0],[532,9,532,10,0],[544,9,544,10,0],[545,13,545,32,0],[546,13,546,45,0],[547,13,547,96,0],[548,13,548,56,0],[549,13,549,61,0],[550,13,550,62,0],[551,13,551,101,0],[553,13,553,41,0],[554,9,554,10,0],[562,9,562,10,0],[564,18,564,54,0],[564,56,564,62,0],[564,64,564,67,0],[565,13,565,14,0],[566,17,567,88,0],[568,17,568,18,0],[570,21,570,52,0],[571,21,592,31,0],[593,21,593,50,0],[594,21,594,22,0],[595,25,616,35,0],[617,25,617,65,0],[618,25,618,26,0],[619,34,619,43,0],[619,45,619,80,0],[619,82,619,85,0],[620,29,620,30,0],[621,33,621,100,0],[622,33,622,34,0],[623,37,623,74,0],[624,37,624,72,0],[625,33,625,34,0],[626,29,626,30,0],[627,25,627,26,0],[628,25,628,51,0],[629,25,629,54,0],[630,21,630,22,0],[632,21,632,37,0],[633,17,633,18,0],[634,13,634,14,0],[637,13,637,47,0],[638,13,638,14,0],[639,17,639,75,0],[640,13,640,14,0],[641,9,641,10,0],[649,9,649,10,0],[651,13,651,42,0],[652,13,652,14,0],[653,17,653,36,0],[654,17,654,42,0],[655,17,655,36,0],[656,13,656,14,0],[658,13,658,28,0],[659,13,659,14,0],[660,17,660,35,0],[661,17,661,18,0],[662,21,662,82,0],[663,21,663,41,0],[664,21,664,22,0],[665,25,665,57,0],[666,21,666,22,0],[667,17,667,18,0],[668,13,668,14,0],[670,13,670,45,0],[671,13,671,61,0],[672,13,672,63,0],[675,13,675,73,0],[676,13,696,49,0],[697,13,697,60,0],[698,13,698,44,0],[700,13,700,84,0],[701,13,701,69,0],[702,13,702,81,0],[703,13,703,80,0],[705,13,705,48,0],[706,13,706,14,0],[707,17,707,111,0],[708,17,708,110,0],[709,17,709,118,0],[710,17,710,116,0],[711,17,711,116,0],[712,17,712,85,0],[713,13,713,14,0],[715,13,715,14,0],[716,17,716,62,0],[717,17,717,57,0],[718,17,718,61,0],[719,17,719,60,0],[720,13,720,14,0],[722,13,722,70,0],[723,13,723,54,0],[724,9,724,10,0],[732,9,732,10,0],[733,13,733,38,0],[734,13,736,82,0],[737,13,739,84,0],[740,13,740,42,0],[741,9,741,10,0],[744,9,744,10,0],[745,13,745,46,0],[746,13,746,62,0],[747,13,747,62,0],[748,13,750,101,0],[752,13,752,40,0],[753,9,753,10,0],[756,9,756,10,0],[758,13,758,14,0],[759,17,759,44,0],[760,17,760,18,0],[761,21,761,58,0],[763,21,763,136,0],[765,17,765,54,0],[766,13,766,14,0],[767,13,767,33,0],[768,13,768,14,0],[769,17,769,49,0],[771,9,771,10,0],[778,9,778,10,0],[780,13,780,83,0],[783,13,783,107,0],[784,17,784,46,0],[786,13,786,14,0],[788,17,788,18,0],[789,21,789,55,0],[790,17,790,18,0],[791,17,791,37,0],[792,17,792,18,0],[793,21,793,74,0],[794,21,794,154,0],[795,17,795,18,0],[796,13,796,14,0],[797,9,797,10,0],[800,9,800,10,0],[802,13,802,82,0],[803,17,805,80,0],[807,18,808,73,0],[809,13,809,14,0],[810,17,810,66,0],[811,17,811,66,0],[812,17,812,293,0],[813,13,813,14,0],[814,9,814,10,0],[826,9,826,10,0],[828,13,828,14,0],[830,17,830,86,0],[831,17,831,18,0],[833,21,833,42,0],[834,21,834,51,0],[837,21,837,54,0],[838,21,838,66,0],[841,21,841,60,0],[842,21,842,78,0],[844,21,844,51,0],[845,21,845,52,0],[846,21,846,91,0],[847,21,847,75,0],[848,21,848,82,0],[849,21,849,86,0],[850,21,850,51,0],[851,21,851,61,0],[852,21,852,38,0],[853,21,853,77,0],[854,21,856,88,0],[857,21,857,120,0],[858,21,858,52,0],[859,21,859,53,0],[860,21,860,65,0],[862,21,862,69,0],[865,21,865,42,0],[866,25,866,153,0],[868,21,868,42,0],[869,25,869,176,0],[872,21,872,42,0],[873,25,873,69,0],[876,21,876,54,0],[877,21,877,48,0],[878,17,878,18,0],[880,22,880,132,0],[881,17,881,18,0],[882,21,882,92,0],[883,21,883,74,0],[884,21,884,84,0],[885,21,885,96,0],[887,21,887,81,0],[888,21,888,97,0],[889,21,889,115,0],[890,21,890,124,0],[893,21,893,124,0],[894,21,894,72,0],[896,21,896,98,0],[897,21,897,96,0],[898,21,898,98,0],[899,21,899,71,0],[900,25,900,190,0],[901,21,901,70,0],[902,21,902,70,0],[903,21,903,54,0],[904,17,904,18,0],[905,13,905,14,0],[906,13,906,33,0],[907,13,907,14,0],[908,17,908,49,0],[910,9,910,10,0],[916,9,916,10,0],[917,13,917,62,0],[918,13,918,72,0],[919,13,919,62,0],[922,13,922,60,0],[923,13,923,49,0],[924,13,924,14,0],[925,17,925,70,0],[926,17,926,75,0],[927,13,927,14,0],[928,13,928,59,0],[929,13,929,14,0],[930,17,930,80,0],[931,17,931,85,0],[932,13,932,14,0],[933,13,933,59,0],[934,13,934,14,0],[935,17,935,80,0],[936,17,936,85,0],[937,13,937,14,0],[938,9,938,10,0],[944,9,944,10,0],[945,13,945,71,0],[946,13,946,58,0],[947,13,947,115,0],[948,13,948,14,0],[949,17,949,98,0],[950,17,950,45,0],[951,21,951,115,0],[952,13,952,14,0],[953,9,953,10,0],[959,9,959,10,0],[960,13,960,87,0],[961,13,961,101,0],[962,13,962,91,0],[963,13,963,104,0],[964,13,964,121,0],[965,13,965,94,0],[966,13,966,92,0],[967,13,967,137,0],[968,13,968,100,0],[969,13,969,95,0],[970,13,970,91,0],[971,13,971,90,0],[972,13,972,91,0],[973,13,974,80,0],[975,13,977,115,0],[978,13,978,38,0],[979,13,979,14,0],[980,17,980,58,0],[981,17,981,101,0],[982,17,982,59,0],[983,17,983,108,0],[984,13,984,14,0],[986,13,986,14,0],[987,17,987,63,0],[988,17,988,119,0],[989,17,989,64,0],[990,17,990,109,0],[991,13,991,14,0],[992,13,992,102,0],[993,13,993,91,0],[994,13,994,102,0],[995,13,995,102,0],[996,13,996,101,0],[997,13,997,92,0],[998,13,999,88,0],[1000,13,1000,98,0],[1001,9,1001,10,0],[1008,9,1008,10,0],[1009,13,1009,37,0],[1010,13,1010,14,0],[1011,22,1011,31,0],[1011,33,1011,52,0],[1011,54,1011,57,0],[1012,17,1012,18,0],[1013,21,1013,77,0],[1014,17,1014,18,0],[1015,13,1015,14,0],[1016,9,1016,10,0],[1024,9,1024,10,0],[1025,13,1025,60,0],[1027,13,1027,35,0],[1028,17,1028,50,0],[1030,13,1030,49,0],[1031,17,1031,64,0],[1033,13,1033,39,0],[1034,17,1034,54,0],[1036,13,1036,39,0],[1037,13,1037,14,0],[1038,17,1038,68,0],[1039,17,1039,63,0],[1040,13,1040,14,0],[1042,13,1042,47,0],[1043,17,1043,85,0],[1045,13,1045,43,0],[1046,17,1046,58,0],[1048,13,1048,45,0],[1049,13,1049,14,0],[1050,17,1050,42,0],[1051,21,1051,83,0],[1053,21,1053,64,0],[1054,13,1054,14,0],[1056,13,1056,42,0],[1057,17,1057,57,0],[1059,13,1059,38,0],[1060,13,1060,14,0],[1061,17,1061,44,0],[1062,21,1062,73,0],[1063,13,1063,14,0],[1065,13,1065,14,0],[1066,17,1066,44,0],[1067,21,1067,59,0],[1068,13,1068,14,0],[1070,13,1070,37,0],[1071,17,1071,61,0],[1073,13,1073,40,0],[1074,13,1074,14,0],[1075,17,1075,120,0],[1076,17,1076,55,0],[1077,13,1077,14,0],[1079,13,1079,41,0],[1080,13,1080,14,0],[1081,17,1081,100,0],[1082,17,1082,92,0],[1083,17,1083,95,0],[1084,17,1084,56,0],[1085,13,1085,14,0],[1087,13,1087,48,0],[1088,13,1088,14,0],[1089,17,1089,78,0],[1090,17,1090,74,0],[1091,17,1091,73,0],[1092,13,1092,14,0],[1094,13,1094,46,0],[1095,17,1095,61,0],[1097,13,1097,39,0],[1098,17,1098,54,0],[1100,13,1100,38,0],[1101,17,1101,53,0],[1103,13,1103,39,0],[1104,17,1104,54,0],[1106,13,1106,50,0],[1107,17,1107,65,0],[1109,13,1109,51,0],[1110,17,1110,66,0],[1112,13,1112,42,0],[1113,17,1113,57,0],[1116,13,1116,50,0],[1117,13,1117,14,0],[1118,17,1118,92,0],[1119,17,1119,76,0],[1120,17,1120,109,0],[1121,17,1121,84,0],[1122,17,1122,75,0],[1123,17,1123,81,0],[1124,17,1124,86,0],[1125,17,1125,79,0],[1127,13,1127,14,0],[1129,13,1129,50,0],[1130,13,1130,14,0],[1131,17,1131,92,0],[1132,17,1132,76,0],[1133,17,1133,109,0],[1134,17,1134,84,0],[1135,17,1135,75,0],[1136,17,1136,80,0],[1137,17,1137,85,0],[1138,17,1138,79,0],[1140,13,1140,14,0],[1142,13,1142,49,0],[1143,13,1143,14,0],[1144,17,1144,108,0],[1145,17,1145,82,0],[1146,17,1146,74,0],[1147,17,1147,78,0],[1148,13,1148,14,0],[1150,13,1150,40,0],[1151,13,1151,14,0],[1152,17,1152,68,0],[1153,17,1153,65,0],[1154,17,1154,71,0],[1155,17,1155,76,0],[1156,17,1156,68,0],[1157,13,1157,14,0],[1159,13,1159,39,0],[1160,13,1160,14,0],[1161,17,1161,54,0],[1162,13,1162,14,0],[1164,13,1164,50,0],[1165,13,1165,14,0],[1166,17,1166,89,0],[1167,17,1167,109,0],[1168,17,1168,79,0],[1170,13,1170,14,0],[1172,13,1172,73,0],[1173,17,1173,122,0],[1175,9,1175,10,0],[1184,9,1184,10,0],[1185,18,1185,27,0],[1185,29,1185,57,0],[1185,59,1185,62,0],[1186,13,1186,14,0],[1187,17,1187,62,0],[1189,17,1189,65,0],[1190,17,1192,92,0],[1193,17,1193,63,0],[1194,17,1196,100,0],[1197,17,1199,101,0],[1200,17,1202,116,0],[1203,17,1205,110,0],[1206,17,1208,108,0],[1209,17,1211,112,0],[1212,17,1214,106,0],[1215,17,1217,102,0],[1218,17,1220,96,0],[1221,17,1223,102,0],[1225,17,1229,114,0],[1230,17,1234,100,0],[1235,17,1239,98,0],[1240,17,1244,100,0],[1245,17,1247,112,0],[1248,17,1250,112,0],[1251,17,1251,148,0],[1252,17,1254,113,0],[1255,17,1257,112,0],[1258,17,1260,101,0],[1262,17,1262,53,0],[1263,13,1263,14,0],[1264,9,1264,10,0],[1272,9,1272,10,0],[1273,13,1273,59,0],[1275,13,1275,38,0],[1277,13,1277,20,0],[1277,22,1277,37,0],[1277,38,1277,40,0],[1277,41,1277,59,0],[1278,13,1278,14,0],[1279,17,1279,42,0],[1280,17,1280,18,0],[1282,21,1282,129,0],[1283,21,1283,22,0],[1284,25,1287,115,0],[1288,25,1288,26,0],[1289,29,1289,48,0],[1290,29,1293,112,0],[1294,25,1294,26,0],[1295,21,1295,22,0],[1298,21,1298,22,0],[1299,25,1301,31,0],[1302,25,1302,26,0],[1303,29,1303,48,0],[1304,29,1305,121,0],[1306,25,1306,26,0],[1307,21,1307,22,0],[1308,17,1308,18,0],[1310,17,1310,18,0],[1311,21,1311,83,0],[1312,21,1312,22,0],[1314,25,1317,115,0],[1318,25,1318,26,0],[1319,29,1319,48,0],[1320,29,1324,112,0],[1325,25,1325,26,0],[1326,21,1326,22,0],[1329,21,1329,22,0],[1330,25,1332,45,0],[1333,25,1333,26,0],[1334,29,1334,48,0],[1335,29,1337,113,0],[1338,25,1338,26,0],[1339,21,1339,22,0],[1340,17,1340,18,0],[1341,13,1341,14,0],[1343,13,1343,20,0],[1343,22,1343,32,0],[1343,33,1343,35,0],[1343,36,1343,58,0],[1344,13,1344,14,0],[1345,17,1345,70,0],[1346,17,1346,35,0],[1347,17,1347,100,0],[1348,17,1348,63,0],[1349,17,1349,108,0],[1350,17,1350,108,0],[1351,17,1351,61,0],[1352,17,1352,58,0],[1353,17,1353,116,0],[1354,17,1354,59,0],[1355,17,1355,114,0],[1356,17,1356,55,0],[1357,17,1357,52,0],[1358,17,1358,61,0],[1358,62,1358,144,0],[1359,17,1359,62,0],[1359,63,1359,147,0],[1360,17,1360,69,0],[1360,70,1360,168,0],[1361,17,1361,72,0],[1361,73,1361,177,0],[1362,17,1362,71,0],[1362,72,1362,174,0],[1363,17,1363,52,0],[1364,17,1364,45,0],[1367,17,1367,76,0],[1370,17,1370,46,0],[1371,13,1371,14,0],[1373,13,1373,32,0],[1374,9,1374,10,0],[1381,9,1381,10,0],[1382,13,1382,58,0],[1383,13,1383,90,0],[1384,13,1384,59,0],[1385,13,1385,47,0],[1386,13,1386,102,0],[1387,13,1387,111,0],[1388,13,1390,122,0],[1391,13,1391,53,0],[1392,13,1392,46,0],[1393,13,1393,45,0],[1394,13,1394,46,0],[1395,13,1395,52,0],[1396,13,1396,44,0],[1397,13,1397,114,0],[1398,13,1400,84,0],[1401,13,1403,78,0],[1404,13,1406,80,0],[1407,13,1407,113,0],[1408,13,1408,104,0],[1410,13,1410,134,0],[1411,13,1411,134,0],[1412,13,1412,131,0],[1413,13,1413,137,0],[1414,13,1414,134,0],[1415,13,1415,103,0],[1417,13,1417,49,0],[1418,9,1418,10,0],[1429,9,1429,10,0],[1430,13,1430,45,0],[1432,13,1432,43,0],[1433,13,1433,54,0],[1434,13,1434,48,0],[1435,13,1435,58,0],[1437,13,1437,43,0],[1438,13,1438,48,0],[1439,13,1439,45,0],[1440,13,1440,58,0],[1442,13,1442,28,0],[1443,9,1443,10,0],[1450,9,1450,10,0],[1451,13,1451,45,0],[1453,13,1453,43,0],[1454,13,1454,54,0],[1455,13,1455,48,0],[1456,13,1456,58,0],[1458,13,1458,43,0],[1459,13,1459,48,0],[1460,13,1460,45,0],[1461,13,1461,58,0],[1463,13,1463,43,0],[1464,13,1464,50,0],[1465,13,1465,46,0],[1466,13,1466,58,0],[1468,13,1468,28,0],[1469,9,1469,10,0],[1477,9,1477,10,0],[1478,13,1478,70,0],[1480,13,1508,50,0],[1509,13,1509,33,0],[1510,9,1510,10,0],[1519,9,1519,10,0],[1520,13,1520,49,0],[1521,9,1521,10,0],[1525,17,1525,18,0],[1525,19,1525,48,0],[1525,49,1525,50,0],[1529,9,1529,10,0],[1530,13,1532,53,0],[1533,9,1533,10,0],[1537,17,1537,18,0],[1537,19,1537,43,0],[1537,44,1537,45,0],[1543,13,1543,14,0],[1544,17,1546,61,0],[1547,13,1547,14,0],[1550,37,1550,38,0],[1550,39,1550,61,0],[1550,62,1550,63,0],[1554,17,1554,18,0],[1554,19,1554,36,0],[1554,37,1554,38,0],[1559,17,1559,18,0],[1559,19,1559,55,0],[1564,17,1564,18,0],[1564,19,1564,53,0],[1564,54,1564,55,0],[1569,17,1569,18,0],[1569,19,1569,60,0],[1569,61,1569,62,0],[1575,9,1575,10,0],[1576,13,1578,60,0],[1579,13,1579,26,0],[1580,13,1580,39,0],[1582,13,1582,14,0],[1583,17,1583,62,0],[1585,17,1585,61,0],[1586,17,1586,45,0],[1587,17,1587,29,0],[1589,13,1589,33,0],[1590,13,1590,14,0],[1591,17,1591,70,0],[1592,17,1593,109,0],[1594,17,1594,38,0],[1595,17,1595,42,0],[1596,17,1596,30,0],[1598,9,1598,10,0],[1607,13,1607,14,0],[1608,17,1610,59,0],[1611,13,1611,14,0],[1617,13,1617,14,0],[1618,17,1618,34,0],[1619,13,1619,14,0],[1621,13,1621,14,0],[1621,15,1621,16,0],[1625,9,1625,10,0],[1625,11,1625,12,0],[1627,51,1627,55,0],[1627,56,1627,60,0],[1629,89,1629,90,0],[1629,91,1629,92,0],[1639,9,1639,36,0],[1640,9,1640,10,0],[1641,13,1641,34,0],[1642,13,1642,41,0],[1643,13,1643,42,0],[1644,13,1644,45,0],[1646,13,1646,65,0],[1647,13,1647,95,0],[1648,9,1648,10,0],[1651,9,1651,10,0],[1652,13,1652,70,0],[1653,13,1653,66,0],[1654,13,1654,70,0],[1655,13,1655,76,0],[1656,13,1656,80,0],[1658,13,1658,14,0],[1659,17,1659,45,0],[1662,25,1662,36,0],[1663,25,1663,31,0],[1665,25,1665,37,0],[1666,25,1666,31,0],[1668,25,1668,37,0],[1669,25,1669,31,0],[1671,25,1671,39,0],[1672,25,1672,31,0],[1674,25,1674,36,0],[1675,25,1675,31,0],[1677,13,1677,14,0],[1678,13,1678,33,0],[1679,13,1679,14,0],[1680,17,1680,70,0],[1681,17,1681,69,0],[1682,17,1682,49,0],[1684,9,1684,10,0],[1687,9,1687,10,0],[1688,13,1688,51,0],[1689,13,1689,55,0],[1690,13,1690,43,0],[1691,13,1691,38,0],[1692,13,1692,85,0],[1693,13,1693,88,0],[1694,13,1694,57,0],[1696,13,1696,74,0],[1698,13,1698,35,0],[1699,17,1699,138,0],[1700,18,1700,40,0],[1701,17,1702,152,0],[1704,13,1704,33,0],[1705,13,1705,14,0],[1706,17,1706,69,0],[1707,17,1707,79,0],[1708,13,1708,14,0],[1710,13,1710,14,0],[1711,17,1711,70,0],[1712,17,1712,81,0],[1713,13,1713,14,0],[1714,9,1714,10,0],[1717,9,1717,10,0],[1718,13,1718,51,0],[1719,13,1719,55,0],[1720,13,1720,47,0],[1721,13,1721,38,0],[1723,13,1723,78,0],[1725,13,1725,37,0],[1726,13,1726,14,0],[1727,17,1727,69,0],[1728,17,1728,81,0],[1729,13,1729,14,0],[1731,13,1731,14,0],[1732,17,1732,70,0],[1733,17,1733,83,0],[1734,13,1734,14,0],[1735,9,1735,10,0],[1738,9,1738,10,0],[1739,13,1739,51,0],[1740,13,1740,55,0],[1741,13,1741,44,0],[1742,13,1742,38,0],[1743,13,1743,84,0],[1744,13,1744,87,0],[1745,13,1745,56,0],[1747,13,1747,73,0],[1749,13,1749,32,0],[1750,13,1750,14,0],[1751,17,1751,69,0],[1752,17,1752,80,0],[1753,13,1753,14,0],[1755,13,1755,14,0],[1756,17,1756,70,0],[1757,17,1757,82,0],[1758,13,1758,14,0],[1759,9,1759,10,0],[1762,9,1762,10,0],[1763,13,1763,51,0],[1764,13,1764,55,0],[1765,13,1765,46,0],[1766,13,1766,38,0],[1768,13,1768,75,0],[1770,13,1770,36,0],[1771,17,1772,160,0],[1774,13,1774,34,0],[1775,13,1775,14,0],[1776,17,1776,69,0],[1777,17,1777,82,0],[1778,13,1778,14,0],[1780,13,1780,14,0],[1781,17,1781,70,0],[1782,17,1782,84,0],[1783,13,1783,14,0],[1784,9,1784,10,0],[1787,9,1787,10,0],[1788,13,1788,51,0],[1789,13,1789,55,0],[1790,13,1790,43,0],[1791,13,1791,38,0],[1793,13,1793,73,0],[1795,13,1795,32,0],[1796,13,1796,14,0],[1797,17,1797,69,0],[1798,17,1798,79,0],[1799,13,1799,14,0],[1801,13,1801,14,0],[1802,17,1802,70,0],[1803,17,1803,81,0],[1804,13,1804,14,0],[1805,9,1805,10,0]]);
    </script>
  </body>
</html>