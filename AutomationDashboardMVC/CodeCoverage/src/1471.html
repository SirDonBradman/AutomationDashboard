<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Aurigo.Workflow.Common\ExtendedStack.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;

#pragma warning disable 1591

namespace Aurigo.Common
{
    [Serializable]
    public class ExtendedStack&lt;T&gt;
    {
        protected List&lt;T&gt; _list;
        protected int _maxLength = 0;

        /// &lt;summary&gt;
        /// Maximum length of the stack
        /// &lt;/summary&gt;
        public int MaxLength
        {
            get { return _maxLength; }
            set { _maxLength = value; }
        }

        /// &lt;summary&gt;
        /// Initializes the stack
        /// &lt;/summary&gt;
        public ExtendedStack()
        {
            _list = new List&lt;T&gt;();
        }

        /// &lt;summary&gt;
        /// Total number of elements in the stack
        /// &lt;/summary&gt;
        public int Count
        {
            get { return _list.Count; }
        }

        /// &lt;summary&gt;
        /// Removes the top element from the stack
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Pop()
        {
            T topValue = default(T);
            if (_list.Count &lt; 1)
                return topValue;

            topValue = _list[_list.Count - 1];
            _list.RemoveAt(_list.Count - 1);
            return topValue;
        }

        /// &lt;summary&gt;
        /// Returns the top element from the stack. 
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T Peek()
        {
            T topValue = default(T);
            if (_list.Count &lt; 1)
                return topValue;

            topValue = _list[_list.Count - 1];
            return topValue;
        }

        /// &lt;summary&gt;
        /// Pushes a value onto the top of the stack 
        /// and removes all the excess elements (if any) 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;value&quot;&gt;Value to be pushed into the stack&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;T&gt; Push(T value)
        {
            List&lt;T&gt; removedItems = new List&lt;T&gt;();
            if (_maxLength &gt;= _list.Count &amp;&amp; _maxLength &gt; 0)
            {
                while (_list.Count &gt;= _maxLength)
                {
                    T removedItem = _list[0];
                    removedItems.Add(removedItem);
                    _list.RemoveAt(0);
                }
            }
            _list.Add(value);
            return removedItems;
        }

        /// &lt;summary&gt;
        /// Removes a particular element
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;index&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T RemoveAt(int index)
        {
            T removedItem = _list[index];
            _list.RemoveAt(index);
            return removedItem;
        }

        /// &lt;summary&gt;
        /// Removes all the elements
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public void Clear()
        {
            _list.Clear();
        }

        /// &lt;summary&gt;
        /// Converts the stack to an array
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public T[] ToArray()
        {
            return _list.ToArray();
        }

        /// &lt;summary&gt;
        /// Converts the stack to a list
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public List&lt;T&gt; ToList()
        {
            T[] refArr = new T[_list.Count];
            _list.CopyTo(refArr);
            return new List&lt;T&gt;(refArr);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,9,12,38,0],[19,17,19,18,0],[19,19,19,37,0],[19,38,19,39,0],[20,17,20,18,0],[20,19,20,38,0],[20,39,20,40,0],[26,9,26,31,0],[27,9,27,10,0],[28,13,28,35,0],[29,9,29,10,0],[36,17,36,18,0],[36,19,36,38,0],[36,39,36,40,0],[44,9,44,10,0],[45,13,45,37,0],[46,13,46,33,0],[47,17,47,33,0],[49,13,49,47,0],[50,13,50,45,0],[51,13,51,29,0],[52,9,52,10,0],[59,9,59,10,0],[60,13,60,37,0],[61,13,61,33,0],[62,17,62,33,0],[64,13,64,47,0],[65,13,65,29,0],[66,9,66,10,0],[75,9,75,10,0],[76,13,76,50,0],[77,13,77,61,0],[78,13,78,14,0],[79,17,79,50,0],[80,17,80,18,0],[81,21,81,46,0],[82,21,82,51,0],[83,21,83,39,0],[84,17,84,18,0],[85,13,85,14,0],[86,13,86,30,0],[87,13,87,33,0],[88,9,88,10,0],[96,9,96,10,0],[97,13,97,42,0],[98,13,98,35,0],[99,13,99,32,0],[100,9,100,10,0],[107,9,107,10,0],[108,13,108,27,0],[109,9,109,10,0],[116,9,116,10,0],[117,13,117,36,0],[118,9,118,10,0],[125,9,125,10,0],[126,13,126,45,0],[127,13,127,34,0],[128,13,128,40,0],[129,9,129,10,0]]);
    </script>
  </body>
</html>