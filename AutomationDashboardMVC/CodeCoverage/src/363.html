<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Work Order\ConcreateModels\WorkOrderReportModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.ContractManager.BusinessLayer.DAC;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.WORKORDBL;
using Aurigo.AMP3.WORKORDDTO;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.ModuleManagementBL;

namespace Aurigo.AMP3.WORKORDUI
{
    [ReportModelContext(Name = &quot;WORKORD&quot;, HasFilter = true, ModuleId = &quot;WORKORD&quot;)]
    public class WorkOrderReportModel : ReportModel
    {
        private readonly string equipment = LocalizationManager.GetString(KeyConstants.LOC_ICA_EQUIPMENT).ToString2();
        private readonly string manpower = LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString2();
        public string reportPathForAX = &quot;&quot;;
        public string workOrderID = &quot;&quot;;

        public override string ReportPath
        {
            get
            {
                if (ReportCode.Equals(&quot;WO&quot;))
                    return &quot;../Modules/CONTMGT/Reports/WOBudgeReport.rpx&quot;;
                else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                    return &quot;../Modules/WORKORD/WOReqForQuotReport.rpx&quot;;
                else
                    return &quot;../Modules/WORKORD/WOReport.rpx&quot;;
            }
        }

        public override string Header
        {
            get
            {
                if (ReportCode.Equals(&quot;WO&quot;))
                    return &quot;Project Budget Status Summary Report&quot;;
                else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                    return &quot;Request For Quotation Report&quot;;
                else
                    return &quot;Work Order Report&quot;;
            }
        }

        public override string ReturnURL
        {
            get
            {
                if (!string.IsNullOrEmpty(Request[&quot;MODID&quot;]) &amp;&amp; Request[&quot;MODID&quot;].Equals(&quot;WORKORD&quot;))
                    return @&quot;~/Common/BrixListPage.aspx?context=WORKORD&amp;PID=&quot; + Request[&quot;PID&quot;] + &quot;&amp;ContractID=&quot; +
                           Request[&quot;ParentID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ParentID&quot;];
                else
                    return base.ReturnURL;
            }
        }

        public string WorkOrderID
        {
            get { return workOrderID; }
            set { workOrderID = value; }
        }

        public override BrixFilter[] GetApplyFilterLabels()
        {
            string purchId = &quot;&quot;;
            BrixFilter[] flr = null;
            DataTable dtPurchId = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(Request[&quot;WOID&quot;],
                                                                                           AMP3Object.WORKORD, ParentID,
                                                                                           AMP3Object.CONTMGT,
                                                                                           RegisteredEIS.AX);
            if (dtPurchId.Rows.Count &gt; 0)
            {
                purchId = dtPurchId.Rows[0][&quot;ERPId&quot;].ToString();
                DataTable poPostingJournalID =
                    WOManager.Instance.GetAXPurchaseOrderJournals(AdditionalInfo[&quot;AXCompany&quot;].ToString(),
                                                                  Request.QueryString[WOConstants.QRY_WORKORDERID],
                                                                  Convert.ToString(ParentID));
                if (poPostingJournalID.Rows.Count &gt; 0)
                {
                    flr = new BrixFilter[2];
                    // AX Purchase Order
                    flr[0] = SetFilterAttributes(BrixFilter.Type.Text, &quot;txtAXPOID&quot;, &quot;Purchase Order:&quot;);
                    flr[0].DataTextField = purchId;
                    //AX Purchase order Posting Journals
                    flr[1] = SetFilterAttributes(BrixFilter.Type.Combo, &quot;ddlAXPOPostingIds&quot;, &quot;Purchase Order Version:&quot;);
                    var filterValues = new string[poPostingJournalID.Rows.Count + 1];
                    filterValues[0] = &quot;Select,0&quot;;
                    for (int count = 1; count &lt;= poPostingJournalID.Rows.Count; count++)
                    {
                        filterValues[count] = poPostingJournalID.Rows[count - 1][&quot;PurchOrderDocNum&quot;] + &quot;,&quot; +
                                              poPostingJournalID.Rows[count - 1][&quot;PurchOrderDocNum&quot;];
                    }
                    flr[1].DataSource = GetComboDataSourceWithValues(filterValues);
                }
            }
            return flr;
        }

        public override Report GetReportObject(Dictionary&lt;string, string&gt; dicFilter)
        {
            if (ReportCode.Equals(&quot;WO&quot;))
                return GetProjectBudgetSummaryReport(dicFilter);
            else if (ReportCode.Equals(&quot;REQFORQUOT&quot;))
                return GetRequestForQuotationReport(dicFilter);
            else
                return GetWorkOrderReport(dicFilter);
        }

        private Report GetProjectBudgetSummaryReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            Report[] subrpt;
            repObj.ReportPath = ReportPath;
            Report.RptControl[] rptctl;
            string path;

            subrpt = new Report[2];

            var subrptctl_0 = new Report.RptControl[6];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Date, ControlType.TextBox,
                                                        StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            path = &quot;../Modules/CONTMGT/Reports/subReportWO.rpx&quot;;
            subrpt[0] = SetSubReportAttributes(&quot;WOsHeader&quot;, &quot;subWorkOrders&quot;, subrptctl_0, path);
            subrpt[0].DataSource = ContMgtComponent.Instance.GetPBSSSubReport1(ParentID.ToInt32_2());

            var subrptctl_1 = new Report.RptControl[6];
            subrptctl_1[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox2&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_1[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);

            path = &quot;../Modules/CONTMGT/Reports/subReportGroups.rpx&quot;;
            subrpt[1] = SetSubReportAttributes(&quot;BudgetHeader&quot;, &quot;subGroupEstimate&quot;, subrptctl_1, path);
            subrpt[1].DataSource = ContMgtComponent.Instance.GetPBSSSubReport2(ParentID.ToInt32_2());

            rptctl = new Report.RptControl[32];
            rptctl[0] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox1&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[1] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox2&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[2] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox3&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox5&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[5] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[6] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.Header);         
            rptctl[7] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name&quot;, FormatType.None, ControlType.Label,
                                                  StyleType.HeaderDetails);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[11] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.Caption);
            rptctl[12] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label3&quot;, ControlType.Label, StyleType.Caption);
            rptctl[13] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label4&quot;, ControlType.Label, StyleType.Caption);
            rptctl[14] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label5&quot;, ControlType.Label, StyleType.Caption);
            rptctl[15] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Caption);
            rptctl[16] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label7&quot;, ControlType.Label, StyleType.Caption);
            rptctl[17] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);
            rptctl[18] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.Caption);
            rptctl[19] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label10&quot;, ControlType.Label, StyleType.Caption);
            rptctl[20] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);         
            rptctl[21] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label12&quot;, LocalizationManager.GetString(&quot;Contract&quot;), FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label13&quot;, ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;BudgetHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;SummaryHeader&quot;, &quot;Label14&quot;, ControlType.Label, StyleType.Caption);
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);           
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[31] = SetReportControlAttributes(&quot;WOsHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.Caption);

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = ContMgtComponent.Instance.GetPBSSReport(ParentID.ToInt32_2());
            return repObj;
        }

        internal Report GetWorkOrderReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            var dt = new DataTable();
            if (!string.IsNullOrEmpty(reportPathForAX))
                repObj.ReportPath = reportPathForAX;
            else
                repObj.ReportPath = ReportPath;
            Report.RptControl[] rptctl;
            string path;
            int subRptCount = 1;
            if (string.IsNullOrEmpty(workOrderID) &amp;&amp;
                !string.IsNullOrEmpty(Request.QueryString[WOConstants.QRY_WORKORDERID]))
            {
                workOrderID = Request.QueryString[WOConstants.QRY_WORKORDERID];
            }

            DataTable dtWOData = WORKORDManager.Instance.GetWOMainReport(ParentID.ToInt32_2(), workOrderID.ToInt32_2());
            if (dtWOData.Rows.Count &gt; 0 &amp;&amp; dtWOData.Rows[0][&quot;Status&quot;].ToString().Equals(&quot;Issued&quot;))
            {
                dt = GetTaxesDataTable(dicFilter);
                if (dt.Rows.Count &gt; 0)
                    subRptCount++;
            }

            List&lt;string&gt; coreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            
            
            var subrpt = new Report[subRptCount];
            subRptCount = 0;
            var subrptctl_0 = new Report.RptControl[7];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox5&quot;, null, FormatType.UnitPrice,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox6&quot;, null, FormatType.Amount,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, null, FormatType.Quantity,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtContractor&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[5] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[6] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            path = &quot;../Modules/WORKORD/WOItems.rpx&quot;;
            subrpt[subRptCount] = SetSubReportAttributes(&quot;GrpHeader&quot;, &quot;subRptItems&quot;, subrptctl_0, path);
            subrpt[subRptCount].DataSource = WORKORDManager.Instance.GetWOSubReport(workOrderID.ToInt32_2(),
                                                                                    ParentID.ToInt32_2());
            subRptCount++;

            rptctl = new Report.RptControl[68];
            rptctl[0] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, null, FormatType.Amount, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[1] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label7&quot;, PayItemNoAbbr, FormatType.None,
                                                   ControlType.Label, StyleType.Caption);
            rptctl[2] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtEndDate&quot;, null, FormatType.Date, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtStartDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[5] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblIssuedDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[6] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[7] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Header);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, ControlType.Label,
                                                   StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[11] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[12] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label3&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[13] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label4&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[14] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label5&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[15] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[16] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[17] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[17] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[18] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[19] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label21&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[20] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label22&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[21] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label12&quot;, ControlType.Label, StyleType.Caption);
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label10&quot;, ControlType.Label, StyleType.Caption);
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label13&quot;, ControlType.Label, StyleType.Caption);
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label14&quot;, ControlType.Label, StyleType.Caption);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtProjectInspector&quot;, ControlType.TextBox,
                                                    StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtWorkDate&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[31] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[32] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[33] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[33] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[34] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblStatus&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[35] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[36] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label23&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[37] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label24&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[38] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label25&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[39] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[40] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox5&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[41] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox6&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[42] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox7&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[43] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label26&quot;, &quot;No &quot; + ItemNameAbbr + &quot;s exist&quot;,
                                                    FormatType.None, ControlType.Label, StyleType.Detail);
            rptctl[44] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[45] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label27&quot;, ControlType.Label, StyleType.HeaderDetails); 
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[46] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[46] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot; With &quot; + LocalizationManager.GetString(manpower), FormatType.None,
                                                        ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[47] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label29&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[47] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label29&quot;, &quot; With &quot; + LocalizationManager.GetString(equipment), FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[48] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[48] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, ControlType.TextBox, StyleType.Detail);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[49] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox10&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[49] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox10&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[50] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblMaxPrepaymentValue&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[51] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtMaxPrepaymentValue&quot;, null, FormatType.Amount,
                                                    ControlType.TextBox, StyleType.Detail);
            rptctl[52] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionPercentagePerRABill&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[53] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionPercentagePerRABill&quot;, null,
                                                    FormatType.Quantity, ControlType.TextBox, StyleType.Detail);
            rptctl[54] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionCeilingPercentage&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[55] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionCeilingPercentage&quot;, null,
                                                    FormatType.Quantity, ControlType.TextBox, StyleType.Detail);
            rptctl[56] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionCeilingAmount&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[57] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionCeilingAmount&quot;, null, FormatType.Amount,
                                                    ControlType.TextBox, StyleType.Detail);
            rptctl[58] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblRetentionReleaseDate&quot;, ControlType.Label,
                                                    StyleType.Caption);
            rptctl[59] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtRetentionReleaseDate&quot;, null, FormatType.Date,
                                                    ControlType.TextBox, StyleType.Detail);

            rptctl[60] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblPreparedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[61] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtPreparedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[62] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblApprovedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[63] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtApprovedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[64] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;lblIssuedBy&quot;, ControlType.Label, StyleType.Caption);
            rptctl[65] = SetReportControlAttributes(&quot;ReportFooter&quot;, &quot;txtIssuedBy&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[66] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblExtReference&quot;, ControlType.Label, StyleType.Caption);
            rptctl[67] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtExtReference&quot;, ControlType.TextBox, StyleType.Detail);

            # region Work Order Taxes from Supreme            

            if (dt.Rows.Count &gt; 0 &amp;&amp; dtWOData.Rows.Count &gt; 0)
            {
                var woTaxesrpt1_0 = new Report.RptControl[13];
                woTaxesrpt1_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxCode&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxBaseAmount&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAXTaxAmount&quot;, null, FormatType.Amount,
                                                              ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[3] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxCode&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[4] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxBaseAmount&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[5] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblAXTaxAmount&quot;, ControlType.TextBox,
                                                              StyleType.Caption);
                woTaxesrpt1_0[6] = SetReportControlAttributes(&quot;GroupHeader1&quot;, &quot;lblTaxCaption&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[7] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalAXTaxAmount&quot;, null,
                                                              FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[8] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalAXTaxAmount&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[9] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalWOAmount&quot;, ControlType.Label,
                                                              StyleType.Caption);
                woTaxesrpt1_0[10] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalWOAmount&quot;, null,
                                                               FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                woTaxesrpt1_0[11] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;lblTotalAmountInclTax&quot;,
                                                               ControlType.Label, StyleType.Caption);
                woTaxesrpt1_0[12] = SetReportControlAttributes(&quot;GroupFooter1&quot;, &quot;txtTotalAmountInclTax&quot;, null,
                                                               FormatType.Amount, ControlType.TextBox, StyleType.Detail);
                path = &quot;../Modules/WORKORD/AXWOTaxes.rpx&quot;;
                subrpt[subRptCount] = SetSubReportAttributes(&quot;ReportFooter&quot;, &quot;subWOAXTaxes&quot;, woTaxesrpt1_0, path);
                dt.Columns.Add(&quot;WOAmount&quot;, typeof (Double));
                dt.Columns.Add(&quot;TotalAmount&quot;, typeof (Double));

                string amount =
                    Convert.ToDecimal(dt.Compute(&quot;sum(SourceTaxAmountCur)&quot;, &quot;&quot;)).ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                                                                                          CultureInfo.CurrentCulture);
                foreach (DataRow dr in dt.Rows)
                {
                    dr[&quot;TotalAmount&quot;] = Convert.ToDouble(amount) + Convert.ToDouble(dtWOData.Rows[0][&quot;EstimatedValue&quot;]);
                    dr[&quot;WOAmount&quot;] = Convert.ToDouble(dtWOData.Rows[0][&quot;EstimatedValue&quot;]);
                }
                subrpt[subRptCount].DataSource = dt;
            }

            # endregion

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = dtWOData;
            return repObj;
        }

        public DataTable GetTaxesDataTable(Dictionary&lt;string, string&gt; dicFilter)
        {
            var dtWOTaxes = new DataTable();
            if (dicFilter != null)
            {
                if (dicFilter.ContainsKey(&quot;ddlAXPOPostingIds&quot;))
                {
                    string POJournalID = Convert.ToString(dicFilter[&quot;ddlAXPOPostingIds&quot;], CultureInfo.CurrentCulture);
                    if (!POJournalID.Equals(&quot;Select&quot;))
                    {
                        DataTable dtPurchId = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(workOrderID,
                                                                                                       AMP3Object.
                                                                                                           WORKORD,
                                                                                                       ParentID,
                                                                                                       AMP3Object.
                                                                                                           CONTMGT,
                                                                                                       RegisteredEIS.AX);
                        string POID = &quot;&quot;;
                        if (dtPurchId.Rows.Count &gt; 0)
                        {
                            POID = dtPurchId.Rows[0][&quot;ERPId&quot;].ToString();
                        }

                        dtWOTaxes = WOManager.Instance.GetTaxes(AdditionalInfo[&quot;AXCompany&quot;].ToString(), POID,
                                                                POJournalID, Convert.ToString(ParentID));
                    }
                    else
                        return dtWOTaxes;
                }
            }
            else
                return dtWOTaxes;

            return dtWOTaxes;
        }

        private Report GetRequestForQuotationReport(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            Report[] subrpt;

            repObj.ReportPath = ReportPath;
            Report.RptControl[] rptctl;
            string path;

            subrpt = new Report[1];
            var subrptctl_0 = new Report.RptControl[5];
            subrptctl_0[0] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox4&quot;, null, FormatType.Quantity,
                                                        ControlType.TextBox, StyleType.Detail);
            subrptctl_0[1] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtContractor&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[2] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[3] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            subrptctl_0[4] = SetReportControlAttributes(&quot;Detail&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            path = &quot;../Modules/WORKORD/WOReqForQuotItems.rpx&quot;;
            subrpt[0] = SetSubReportAttributes(&quot;GrpHeader&quot;, &quot;subRptItems&quot;, subrptctl_0, path);
            subrpt[0].DataSource =
                WORKORDManager.Instance.GetWOSubReport(Request.QueryString[WOConstants.QRY_WORKORDERID].ToInt32_2(),
                                                       ParentID.ToInt32_2());

            List&lt;string&gt; coreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);

            rptctl = new Report.RptControl[45];
            rptctl[0] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label7&quot;, PayItemNoAbbr, FormatType.None,
                                                   ControlType.Label, StyleType.Caption);
            rptctl[1] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtEndDate&quot;, null, FormatType.Date, ControlType.TextBox,
                                                   StyleType.Detail);
            rptctl[2] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtStartDate&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtPrimeContractor&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblHeader&quot;, ControlType.Label, StyleType.Header);
            rptctl[5] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label6&quot;, ControlType.Label, StyleType.Header);
            rptctl[6] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;lblProjNamePg2&quot;, ControlType.Label,
                                                   StyleType.HeaderDetails);
            rptctl[7] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[8] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[9] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label2&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[10] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label15&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[11] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label18&quot;, ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[12] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[12] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label19&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[13] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[14] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label21&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[15] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label22&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[16] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label11&quot;, ControlType.Label, StyleType.Caption);
            rptctl[17] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label17&quot;, ControlType.Label, StyleType.Caption);
            rptctl[18] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label8&quot;, ControlType.Label, StyleType.Caption);           
            rptctl[19] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label10&quot;, LocalizationManager.GetString(&quot;Unit&quot;), FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[20] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label12&quot;, ControlType.Label, StyleType.Caption);
            rptctl[21] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label13&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Unit Cost&quot;, false),
                                                    FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[22] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label14&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Amount&quot;, false), FormatType.None,
                                                    ControlType.Label, StyleType.Caption);
            rptctl[23] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label3&quot;,
                                                    GlobalizationUtility.SetResource(&quot;Total Amount&quot;, false),
                                                    FormatType.None, ControlType.Label, StyleType.Caption);
            rptctl[24] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[25] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtProjectInspector&quot;, ControlType.TextBox,
                                                    StyleType.Detail);
            rptctl[26] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;txtWorkDate&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[27] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[28] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox2&quot;, ControlType.TextBox, StyleType.Detail);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[29] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox3&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[30] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label9&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[31] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label23&quot;, ControlType.Label, StyleType.HeaderDetails);            
            rptctl[32] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label24&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);          
            rptctl[33] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label25&quot;, &quot; &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[34] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[35] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox5&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[36] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox6&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[37] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox7&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[38] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label26&quot;, &quot;No &quot; + ItemNameAbbr + &quot;s exist&quot;,
                                                    FormatType.None, ControlType.Label, StyleType.Detail);
            rptctl[39] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox8&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            rptctl[40] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label27&quot;, ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[41] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label5&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[41] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label5&quot;, &quot; With &quot; + LocalizationManager.GetString(manpower), FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[42] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot;&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails, false);
            else
                rptctl[42] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;Label28&quot;, &quot; With &quot; + equipment, FormatType.None,
                                                    ControlType.Label, StyleType.HeaderDetails);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[43] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[43] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox9&quot;, ControlType.TextBox, StyleType.Detail);
            if (!coreComponents.Contains(&quot;RateAnalysis&quot;))
                rptctl[44] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, &quot;&quot;, FormatType.None, ControlType.TextBox, StyleType.Detail, false);
            else
                rptctl[44] = SetReportControlAttributes(&quot;GrpHeader&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);

            repObj.RptControls = rptctl;
            repObj.SubReports = subrpt;
            repObj.DataSource = WORKORDManager.Instance.GetWOMainReport(ParentID.ToInt32_2(),
                                                                        Request.QueryString[WOConstants.QRY_WORKORDERID]
                                                                            .ToInt32_2());
            return repObj;
        }


        public DataTable GetComboDataSourceWithValues(string[] values)
        {
            DataTable dtTemp = new BrixDataTable();
            dtTemp.Columns.Add(&quot;Value&quot;);
            dtTemp.Columns.Add(&quot;Name&quot;);
            dtTemp.AcceptChanges();

            foreach (string value in values)
            {
                DataRow dr = dtTemp.NewRow();
                dr[0] = value.Split(&#39;,&#39;)[1];
                dr[1] = value.Split(&#39;,&#39;)[0];
                dtTemp.Rows.Add(dr);
            }
            return dtTemp;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,22,119,0],[23,9,23,117,0],[24,9,24,44,0],[25,9,25,40,0],[30,13,30,14,0],[31,17,31,45,0],[32,21,32,75,0],[33,22,33,58,0],[34,21,34,72,0],[36,21,36,62,0],[37,13,37,14,0],[43,13,43,14,0],[44,17,44,45,0],[45,21,45,67,0],[46,22,46,58,0],[47,21,47,59,0],[49,21,49,48,0],[50,13,50,14,0],[56,13,56,14,0],[57,17,57,99,0],[58,21,59,85,0],[61,21,61,43,0],[62,13,62,14,0],[67,17,67,18,0],[67,19,67,38,0],[67,39,67,40,0],[68,17,68,18,0],[68,19,68,39,0],[68,40,68,41,0],[72,9,72,10,0],[73,13,73,33,0],[74,13,74,37,0],[75,13,78,110,0],[79,13,79,42,0],[80,13,80,14,0],[81,17,81,65,0],[82,17,85,95,0],[86,17,86,55,0],[87,17,87,18,0],[88,21,88,45,0],[90,21,90,104,0],[91,21,91,52,0],[93,21,93,121,0],[94,21,94,86,0],[95,21,95,50,0],[96,26,96,39,0],[96,41,96,79,0],[96,81,96,88,0],[97,21,97,22,0],[98,25,99,102,0],[100,21,100,22,0],[101,21,101,84,0],[102,17,102,18,0],[103,13,103,14,0],[104,13,104,24,0],[105,9,105,10,0],[108,9,108,10,0],[109,13,109,41,0],[110,17,110,65,0],[111,18,111,54,0],[112,17,112,64,0],[114,17,114,54,0],[115,9,115,10,0],[118,9,118,10,0],[119,13,119,39,0],[121,13,121,44,0],[125,13,125,36,0],[127,13,127,56,0],[128,13,129,96,0],[130,13,131,75,0],[132,13,132,118,0],[133,13,133,118,0],[134,13,134,118,0],[135,13,135,117,0],[136,13,136,65,0],[137,13,137,97,0],[138,13,138,102,0],[140,13,140,56,0],[141,13,142,96,0],[143,13,144,96,0],[145,13,146,96,0],[147,13,148,96,0],[149,13,150,96,0],[151,13,151,117,0],[153,13,153,69,0],[154,13,154,103,0],[155,13,155,102,0],[157,13,157,48,0],[158,13,159,91,0],[160,13,161,91,0],[162,13,163,91,0],[164,13,165,91,0],[166,13,167,91,0],[168,13,168,118,0],[169,13,169,114,0],[170,13,171,76,0],[172,13,172,118,0],[173,13,174,70,0],[175,13,175,120,0],[176,13,176,114,0],[177,13,177,114,0],[178,13,178,114,0],[179,13,179,114,0],[180,13,180,114,0],[181,13,181,117,0],[182,13,182,117,0],[183,13,183,117,0],[184,13,184,118,0],[185,13,185,118,0],[186,13,186,178,0],[187,13,187,118,0],[188,13,188,118,0],[189,13,189,119,0],[190,13,190,121,0],[191,13,191,120,0],[192,13,192,196,0],[193,13,193,117,0],[194,13,194,116,0],[195,13,195,117,0],[196,13,196,115,0],[198,13,198,41,0],[199,13,199,40,0],[200,13,200,95,0],[201,13,201,27,0],[202,9,202,10,0],[205,9,205,10,0],[206,13,206,39,0],[207,13,207,38,0],[208,13,208,56,0],[209,17,209,53,0],[211,17,211,48,0],[214,13,214,33,0],[215,13,216,89,0],[217,13,217,14,0],[218,17,218,80,0],[219,13,219,14,0],[221,13,221,121,0],[222,13,222,99,0],[223,13,223,14,0],[224,17,224,51,0],[225,17,225,39,0],[226,21,226,35,0],[227,13,227,14,0],[229,13,229,109,0],[232,13,232,50,0],[233,13,233,29,0],[234,13,234,56,0],[235,13,236,96,0],[237,13,238,96,0],[239,13,240,96,0],[241,13,241,123,0],[242,13,242,117,0],[243,13,243,118,0],[244,13,244,118,0],[245,13,245,53,0],[246,13,246,105,0],[247,13,248,107,0],[249,13,249,27,0],[251,13,251,48,0],[252,13,253,70,0],[254,13,255,90,0],[256,13,257,70,0],[258,13,259,91,0],[260,13,261,91,0],[262,13,263,91,0],[264,13,264,118,0],[265,13,265,113,0],[266,13,267,77,0],[268,13,268,118,0],[269,13,269,120,0],[270,13,270,120,0],[271,13,271,120,0],[272,13,272,120,0],[273,13,273,120,0],[274,13,274,121,0],[275,13,275,121,0],[276,13,276,58,0],[277,17,277,153,0],[279,17,279,125,0],[280,13,280,121,0],[281,13,281,121,0],[282,13,282,121,0],[283,13,283,115,0],[284,13,284,115,0],[285,13,285,114,0],[286,13,286,115,0],[287,13,287,115,0],[288,13,288,115,0],[289,13,289,115,0],[290,13,290,120,0],[291,13,292,71,0],[293,13,293,120,0],[294,13,294,117,0],[295,13,295,117,0],[296,13,296,58,0],[297,17,297,149,0],[299,17,299,121,0],[300,13,300,118,0],[301,13,301,120,0],[302,13,302,121,0],[303,13,303,121,0],[304,13,304,121,0],[305,13,305,117,0],[306,13,306,117,0],[307,13,307,117,0],[308,13,308,117,0],[309,13,310,107,0],[311,13,311,117,0],[312,13,312,121,0],[313,13,313,58,0],[314,17,314,153,0],[316,17,317,101,0],[318,13,318,58,0],[319,17,319,153,0],[321,17,322,97,0],[323,13,323,58,0],[324,17,324,149,0],[326,17,326,121,0],[327,13,327,58,0],[328,17,328,150,0],[330,17,330,122,0],[331,13,332,72,0],[333,13,334,92,0],[335,13,336,72,0],[337,13,338,113,0],[339,13,340,72,0],[341,13,342,113,0],[343,13,344,72,0],[345,13,346,92,0],[347,13,348,72,0],[349,13,350,92,0],[352,13,352,124,0],[353,13,353,125,0],[354,13,354,124,0],[355,13,355,125,0],[356,13,356,122,0],[357,13,357,123,0],[358,13,358,123,0],[359,13,359,124,0],[363,13,363,62,0],[364,13,364,14,0],[365,17,365,63,0],[366,17,367,102,0],[368,17,369,102,0],[370,17,371,102,0],[372,17,373,82,0],[374,17,375,82,0],[376,17,377,82,0],[378,17,379,82,0],[380,17,381,121,0],[382,17,383,82,0],[384,17,385,82,0],[386,17,387,122,0],[388,17,389,102,0],[390,17,391,122,0],[392,17,392,59,0],[393,17,393,115,0],[394,17,394,61,0],[395,17,395,64,0],[397,17,399,119,0],[400,17,400,24,0],[400,26,400,36,0],[400,37,400,39,0],[400,40,400,47,0],[401,17,401,18,0],[402,21,402,121,0],[403,21,403,91,0],[404,17,404,18,0],[405,17,405,53,0],[406,13,406,14,0],[410,13,410,41,0],[411,13,411,40,0],[412,13,412,42,0],[413,13,413,27,0],[414,9,414,10,0],[417,9,417,10,0],[418,13,418,45,0],[419,13,419,35,0],[420,13,420,14,0],[421,17,421,64,0],[422,17,422,18,0],[423,21,423,119,0],[424,21,424,55,0],[425,21,425,22,0],[426,25,432,122,0],[433,25,433,42,0],[434,25,434,54,0],[435,25,435,26,0],[436,29,436,74,0],[437,25,437,26,0],[439,25,440,106,0],[441,21,441,22,0],[443,25,443,42,0],[444,17,444,18,0],[445,13,445,14,0],[447,17,447,34,0],[449,13,449,30,0],[450,9,450,10,0],[453,9,453,10,0],[454,13,454,39,0],[457,13,457,44,0],[461,13,461,36,0],[462,13,462,56,0],[463,13,464,96,0],[465,13,465,123,0],[466,13,466,117,0],[467,13,467,118,0],[468,13,468,118,0],[469,13,469,63,0],[470,13,470,95,0],[471,13,473,78,0],[475,13,475,109,0],[477,13,477,48,0],[478,13,479,90,0],[480,13,481,70,0],[482,13,483,91,0],[484,13,485,91,0],[486,13,486,118,0],[487,13,487,113,0],[488,13,489,77,0],[490,13,490,118,0],[491,13,491,119,0],[492,13,492,119,0],[493,13,493,121,0],[494,13,494,121,0],[495,13,495,58,0],[496,17,496,153,0],[498,17,498,125,0],[499,13,499,121,0],[500,13,500,121,0],[501,13,501,121,0],[502,13,502,115,0],[503,13,503,115,0],[504,13,504,114,0],[505,13,505,171,0],[506,13,506,115,0],[507,13,509,108,0],[510,13,512,91,0],[513,13,515,108,0],[516,13,516,120,0],[517,13,518,71,0],[519,13,519,120,0],[520,13,520,117,0],[521,13,521,117,0],[522,13,522,58,0],[523,17,523,149,0],[525,17,525,121,0],[526,13,526,120,0],[527,13,527,121,0],[528,13,528,197,0],[529,13,529,197,0],[530,13,530,117,0],[531,13,531,117,0],[532,13,532,117,0],[533,13,533,117,0],[534,13,535,107,0],[536,13,536,145,0],[537,13,537,121,0],[538,13,538,58,0],[539,17,539,152,0],[541,17,542,97,0],[543,13,543,58,0],[544,17,544,153,0],[546,17,547,97,0],[548,13,548,58,0],[549,17,549,149,0],[551,17,551,121,0],[552,13,552,58,0],[553,17,553,148,0],[555,17,555,120,0],[557,13,557,41,0],[558,13,558,40,0],[559,13,561,91,0],[562,13,562,27,0],[563,9,563,10,0],[567,9,567,10,0],[568,13,568,52,0],[569,13,569,41,0],[570,13,570,40,0],[571,13,571,36,0],[573,13,573,20,0],[573,22,573,34,0],[573,35,573,37,0],[573,38,573,44,0],[574,13,574,14,0],[575,17,575,46,0],[576,17,576,45,0],[577,17,577,45,0],[578,17,578,37,0],[579,13,579,14,0],[580,13,580,27,0],[581,9,581,10,0]]);
    </script>
  </body>
</html>