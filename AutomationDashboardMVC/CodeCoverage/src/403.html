<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Estimator\BusinessLayer\BL\EstimateManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Text;
using System.Web;
using System.Web.Configuration;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.BusinessLayer.BL;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.EstimatorDAC;
using Aurigo.AMP3.EstimatorDTO;
using Aurigo.AMP3.LibraryBL;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Construction.Estimator.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using DataDynamics.ActiveReports;
using DataDynamics.ActiveReports.Export.Pdf;
using Image = System.Drawing.Image;
using System.Web.UI;
using System.Configuration;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.AMP3.ProjectBL;

namespace Aurigo.AMP3.EstimatorBL
{
    public class EstimateManager : IReports, IXmlTree
    {
        public const string MODID_ESTIMATOR = &quot;ESTMATE&quot;;
        public const string MODSUBMTAL = &quot;SUBMTAL&quot;;
        private const string estimatesRelPath = &quot;~/Modules/ESTMATE/&quot;;
        private const string submittalRelPath = &quot;~/Modules/SUBMTAL/&quot;;
        private const string IMGPATHCATEGORY = &quot;~/Images/IcnFolder.gif&quot;;
        private const string IMGPATHCATALOG = &quot;~/Images/IcnPage.gif&quot;;

        public const string SendAddIssuedEmail = &quot;SENDADDENDUMISSUEDEMAIL&quot;;
        public const string SendInviteEmail = &quot;SENDINVITEEMAIL&quot;;

        private static volatile Dictionary&lt;string, EstimateManager&gt; _Inst = null;
        private static readonly object _oSync = new object();
        public static EstimateManager Instance
        {
            get
            {
                lock (_oSync)
                {
                    if (_Inst == null) _Inst = new Dictionary&lt;string, EstimateManager&gt;();
                    string currentCompany = ConnectionHelper.GetCurrentCompany();
                    if (!_Inst.ContainsKey(currentCompany))
                        _Inst.Add(currentCompany, new EstimateManager());

                    return _Inst[currentCompany];
                }
            }
        }

        private DataSet dsCSInfo = new BrixDataSet();
        private string rPath = string.Empty;

        public EstimateManager()
        {

        }

        #region IReports Members

        public Dictionary&lt;string, ReportType&gt; GetReportList()
        {
            var reportNames = new Dictionary&lt;string, ReportType&gt;();
            reportNames.Add(&quot;Submittal Status&quot;, ReportType.PDF);
            return reportNames;
        }

        public MemoryStream GetReportStream(string reportName, string appPath, object[] parameters)
        {
            try
            {
                MemoryStream pdfStream = null;
                pdfStream = GetPdfStream(reportName, appPath, parameters);
                return pdfStream;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, &quot;Error generating Report :&quot; + ex.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        public string PostBackPage(string reportName)
        {
            return string.Empty;
        }

        #endregion

        #region IXmlTree Members

        public virtual TNode GetXmlForTree(int projectID, int uid, int roleID, string platformKey)
        {
            DataTable dtEstimates = EstimateComponent.Instance.GetEstimates(projectID, false, 0, null);
            List&lt;string&gt; permissionsForSubmittal = ModuleManager.Instance.GetPermissionByUserOrRole(&quot;SUBESTL&quot;, uid, roleID, projectID);
            List&lt;string&gt; permissionsForChecklist = ModuleManager.Instance.GetPermissionByUserOrRole(&quot;CHKESTL&quot;, uid, roleID, projectID);
            List&lt;string&gt; Modcomponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CONTMGT);
            List&lt;string&gt; estimateComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_ESTMATE);

            const string PID = &quot;PID&quot;;

            string strQry = &quot;?&quot; + PID + &quot;=&quot; + projectID.ToString2();

            var tree = new TNode();

            string projectEstimateID = String.Empty;

            bool sameProject = false;
            if (HttpContext.Current.Session[&quot;WorkingEstimate&quot;] != null)
            {
                int sessionProjectID =
                    EstimateComponent.Instance.GetProjectID(HttpContext.Current.Session[&quot;WorkingEstimate&quot;].ToInt32_2());

                sameProject = (projectID == sessionProjectID) ? true : false;

                if (!sameProject)
                {
                    HttpContext.Current.Session.Remove(&quot;WorkingEstimate&quot;);
                    HttpContext.Current.Session.Remove(&quot;ProjectEstimateID&quot;);
                }
            }


            if (dtEstimates.Rows.Count &gt; 0)
            {
                if (sameProject &amp;&amp; AMP3ApplicationSettings.Instance.IsSingleProjectMode &amp;&amp; HttpContext.Current.Session[&quot;WorkingEstimate&quot;] != null)
                    projectEstimateID = HttpContext.Current.Session[&quot;WorkingEstimate&quot;].ToString2();
                else
                    projectEstimateID = dtEstimates.Rows[0][&quot;ProjectEstimateId&quot;].ToString2();
            }
            else
            {
                HttpContext.Current.Session.Remove(&quot;ProjectEstimateID&quot;);
            }

            string targetURL = (!AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                                   ? &quot;~/Common/BrixListPage.aspx&quot; + strQry + &quot;&amp;Context=ESTMATE&quot;
                                   : ((dtEstimates.Rows.Count &lt;= 0)
                                          ? &quot;~/Modules/ESTMATE/NewEstimate.aspx&quot; + strQry
                                          : &quot;~/Modules/ESTMATE/EstimateDetails.aspx&quot; + strQry +
                                            &quot;&amp;ProjectEstimateID=&quot; +
                                            projectEstimateID);

            var estimatesNode = new TNode(LocalizationManager.GetString(&quot;Bid Estimate Information&quot;), targetURL, useHtmlEncoding: true);
            tree.Nodes.Add(estimatesNode);


            estimatesNode.Nodes.Add(new TNode(&quot;Unit Price Search&quot;,
                                              &quot;~/Modules/ESTMATE/UnitPriceSearch.aspx&quot; + strQry + &quot;&amp;Context=ESTMATE&quot;, useHtmlEncoding: true));

            int colProjectEstimateId = dtEstimates.Columns.IndexOf(&quot;ProjectEstimateId&quot;);
            int currentProjectEstimateId = 0;

            if (AMP3ApplicationSettings.Instance.ESTMATELoadTreeOnDemand)
            {
                HttpRequest request = ((Page)HttpContext.Current.Handler).Request;

                if ((string.IsNullOrEmpty(request[&quot;context&quot;]) || !request[&quot;context&quot;].ToLower().Equals(&quot;contmgt&quot;)) &amp;&amp;
                    (string.IsNullOrEmpty(request[&quot;link&quot;]) || !request[&quot;link&quot;].ToLower().Equals(&quot;contmgt&quot;)) &amp;&amp;
                    (string.IsNullOrEmpty(request[&quot;code&quot;]) || !request[&quot;code&quot;].ToLower().Equals(&quot;contmgt&quot;)) &amp;&amp;
                    (string.IsNullOrEmpty(request[&quot;modid&quot;]) || !request[&quot;modid&quot;].ToLower().Equals(&quot;contmgt&quot;)))
                {
                    if (!string.IsNullOrEmpty(request[&quot;projectestimateID&quot;]))
                        int.TryParse(request[&quot;projectestimateID&quot;], out currentProjectEstimateId);
                    else if (!string.IsNullOrEmpty(request[&quot;mid&quot;]) &amp;&amp; request[&quot;mid&quot;].ToLower().Equals(&quot;estmate&quot;))
                        int.TryParse(request[&quot;iid&quot;], out currentProjectEstimateId);
                    else if (!string.IsNullOrEmpty(request[&quot;link&quot;]) &amp;&amp; request[&quot;link&quot;].ToLower().Equals(&quot;estmate&quot;))
                        int.TryParse(request[&quot;linkid&quot;], out currentProjectEstimateId);
                    else if (!string.IsNullOrEmpty(request[&quot;context&quot;]) &amp;&amp; request[&quot;context&quot;].ToLower().Equals(&quot;estmate&quot;))
                    {
                        int.TryParse(request[&quot;parent&quot;], out currentProjectEstimateId);
                        if (currentProjectEstimateId == 0) int.TryParse(request[&quot;parentid&quot;], out currentProjectEstimateId);
                    }
                    else
                        int.TryParse(request[&quot;parentid&quot;], out currentProjectEstimateId);
                }
            }
            // add all the xmlform nodes here to this estimateinstance ID
            DataTable dtAllModules = ModuleManager.Instance.GetModules();

            Dictionary&lt;string, string&gt; activeModulesForEstimate = ModuleManager.Instance.GetModuleListByParent(&quot;ESTMATE&quot;, true);
            foreach (DataRow row in dtEstimates.Rows)
            {
                int estimateid = 0;
                int.TryParse(row[colProjectEstimateId].ToString2(), out estimateid);
                if (sameProject &amp;&amp; AMP3ApplicationSettings.Instance.IsSingleProjectMode &amp;&amp; HttpContext.Current.Session[&quot;WorkingEstimate&quot;] != null)
                {
                    strQry = &quot;?&quot; + PID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;ProjectEstimateID=&quot; +
                             HttpContext.Current.Session[&quot;WorkingEstimate&quot;].ToString2() + &quot;&amp;ParentID=&quot; +
                             HttpContext.Current.Session[&quot;WorkingEstimate&quot;].ToString2();
                }
                else
                {
                    strQry = &quot;?&quot; + PID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;ProjectEstimateID=&quot; +
                             row[colProjectEstimateId].ToString2() + &quot;&amp;ParentID=&quot; +
                             row[colProjectEstimateId].ToString2();
                }
                var estimateInstanceID = new TNode(&quot;&quot;, &quot;#&quot;, useHtmlEncoding: true);
                if (!AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                {
                    estimateInstanceID = new TNode(&quot;(&quot; + row[&quot;EstimateID&quot;].ToString2() + &quot;) - &quot; + row[&quot;EstimateName&quot;].ToString2(),
                                                       &quot;~/Modules/ESTMATE/EstimateDetails.aspx&quot; + strQry +
                                                       &quot;&amp;Context=ESTMATE&amp;nt=1&quot;, &quot;Estimate Details&quot;, useHtmlEncoding: true);
                    estimatesNode.Nodes.Add(estimateInstanceID);
                }
                else
                    estimateInstanceID = estimatesNode;

                if (!AMP3ApplicationSettings.Instance.ESTMATELoadTreeOnDemand || currentProjectEstimateId == estimateid)
                {

                    //DOCUMENT MANAGEMENT
                    //Included Bid letting documents in the Document tree.(BRIX-16046)
                    DataTable dtProjectAssc = EstimateComponent.Instance.GetProjectAssociation(projectID, MODSUBMTAL);
                    var estimateModules = new Dictionary&lt;string, string&gt;();
                    estimateModules.Add(Constants.MODID_ESTMATE, LocalizationManager.GetString(&quot;Bid Letting&quot;));
                    //if (dtProjectAssc.Rows.Count &gt; 0)
                    //{
                    //    if (permissionsForSubmittal.Contains(&quot;Create&quot;) || permissionsForSubmittal.Contains(&quot;Edit&quot;) || permissionsForSubmittal.Contains(&quot;Submit&quot;) || permissionsForSubmittal.Contains(&quot;Reply&quot;) || permissionsForSubmittal.Contains(&quot;Visibility&quot;) || permissionsForSubmittal.Contains(&quot;View&quot;) || permissionsForSubmittal.Contains(&quot;Transmit&quot;) || permissionsForSubmittal.Contains(&quot;Approve&quot;) || permissionsForSubmittal.Contains(&quot;Import&quot;) || permissionsForSubmittal.Contains(&quot;Export&quot;) || permissionsForSubmittal.Contains(&quot;Library Visibility&quot;) || permissionsForSubmittal.Contains(&quot;SUBMITTALReport-PROJECT&quot;) || permissionsForSubmittal.Contains(&quot;TRANSMITTALReport&quot;))
                    //        estimateModules.Add(&quot;SUBMTAL&quot;, &quot;Submittals&quot;);
                    //}

                    if (estimateComponents.Contains(&quot;ShowEstimateDocuments&quot;))
                        DocumentManager.Instance.GetXmlForTree(projectID, estimateid, roleID, platformKey, &quot;ESTMATE&quot;,
                                                               estimateModules, estimateInstanceID);

                    #region Version
                    //versions should be allowed even in single estimate mode.
                    try
                    {
                        DataTable dtEstVersions = EstimateComponent.Instance.GetEstimates(projectID, false, 0,
                                                                                          row[colProjectEstimateId].
                                                                                              ToInt32_2());
                        if (dtEstVersions.Rows.Count &gt; 0)
                        {
                            string strVerQry = &quot;&quot;;
                            var versionRootNode = new TNode(&quot;Versions&quot;, &quot;&quot;, &quot;Estimate Versions&quot;, useHtmlEncoding: true);
                            estimateInstanceID.Nodes.Add(versionRootNode);

                            foreach (DataRow drVer in dtEstVersions.Rows)
                            {
                                strVerQry = &quot;?&quot; + PID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;ProjectEstimateID=&quot; +
                                            drVer[colProjectEstimateId].ToString2() + &quot;&amp;ParentID=&quot; +
                              drVer[colProjectEstimateId].ToString2();

                                TNode versionNode = new TNode(&quot;(&quot; + drVer[&quot;EstimateID&quot;].ToString2() + &quot;) - &quot; + drVer[&quot;EstimateName&quot;].ToString2(),
                                                                                 &quot;~/Modules/ESTMATE/EstimateDetails.aspx&quot; +
                                                                                 strVerQry + &quot;&amp;Context=ESTMATE&quot;, useHtmlEncoding: true);
                                versionRootNode.Nodes.Add(versionNode);
                                if (activeModulesForEstimate.ContainsKey(&quot;CHKESTL&quot;))
                                {
                                    if (permissionsForChecklist.Contains(&quot;Checklist Create&quot;) || permissionsForChecklist.Contains(&quot;Checklist Edit&quot;) || permissionsForChecklist.Contains(&quot;Checklist Complete&quot;))
                                        versionNode.Nodes.AddRange(new[]
                                                                   {

                                                                       new TNode(&quot;Checklists&quot;,
                                                                                 &quot;~/Common/BrixChecklist.aspx?context=ESTMATE&amp;PID=&quot; +
                                                                                 projectID.ToString2() + &quot;&amp;ParentID=&quot; +
                                                                                 row[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                                   });
                                }

                                versionNode.Nodes.AddRange(new[]
                                                                   {
                                                                       new TNode(LocalizationManager.GetString(&quot;Bid&quot;) + &quot; &quot;+
                                                                           LocalizationManager.GetString(
                                                                               KeyConstants.LOC_ITEMS),
                                                                           &quot;~/Common/BrixItemListPage.aspx?Context=ESTMATE&amp;PID=&quot; +
                                                                           projectID.ToString2() + &quot;&amp;ParentID=&quot; +
                                                                           drVer[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                                   });


                                if (Modcomponents.Contains(&quot;ContractTotal&quot;))
                                {
                                    versionNode.Nodes.AddRange(new[]
                                                                   {
                                                                       new TNode(&quot;Estimate Total&quot;,
                                                                                 &quot;~/Common/BrixItemsTotal.aspx?Context=ESTMATE&amp;ParentID=&quot; +
                                                                                 drVer[colProjectEstimateId].ToString2() +
                                                                                 &quot;&amp;PID=&quot; + projectID.ToString2())
                                                                   });
                                }

                                versionNode.Nodes.AddRange(new[]
                                                                   {
                                                                       new TNode(LocalizationManager.GetString(&quot;Bid Letting&quot;), &quot;~/Common/BrixListPage.aspx&quot; + strVerQry + &quot;&amp;context=BIDLTDL&quot;, useHtmlEncoding:true),
                                                                       new TNode(LocalizationManager.GetString(&quot;Bid Management&quot;), &quot;~/Common/BrixListPage.aspx&quot; + strVerQry + &quot;&amp;Context=ESTMBID&amp;module=ESTMBID&quot;, useHtmlEncoding:true),
                                                                   });
                                AppendEstLevelXmlForms(versionNode, dtAllModules, drVer[colProjectEstimateId].ToString2(), projectID.ToString2());
                                versionNode.Nodes.AddRange(new[]
                                                                   {
                                                                       new TNode(&quot;Reports&quot;, &quot;~/Common/BrixReportGallery.aspx?context=&quot; + Constants.MODID_ESTMATE + &quot;&amp;PID=&quot; + projectID + &quot;&amp;ParentID=&quot; + drVer[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                                   });
                            }
                        }
                    }
                    catch (Exception exVersion)
                    {
                        throw exVersion;
                    }

                    #endregion

                    if (AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                    {
                        if (!AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                            estimateInstanceID.Nodes.Add(new TNode(&quot;Settings&quot;, &quot;~/Modules/ESTMATE/Settings.aspx&quot; + strQry, useHtmlEncoding: true));
                    }


                    if (activeModulesForEstimate.ContainsKey(&quot;CHKESTL&quot;))
                    {
                        if (permissionsForChecklist.Contains(&quot;Checklist Create&quot;) || permissionsForChecklist.Contains(&quot;Checklist Edit&quot;) || permissionsForChecklist.Contains(&quot;Checklist Complete&quot;))
                            estimateInstanceID.Nodes.AddRange(new[]
                                                      {
                                                          new TNode(&quot;Checklists&quot;,
                                                                    &quot;~/Common/BrixChecklist.aspx?context=ESTMATE&amp;PID=&quot; +
                                                                    projectID.ToString2() + &quot;&amp;ParentID=&quot; +
                                                                    row[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                      });
                    }
                    estimateInstanceID.Nodes.AddRange(new[]
                                                      {
                                                          new TNode(LocalizationManager.GetString(&quot;Bid&quot;) + &quot; &quot;+
                                                              LocalizationManager.GetString(KeyConstants.LOC_ITEMS),
                                                              &quot;~/Common/BrixItemListPage.aspx?context=ESTMATE&amp;PID=&quot; +
                                                              projectID.ToString2() + &quot;&amp;ParentID=&quot; +
                                                              row[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                      });

                    List&lt;string&gt; components = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CONTMGT);
                    if (components.Contains(&quot;SOR&quot;))
                        estimateInstanceID.Nodes.AddRange(new[]
                                                      {
                                                           new TNode(&quot;Summary of Resources&quot;,
                                                                    &quot;~/Common/ResourceSummary.aspx?context=ESTMATE&amp;PID=&quot; +
                                                                    projectID.ToString2() + &quot;&amp;ParentID=&quot; +
                                                                    row[colProjectEstimateId].ToString2(), useHtmlEncoding:true)
                                                      });

                    if (dtProjectAssc.Rows.Count &gt; 0)
                    {
                        if (activeModulesForEstimate.ContainsKey(&quot;SUBESTL&quot;))
                        {
                            if (permissionsForSubmittal.Contains(&quot;Create&quot;) || permissionsForSubmittal.Contains(&quot;Edit&quot;) || permissionsForSubmittal.Contains(&quot;Submit&quot;) || permissionsForSubmittal.Contains(&quot;Reply&quot;) || permissionsForSubmittal.Contains(&quot;Visibility&quot;) || permissionsForSubmittal.Contains(&quot;View&quot;) || permissionsForSubmittal.Contains(&quot;Transmit&quot;) || permissionsForSubmittal.Contains(&quot;Approve&quot;) || permissionsForSubmittal.Contains(&quot;Import&quot;) || permissionsForSubmittal.Contains(&quot;Export&quot;) || permissionsForSubmittal.Contains(&quot;Library Visibility&quot;) || permissionsForSubmittal.Contains(&quot;SUBMITTALReport-PROJECT&quot;) || permissionsForSubmittal.Contains(&quot;TRANSMITTALReport&quot;))
                            {
                                var submittalNode = new TNode(&quot;Submittals&quot;, &quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;PID=&quot; + projectID + &quot;&amp;LinkID=&quot; +
                                                              row[colProjectEstimateId].ToString2() + &quot;&amp;Link=&quot; + MODID_ESTIMATOR, useHtmlEncoding: true);
                                estimateInstanceID.Nodes.Add(submittalNode);
                            }
                        }
                    }

                    if (components.Contains(&quot;ContractTotal&quot;))
                        estimateInstanceID.Nodes.AddRange(new[]
                                                      {
                                                          new TNode(&quot;Estimate Total&quot;,
                                                                    &quot;~/Common/BrixItemsTotal.aspx?Context=ESTMATE&amp;ParentID=&quot; +
                                                                    row[colProjectEstimateId].ToString2() + &quot;&amp;PID=&quot; +
                                                                    projectID.ToString2(), useHtmlEncoding:true)
                                                      });

                    estimateInstanceID.Nodes.AddRange(new[]
                                                      {
                                                          new TNode(LocalizationManager.GetString(&quot;Bid Letting&quot;), &quot;~/Common/BrixListPage.aspx&quot; + strQry + &quot;&amp;context=BIDLTDL&quot;, useHtmlEncoding:true),
                                                          new TNode(LocalizationManager.GetString(&quot;Bid Management&quot;), &quot;~/Common/BrixListPage.aspx&quot; + strQry + &quot;&amp;Context=ESTMBID&amp;module=ESTMBID&quot;, useHtmlEncoding:true)
                                                      });


                    AppendEstLevelXmlForms(estimateInstanceID, dtAllModules, row[colProjectEstimateId].ToString2(), projectID.ToString2());

                    ReportManager.Instance.GetReportGalleryXml(estimateInstanceID, Constants.MODID_ESTMATE, projectID,
                                                               row[colProjectEstimateId].ToInt32_2());
                }
                if (AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                    break;
            }
            return tree;
        }
        public Dictionary&lt;string, string&gt; GetTreeForMobile(int projectID, int instanceId, int userId, int roleId)
        {
            return new Dictionary&lt;string, string&gt;();
        }
        string IXmlTree.ActiveTab { get { return &quot;PROJECT&quot;; } set { } }
        string IXmlTree.ModuleID { get { return &quot;ESTMATE&quot;; } set { } }
        #endregion


        public void AppendEstLevelXmlForms(TNode tree, DataTable dtModuleList, string estimateID, string pid)
        {
            TNode parentNode = tree;

            List&lt;string&gt; prodTemplates = new List&lt;string&gt;();
            prodTemplates.Add(&quot;XBIDLST&quot;);

            foreach (DataRow dr in dtModuleList.Rows)
            {
                if ((dr[&quot;ParentModuleID&quot;].ToString() == Constants.MODID_ESTMATE &amp;&amp; dr[&quot;NavigateURL&quot;].ToString().ToLower() == &quot;xmlform&quot;))
                {
                    //hiding the product template
                    if (!prodTemplates.Contains(dr[&quot;ModuleID&quot;].ToString()))
                    {
                        string instanceUrl = dr[&quot;InstanceUrl&quot;].ToString();
                        string urlcontext = &quot;xContext&quot;;
                        if (dr[&quot;IsSingleInstance&quot;].ToBoolean2())
                            urlcontext = &quot;Context&quot;;

                        string url = &quot;{0}?{1}={2}&amp;PID={3}&amp;ParentID={4}&quot;.Format2(instanceUrl, urlcontext, dr[&quot;moduleid&quot;], pid, estimateID);


                        if (dr[&quot;ParentFolderPath&quot;].ToString().ToUpper2() != &quot;FORMS&quot;)
                            parentNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), LocalizationManager.GetString(dr[&quot;ModuleName&quot;].ToString()),
                                                               url);
                        else
                            parentNode.Nodes.Add(new TNode(LocalizationManager.GetString(dr[&quot;ModuleName&quot;].ToString()), url, useHtmlEncoding: true));

                        //parentNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                        //                               &quot;~/Common/BrixListPage.aspx?xContext=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + pid + &quot;&amp;ParentID=&quot; + estimateID);
                    }
                }
            }
        }


        //GETS ALL THE ESTIMATES FOR A SPECIFIC PROJECT
        public DataTable GetEstimates(int projectID, bool isDeleted, int pageType)
        {
            return EstimateComponent.Instance.GetEstimates(projectID, isDeleted, pageType, null);
        }

        public DataTable GetItemsByGroups(int projectEstimateID)
        {
            return EstimateComponent.Instance.GetItemsByGroups(projectEstimateID);
        }

        public int UpdateEstimate(EstimatorDTO.Estimator dtoObj, int projectEstimateID, int projectID)
        {
            return EstimateComponent.Instance.UpdateEstimate(dtoObj, projectEstimateID, projectID);
        }

        public int[] RemoveEstimate(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.RemoveEstimate(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetProjectList(string erpCompany)
        {
            try
            {
                return EstimateComponent.Instance.GetProjectList(erpCompany);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int CreateEstimate(EstimatorDTO.Estimator estObj)
        {
            try
            {
                return EstimateComponent.Instance.CreateEstimate(estObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public EstimatorDTO.Estimator GetEstimateDetails(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateDetails(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public Dictionary&lt;string, string&gt; GetEstimateAttributes(int projectEstimateID)
        {
            return EstimateComponent.Instance.GetAttributesValues(projectEstimateID);
        }

        public int CopyEstimate(int srcProjectEstID, int destProjectID, string newEstimateID, string newEstDescription,
                                string copyElements, string initiatedBy, int initiatedById, out Int64 NewEstimateID, string CopyFund = &quot;&quot;)
        {
            try
            {
                return
                    EstimateComponent.Instance.CopyEstimate(srcProjectEstID, destProjectID, newEstimateID,
                                                            newEstDescription, copyElements, initiatedBy, initiatedById, out NewEstimateID, CopyFund);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidList(int projectEstimateID, int flag, string altIDList, object startRowIdx,
                            object maxRows, string sortOrder, string getCount)
        {
            return EstimateComponent.Instance.GetBidList(projectEstimateID, flag, altIDList, startRowIdx, maxRows,
                                                         sortOrder, getCount);
        }
        public DataTable GetBidList(int projectEstimateID, int flag, string altIDList, object startRowIdx,
                                    object maxRows, string sortOrder, string filter, string getCount)
        {
            return EstimateComponent.Instance.GetBidList(projectEstimateID, flag, altIDList, startRowIdx, maxRows,
                                                         sortOrder, filter, getCount);
        }

        public int GetBidListCount(int projEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidListCount(projEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetAddendumItemsCount(int parentId)
        {
            return EstimateComponent.Instance.GetAddendumItemsCount(parentId);
        }

        public DataTable GetBidAnalysis(int projectEstimateID)
        {
            return EstimateComponent.Instance.GetBidAnalysis(projectEstimateID);
        }

        public int ImportBids(DataSet dsBids, int enterpriseID)
        {
            return EstimateComponent.Instance.ImportBids(dsBids, enterpriseID);
        }

        public DataTable GetGroupDetails(int projEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetGroupDetails(projEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int RemoveGroup(int groupID)
        {
            try
            {
                return EstimateComponent.Instance.RemoveGroup(groupID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteEstimateFromView(string projectEstimateIDs, bool blnRestore)
        {
            try
            {
                return EstimateComponent.Instance.DeleteEstimateFromView(projectEstimateIDs, blnRestore);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateIsLocked(int projectEstimateID, bool isLocked)
        {
            try
            {
                #region WorkFlow Code - DO NOT REMOVE THIS COMMENT : SOMU

                //string message = &quot;&quot;;
                //MethodInvokeInfo objAEI = WorkFlowComponent.Instance.ExecuteScriptlet(ScriptletPoints.OnEstimateBOQLock, 
                //    new object[] { projectEstimateID, isLocked }, out message, true);
                //if(objAEI.IsSuccessfulCall)
                //{
                //    return BrixDatatypeHelper.ToInt32_2(objAEI.Output);
                //}
                //else
                //{
                //    throw new Exception(message, objAEI.Exception);
                //}

                #endregion

                #region Existing Code - How AMP3 Works Today

                return EstimateComponent.Instance.UpdateIsLocked(projectEstimateID, isLocked);

                #endregion
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateIsApproved(int projectEstimateID, bool isApproved)
        {
            try
            {
                return EstimateComponent.Instance.UpdateIsApproved(projectEstimateID, isApproved);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool GetApprovedStatus(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetApprovedStatus(projectEstimateID);
            }

            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool GetLockStatus(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetLockStatus(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddBidInfo(EstimateBid dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.AddBidInfo(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidId(string contractorID, string contractorName, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidId(contractorID, contractorName, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddBidUnitPrice(string unitPriceDetails, int projectEstimateID, int bidID)
        {
            try
            {
                return EstimateComponent.Instance.AddBidUnitPrice(unitPriceDetails, projectEstimateID, bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidDetails(int bidID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidDetails(bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateBidUnitPrice(string unitPriceDetails, int projectEstimateID, int bidID)
        {
            try
            {
                return EstimateComponent.Instance.UpdateBidUnitPrice(unitPriceDetails, projectEstimateID, bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public double GetBidTotal(int bidID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidTotal(bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable UnitPriceSearch(string executionSQL)
        {
            try
            {
                return EstimateComponent.Instance.UnitPriceSearch(executionSQL);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateAwardedStatus(int awardStatus, int bidID, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.UpdateAwardedStatus(awardStatus, bidID, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteBid(int bidID)
        {
            try
            {
                return EstimateComponent.Instance.DeleteBid(bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public static Stream GetIOStream(string xmlStr)
        {
            var myEncoder = new ASCIIEncoding();
            return new MemoryStream(myEncoder.GetBytes(xmlStr));
        }

        public string GetLibraryCatalogs(string catalogName)
        {
            return QueryInterface.Instance.GetCatalogRecords(catalogName, &quot;&quot;, 0, 0, &quot;&quot;);
        }

        public Dictionary&lt;int, string&gt; GetLibraryCatalogs1()
        {
            return QueryInterface.Instance.GetChildNodes(&quot;Common&quot;);
        }

        public int CreateAttribute(string attributeName, string attributeType, string CatalogName)
        {
            try
            {
                return EstimateComponent.Instance.CreateAttribute(attributeName, attributeType, CatalogName);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetAttributes()
        {
            try
            {
                return EstimateComponent.Instance.GetAttributes();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetWorkBook(int itemID)
        {
            try
            {
                return EstimateComponent.Instance.GetWorkbook(itemID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddToWorkbook(int itemID, string dtWorkbookXML)
        {
            try
            {
                return EstimateComponent.Instance.AddToWorkbook(itemID, dtWorkbookXML);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteWorkbook(string workIDs)
        {
            try
            {
                return EstimateComponent.Instance.DeleteWorkbook(workIDs);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidAwardStatus(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidAwardStatus(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public string GetWorkFlowStatus(int instanceID, int parentID)
        {
            try
            {
                return EstimateComponent.Instance.GetWorkFlowStatus(instanceID, parentID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateDesignContigency(int projectEstimateID, decimal designCont, decimal estTotal)
        {
            try
            {
                return EstimateComponent.Instance.UpdateDesignContigency(projectEstimateID, designCont, estTotal);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidCount(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidCount(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataSet GetEstimateBidInfo(int estimateId)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateBidInfo(estimateId);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public MemoryStream GetPdfReport(int projectEstimateID, string reportPath, string logoPath, int AddendumID,
                                         int projectID)
        {
            var pdf = new PdfExport();
            var rpt = new ActiveReport();


            try
            {
                var strm = new MemoryStream();
                XmlReader XReader = XmlReader.Create(reportPath);
                rpt.LoadLayout(XReader);
                rpt.PageSettings.Margins.Top = 0.5F;
                rpt.PageSettings.Margins.Bottom = 0.5F;
                rpt.PageSettings.Margins.Left = 0.5F;
                rpt.PageSettings.Margins.Right = 0.5F;

                //OleDBDataSource ds = ((OleDBDataSource) (rpt.DataSource));

                //ds.ConnectionString = &quot;Provider=oraOLEDB.Oracle;&quot; +
                //    WebConfigurationManager.ConnectionStrings[Constants.AMP3_CONNECTIONSTRING].ConnectionString;

                //SqlDBDataSource ds = ((SqlDBDataSource)(rpt.DataSource));
                //ds.ConnectionString =
                //    WebConfigurationManager.ConnectionStrings[Constants.AMP3_CONNECTIONSTRING].ConnectionString;

                if (File.Exists(logoPath))
                {
                    Image logoImage = new Bitmap(logoPath);
                    var pic = ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                    pic.Image = logoImage;

                    if (logoImage.Height &gt; pic.Height * 100 ||
                        logoImage.Width &gt; pic.Width * 100)
                        pic.SizeMode = SizeModes.Zoom;
                }

                if (reportPath.Contains(&quot;rptEstimateSubmittals.rpx&quot;))
                {
                    rPath = reportPath.Replace(&quot;rptEstimateSubmittals.rpx&quot;, &quot;&quot;);
                    DataTable reportDetails = EstimateComponent.Instance.GetReportDetails(projectEstimateID);
                    rpt.DataSource = reportDetails;

                    ((Label)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;lblModuleCategory&quot;]).Text =
                        &quot;Estimate Submittals Report&quot;;

                    DataSet reportDs = EstimateComponent.Instance.GetEstimateSubmittals(projectEstimateID, projectID,
                                                                                        &quot;ESTMATE&quot;);
                    reportDs = GetReportDs(reportDs.Tables[0]);

                    //Past Due
                    if (reportDs.Tables[0].Rows.Count &gt; 0)
                    {
                        var rptSubdt = new ActiveReport();
                        XmlReader XmReader = XmlReader.Create(this.rPath + &quot;\\subRptDueDate.rpx&quot;);
                        rptSubdt.LoadLayout(XmReader);
                        rptSubdt.DataSource = reportDs.Tables[0];
                        ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate&quot;]).Report = rptSubdt;
                    }

                    //Due 7
                    if (reportDs.Tables[1].Rows.Count &gt; 0)
                    {
                        var rptSubdt7 = new ActiveReport();
                        XmlReader Reader = XmlReader.Create(this.rPath + &quot;\\subRptDueDate.rpx&quot;);
                        rptSubdt7.LoadLayout(Reader);

                        rptSubdt7.DataSource = reportDs.Tables[1];
                        ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate7&quot;]).Report = rptSubdt7;
                    }

                    //Due 30
                    if (reportDs.Tables[2].Rows.Count &gt; 0)
                    {
                        var rptSubdt7_30 = new ActiveReport();
                        XmlReader XmReader = XmlReader.Create(this.rPath + &quot;\\subRptDueDate.rpx&quot;);
                        rptSubdt7_30.LoadLayout(XmReader);

                        rptSubdt7_30.DataSource = reportDs.Tables[2];
                        ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate7_30&quot;]).Report = rptSubdt7_30;
                    }

                    //Due 7-30
                    if (reportDs.Tables[3].Rows.Count &gt; 0)
                    {
                        var rptSubdt30 = new ActiveReport();
                        XmlReader XmmReader = XmlReader.Create(this.rPath + &quot;\\subRptDueDate.rpx&quot;);
                        rptSubdt30.LoadLayout(XmmReader);

                        rptSubdt30.DataSource = reportDs.Tables[3];
                        ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate30&quot;]).Report = rptSubdt30;
                    }
                }


                rpt.ShowParameterUI = false;
                rpt.Run();
                pdf.Export(rpt.Document, strm);
                return strm;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
            finally
            {
                pdf.Dispose();
                rpt.Dispose();
            }
        }

        public DataTable GetBidItems(int projectEstimateID, int bidID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidItems(projectEstimateID, bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        //public List&lt;string&gt; GetPermissionByRole(string moduleID, int roleID)
        //{
        //    try
        //    {
        //        return ModuleManager.Instance.GetPermissionByRole(moduleID, roleID);
        //    }
        //    catch (Exception ex)
        //    {
        //        Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
        //        throw;
        //    }
        //}

        public int CreateSnapShot(EstimatorDTO.Estimator dtoObj, out int NewEstimateId)
        {
            try
            {
                return EstimateComponent.Instance.CreateSnapShot(dtoObj, out NewEstimateId);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetSnapShotEstimates(int projectID, bool isDeleted)
        {
            try
            {
                return EstimateComponent.Instance.GetSnapShotEstimates(projectID, isDeleted);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public EstimateBid GetContractorDetails(int bidID)
        {
            try
            {
                return EstimateComponent.Instance.GetContractorDetails(bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateContractorDetails(EstimateBid dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.UpdateContractorDetails(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetItemsBySection(int projectEstimateID, int sectionID)
        {
            try
            {
                return EstimateComponent.Instance.GetItemsBySection(projectEstimateID, sectionID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddBidLetInfo(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.AddBidLetInfo(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidLetInfo(int projectEstimateID, object startRowIdx, object maxRows, string sortOrder,
                               string getCount, string flag)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLetInfo(projectEstimateID, startRowIdx, maxRows, sortOrder,
                                                                string.Empty, getCount, flag);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public DataTable GetBidLetInfo(int projectEstimateID, object startRowIdx, object maxRows, string sortOrder,
                                       string filter, string getCount, string flag)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLetInfo(projectEstimateID, startRowIdx, maxRows, sortOrder,
                                                                filter, getCount, flag);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidLetInfoCount(int projEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLetInfoCount(projEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteBidLetInfo(int ID)
        {
            try
            {
                return EstimateComponent.Instance.DeleteBidLetInfo(ID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetUPSMeasureUnits()
        {
            try
            {
                return EstimateComponent.Instance.GetUPSMeasureUnits();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteAttribute(int attributeId)
        {
            try
            {
                return EstimateComponent.Instance.DeleteAttribute(attributeId);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetAlternates(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetAlternates(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddAlternateInfo(EstimateItem dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.AddAlternateInfo(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateAlternateInfo(EstimateItem dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.UpdateAlternateInfo(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteAlternateInfo(int alternateID, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.DeleteAlternateInfo(alternateID, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable[] GetGSAList(int projEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetGSAList(projEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool GetAddendumStatus(int addendumID)
        {
            try
            {
                return EstimateComponent.Instance.GetAddendumStatus(addendumID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetStdItems(int projEstimateID, int stdItemID, object startRowIdx, object maxRows,
                                     string sortOrder, string filterSearch)
        {
            try
            {
                //if(ConnectorFacade.Instance.IsERPConnectorAttached)
                //{
                //    QueryStatus[] objERPOutput = ERPComponent.Instance.ExecuteERPTrigger(AMP3ObjectType.Estimate, MethodInfo.GetCurrentMethod(), null, null);
                //    return objERPOutput[0].ERPDataSet.Tables[0];
                //}
                //else
                //{
                return EstimateComponent.Instance.GetStdItems(projEstimateID, stdItemID, startRowIdx, maxRows, sortOrder,
                                                              filterSearch);
                // }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetStdItemCount(int stdTableID, int projEstimateID, string filterSearch)
        {
            try
            {
                return EstimateComponent.Instance.GetStdItemCount(stdTableID, projEstimateID, filterSearch);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetStdItems4UPS(int projEstimateID, object startRowIdx, object maxRows,
                                    string sortOrder, string filterSearch)
        {
            try
            {

                return EstimateComponent.Instance.GetStdItems4UPS(projEstimateID, startRowIdx, maxRows, sortOrder,
                                                              filterSearch);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetStdItemCount4UPS(int projEstimateID, string filterSearch)
        {
            try
            {
                return EstimateComponent.Instance.GetStdItemCount4UPS(projEstimateID, filterSearch);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetStandardItemTables(string AXCompany)
        {
            try
            {
                //if (ConnectorFacade.Instance.IsERPConnectorAttached)
                //{
                //    QueryStatus[] objERPOutput = ERPComponent.Instance.ExecuteERPTrigger(AMP3ObjectType.Estimate, MethodInfo.GetCurrentMethod(), null, null);
                //    return objERPOutput[0].ERPDataSet.Tables[1];
                //}
                //else
                //{
                return EstimateComponent.Instance.GetStandardItemTables(AXCompany);
                //}
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidLetStaus(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLetStaus(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidLetDetail(int id, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLetDetail(id, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable[] GetBidTabulationList(string alternateIDList, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidTabulationList(alternateIDList, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public List&lt;int&gt; GetRolesForFeatureList(string moduleID, string featureCode)
        {
            try
            {
                return EstimateComponent.Instance.GetRolesForFeatureList(moduleID, featureCode);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetProjectUsers(int projectID)
        {
            try
            {
                return EstimateComponent.Instance.GetProjectUsers(projectID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetUserInformation(string listofUsers)
        {
            try
            {
                return EstimateComponent.Instance.GetUserInformation(listofUsers);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBLStatusList()
        {
            try
            {
                return EstimateComponent.Instance.GetBLStatusList();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable[] GetChoosenAlternates(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetChoosenAlternates(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateBidLetInfo(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.UpdateBidLetInfo(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteEstimateSettings(int estSettingsID)
        {
            try
            {
                return EstimateComponent.Instance.DeleteEstimateSettings(estSettingsID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateEstimateSettings(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.UpdateEstimateSettings(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int AddEstimateSettings(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                return EstimateComponent.Instance.AddEstimateSettings(dtoObj);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetEstimateSettings(int projectID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateSettings(projectID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetEstimateStdTable(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateStdTable(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetProjectsList(object startRowIdx, object maxRows, string sortOrder, string filterSearch)
        {
            try
            {
                return EstimateComponent.Instance.GetProjectsList(startRowIdx, maxRows, sortOrder, filterSearch);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetProjectsCount(string filterSearch)
        {
            try
            {
                return EstimateComponent.Instance.GetProjectsCount(filterSearch);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetEstimateForVersion(int projectID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateForVersion(projectID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable[] GetIWTExportDetails(int projectEstimateID, int addendumID)
        {
            try
            {
                return EstimateComponent.Instance.GetIWTExportDetails(projectEstimateID, addendumID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public string[] CheckSnapShot(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.CheckSnapShot(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int UpdateIWTExpSuccess(int projectEstimateID, int addendumID)
        {
            try
            {
                //List&lt;SPParameter&gt; inParams = new List&lt;SPParameter&gt;();
                //List&lt;SPParameter&gt; outParams = new List&lt;SPParameter&gt;();

                //DbCommand cmd = db.GetStoredProcCommand(&quot;usp_ESTMATEUpdateIWTExpSucess&quot;);
                //db.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                //db.AddInParameter(cmd, &quot;ADDENDUMID&quot;, DbType.Int32, addendumID);
                //db.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                //db.ExecuteNonQuery(cmd);
                //return Convert.ToInt32(db.GetParameterValue(cmd, &quot;STATUS&quot;).ToString());


                return EstimateComponent.Instance.UpdateIWTExpSuccess(projectEstimateID, addendumID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public string[] ExportToContract(int bidID, int projectEstimateID, int projectID)
        {
            DataTable[] dtAwardedDetails = EstimateComponent.Instance.GetExportDataToContract(bidID, projectEstimateID,
                                                                                              projectID);

            // 1st table contains Project Details
            // 2nd table contains contrator details
            // 3rd table all the subcontractors of the project
            // 4th table contains groups
            // 5th table contains sections
            // 6th table contains the ItemDetails of the contractor.

            DataRow dr;
            var sWr = new StringWriter(CultureInfo.CurrentCulture);
            var xWr = new XmlTextWriter(sWr);


            xWr.WriteStartElement(&quot;XMLROOT&quot;);

            if (dtAwardedDetails[0].Rows.Count &gt; 0)
            {
                dr = dtAwardedDetails[0].Rows[0];
                xWr.WriteStartElement(&quot;Contracts&quot;);
                xWr.WriteAttributeString(&quot;ProjectID&quot;, dr[&quot;ProjectId&quot;].ToString2());
                xWr.WriteElementString(&quot;MeasSysID&quot;, dr[&quot;MeasurementSysID&quot;].ToString2());
                xWr.WriteElementString(&quot;CreatedBy&quot;, dr[&quot;Owner&quot;].ToString2());
            }

            if (dtAwardedDetails[1].Rows.Count &gt; 0)
            {
                int n;
                dr = dtAwardedDetails[1].Rows[0];

                xWr.WriteStartElement(&quot;PC&quot;);
                if (int.TryParse(dr[&quot;ContractorId&quot;].ToString2(), out n))
                {
                    int contID = EstimateComponent.Instance.GetLIBContRecID(dr[&quot;ContractorId&quot;].ToString2());
                    xWr.WriteElementString(&quot;RecordID&quot;, contID.ToString2());
                }
                else
                    xWr.WriteElementString(&quot;RecordID&quot;, &quot;0&quot;);

                xWr.WriteElementString(&quot;PID&quot;, int.TryParse(dr[&quot;ContractorId&quot;].ToString2(), out n)
                                                  ? dr[&quot;ContractorId&quot;].ToString2()
                                                  : &quot;1&quot;);
                xWr.WriteElementString(&quot;Contact&quot;, dr[&quot;ContractorName&quot;].ToString2());
                xWr.WriteElementString(&quot;Company&quot;, dr[&quot;ContractorName&quot;].ToString2());
                xWr.WriteElementString(&quot;Address&quot;, dr[&quot;Address1&quot;].ToString2());
                xWr.WriteElementString(&quot;Address1&quot;, dr[&quot;Address2&quot;].ToString2());
                xWr.WriteElementString(&quot;Address2&quot;, dr[&quot;Address3&quot;].ToString2());
                xWr.WriteElementString(&quot;City&quot;, dr[&quot;City&quot;].ToString2());
                xWr.WriteElementString(&quot;State&quot;, dr[&quot;State&quot;].ToString2());
                xWr.WriteElementString(&quot;Zip&quot;, dr[&quot;Zip&quot;].ToString2());
                xWr.WriteElementString(&quot;Phone&quot;, dr[&quot;Telephone&quot;].ToString2());
                xWr.WriteElementString(&quot;Fax&quot;, dr[&quot;Fax&quot;].ToString2());
                xWr.WriteElementString(&quot;Email&quot;, dr[&quot;Email&quot;].ToString2());
            }


            for (int i = 0; i &lt; dtAwardedDetails[2].Rows.Count; i++)
            {
                dr = dtAwardedDetails[2].Rows[i];
                xWr.WriteStartElement(&quot;SC&quot;);
                xWr.WriteElementString(&quot;SID&quot;, dr[&quot;ContractorId&quot;].ToString2());
                xWr.WriteElementString(&quot;Contact&quot;, dr[&quot;ContractorName&quot;].ToString2());
                xWr.WriteElementString(&quot;Company&quot;, dr[&quot;ContractorName&quot;].ToString2());
                xWr.WriteElementString(&quot;Address&quot;, dr[&quot;Address1&quot;].ToString2());
                xWr.WriteElementString(&quot;Address1&quot;, dr[&quot;Address2&quot;].ToString2());
                xWr.WriteElementString(&quot;Address2&quot;, dr[&quot;Address3&quot;].ToString2());
                xWr.WriteElementString(&quot;Phone&quot;, dr[&quot;Telephone&quot;].ToString2());
                xWr.WriteElementString(&quot;Fax&quot;, dr[&quot;Fax&quot;].ToString2());
                xWr.WriteElementString(&quot;Email&quot;, dr[&quot;Email&quot;].ToString2());
                xWr.WriteEndElement(); // SC
            }

            if (dtAwardedDetails[1].Rows.Count &gt; 0)
                xWr.WriteEndElement(); // PC end tag

            xWr.WriteEndElement(); // Contracts tag                
            xWr.WriteEndElement(); // XMLROOT

            xWr.Flush();
            string s = sWr.ToString2();
            sWr.Close();

            var rtnAwdDetails = new string[2];
            rtnAwdDetails[0] = s;
            rtnAwdDetails[1] = &quot;&quot;;

            return rtnAwdDetails;
        }

        public DataSet GetReportDs(DataTable dt)
        {
            DateTime fromDate;
            DateTime toDate;
            DataSet ds = new BrixDataSet();

            DataRow[] rows;

            //OverDue..
            fromDate = toDate = DateTime.UtcNow;
            rows = dt.Select(&quot;DueDate&lt;&#39;&quot; + fromDate + &quot;&#39;&quot;);
            DataTable dtTemp = new BrixDataTable();
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;OverDue&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //7 days for due Date...
            fromDate = DateTime.UtcNow;
            toDate = DateTime.UtcNow.AddDays(7);
            rows = dt.Select(&quot;DueDate&gt;=&#39;&quot; + fromDate + &quot;&#39; AND DueDate&lt;=&#39;&quot; + toDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;7Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //30 days for due date...
            fromDate = DateTime.UtcNow.AddDays(7);
            toDate = DateTime.UtcNow.AddDays(30);
            rows = dt.Select(&quot;DueDate&gt;&#39;&quot; + fromDate + &quot;&#39; AND DueDate&lt;=&#39;&quot; + toDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;7-30Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //&gt;30 days for due date...
            fromDate = DateTime.UtcNow.AddDays(30);
            rows = dt.Select(&quot;DueDate&gt;&#39;&quot; + fromDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;MoreThan30Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            return ds;
        }

        // ODS Contractors
        public int GetContractorsCount(string additionalInfo, string filterSearch)
        {
            return EstimateComponent.Instance.GetContractorCount(additionalInfo, filterSearch);
        }

        public DataTable GetContractor(string additionalInfo, object startRowIdx, object maxRows, string sortOrder,
                                       string filterSearch, string filterValues = null)
        {
            return EstimateComponent.Instance.GetContractor(additionalInfo, startRowIdx, maxRows, sortOrder,
                                                            filterSearch, filterValues);
        }

        // ODS Contractors

        public int GetProjectEstimateID(int addendumID)
        {
            return
                ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATEGetProjectEstimateID, null,
                                                       new object[] { addendumID }).ToInt32_2();
        }

        public DataTable GetProjectAssociation(int projectID, string moduleID)
        {
            return EstimateComponent.Instance.GetProjectAssociation(projectID, moduleID);
        }

        public DataSet GetEstimateAndWorkType()
        {
            return EstimateComponent.Instance.GetEstimateAndWorkType();
        }

        private MemoryStream GetPdfStream(string reportName, string appPath, object[] parameters)
        {
            var rptParams = new ReportParams();
            MemoryStream strm = null;
            string[] logoFileName = AMP3ApplicationSettings.Instance.AppLogo.Split(&#39;/&#39;);
            foreach (string strName in logoFileName)
            {
                if (strName.Contains(&quot;.&quot;))
                    rptParams.ReportLogoPath = appPath + &quot;Modules\\MODMGMT\\Images\\&quot; + strName;
            }

            switch (reportName)
            {
                case &quot;Project Submittals&quot;:
                    {
                        rptParams.ReportPath = appPath + &quot;Modules\\ESTMATE\\rptEstimateSubmittals.rpx&quot;;
                        if (parameters.Length &lt; 2) return null;
                        int pid = parameters[0].ToInt32_2();
                        int eid = parameters[1].ToInt32_2();
                        strm = GetPdfReport(eid, rptParams.ReportPath, rptParams.ReportLogoPath, -1, pid);
                        break;
                    }
            }

            return strm;
        }

        //Query for obtaining the Letting IDs of the particular Estimate required for getting  
        //all the documents attached to the Estimates(Bid Letting and Addendum)(BRIX-16046)
        public string GetModuleInstances(string parentID, string parentModuleID)
        {
            return &quot;SELECT CAST(ID AS VARCHAR) FROM ESTMATEBidLettingInfo  WHERE ProjectEstimateID = &quot; + parentID;
        }

        public int GetProjectEstimateIDFromBidId(int BidId)
        {
            return EstimateComponent.Instance.GetProjectEstimateIDFromBidId(BidId);
        }

        public int CancelBidLetting(int bidLettingID)
        {
            try
            {
                return EstimateComponent.Instance.CancelBidLetting(bidLettingID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidLettingDetail(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidLettingDetail(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool HasUnitPrice(string bidIDs)
        {
            try
            {
                DataTable dt = EstimateComponent.Instance.HasUnitPrice(bidIDs);

                if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                    return true;

                return false;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public void UpdateEstimateBidSettings(params object[] estimateSettings)
        {
            try
            {
                EstimateComponent.Instance.UpdateEstimateBidSettings(estimateSettings);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetContractIdFromEstimateId(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetContractIdFromEstimateId(projectEstimateID).ToInt32_2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool GetAutoCreateContract(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetAutoCreateContract(projectEstimateID).ToBoolean2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetBidStatus(int bidId)
        {
            try
            {
                return EstimateComponent.Instance.GetBidStatus(bidId).ToInt16_2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public DataTable GetBidInformation(int bidID, int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetBidInformation(bidID, projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool isExistsAddendum(int projectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.isExistsAddendum(projectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int DeleteCORITEMDetail(int ParentInstanceID, string ModuleID, int Error)
        {
            try
            {
                return EstimateComponent.Instance.DeleteCORITEMDetail(ParentInstanceID, ModuleID, Error);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }

        }

        public bool BidBelongsToBidder(int CurrentUserId, int bidID)
        {
            try
            {
                return EstimateComponent.Instance.BidBelongsToBidder(CurrentUserId, bidID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public bool GetEstimateBidSettings(int projectEstimateID, string EstBidSettingName)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateBidSettings(projectEstimateID, EstBidSettingName).ToBoolean2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public object GetEstimateInfo(int projectid)
        {
            try
            {
                return EstimateComponent.Instance.GetEstmateInfo(projectid);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public int GetEstmateInfoEstimate(string EstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstmateInfoEstimate(EstimateID).ToInt32_2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public string GetProjectName(int ProjectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetProjectName(ProjectEstimateID).ToString();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public DataSet GetAddendumIssuedMail(int projectEstimateId)
        {
            return EstimateComponent.Instance.GetAddendumIssuedMail(projectEstimateId);
        }

        public int GetInviteBidderInfo(int projectid, int ProjectEstimateID, int userID)
        {
            try
            {
                return EstimateComponent.Instance.GetInviteBidderInfo(projectid, ProjectEstimateID, userID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public object GetEstimateContractorLoginID(string ContractorID, int PID, int ProjectEstimateID)
        {
            try
            {
                return EstimateComponent.Instance.GetEstimateContractorLoginID(ContractorID, PID, ProjectEstimateID);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }
        public string CUBidInformation(int BidID, string Remarks, int projectID, int ProjectEstimateID, string ModifiedBy)
        {
            try
            {
                return EstimateComponent.Instance.CUBidInformation(BidID, Remarks, projectID, ProjectEstimateID, ModifiedBy).ToString();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, MODID_ESTIMATOR);
                throw;
            }
        }

        public int GetPIDFromEstimateId(int id)
        {
            object pid = EstimateComponent.Instance.GetPIDFromEstimateId(id);
            if (pid != null)
                return pid.ToInt32_2();
            else
                return -1;

        }
    }

    public class EstimatesBreadCrumb : BreadCrumbBase
    {
        public override string Title { get { return (AMP3ApplicationSettings.Instance.IsSingleProjectMode) ? &quot;&quot; : &quot;Cost Estimate Information&quot;; } }

        public override string URL
        {
            get
            {
                string pid = HttpContext.Current.Request.QueryString[&quot;PID&quot;];
                return string.Format(&quot;/Common/BrixListPage.aspx?PID={0}&amp;Context=ESTMATE&quot;, pid);
            }
        }

        public override BreadCrumbBase parent
        {
            get
            {
                return new ProjectBreadCrumb();
            }
        }
    }

    [Context(Name = Constants.MODID_ESTMATE)]
    public class EstimateBreadCrumb : BreadCrumbBase
    {
        bool isEstimates = false;

        private string estimateID
        {
            get
            {
                string id = HttpContext.Current.Request.QueryString[&quot;ProjectEstimateID&quot;];
                if (string.IsNullOrEmpty(id))
                    id = HttpContext.Current.Request.QueryString[&quot;ParentID&quot;];
                if (string.IsNullOrEmpty(id))
                    id = HttpContext.Current.Request.QueryString[&quot;IID&quot;];
                return id;
            }
        }

        public override string Title
        {
            get
            {
                if (AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                    return &quot;&quot;;
                isEstimates = (string.IsNullOrEmpty(estimateID));
                if (!isEstimates)
                    return ComponentHelper.Instance.ExecuteScalar(&quot;select &#39;(&#39; + EstimateID + &#39;) &#39; + EstimateName from ESTMATEInfo where ProjectEstimateID ={0}&quot;, estimateID).ToString();
                return &quot;&quot;;
            }
        }

        public override string URL
        {
            get
            {
                string pid = HttpContext.Current.Request.QueryString[&quot;PID&quot;];
                if (!isEstimates)
                    return string.Format(&quot;/Modules/ESTMATE/EstimateDetails.aspx?PID={0}&amp;ProjectEstimateID={1}&amp;ParentID={1}&amp;Context=ESTMATE&quot;, pid, estimateID);
                return &quot;&quot;;
            }
        }

        public override BreadCrumbBase parent
        {
            get
            {
                return new EstimatesBreadCrumb();
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[48,9,48,82,1],[49,9,49,62,1],[53,13,53,14,1],[54,17,54,30,1],[55,17,55,18,1],[56,21,56,39,1],[56,40,56,90,1],[57,21,57,82,1],[58,21,58,60,1],[59,25,59,74,1],[61,21,61,50,1],[63,13,63,14,1],[66,9,66,54,1],[67,9,67,45,1],[69,9,69,33,1],[70,9,70,10,1],[72,9,72,10,1],[77,9,77,10,0],[78,13,78,68,0],[79,13,79,65,0],[80,13,80,32,0],[81,9,81,10,0],[84,9,84,10,0],[86,13,86,14,0],[87,17,87,47,0],[88,17,88,75,0],[89,17,89,34,0],[91,13,91,33,0],[92,13,92,14,0],[93,17,93,109,0],[94,17,94,23,0],[96,9,96,10,0],[99,9,99,10,0],[100,13,100,33,0],[101,9,101,10,0],[108,9,108,10,1],[109,13,109,104,1],[110,13,110,136,1],[111,13,111,136,1],[112,13,112,111,1],[113,13,113,116,1],[117,13,117,69,1],[119,13,119,36,1],[121,13,121,53,1],[123,13,123,38,1],[124,13,124,72,1],[125,13,125,14,0],[126,17,127,121,0],[129,17,129,78,0],[131,17,131,34,0],[132,17,132,18,0],[133,21,133,75,0],[134,21,134,77,0],[135,17,135,18,0],[136,13,136,14,0],[139,13,139,44,1],[140,13,140,14,1],[141,17,141,147,1],[142,21,142,100,0],[144,21,144,94,1],[145,13,145,14,1],[147,13,147,14,0],[148,17,148,73,0],[149,13,149,14,0],[151,13,157,64,1],[159,13,159,136,1],[160,13,160,43,1],[163,13,164,143,1],[166,13,166,89,1],[167,13,167,46,1],[169,13,169,74,1],[170,13,170,14,0],[171,17,171,83,0],[173,17,176,111,0],[177,17,177,18,0],[178,21,178,77,0],[179,25,179,98,0],[180,26,180,114,0],[181,25,181,84,0],[182,26,182,116,0],[183,25,183,87,0],[184,26,184,122,0],[185,21,185,22,0],[186,25,186,87,0],[187,25,187,59,0],[187,60,187,124,0],[188,21,188,22,0],[190,25,190,89,0],[191,17,191,18,0],[192,13,192,14,0],[194,13,194,74,1],[196,13,196,129,1],[197,13,197,20,1],[197,22,197,33,1],[197,34,197,36,1],[197,37,197,53,1],[198,13,198,14,1],[199,17,199,36,1],[200,17,200,85,1],[201,17,201,147,1],[202,17,202,18,0],[203,21,205,89,0],[206,17,206,18,0],[208,17,208,18,1],[209,21,211,68,1],[212,17,212,18,1],[213,17,213,84,1],[214,17,214,75,1],[215,17,215,18,0],[216,21,218,124,0],[219,21,219,65,0],[220,17,220,18,0],[222,21,222,56,1],[224,17,224,121,1],[225,17,225,18,1],[229,21,229,119,1],[230,21,230,76,1],[231,21,231,112,1],[238,21,238,78,1],[239,25,240,101,0],[245,21,245,22,1],[246,25,248,108,1],[249,25,249,58,1],[250,25,250,26,0],[251,29,251,51,0],[252,29,252,121,0],[253,29,253,75,0],[255,29,255,36,0],[255,38,255,51,0],[255,52,255,54,0],[255,55,255,73,0],[256,29,256,30,0],[257,33,259,71,0],[261,33,263,137,0],[264,33,264,72,0],[265,33,265,85,0],[266,33,266,34,0],[267,37,267,206,0],[268,41,275,71,0],[276,33,276,34,0],[278,33,286,71,0],[289,33,289,77,0],[290,33,290,34,0],[291,37,297,71,0],[298,33,298,34,0],[300,33,304,71,0],[305,33,305,147,0],[306,33,309,71,0],[310,29,310,30,0],[311,25,311,26,0],[312,21,312,22,1],[313,21,313,48,0],[314,21,314,22,0],[315,25,315,41,0],[320,21,320,78,1],[321,21,321,22,1],[322,25,322,83,1],[323,29,323,148,0],[324,21,324,22,1],[327,21,327,73,1],[328,21,328,22,0],[329,25,329,194,0],[330,29,336,58,0],[337,21,337,22,0],[338,21,345,58,1],[347,21,347,116,1],[348,21,348,52,1],[349,25,355,58,0],[357,21,357,54,1],[358,21,358,22,1],[359,25,359,77,1],[360,25,360,26,1],[361,29,361,670,1],[362,29,362,30,1],[363,33,364,154,1],[365,33,365,77,1],[366,29,366,30,1],[367,25,367,26,1],[368,21,368,22,1],[370,21,370,62,1],[371,25,377,58,0],[379,21,383,58,1],[386,21,386,140,1],[388,21,389,103,1],[390,17,390,18,1],[391,17,391,74,1],[392,21,392,27,1],[393,13,393,14,0],[394,13,394,25,1],[395,9,395,10,1],[397,9,397,10,0],[398,13,398,53,0],[399,9,399,10,0],[400,41,400,42,0],[400,43,400,60,0],[400,61,400,62,0],[400,67,400,68,0],[400,69,400,70,0],[401,40,401,41,1],[401,42,401,59,1],[401,60,401,61,1],[401,66,401,67,0],[401,68,401,69,0],[406,9,406,10,1],[407,13,407,37,1],[409,13,409,61,1],[410,13,410,42,1],[412,13,412,20,1],[412,22,412,32,1],[412,33,412,35,1],[412,36,412,53,1],[413,13,413,14,1],[414,17,414,137,1],[415,17,415,18,1],[417,21,417,76,1],[418,21,418,22,0],[419,25,419,75,0],[420,25,420,56,0],[421,25,421,65,0],[422,29,422,52,0],[424,25,424,139,0],[427,25,427,85,0],[428,29,429,69,0],[431,29,431,149,0],[435,21,435,22,0],[436,17,436,18,1],[437,13,437,14,1],[438,9,438,10,1],[443,9,443,10,0],[444,13,444,98,0],[445,9,445,10,0],[448,9,448,10,0],[449,13,449,83,0],[450,9,450,10,0],[453,9,453,10,0],[454,13,454,100,0],[455,9,455,10,0],[458,9,458,10,0],[460,13,460,14,0],[461,17,461,85,0],[463,13,463,33,0],[464,13,464,14,0],[465,17,465,85,0],[466,17,466,23,0],[468,9,468,10,0],[471,9,471,10,0],[473,13,473,14,0],[474,17,474,78,0],[476,13,476,33,0],[477,13,477,14,0],[478,17,478,85,0],[479,17,479,23,0],[481,9,481,10,0],[484,9,484,10,0],[486,13,486,14,0],[487,17,487,74,0],[489,13,489,33,0],[490,13,490,14,0],[491,17,491,85,0],[492,17,492,23,0],[494,9,494,10,0],[497,9,497,10,0],[499,13,499,14,0],[500,17,500,89,0],[502,13,502,33,0],[503,13,503,14,0],[504,17,504,85,0],[505,17,505,23,0],[507,9,507,10,0],[510,9,510,10,0],[511,13,511,86,0],[512,9,512,10,0],[516,9,516,10,1],[518,13,518,14,1],[519,17,521,151,1],[523,13,523,33,0],[524,13,524,14,0],[525,17,525,85,0],[526,17,526,23,0],[528,9,528,10,1],[532,9,532,10,0],[533,13,534,79,0],[535,9,535,10,0],[538,9,538,10,1],[539,13,540,87,1],[541,9,541,10,1],[544,9,544,10,1],[546,13,546,14,1],[547,17,547,83,1],[549,13,549,33,0],[550,13,550,14,0],[551,17,551,85,0],[552,17,552,23,0],[554,9,554,10,1],[557,9,557,10,0],[558,13,558,79,0],[559,9,559,10,0],[562,9,562,10,0],[563,13,563,81,0],[564,9,564,10,0],[567,9,567,10,0],[568,13,568,80,0],[569,9,569,10,0],[572,9,572,10,0],[574,13,574,14,0],[575,17,575,83,0],[577,13,577,33,0],[578,13,578,14,0],[579,17,579,85,0],[580,17,580,23,0],[582,9,582,10,0],[585,9,585,10,0],[587,13,587,14,0],[588,17,588,72,0],[590,13,590,33,0],[591,13,591,14,0],[592,17,592,85,0],[593,17,593,23,0],[595,9,595,10,0],[598,9,598,10,0],[600,13,600,14,0],[601,17,601,106,0],[603,13,603,33,0],[604,13,604,14,0],[605,17,605,85,0],[606,17,606,23,0],[608,9,608,10,0],[611,9,611,10,1],[613,13,613,14,1],[632,17,632,95,1],[636,13,636,33,0],[637,13,637,14,0],[638,17,638,85,0],[639,17,639,23,0],[641,9,641,10,1],[644,9,644,10,1],[646,13,646,14,1],[647,17,647,99,1],[649,13,649,33,0],[650,13,650,14,0],[651,17,651,85,0],[652,17,652,23,0],[654,9,654,10,1],[657,9,657,10,1],[659,13,659,14,1],[660,17,660,88,1],[663,13,663,33,0],[664,13,664,14,0],[665,17,665,85,0],[666,17,666,23,0],[668,9,668,10,1],[671,9,671,10,1],[673,13,673,14,1],[674,17,674,84,1],[676,13,676,33,0],[677,13,677,14,0],[678,17,678,85,0],[679,17,679,23,0],[681,9,681,10,1],[684,9,684,10,1],[686,13,686,14,1],[687,17,687,70,1],[689,13,689,33,0],[690,13,690,14,0],[691,17,691,85,0],[692,17,692,23,0],[694,9,694,10,1],[697,9,697,10,1],[699,13,699,14,1],[700,17,700,109,1],[702,13,702,33,0],[703,13,703,14,0],[704,17,704,85,0],[705,17,705,23,0],[707,9,707,10,1],[710,9,710,10,0],[712,13,712,14,0],[713,17,713,111,0],[715,13,715,33,0],[716,13,716,14,0],[717,17,717,85,0],[718,17,718,23,0],[720,9,720,10,0],[723,9,723,10,0],[725,13,725,14,0],[726,17,726,72,0],[728,13,728,33,0],[729,13,729,14,0],[730,17,730,85,0],[731,17,731,23,0],[733,9,733,10,0],[736,9,736,10,1],[738,13,738,14,1],[739,17,739,114,1],[741,13,741,33,0],[742,13,742,14,0],[743,17,743,85,0],[744,17,744,23,0],[746,9,746,10,1],[749,9,749,10,1],[751,13,751,14,1],[752,17,752,70,1],[754,13,754,33,0],[755,13,755,14,0],[756,17,756,85,0],[757,17,757,23,0],[759,9,759,10,1],[762,9,762,10,1],[764,13,764,14,1],[765,17,765,81,1],[767,13,767,33,0],[768,13,768,14,0],[769,17,769,85,0],[770,17,770,23,0],[772,9,772,10,1],[775,9,775,10,1],[777,13,777,14,1],[778,17,778,110,1],[780,13,780,33,0],[781,13,781,14,0],[782,17,782,85,0],[783,17,783,23,0],[785,9,785,10,1],[788,9,788,10,1],[790,13,790,14,1],[791,17,791,68,1],[793,13,793,33,0],[794,13,794,14,0],[795,17,795,85,0],[796,17,796,23,0],[798,9,798,10,1],[801,9,801,10,0],[802,13,802,49,0],[803,13,803,65,0],[804,9,804,10,0],[807,9,807,10,0],[808,13,808,89,0],[809,9,809,10,0],[812,9,812,10,0],[813,13,813,68,0],[814,9,814,10,0],[817,9,817,10,0],[819,13,819,14,0],[820,17,820,110,0],[822,13,822,33,0],[823,13,823,14,0],[824,17,824,85,0],[825,17,825,23,0],[827,9,827,10,0],[830,9,830,10,0],[832,13,832,14,0],[833,17,833,67,0],[835,13,835,33,0],[836,13,836,14,0],[837,17,837,85,0],[838,17,838,23,0],[840,9,840,10,0],[843,9,843,10,0],[845,13,845,14,0],[846,17,846,71,0],[848,13,848,33,0],[849,13,849,14,0],[850,17,850,85,0],[851,17,851,23,0],[853,9,853,10,0],[856,9,856,10,0],[858,13,858,14,0],[859,17,859,88,0],[861,13,861,33,0],[862,13,862,14,0],[863,17,863,85,0],[864,17,864,23,0],[866,9,866,10,0],[869,9,869,10,0],[871,13,871,14,0],[872,17,872,75,0],[874,13,874,33,0],[875,13,875,14,0],[876,17,876,85,0],[877,17,877,23,0],[879,9,879,10,0],[882,9,882,10,1],[884,13,884,14,1],[885,17,885,88,1],[887,13,887,33,0],[888,13,888,14,0],[889,17,889,85,0],[890,17,890,23,0],[892,9,892,10,1],[894,9,894,10,1],[896,13,896,14,1],[897,17,897,91,1],[899,13,899,33,0],[900,13,900,14,0],[901,17,901,85,0],[902,17,902,23,0],[904,9,904,10,1],[907,9,907,10,0],[909,13,909,14,0],[910,17,910,115,0],[912,13,912,33,0],[913,13,913,14,0],[914,17,914,85,0],[915,17,915,23,0],[917,9,917,10,0],[920,9,920,10,0],[922,13,922,14,0],[923,17,923,82,0],[925,13,925,33,0],[926,13,926,14,0],[927,17,927,85,0],[928,17,928,23,0],[930,9,930,10,0],[933,9,933,10,0],[935,13,935,14,0],[936,17,936,82,0],[938,13,938,33,0],[939,13,939,14,0],[940,17,940,85,0],[941,17,941,23,0],[943,9,943,10,0],[947,9,947,10,0],[948,13,948,39,0],[949,13,949,42,0],[953,13,953,14,0],[954,17,954,47,0],[955,17,955,66,0],[956,17,956,41,0],[957,17,957,53,0],[958,17,958,56,0],[959,17,959,54,0],[960,17,960,55,0],[971,17,971,43,0],[972,17,972,18,0],[973,21,973,60,0],[974,21,974,91,0],[975,21,975,43,0],[977,21,978,59,0],[979,25,979,55,0],[980,17,980,18,0],[982,17,982,70,0],[983,17,983,18,0],[984,21,984,81,0],[985,21,985,110,0],[986,21,986,52,0],[988,21,989,54,0],[991,21,992,100,0],[993,21,993,64,0],[996,21,996,59,0],[997,21,997,22,0],[998,25,998,59,0],[999,25,999,99,0],[1000,25,1000,55,0],[1001,25,1001,66,0],[1002,25,1002,105,0],[1003,21,1003,22,0],[1006,21,1006,59,0],[1007,21,1007,22,0],[1008,25,1008,60,0],[1009,25,1009,97,0],[1010,25,1010,54,0],[1012,25,1012,67,0],[1013,25,1013,107,0],[1014,21,1014,22,0],[1017,21,1017,59,0],[1018,21,1018,22,0],[1019,25,1019,63,0],[1020,25,1020,99,0],[1021,25,1021,59,0],[1023,25,1023,70,0],[1024,25,1024,113,0],[1025,21,1025,22,0],[1028,21,1028,59,0],[1029,21,1029,22,0],[1030,25,1030,61,0],[1031,25,1031,100,0],[1032,25,1032,58,0],[1034,25,1034,68,0],[1035,25,1035,109,0],[1036,21,1036,22,0],[1037,17,1037,18,0],[1040,17,1040,45,0],[1041,17,1041,27,0],[1042,17,1042,48,0],[1043,17,1043,29,0],[1045,13,1045,33,0],[1046,13,1046,14,0],[1047,17,1047,85,0],[1048,17,1048,23,0],[1051,13,1051,14,0],[1052,17,1052,31,0],[1053,17,1053,31,0],[1054,13,1054,14,0],[1055,9,1055,10,0],[1058,9,1058,10,1],[1060,13,1060,14,1],[1061,17,1061,89,1],[1063,13,1063,33,0],[1064,13,1064,14,0],[1065,17,1065,85,0],[1066,17,1066,23,0],[1068,9,1068,10,1],[1084,9,1084,10,0],[1086,13,1086,14,0],[1087,17,1087,93,0],[1089,13,1089,33,0],[1090,13,1090,14,0],[1091,17,1091,85,0],[1092,17,1092,23,0],[1094,9,1094,10,0],[1097,9,1097,10,0],[1099,13,1099,14,0],[1100,17,1100,94,0],[1102,13,1102,33,0],[1103,13,1103,14,0],[1104,17,1104,85,0],[1105,17,1105,23,0],[1107,9,1107,10,0],[1110,9,1110,10,1],[1112,13,1112,14,1],[1113,17,1113,79,1],[1115,13,1115,33,0],[1116,13,1116,14,0],[1117,17,1117,85,0],[1118,17,1118,23,0],[1120,9,1120,10,1],[1123,9,1123,10,1],[1125,13,1125,14,1],[1126,17,1126,83,1],[1128,13,1128,33,0],[1129,13,1129,14,0],[1130,17,1130,85,0],[1131,17,1131,23,0],[1133,9,1133,10,1],[1136,9,1136,10,0],[1138,13,1138,14,0],[1139,17,1139,99,0],[1141,13,1141,33,0],[1142,13,1142,14,0],[1143,17,1143,85,0],[1144,17,1144,23,0],[1146,9,1146,10,0],[1149,9,1149,10,1],[1151,13,1151,14,1],[1152,17,1152,73,1],[1154,13,1154,33,0],[1155,13,1155,14,0],[1156,17,1156,85,0],[1157,17,1157,23,0],[1159,9,1159,10,1],[1163,9,1163,10,0],[1165,13,1165,14,0],[1166,17,1167,95,0],[1169,13,1169,33,0],[1170,13,1170,14,0],[1171,17,1171,85,0],[1172,17,1172,23,0],[1174,9,1174,10,0],[1177,9,1177,10,1],[1179,13,1179,14,1],[1180,17,1181,89,1],[1183,13,1183,33,0],[1184,13,1184,14,0],[1185,17,1185,85,0],[1186,17,1186,23,0],[1188,9,1188,10,1],[1191,9,1191,10,1],[1193,13,1193,14,1],[1194,17,1194,86,1],[1196,13,1196,33,0],[1197,13,1197,14,0],[1198,17,1198,85,0],[1199,17,1199,23,0],[1201,9,1201,10,1],[1204,9,1204,10,1],[1206,13,1206,14,1],[1207,17,1207,72,1],[1209,13,1209,33,0],[1210,13,1210,14,0],[1211,17,1211,85,0],[1212,17,1212,23,0],[1214,9,1214,10,1],[1217,9,1217,10,1],[1219,13,1219,14,1],[1220,17,1220,72,1],[1222,13,1222,33,0],[1223,13,1223,14,0],[1224,17,1224,85,0],[1225,17,1225,23,0],[1227,9,1227,10,1],[1230,9,1230,10,0],[1232,13,1232,14,0],[1233,17,1233,80,0],[1235,13,1235,33,0],[1236,13,1236,14,0],[1237,17,1237,85,0],[1238,17,1238,23,0],[1240,9,1240,10,0],[1243,9,1243,10,1],[1245,13,1245,14,1],[1246,17,1246,84,1],[1248,13,1248,33,0],[1249,13,1249,14,0],[1250,17,1250,85,0],[1251,17,1251,23,0],[1253,9,1253,10,1],[1256,9,1256,10,1],[1258,13,1258,14,1],[1259,17,1259,76,1],[1261,13,1261,33,0],[1262,13,1262,14,0],[1263,17,1263,85,0],[1264,17,1264,23,0],[1266,9,1266,10,1],[1269,9,1269,10,0],[1271,13,1271,14,0],[1272,17,1272,79,0],[1274,13,1274,33,0],[1275,13,1275,14,0],[1276,17,1276,85,0],[1277,17,1277,23,0],[1279,9,1279,10,0],[1282,9,1282,10,1],[1284,13,1284,14,1],[1285,17,1285,103,1],[1287,13,1287,33,0],[1288,13,1288,14,0],[1289,17,1289,85,0],[1290,17,1290,23,0],[1292,9,1292,10,1],[1295,9,1295,10,0],[1297,13,1297,14,0],[1298,17,1298,78,0],[1300,13,1300,33,0],[1301,13,1301,14,0],[1302,17,1302,85,0],[1303,17,1303,23,0],[1305,9,1305,10,0],[1308,9,1308,10,1],[1310,13,1310,14,1],[1311,17,1311,81,1],[1313,13,1313,33,0],[1314,13,1314,14,0],[1315,17,1315,85,0],[1316,17,1316,23,0],[1318,9,1318,10,1],[1322,9,1322,10,0],[1324,13,1324,14,0],[1332,17,1333,77,0],[1336,13,1336,33,0],[1337,13,1337,14,0],[1338,17,1338,85,0],[1339,17,1339,23,0],[1341,9,1341,10,0],[1344,9,1344,10,0],[1346,13,1346,14,0],[1347,17,1347,109,0],[1349,13,1349,33,0],[1350,13,1350,14,0],[1351,17,1351,85,0],[1352,17,1352,23,0],[1354,9,1354,10,0],[1358,9,1358,10,1],[1360,13,1360,14,1],[1362,17,1363,77,1],[1365,13,1365,33,0],[1366,13,1366,14,0],[1367,17,1367,85,0],[1368,17,1368,23,0],[1370,9,1370,10,1],[1373,9,1373,10,1],[1375,13,1375,14,1],[1376,17,1376,101,1],[1378,13,1378,33,0],[1379,13,1379,14,0],[1380,17,1380,85,0],[1381,17,1381,23,0],[1383,9,1383,10,1],[1386,9,1386,10,0],[1388,13,1388,14,0],[1396,17,1396,84,0],[1399,13,1399,33,0],[1400,13,1400,14,0],[1401,17,1401,85,0],[1402,17,1402,23,0],[1404,9,1404,10,0],[1407,9,1407,10,1],[1409,13,1409,14,1],[1410,17,1410,85,1],[1412,13,1412,33,0],[1413,13,1413,14,0],[1414,17,1414,85,0],[1415,17,1415,23,0],[1417,9,1417,10,1],[1420,9,1420,10,1],[1422,13,1422,14,1],[1423,17,1423,90,1],[1425,13,1425,33,0],[1426,13,1426,14,0],[1427,17,1427,85,0],[1428,17,1428,23,0],[1430,9,1430,10,1],[1433,9,1433,10,1],[1435,13,1435,14,1],[1436,17,1436,108,1],[1438,13,1438,33,0],[1439,13,1439,14,0],[1440,17,1440,85,0],[1441,17,1441,23,0],[1443,9,1443,10,1],[1446,9,1446,10,1],[1448,13,1448,14,1],[1449,17,1449,97,1],[1451,13,1451,33,0],[1452,13,1452,14,0],[1453,17,1453,85,0],[1454,17,1454,23,0],[1456,9,1456,10,1],[1459,9,1459,10,1],[1461,13,1461,14,1],[1462,17,1462,78,1],[1464,13,1464,33,0],[1465,13,1465,14,0],[1466,17,1466,85,0],[1467,17,1467,23,0],[1469,9,1469,10,1],[1472,9,1472,10,1],[1474,13,1474,14,1],[1475,17,1475,83,1],[1477,13,1477,33,0],[1478,13,1478,14,0],[1479,17,1479,85,0],[1480,17,1480,23,0],[1482,9,1482,10,1],[1485,9,1485,10,1],[1487,13,1487,14,1],[1488,17,1488,69,1],[1490,13,1490,33,0],[1491,13,1491,14,0],[1492,17,1492,85,0],[1493,17,1493,23,0],[1495,9,1495,10,1],[1498,9,1498,10,1],[1500,13,1500,14,1],[1501,17,1501,91,1],[1503,13,1503,33,0],[1504,13,1504,14,0],[1505,17,1505,85,0],[1506,17,1506,23,0],[1508,9,1508,10,1],[1511,9,1511,10,1],[1513,13,1513,14,1],[1514,17,1514,76,1],[1516,13,1516,33,0],[1517,13,1517,14,0],[1518,17,1518,85,0],[1519,17,1519,23,0],[1521,9,1521,10,1],[1524,9,1524,10,0],[1526,13,1526,14,0],[1527,17,1527,89,0],[1529,13,1529,33,0],[1530,13,1530,14,0],[1531,17,1531,85,0],[1532,17,1532,23,0],[1534,9,1534,10,0],[1537,9,1537,10,0],[1539,13,1539,14,0],[1540,17,1540,82,0],[1542,13,1542,33,0],[1543,13,1543,14,0],[1544,17,1544,85,0],[1545,17,1545,23,0],[1547,9,1547,10,0],[1550,9,1550,10,0],[1552,13,1552,14,0],[1553,17,1553,79,0],[1555,13,1555,33,0],[1556,13,1556,14,0],[1557,17,1557,85,0],[1558,17,1558,23,0],[1560,9,1560,10,0],[1563,9,1563,10,0],[1565,13,1565,14,0],[1566,17,1566,82,0],[1568,13,1568,33,0],[1569,13,1569,14,0],[1570,17,1570,85,0],[1571,17,1571,23,0],[1573,9,1573,10,0],[1576,9,1576,10,0],[1578,13,1578,14,0],[1579,17,1579,90,0],[1581,13,1581,33,0],[1582,13,1582,14,0],[1583,17,1583,85,0],[1584,17,1584,23,0],[1586,9,1586,10,0],[1589,9,1589,10,1],[1591,13,1591,14,1],[1592,17,1592,114,1],[1594,13,1594,33,0],[1595,13,1595,14,0],[1596,17,1596,85,0],[1597,17,1597,23,0],[1599,9,1599,10,1],[1602,9,1602,10,1],[1604,13,1604,14,1],[1605,17,1605,82,1],[1607,13,1607,33,0],[1608,13,1608,14,0],[1609,17,1609,85,0],[1610,17,1610,23,0],[1612,9,1612,10,1],[1615,9,1615,10,0],[1617,13,1617,14,0],[1618,17,1618,84,0],[1620,13,1620,33,0],[1621,13,1621,14,0],[1622,17,1622,85,0],[1623,17,1623,23,0],[1625,9,1625,10,0],[1628,9,1628,10,0],[1630,13,1630,14,0],[1631,17,1631,102,0],[1633,13,1633,33,0],[1634,13,1634,14,0],[1635,17,1635,85,0],[1636,17,1636,23,0],[1638,9,1638,10,0],[1641,9,1641,10,0],[1643,13,1643,14,0],[1644,17,1644,84,0],[1646,13,1646,33,0],[1647,13,1647,14,0],[1648,17,1648,85,0],[1649,17,1649,23,0],[1651,9,1651,10,0],[1654,9,1654,10,0],[1656,13,1656,14,0],[1668,17,1668,102,0],[1670,13,1670,33,0],[1671,13,1671,14,0],[1672,17,1672,85,0],[1673,17,1673,23,0],[1675,9,1675,10,0],[1678,9,1678,10,1],[1679,13,1680,106,1],[1690,13,1690,68,1],[1691,13,1691,46,1],[1694,13,1694,46,1],[1696,13,1696,52,1],[1697,13,1697,14,1],[1698,17,1698,50,1],[1699,17,1699,52,1],[1700,17,1700,84,1],[1701,17,1701,89,1],[1702,17,1702,78,1],[1703,13,1703,14,1],[1705,13,1705,52,1],[1706,13,1706,14,0],[1708,17,1708,50,0],[1710,17,1710,45,0],[1711,17,1711,73,0],[1712,17,1712,18,0],[1713,21,1713,109,0],[1714,21,1714,76,0],[1715,17,1715,18,0],[1717,21,1717,61,0],[1719,17,1721,58,0],[1722,17,1722,85,0],[1723,17,1723,85,0],[1724,17,1724,79,0],[1725,17,1725,80,0],[1726,17,1726,80,0],[1727,17,1727,72,0],[1728,17,1728,74,0],[1729,17,1729,70,0],[1730,17,1730,78,0],[1731,17,1731,70,0],[1732,17,1732,74,0],[1733,13,1733,14,0],[1736,18,1736,27,1],[1736,29,1736,63,1],[1736,65,1736,68,0],[1737,13,1737,14,0],[1738,17,1738,50,0],[1739,17,1739,45,0],[1740,17,1740,79,0],[1741,17,1741,85,0],[1742,17,1742,85,0],[1743,17,1743,79,0],[1744,17,1744,80,0],[1745,17,1745,80,0],[1746,17,1746,78,0],[1747,17,1747,70,0],[1748,17,1748,74,0],[1749,17,1749,39,0],[1750,13,1750,14,0],[1752,13,1752,52,1],[1753,17,1753,39,0],[1755,13,1755,35,1],[1756,13,1756,35,1],[1758,13,1758,25,1],[1759,13,1759,40,1],[1760,13,1760,25,1],[1762,13,1762,47,1],[1763,13,1763,34,1],[1764,13,1764,35,1],[1766,13,1766,34,1],[1767,9,1767,10,1],[1770,9,1770,10,0],[1773,13,1773,44,0],[1778,13,1778,49,0],[1779,13,1779,60,0],[1780,13,1780,52,0],[1781,13,1781,33,0],[1782,13,1782,42,0],[1784,13,1784,20,0],[1784,22,1784,32,0],[1784,33,1784,35,0],[1784,36,1784,40,0],[1785,13,1785,14,0],[1786,17,1786,47,0],[1787,13,1787,14,0],[1788,13,1788,35,0],[1791,13,1791,40,0],[1792,13,1792,49,0],[1793,13,1793,91,0],[1794,13,1794,33,0],[1795,13,1795,40,0],[1797,13,1797,20,0],[1797,22,1797,32,0],[1797,33,1797,35,0],[1797,36,1797,40,0],[1798,13,1798,14,0],[1799,17,1799,47,0],[1800,13,1800,14,0],[1801,13,1801,35,0],[1804,13,1804,51,0],[1805,13,1805,50,0],[1806,13,1806,90,0],[1807,13,1807,33,0],[1808,13,1808,43,0],[1810,13,1810,20,0],[1810,22,1810,32,0],[1810,33,1810,35,0],[1810,36,1810,40,0],[1811,13,1811,14,0],[1812,17,1812,47,0],[1813,13,1813,14,0],[1814,13,1814,35,0],[1817,13,1817,52,0],[1818,13,1818,60,0],[1819,13,1819,33,0],[1820,13,1820,49,0],[1822,13,1822,20,0],[1822,22,1822,32,0],[1822,33,1822,35,0],[1822,36,1822,40,0],[1823,13,1823,14,0],[1824,17,1824,47,0],[1825,13,1825,14,0],[1826,13,1826,35,0],[1828,13,1828,23,0],[1829,9,1829,10,0],[1833,9,1833,10,1],[1834,13,1834,96,1],[1835,9,1835,10,1],[1839,9,1839,10,1],[1840,13,1841,89,1],[1842,9,1842,10,1],[1847,9,1847,10,0],[1848,13,1850,97,0],[1851,9,1851,10,0],[1854,9,1854,10,0],[1855,13,1855,90,0],[1856,9,1856,10,0],[1859,9,1859,10,0],[1860,13,1860,72,0],[1861,9,1861,10,0],[1864,9,1864,10,0],[1865,13,1865,48,0],[1866,13,1866,38,0],[1867,13,1867,89,0],[1868,13,1868,20,0],[1868,22,1868,36,0],[1868,37,1868,39,0],[1868,40,1868,52,0],[1869,13,1869,14,0],[1870,17,1870,43,0],[1871,21,1871,97,0],[1872,13,1872,14,0],[1874,13,1874,32,0],[1877,21,1877,22,0],[1878,25,1878,104,0],[1879,25,1879,51,0],[1879,52,1879,64,0],[1880,25,1880,61,0],[1881,25,1881,61,0],[1882,25,1882,107,0],[1883,25,1883,31,0],[1887,13,1887,25,0],[1888,9,1888,10,0],[1893,9,1893,10,0],[1894,13,1894,115,0],[1895,9,1895,10,0],[1898,9,1898,10,1],[1899,13,1899,84,1],[1900,9,1900,10,1],[1903,9,1903,10,0],[1905,13,1905,14,0],[1906,17,1906,82,0],[1908,13,1908,33,0],[1909,13,1909,14,0],[1910,17,1910,85,0],[1911,17,1911,23,0],[1913,9,1913,10,0],[1916,9,1916,10,1],[1918,13,1918,14,1],[1919,17,1919,90,1],[1921,13,1921,33,0],[1922,13,1922,14,0],[1923,17,1923,85,0],[1924,17,1924,23,0],[1926,9,1926,10,1],[1929,9,1929,10,1],[1931,13,1931,14,1],[1932,17,1932,80,1],[1934,17,1934,53,1],[1935,21,1935,33,1],[1937,17,1937,30,1],[1939,13,1939,33,0],[1940,13,1940,14,0],[1941,17,1941,85,0],[1942,17,1942,23,0],[1944,9,1944,10,1],[1947,9,1947,10,0],[1949,13,1949,14,0],[1950,17,1950,88,0],[1951,13,1951,14,0],[1952,13,1952,33,0],[1953,13,1953,14,0],[1954,17,1954,85,0],[1955,17,1955,23,0],[1957,9,1957,10,0],[1960,9,1960,10,0],[1962,13,1962,14,0],[1963,17,1963,110,0],[1965,13,1965,33,0],[1966,13,1966,14,0],[1967,17,1967,85,0],[1968,17,1968,23,0],[1970,9,1970,10,0],[1973,9,1973,10,1],[1975,13,1975,14,1],[1976,17,1976,105,1],[1978,13,1978,33,0],[1979,13,1979,14,0],[1980,17,1980,85,0],[1981,17,1981,23,0],[1983,9,1983,10,1],[1986,9,1986,10,0],[1988,13,1988,14,0],[1989,17,1989,83,0],[1991,13,1991,33,0],[1992,13,1992,14,0],[1993,17,1993,85,0],[1994,17,1994,23,0],[1996,9,1996,10,0],[1999,9,1999,10,1],[2001,13,2001,14,1],[2002,17,2002,95,1],[2004,13,2004,33,0],[2005,13,2005,14,0],[2006,17,2006,85,0],[2007,17,2007,23,0],[2009,9,2009,10,1],[2012,9,2012,10,0],[2014,13,2014,14,0],[2015,17,2015,87,0],[2017,13,2017,33,0],[2018,13,2018,14,0],[2019,17,2019,85,0],[2020,17,2020,23,0],[2022,9,2022,10,0],[2025,9,2025,10,0],[2027,13,2027,14,0],[2028,17,2028,106,0],[2030,13,2030,33,0],[2031,13,2031,14,0],[2032,17,2032,85,0],[2033,17,2033,23,0],[2036,9,2036,10,0],[2039,9,2039,10,0],[2041,13,2041,14,0],[2042,17,2042,92,0],[2044,13,2044,33,0],[2045,13,2045,14,0],[2046,17,2046,85,0],[2047,17,2047,23,0],[2049,9,2049,10,0],[2052,9,2052,10,1],[2054,13,2054,14,1],[2055,17,2055,125,1],[2057,13,2057,33,0],[2058,13,2058,14,0],[2059,17,2059,85,0],[2060,17,2060,23,0],[2062,9,2062,10,1],[2064,9,2064,10,1],[2066,13,2066,14,1],[2067,17,2067,77,1],[2069,13,2069,33,0],[2070,13,2070,14,0],[2071,17,2071,85,0],[2072,17,2072,23,0],[2074,9,2074,10,1],[2076,9,2076,10,1],[2078,13,2078,14,1],[2079,17,2079,98,1],[2081,13,2081,33,0],[2082,13,2082,14,0],[2083,17,2083,85,0],[2084,17,2084,23,0],[2086,9,2086,10,1],[2088,9,2088,10,0],[2090,13,2090,14,0],[2091,17,2091,96,0],[2093,13,2093,33,0],[2094,13,2094,14,0],[2095,17,2095,85,0],[2096,17,2096,23,0],[2098,9,2098,10,0],[2100,9,2100,10,0],[2101,13,2101,88,0],[2102,9,2102,10,0],[2105,9,2105,10,0],[2107,13,2107,14,0],[2108,17,2108,109,0],[2110,13,2110,33,0],[2111,13,2111,14,0],[2112,17,2112,85,0],[2113,17,2113,23,0],[2115,9,2115,10,0],[2117,9,2117,10,1],[2119,13,2119,14,1],[2120,17,2120,118,1],[2122,13,2122,33,0],[2123,13,2123,14,0],[2124,17,2124,85,0],[2125,17,2125,23,0],[2127,9,2127,10,1],[2129,9,2129,10,0],[2131,13,2131,14,0],[2132,17,2132,137,0],[2134,13,2134,33,0],[2135,13,2135,14,0],[2136,17,2136,85,0],[2137,17,2137,23,0],[2139,9,2139,10,0],[2142,9,2142,10,1],[2143,13,2143,78,1],[2144,13,2144,29,1],[2145,17,2145,40,1],[2147,17,2147,27,0],[2149,9,2149,10,1],[2154,44,2154,45,1],[2154,46,2154,143,1],[2154,144,2154,145,1],[2159,13,2159,14,1],[2160,17,2160,77,1],[2161,17,2161,96,1],[2162,13,2162,14,1],[2168,13,2168,14,1],[2169,17,2169,48,1],[2170,13,2170,14,1],[2177,9,2177,34,1],[2182,13,2182,14,1],[2183,17,2183,90,1],[2184,17,2184,46,1],[2185,21,2185,78,1],[2186,17,2186,46,1],[2187,21,2187,73,1],[2188,17,2188,27,1],[2189,13,2189,14,1],[2195,13,2195,14,1],[2196,17,2196,74,1],[2197,21,2197,31,1],[2198,17,2198,66,0],[2199,17,2199,34,0],[2200,21,2200,185,0],[2201,17,2201,27,0],[2202,13,2202,14,1],[2208,13,2208,14,1],[2209,17,2209,77,1],[2210,17,2210,34,1],[2211,21,2211,159,1],[2212,17,2212,27,0],[2213,13,2213,14,1],[2219,13,2219,14,1],[2220,17,2220,50,1],[2221,13,2221,14,1]]);
    </script>
  </body>
</html>