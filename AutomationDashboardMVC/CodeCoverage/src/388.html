<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Core Modules\Submittals\CreateSubmittal.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.SubmittalsBL;
using Aurigo.AMP3.SubmittalsDTO;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebSchedule;
using System.Web;
using Aurigo.Brix.Platform.BusinessLayer.DataResouces;
using System.Threading;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;

namespace Aurigo.AMP3.Submittals.UI
{
    public partial class CreateSubmittal : BrixPageBase, IWorkflowEnabled, IXMLControl
    {
        protected global::Aurigo.AMP3.Core.UserControls.AttachmentsControl attachments;

        protected ModalPopupExtender PopupExtender;

        /// &lt;summary&gt;
        /// Gets the Integration Cutoff Date
        /// &lt;/summary&gt;
        private DateTime IntegrationCutoffDate
        {
            get { return ((DateTime)Session[Constants.APP_IntegrationCutoffDate]).AddDays(-1); }
        }

        /// &lt;summary&gt;
        /// Gets the Default Record Date
        /// &lt;/summary&gt;
        private DateTime DefaultRecordDate
        {
            get { return (DateTime)Session[Constants.APP_DefaultRecordDate]; }
        }

        /// &lt;summary&gt;
        /// Gets the Project Mode : I-Integration, L-Live
        /// &lt;/summary&gt;
        private string ProjectMode
        {
            get { return (CacheManager.Instance.IsIntegrated(PID) ? &quot;I&quot; : &quot;L&quot;); }
        }

        private BrixFormModel model;
        private XMLFormManagerModel managerModel;

        #region IWorkflowEnabled Members

        public void CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            throw new NotImplementedException();
        }

        public string ClientValidationFunction
        {
            get { return &quot;SaveCheck()&quot;; }
        }

        public string FormInstanceId
        {
            get
            {
                int id = String.IsNullOrEmpty(Request.QueryString[&quot;SubmittalID&quot;])
                             ? -1
                             : int.TryParse(Request.QueryString[&quot;SubmittalID&quot;], out id) ? id : -1;
                return id.ToString();
            }
        }

        public string FormKey { get { return string.Format(&quot;Submittal Type : {0}, Submittal Requirement : {1}&quot;, ddlSubmittalType.SelectedItem.Text, ddlRequirement.SelectedItem.Text); } }

        public string FormName
        {
            get { return &quot;SUBREGR&quot;; }
        }

        public bool IsOldWorkflow
        {
            get { return true; }
        }

        public int PID
        {
            get { return Request.QueryString[&quot;PID&quot;].ToInt32_2(); }
        }

        public int ParentModuleId
        {
            get
            {
                if(!String.IsNullOrWhiteSpace(Request.QueryString[&quot;ParentID&quot;]))
                {
                    return Request.QueryString[&quot;ParentID&quot;].ToInt32_2();
                }
                int id = String.IsNullOrEmpty(Request.QueryString[&quot;PID&quot;])
                             ? -1
                             : int.TryParse(Request.QueryString[&quot;PID&quot;], out id) ? id : -1;
                return id;
            }
        }

        public string PostCancelRedirectUrl
        {
            get
            {
                return ResolveUrl(String.Format(CultureInfo.CurrentCulture, &quot;~/Common/BrixListPage.aspx?context=SUBMTAL&amp;PID={0}&amp;Link={1}&amp;LinkID={2}&amp;ParentID={3}&quot;,
                                     PID, Request[&quot;Link&quot;], Request[&quot;LinkID&quot;], Request[&quot;LinkID&quot;]));
            }
        }

        public string PostSaveRedirectUrl(string sSavedToken = &quot;&quot;)
        {
            return String.Format(CultureInfo.CurrentCulture,
                                 &quot;~/Common/BrixListPage.aspx?context=SUBMTAL&amp;PID={0}&amp;Link={1}&amp;LinkID={2}&amp;ParentID={3}&quot;, PID, Request[&quot;Link&quot;], Request[&quot;LinkID&quot;], Request[&quot;LinkID&quot;]);
        }

        public bool SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors,
                                out string sRedirectTo)
        {
            sSavedInstanceToken = &quot;&quot;;
            sRedirectTo = &quot;&quot;;
            sErrors = &quot;&quot;;

            try
            {
                if (Request[&quot;Link&quot;] != &quot;PROJECT&quot; &amp;&amp; Request[&quot;Link&quot;] != &quot;LANDMGT&quot; &amp;&amp; rbItemLvl.Checked &amp;&amp;
                    String.IsNullOrEmpty(txtItemDesc.Text))
                {
                    throw new Exception(&quot;Please Select &quot; + LocalizationManager.GetString(KeyConstants.LOC_AN_ITEM) + &quot;.&quot;);
                }
                if (Request[&quot;Link&quot;] != &quot;PROJECT&quot; &amp;&amp; Request[&quot;Link&quot;] != &quot;LANDMGT&quot; &amp;&amp; rbItemLvl.Checked &amp;&amp;
                    ddlComponent.Items.Count == 0)
                {
                    throw new Exception(&quot;Component is Mandatory.&quot;);
                }

                if (ddlSubmittalType.Items.Count == 0)
                {
                    throw new Exception(&quot;Submittal Type is mandatory.&quot;);
                }
                if (ddlRequirement.Items.Count == 0)
                {
                    throw new Exception(&quot;Submittal Requirement is mandatory.&quot;);
                }

                if(
                    Convert.ToDateTime(dtDueDate.Value, CultureInfo.CurrentCulture) &lt;
                    Convert.ToDateTime(wdcCreatedOn.Value, CultureInfo.CurrentCulture))
                {
                    throw new Exception(&quot;Approval due date is before the created on date.&quot;);
                }

                List&lt;DTOSubmittals&gt; submittals = new List&lt;DTOSubmittals&gt;();
                DTOSubmittals dto = new DTOSubmittals();

                dto.ProjectID = Request[&quot;PID&quot;].ToInt32_2();
                dto.ModuleCategory = Request[&quot;Link&quot;];
                if (Request[&quot;Link&quot;] != &quot;PROJECT&quot; &amp;&amp; Request[&quot;Link&quot;] != &quot;LANDMGT&quot;)
                {
                    if (rbItemLvl.Checked)
                    {
                        dto.ItemID = hdnItemID.Value.ToInt32_2();
                        dto.componentID = ddlComponent.SelectedValue.ToInt32_2(); //Not yet implemented..
                    }
                    dto.ModuleLinkID = Request[&quot;LinkID&quot;].ToInt32_2();
                }
                if (Request[&quot;Link&quot;].Equals(&quot;LANDMGT&quot;))
                    dto.ModuleLinkID = Request[&quot;LMID&quot;].ToInt32_2();
                dto.TypeID = ddlSubmittalType.SelectedValue.ToInt32_2();
                dto.RequirementID = ddlRequirement.SelectedValue.ToInt32_2();
                dto.Reference = txtRef.Text;
                dto.Notes = txtNotes.Text;
                dto.Remarks = txtRemarks.Text;
                dto.DueDate = dtDueDate.Value.ToUtcNullable();
                dto.HasAttachment = true;
                UserDetail ud = UserDetail.GetCurrentUserDetail();
                dto.CreatedBy = ud.UID;
                submittals.Add(dto);

                int id = SubmittalsManager.BLInstance.CUDSubmittals(Operations.Create, submittals);
                sSavedInstanceToken = id.ToString2();
                //using hasattachments() from updated linksUI dll reference.
                attachments.ParentModuleID = Request[&quot;Link&quot;];
                if (dto.ModuleLinkID.HasValue)
                    attachments.ParentInstanceID = dto.ModuleLinkID.Value;
                if (Request[&quot;Link&quot;].Equals(&quot;PROJECT&quot;))
                    attachments.ParentInstanceID = dto.ProjectID.Value;
                string moduleCode = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);
                if (attachments.SaveAttachments(id.ToString2(), moduleCode, ud.UID, ud.UserName, &quot;Submittal Attachments&quot;))
                    SubmittalsManager.BLInstance.UpdateAttachmentStatus(id, attachments.HasAttachments(), SubConstants.SUBMITTAL);
                return true;
            }
            catch (Exception ex)
            {
                ScriptManager.RegisterStartupScript(upGhost, GetType(), &quot;alert&quot;, &quot;ShowError(&#39;&quot; +
                    ex.Message.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;);&quot;, true);
                return false;
            }
        }

        #endregion

        private void GoBack()
        {
            Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, true);
        }

        private void SetManagerModel()
        {
            model = BrixFormModel.GetInstance(&quot;SUBREGR&quot;, &quot;SUBREGR&quot;, Request, Response);

            if (!string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp; !string.IsNullOrEmpty(model.form.FormManagerClass))
            {
                managerModel = AMP3InterfaceFactory.GetInstance&lt;XMLFormManagerModel&gt;(model.form.ManagerDLL,
                                                                                 model.form.FormManagerClass);
                // managerModel.PageViewState = ViewState;
            }
        }

        protected override void OnPreInit(EventArgs e)
        {
            //This seems like a bug hence commenting it after discussing with Akila
            //if (!String.IsNullOrEmpty(Request[&quot;PID&quot;]))
            //    ModuleId = Request[&quot;PID&quot;].Equals(&quot;0&quot;) ? &quot;LANDMGT&quot; : &quot;SUBMTAL&quot;;

            this.ModuleId = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);
            
            base.OnPreInit(e);
            SetManagerModel();
            if (managerModel != null)
                managerModel.OnPreInit(model, new XmlFormArgs());
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            #region URL Validation

            try
            {
                Request[&quot;PID&quot;].ToInt32_2();
                //BrixDatatypeHelper.ToInt32_2(Request[&quot;RegisterID&quot;]);
                Request[&quot;LinkID&quot;].ToInt32_2();
            }
            catch
            {
                GoBack();
            }

            if (string.IsNullOrEmpty(Request[&quot;PID&quot;]) || string.IsNullOrEmpty(Request[&quot;Link&quot;]) ||
                string.IsNullOrEmpty(Request[&quot;LinkID&quot;]))
            {
                GoBack();
            }

            if (
                !(Request[&quot;Link&quot;] == &quot;PROJECT&quot; || Request[&quot;Link&quot;] == &quot;LANDMGT&quot; || Request[&quot;Link&quot;] == &quot;CONTMGT&quot; ||
                  Request[&quot;Link&quot;] == &quot;ESTMATE&quot;))
            {
                GoBack();
            }

            #endregion

            #region Authorization

            UIHelper.DisableRoleSelection(Page);

            string strModID = SubmittalsManager.Helper_GetModuleId_ForSubmittals_ByLinkId(Request[&quot;Link&quot;], Constants.MODID_PROJECT_Submittals);

            List&lt;string&gt; featurelist = ModuleManager.Instance.GetPermissionByUserOrRole(strModID, UserDetail.GetCurrentUserDetail().UID,
                            UserDetail.GetCurrentUserDetail().RID, Request.QueryString[&quot;PID&quot;].ToInt32_2());

            if (!(featurelist.Contains(&quot;Create&quot;)))
                UIHelper.RedirectURL(
                    &quot;The current role does not have the required permissions to view this page.&quot;,
                    ResolveUrl(&quot;~/Common/BrixListPage.aspx?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                               &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                               Request[&quot;LinkID&quot;]+ &quot;&amp;ParentID=&quot;+Request[&quot;LinkID&quot;]), null, Context);

            #endregion

            if (!IsPostBack)
            {
                wdcCreatedOn.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
                wdcCreatedOn.MinDate = ProjectMode.Equals(&quot;L&quot;) ? MWDateTimeHelper.MWNow : DefaultRecordDate.ToMWDateTime();
                wdcCreatedOn.MaxDate = ProjectMode.Equals(&quot;L&quot;) ? MWDateTimeHelper.MWNow : IntegrationCutoffDate.ToMWDateTime();
                wdcCreatedOn.Value = ProjectMode.Equals(&quot;L&quot;) ? MWDateTimeHelper.MWNow : DefaultRecordDate.ToMWDateTime();
                wdcCreatedOn.Enabled = !ProjectMode.Equals(&quot;L&quot;);
                dtDueDate.MaxDate = ProjectMode.Equals(&quot;L&quot;) ? DateTime.MaxValue : IntegrationCutoffDate.ToMWDateTime();

                // Resetting the filter when the Reset All button is clicked.
                btnReset.Attributes.Add(&quot;onClick&quot;,
                                        &quot;document.getElementById(&#39;&quot; + btnFilterCncl.ClientID +
                                        &quot;&#39;).click();return resetFilters();&quot;);
                dtDueDate.Value = MWDateTimeHelper.MWNow;

                if ((Request[&quot;Link&quot;] == &quot;CONTMGT&quot;) || (Request[&quot;Link&quot;] == &quot;ESTMATE&quot;))
                {
                    hdnItem.Value = LocalizationManager.GetString(KeyConstants.LOC_ITEM_ABBR);
                    trSubmLevel.Visible = true;
                    trItems.Visible = true;
                    trContEstLvl.Visible = true;
                    BindData();
                    if (Request[&quot;Link&quot;] == &quot;CONTMGT&quot;)
                    {
                        lblSubmtalLevel.Text = &quot;Contract Level :&quot;;
                        lblComponent.Text = lblItemDesc.Text = &quot;Contract Level&quot;;
                        PopupExtender.Title = &quot;Contract/Non-Contract Items&quot;;
                    }
                    else if (Request[&quot;Link&quot;] == &quot;ESTMATE&quot;)
                    {
                        lblSubmtalLevel.Text = &quot;Estimate Level :&quot;;
                        lblComponent.Text = lblItemDesc.Text = &quot;Estimate Level&quot;;
                        PopupExtender.Title = &quot;Estimate Items&quot;;
                    }
                }
                else
                {
                    trSubmLevel.Visible = false;
                    trItems.Visible = false;
                    trContEstLvl.Visible = false;
                }
                LoadSubmittalType();

                string errDocuSign = string.Empty;
                if (Session[&quot;DocuSignErr&quot;] != null)
                    errDocuSign = Session[&quot;DocuSignErr&quot;].ToString();

                if (!string.IsNullOrEmpty(errDocuSign))
                {
                    ShowError(errDocuSign);
                    Session.Remove(&quot;DocuSignErr&quot;);
                }
            }

            if ((Request[&quot;Link&quot;] == &quot;CONTMGT&quot; || Request[&quot;Link&quot;] == &quot;ESTMATE&quot;) &amp;&amp; rbItemLvl.Checked)
            {
                Page.ClientScript.RegisterStartupScript(typeof(Page), &quot;ShowItem&quot;, &quot;ShowItemLevel(true);&quot;, true);
            }

            PageTitle = &quot;New Submittal&quot;;

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnPageLoad(model, args);

        }

        protected override void OnInit(EventArgs e)
        {
            PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);
            PermissionsToCheck.Add(Constants.MODFEAT_CREATE);//this is same for all 4 submittal pages 

            (mypager as PagerControl).ItemClicked += HandlePagerEvent;
            mypager.EnableViewState = true;
            gridItem.DisplayLayout.Pager.PagerStyle.CustomRules = &quot;display:none&quot;;

            //PopupExtender = (ModalPopupExtender)this.Master.FindControl(&quot;filterExtender&quot;);
            PopupExtender.Visible = true;
            PopupExtender.AddNewPopup(aspPnlItems.ClientID, btnItems.ClientID, btnCncl.ClientID, 200, 650);
            PopupExtender.AddNewPopup(aspPnlFilter.ClientID, btnFilter.ClientID, btnFilterCncl.ClientID, 300, 400);

            dtDueDate.ValueChanged += wdcDuedt_ValueChanged;
            dtDueDate.AutoPostBack.ValueChanged = true;

            base.PageUniqueID = HttpContext.Current.Request.QueryString[&quot;Link&quot;];

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnInit(model, args);

            base.OnInit(e);
        }

        public void HandlePagerEvent(object sender, ItemClickEventArgs e)
        {
            try
            {
                BindData();
                gridItem.DisplayLayout.Pager.CurrentPageIndex = 1;
            }
            catch
            {
            }
        }

        protected void LoadSubmittalType()
        {
            DataTable dt = SubmittalsManager.BLInstance.GetSubmittalTypes();

            if (dt.Rows.Count &gt; 0)
            {
                ddlSubmittalType.DataSource = dt;
                ddlSubmittalType.DataTextField = &quot;SubmittalType&quot;;
                ddlSubmittalType.DataValueField = &quot;TypeID&quot;;
                ddlSubmittalType.DataBind();

                ddlSubmittalType.SelectedIndex = 0;
                LoadSubittalRequirements(ddlSubmittalType.Items[0].Value.ToInt32_2());
            }
            else
            {
                ddlRequirement.Items.Clear();
                ddlRequirement.Enabled = ddlSubmittalType.Enabled = false;
            }
        }

        protected void btnItemGhost_Click(object sender, EventArgs e)
        {
            if (gridItem.DisplayLayout.SelectedRows.Count == 0)
                throw new Exception(&quot;Please select atleast one row from the Standarard Items list.&quot;);

            CellsCollection coll = gridItem.DisplayLayout.SelectedRows[0].Cells;
            hdnItemID.Value = Convert.ToString(coll.FromKey(&quot;ItemID&quot;).Value, CultureInfo.CurrentCulture);
            txtItemDesc.Text = Convert.ToString(coll.FromKey(&quot;Description&quot;).Value, CultureInfo.CurrentCulture);

            DataTable dt =
                SubmittalsManager.BLInstance.GetSubmittalComponents(
                    Convert.ToString(coll.FromKey(&quot;ItemID&quot;), CultureInfo.CurrentCulture).ToInt32_2(), Request[&quot;Link&quot;],
                    Request[&quot;LinkID&quot;].ToInt32_2());
            if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
            {
                ddlComponent.DataSource = dt;
                ddlComponent.DataTextField = &quot;ComponentName&quot;;
                ddlComponent.DataValueField = &quot;ComponentID&quot;;
                ddlComponent.DataBind();
            }
        }

        protected void rbSubItmLvl_CheckedChanged(object sender, EventArgs e)
        {
            LoadSubmittalType();
        }

        protected void btnLoadItems_Click(object sender, EventArgs e)
        {
            BindData();
        }

        protected void BindData()
        {
            if (Request[&quot;Link&quot;] == &quot;CONTMGT&quot;)
            {
                BindContractItems();
            }
            else if (Request[&quot;Link&quot;] == &quot;ESTMATE&quot;)
            {
                BindEstimateItems();
            }
        }

        protected void SetGridColumns()
        {
            ColumnsCollection cols;
            UltraGridColumn c;
            foreach (UltraGridColumn col in gridItem.Columns)
            {
                col.Hidden = true;
            }
            cols = gridItem.Bands[0].Columns;

            //Set visibility for selected columns..
            cols.FromKey(&quot;LineNo&quot;).Hidden = false;
            cols.FromKey(&quot;StandardItemNo&quot;).Hidden = false;
            cols.FromKey(&quot;StandardItemNo&quot;).Header.Caption = &quot;Standard Item No.&quot;;

            cols.FromKey(&quot;Description&quot;).Hidden = false;

            cols.FromKey(&quot;Quantity&quot;).Hidden = false;
            cols.FromKey(&quot;Quantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;

            cols.FromKey(&quot;Unit&quot;).Hidden = false;
            cols.FromKey(&quot;Amount&quot;).Hidden = false;
            cols.FromKey(&quot;Amount&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Right;
            cols.FromKey(&quot;UnitPrice&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Right;
            cols.FromKey(&quot;Quantity&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Right;
            cols.FromKey(&quot;Description&quot;).FieldLen = 200;
            cols.FromKey(&quot;StandardItemNo&quot;).FieldLen = 25;
            cols.FromKey(&quot;Quantity&quot;).FieldLen = 10;
            cols.FromKey(&quot;UnitPrice&quot;).FieldLen = 14;

            //cols.FromKey(&quot;LineNo&quot;).Width = Unit.Pixel(50);
            //cols.FromKey(&quot;StandardItemNo&quot;).Width = Unit.Pixel(100);
            //cols.FromKey(&quot;Description&quot;).Width = Unit.Pixel(220);
            //cols.FromKey(&quot;Quantity&quot;).Width = Unit.Pixel(100);
            //cols.FromKey(&quot;Unit&quot;).Width = Unit.Pixel(75);
            //cols.FromKey(&quot;UnitPrice&quot;).Width = Unit.Pixel(100);
            //cols.FromKey(&quot;Amount&quot;).Width = Unit.Pixel(100);

            (c = cols.FromKey(&quot;Quantity&quot;)).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;

            (c = cols.FromKey(&quot;UnitPrice&quot;)).Format = AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.Header.Caption = &quot;Unit Price&quot;;

            (c = cols.FromKey(&quot;Amount&quot;)).FooterTotal = SummaryInfo.Sum;
            c.Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
            c.CellStyle.HorizontalAlign = HorizontalAlign.Right;
            c.Header.Caption = &quot;Amount&quot;;

            gridItem.DisplayLayout.ScrollBar = ScrollBar.Auto;
            //gridItem.DisplayLayout.FrameStyle.Height = Unit.Percentage(100);
            gridItem.DisplayLayout.Pager.PagerStyle.CustomRules = &quot;display:none&quot;;

            foreach (UltraGridColumn col in gridItem.Columns)
            {
                col.HTMLEncodeContent = true;
            }
        }

        protected void btnFilterGhost_Click(object sender, EventArgs e)
        {
            ApplyItemsFilter();
        }

        protected void ApplyItemsFilter()
        {
            ViewState[Constants.ODS_FILTER] = UIHelper.GenerateFilterXML(aspPnlFilter);
            BindData();
        }

        protected void LoadSubittalRequirements(int TypeID)
        {
            DataTable dt = SubmittalsManager.BLInstance.GetSubmittalRequirements(TypeID, Request[&quot;Link&quot;],
                                                                                 Request[&quot;LinkID&quot;].ToInt32_2(),
                                                                                 Request[&quot;PID&quot;].ToInt32_2(),
                                                                                 rbItemLvl.Checked ? &#39;Y&#39; : &#39;N&#39;);

            if (dt.Rows.Count &gt; 0)
            {
                ddlRequirement.DataSource = dt;
                ddlRequirement.DataTextField = &quot;Requirement&quot;;
                ddlRequirement.DataValueField = &quot;RequirementID&quot;;
                ddlRequirement.DataBind();
                ddlRequirement.SelectedIndex = 0;
                lblRequirement.Text = Convert.ToString(dt.Rows[0][&quot;Description&quot;], CultureInfo.CurrentCulture).BrixHTMLEncode();
                ddlRequirement.Enabled = true;
            }
            else
            {
                lblRequirement.Text = String.Empty;
                ddlRequirement.Items.Clear();
                ddlRequirement.Enabled = false;
            }
        }

        protected void ddlSubmittalType_SelectedIndexChanged(object sender, EventArgs e)
        {
            LoadSubittalRequirements(ddlSubmittalType.SelectedValue.ToInt32_2());
        }

        protected void ddlRequirement_SelectedIndexChanged(object sender, EventArgs e)
        {
            DataTable dt = SubmittalsManager.BLInstance.GetSubmittalReqDetails(ddlRequirement.SelectedValue.ToInt32_2());
            lblRequirement.Text = Convert.ToString(dt.Rows[0][&quot;Description&quot;], CultureInfo.CurrentCulture).BrixHTMLEncode();
        }

        protected void btnStatusUpdate_Click(object sender, EventArgs e)
        {
            //btnSaveCont_Click(sender, e);
            //btnCancel_Click(sender, e);
        }

        protected void StdItemsGrid_SortColumn(object sender, SortColumnEventArgs e)
        {
            //ApplyStdItemSort(e.ColumnNo);
            //stdPageState.MaintainState(BrixDatatypeHelper.ToInt32_2((stdPager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value),
            //                           e.ColumnNo,
            //                           ViewState[ContConstants.ODS_SORTORDER] == null
            //                               ? null
            //                               : ViewState[ContConstants.ODS_SORTORDER].ToString2(),
            //                           ViewState[ContConstants.ODS_FILTER] == null
            //                               ? null
            //                               : ViewState[ContConstants.ODS_FILTER].ToString2());
        }

        protected void ddlStdItmTbl_SelectedIndexChanged(object sender, EventArgs e)
        {
            //GetStdItemsCount((ddlStdItmTbl.SelectedIndex == -1)
            //                     ? ddlStdItmTbl.SelectedIndex
            //                     : BrixDatatypeHelper.ToInt32_2(ddlStdItmTbl.SelectedValue));
            //BindStdItems((ddlStdItmTbl.SelectedIndex == -1)
            //                 ? ddlStdItmTbl.SelectedIndex
            //                 : BrixDatatypeHelper.ToInt32_2(ddlStdItmTbl.SelectedValue));
        }

        protected void btnSaveSubmittal_Click(object sender, EventArgs e)
        {
            WorkflowEnabledSaveHandler();
        }

        protected void btnResetSubmittal_Click(object sender, EventArgs e)
        {
            try
            {
                if (ddlSubmittalType.Items != null &amp;&amp; ddlSubmittalType.Items.Count &gt; 0)
                {
                    ddlSubmittalType.SelectedIndex = 0;
                    LoadSubittalRequirements(ddlSubmittalType.SelectedValue.ToInt32_2());
                }
                txtItemDesc.Text = &quot;&quot;;
                txtRef.Text = &quot;&quot;;
                txtNotes.Text = &quot;&quot;;
                txtRemarks.Text = &quot;&quot;;
                if (ddlComponent.Items.Count &gt; 0)
                {
                    ddlComponent.SelectedIndex = 0;
                    ddlComponent.Items.Clear();
                }
                if (ddlRequirement.Items.Count &gt; 0)
                    ddlRequirement.SelectedIndex = 0;

                dtDueDate.Value = MWDateTimeHelper.MWNow; //DateTime.UtcNow;
                attachments.ClearAllAttachments();
            }
            catch (Exception ex)
            {
                //lblError.Text = ex.Message;
                ScriptManager.RegisterStartupScript(upGhost, GetType(), &quot;alert&quot;, &quot;ShowError(&#39;&quot; +
                                                                                 ex.Message.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;);&quot;,
                                                    true);
            }
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                              &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; + Request[&quot;LinkID&quot;]+ &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
        }

        protected void wdcDuedt_ValueChanged(object sender, WebDateChooser.WebDateChooserEventArgs e)
        {
            if (Request[&quot;Mode&quot;] == null &amp;&amp;
                (Convert.ToDateTime(
                    Convert.ToDateTime(dtDueDate.Value, CultureInfo.CurrentCulture).ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE,
                                                                                             CultureInfo.CurrentCulture),
                    DateFormatCulture.GetDateFormatCulture()) &lt;
                 Convert.ToDateTime(
                     Convert.ToDateTime(wdcCreatedOn.Value, CultureInfo.CurrentCulture).ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE,
                                                                                                 CultureInfo.
                                                                                                     CurrentCulture),
                     DateFormatCulture.GetDateFormatCulture())))
            {
                //lblError.Text = &quot;Approval due date is before the created on date.&quot;;
                // lblError.ForeColor = Color.Red;
                ShowNotificationMessage(&quot;Approval due date is before the created on date.&quot;, NotificationType.Error);
            }
            else
                lblError.Text = String.Empty;
        }

        protected override void CreateChildControls()
        {
            var menus = new MenuArray();
            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkImport&quot;, &quot;Reset&quot;, &quot;Icn_importxl.png&quot;, 55));
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));
            CreateToolBarMenu(menus, null);
            base.CreateChildControls();
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += btnSaveSubmittal_Click;
                    if (_WorkflowsInitiated != null &amp;&amp; _WorkflowsInitiated.Count &gt; 0)
                    {
                        lnkSave.OnClientClick = &quot;javascript: DisableControlsOnSaveAndWFAction(&#39;&quot; + _WorkflowsInitiated[0].ToString() + &quot;&#39;); var result= SaveCheck(); if(!result)  {EnableControlsOnSaveAndWFAction(&#39;&quot; + _WorkflowsInitiated[0].ToString() + &quot;&#39;); return false; }else return true; &quot;;
                    }
                    else
                        lnkSave.OnClientClick = &quot;return SaveCheck()&quot;;
                    lnkSave.ToolTip = &quot;Save&quot;;
                    lnkSave.CausesValidation = false;
                }
            }

            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkImport&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).Click += btnResetSubmittal_Click;
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).OnClientClick = &quot;return resetData()&quot;;
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).ToolTip = &quot;Reset&quot;;
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).CausesValidation = false;
            }
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (!String.IsNullOrEmpty(Request[&quot;Mode&quot;]) &amp;&amp; Request[&quot;Mode&quot;] == &quot;View&quot;)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;);
                    }
                }
            }

            base.OnPreRender(e);
        }

        public override Dictionary&lt;string, string&gt; PassInformationToWorkFlow()
        {
            Dictionary&lt;string, string&gt; sParams = base.PassInformationToWorkFlow();
            if (managerModel != null)
                sParams = managerModel.PassInformationToWorkFlow(model, sParams, new XmlFormArgs());
            return sParams;
        }

        #region Contract Items...

        protected void BindContractItems()
        {
            try
            {
                int currentPage = (mypager as PagerControl).CurrentPage, pageCount;
                int startIdx =
                    (startIdx = (mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value.ToInt32_2() - 1) ==
                    -1
                        ? 0
                        : startIdx;

                startIdx = 1 + (gridItem.DisplayLayout.Pager.PageSize * startIdx);

                DataTable dTable = SubmittalsManager.BLInstance.GetContractItems(Request[&quot;LinkID&quot;].ToInt32_2(),
                                                                                 startIdx,
                                                                                 gridItem.DisplayLayout.Pager.PageSize,
                                                                                 ViewState[Constants.ODS_SORTORDER] ==
                                                                                 null
                                                                                     ? null
                                                                                     : ViewState[Constants.ODS_SORTORDER
                                                                                           ].ToString2(),
                                                                                 ViewState[Constants.ODS_FILTER] == null
                                                                                     ? null
                                                                                     : ViewState[Constants.ODS_FILTER].
                                                                                           ToString2(), null,
                                                                                 ref currentPage, out pageCount);


                (mypager as PagerControl).PageCount = pageCount;
                (mypager as PagerControl).Set_Page(currentPage, pageCount);
                gridItem.DataSource = dTable;
                gridItem.DataBind();
                SetGridColumns();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.ToString2(), &quot;CONTMGT&quot;);
            }
        }

        #endregion

        #region Estimate Items..

        protected void BindEstimateItems()
        {
            try
            {
                int currentPage = (mypager as PagerControl).CurrentPage, pageCount;
                int startIdx = ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value.ToInt32_2() - 1;
                //if (startIdx &gt; 1)
                {
                    startIdx = 1 + (gridItem.DisplayLayout.Pager.PageSize * startIdx);
                }

                DataTable itemsDT = SubmittalsManager.BLInstance.GetParentItems(Request[&quot;LinkID&quot;].ToInt32_2(), startIdx,
                                                                                gridItem.DisplayLayout.Pager.PageSize,
                                                                                ViewState[Constants.ODS_SORTORDER] ==
                                                                                null
                                                                                    ? null
                                                                                    : ViewState[Constants.ODS_SORTORDER]
                                                                                          .ToString2(),
                                                                                ViewState[Constants.ODS_FILTER] == null
                                                                                    ? null
                                                                                    : ViewState[Constants.ODS_FILTER].
                                                                                          ToString2(), null,
                                                                                ref currentPage, out pageCount);

                (mypager as PagerControl).PageCount = pageCount;
                (mypager as PagerControl).Set_Page(currentPage, pageCount);
                gridItem.DataSource = itemsDT;
                gridItem.DataBind();
                SetGridColumns();
            }
            catch (Exception)
            {
            }
        }

        #endregion

        #region IXMLControl Members
        public HtmlGenericControl XMLContainterDiv
        {
            get { return divExtension; }
            set { throw new NotImplementedException(); }
        }

        public object[] ParentFormInstanceID
        {
            get { return new object[] { &quot;0&quot; }; }
        }

        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        { }

        public void HandleInjectionAfterSave(object model, string parentFormInstanceId)
        { }

        public bool SkipDefaultXMLInjectionSave { get; set; }

        #endregion

    }

    [CustomResourceType(&quot;Forms&quot;, &quot;SUBREGR&quot;)]
    public class SubmittalRegisterWFOperations : FormsCustomResource
    {
        public SubmittalRegisterWFOperations()
        {
            _Namespace = &quot;Forms&quot;;
            _Path = &quot;Forms.Project.Submittal&quot;;
            _Name = &quot;SubmittalRegisterWFOperations&quot;;
            _Desc = &quot;Perform Submittal Operations&quot;;

            _InParameters = new[] { &quot;Operation,System.String&quot; };
            _OutParameters = new[] { &quot;IsSuccessful,System.Boolean&quot;, &quot;Message,System.String&quot; };
        }

        public override void ExecuteDerived()
        {
            try
            {
                string operation = GetInputParam(&quot;Operation&quot;).ToString();
                string culture = GetInputParam(&quot;Culture&quot;).ToString();
                string uiCulture = GetInputParam(&quot;UICulture&quot;).ToString();
                Thread.CurrentThread.CurrentCulture = new CultureInfo(culture);
                Thread.CurrentThread.CurrentUICulture = new CultureInfo(uiCulture);

                int userId = GetInputParam(&quot;_CurrentUserId&quot;).ToInt32_2();

                switch (operation.ToUpper())
                {
                    case &quot;SUBMIT&quot;:
                        SubmitSubmittal(userId);
                        break;
                    case &quot;APPROVE&quot;:
                        ApproveSubmittal(userId);
                        break;
                    case &quot;REJECT&quot;:
                        RejectSubmittal(userId);
                        break;

                }
            }
            catch (Exception ex)
            {
                SetOutParam(&quot;IsSuccessful&quot;, false, &quot;System.Boolean&quot;);
                SetOutParam(&quot;Message&quot;, ex.Message, &quot;System.String&quot;);
                throw new Exception(ex.Message);
            }
        }

        private void SubmitSubmittal(int userId)
        {
            SubmittalsManager.BLInstance.SubmittalUpdateStatus(InstanceId.ToInt32_2(), String.Empty, &quot;P&quot;, userId, null);
            SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
            SetOutParam(&quot;Message&quot;, &quot;Successful&quot;, &quot;System.String&quot;);
        }

        private void ApproveSubmittal(int userId)
        {
            SubmittalsManager.BLInstance.SubmittalUpdateStatus(InstanceId.ToInt32_2(), string.Empty, &quot;A&quot;, userId, null);
            SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
            SetOutParam(&quot;Message&quot;, &quot;Successful&quot;, &quot;System.String&quot;);
        }

        private void RejectSubmittal(int userId)
        {
            SubmittalsManager.BLInstance.SubmittalUpdateStatus(InstanceId.ToInt32_2(), string.Empty, &quot;R&quot;, userId, null);
            SetOutParam(&quot;IsSuccessful&quot;, true, &quot;System.Boolean&quot;);
            SetOutParam(&quot;Message&quot;, &quot;Successful&quot;, &quot;System.String&quot;);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[43,17,43,18,0],[43,19,43,95,0],[43,96,43,97,0],[51,17,51,18,0],[51,19,51,77,0],[51,78,51,79,0],[59,17,59,18,1],[59,19,59,80,1],[59,81,59,82,1],[68,9,68,10,0],[69,13,69,49,0],[74,17,74,18,1],[74,19,74,40,1],[74,41,74,42,1],[80,13,80,14,1],[81,17,83,99,1],[84,17,84,38,1],[85,13,85,14,1],[88,37,88,38,1],[88,39,88,183,1],[88,184,88,185,1],[92,17,92,18,1],[92,19,92,36,1],[92,37,92,38,1],[97,17,97,18,0],[97,19,97,31,0],[97,32,97,33,0],[102,17,102,18,1],[102,19,102,65,1],[102,66,102,67,1],[108,13,108,14,1],[109,17,109,80,1],[110,17,110,18,1],[111,21,111,72,1],[113,17,115,91,0],[116,17,116,27,0],[117,13,117,14,1],[123,13,123,14,0],[124,17,125,99,0],[126,13,126,14,0],[130,9,130,10,1],[131,13,132,181,1],[133,9,133,10,1],[137,9,137,10,0],[138,13,138,38,0],[139,13,139,30,0],[140,13,140,26,0],[143,13,143,14,0],[144,17,145,60,0],[146,17,146,18,0],[147,21,147,123,0],[149,17,150,51,0],[151,17,151,18,0],[152,21,152,68,0],[155,17,155,55,0],[156,17,156,18,0],[157,21,157,73,0],[159,17,159,53,0],[160,17,160,18,0],[161,21,161,80,0],[164,17,166,88,0],[167,17,167,18,0],[168,21,168,93,0],[171,17,171,76,0],[172,17,172,57,0],[174,17,174,60,0],[175,17,175,54,0],[176,17,176,82,0],[177,17,177,18,0],[178,21,178,43,0],[179,21,179,22,0],[180,25,180,66,0],[181,25,181,82,0],[182,21,182,22,0],[183,21,183,70,0],[184,17,184,18,0],[185,17,185,55,0],[186,21,186,68,0],[187,17,187,73,0],[188,17,188,78,0],[189,17,189,45,0],[190,17,190,43,0],[191,17,191,47,0],[192,17,192,63,0],[193,17,193,42,0],[194,17,194,67,0],[195,17,195,40,0],[196,17,196,37,0],[198,17,198,100,0],[199,17,199,54,0],[201,17,201,62,0],[202,17,202,47,0],[203,21,203,75,0],[204,17,204,55,0],[205,21,205,72,0],[206,17,206,134,0],[207,17,207,123,0],[208,21,208,131,0],[209,17,209,29,0],[211,13,211,33,0],[212,13,212,14,0],[213,17,214,66,0],[215,17,215,30,0],[217,9,217,10,0],[222,9,222,10,0],[223,13,223,83,0],[224,9,224,10,0],[227,9,227,10,1],[228,13,228,88,1],[230,13,230,116,1],[231,13,231,14,0],[232,17,233,111,0],[235,13,235,14,0],[236,9,236,10,1],[239,9,239,10,1],[244,13,244,126,1],[246,13,246,31,1],[247,13,247,31,1],[248,13,248,38,1],[249,17,249,66,0],[250,9,250,10,1],[253,9,253,10,1],[257,13,257,14,1],[258,17,258,44,1],[260,17,260,47,1],[261,13,261,14,1],[262,13,262,18,0],[263,13,263,14,0],[264,17,264,26,0],[265,13,265,14,0],[267,13,268,57,1],[269,13,269,14,0],[270,17,270,26,0],[271,13,271,14,0],[273,13,275,49,1],[276,13,276,14,0],[277,17,277,26,0],[278,13,278,14,0],[284,13,284,49,1],[286,13,286,144,1],[288,13,289,108,1],[291,13,291,51,1],[292,17,296,99,0],[300,13,300,29,1],[301,13,301,14,1],[302,17,302,96,1],[303,17,303,124,1],[304,17,304,128,1],[305,17,305,122,1],[306,17,306,65,1],[307,17,307,120,1],[310,17,312,78,1],[313,17,313,58,1],[315,17,315,86,1],[316,17,316,18,1],[317,21,317,95,1],[318,21,318,48,1],[319,21,319,44,1],[320,21,320,49,1],[321,21,321,32,1],[322,21,322,54,1],[323,21,323,22,1],[324,25,324,67,1],[325,25,325,81,1],[326,25,326,77,1],[327,21,327,22,1],[328,26,328,59,1],[329,21,329,22,1],[330,25,330,67,1],[331,25,331,81,1],[332,25,332,64,1],[333,21,333,22,1],[334,17,334,18,1],[336,17,336,18,1],[337,21,337,49,1],[338,21,338,45,1],[339,21,339,50,1],[340,17,340,18,1],[341,17,341,37,1],[343,17,343,51,1],[344,17,344,52,1],[345,21,345,69,0],[347,17,347,56,1],[348,17,348,18,0],[349,21,349,44,0],[350,21,350,51,0],[351,17,351,18,0],[352,13,352,14,1],[354,13,354,101,1],[355,13,355,14,1],[356,17,356,113,1],[357,13,357,14,1],[359,13,359,41,1],[361,13,361,50,1],[362,13,362,38,1],[363,17,363,54,0],[365,9,365,10,1],[368,9,368,10,1],[369,13,369,66,1],[370,13,370,62,1],[372,13,372,71,1],[373,13,373,44,1],[374,13,374,82,1],[377,13,377,42,1],[378,13,378,108,1],[379,13,379,116,1],[381,13,381,61,1],[382,13,382,56,1],[384,13,384,81,1],[386,13,386,50,1],[387,13,387,38,1],[388,17,388,50,0],[390,13,390,28,1],[391,9,391,10,1],[394,9,394,10,0],[396,13,396,14,0],[397,17,397,28,0],[398,17,398,67,0],[399,13,399,14,0],[400,13,400,18,0],[401,13,401,14,0],[402,13,402,14,0],[403,9,403,10,0],[406,9,406,10,1],[407,13,407,77,1],[409,13,409,35,1],[410,13,410,14,1],[411,17,411,50,1],[412,17,412,66,1],[413,17,413,60,1],[414,17,414,45,1],[416,17,416,52,1],[417,17,417,87,1],[418,13,418,14,1],[420,13,420,14,0],[421,17,421,46,0],[422,17,422,75,0],[423,13,423,14,0],[424,9,424,10,1],[427,9,427,10,0],[428,13,428,64,0],[429,17,429,102,0],[431,13,431,81,0],[432,13,432,106,0],[433,13,433,112,0],[435,13,438,52,0],[439,13,439,49,0],[440,13,440,14,0],[441,17,441,46,0],[442,17,442,62,0],[443,17,443,61,0],[444,17,444,41,0],[445,13,445,14,0],[446,9,446,10,0],[449,9,449,10,1],[450,13,450,33,1],[451,9,451,10,1],[454,9,454,10,1],[455,13,455,24,1],[456,9,456,10,1],[459,9,459,10,1],[460,13,460,46,1],[461,13,461,14,1],[462,17,462,37,1],[463,13,463,14,1],[464,18,464,51,1],[465,13,465,14,1],[466,17,466,37,1],[467,13,467,14,1],[468,9,468,10,1],[471,9,471,10,1],[474,13,474,20,1],[474,22,474,41,1],[474,42,474,44,1],[474,45,474,61,1],[475,13,475,14,1],[476,17,476,35,1],[477,13,477,14,1],[478,13,478,46,1],[481,13,481,51,1],[482,13,482,59,1],[483,13,483,81,1],[485,13,485,56,1],[487,13,487,53,1],[488,13,488,96,1],[490,13,490,49,1],[491,13,491,51,1],[492,13,492,89,1],[493,13,493,92,1],[494,13,494,91,1],[495,13,495,56,1],[496,13,496,58,1],[497,13,497,52,1],[498,13,498,53,1],[508,13,508,102,1],[509,13,509,65,1],[511,13,511,105,1],[512,13,512,65,1],[513,13,513,45,1],[515,13,515,72,1],[516,13,516,71,1],[517,13,517,65,1],[518,13,518,41,1],[520,13,520,63,1],[522,13,522,82,1],[524,13,524,20,1],[524,22,524,41,1],[524,42,524,44,1],[524,45,524,61,1],[525,13,525,14,1],[526,17,526,46,1],[527,13,527,14,1],[528,9,528,10,1],[531,9,531,10,0],[532,13,532,32,0],[533,9,533,10,0],[536,9,536,10,0],[537,13,537,88,0],[538,13,538,24,0],[539,9,539,10,0],[542,9,542,10,1],[543,13,546,113,1],[548,13,548,35,1],[549,13,549,14,1],[550,17,550,48,1],[551,17,551,62,1],[552,17,552,65,1],[553,17,553,43,1],[554,17,554,50,1],[555,17,555,128,1],[556,17,556,47,1],[557,13,557,14,1],[559,13,559,14,0],[560,17,560,52,0],[561,17,561,46,0],[562,17,562,48,0],[563,13,563,14,0],[564,9,564,10,1],[567,9,567,10,1],[568,13,568,82,1],[569,9,569,10,1],[572,9,572,10,0],[573,13,573,122,0],[574,13,574,124,0],[575,9,575,10,0],[578,9,578,10,0],[581,9,581,10,0],[584,9,584,10,0],[594,9,594,10,0],[597,9,597,10,0],[604,9,604,10,0],[607,9,607,10,1],[608,13,608,42,1],[609,9,609,10,0],[612,9,612,10,0],[614,13,614,14,0],[615,17,615,88,0],[616,17,616,18,0],[617,21,617,56,0],[618,21,618,90,0],[619,17,619,18,0],[620,17,620,39,0],[621,17,621,34,0],[622,17,622,36,0],[623,17,623,38,0],[624,17,624,50,0],[625,17,625,18,0],[626,21,626,52,0],[627,21,627,48,0],[628,17,628,18,0],[629,17,629,52,0],[630,21,630,54,0],[632,17,632,58,0],[633,17,633,51,0],[634,13,634,14,0],[635,13,635,33,0],[636,13,636,14,0],[638,17,640,59,0],[641,13,641,14,0],[642,9,642,10,0],[645,9,645,10,1],[646,13,647,157,1],[648,9,648,10,0],[651,9,651,10,1],[652,13,661,65,1],[662,13,662,14,1],[665,17,665,117,1],[666,13,666,14,1],[668,17,668,46,0],[669,9,669,10,1],[672,9,672,10,1],[673,13,673,41,1],[674,13,674,34,1],[675,13,675,83,1],[676,13,676,82,1],[677,13,677,44,1],[678,13,678,40,1],[679,9,679,10,1],[682,9,682,10,1],[683,13,683,31,1],[684,13,684,14,1],[685,17,685,78,1],[686,17,686,37,1],[687,17,687,18,1],[688,21,688,61,1],[689,21,689,86,1],[690,21,690,22,1],[691,25,691,293,1],[692,21,692,22,1],[694,25,694,70,0],[695,21,695,46,1],[696,21,696,54,1],[697,17,697,18,1],[698,13,698,14,1],[700,13,700,67,1],[701,13,701,14,1],[702,17,702,84,1],[703,17,703,84,1],[704,13,704,14,1],[705,13,705,67,1],[706,13,706,14,1],[707,17,707,92,1],[708,17,708,96,1],[709,17,709,77,1],[710,17,710,84,1],[711,13,711,14,1],[712,9,712,10,1],[715,9,715,10,1],[716,13,716,85,1],[717,13,717,14,0],[718,17,718,35,0],[719,17,719,18,0],[720,21,720,82,0],[721,21,721,41,0],[722,21,722,22,0],[723,25,723,57,0],[724,21,724,22,0],[725,17,725,18,0],[726,13,726,14,0],[728,13,728,33,1],[729,9,729,10,1],[732,9,732,10,0],[733,13,733,83,0],[734,13,734,38,0],[735,17,735,101,0],[736,13,736,28,0],[737,9,737,10,0],[742,9,742,10,1],[744,13,744,14,1],[745,17,745,72,1],[746,17,750,36,1],[752,17,752,83,1],[754,17,766,114,1],[769,17,769,65,1],[770,17,770,76,1],[771,17,771,46,1],[772,17,772,37,1],[773,17,773,34,1],[774,13,774,14,1],[775,13,775,33,0],[776,13,776,14,0],[777,17,777,83,0],[778,13,778,14,0],[779,9,779,10,1],[786,9,786,10,1],[788,13,788,14,1],[789,17,789,72,1],[790,17,790,108,1],[792,17,792,18,1],[793,21,793,87,1],[794,17,794,18,1],[796,17,807,113,1],[809,17,809,65,1],[810,17,810,76,1],[811,17,811,47,1],[812,17,812,37,1],[813,17,813,34,1],[814,13,814,14,1],[815,13,815,30,0],[816,13,816,14,0],[817,13,817,14,0],[818,9,818,10,1],[825,17,825,18,0],[825,19,825,39,0],[825,40,825,41,0],[826,17,826,18,0],[826,19,826,55,0],[831,17,831,18,1],[831,19,831,47,1],[831,48,831,49,1],[835,9,835,10,0],[835,11,835,12,0],[838,9,838,10,0],[838,11,838,12,0],[840,51,840,55,0],[840,56,840,60,0],[849,9,849,47,1],[850,9,850,10,1],[851,13,851,34,1],[852,13,852,47,1],[853,13,853,53,1],[854,13,854,52,1],[856,13,856,65,1],[857,13,857,95,1],[858,9,858,10,1],[861,9,861,10,1],[863,13,863,14,1],[864,17,864,74,1],[865,17,865,70,1],[866,17,866,74,1],[867,17,867,80,1],[868,17,868,84,1],[870,17,870,74,1],[872,17,872,45,1],[875,25,875,49,1],[876,25,876,31,1],[878,25,878,50,1],[879,25,879,31,1],[881,25,881,49,0],[882,25,882,31,0],[885,13,885,14,1],[886,13,886,33,0],[887,13,887,14,0],[888,17,888,70,0],[889,17,889,69,0],[890,17,890,49,0],[892,9,892,10,1],[895,9,895,10,1],[896,13,896,121,1],[897,13,897,65,1],[898,13,898,67,1],[899,9,899,10,1],[902,9,902,10,1],[903,13,903,121,1],[904,13,904,65,1],[905,13,905,67,1],[906,9,906,10,1],[909,9,909,10,0],[910,13,910,121,0],[911,13,911,65,0],[912,13,912,67,0],[913,9,913,10,0]]);
    </script>
  </body>
</html>