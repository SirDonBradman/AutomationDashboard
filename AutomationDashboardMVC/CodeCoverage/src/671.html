<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\ConcreteModels\Project\ProjectListModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectBL;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Aurigo.Common.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.UltraWebGrid.ExcelExport;
using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Data;
using System.Globalization;
using System.Linq;
using System.Web;
using System.Web.UI;
using Telerik.Web.UI;

namespace Aurigo.AMP3.ProjectUI
{
    [ListModelContext(Name = &quot;PROJECT&quot;)]
    [ContextElement(Name = &quot;Project List&quot;)]
    public class ProjectListModel : ListModel, ContextElementCallBack, IWorkflowEnabledList
    {
        private Dictionary&lt;string, string&gt; _uploadedModuleList;

        private Dictionary&lt;string, string&gt; UploadedModuleList
        {
            get
            {
                if (_uploadedModuleList == null)
                    _uploadedModuleList = ModuleManager.Instance.GetModuleList();
                return _uploadedModuleList;
            }
        }

        public override string QueryStringName
        {
            get { return &quot;ProjectId&quot;; }
        }

        public override string ModuleId
        {
            get { return &quot;PROJECT&quot;; }
        }

        public override bool HasMultiApprove
        {
            get { return false; }
        }

        public override string ParentIDKey
        {
            get { return Constants.QRY_PROJECTID; }
        }

        public override string ProductTemplateName
        {
            get { return &quot;XPROJCT&quot;; }
        }

        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        //public override Dictionary&lt;string, string&gt; DataSourceFiltersWithValue
        //{
        //    get
        //    {
        //        return new Dictionary&lt;string, string&gt; { { &quot;IsProposedGWP&quot;, (IsProposedProject ? &quot;1&quot; : &quot;0&quot;) } };
        //    }
        //}

        #region ContextElementCallBack Members

        public void DoCallBack(string Name, CIDictionary Parameters)
        {
            if (Name == LocalizationManager.GetString(&quot;Project&quot;) + &quot; Details&quot;)
            {
                HttpContext.Current.Response.Redirect(
                    (IsProposedProject)
                        ? @&quot;~/Modules/PROJECT/ProjectDetails.aspx?PID=&quot; + Parameters[&quot;ProjectId&quot;] + &quot;&amp;nt=1&amp;PP=1&amp;Mode=View&quot;
                        : @&quot;~/Modules/PROJECT/ProjectDetails.aspx?PID=&quot; + Parameters[&quot;ProjectId&quot;] + &quot;&amp;Mode=View&amp;nt=1&quot;, true);
            }
        }

        public List&lt;BrixContextMenu&gt; GetActionList()
        {
            var lst = new List&lt;BrixContextMenu&gt;();
            var item = new BrixContextMenu();
            item.Name = LocalizationManager.GetString(&quot;Project&quot;) + &quot; Details&quot;;
            //item.Description = LocalizationManager.GetString(&quot;Project&quot;) + &quot; Details Page&quot;;
            item.IconImage = &quot;IcnPage.gif&quot;;
            lst.Add(item);
            return lst;
        }

        #endregion

        #region IWorkflowEnabledList Members

        public string FormName
        {
            get { return &quot;XPROJCT&quot;; }
        }

        public int ParentModuleId
        {
            get { return 0; }
        }

        public string ListPrimaryKey
        {
            get { return &quot;ProjectId&quot;; }
        }

        public int PID
        {
            get { return 0; }
        }

        #endregion

        public override List&lt;MenuGroup&gt; MenuGroups
        {
            get
            {
                List&lt;MenuGroup&gt; menuGroups = base.MenuGroups;

                #region Project Details

                bool isProposed = !string.IsNullOrEmpty(Request.QueryString[&quot;pp&quot;]);

                MenuGroup projectDetails = new MenuGroup(&quot;Projects&quot;);
                if (displayCopy)
                    projectDetails.AddMenu(new TextIcon(&quot;lnkCopy&quot;, &quot;Copy&quot;, &quot;Icn_Copyproject_16.png&quot;));

                List&lt;string&gt; CoreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                if (displayChangeStatus &amp;&amp; !CoreComponents.Contains(&quot;HideChangeStatus&quot;))
                    projectDetails.AddMenu(new TextIcon(&quot;lnkChgStatus&quot;, &quot;Change Status&quot;, &quot;Icn_Changestatus_16.png&quot;));

                if (displayManageUsers)
                    projectDetails.AddMenu(new TextIcon(&quot;lnkManageUsers&quot;, &quot;Manage Users&quot;, &quot;Icn_Manageusers_16.png&quot;));

                if (DisplayCostManager &amp;&amp; !isProposed)
                    projectDetails.AddMenu(new TextIcon(&quot;lnkCostManager&quot;, &quot;Cost Sheet&quot;, &quot;Icn_Costview_16.png&quot;));

                if (displaySettings)
                    projectDetails.AddMenu(new TextIcon(&quot;lnkSettings&quot;, &quot;Status and Attributes&quot;, &quot;Icn_Attributes_16.png&quot;));

                bool hasPlanningModule = UploadedModuleList.ContainsKey(Constants.MODID_PLANING);
                if (hasPlanningModule &amp;&amp; IsProposedProject == false)
                    projectDetails.AddMenu(new TextIcon(&quot;lnkDefer&quot;, &quot;Defer&quot;, &quot;Icn_Costview_16.png&quot;));

                if (projectDetails.Menus.Count &gt; 0)
                    menuGroups.Insert(1, projectDetails);

                #endregion

                #region Reports

                MenuGroup othersGroup = menuGroups.Find(mg =&gt; mg.Title == &quot;Others&quot;);
                if (othersGroup == null)
                {
                    othersGroup = new MenuGroup(GROUP_OTHERS);
                    menuGroups.Insert(menuGroups.Count, othersGroup);
                }
                MenuButton reportsMenu = (MenuButton)othersGroup.Menus.Find(menu =&gt; menu.ID == &quot;lnkReports&quot;);
                bool addRptMenu = (reportsMenu == null);
                if (addRptMenu)
                    reportsMenu = new MenuButton(&quot;lnkReports&quot;, &quot;Reports&quot;, &quot;Icn_Reports.png&quot;);
                if (displayReportsProjects)
                {
                    //reportsMenu.AddSubMenu(new TextIcon(&quot;lnkActiveProjects&quot;, &quot;Active &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;s List&quot;, &quot;Icn_Pdf_16.png&quot;));
                    //reportsMenu.AddSubMenu(new TextIcon(&quot;lnkInactiveProjects&quot;, &quot;Inactive &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;s List&quot;, &quot;Icn_Pdf_16.png&quot;));
                    //reportsMenu.AddSubMenu(new TextIcon(&quot;lnkProjectStatus&quot;, &quot;Project Status Report&quot;, &quot;Icn_Pdf_16.png&quot;));
                    //reportsMenu.AddSubMenu(new TextIcon(&quot;lnkProjectSummary&quot;, &quot;Project Summary Report&quot;, &quot;Icn_Pdf_16.png&quot;));
                    //reportsMenu.AddSubMenu(new TextIcon(&quot;lnkProjectDetails&quot;, &quot;Project Details Report&quot;, &quot;Icn_Pdf_16.png&quot;));
                }
                if (addRptMenu)
                    othersGroup.AddMenu(reportsMenu);

                #endregion

                if (IsAuditLogEnabled(&quot;ProjectProjectMain&quot;))
                    othersGroup.AddMenu(new TextIcon(&quot;lnkAudit&quot;, &quot;Audit Log&quot;, &quot;Icn_Pdf_16.png&quot;));

                return menuGroups;
            }
        }

        public override void SetUIDetails()
        {
            //IsActive Image Column
            SetImageForRowValue(&quot;DISPLAYTEXT&quot;, &quot;InActive&quot;, &quot;InActive&quot;, &quot;Icn_Active3_Disable_16.png&quot;);
            SetImageForRowValue(&quot;DISPLAYTEXT&quot;, &quot;Active&quot;, &quot;Active&quot;, &quot;Icn_Active2_16.png&quot;);

            //Displayed Columns
            ModifyColumnProperties(&quot;IsActive&quot;, false, null, null, &quot;70&quot;, false);

            ModifyColumnProperties(&quot;DateCreated&quot;, false, null, AMP3ApplicationSettings.Instance.FORMAT_DATE, null, false, isTimezoneApplicable: true);

            //Hidden Columns
            ModifyColumnProperties(&quot;Multi&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;ProjectId&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;StartDate&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;EndDate&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;StatusId&quot;, true, null, null, null, false);
            //ModifyColumnProperties(&quot;IsActive&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;TemplateId&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;DISPLAYTEXT&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;BusinessUnitName&quot;, false, null, null, null, false, LocalizationManager.GetString(&quot;BusinessUnit&quot;).ToString2());

            ModifyColumnProperties(&quot;AUR_ModifiedOn&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;PU_AUR_ModifiedOn&quot;, true, null, null, null, false);
            ModifyColumnProperties(&quot;CreateDate&quot;, true, null, null, null, false);

            if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
            {
                ModifyColumnProperties(&quot;TotalScore&quot;, false, null, &quot;#0.00&quot;, &quot;140&quot;, false, &quot;Project Score&quot;);
                ModifyColumnProperties(&quot;IsProposedGWP&quot;, true, null, null, null, false);
                ModifyColumnProperties(&quot;RowNum&quot;, true, null, null, null, false);
                ModifyColumnProperties(&quot;Active&quot;, true, null, null, null, false);
            }

            if (HttpContext.Current != null)
            {
                if (null == HttpContext.Current.Session[Constants.APP_IntegrationCutoffDate] ||
                    (HttpContext.Current.Session[Constants.APP_IntegrationCutoffDate].ToDateTime_MWCulture().AddDays(-1) ==
                     DateTime.MinValue))
                    ModifyColumnProperties(&quot;ProjectMode&quot;, true, null, null, null, false);
                else
                    ModifyColumnProperties(&quot;ProjectMode&quot;, false, null, null, null, false,
                        LocalizationManager.GetString(&quot;Project&quot;) + &quot; Mode&quot;);
            }
            else
            {
                ModifyColumnProperties(&quot;ProjectMode&quot;, false, null, null, null, false,
                    LocalizationManager.GetString(&quot;Project&quot;) + &quot; Mode&quot;);
            }

            ModifyColumnProperties(&quot;InvitedRoles&quot;, !ModuleManager.Instance.IsEffectivePermissionOfRoles(), null, null,
                null, false, &quot;Project Roles&quot;);
            if (HttpContext.Current != null)
            {
                if (HttpContext.Current.Request.QueryString[&quot;PP&quot;] != &quot;1&quot; &amp;&amp; UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                {
                    displayNew = false;
                }
                else
                    displayNew = true;
            }

            displayDelete = true;
            displayCopy = true;
            displayManageUsers = true;
            displayView = true;
            displayChangeStatus = true;
            displaySettings = true;
            displayTemplates = true;

            //Display Buttons
            displayEdit = true;
            displayApplyFilter = true;
            displayReportsProjects = true;


            //Handle the Grid Double Click
            EnableGridDblClick = true;


            //Enable Role Selection Drop Down List
            disableRoleSelection = false;

            if (HttpContext.Current != null)
            {
                if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING) &amp;&amp; IsProposedProject == true)
                    header = &quot;Planned &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot; List&quot;;
                else
                    header = LocalizationManager.GetString(&quot;Project&quot;) + &quot; List&quot;;
            }
        }

        protected override void SetModuleLevelPermissions(List&lt;string&gt; permissions)
        {
            //Set Button Visibility based on Module Permissions
            if (displayChangeStatus &amp;&amp; !permissions.Contains(&quot;Activate/Deactivate&quot;)) displayChangeStatus = false;

            displayManageUsers = permissions.Contains(&quot;ManageUsers-Project&quot;);

            if (displayCopy &amp;&amp; !permissions.Contains(&quot;Copy&quot;)) displayCopy = false;
            if (displayOtherDropMenu)
            {
                if (displaySettings &amp;&amp; !permissions.Contains(&quot;Settings&quot;)) displaySettings = false;
                if (displayTemplates &amp;&amp; !permissions.Contains(&quot;Settings&quot;)) displayTemplates = false;
            }

            List&lt;string&gt; components = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            List&lt;string&gt; projectComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
            // For BYU hide project attributes and status
            if (!projectComponents.Contains(&quot;ShowProjectAttributes&quot;))
            {
                displaySettings = false;
            }

            if (components.Contains(&quot;CostViewEntr&quot;) &amp;&amp; permissions.Contains(&quot;CMENTPR&quot;))
                DisplayCostManager = true;
        }

        public override BrixFilter[] GetApplyFilterLabels()
        {
            bool isAXAttached = (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX));
            var filters = new BrixFilter[GetCount(isAXAttached, displaySettings)];


            filters[0] = new BrixFilter();
            filters[0].Title = &quot;Project&quot;;
            filters[0].Name = &quot;ProjectName&quot;;
            filters[0].FilterType = BrixFilter.Type.Text;

            filters[1] = new BrixFilter();
            filters[1].Title = &quot;Code&quot;;
            filters[1].Name = &quot;ProjectCode&quot;;
            filters[1].FilterType = BrixFilter.Type.Text;


            //filters[3] = new BrixFilter();
            //filters[3].Title = &quot;Region&quot;;
            //filters[3].Name = &quot;RegionID&quot;;
            //filters[3].FilterType = BrixFilter.Type.Combo;
            //filters[3].DataSource = ComponentHelper.Instance.ExecuteDataSet(&quot;select ID,Name from LIBRARYRegion&quot;).Tables[0];
            //filters[3].DataTextField = &quot;Name&quot;;
            //filters[3].DataValueField = &quot;ID&quot;;


            //DataSet ds = ComponentHelper.Instance.ExecuteDataSet(&quot;select ID,Name from LIBRARYRegion&quot;);
            //if (ds.Tables.Count &gt; 0)
            //{
            //    Dictionary&lt;string, string&gt; vals = new Dictionary&lt;string, string&gt;();
            //    foreach (DataRow rw in ds.Tables[0].Rows)
            //        vals.Add(rw[&quot;ID&quot;].ToString(), rw[&quot;Name&quot;].ToString());
            //    filters[3].Values = vals;
            //    filters[3].DataTextField = &quot;Value&quot;;
            //    filters[3].DataValueField = &quot;Key&quot;;
            //}

            //filters[4] = new BrixFilter();
            //filters[4].Title = &quot;Project Type&quot;;
            //filters[4].Name = &quot;ProjectTypeCode&quot;;
            //filters[4].FilterType = BrixFilter.Type.Combo;
            //filters[4].DataTextField = &quot;Key&quot;;
            //filters[4].DataValueField = &quot;Value&quot;;
            //filters[4].Values = new Dictionary&lt;string, string&gt;();
            //filters[4].Values[&quot;MAJOR CAP&quot;] = &quot;MAJOR CAP&quot;;
            //filters[4].Values[&quot;MINOR CAP&quot;] = &quot;MINOR CAP&quot;;
            //filters[4].Values[&quot;PRES CAP&quot;] = &quot;PRES CAP&quot;;


            //filters[2] = new BrixFilter();
            //filters[2].Title = &quot;ProjectType&quot;;
            //filters[2].Name = &quot;ProjectTypeCode&quot;;
            //filters[2].FilterType = BrixFilter.Type.Combo;

            //filters[2].DataTextField = &quot;ProjectType&quot;;
            //filters[2].DataValueField = &quot;ID&quot;;

            filters[2] = new BrixFilter();
            filters[2].Title = &quot;Owner&quot;;
            filters[2].Name = &quot;Owner&quot;;
            filters[2].FilterType = BrixFilter.Type.Text;

            filters[3] = new BrixFilter();
            filters[3].Title = &quot;Active Status&quot;;
            filters[3].Name = &quot;IsActive&quot;;
            filters[3].FilterType = BrixFilter.Type.Radio;
            filters[3].Values = new Dictionary&lt;string, string&gt;();
            filters[3].Values[&quot;Active&quot;] = &quot;1&quot;;
            filters[3].Values[&quot;InActive&quot;] = &quot;0&quot;;
            filters[3].Values[&quot;Both&quot;] = null;


            if (isAXAttached)
            {
                filters[4] = new BrixFilter();
                filters[4].Title = LocalizationManager.GetString(&quot;Project&quot;) + &quot; Mode&quot;;
                filters[4].Name = &quot;ProjectMode&quot;;
                filters[4].FilterType = BrixFilter.Type.Radio;
                filters[4].Values = new Dictionary&lt;string, string&gt;();
                filters[4].Values[&quot;Integration&quot;] = &quot;I&quot;;
                filters[4].Values[&quot;Live&quot;] = &quot;L&quot;;
            }
            else if (!isAXAttached &amp;&amp; displaySettings)
            {
                filters[4] = new BrixFilter();
                filters[4].Title = &quot;Status&quot;;
                filters[4].Name = &quot;Status&quot;;
                filters[4].FilterType = BrixFilter.Type.Text;
            }
            else if (isAXAttached &amp;&amp; displaySettings)
            {
                filters[5] = new BrixFilter();
                filters[5].Title = &quot;Status&quot;;
                filters[5].Name = &quot;Status&quot;;
                filters[5].FilterType = BrixFilter.Type.Text;
            }

            return filters;
        }

        private int GetCount(bool isAXAttached, bool displaySettings)
        {
            int count = 4;
            if (isAXAttached &amp;&amp; displaySettings)
            {
                count = 6;
            }
            else if (!isAXAttached &amp;&amp; displaySettings)
            {
                count = 5;
            }
            else if (isAXAttached &amp;&amp; !displaySettings)
            {
                count = 5;
            }
            else if (!isAXAttached &amp;&amp; !displaySettings)
            {
                count = 4;
            }
            return count;
        }

        public override void HandleNew()
        {
            if (!string.IsNullOrEmpty(ConnectionHelper.GetCurrentCompany()) &amp;&amp;
                ProjectManager.Instance.GetAllProjectCount() &gt;=
                CompanyManager.Instance.GetCurrentCompanyDetails().ProjectLimit)
                throw new Exception(&quot;Please upgrade to create more projects&quot;);
            string url = &quot;&quot;;
            if (!IsProposedProject)
                url = &quot;~/Modules/PROJECT/CreateProjects.aspx&quot;;
            else
                url = &quot;~/Modules/PROJECT/CreateProjects.aspx?PP=1&quot;;
            Response.Redirect(url, true);
        }

        public override void HandleEdit()
        {
            string selProjectID = GetSelectedItemFromGrid();

            if (String.IsNullOrEmpty(selProjectID))
            {
                throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
            }
            else
            {
                var requestObj = HttpContext.Current.Request;
                var urlPath = requestObj.Url.PathAndQuery;

                var queryStringCollection = new NameValueCollection(HttpContext.Current.Request.QueryString);
                if (queryStringCollection.AllKeys.Contains(&quot;ReturnUrl&quot;))
                {
                    queryStringCollection.Remove(&quot;ReturnUrl&quot;);
                    urlPath = requestObj.Url.AbsolutePath;

                    for (int i = 0; i &lt; queryStringCollection.Count; i++)
                        urlPath += string.Format(&quot;{0}{1}={2}&quot;, (i == 0 ? &quot;?&quot; : &quot;&amp;&quot;), queryStringCollection.Keys[i], queryStringCollection[i]);
                }
                string encryptedURL = SecurityHelpers.Encrypt_Simple(urlPath);
                string retUrl = HttpContext.Current.Server.UrlEncode(encryptedURL);

                if (!IsProposedProject)
                    Response.Redirect(
                        &quot;~/Modules/PROJECT/CreateProjects.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + selProjectID +
                        &quot;&amp;nt=1&amp;Mode=Edit&quot; + &quot;&amp;ReturnUrl=&quot; + retUrl, true);
                else
                    Response.Redirect(
                        &quot;~/Modules/PROJECT/CreateProjects.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + selProjectID +
                        &quot;&amp;PP=1&amp;nt=1&amp;Mode=Edit&quot; + &quot;&amp;ReturnUrl=&quot; + retUrl, true);
            }
        }

        public override void HandleView()
        {
            string selProjectID = GetSelectedItemFromGrid();

            if (String.IsNullOrEmpty(selProjectID))
            {
                throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
            }
            else
            {
                Response.Redirect(
                    (IsProposedProject)
                        ? &quot;~/Modules/PROJECT/ProjectInfo.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + selProjectID + &quot;&amp;PP=1&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;
                        : &quot;~/Modules/PROJECT/ProjectInfo.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + selProjectID + &quot;&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;,
                    true);
            }
        }

        public override int HandleDelete()
        {
            string selProjectID = GetSelectedItemFromGrid();

            if (String.IsNullOrEmpty(selProjectID))
            {
                throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
            }
            else
            {
                try
                {
                    selProjectID = ListModel.FilterIdsToDeleteBasedOnWFDefinitions(&quot;XPROJCT&quot;, selProjectID, null, selProjectID);
                    if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                    {
                        int Output = 0;
                        Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
                        ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PLANINGDeferProjects, dic, selProjectID);
                        Output = Convert.ToInt32(dic[&quot;Output&quot;]);

                        if (Output == 0)
                            throw new Exception(LocalizationManager.GetString(&quot;Project&quot;) + &quot;s that were deferred cannot be deleted.&quot;);
                    }

                    ProjectManager.Instance.DeleteProject(selProjectID.ToInt32_2());
                    ListModel.ForceDeleteWorkflowsForThisForm(selProjectID, &quot;XPROJCT&quot;);
                    DocumentManager.Instance.DeleteFolderContents(DocumentManager.Instance.GetInstanceRootFolder(selProjectID.ToInt32_2(), &quot;PROJECT&quot;));
                }
                catch (Exception ex)
                {
                    throw ex;
                }

                Response.Redirect(
                    ((IsProposedProject)
                        ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&amp;PP=1&quot;
                        : &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&quot;), true);
            }

            return 1;
        }

        public override int HandleActivate()
        {
            string selProjectID = GetSelectedItemFromGrid();

            if (String.IsNullOrEmpty(selProjectID))
            {
                throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
            }
            else
            {
                string errorMsg = string.Empty;

                try
                {
                    if (!ProjectManager.Instance.TryToggleProjectStatus(selProjectID.Parse2(), ref errorMsg))
                        throw new Exception(errorMsg);

                }
                catch (Exception ex)
                {
                    throw;
                }
                Response.Redirect(
                    (IsProposedProject)
                        ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                        : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, true);
            }
            return 1;
        }

        public override void HandleGridDblClick&lt;T&gt;(T row)
        {
            if (MWGrid.ColumnExists(row, &quot;ProjectId&quot;))
            {
                Response.Redirect(
                    (IsProposedProject)
                        ? &quot;~/Modules/PROJECT/ProjectInfo.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + MWGrid.GetCellValue(row, &quot;ProjectId&quot;) + &quot;&amp;PP=1&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;
                        : &quot;~/Modules/PROJECT/ProjectInfo.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + MWGrid.GetCellValue(row, &quot;ProjectId&quot;) + &quot;&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;, true);
            }
        }

        public override string HandleMenuItem(string eventString)
        {
            try
            {

                switch (eventString)
                {
                    case &quot;Manage Users&quot;:
                        Response.Redirect(
                   (IsProposedProject)
                       ? &quot;~/Modules/PROJECT/ProjectsToUser.aspx?PP=1&quot;
                       : &quot;~/Modules/PROJECT/ProjectsToUser.aspx&quot;, true);
                        break;
                    case &quot;Copy&quot;:
                        string selProjectID = GetSelectedItemFromGrid();

                        if (String.IsNullOrEmpty(selProjectID))
                        {
                            throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
                        }
                        else
                        {
                            if (!string.IsNullOrEmpty(ConnectionHelper.GetCurrentCompany()) &amp;&amp;
                                ProjectManager.Instance.GetAllProjectCount() &gt;=
                                CompanyManager.Instance.GetCurrentCompanyDetails().ProjectLimit)
                            {
                                throw new Exception(&quot;Please upgrade to create more projects&quot;);
                            }
                            else
                                Response.Redirect(
                                    ((IsProposedProject)
                                        ? &quot;~/Modules/PROJECT/CopyProject.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; +
                                          selProjectID + &quot;&amp;PP=1&quot;
                                        : &quot;~/Modules/PROJECT/CopyProject.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; +
                                          selProjectID),
                                    true);
                        }
                        break;

                    case &quot;Status and Attributes&quot;:
                        Response.Redirect(
                        (IsProposedProject) ? &quot;~/Modules/PROJECT/Settings.aspx?PP=1&quot; : &quot;~/Modules/PROJECT/Settings.aspx&quot;,
                        true);
                        break;
                    case &quot;Templates&quot;:
                        Response.Redirect(
                        (IsProposedProject)
                            ? &quot;~/Modules/PROJECT/ManageTemplate.aspx?PP=1&quot;
                            : &quot;~/Modules/PROJECT/ManageTemplate.aspx&quot;, true);
                        break;

                    case &quot;Cost Sheet&quot;:
                        Response.Redirect(
                        (IsProposedProject)
                            ? @&quot;~/Common/BrixItemListPage.aspx?Context=CMENTPR&amp;PP=1&quot;
                            : @&quot;~/Common/BrixItemListPage.aspx?Context=CMENTPR&quot;, true);
                        break;
                    case &quot;Defer&quot;:
                        string projectID = GetSelectedItemFromGrid();
                        if (String.IsNullOrEmpty(projectID))
                        {
                            throw new Exception(&quot;Please select a &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;.&quot;);
                        }
                        else
                        {
                            int Output = 0;
                            Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
                            ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PLANINGDefer, dic, projectID);
                            Output = Convert.ToInt32(dic[&quot;Output&quot;]);
                            if (Output == 1) { ShowSuccess(&quot;The project is deferred successfully.&quot;); }
                            if (Output == 0)
                                throw new Exception(
                                    &quot;The workflow status of one or more records does not permit defer operation.&quot;);
                        }
                        break;
                    case &quot;Audit Log&quot;:
                        BrixFormModel xmlModel = new BrixFormModel(ProductTemplateName, ProductTemplateName + &quot;.xml&quot;, XMLType.Form, Request, Response);
                        ValidateFormForAuditLog(xmlModel);
                        break;

                    default:
                        return base.HandleMenuItem(eventString);

                }
                return String.Empty;
            }
            catch (Exception ex)
            {
                return ex.Message;
            }
        }

        public override string HandleMenuItems(string eventString, UltraWebGridExcelExporter UltraWebGridExcelExporter1, string filter = &quot;&quot;)
        {
            string error = String.Empty;
            if (eventString.Equals(LocalizationManager.GetString(&quot;Project&quot;) + &quot; Details Report&quot;))
            {
                DataTable bindingTable;
                bindingTable = GetProjectDetailsforExport().Select(filter).CopyToDataTable();
                if (bindingTable.Rows.Count &gt; 0)
                {
                    var UltraWebGrid2 = new UltraWebGrid(&quot;grd_Temp&quot;);
                    UltraWebGrid2.DataSource = bindingTable;
                    UltraWebGrid2.DataBind();
                    foreach (UltraGridColumn uwc in UltraWebGrid2.Columns)
                        uwc.Header.Style.Font.Bold = true;
                    UltraWebGridExcelExporter1.DownloadName = LocalizationManager.GetString(&quot;Project&quot;) +
                                                              &quot; Details Report.xls&quot;;
                    UltraWebGridExcelExporter1.WorksheetName = LocalizationManager.GetString(&quot;Project&quot;) +
                                                               &quot; Details Report&quot;;
                    UltraWebGridExcelExporter1.Export(UltraWebGrid2);
                }
                else
                {
                    return &quot;No &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;s to Export&quot;;
                }
            }
            else
                error = HandleMenuItem(eventString);
            return error;
        }

        public override DataSet GetList(int pageSize, string sortOrder, string filter, ref int CurrentPage,
            out int count)
        {
            #region Override SortOrder for Image Cols

            sortOrder = string.IsNullOrEmpty(sortOrder)
                ? UIHelper.GetSortOrder(DefaultSortColumn, GridSortOrder.Ascending)
                : sortOrder;

            if (!string.IsNullOrEmpty(sortOrder) &amp;&amp; sortOrder.Contains(&quot;img_&quot;))
                sortOrder = sortOrder.Replace(&quot;img_&quot;, string.Empty);

            #endregion

            UserDetail ud = UserDetail.GetCurrentUserDetail();

            //Showing only the AX Mapped projecs of the logged-in company and the projects which are not mapped to any company
            //Additonal paramter - AXCompany (Only if AX is uploaded)
            string AXCompany = null;

            if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            {
                AXCompany = AdditionalInfo[&quot;AXCompany&quot;].ToString2();
            }

            // For MTO we are passing some value in Axcompanay if it is for unplanned GWPs
            if (Request.QueryString[&quot;PP&quot;] == &quot;1&quot;)
            {
                AXCompany = &quot;123MTO&quot;;
            }
            DataTable projectDT = new DataTable();
            int rowCount = 0;

            if (!UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
            {
                projectDT = ProjectManager.Instance.GetProjectsWithFeaturePermission(ud.UID,
                    ud.RID,
                    Constants.MODFEAT_VISIBILITY,
                    ProjectConstants.
                        MODID_PROJECT,
                    (1 +
                     (pageSize *
                      (CurrentPage == 0
                          ? 0
                          : CurrentPage - 1))),
                    pageSize,
                    sortOrder,
                    filter, AXCompany,
                    FilterOrSortHasPendingOnUser, out rowCount);
            }
            else
            {
                projectDT = ProjectManager.Instance.GetPlanningProjectsWithFeaturePermission(ud.UID,
                    ud.RID,
                    Constants.MODFEAT_VISIBILITY,
                    ProjectConstants.
                        MODID_PROJECT,
                    (1 +
                     (pageSize *
                      (CurrentPage == 0
                          ? 0
                          : CurrentPage - 1))),
                    pageSize,
                    sortOrder,
                    filter, AXCompany, (IsProposedProject) ? 1 : 0,
                    FilterOrSortHasPendingOnUser, out rowCount);

                //DataSet projectDS = CoreDatabaseHelper.GetODSData(&quot;vw_ProjectList&quot;, pageSize, sortOrder, filter, true,
                //                                        ref CurrentPage, out count, DataSourceFilters,
                //                                        DataSourceFiltersWithValue);
                //if (projectDS.Tables.Count &gt; 0 &amp;&amp; projectDS.Tables[0].Rows.Count &gt; 0)
                //{
                //    projectDT = projectDS.Tables[0];
                //    rowCount = projectDT.Rows.Count;
                //}
            }

            //            if (Request.QueryString[&quot;PP&quot;] == &quot;1&quot;)
            //            {
            //                //Then bring only proposed projects PP= Proposed Projects
            //                //Get the list of all the projects which are a part of Plan
            //                string unapprovedIds = ComponentHelper.Instance.ExecuteScalar(@&quot;declare @ids  nvarchar(max) = &#39;&#39; 
            //                    select @ids = @ids + cast(PM.ProjectId as nvarchar) + &#39;,&#39;  
            //                    from PROJECTProjectMain PM 
            //                    left outer join PLANINGProjects PP on PM.ProjectId = PP.ProjectId 
            //                    left outer join WorkflowFormMapping wf on wf.FormInstanceID = pp.PlanningID and wf.FormID = &#39;PLANING&#39;  
            //                    where wf.CurrentStatus &lt;&gt; &#39;Approved&#39; or PP.ID is null  select @ids&quot;).ToString();

            //                DataRow[] rows = projectDT.Select(&quot;ProjectID in (&quot; + unapprovedIds + &quot;)&quot;);
            //                rowCount = rows.Length;

            //                if (rowCount &gt; 0)
            //                {
            //                    DataTable newProjectDt = new DataTable();
            //                    rows.CopyToDataTable(newProjectDt, LoadOption.OverwriteChanges);
            //                    projectDT = newProjectDt;
            //                }
            //            }

            //if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            //{
            //    DataTable dtAXProjects = new BrixDataTable();
            //    int rowCountAX = 0;
            //    dtAXProjects = IntegrationConnectorManager.Instance.GetAXMappedProjects();
            //    DataRow[] drSelect = dtAXProjects.Select(&quot;ERPCompany &lt;&gt; &#39;&quot; + AdditionalInfo[&quot;AXCompany&quot;].ToString2() + &quot;&#39;&quot;);
            //    foreach (DataRow dr in drSelect)
            //    {
            //        DataRow[] drProjectDT = projectDT.Select(&quot;ProjectID = &quot; + dr[&quot;AMP3Id&quot;]);
            //        if (drProjectDT.Length &gt; 0)
            //        {
            //            projectDT.Rows.Remove(drProjectDT[0]);
            //            rowCountAX++;
            //        }
            //    }
            //    rowCount = rowCount - rowCountAX;
            //}

            if (sortOrder.Contains(&quot;DISPLAYTEXT&quot;) &amp;&amp; projectDT.Select(&quot;IsActive=1&quot;).Length &gt; 0 &amp;&amp;
                projectDT.Select(&quot;IsActive=0&quot;).Length &gt; 0)
            {
                if (mwGrid.Page.IsPostBack)
                    Response.Redirect(Request.RawUrl, true);
                ScriptManager.RegisterStartupScript(mwGrid.Page, typeof(UltraWebGrid), &quot;GridClientSortOnHiddenColumn&quot;,
                    &quot;&lt;script&gt;$(document).ready(function () { GridClientSortOnHiddenColumn(&#39;&quot; + mwGrid.ClientID +
                    &quot;&#39;, &#39;IsActive&#39;, &quot; + (sortOrder.EndsWith(&quot; DESC&quot;) ? &quot;0&quot; : &quot;1&quot;) + &quot;); } ) &lt;/script&gt;&quot;, false);
            }


            if ((rowCount % pageSize) == 0)
                count = rowCount / pageSize;
            else
                count = rowCount / pageSize + 1;

            if (count == 0) CurrentPage = 0;

            return projectDT.DataSet;
        }

        public override void SetGridColumnProperties&lt;T&gt;(T grid)
        {
            base.SetGridColumnProperties(grid);
        }

        public override void OnPreRender()
        {
            var invitedRoles = mwGrid.MasterTableView.GetColumnSafe(&quot;InvitedRoles&quot;) as GridBoundColumn;
            if (invitedRoles != null)
            {
                invitedRoles.AllowFiltering = false;
                invitedRoles.AllowSorting = false;
            }
            //KK: not necessary anymore mwGrid.Rebind();

            base.OnPreRender();
        }

        protected DataTable GetProjectDetailsforExport()
        {
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            string AXCompany = ((Page)HttpContext.Current.Handler).Session[Constants.EIS_ADDITIONAL_INFO] == null
                ? string.Empty
                : ((Page)HttpContext.Current.Handler).Session[Constants.EIS_ADDITIONAL_INFO].
                    ToString2();

            DataTable dtProjects =
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjects, null, AXCompany, ud.RID,
                    ud.UID).Tables[
                        0];
            DataTable dtMasterAttribs =
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetAttributes, null, false).Tables[0];
            DataTable dtProjectAttribs;
            DataRow[] drColl;
            string attribName = string.Empty;
            string attribValue = string.Empty;
            int i = 1;

            string[,] newColumns =
            {
                { &quot;SL. No.&quot;, &quot;0&quot; }, { &quot;Date Created&quot;, &quot;4&quot; }, { &quot;Start Date&quot;, &quot;6&quot; },
                { &quot;End Date&quot;, &quot;7&quot; }
            };
            for (int count = 0; count &lt; newColumns.GetLength(0); count++)
            {
                dtProjects.Columns.Add(newColumns[count, 0]);
                dtProjects.Columns[newColumns[count, 0]].SetOrdinal(newColumns[count, 1].Parse2());
            }

            foreach (DataRow dr in dtMasterAttribs.Select(&quot;ModuleId=&#39;Project&#39;&quot;))
            {
                dtProjects.Columns.Add(dr[&quot;AttributeName&quot;].ToString2());
            }

            dtProjects.AcceptChanges();

            foreach (DataRow dr1 in dtProjects.Select())
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dtProjectAttribs =
                    ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjAttribs, dic,
                        dr1[&quot;ProjectID&quot;].ToString2().Parse2()).Tables[0];

                foreach (DataRow dr2 in dtMasterAttribs.Select(&quot;ModuleId=&#39;Project&#39;&quot;))
                {
                    attribName = (dr2[&quot;AttributeName&quot;]).ToString2();
                    drColl = dtProjectAttribs.Select(&quot;AttributeName = &#39;&quot; + attribName + &quot;&#39;&quot;);
                    attribValue = (drColl.Length.Equals(0)) ? &quot;&quot; : drColl[0][&quot;AttributeValue&quot;].ToString2();
                    dr1[attribName] = attribValue;
                }

                dr1[&quot;SL. No.&quot;] = i++;
                dr1[&quot;DISPLAYTEXT&quot;] = dr1[&quot;IsActive&quot;].ToString2().Equals(&quot;True&quot;) ? &quot;Yes&quot; : &quot;No&quot;;

                string[,] dateLocalization =
                {
                    { &quot;Date Created&quot;, &quot;Date&quot; }, { &quot;Start Date&quot;, &quot;StartDate&quot; },
                    { &quot;End Date&quot;, &quot;EndDate&quot; }
                };
                for (int count = 0; count &lt; 3; count++)
                {
                    dr1[dateLocalization[count, 0]] =
                        Convert.ToDateTime(dr1[dateLocalization[count, 1]], DateFormatCulture.GetDateFormatCulture()).
                            ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                }
            }

            string[] colRemove = { &quot;ProjectID&quot;, &quot;StatusID&quot;, &quot;TemplateID&quot;, &quot;IsActive&quot;, &quot;Date&quot;, &quot;StartDate&quot;, &quot;EndDate&quot; };
            foreach (string str in colRemove)
            {
                dtProjects.Columns.Remove(str);
            }

            string[,] newCaptions =
            {
                { &quot;ProjectCode&quot;, &quot;Project Code&quot; }, { &quot;ProjectName&quot;, LocalizationManager.GetString(&quot;Project&quot;) + &quot; Name&quot; },
                { &quot;DISPLAYTEXT&quot;, &quot;Is Active&quot; }, { &quot;StatusName&quot;, &quot;Status&quot; },
                { &quot;ProjectMode&quot;, LocalizationManager.GetString(&quot;Project&quot;) + &quot; Mode&quot; }
            };
            for (int count = 0; count &lt; newCaptions.GetLength(0); count++)
            {
                dtProjects.Columns[newCaptions[count, 0]].Caption = newCaptions[count, 1];
            }

            dtProjects.AcceptChanges();
            return dtProjects;
        }

        public override string GetEditPageURL(string pID, string parentID, string instanceID, string context)
        {
            //check if planning module exists
            if (!UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
            {
                return (string.Format(&quot;~/Modules/PROJECT/CreateProjects.aspx?{0}={1}&quot;, Constants.QRY_PROJECTID, instanceID));
            }
            else
            {
                //check if the project is a planned project
                bool isPlanned = ProjectManager.Instance.CheckIfPlannedProject(instanceID);
                if (!isPlanned)
                {
                    return (string.Format(&quot;~/Modules/PROJECT/CreateProjects.aspx?{0}={1}&amp;PP=1&quot;, Constants.QRY_PROJECTID, instanceID));
                }
                else
                {
                    return (string.Format(&quot;~/Modules/PROJECT/CreateProjects.aspx?{0}={1}&quot;, Constants.QRY_PROJECTID, instanceID));
                }

            }
        }

        public override string GetViewPageURL(string pID, string parentID, string instanceID, string context)
        {
            return (string.Format(&quot;~/Modules/PROJECT/ProjectDetails.aspx?{0}={1}&amp;Mode=View&quot;, Constants.QRY_PROJECTID, instanceID));
        }

        public override bool HasAttachments
        {
            get { return true; }
        }

        Dictionary&lt;int, int&gt; folderIDs = new Dictionary&lt;int, int&gt;();

        public override int FolderID(string pID, string parentID, string instanceID, string context)
        {
            if (!folderIDs.ContainsKey(instanceID.ToInt32_2()))
                folderIDs.Add(instanceID.ToInt32_2(),
                    DocumentManager.Instance.GetInstanceRootFolder(instanceID.ToInt32_2(), &quot;PROJECT&quot;).FolderId);
            return folderIDs[instanceID.ToInt32_2()];
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[42,13,42,14,1],[43,17,43,49,1],[44,21,44,82,1],[45,17,45,44,1],[46,13,46,14,1],[51,17,51,18,1],[51,19,51,38,1],[51,39,51,40,1],[56,17,56,18,1],[56,19,56,36,1],[56,37,56,38,1],[61,17,61,18,0],[61,19,61,32,0],[61,33,61,34,0],[66,17,66,18,0],[66,19,66,50,0],[66,51,66,52,0],[71,17,71,18,0],[71,19,71,36,0],[71,37,71,38,0],[77,13,77,14,1],[78,17,81,94,1],[82,13,82,14,1],[96,9,96,10,0],[97,13,97,79,0],[98,13,98,14,0],[99,17,102,126,0],[103,13,103,14,0],[104,9,104,10,0],[107,9,107,10,1],[108,13,108,51,1],[109,13,109,46,1],[110,13,110,79,1],[112,13,112,44,1],[113,13,113,27,1],[114,13,114,24,1],[115,9,115,10,1],[123,17,123,18,1],[123,19,123,36,1],[123,37,123,38,1],[128,17,128,18,0],[128,19,128,28,0],[128,29,128,30,0],[133,17,133,18,1],[133,19,133,38,1],[133,39,133,40,1],[138,17,138,18,0],[138,19,138,28,0],[138,29,138,30,0],[146,13,146,14,0],[147,17,147,62,0],[151,17,151,84,0],[153,17,153,70,0],[154,17,154,33,0],[155,21,155,103,0],[157,17,157,113,0],[158,17,158,89,0],[159,21,159,118,0],[161,17,161,40,0],[162,21,162,118,0],[164,17,164,55,0],[165,21,165,113,0],[167,17,167,37,0],[168,21,168,123,0],[170,17,170,98,0],[171,17,171,69,0],[172,21,172,102,0],[174,17,174,52,0],[175,21,175,58,0],[181,17,181,63,0],[181,63,181,83,1],[181,83,181,85,0],[181,17,181,85,0],[182,17,182,41,0],[183,17,183,18,0],[184,21,184,63,0],[185,21,185,70,0],[186,17,186,18,0],[187,17,187,85,0],[187,85,187,108,1],[187,108,187,110,0],[187,17,187,110,0],[188,17,188,57,0],[189,17,189,32,0],[190,21,190,94,0],[191,17,191,44,0],[192,17,192,18,0],[198,17,198,18,0],[199,17,199,32,0],[200,21,200,54,0],[204,17,204,61,0],[205,21,205,98,0],[207,17,207,35,0],[208,13,208,14,0],[212,9,212,10,1],[214,13,214,102,1],[215,13,215,90,1],[218,13,218,80,1],[220,13,220,151,1],[223,13,223,76,1],[224,13,224,80,1],[225,13,225,80,1],[226,13,226,78,1],[227,13,227,79,1],[229,13,229,81,1],[230,13,230,82,1],[231,13,231,147,1],[233,13,233,85,1],[234,13,234,88,1],[235,13,235,81,1],[237,13,237,73,1],[238,13,238,14,1],[239,17,239,107,1],[240,17,240,88,1],[241,17,241,81,1],[242,17,242,81,1],[243,13,243,14,1],[245,13,245,45,1],[246,13,246,14,1],[247,17,249,41,1],[250,21,250,90,1],[252,21,253,77,0],[254,13,254,14,1],[256,13,256,14,0],[257,17,258,73,0],[259,13,259,14,0],[261,13,262,47,1],[263,13,263,45,1],[264,13,264,14,1],[265,17,265,133,1],[266,17,266,18,1],[267,21,267,40,1],[268,17,268,18,1],[270,21,270,39,1],[271,13,271,14,1],[273,13,273,34,1],[274,13,274,32,1],[275,13,275,39,1],[276,13,276,32,1],[277,13,277,40,1],[278,13,278,36,1],[279,13,279,37,1],[282,13,282,32,1],[283,13,283,39,1],[284,13,284,43,1],[288,13,288,39,1],[292,13,292,42,1],[294,13,294,45,1],[295,13,295,14,1],[296,17,296,106,1],[297,21,297,94,1],[299,21,299,81,1],[300,13,300,14,1],[301,9,301,10,1],[304,9,304,10,1],[306,13,306,85,1],[306,86,306,114,0],[308,13,308,78,1],[310,13,310,62,1],[310,63,310,83,0],[311,13,311,38,1],[312,13,312,14,1],[313,17,313,74,1],[313,75,313,99,0],[314,17,314,75,1],[314,76,314,101,0],[315,13,315,14,1],[317,13,317,105,1],[318,13,318,115,1],[320,13,320,70,1],[321,13,321,14,0],[322,17,322,41,0],[323,13,323,14,0],[325,13,325,88,1],[326,17,326,43,0],[327,9,327,10,1],[330,9,330,10,1],[331,13,331,121,1],[332,13,332,83,1],[335,13,335,43,1],[336,13,336,42,1],[337,13,337,45,1],[338,13,338,58,1],[340,13,340,43,1],[341,13,341,39,1],[342,13,342,45,1],[343,13,343,58,1],[386,13,386,43,1],[387,13,387,40,1],[388,13,388,39,1],[389,13,389,58,1],[391,13,391,43,1],[392,13,392,48,1],[393,13,393,42,1],[394,13,394,59,1],[395,13,395,66,1],[396,13,396,47,1],[397,13,397,49,1],[398,13,398,46,1],[401,13,401,30,1],[402,13,402,14,0],[403,17,403,47,0],[404,17,404,87,0],[405,17,405,49,0],[406,17,406,63,0],[407,17,407,70,0],[408,17,408,56,0],[409,17,409,49,0],[410,13,410,14,0],[411,18,411,55,1],[412,13,412,14,1],[413,17,413,47,1],[414,17,414,45,1],[415,17,415,44,1],[416,17,416,62,1],[417,13,417,14,1],[418,18,418,54,0],[419,13,419,14,0],[420,17,420,47,0],[421,17,421,45,0],[422,17,422,44,0],[423,17,423,62,0],[424,13,424,14,0],[426,13,426,28,1],[427,9,427,10,1],[430,9,430,10,1],[431,13,431,27,1],[432,13,432,49,1],[433,13,433,14,0],[434,17,434,27,0],[435,13,435,14,0],[436,18,436,55,1],[437,13,437,14,1],[438,17,438,27,1],[439,13,439,14,1],[440,18,440,55,0],[441,13,441,14,0],[442,17,442,27,0],[443,13,443,14,0],[444,18,444,56,0],[445,13,445,14,0],[446,17,446,27,0],[447,13,447,14,0],[448,13,448,26,1],[449,9,449,10,1],[452,9,452,10,1],[453,13,455,81,1],[456,17,456,79,0],[457,13,457,29,1],[458,13,458,36,1],[459,17,459,63,0],[461,17,461,68,1],[462,13,462,42,1],[463,9,463,10,0],[466,9,466,10,0],[467,13,467,61,0],[469,13,469,52,0],[470,13,470,14,0],[471,17,471,106,0],[474,13,474,14,0],[475,17,475,62,0],[476,17,476,59,0],[478,17,478,110,0],[479,17,479,73,0],[480,17,480,18,0],[481,21,481,63,0],[482,21,482,59,0],[484,26,484,35,0],[484,37,484,68,0],[484,70,484,73,0],[485,25,485,143,0],[486,17,486,18,0],[487,17,487,79,0],[488,17,488,84,0],[490,17,490,40,0],[491,21,493,75,0],[495,21,497,80,0],[498,13,498,14,0],[499,9,499,10,0],[502,9,502,10,1],[503,13,503,61,1],[505,13,505,52,1],[506,13,506,14,0],[507,17,507,106,0],[510,13,510,14,1],[511,17,515,27,1],[516,13,516,14,0],[517,9,517,10,0],[520,9,520,10,1],[521,13,521,61,1],[523,13,523,52,1],[524,13,524,14,0],[525,17,525,106,0],[528,13,528,14,1],[530,17,530,18,1],[531,21,531,129,1],[532,21,532,81,1],[533,21,533,22,1],[534,25,534,40,1],[535,25,535,91,1],[536,25,536,126,1],[537,25,537,65,1],[539,25,539,41,1],[540,29,540,135,0],[541,21,541,22,1],[543,21,543,85,1],[544,21,544,88,1],[545,21,545,152,1],[546,17,546,18,1],[547,17,547,37,0],[548,17,548,18,0],[549,21,549,30,0],[552,17,555,85,1],[556,13,556,14,0],[558,13,558,22,0],[559,9,559,10,0],[562,9,562,10,1],[563,13,563,61,1],[565,13,565,52,1],[566,13,566,14,0],[567,17,567,106,0],[570,13,570,14,1],[571,17,571,48,1],[574,17,574,18,1],[575,21,575,110,1],[576,25,576,55,0],[578,17,578,18,1],[579,17,579,37,0],[580,17,580,18,0],[581,21,581,27,0],[583,17,586,79,1],[587,13,587,14,0],[588,13,588,22,0],[589,9,589,10,0],[592,9,592,10,1],[593,13,593,55,1],[594,13,594,14,1],[595,17,598,188,1],[599,13,599,14,0],[600,9,600,10,0],[603,9,603,10,1],[605,13,605,14,1],[607,17,607,37,1],[610,25,613,73,1],[614,25,614,31,0],[616,25,616,73,1],[618,25,618,64,1],[619,25,619,26,0],[620,29,620,118,0],[623,25,623,26,1],[624,29,626,97,1],[627,29,627,30,0],[628,33,628,95,0],[631,33,637,43,1],[638,25,638,26,0],[639,25,639,31,0],[642,25,644,31,1],[645,25,645,31,0],[647,25,650,78,0],[651,25,651,31,0],[654,25,657,88,0],[658,25,658,31,0],[660,25,660,70,0],[661,25,661,61,0],[662,25,662,26,0],[663,29,663,118,0],[666,25,666,26,0],[667,29,667,44,0],[668,29,668,95,0],[669,29,669,119,0],[670,29,670,69,0],[671,29,671,45,0],[671,46,671,47,0],[671,48,671,101,0],[671,102,671,103,0],[672,29,672,45,0],[673,33,674,116,0],[675,25,675,26,0],[676,25,676,31,0],[678,25,678,152,0],[679,25,679,59,0],[680,25,680,31,0],[683,25,683,65,0],[686,17,686,37,0],[688,13,688,33,1],[689,13,689,14,1],[690,17,690,35,1],[692,9,692,10,1],[695,9,695,10,1],[696,13,696,41,1],[697,13,697,98,1],[698,13,698,14,0],[700,17,700,94,0],[701,17,701,49,0],[702,17,702,18,0],[703,21,703,70,0],[704,21,704,61,0],[705,21,705,46,0],[706,21,706,28,0],[706,30,706,49,0],[706,50,706,52,0],[706,53,706,74,0],[707,25,707,59,0],[708,21,709,85,0],[710,21,711,82,0],[712,21,712,70,0],[713,17,713,18,0],[715,17,715,18,0],[716,21,716,93,0],[718,13,718,14,0],[720,17,720,53,1],[721,13,721,26,0],[722,9,722,10,0],[726,9,726,10,1],[729,13,731,29,1],[733,13,733,80,1],[734,17,734,69,0],[738,13,738,63,1],[742,13,742,37,1],[744,13,744,103,1],[745,13,745,14,0],[746,17,746,69,0],[747,13,747,14,0],[750,13,750,50,1],[751,13,751,14,1],[752,17,752,38,1],[753,13,753,14,1],[754,13,754,51,1],[755,13,755,30,1],[757,13,757,74,1],[758,13,758,14,0],[759,17,772,65,0],[773,13,773,14,0],[775,13,775,14,1],[776,17,789,65,1],[799,13,799,14,1],[841,13,842,59,1],[843,13,843,14,0],[844,17,844,44,0],[845,21,845,61,0],[846,17,848,112,0],[849,13,849,14,0],[852,13,852,44,1],[853,17,853,45,1],[855,17,855,49,1],[857,13,857,28,1],[857,29,857,45,0],[859,13,859,38,1],[860,9,860,10,1],[863,9,863,10,1],[864,13,864,48,1],[865,9,865,10,1],[868,9,868,10,1],[869,13,869,104,1],[870,13,870,38,1],[871,13,871,14,0],[872,17,872,53,0],[873,17,873,51,0],[874,13,874,14,0],[877,13,877,32,1],[878,9,878,10,1],[881,9,881,10,0],[882,13,882,63,0],[883,13,886,33,0],[888,13,891,28,0],[892,13,893,122,0],[896,13,896,46,0],[897,13,897,47,0],[898,13,898,23,0],[900,13,904,15,0],[905,18,905,31,0],[905,33,905,64,0],[905,66,905,73,0],[906,13,906,14,0],[907,17,907,62,0],[908,17,908,100,0],[909,13,909,14,0],[911,13,911,20,0],[911,22,911,32,0],[911,33,911,35,0],[911,36,911,80,0],[912,13,912,14,0],[913,17,913,73,0],[914,13,914,14,0],[916,13,916,40,0],[918,13,918,20,0],[918,22,918,33,0],[918,34,918,36,0],[918,37,918,56,0],[919,13,919,14,0],[920,17,920,60,0],[921,17,923,74,0],[925,17,925,24,0],[925,26,925,37,0],[925,38,925,40,0],[925,41,925,85,0],[926,17,926,18,0],[927,21,927,69,0],[928,21,928,94,0],[929,21,929,108,0],[930,21,930,51,0],[931,17,931,18,0],[933,17,933,38,0],[934,17,934,96,0],[936,17,940,19,0],[941,22,941,35,0],[941,37,941,46,0],[941,48,941,55,0],[942,17,942,18,0],[943,21,945,112,0],[946,17,946,18,0],[947,13,947,14,0],[949,13,949,120,0],[950,13,950,20,0],[950,22,950,32,0],[950,33,950,35,0],[950,36,950,45,0],[951,13,951,14,0],[952,17,952,48,0],[953,13,953,14,0],[955,13,960,15,0],[961,18,961,31,0],[961,33,961,65,0],[961,67,961,74,0],[962,13,962,14,0],[963,17,963,91,0],[964,13,964,14,0],[966,13,966,40,0],[967,13,967,31,0],[968,9,968,10,0],[971,9,971,10,1],[973,13,973,74,1],[974,13,974,14,0],[975,17,975,126,0],[978,13,978,14,1],[980,17,980,92,1],[981,17,981,32,1],[982,17,982,18,1],[983,21,983,135,1],[986,17,986,18,0],[987,21,987,130,0],[991,9,991,10,1],[994,9,994,10,0],[995,13,995,132,0],[996,9,996,10,0],[1000,17,1000,18,1],[1000,19,1000,31,1],[1000,32,1000,33,1],[1003,9,1003,69,1],[1006,9,1006,10,0],[1007,13,1007,64,0],[1008,17,1009,113,0],[1010,13,1010,54,0],[1011,9,1011,10,0]]);
    </script>
  </body>
</html>