<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Platform UI\Modules\PROJECT\ProjectDetails.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Web;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.LibraryDAC;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectBL;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.TabInjectionDAC;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Infragistics.WebUI.UltraWebGrid;
using Aurigo.Brix.Platform.UI.Common.Helpers;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using System.Web.Script.Serialization;
using Aurigo.Common.Utility;
using System.Collections.Specialized;
using System.Linq;

namespace Aurigo.AMP3.ProjectUI
{
    public partial class ProjectDetails : BrixPageBase, IXMLControl, IWorkflowEnabled
    {
        #region Private Fields

        //private Dictionary&lt;string, UltraChart&gt; charts;
        //private Dictionary&lt;string, DataSet&gt; myDatas = new Dictionary&lt;string, DataSet&gt;();
        //private DashboardChartManager xmlChart;
        private bool allowCopy;
        private bool allowDeactivate;
        private bool allowDelete;
        private bool allowEdit;
        private bool allowManageUsers;
        private bool landAttached;
        private bool allowManageUserProject;
        private int projectID;
        List&lt;string&gt; featurelist;
        private CalendarCalculationsModel _projectCalendarModel = CalendarCalculationsModel.GetInstance(&quot;PROJECT&quot;);
        private int Thumbnail = 0;

        /// &lt;summary&gt;
        /// Gets the Integration Cutoff Date
        /// &lt;/summary&gt;
        private DateTime IntegrationCutoffDate
        {
            get { return (DateTime)Session[Constants.APP_IntegrationCutoffDate]; }
        }

        /// &lt;summary&gt;
        /// Gets the Default Record Date
        /// &lt;/summary&gt;
        private DateTime DefaultRecordDate
        {
            get { return (DateTime)Session[Constants.APP_DefaultRecordDate]; }
        }

        private BrixFormModel model;
        private XMLFormManagerModel managerModel;

        #endregion

        private readonly ProjectManager blInstance = ProjectManager.Instance;

        public BrixFormModel Model
        {
            get { return model; }
            set { model = value; }
        }

        public override void InclueScriptAndStyleFiles()
        {
            base.InclueScriptAndStyleFiles();

            RegisterClientScriptInclude(&quot;~/Scripts/projectDetailsView.js&quot;);
        }
        protected override void OnPreInit(EventArgs e)
        {
            if (base.Master is BrixTabMasterPage)
            {
                var objMasterPage = (base.Master as BrixTabMasterPage);
                objMasterPage.AMP3PageName = TabEnabledPages.ProjectDetails;
                objMasterPage.Mode = PageMode.View;
                objMasterPage.AMP3ObjectType = AMP3Object.PROJECT;
                objMasterPage.AMP3ObjectId = Request.QueryString[Constants.QRY_PROJECTID].ToInt32_2();
            }
            SetManagerModel();
            if (managerModel != null)
                managerModel.OnPreInit(model, new XmlFormArgs());
            base.OnPreInit(e);
        }

        private void SetManagerModel()
        {
            model = BrixFormModel.GetInstance(&quot;XPROJCT&quot;, &quot;XPROJCT&quot;, Request, Response);

            // KK: clean up code path if XPROJCT not loaded
            if (model != null &amp;&amp; model.form != null &amp;&amp; !string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp;
                !string.IsNullOrEmpty(model.form.FormManagerClass))
            {
                managerModel = AMP3InterfaceFactory.GetInstance&lt;XMLFormManagerModel&gt;(model.form.ManagerDLL,
                    model.form.FormManagerClass);
                // managerModel.PageViewState = ViewState;
            }
        }

        protected override void CustomizeToolBar()
        {
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Click += btnEdit_Click;
                if (!allowEdit) MainToolBar.HideMenu(&quot;lnkEdit&quot;);
            }
            List&lt;string&gt; CoreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            if (!CoreComponents.Contains(&quot;HideCopyProject&quot;))
                if (MainToolBar.GetMenuReference(&quot;lnkCopy&quot;) != null)
                {
                    MainToolBar.GetMenuReference(&quot;lnkCopy&quot;).Click += btnCopy_Click;
                    if (!allowCopy) MainToolBar.HideMenu(&quot;lnkCopy&quot;);
                }
            if (MainToolBar.GetMenuReference(&quot;lnkMap&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkMap&quot;).Click += btnMap_Click;
                if (!ProjectManager.Instance.IsERPConnecterAttached())
                    MainToolBar.HideMenu(&quot;lnkMap&quot;);
            }
            if (MainToolBar.GetMenuReference(&quot;lnkDelete&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).Click += btnDelete_Click;
                if (!allowDelete) MainToolBar.HideMenu(&quot;lnkDelete&quot;);
                MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).OnClientClick = &quot;return ConfirmDelete()&quot;;
            }
            MainToolBar.GetMenuReference(&quot;lnkMngUsers&quot;).Click += btnMngUsers_Click;
            if (!allowManageUsers || !allowManageUserProject) MainToolBar.HideMenu(&quot;lnkMngUsers&quot;);
            if ((allowManageUsers &amp;&amp; !allowManageUserProject) || (!allowManageUsers &amp;&amp; allowManageUserProject))
            {
                MainToolBar.ShowMenu(&quot;lnkMngUsers&quot;);
            }
            if (!CoreComponents.Contains(&quot;HideChangeStatus&quot;))
            {
                MainToolBar.GetMenuReference(&quot;lnkActivate&quot;).Click += btnActivate_Click;
                if (!allowDeactivate) MainToolBar.HideMenu(&quot;lnkActivate&quot;);
                MainToolBar.GetMenuReference(&quot;lnkActivate&quot;).OnClientClick = &quot;return ConfirmDeactivate();&quot;;
            }

            MainToolBar.GetMenuReference(&quot;lnkBack&quot;).Click += btnBack_Click;

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.AfterCustomizeToolbar(model, MainToolBar, args);
        }

        /// &lt;summary&gt;
        /// This page contains a details view control that has a object source as the method fo BL.
        /// This also contains 2 Datagrids which also receive the data from the object source which is set a method in BL
        /// The Modules datagrid is filled by filtering the Master modules list and the modules for the selected project since we store only the moduleID.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;        
        protected void Page_Load(object sender, EventArgs e)
        {
            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnPageLoad(model, args);

            try
            {
                if (String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                    || !int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out projectID)
                    )
                {
                    UIHelper.RedirectURL(&quot;Error loading the requested page.&quot;,
                        (IsProposedProject)
                            ? ResolveUrl(Constants.URL_PROJECTS) + &quot;&amp;PP=1&quot;
                            : ResolveUrl(Constants.URL_PROJECTS), null, Context);
                }

                UserDetail dtUser = UserDetail.GetCurrentUserDetail();
                if (!IsPostBack)
                {
                    CheckAndLoadLANDMGTDetails();

                    //hdnConfirmProjectDelete.Value =
                    //    MessageResourceManager.GetString(&quot;W_PROJECT_CONFIRM_DELETE_PROJECT&quot;,
                    //        Enumerations.MessageType.WarningMessage);
                }

                DataTable dtModules = ModuleManager.Instance.GetModules();
                DataRow[] rows = dtModules.Select(&quot;ModuleID=&#39;LANDMGT&#39;&quot;);
                if (rows != null &amp;&amp; rows.Length &gt; 0)
                {
                    landAttached = true;
                }

                UIHelper.DisableRoleSelection(Page);

                if (!ProjectManager.Instance.CheckIfUserHasAccess(projectID))
                    UIHelper.RedirectURL(&quot;The current role does not have the required permissions to view this page.&quot;,
                        ResolveUrl(Constants.URL_ENTERPRISE), null, Context);


                //For project works, Integration Date &amp; Project mode are made hidden

                List&lt;string&gt; components =
                    ModuleManagementBL.ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
                if (!components.Contains(&quot;IntegrationDateMode&quot;))
                {
                    trProjectMode.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    trIntegDate.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }
                if (!components.Contains(&quot;ShowProjectAttributes&quot;))
                {
                    trAttributes.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                    divAttributesGrid.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                }
                if (!components.Contains(&quot;ShowProjectScore&quot;))
                {
                    trProjectScore.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }

                if (!IsPostBack)
                {
                    attachments.InstanceID = Request.QueryString[Constants.QRY_PROJECTID];
                    attachments.SrcType = &quot;PROJECT&quot;;
                    attachments.ReadOnly = true;
                }
                ProjectManager.Instance.AddRecentProject(projectID, dtUser.UID);
                hdnProjectID.Value = projectID.ToString2();
                if (!IsPostBack)
                    GetImageAttachments(projectID);

                LoadModulesGrid();

                Project proj = ProjectManager.Instance.GetProjectDetails(projectID);

                if ((projectID &gt; 0 &amp;&amp; proj.ProjectID == 0) || (proj.IsDeleted.HasValue &amp;&amp; proj.IsDeleted.Value))
                {
                    UIHelper.RedirectURL(
                        LocalizationManager.GetString(&quot;Project&quot;) + &quot; you are trying to view is deleted.&quot;,
                        (IsProposedProject)
                            ? ResolveUrl(Constants.URL_PROJECTS) + &quot;&amp;PP=1&quot;
                            : ResolveUrl(Constants.URL_PROJECTS), null, Context);
                }

                txtActive.Checked = proj.ProjectIsActive;

                if (!proj.ProjectIsActive)
                {
                    allowEdit = false;
                    allowManageUsers = false;
                }

                txtCreatedDate.Text = proj.ProjectCreatedDate.ToMWDateTime().ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE,
                    CultureInfo.CurrentCulture);
                txtDesc.Text = proj.ProjectDescription;
                txtDesc.Attributes.Add(&quot;style&quot;, &quot;overflow:auto&quot;);

                txtBusinessUnit.Text = proj.BusinessUnitPath.BrixHTMLEncode();

                txtStartDate.Text = proj.ProjectStartDate.ToMWDateTime().ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                txtEndDate.Text = proj.ProjectEndDate.ToMWDateTime().ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                txtOwner.Text = proj.ProjectOwner.ToString2().BrixHTMLEncode();
                lblProjectScore.Text = String.Format(&quot;{0:0.00}&quot;, proj.ProjectScore).BrixHTMLEncode();

                if (ModuleManager.Instance.GetModuleList().ContainsKey(Constants.MODID_PLANING))
                {
                    lblProgramYear.Text = ((proj.ProgramYear == null) ? &quot;&quot; : proj.ProgramYear.ToString()).BrixHTMLEncode();
                    lblProjectClass.Text = ((proj.ProjectClassName == null) ? &quot;&quot; : proj.ProjectClassName.ToString()).BrixHTMLEncode();
                }
                else
                {
                    idProgramYear.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    idProjectClass.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    TrProjectValue.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }

                //lblProjectValue.Text = proj.ProjectValue.ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                //Set Project Value
                if (ModuleManager.Instance.GetModuleDetails(&quot;BDGMGMT&quot;) != null)
                {
                    Hashtable GetPValue = new Hashtable();
                    GetPValue = blInstance.GetProjectValue(projectID);
                    foreach (DictionaryEntry entry in GetPValue)
                    {
                        lblProjectValue.Text =
                            entry.Value.ToDecimal2()
                                .ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                    }
                }
                else
                {
                    TrProjectValue.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }

                txtStatus.Text = proj.ProjectStatusName.BrixHTMLEncode();

                txtProjName.Text = proj.ProjectName.BrixHTMLEncode();
                //UIHelper.ReplaceXMLCharEntities(proj.ProjectName,
                //                                UIHelper.XmlCharEntity.CE_ALL &amp;
                //                                ~UIHelper.XmlCharEntity.CE_APOS);
                txtProjNumber.Text = proj.ProjectCode.ToString2().BrixHTMLEncode();

                if (landAttached)
                    lblLandName.Text = ((String.IsNullOrEmpty(proj.LandMasterName))
                        ? &quot;No Land Attached&quot;
                        : proj.LandMasterName).BrixHTMLEncode();
                else
                    trLand.Visible = false; // lblLandName.Text = &quot;No Land Attached&quot;;

                lblDocumentTemplate.Text = proj.DocumentTemplateName.BrixHTMLEncode();

                lblDocMetadata.Text = proj.DocumentMetadataName.BrixHTMLEncode();

                //lblProjectCalendar.Text = proj.ProjectCalendarName;

                //tblAttributeKeys.EnableViewState = true;
                //tblAttributeValues.EnableViewState = true;
                //tblAttributeNotes.EnableViewState = true;

                ProjectManager.Instance.CreateAttributesHTMLTable(projectID, GrdA);
                HTMLEncodeGridColumns(GrdA);

                lblProjectMode.Text = (proj.ProjectMode == &#39;I&#39;) ? &quot;Integration&quot; : &quot;Live&quot;;
                lblIntegrationCutoffDate.Text =
                    (IntegrationCutoffDate.ToMWDateTime() == DateTime.MinValue.ToMWDateTime().AddDays(1))
                        ? &quot;&quot;
                        : IntegrationCutoffDate.ToMWDateTime().ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE,
                                CultureInfo.CurrentCulture);

                if (IntegrationCutoffDate.AddDays(-1) == DateTime.MinValue)
                {
                    trProjectMode.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    trIntegDate.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }

                // Fixed Bug - 123910 - Multi contract Mode:Forecast calendar is not showing up for the project(Showing irrespective of condition)
                //if (!AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                //{
                //    trCalendar.Style.Add(&quot;display&quot;, &quot;none&quot;);
                //    trTimeType.Style.Add(&quot;display&quot;, &quot;none&quot;);
                //    trDays.Style.Add(&quot;display&quot;, &quot;none&quot;);
                //}
                //else
                //{
                DataSet ds = _projectCalendarModel.GetLibraryCalendarList();
                if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                {
                    DataTable dt = ds.Tables[0];
                    if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                    {
                        foreach (DataRow row in dt.Rows)
                        {
                            if (row[&quot;ID&quot;].ToInt32_2() == proj.ExpenditureCurveID)
                            {
                                lblCalendar.Text = row[&quot;Name&quot;].ToString().BrixHTMLEncode();
                                break;
                            }
                        }
                    }
                }

                lblTimeType.Text = proj.ExpenditureCurveID &gt; 0 ? &quot;Working Days&quot; : &quot;Calendar Days&quot;;
                tdDaysCaption.InnerText = proj.ExpenditureCurveID &gt; 0 ? &quot;Working Days&quot; : &quot;Calendar Days&quot;;
                lblDays.Text = proj.CalendarDays.ToString();
                //}

                //Checking - Land Management Exists or Not
                var IsLandManagementEnabled =
                    ComponentHelper.Instance.ExecuteScalar(
                        &quot;select CASE WHEN IsActive=1 THEN &#39;1&#39; ELSE &#39;0&#39; END IsLandEnabled from MODMGMTModules where ModuleID=&#39;LANDMGT&#39;&quot;);
                if (IsLandManagementEnabled != null &amp;&amp; IsLandManagementEnabled.ToString() == &quot;1&quot;)
                    //This is Product feature so checking for planning module exists or not - Not Required
                    LoadLandGrid();
                else
                {
                    trLandGrid.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    trLandExpand.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }
                lblProjectName.Text = (LocalizationManager.GetString(&quot;Project&quot;) + &quot; Name &quot;).BrixHTMLEncode();
                lblProjectCode.Text = (LocalizationManager.GetString(&quot;Project&quot;) + &quot; Code &quot;).BrixHTMLEncode();
                lblBusinessUnit.Text = (LocalizationManager.GetString(&quot;BusinessUnit&quot;)).BrixHTMLEncode();
            }

            catch (Exception err)
            {
                lblException.Text = err.StackTrace;
            }
        }

        protected override void OnPreRender(EventArgs e)
        {
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            string s = CoreDatabaseHelper.GetControlSettings(ud.UID, &quot;Layout_ProjectInfo&quot;);
            WidgetSettings widgetSettings = new WidgetSettings(s);
            UIHelper.CreateDashboadTabs(0, PageTabBar, widgetSettings.pages, 0, &quot;ProjectInfo&quot;, BuildURL(string.Format(&quot;?pid={0}&quot;, projectID), null));
            if (PageTabBar.Tabs.Count == 0)
                PageTabBar.Tabs.Add(new Tab(LocalizationManager.GetString(&quot;Project&quot;) + &quot; Dashboard&quot;, BuildURL(string.Format(&quot;~/Modules/PROJECT/ProjectInfo.aspx?pid={0}&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;, projectID), null)));
            PageTabBar.Tabs.Add(new Tab(LocalizationManager.GetString(&quot;Project&quot;) + &quot; Details&quot;, &quot;#&quot;, true));
            base.OnPreRender(e);
        }

        private void CheckAndLoadLANDMGTDetails()
        {
            object data = CoreDatabaseHelper.GetDataFromAssembly(Constants.MODID_LANDMGT, &quot;GetLandMasterDetails&quot;,
                new object[] { -1, -1, &quot;ENTPRSE&quot;, 0, 0, null, null });

            if (data != null)
            {
                List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);

                if (ModuleComponents.Contains(&quot;LandManagementSingleMode&quot;))
                    trLand.Style.Add(HtmlTextWriterStyle.Display, &quot;table-row&quot;);
                else
                    trLand.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            }
        }

        private void LoadLandGrid()
        {
            DataSet dsLand = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_GetPLANINGLand, null,
                Request.QueryString[&quot;pid&quot;]);
            if (dsLand.Tables[0] != null &amp;&amp; dsLand.Tables[0].Rows.Count &gt; 0)
            {
                uwgLandDetails.DataSource = dsLand.Tables[0];
                uwgLandDetails.DataBind();
                HTMLEncodeGridColumns(uwgLandDetails);
            }
            else
            {
                uwgLandDetails.DataSource = null;
                uwgLandDetails.DataBind();
            }
        }

        private void LoadModulesGrid()
        {
            try
            {
                var xDoc = new XmlDocument();
                xDoc.LoadXml(ModuleManager.Instance.GetModulePlatforms(&quot;PROJECT&quot;));

                DataTable dtModulePlatforms = new BrixDataTable();
                dtModulePlatforms.Columns.Add(&quot;ModuleID&quot;);
                dtModulePlatforms.Columns.Add(&quot;ModuleName&quot;);
                foreach (XmlNode xModule in xDoc.SelectNodes(&quot;modules/module&quot;))
                {
                    foreach (XmlNode xPlatform in xModule.ChildNodes)
                    {
                        string platform = xPlatform.InnerText;
                        if (dtModulePlatforms.Columns.IndexOf(platform) == -1)
                        {
                            var colAvlbl = new DataColumn(platform);
                            colAvlbl.DataType = typeof(bool);
                            colAvlbl.DefaultValue = false;
                            dtModulePlatforms.Columns.Add(colAvlbl);
                        }
                    }
                }

                List&lt;Platform&gt; projModuleList = ProjectManager.Instance.GetProjectModules(projectID);
                XmlElement rootElem = xDoc.DocumentElement;

                XmlNodeList allModules = rootElem.GetElementsByTagName(&quot;module&quot;);

                foreach (Platform xPlatform in projModuleList)
                {
                    var values = new object[dtModulePlatforms.Columns.Count];
                    string moduleID = xPlatform.ModuleId;
                    string platformID = xPlatform.PlatformKey;
                    string tempModuleName = null;
                    string tempPlatformName = null;

                    foreach (XmlElement xmlElem in allModules)
                    {
                        if (moduleID == xmlElem.Attributes[&quot;key&quot;].Value.ToString2())
                        {
                            tempModuleName = xmlElem.Attributes[&quot;name&quot;].Value.ToString2();

                            values[1] = tempModuleName;
                            XmlNodeList modulePlatforms = xmlElem.GetElementsByTagName(&quot;platform&quot;);
                            for (int j = 0; j &lt; modulePlatforms.Count; j++)
                            {
                                if (platformID == modulePlatforms.Item(j).Attributes[&quot;key&quot;].Value.ToString2())
                                {
                                    tempPlatformName = modulePlatforms.Item(j).InnerText.ToString2();
                                }
                            }
                        }
                    }
                    if (!string.IsNullOrEmpty(tempPlatformName))
                    {
                        bool found = false;
                        for (int rowNo = 0; rowNo &lt; dtModulePlatforms.Rows.Count; rowNo++)
                        {
                            if (dtModulePlatforms.Rows[rowNo][0].ToString2().Equals(moduleID))
                            {
                                found = true;
                                dtModulePlatforms.Rows[rowNo][dtModulePlatforms.Columns.IndexOf(tempPlatformName)] =
                                    true;
                            }
                        }
                        if (!found)
                        {
                            values[0] = moduleID;
                            values[1] = tempModuleName;
                            for (int col = 2; col &lt; dtModulePlatforms.Columns.Count; col++)
                            {
                                values[col] = false;
                            }
                            int index = dtModulePlatforms.Columns.IndexOf(tempPlatformName);
                            if (index &gt;= 0 &amp;&amp; index &lt; dtModulePlatforms.Columns.Count)
                                values[index] = true;

                            dtModulePlatforms.Rows.Add(values);
                        }
                    }
                }

                grdModulePlatforms.DataSource = dtModulePlatforms;
                grdModulePlatforms.DataBind();
                grdModulePlatforms.Bands[0].Columns.FromKey(&quot;ModuleID&quot;).Hidden = true;
                //if (dtModulePlatforms.Rows.Count &gt; 0)
                // {
                grdModulePlatforms.Bands[0].Columns.FromKey(&quot;ModuleName&quot;).Header.Caption = &quot;Module Name&quot;;
                for (int k = 0; k &lt; grdModulePlatforms.Columns.Count; k++)
                    grdModulePlatforms.Columns[k].AllowUpdate = AllowUpdate.No;
                //  }
                if (dtModulePlatforms.Rows.Count &lt; 1)
                {
                    grdModulePlatforms.Columns.Clear();
                    grdModulePlatforms.DisplayLayout.NoDataMessage = &quot;No Modules available&quot;;
                }
                HTMLEncodeGridColumns(grdModulePlatforms);
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        private void HTMLEncodeGridColumns(UltraWebGrid grid)
        {
            if (grid == null)
                return;

            foreach (UltraGridColumn col in grid.Columns)
            {
                col.HTMLEncodeContent = true;
            }
        }

        /// &lt;summary&gt;
        /// Fires when the Copy button is clicked.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void btnCopy_Click(object sender, EventArgs e)
        {
            Response.Redirect(BuildURL(&quot;CopyProject.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID.ToString2(), new List&lt;string&gt; { &quot;Mode&quot; }),
                true);
        }

        /// &lt;summary&gt;
        /// Fires when the Edit button is clicked.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void btnEdit_Click(object sender, EventArgs e)
        {
            var requestObj = HttpContext.Current.Request;
            var urlPath = requestObj.Url.PathAndQuery;

            var queryStringCollection = new NameValueCollection(HttpContext.Current.Request.QueryString);
            if (queryStringCollection.AllKeys.Contains(&quot;ReturnUrl&quot;))
            {
                queryStringCollection.Remove(&quot;ReturnUrl&quot;);
                urlPath = requestObj.Url.AbsolutePath;

                for (int i = 0; i &lt; queryStringCollection.Count; i++)
                    urlPath += string.Format(&quot;{0}{1}={2}&quot;, (i == 0 ? &quot;?&quot; : &quot;&amp;&quot;), queryStringCollection.Keys[i], queryStringCollection[i]);
            }

            string encryptedURL = SecurityHelpers.Encrypt_Simple(urlPath);

            string retUrl = HttpContext.Current.Server.UrlEncode(encryptedURL);
            Response.Redirect(
                BuildURL(&quot;CreateProjects.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;Mode=Edit&quot; + &quot;&amp;ReturnUrl=&quot; + retUrl, null),
                true);
        }

        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        /// &lt;summary&gt;
        /// Fires when the Delete button is clicked.This calls the BL method to delete the selected Project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected virtual void btnDelete_Click(object sender, EventArgs e)
        {
            try
            {
                if (allowDelete)
                {
                    if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
                    {
                        var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                        additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, Session[&quot;AXCompany&quot;].ToString());
                        var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                        dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);
                        var lstBrixMapInfo = new List&lt;ConnectionBrixInfo&gt;();
                        lstBrixMapInfo.Add(new ConnectionBrixInfo(AMP3Object.PROJECT, projectID.ToString2(),
                            AMP3Object.UNKNOWN, null));

                        var connectorParameter = new ConnectorParameters(dictAdditionalInfo,
                            MethodBase.GetCurrentMethod(),
                            AMP3ObjectType.Unknown, null, lstBrixMapInfo);
                        // int count = 0;
                        DataSet ds = new BrixDataSet();
                        if (IntegrationConnectorManager.HandleApprovalWorkflow(connectorParameter, EISObjectType.Project))
                        {
                            DeleteProject(projectID);
                            //Response.Redirect(BuildURL((IsProposedProject)?&quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&amp;PP=1&quot;:&quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&quot;), true);
                        }
                        else
                            ShowError(&quot;Cannot delete the &quot; + LocalizationManager.GetString(&quot;Project&quot;) +
                                 &quot; as mapping exists in AX.&quot;);
                    }
                    else
                    {
                        DeleteProject(projectID);
                        DocumentManager.Instance.DeleteFolderContents(
                            DocumentManager.Instance.GetInstanceRootFolder(projectID, &quot;PROJECT&quot;));
                        Response.Redirect(
                            BuildURL((IsProposedProject)
                                ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&amp;PP=1&quot;
                                : &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&quot;, null), true);
                    }
                }
                else
                {
                    ShowError(&quot;The user does not have the required permissions to delete the &quot; +
                        LocalizationManager.GetString(&quot;Project&quot;));
                }
            }
            catch (Exception err)
            {
                lblException.Text = err.Message;
            }
        }

        private int DeleteProject(int projectID)
        {
            int i = 0;

            if (!string.IsNullOrEmpty(checkWorkFlowValidation(FormName, projectID.ToString())))
            {
                if (ModuleManager.Instance.GetModuleList().ContainsKey(Constants.MODID_PLANING))
                {
                    int Output = 0;
                    Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
                    ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PLANINGDeferProjects, dic, projectID);
                    Output = Convert.ToInt32(dic[&quot;Output&quot;]);
                    if (Output == 0)
                    {
                        Session[&quot;WorkflowErrOnLastPage&quot;] = LocalizationManager.GetString(&quot;Project&quot;) +
                                                           &quot;s that were deferred cannot be deleted.&quot;;
                        return projectID;
                    }
                }

                i = ProjectManager.Instance.DeleteProject(projectID);
                if (i == 1)
                    DocumentManager.Instance.DeleteFolderContents(DocumentManager.Instance.GetInstanceRootFolder(projectID,
                        &quot;PROJECT&quot;));
            }

            return i;

        }

        /// &lt;summary&gt;
        /// Fires when the Activate button is clicked.This calls the BL method to Activate/Deactivate a particular project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void btnActivate_Click(object sender, EventArgs e)
        {
            try
            {
                string errorMsg = string.Empty;

                if (!ProjectManager.Instance.TryToggleProjectStatus(projectID, ref errorMsg))
                    lblException.Text = errorMsg;
                else
                    Response.Redirect(
                        BuildURL((IsProposedProject)
                            ? &quot;ProjectDetails.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;nt=1&amp;PP=1&amp;Mode=View&quot;
                            : &quot;ProjectDetails.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID.ToString2() + &quot;&amp;Mode=View&amp;nt=1&quot;, null),
                        true);
            }
            catch (Exception err)
            {
                lblException.Text = err.ToString2();
            }
        }

        protected void btnMngUsers_Click(object sender, EventArgs e)
        {
            Response.Redirect(
                BuildURL(&quot;InviteUsersToProject.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID.ToString2(), null),
                true);
        }

        protected void btnBack_Click(object sender, EventArgs e)
        {
            Response.Redirect(
                BuildURL((IsProposedProject)
                    ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&amp;PP=1&quot;
                    : &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&quot;, null), true);
        }

        private void GetImageAttachments(int projId)
        {
            try
            {
                string xmlStr = new Album().GenerateDataXml(projId.ToInt32_2(), &quot;PROJECT&quot;);

                hdnImageUrls.Value = &quot;&quot;;
                hdnImageNames.Value = &quot;&quot;;

                if (String.IsNullOrEmpty(xmlStr))
                {
                    tblImages.Style.Value = &quot;Display:None&quot;;
                    return;
                }

                DataSet ds = new BrixDataSet();
                using (var sRd = new StringReader(xmlStr))
                    ds.ReadXml(sRd);

                if (ds.Tables[0].Rows.Count &gt; 0)
                {
                    string append = String.Empty;
                    imgProject.Src =
                        ResolveUrl(string.Format(&quot;{0}&amp;W={1}&amp;H={2}&amp;Thumbnail={3}&quot;, ds.Tables[0].Rows[0][&quot;ImageUrl&quot;],
                            imgProject.Width, imgProject.Height, Thumbnail));
                    imgProject.Attributes.Add(&quot;data&quot;, ResolveUrl(ds.Tables[0].Rows[0][&quot;ImageUrl&quot;].ToString()));
                    imgProject.Visible = true;
                    try
                    {
                        using (
                            Stream stream =
                                DocumentManager.Instance.GetStream(ds.Tables[0].Rows[0][&quot;StorageID&quot;].ToString2()))
                        {
                            var img = (Bitmap)(Image.FromStream(stream, true, false));
                            KeyValuePair&lt;int, int&gt; imgCntrlDim = UIHelper.RatioStretch(img.Width, img.Height, 250, 175);

                            imgProject.Height = imgCntrlDim.Value;
                            imgProject.Width = imgCntrlDim.Key;
                        }
                    }
                    catch
                    {
                        imgProject.Style.Add(&quot;display&quot;, &quot;none&quot;);
                        imgProject.Visible = false;
                        append = &quot; (File not found)&quot;;
                    }
                    tdImgName.InnerText = Server.UrlDecode(ds.Tables[0].Rows[0][&quot;FileName&quot;].ToString2().Split(&#39;.&#39;)[0]) +
                                          append;
                    foreach (DataRow dr in ds.Tables[0].Rows)
                    {
                        hdnImageUrls.Value += ResolveUrl(dr[&quot;ImageUrl&quot;].ToString2()) + &quot;|&quot;;
                        hdnImageNames.Value += Server.UrlDecode(dr[&quot;FileName&quot;].ToString2().Split(&#39;.&#39;)[0]) + &quot;|&quot;;
                    }
                    imgPrevious.Enabled = false;
                    imgPrevious.ImageUrl = &quot;../../Images/ImgPrevMD.gif&quot;;
                    if (ds.Tables[0].Rows.Count == 1)
                    {
                        imgNext.Enabled = false;
                        imgNext.ImageUrl = &quot;../../Images/ImgNextMD.gif&quot;;
                    }
                    else
                    {
                        imgNext.Enabled = true;
                        imgNext.ImageUrl = &quot;../../Images/ImgNextMN.gif&quot;;
                    }
                    hdnImageNo.Value = &quot;0&quot;;
                }
                tblImages.Style.Value = &quot;Display:Block&quot;;
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        protected void ImageScrollPrev(object sender, ImageClickEventArgs e)
        {
            if (!string.IsNullOrEmpty(hdnImageNo.Value))
            {
                SetImage(hdnImageNo.Value.ToInt32_2(), false);
            }
        }

        protected void ImageScrollNext(object sender, ImageClickEventArgs e)
        {
            if (!string.IsNullOrEmpty(hdnImageNo.Value))
            {
                SetImage(hdnImageNo.Value.ToInt32_2(), true);
            }
        }

        private void SetImage(int imageNo, bool isNext)
        {
            string xmlStr = new Album().GenerateDataXml(hdnProjectID.Value.ToInt32_2(), &quot;PROJECT&quot;);

            if (String.IsNullOrEmpty(xmlStr))
            {
                tblImages.Style.Value = &quot;Display:None&quot;;
                return;
            }

            DataSet ds = new BrixDataSet();
            using (var sRd = new StringReader(xmlStr))
                ds.ReadXml(sRd);

            if (ds.Tables[0].Rows.Count &gt; 0)
            {
                int nextImage = (isNext) ? (imageNo + 1) : (imageNo - 1);
                string append = String.Empty;
                imgProject.Src =
                    ResolveUrl(string.Format(&quot;{0}&amp;W={1}&amp;H={2}&amp;Thumbnail={3}&quot;, ds.Tables[0].Rows[nextImage][&quot;ImageUrl&quot;],
                        imgProject.Width, imgProject.Height, Thumbnail));
                imgProject.Attributes.Add(&quot;data&quot;, ResolveUrl(ds.Tables[0].Rows[nextImage][&quot;ImageUrl&quot;].ToString()));
                imgProject.Visible = true;

                try
                {
                    var img =
                        new Bitmap(
                            DocumentManager.Instance.GetStream(ds.Tables[0].Rows[nextImage][&quot;StorageID&quot;].ToString2()));
                    KeyValuePair&lt;int, int&gt; imgCntrlDim = UIHelper.RatioStretch(img.Width, img.Height, 250, 175);

                    imgProject.Height = imgCntrlDim.Value;
                    imgProject.Width = imgCntrlDim.Key;
                }
                catch
                {
                    imgProject.Visible = false;
                    append = &quot; (File not found)&quot;;
                }
                tdImgName.InnerText =
                    Server.UrlDecode(ds.Tables[0].Rows[nextImage][&quot;FileName&quot;].ToString2().Split(&#39;.&#39;)[0]) + append;

                if ((nextImage == (ds.Tables[0].Rows.Count - 1)))
                {
                    imgNext.Enabled = false;
                    imgNext.ImageUrl = &quot;../../Images/ImgNextMD.gif&quot;;
                }
                else
                {
                    imgNext.Enabled = true;
                    imgNext.ImageUrl = &quot;../../Images/ImgNextMN.gif&quot;;
                }

                hdnImageNo.Value = nextImage.ToString2();

                if (((ds.Tables[0].Rows.Count &gt; 1) &amp;&amp; (nextImage != 0)))
                {
                    imgPrevious.Enabled = true;
                    imgPrevious.ImageUrl = &quot;../../Images/ImgPrevMN.gif&quot;;
                }
                else
                {
                    imgPrevious.Enabled = false;
                    imgPrevious.ImageUrl = &quot;../../Images/ImgPrevMD.gif&quot;;
                }
            }
        }

        protected void btnMap_Click(object sender, EventArgs e)
        {
            ProjectManager.Instance.MapProjectInERP(txtProjNumber.Text, &quot;AMP3_Group&quot;, txtProjName.Text,
                txtCreatedDate.Text.ToDateTime_MWCulture().ToMWUtcDateTime(), txtStartDate.Text.ToDateTime_MWCulture().ToMWUtcDateTime(),
                txtEndDate.Text.ToDateTime_MWCulture().ToMWUtcDateTime(), 0);
        }

        protected override void OnInit(EventArgs e)
        {
            PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);
            PermissionsToCheck.Add(Constants.MODFEAT_VIEW);

            projectID = Request.QueryString[&quot;pid&quot;].ToInt32_2();
            if (!ProjectManager.Instance.CheckIfUserHasAccess(projectID))
            {
                UIHelper.RedirectURL(
                    MessageResourceManager.GetString(&quot;E_USRMGMT_NO_PERMISSIONS_TO_VIEW_PAGE&quot;,
                        Enumerations.MessageType.ErrorMessage),
                    ResolveUrl(Aurigo.AMP3.Common.Constants.URL_ENTERPRISE), null, Context);
            }

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnInit(model, args);

            // Visibility check is made in the Master Page
            featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];

            allowCopy = featurelist.Contains(ProjectConstants.MODFEAT_COPY);
            allowDelete = featurelist.Contains(ProjectConstants.MODFEAT_DELETE);
            allowManageUsers = featurelist.Contains(ProjectConstants.MODFEAT_MANAGEUSERS);
            allowManageUserProject = featurelist.Contains(ProjectConstants.MODFEAT_MANAGEUSERPROJECT);
            allowEdit = featurelist.Contains(ProjectConstants.MODFEAT_EDIT);
            allowDeactivate = featurelist.Contains(ProjectConstants.MODFEAT_ACTIVATE);
            base.OnInit(e);

            List&lt;MenuGroup&gt; menuGroups = new List&lt;MenuGroup&gt;();
            MenuGroup generalGroup = new MenuGroup(&quot;General&quot;);
            if (allowEdit)
                generalGroup.AddMenu(new LargeButton(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;Icn_Edit.png&quot;));
            if (allowDelete)
                generalGroup.AddMenu(new LargeButton(&quot;lnkDelete&quot;, &quot;Delete&quot;, &quot;Icn_Delete.png&quot;));
            List&lt;string&gt; CoreComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            if (!CoreComponents.Contains(&quot;HideCopyProject&quot;))
            {
                if (allowCopy)
                    generalGroup.AddMenu(new LargeButton(&quot;lnkCopy&quot;, &quot;Copy&quot;, &quot;IcnCopy3.png&quot;));
            }
            if (ProjectManager.Instance.IsERPConnecterAttached())
                generalGroup.AddMenu(new LargeButton(&quot;lnkMap&quot;, &quot;Map in AX&quot;, &quot;Icn_link.png&quot;));
            if (generalGroup.Menus.Count &gt; 0)
                menuGroups.Add(generalGroup);

            MenuGroup otherGroup = new MenuGroup(&quot;Others&quot;);
            otherGroup.AddMenu(new LargeButton(&quot;lnkBack&quot;, &quot;Back&quot;, &quot;Icn_Back.png&quot;));
            otherGroup.AddMenu(new TextIcon(&quot;lnkMngUsers&quot;, &quot;Manage Users&quot;, &quot;Icn_ManageUsers_16.png&quot;));
            if (!CoreComponents.Contains(&quot;HideChangeStatus&quot;))
                otherGroup.AddMenu(new TextIcon(&quot;lnkActivate&quot;, &quot;Change Status&quot;, &quot;Icn_Changestatus_16.png&quot;));
            menuGroups.Add(otherGroup);
            CreateToolBarMenu(menuGroups, null);
            _IsNew = false;
            _IsView = false;
            _IsEdit = false;
            _IsList = false;
            UpdateTree = true;
        }

        protected override void RaisePostBackEvent(IPostBackEventHandler sourceControl, string eventArgument)
        {
            base.RaisePostBackEvent(sourceControl, eventArgument);
        }

        public object[] ParentFormInstanceID
        {
            get { return new object[] { Request.QueryString[&quot;PID&quot;] }; }
        }

        public HtmlGenericControl XMLContainterDiv
        {
            get { return additionaldiv; }
            set { }
        }

        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        {
        }

        private string BuildURL(string url, List&lt;string&gt; escapeKeys)
        {
            if (escapeKeys != null)
                escapeKeys.AddRange(new List&lt;string&gt; { &quot;pid&quot;, &quot;nt&quot; });
            else
                escapeKeys = new List&lt;string&gt; { &quot;pid&quot;, &quot;nt&quot; };
            return UIHelper.BuildURL(url, escapeKeys, HttpContext.Current);
        }

        public void HandleInjectionAfterSave(object model, string parentFormInstanceId)
        {
        }

        public bool IsOldWorkflow
        {
            get { throw new NotImplementedException(); }
        }

        public new string FormInstanceId
        {
            get
            {
                int pid = String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                    ? -1
                    : int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out pid) ? pid : -1;
                return pid.ToString();
            }
        }

        public string FormName
        {
            get { return model.form.Name; }
        }

        public string FormKey
        {
            get { throw new NotImplementedException(); }
        }

        public string ClientValidationFunction
        {
            get { return string.Empty; }
        }

        public int ParentModuleId
        {
            get
            {
                string s = Request.QueryString[&quot;ParentID&quot;];
                return string.IsNullOrEmpty(s) ? 0 : s.ToInt32_2();
            }
        }

        public int PID
        {
            get
            {
                string s = Request.QueryString[&quot;PID&quot;];
                return string.IsNullOrEmpty(s) ? 0 : s.ToInt32_2();
            }
        }

        public string PostCancelRedirectUrl
        {
            get
            {
                return
                    BuildURL(
                        (IsProposedProject)
                            ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                            : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, new List&lt;string&gt;());
            }
        }

        public bool SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors,
            out string sRedirectTo)
        {
            throw new NotImplementedException();
        }

        public void CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            throw new NotImplementedException();
        }

        public string PostSaveRedirectUrl(string sSavedToken = &quot;&quot;)
        {
            throw new NotImplementedException();
        }

        bool IWorkflowEnabled.IsOldWorkflow
        {
            get { throw new NotImplementedException(); }
        }

        string IWorkflowEnabled.FormInstanceId
        {
            get
            {
                int pid = String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                    ? -1
                    : int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out pid) ? pid : -1;
                return pid.ToString();
            }
        }

        string IWorkflowEnabled.FormName
        {
            get
            {
                if (model == null || model.form == null)
                    return string.Empty;

                return model.form.Name;
            }
        }

        string IWorkflowEnabled.FormKey
        {
            get { throw new NotImplementedException(); }
        }

        string IWorkflowEnabled.ClientValidationFunction
        {
            get { return string.Empty; }
        }

        int IWorkflowEnabled.ParentModuleId
        {
            get
            {
                string s = Request.QueryString[&quot;ParentID&quot;];
                return string.IsNullOrEmpty(s) ? 0 : s.ToInt32_2();
            }
        }

        int IWorkflowEnabled.PID
        {
            get
            {
                string s = Request.QueryString[&quot;PID&quot;];
                return string.IsNullOrEmpty(s) ? 0 : s.ToInt32_2();
            }
        }

        string IWorkflowEnabled.PostCancelRedirectUrl
        {
            get
            {
                return
                    BuildURL(
                        (IsProposedProject)
                            ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                            : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, new List&lt;string&gt;());
            }
        }

        bool IWorkflowEnabled.SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors,
            out string sRedirectTo)
        {
            throw new NotImplementedException();
        }

        void IWorkflowEnabled.CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            throw new NotImplementedException();
        }

        string IWorkflowEnabled.PostSaveRedirectUrl(string sSavedToken)
        {
            throw new NotImplementedException();
        }


        public bool SkipDefaultXMLInjectionSave { get; set; }

        public string GetInitilize_ClientId_ForUseInJavascript()
        {
            JavascriptRenderFramework jrf = new JavascriptRenderFramework(&quot;CONST_ProjectView&quot;);

            jrf.Add_ClientId(
                 hdnImageUrls
                 , hdnImageNames
                 , imgProject
                 , tdImgName

                 , imgPrevious
                 , imgNext
                 , grdModulePlatforms
            );

            jrf.Add_ClientId(btnEdit, btnDelete);

            jrf.Add_Message(&quot;ConfirmProjectDelete&quot;, MessageResourceManager.GetString(&quot;W_PROJECT_CONFIRM_DELETE_PROJECT&quot;, Enumerations.MessageType.WarningMessage));

            string scriptString = jrf.Generate();

            return scriptString;
            //ClientScript.RegisterClientScriptBlock(GetType(), &quot;ProjectInitilizeScript&quot;, scriptString, true);
            //ClientScript.RegisterClientScriptInclude(&quot;projects&quot;, ResolveClientUrl(&quot;~/Scripts/login.js&quot;));
        }

        public string checkWorkFlowValidation(string formName, string formInstanceId)
        {

            string finalIdToDelete = &quot;&quot;;

            if (string.IsNullOrEmpty(formName))
                throw new InvalidDataException(&quot;Internal exception: Form name not specified&quot;);
            if (string.IsNullOrEmpty(formInstanceId)) return &quot;&quot;;

            DataTable mappingDetails = BrixWorkflowManager.Instance.GetWorkflowMappingDetails(formInstanceId, formName);

            if (mappingDetails.Rows.Count &lt; 1)
                return formInstanceId;

            foreach (DataRow dr in mappingDetails.Rows)
            {
                string id = (null != dr[&quot;FormInstanceID&quot;]) ? dr[&quot;FormInstanceID&quot;].ToString() : &quot;&quot;;
                string currentState = (null != dr[&quot;CurrentStatus&quot;]) ? dr[&quot;CurrentStatus&quot;].ToString() : &quot;&quot;;
                string guid = (null != dr[&quot;WorkflowInstanceGuid&quot;]) ? dr[&quot;WorkflowInstanceGuid&quot;].ToString() : &quot;&quot;;
                string canDelete = (null != dr[&quot;CanDeleteInState&quot;]) ? dr[&quot;CanDeleteInState&quot;].ToString() : &quot;&quot;;

                if (DeleteValidation.AllowDelete.ToString() == canDelete)
                    finalIdToDelete = id;
                else if (DeleteValidation.DonotDelete.ToString() == canDelete)
                    throw new Exception(&quot;The workflow status of one or more records does not permit delete operation.&quot;);
                else if (DeleteValidation.UseDeleteValidator.ToString() == canDelete)
                {
                    IStateMachineWFTemplate template = BrixWorkflowManager.Instance.GetWorkflow(guid);
                    if (null == template) continue;
                    IDeleteValidator dv = template.GetDeleteValidator();
                    string errors;
                    string validIds = dv.Validate(currentState, id, out errors);
                    if (!string.IsNullOrEmpty(validIds)) finalIdToDelete = id;
                }
                else
                    finalIdToDelete = id;
            }

            return finalIdToDelete;


        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[58,9,58,116,1],[59,9,59,35,1],[66,17,66,18,1],[66,19,66,81,1],[66,82,66,83,1],[74,17,74,18,0],[74,19,74,77,0],[74,78,74,79,0],[82,9,82,78,1],[86,17,86,18,0],[86,19,86,32,0],[86,33,86,34,0],[87,17,87,18,0],[87,19,87,33,0],[87,34,87,35,0],[91,9,91,10,1],[92,13,92,46,1],[94,13,94,76,1],[95,9,95,10,1],[97,9,97,10,1],[98,13,98,50,1],[99,13,99,14,1],[100,17,100,72,1],[101,17,101,77,1],[102,17,102,52,1],[103,17,103,67,1],[104,17,104,103,1],[105,13,105,14,1],[106,13,106,31,1],[107,13,107,38,1],[108,17,108,66,0],[109,13,109,31,1],[110,9,110,10,1],[113,9,113,10,1],[114,13,114,88,1],[117,13,118,68,1],[119,13,119,14,0],[120,17,121,50,0],[123,13,123,14,0],[124,9,124,10,1],[127,9,127,10,1],[128,13,128,65,1],[129,13,129,14,1],[130,17,130,80,1],[131,17,131,32,1],[131,33,131,65,0],[132,13,132,14,1],[133,13,133,109,1],[134,13,134,61,1],[135,17,135,69,1],[136,17,136,18,1],[137,21,137,84,1],[138,21,138,36,1],[138,37,138,69,0],[139,17,139,18,1],[140,13,140,64,1],[141,13,141,14,0],[142,17,142,78,0],[143,17,143,71,0],[144,21,144,52,0],[145,13,145,14,0],[146,13,146,67,1],[147,13,147,14,1],[148,17,148,84,1],[149,17,149,34,1],[149,35,149,69,0],[150,17,150,100,1],[151,13,151,14,1],[152,13,152,84,1],[153,13,153,62,1],[153,63,153,99,0],[154,13,154,112,1],[155,13,155,14,0],[156,17,156,53,0],[157,13,157,14,0],[158,13,158,62,1],[159,13,159,14,1],[160,17,160,88,1],[161,17,161,38,1],[161,39,161,75,0],[162,17,162,107,1],[163,13,163,14,1],[165,13,165,76,1],[167,13,167,50,1],[168,13,168,38,1],[169,17,169,78,0],[170,9,170,10,1],[180,9,180,10,1],[181,13,181,50,1],[182,13,182,38,1],[183,17,183,54,0],[186,13,186,14,1],[187,17,189,22,1],[190,17,190,18,0],[191,21,194,82,0],[195,17,195,18,0],[197,17,197,71,1],[198,17,198,33,1],[199,17,199,18,1],[200,21,200,50,1],[205,17,205,18,1],[207,17,207,75,1],[208,17,208,73,1],[209,17,209,53,1],[210,17,210,18,1],[211,21,211,41,1],[212,17,212,18,1],[214,17,214,53,1],[216,17,216,78,1],[217,21,218,78,0],[223,17,224,109,1],[225,17,225,65,1],[226,17,226,18,0],[227,21,227,64,0],[228,21,228,62,0],[229,17,229,18,0],[230,17,230,67,1],[231,17,231,18,0],[232,21,232,81,0],[233,21,233,86,0],[234,17,234,18,0],[235,17,235,62,1],[236,17,236,18,0],[237,21,237,65,0],[238,17,238,18,0],[240,17,240,33,1],[241,17,241,18,1],[242,21,242,91,1],[243,21,243,53,1],[244,21,244,49,1],[245,17,245,18,1],[246,17,246,81,1],[247,17,247,60,1],[248,17,248,33,1],[249,21,249,52,1],[251,17,251,35,1],[253,17,253,85,1],[255,17,255,113,1],[256,17,256,18,0],[257,21,261,82,0],[262,17,262,18,0],[264,17,264,58,1],[266,17,266,43,1],[267,17,267,18,0],[268,21,268,39,0],[269,21,269,46,0],[270,17,270,18,0],[272,17,273,49,1],[274,17,274,56,1],[275,17,275,66,1],[277,17,277,79,1],[279,17,279,157,1],[280,17,280,153,1],[281,17,281,80,1],[282,17,282,102,1],[284,17,284,97,1],[285,17,285,18,1],[286,21,286,124,1],[287,21,287,135,1],[288,17,288,18,1],[290,17,290,18,0],[291,21,291,64,0],[292,21,292,65,0],[293,21,293,65,0],[294,17,294,18,0],[298,17,298,80,1],[299,17,299,18,1],[300,21,300,59,1],[301,21,301,71,1],[302,21,302,28,1],[302,30,302,51,1],[302,52,302,54,1],[302,55,302,64,1],[303,21,303,22,1],[304,25,306,119,1],[307,21,307,22,1],[308,17,308,18,1],[310,17,310,18,0],[311,21,311,65,0],[312,17,312,18,0],[314,17,314,74,1],[316,17,316,70,1],[320,17,320,84,1],[322,17,322,34,1],[323,21,325,65,1],[327,21,327,44,0],[329,17,329,87,1],[331,17,331,82,1],[339,17,339,84,1],[340,17,340,45,1],[342,17,342,90,1],[343,17,347,61,1],[349,17,349,76,1],[350,17,350,18,1],[351,21,351,64,1],[352,21,352,62,1],[353,17,353,18,1],[364,17,364,77,1],[365,17,365,55,1],[366,17,366,18,1],[367,21,367,49,1],[368,21,368,57,1],[369,21,369,22,1],[370,25,370,32,1],[370,34,370,45,1],[370,46,370,48,1],[370,49,370,56,1],[371,25,371,26,1],[372,29,372,82,1],[373,29,373,30,0],[374,33,374,92,0],[375,33,375,39,0],[377,25,377,26,1],[378,21,378,22,1],[379,17,379,18,1],[381,17,381,99,1],[382,17,382,106,1],[383,17,383,61,1],[387,17,389,137,1],[390,17,390,98,1],[392,21,392,36,1],[394,17,394,18,0],[395,21,395,61,0],[396,21,396,63,0],[397,17,397,18,0],[398,17,398,110,1],[399,17,399,110,1],[400,17,400,105,1],[401,13,401,14,1],[403,13,403,34,0],[404,13,404,14,0],[405,17,405,52,0],[406,13,406,14,0],[407,9,407,10,1],[410,9,410,10,1],[411,13,411,63,1],[412,13,412,92,1],[413,13,413,67,1],[414,13,414,150,1],[415,13,415,44,1],[416,17,416,230,1],[417,13,417,108,1],[418,13,418,33,1],[419,9,419,10,1],[422,9,422,10,1],[423,13,424,71,1],[426,13,426,30,1],[427,13,427,14,1],[428,17,428,118,1],[430,17,430,75,1],[431,21,431,80,0],[433,21,433,75,1],[434,13,434,14,1],[435,9,435,10,1],[438,9,438,10,1],[439,13,440,45,1],[441,13,441,77,1],[442,13,442,14,1],[443,17,443,62,1],[444,17,444,43,1],[445,17,445,55,1],[446,13,446,14,1],[448,13,448,14,1],[449,17,449,50,1],[450,17,450,43,1],[451,13,451,14,1],[452,9,452,10,1],[455,9,455,10,1],[457,13,457,14,1],[458,17,458,46,1],[459,17,459,84,1],[461,17,461,67,1],[462,17,462,59,1],[463,17,463,61,1],[464,17,464,24,1],[464,26,464,41,1],[464,42,464,44,1],[464,45,464,79,1],[465,17,465,18,1],[466,21,466,28,1],[466,30,466,47,1],[466,48,466,50,1],[466,51,466,69,1],[467,21,467,22,1],[468,25,468,63,1],[469,25,469,79,1],[470,25,470,26,1],[471,29,471,69,1],[472,29,472,62,1],[473,29,473,59,1],[474,29,474,69,1],[475,25,475,26,1],[476,21,476,22,1],[477,17,477,18,1],[479,17,479,102,1],[480,17,480,60,1],[482,17,482,82,1],[484,17,484,24,1],[484,26,484,44,1],[484,45,484,47,1],[484,48,484,62,1],[485,17,485,18,1],[486,21,486,78,1],[487,21,487,58,1],[488,21,488,63,1],[489,21,489,50,1],[490,21,490,52,1],[492,21,492,28,1],[492,30,492,48,1],[492,49,492,51,1],[492,52,492,62,1],[493,21,493,22,1],[494,25,494,85,1],[495,25,495,26,1],[496,29,496,91,1],[498,29,498,56,1],[499,29,499,100,1],[500,34,500,43,1],[500,45,500,70,1],[500,72,500,75,1],[501,29,501,30,1],[502,33,502,111,1],[503,33,503,34,1],[504,37,504,102,1],[505,33,505,34,1],[506,29,506,30,1],[507,25,507,26,1],[508,21,508,22,1],[509,21,509,65,1],[510,21,510,22,1],[511,25,511,44,1],[512,30,512,43,1],[512,45,512,81,1],[512,83,512,90,1],[513,25,513,26,1],[514,29,514,95,1],[515,29,515,30,0],[516,33,516,46,0],[517,33,518,42,0],[519,29,519,30,0],[520,25,520,26,1],[521,25,521,36,1],[522,25,522,26,1],[523,29,523,50,1],[524,29,524,56,1],[525,34,525,45,1],[525,47,525,84,1],[525,86,525,91,1],[526,29,526,30,1],[527,33,527,53,1],[528,29,528,30,1],[529,29,529,93,1],[530,29,530,87,1],[531,33,531,54,1],[533,29,533,64,1],[534,25,534,26,1],[535,21,535,22,1],[536,17,536,18,1],[538,17,538,67,1],[539,17,539,47,1],[540,17,540,87,1],[543,17,543,106,1],[544,22,544,31,1],[544,33,544,69,1],[544,71,544,74,1],[545,21,545,80,1],[547,17,547,54,1],[548,17,548,18,0],[549,21,549,56,0],[550,21,550,93,0],[551,17,551,18,0],[552,17,552,59,1],[553,13,553,14,1],[554,13,554,33,0],[555,13,555,14,0],[556,17,556,48,0],[557,13,557,14,0],[558,9,558,10,1],[561,9,561,10,1],[562,13,562,30,1],[563,17,563,24,0],[565,13,565,20,1],[565,22,565,41,1],[565,42,565,44,1],[565,45,565,57,1],[566,13,566,14,1],[567,17,567,46,1],[568,13,568,14,1],[569,9,569,10,1],[577,9,577,10,0],[578,13,579,23,0],[580,9,580,10,0],[588,9,588,10,1],[589,13,589,58,1],[590,13,590,55,1],[592,13,592,106,1],[593,13,593,69,1],[594,13,594,14,0],[595,17,595,59,0],[596,17,596,55,0],[598,22,598,31,0],[598,33,598,64,0],[598,66,598,69,0],[599,21,599,139,0],[600,13,600,14,0],[602,13,602,75,1],[604,13,604,80,1],[605,13,607,23,1],[608,9,608,10,0],[613,13,613,14,1],[614,17,617,94,1],[618,13,618,14,1],[627,9,627,10,0],[629,13,629,14,0],[630,17,630,33,0],[631,17,631,18,0],[632,21,632,111,0],[633,21,633,22,0],[634,25,634,86,0],[635,25,635,112,0],[636,25,636,101,0],[637,25,637,82,0],[638,25,638,77,0],[639,25,640,56,0],[642,25,644,75,0],[646,25,646,56,0],[647,25,647,123,0],[648,25,648,26,0],[649,29,649,54,0],[651,25,651,26,0],[653,29,654,63,0],[655,21,655,22,0],[657,21,657,22,0],[658,25,658,50,0],[659,25,660,99,0],[661,25,664,99,0],[665,21,665,22,0],[666,17,666,18,0],[668,17,668,18,0],[669,21,670,67,0],[671,17,671,18,0],[672,13,672,14,0],[673,13,673,34,0],[674,13,674,14,0],[675,17,675,49,0],[676,13,676,14,0],[677,9,677,10,0],[680,9,680,10,0],[681,13,681,23,0],[683,13,683,96,0],[684,13,684,14,0],[685,17,685,97,0],[686,17,686,18,0],[687,21,687,36,0],[688,21,688,87,0],[689,21,689,119,0],[690,21,690,61,0],[691,21,691,37,0],[692,21,692,22,0],[693,25,694,102,0],[695,25,695,42,0],[697,17,697,18,0],[699,17,699,70,0],[700,17,700,28,0],[701,21,702,37,0],[703,13,703,14,0],[705,13,705,22,0],[707,9,707,10,0],[715,9,715,10,0],[717,13,717,14,0],[718,17,718,48,0],[720,17,720,94,0],[721,21,721,50,0],[723,21,727,31,0],[728,13,728,14,0],[729,13,729,34,0],[730,13,730,14,0],[731,17,731,53,0],[732,13,732,14,0],[733,9,733,10,0],[736,9,736,10,1],[737,13,739,23,1],[740,9,740,10,0],[743,9,743,10,1],[744,13,747,87,1],[748,9,748,10,0],[751,9,751,10,1],[753,13,753,14,1],[754,17,754,92,1],[756,17,756,41,1],[757,17,757,42,1],[759,17,759,50,1],[760,17,760,18,1],[761,21,761,60,1],[762,21,762,28,1],[765,17,765,48,0],[766,24,766,58,0],[767,21,767,37,0],[769,17,769,49,0],[770,17,770,18,0],[771,21,771,50,0],[772,21,774,78,0],[775,21,775,112,0],[776,21,776,47,0],[778,21,778,22,0],[780,29,781,114,0],[782,25,782,26,0],[783,29,783,87,0],[784,29,784,121,0],[786,29,786,67,0],[787,29,787,64,0],[788,25,788,26,0],[789,21,789,22,0],[790,21,790,26,0],[791,21,791,22,0],[792,25,792,65,0],[793,25,793,52,0],[794,25,794,54,0],[795,21,795,22,0],[796,21,797,50,0],[798,21,798,28,0],[798,30,798,40,0],[798,41,798,43,0],[798,44,798,61,0],[799,21,799,22,0],[800,25,800,92,0],[801,25,801,113,0],[802,21,802,22,0],[803,21,803,49,0],[804,21,804,73,0],[805,21,805,54,0],[806,21,806,22,0],[807,25,807,49,0],[808,25,808,73,0],[809,21,809,22,0],[811,21,811,22,0],[812,25,812,48,0],[813,25,813,73,0],[814,21,814,22,0],[815,21,815,44,0],[816,17,816,18,0],[817,17,817,57,0],[818,13,818,14,0],[819,13,819,33,0],[820,13,820,14,0],[821,17,821,48,0],[822,13,822,14,0],[823,9,823,10,1],[826,9,826,10,0],[827,13,827,57,0],[828,13,828,14,0],[829,17,829,63,0],[830,13,830,14,0],[831,9,831,10,0],[834,9,834,10,0],[835,13,835,57,0],[836,13,836,14,0],[837,17,837,62,0],[838,13,838,14,0],[839,9,839,10,0],[842,9,842,10,0],[843,13,843,100,0],[845,13,845,46,0],[846,13,846,14,0],[847,17,847,56,0],[848,17,848,24,0],[851,13,851,44,0],[852,20,852,54,0],[853,17,853,33,0],[855,13,855,45,0],[856,13,856,14,0],[857,17,857,74,0],[858,17,858,46,0],[859,17,861,74,0],[862,17,862,116,0],[863,17,863,43,0],[866,17,866,18,0],[867,21,869,120,0],[870,21,870,113,0],[872,21,872,59,0],[873,21,873,56,0],[874,17,874,18,0],[875,17,875,22,0],[876,17,876,18,0],[877,21,877,48,0],[878,21,878,50,0],[879,17,879,18,0],[880,17,881,115,0],[883,17,883,66,0],[884,17,884,18,0],[885,21,885,45,0],[886,21,886,69,0],[887,17,887,18,0],[889,17,889,18,0],[890,21,890,44,0],[891,21,891,69,0],[892,17,892,18,0],[894,17,894,58,0],[896,17,896,73,0],[897,17,897,18,0],[898,21,898,48,0],[899,21,899,73,0],[900,17,900,18,0],[902,17,902,18,0],[903,21,903,49,0],[904,21,904,73,0],[905,17,905,18,0],[906,13,906,14,0],[907,9,907,10,0],[910,9,910,10,0],[911,13,913,78,0],[914,9,914,10,0],[917,9,917,10,1],[918,13,918,66,1],[919,13,919,60,1],[921,13,921,64,1],[922,13,922,74,1],[923,13,923,14,0],[924,17,927,93,0],[928,13,928,14,0],[930,13,930,50,1],[931,13,931,38,1],[932,17,932,50,0],[935,13,935,85,1],[937,13,937,77,1],[938,13,938,81,1],[939,13,939,91,1],[940,13,940,103,1],[941,13,941,77,1],[942,13,942,87,1],[943,13,943,28,1],[945,13,945,64,1],[946,13,946,63,1],[947,13,947,27,1],[948,17,948,90,1],[949,13,949,29,1],[950,17,950,96,1],[951,13,951,109,1],[952,13,952,61,1],[953,13,953,14,1],[954,17,954,31,1],[955,21,955,94,1],[956,13,956,14,1],[957,13,957,66,1],[958,17,958,94,0],[959,13,959,46,1],[960,17,960,46,1],[962,13,962,60,1],[963,13,963,84,1],[964,13,964,103,1],[965,13,965,62,1],[966,17,966,109,1],[967,13,967,40,1],[968,13,968,49,1],[969,13,969,28,1],[970,13,970,29,1],[971,13,971,29,1],[972,13,972,29,1],[973,13,973,31,1],[974,9,974,10,1],[977,9,977,10,1],[978,13,978,67,1],[979,9,979,10,0],[983,17,983,18,1],[983,19,983,70,1],[983,71,983,72,1],[988,17,988,18,0],[988,19,988,40,0],[988,41,988,42,0],[989,17,989,18,0],[989,19,989,20,0],[993,9,993,10,0],[994,9,994,10,0],[997,9,997,10,1],[998,13,998,36,1],[999,17,999,71,0],[1001,17,1001,63,1],[1002,13,1002,76,1],[1003,9,1003,10,1],[1006,9,1006,10,0],[1007,9,1007,10,0],[1011,17,1011,18,0],[1011,19,1011,55,0],[1017,13,1017,14,0],[1018,17,1020,102,0],[1021,17,1021,39,0],[1022,13,1022,14,0],[1027,17,1027,18,0],[1027,19,1027,42,0],[1027,43,1027,44,0],[1032,17,1032,18,0],[1032,19,1032,55,0],[1037,17,1037,18,0],[1037,19,1037,39,0],[1037,40,1037,41,0],[1043,13,1043,14,0],[1044,17,1044,60,0],[1045,17,1045,68,0],[1046,13,1046,14,0],[1052,13,1052,14,0],[1053,17,1053,55,0],[1054,17,1054,68,0],[1055,13,1055,14,0],[1061,13,1061,14,0],[1062,17,1066,97,0],[1067,13,1067,14,0],[1072,9,1072,10,0],[1073,13,1073,49,0],[1077,9,1077,10,0],[1078,13,1078,49,0],[1082,9,1082,10,0],[1083,13,1083,49,0],[1088,17,1088,18,0],[1088,19,1088,55,0],[1094,13,1094,14,1],[1095,17,1097,102,1],[1098,17,1098,39,1],[1099,13,1099,14,1],[1105,13,1105,14,1],[1106,17,1106,57,1],[1107,21,1107,41,0],[1109,17,1109,40,1],[1110,13,1110,14,1],[1115,17,1115,18,0],[1115,19,1115,55,0],[1120,17,1120,18,0],[1120,19,1120,39,0],[1120,40,1120,41,0],[1126,13,1126,14,1],[1127,17,1127,60,1],[1128,17,1128,68,1],[1129,13,1129,14,1],[1135,13,1135,14,1],[1136,17,1136,55,1],[1137,17,1137,68,1],[1138,13,1138,14,1],[1144,13,1144,14,0],[1145,17,1149,97,0],[1150,13,1150,14,0],[1155,9,1155,10,0],[1156,13,1156,49,0],[1160,9,1160,10,0],[1161,13,1161,49,0],[1165,9,1165,10,0],[1166,13,1166,49,0],[1170,51,1170,55,0],[1170,56,1170,60,0],[1173,9,1173,10,1],[1174,13,1174,96,1],[1176,13,1185,15,1],[1187,13,1187,50,1],[1189,13,1189,164,1],[1191,13,1191,50,1],[1193,13,1193,33,1],[1196,9,1196,10,1],[1199,9,1199,10,0],[1201,13,1201,41,0],[1203,13,1203,48,0],[1204,17,1204,95,0],[1205,13,1205,54,0],[1205,55,1205,65,0],[1207,13,1207,121,0],[1209,13,1209,47,0],[1210,17,1210,39,0],[1212,13,1212,20,0],[1212,22,1212,32,0],[1212,33,1212,35,0],[1212,36,1212,55,0],[1213,13,1213,14,0],[1214,17,1214,99,0],[1215,17,1215,107,0],[1216,17,1216,113,0],[1217,17,1217,110,0],[1219,17,1219,74,0],[1220,21,1220,42,0],[1221,22,1221,79,0],[1222,21,1222,121,0],[1223,22,1223,86,0],[1224,17,1224,18,0],[1225,21,1225,103,0],[1226,21,1226,42,0],[1226,43,1226,52,0],[1227,21,1227,73,0],[1229,21,1229,81,0],[1230,21,1230,57,0],[1230,58,1230,79,0],[1231,17,1231,18,0],[1233,21,1233,42,0],[1234,13,1234,14,0],[1236,13,1236,36,0],[1239,9,1239,10,0]]);
    </script>
  </body>
</html>