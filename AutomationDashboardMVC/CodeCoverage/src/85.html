<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Contract Manager\Business Layer\ConcreateModels\ContractSummaryReportModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Collections.Generic;
using System.Data;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.Brix.Construction.ContractManager.BusinessLayer.BL;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using DataDynamics.ActiveReports;
using Aurigo.AMP3.Resources.TerminologyResources;

namespace Aurigo.AMP3.ContmgtUI
{
    [ReportModelContext(Name = &quot;CONTMGTCS&quot;, ModuleId = &quot;CONTMGT&quot;)]
    public class ContractSummaryReportModel : ReportModel
    {
        public DataSet ds;

        public override string ReportPath
        {
            get { return &quot;../Modules/CONTMGT/Reports/rptProjectSummary.rpx&quot;; }
        }

        public override string Header
        {
            get { return LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Summary&quot;; }
        }

        public override Report GetReportObject(Dictionary&lt;string, string&gt; dicFilter)
        {
            var repObj = new Report();
            ds = ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetContractSummary,
                                                         null, ParentID.ToInt32_2());

            //var rptctl = new Report.RptControl[37];
            var rptctl = new Report.RptControl[38];
            rptctl[0] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox2&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[1] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox3&quot;, null, FormatType.Amount,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[2] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox9&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[3] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox10&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[4] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox11&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[5] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox12&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[6] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox13&quot;, null, FormatType.Date,
                                                   ControlType.TextBox, StyleType.Detail);
            rptctl[7] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;txtContract&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[8] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;txtCoNo&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[9] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;txtCoDt&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[10] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[11] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox1&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[12] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox6&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[13] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox7&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[14] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox8&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[15] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;TextBox4&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[16] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;lblCnt&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[17] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label1&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[18] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label2&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Name :&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[19] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label3&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Code :&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[20] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label4&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[21] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label5&quot;, &quot;Original &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Amount :&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[22] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label6&quot;, &quot;Current &quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Amount :&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);
            rptctl[23] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;key&quot;, ControlType.Label, StyleType.HeaderDetails);
            rptctl[24] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label10&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[25] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label11&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);           
            rptctl[26] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label12&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Administrator :&quot;, FormatType.None, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[27] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label13&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[28] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label14&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[29] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label15&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[30] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label16&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[31] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label17&quot;, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[32] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label18&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;) + &quot; Closed (Final Estimate) Date :&quot;, FormatType.None, ControlType.Label,
                                                    StyleType.HeaderDetails);
            rptctl[33] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label21&quot;, ControlType.Label, StyleType.Caption);
            rptctl[34] = SetReportControlAttributes(&quot;PageHeader&quot;, &quot;Label20&quot;, ControlType.Label, StyleType.Caption);
            rptctl[35] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAttributeName&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[36] = SetReportControlAttributes(&quot;Detail&quot;, &quot;txtAttributeValue&quot;, ControlType.TextBox, StyleType.Detail);
            rptctl[37] = SetReportControlAttributes(&quot;ReportHeader&quot;, &quot;Label7&quot;, &quot;&quot; + LocalizationManager.GetString(&quot;Contract&quot;).ToUpper2() + &quot; SUMMARY REPORT&quot;, FormatType.None, ControlType.Label, StyleType.HeaderDetails);

            repObj.RptControls = rptctl;
            repObj.ReportPath = ReportPath;
            repObj.DataSource = ds.Tables[0];
            return repObj;
        }

        public override ActiveReport GetActiveReport(Report repObj, ActiveReport rpt)
        {
            rpt.FetchData += rpt_FetchData;
            rpt = base.GetActiveReport(repObj, rpt);
            return rpt;
        }

        private void rpt_FetchData(object sender, ActiveReport.FetchEventArgs eArgs)
        {
            if (string.IsNullOrEmpty(ds.Tables[0].Rows[0][&quot;AttributeName&quot;].ToString()))
            {
                ((ActiveReport) sender).Sections[&quot;PageHeader&quot;].Visible = false;
                ((ActiveReport) sender).Sections[&quot;Detail&quot;].Visible = false;
                //((TextBox) (((ActiveReport) sender).Sections[&quot;ReportHeader&quot;].Controls[&quot;TextBox4&quot;])).Text =
                //    &quot;No Attributes to Display&quot;;
            }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[20,17,20,18,0],[20,19,20,77,0],[20,78,20,79,0],[25,17,25,18,0],[25,19,25,81,0],[25,82,25,83,0],[29,9,29,10,0],[30,13,30,39,0],[31,13,32,86,0],[35,13,35,52,0],[36,13,37,91,0],[38,13,39,91,0],[40,13,41,91,0],[42,13,43,91,0],[44,13,45,91,0],[46,13,47,91,0],[48,13,49,91,0],[50,13,50,122,0],[51,13,51,118,0],[52,13,52,118,0],[53,13,53,119,0],[54,13,54,120,0],[55,13,55,120,0],[56,13,56,120,0],[57,13,57,120,0],[58,13,58,120,0],[59,13,59,123,0],[60,13,60,123,0],[61,13,61,200,0],[62,13,62,200,0],[63,13,63,123,0],[64,13,64,211,0],[65,13,65,210,0],[66,13,66,120,0],[67,13,68,78,0],[69,13,70,78,0],[71,13,72,78,0],[73,13,74,78,0],[75,13,76,78,0],[77,13,78,78,0],[79,13,80,78,0],[81,13,82,78,0],[83,13,84,78,0],[85,13,85,116,0],[86,13,86,116,0],[87,13,87,122,0],[88,13,88,123,0],[89,13,89,219,0],[91,13,91,41,0],[92,13,92,44,0],[93,13,93,46,0],[94,13,94,27,0],[95,9,95,10,0],[98,9,98,10,0],[99,13,99,44,0],[100,13,100,53,0],[101,13,101,24,0],[102,9,102,10,0],[105,9,105,10,0],[106,13,106,88,0],[107,13,107,14,0],[108,17,108,80,0],[109,17,109,76,0],[112,13,112,14,0],[113,9,113,10,0]]);
    </script>
  </body>
</html>