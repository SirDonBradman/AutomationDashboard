<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\XmlForm Framework\Renderers\RendererDataDynamics.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.IO;
using System.Web;
using System.Xml;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using DataDynamics.ActiveReports.Web;
using F = Aurigo.Brix.Platform.BusinessLayer.XMLForm;
using D = DataDynamics.ActiveReports;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

#pragma warning disable 0618

namespace Aurigo.AMP3.Common
{
    public class DataDynamicsRenderer : F.Renderer
    {
        private readonly Dictionary&lt;StyleType, string&gt; styleType = new Dictionary&lt;StyleType, string&gt;
        {
            {
                StyleType.Caption,
                &quot;font-weight: bold; font-size: 8pt;&quot;
            },
            { StyleType.Detail, &quot;font-size: 8pt;&quot; },
            {
                StyleType.Header,
                &quot;font-weight: bold; font-size: 10pt;&quot;
            },
            {
                StyleType.HeaderDetails,
                &quot; font-weight: bold; font-size: 8pt;&quot;
            },
            { StyleType.None, &quot;font-size: 8pt;&quot; }
        };

        //private PdfExport pdf;
        private D.ActiveReport report;

        #region CELL RENDERER FUNCTIONS

        private string GetReportFormat(string format)
        {
            format = string.IsNullOrEmpty(format) ? &quot;&quot; : format;
            switch (format.ToUpper())
            {
                case &quot;DATE&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_DATE;
                case &quot;DATETIME&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_DATETIME;
                case &quot;UNITPRICE&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE;
                case &quot;AMOUNT&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
                case &quot;QUANTITY&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                case &quot;PERCENTAGE&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE;
                case &quot;TIME&quot;:
                    return AMP3ApplicationSettings.Instance.FORMAT_TIME;
                case &quot;CURRENCY&quot;:
                    return LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_AMOUNT_FULL);
                default:
                    return &quot;&quot;;
            }
        }

        private D.TextBox CreateTextBoxforReport(string name, string text, string dataField, PointF location, SizeF size,
            StyleType style, string format)
        {
            var txtNew = new D.TextBox();
            //txtNew.Name = name.Replace(&#39; &#39;, &#39;_&#39;); 
            txtNew.Text = text;
            txtNew.DataField = dataField;
            txtNew.Location = location;
            txtNew.Size = size;
            txtNew.Style = styleType[style];
            txtNew.CanGrow = true;
            txtNew.CanShrink = true;
            txtNew.WordWrap = true;
            txtNew.OutputFormat = GetReportFormat(format);
            return txtNew;
        }

        private D.CheckBox CreateCheckboxforReport(string name, string text, string dataField, PointF location,
            SizeF size,
            StyleType style)
        {
            var chkbxNew = new D.CheckBox();
            //chkbxNew.Name = name.Replace(&#39; &#39;, &#39;_&#39;);
            chkbxNew.Text = text;
            chkbxNew.DataField = dataField;
            chkbxNew.Location = location;
            chkbxNew.Size = size;
            chkbxNew.Style = styleType[style];
            chkbxNew.WordWrap = true;

            return chkbxNew;
        }

        private D.TextBox CreateTextBoxforReport(string name, string text, string dataField, PointF location, SizeF size,
            StyleType style)
        {
            return CreateTextBoxforReport(name, text, dataField, location, size, style, &quot;&quot;);
        }

        private object RenderReportControl(F.xControl ctrl, object parent, object valueObj)
        {
            D.TextBox txt2 = CreateTextBoxforReport(ctrl.Name + &quot;Value&quot;, &quot;&quot;, ctrl.Name,
                ctrl.Point, ctrl.Size, StyleType.Detail, ctrl.Format);

            txt2.Value = (valueObj != null) ? valueObj.ToString() : ctrl.EvaluateControlValue();

            if (!string.IsNullOrEmpty(ctrl.Format))
            {
                string format = &quot;{0:&quot; + (string.IsNullOrEmpty(txt2.OutputFormat) ? ctrl.Format : txt2.OutputFormat) +
                                &quot;}&quot;;
                if (ctrl.Type == F.ControlType.Date &amp;&amp; txt2.Value != null &amp;&amp;
                    !string.IsNullOrWhiteSpace(txt2.Value.ToString()))
                    try
                    {
                        txt2.Value = string.Format(format, txt2.Value.ToDateTime_MWCulture());
                    }
                    catch
                    {
                        txt2.Value = &quot;&quot;;
                    }
                if (ctrl.Type == F.ControlType.Numeric &amp;&amp; txt2.Value != null &amp;&amp;
                    !string.IsNullOrWhiteSpace(txt2.Value.ToString()))
                    try
                    {
                        txt2.Value = string.Format(format, txt2.Value.ToDecimal2());
                    }
                    catch
                    {
                        txt2.Value = &quot;&quot;;
                    }
                //else
                //    txt2.Value = MaskValue(format, txt2.Value.ToString());
            }
            return (txt2);
        }


        //public string MaskValue(string mask, string value)
        //{
        //    try
        //    {
        //        var builder = new System.Text.StringBuilder();
        //        var maskIndex = 0;
        //        var valueIndex = 0;
        //        while (maskIndex &lt; mask.Length &amp;&amp; valueIndex &lt; value.Length)
        //        {
        //            if (mask[maskIndex] == &#39;-&#39;)
        //            {
        //                builder.Append(&#39;-&#39;);
        //                maskIndex++;
        //            }
        //            else
        //            {
        //                builder.Append(value[valueIndex]);
        //                maskIndex++;
        //                valueIndex++;
        //            }
        //        }

        //        // Add in the remainder of the value
        //        if (valueIndex + 1 &lt; value.Length)
        //        {
        //            builder.Append(value.Substring(valueIndex));
        //        }

        //        return builder.ToString();
        //    }
        //    catch
        //    {
        //        return value;
        //    }
        //}


        private object RenderCheckBoxReportControl(F.xControl ctrl, object parent, object valueObj)
        {
            var report = parent as D.ActiveReport;
            bool val = false;
            if (valueObj != null)
            {
                try
                {
                    // we cant be sure there is the correct data value so mkte sure that you dont crash if the string
                    // value is not true or false.
                    val = Convert.ToBoolean(valueObj);
                }
                catch
                {
                }
            }
            //This is a Hack!!! in HtmlViewer, CheckBox controls won&#39;t display. Creating TextBox instead of CheckBox
            if (HttpContext.Current != null &amp;&amp; HttpContext.Current.Items != null &amp;&amp;
                HttpContext.Current.Items[&quot;ViewerType&quot;] != null &amp;&amp; HttpContext.Current.Items[&quot;ViewerType&quot;] is ViewerType)
            {
                ViewerType viewerType =
                    (ViewerType)(HttpContext.Current.Items[&quot;ViewerType&quot;] ?? ViewerType.AcrobatReader);
                if (viewerType == ViewerType.HtmlViewer)
                    return RenderReportControl(ctrl, parent, val ? &quot;Yes&quot; : &quot;No&quot;);
            }
            D.CheckBox chk = CreateCheckboxforReport(ctrl.Name + &quot;Value&quot;, ctrl.Value, ctrl.Name, ctrl.Point, ctrl.Size,
                StyleType.Detail);
            chk.Checked = val;
            return (chk);
        }

        private object RenderLink(F.xControl ctrl, object parent, object valueObj)
        {
            //TODO: It should render hyperlink in PDF.
            D.Label lbl = new D.Label();
            return lbl;
        }

        private object RenderPickerTrigger(F.xControl ctrl, object parent, object valueObj)
        {
            D.Label lbl = new D.Label();
            return lbl;
        }

        private void SetCellRenderers()
        {
            F.xControl.RenderControl d = RenderReportControl;

            CellRenderers[(int)F.ControlType.Hidden] = d;
            CellRenderers[(int)F.ControlType.InsertHide] = d;
            CellRenderers[(int)F.ControlType.Display] = d;
            CellRenderers[(int)F.ControlType.TextBox] = d;
            CellRenderers[(int)F.ControlType.TextArea] = d;
            CellRenderers[(int)F.ControlType.Date] = d;
            CellRenderers[(int)F.ControlType.Numeric] = d;
            CellRenderers[(int)F.ControlType.Integer] = d;
            CellRenderers[(int)F.ControlType.TimeInput] = d;
            CellRenderers[(int)F.ControlType.DropDownList] = d;
            CellRenderers[(int)F.ControlType.DropDownTreeDataControl] = d;
            CellRenderers[(int)F.ControlType.Listbox] = d;
            CellRenderers[(int)F.ControlType.CheckBox] = new F.xControl.RenderControl(RenderCheckBoxReportControl);
            CellRenderers[(int)F.ControlType.RadioButtonList] = d;
            CellRenderers[(int)F.ControlType.Column] = d;
            CellRenderers[(int)F.ControlType.Formula] = d;
            CellRenderers[(int)F.ControlType.Formatted] = d;
            CellRenderers[(int)F.ControlType.MultiPicker] = d;
            CellRenderers[(int)F.ControlType.Link] = new F.xControl.RenderControl(RenderLink);
            CellRenderers[(int)F.ControlType.Password] = d;
            CellRenderers[(int)F.ControlType.CheckBoxList] = d;
            CellRenderers[(int)F.ControlType.AutoIncrement] = d;
            CellRenderers[(int)F.ControlType.PickerTrigger] = new F.xControl.RenderControl(RenderPickerTrigger);
            CellRenderers[(int)F.ControlType.Button] = new F.xControl.RenderControl(RenderPickerTrigger);
            CellRenderers[(int)F.ControlType.PlaceHolder] = new F.xControl.RenderControl(RenderPickerTrigger);
        }

        #endregion

        #region CONTAINER RENDERER FUNCTIONS

        private const float WidthInPixels = 800.0f;
        private const float WidthInInches = 8.0f;

        private void ProcessHtmlStyles(D.TextBox tb, string styles)
        {
            if (!String.IsNullOrEmpty(styles))
            {
                string[] parts = styles.Split(&#39;;&#39;);
                string style = tb.Style;

                foreach (string part in parts)
                {
                    string tag;
                    string[] subparts = part.Split(&#39;:&#39;);
                    if (subparts.Length == 0)
                        tag = part;
                    else
                        tag = subparts[0];

                    if (tag.StartsWith(&quot;font&quot;))
                    {
                    }
                    else if (tag == &quot;background&quot;)
                    {
                        tag = &quot;background-color&quot;;
                        style += tag;
                        if (subparts.Length == 2)
                            style += &quot;:&quot; + subparts[1];
                    }
                    else if (tag == &quot;text-align&quot;) // we can just pass text align through in styles
                        style += part;

                    style += &quot;;&quot;;
                }

                // now overwrite the style feld
                tb.Style = style;
            }
        }

        private void RenderCaptionforReport(F.Form f, D.ActiveReport report, string caption, string dataField,
            float xCoord,
            float yCoord, int sectionIndex)
        {
            var txtHeader = new D.TextBox();
            txtHeader.Location = new PointF(xCoord, yCoord);
            txtHeader.Size = new SizeF(7.5f, 0.2f);
            txtHeader.Style = styleType[StyleType.Caption];
            txtHeader.WordWrap = true;
            txtHeader.Text = caption;
            txtHeader.CanGrow = true;
            txtHeader.DataField = dataField;
            txtHeader.Border.BottomStyle = D.BorderLineStyle.Solid;
            report.Sections[sectionIndex].Controls.Add(txtHeader);

            // lets try to do some magic from the html styling that is set in the xml form.  we want
            // as much fidelity as possible when rendering reports.
            ProcessHtmlStyles(txtHeader, f.CaptionStyle);
        }

        private bool IsVisible(F.xControl control)
        {
            if (string.IsNullOrEmpty(control.VisibleIf))
                return true;

            string info = control.VisibleIf;
            F.xControl controller;
            if (info.Contains(&quot;;&quot;))
            {
                controller = control.form.GetControl(info.Split(&quot;;&quot;.ToCharArray())[0].Trim(&quot;$&quot;.ToCharArray()));
            }
            else
                controller = control.form.GetControl(info.Split(&quot;=&quot;.ToCharArray())[0].Trim(&quot;$&quot;.ToCharArray()));
            string value = string.Empty;
            if (!string.IsNullOrEmpty(controller.DBType)) // get the control value stored into the db
                value = control.form.Table.Rows[0].Field&lt;object&gt;(controller.Name).ToString2();
            else
                value = controller.EvaluateControlValue();
            if (!string.IsNullOrEmpty(value) &amp;&amp; value.Equals(info.Split(&quot;=&quot;.ToCharArray())[1].Trim(&quot;$&quot;.ToCharArray())))
                return true;
            return false;
        }

        /// &lt;summary&gt;
        /// ConvertWidthToInches();
        ///     This routine attempts to keep the WYSIWYG functionality of XML forms and reporting.  Here we assume that XML forms are
        ///     specified in pixels.  what this routine does is assume that a report is 8 incues wide and that a form is geared to be
        ///     800 pixels wide.  Using those two simplistic assumptions it converts pixels to inches.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ctrl&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private float ConvertWidthToInches(F.ControlContainer ctrl)
        {
            return (ConvertWidthToInches(ctrl, 1.0f));
        }

        private float ConvertWidthToInches(F.ControlContainer ctrl, float defWidth)
        {
            if (String.IsNullOrEmpty(ctrl.Width))
                return (defWidth);
            else
            {
                float Pixels =
                    Convert.ToInt32(ctrl.Width.Contains(&quot;px&quot;)
                        ? ctrl.Width.Substring(0, ctrl.Width.Length - 2)
                        : ctrl.Width);

                float tmp = (Pixels * WidthInInches) / WidthInPixels;
                return (tmp);
            }
        }

        private void RenderSection(F.ControlContainer cont, object parent)
        {
            var section = cont as F.Section;
            var report = parent as D.ActiveReport;
            object valueObj;
            float LineHeight = 0.2f;
            float sectionX = LocX;
            float sectionY = LocY;

            if (!string.IsNullOrEmpty(section.Caption))
            {
                RenderCaptionforReport(cont.form, report, section.ParseDynamicString(section.Caption), &quot;&quot;, LocX, LocY, 2);
                LocY += 0.2f;
                sectionY = LocY;
            }

            foreach (F.xControl reportControl in section.Controls)
            {
                bool bCaptionRendered;
                D.TextBox txt1;

                if (reportControl.Type != F.ControlType.Hidden &amp;&amp; IsVisible(reportControl))
                {
                    // dont render the control caption if there is none.  Remember if caption is not specified
                    // then it should render the control.Name, so you MUST have the if statement like this
                    // instead of using IsNullOrEmpty()
                    if (reportControl.Caption == null &amp;&amp; reportControl.Name != null)
                        bCaptionRendered = false;
                    else if (reportControl.Caption == null &amp;&amp; reportControl.Name == null)
                        bCaptionRendered = false;
                    else if (reportControl.Caption != null &amp;&amp; reportControl.Caption == &quot;&quot;)
                        bCaptionRendered = false;
                    else
                        bCaptionRendered = true;

                    if (bCaptionRendered)
                    {
                        txt1 = CreateTextBoxforReport(reportControl.Name,
                            reportControl.Caption == null
                                ? reportControl.Name
                                : reportControl.ParseDynamicString(reportControl.Caption), &quot;&quot;,
                            new PointF(LocX, LocY),
                            new SizeF(ConvertWidthToInches(reportControl, 2f), 0.2f),
                            StyleType.Caption);

                        report.Sections[2].Controls.Add(txt1);
                    }

                    if (reportControl.Controls.Count == 0)
                    {
                        // for single line controls if there is no caption then dont render them over by 2 inches.
                        if (bCaptionRendered)
                            LocX += 2f;

                        valueObj = String.IsNullOrEmpty(reportControl.DBType)
                            ? reportControl.EvaluateControlValue()
                            : reportControl.form.Table.Rows[0].Field&lt;object&gt;(reportControl.Name);

                        if (reportControl.Type == F.ControlType.DropDownList ||
                            reportControl.Type == F.ControlType.RadioButtonList)
                        {
                            List&lt;F.FormListItem&gt; listItems = reportControl.GetFormList();
                            foreach (F.FormListItem fli in listItems)
                            {
                                if (fli.value == valueObj.ToString2())
                                    valueObj = fli.display;
                            }
                        }

                        if (reportControl.Type == F.ControlType.Display)
                            //valueObj = reportControl.ParseDynamicString(reportControl.Value);
                            valueObj = reportControl.EvaluateControlValue();

                        reportControl.Size = new SizeF(ConvertWidthToInches(reportControl, 5.5f), 0.2f);
                        reportControl.Point = new PointF(LocX, LocY);
                        object x = reportControl.RenderSingleFormControl(valueObj, F.RenderFormat.RenderDataDynamics);
                        LineHeight = (x as D.ARControl).Height;

                        report.Sections[2].Controls.Add(x as D.ARControl);
                    }
                    else
                    {
                        if (!string.IsNullOrEmpty(reportControl.Caption) &amp;&amp; reportControl.Caption != &quot;&quot;)
                            LocY += LineHeight;
                        // add titles for each control
                        foreach (F.xControl title in reportControl.Controls)
                        {
                            txt1 = CreateTextBoxforReport(title.Name,
                                title.Caption == null ? title.Name : title.ParseDynamicString(title.Caption),
                                &quot;&quot;,
                                new PointF(LocX, LocY),
                                new SizeF(ConvertWidthToInches(title, 2f), 0.2f),
                                StyleType.Caption);
                            report.Sections[2].Controls.Add(txt1);

                            LineHeight = txt1.Height;
                            LocX += ConvertWidthToInches(title);
                        }

                        LocX = sectionX;
                        LocY += LineHeight;

                        foreach (F.xControl childctrl in reportControl.Controls)
                        {
                            valueObj = String.IsNullOrEmpty(childctrl.DBType)
                                ? childctrl.EvaluateControlValue()
                                : childctrl.form.Table.Rows[0].Field&lt;object&gt;(childctrl.Name);

                            if (childctrl.Type == F.ControlType.DropDownList ||
                                childctrl.Type == F.ControlType.RadioButtonList)
                            {
                                List&lt;F.FormListItem&gt; listItems = childctrl.GetFormList();
                                foreach (F.FormListItem fli in listItems)
                                {
                                    if (fli.value == valueObj.ToString2())
                                        valueObj = fli.display;
                                }
                            }

                            if (childctrl.Type == F.ControlType.Display)
                                valueObj = childctrl.EvaluateControlValue();


                            childctrl.Point = new PointF(LocX, LocY);
                            childctrl.Size = new SizeF(ConvertWidthToInches(childctrl, 5.5f), 0.3f);
                            object x = childctrl.RenderSingleFormControl(valueObj, F.RenderFormat.RenderDataDynamics);

                            report.Sections[2].Controls.Add(x as D.ARControl);
                            LineHeight = (x as D.ARControl).Height;
                            LocX += ConvertWidthToInches(childctrl);
                        }
                    }
                    //if (!(section.ParentObject is Section) ||
                    //    (section.ParentObject is Section &amp;&amp; (section.ParentObject as Section).Orientation == Orientation.Vertical))
                    LocX = sectionX;
                    LocY += LineHeight;
                }
            }

            if (section.Containers.FindAll(cc =&gt; cc.GetType() == typeof(F.Section)).Count &gt; 0)
            {
                int numberOfHorizontalSections = 0;
                if (section.Orientation == F.Orientation.Horizontal)
                {
                    numberOfHorizontalSections =
                        section.Containers.FindAll(cc =&gt; cc.GetType() == typeof(F.Section)).Count;
                }

                int currentSectionIndex = 0;
                float reportWidth = 8;
                float eachSectionWidth = numberOfHorizontalSections == 0
                    ? reportWidth
                    : reportWidth / numberOfHorizontalSections;
                float MaxofInnerSectionsY = 0;
                foreach (F.ControlContainer c in section.Containers)
                {
                    if (c.GetType() == typeof(F.Section))
                    {
                        LocX = currentSectionIndex * eachSectionWidth;
                        if (numberOfHorizontalSections &gt; 0)
                            LocY = sectionY;
                        RenderSection(c as F.Section, report);
                        MaxofInnerSectionsY = Math.Max(MaxofInnerSectionsY, LocY);
                        currentSectionIndex++;
                    }
                }
                LocY = MaxofInnerSectionsY;
            }
            else if (section.Containers.FindAll(cc =&gt; cc.GetType() != typeof(F.Section)).Count &gt; 0)
            {
                foreach (F.ControlContainer c in section.Containers)
                {
                    if (c.GetType() != typeof(F.Section))
                    {
                        c.Render(report, F.RenderFormat.RenderDataDynamics);
                    }
                }
            }
            else
            {
                LocX = 0f;
            }
        }

        private void RenderText(F.ControlContainer cont, object parent)
        {
            var Text = cont as F.Text;
            var report = parent as D.ActiveReport;

            var rtb = new D.RichTextBox();

            rtb.Location = new PointF(LocX, LocY);
            rtb.Size = new SizeF(ConvertWidthToInches(cont, 7.5f), 0.2f);
            rtb.CanGrow = true;
            rtb.Font = new Font(FontFamily.GenericSerif, 0.2f, FontStyle.Regular);

            if (Text.AllElements != null)
                foreach (XmlElement xe in Text.AllElements)
                {
                    try
                    {
                        rtb.Html += xe.InnerXml;
                    }
                    catch
                    {
                    }
                }

            // rtb.Html += Text.Markup;

            report.Sections[2].Controls.Add(rtb);

            LocY += rtb.Height;
        }

        private void RenderReportControlforTable(D.ActiveReport report, F.xControl reportControl, PointF location,
            SizeF size, int sectionIndex)
        {
            object valueObj;

            D.TextBox txt = CreateTextBoxforReport(reportControl.Name,
                string.IsNullOrEmpty(reportControl.Caption)
                    ? reportControl.Name
                    : reportControl.ParseDynamicString(reportControl.Caption),
                &quot;&quot;, location, size, StyleType.Caption);
            report.Sections[sectionIndex].Controls.Add(txt);

            // render the text for datadynamics
            valueObj = string.IsNullOrEmpty(reportControl.DBType) ? reportControl.EvaluateControlValue() : null;

            if (reportControl.Type == F.ControlType.Display)
                valueObj = reportControl.EvaluateControlValue();
            // reportControl.ParseDynamicString(reportControl.Value);

            reportControl.Size = size;
            reportControl.Point = location;

            object x = reportControl.RenderSingleFormControl(valueObj, F.RenderFormat.RenderDataDynamics);

            // you cant add null objects to the report.  So if for some reason we can&#39;t render the control then just fail
            if (x != null)
                report.Sections[&quot;Detail&quot;].Controls.Add(x as D.ARControl);
        }

        //private void RenderReportFooterforTable(ReportFooter footer, xControl reportControl, PointF location,
        //                                         SizeF size, int sectionIndex)
        //{
        //    object valueObj;

        //    TextBox txt = CreateTextBoxforReport(reportControl.Name,
        //                                         string.IsNullOrEmpty(reportControl.Caption)
        //                                             ? reportControl.Name
        //                                             : reportControl.Caption,
        //                                         &quot;&quot;, location, size, StyleType.Caption);


        //    txt.DataField = reportControl.Name;
        //    txt.SummaryRunning = SummaryRunning.None;
        //    txt.SummaryType = SummaryType.GrandTotal;

        //    switch (reportControl.Footer)
        //    {
        //        case Footer.Sum:
        //            txt.SummaryFunc = SummaryFunc.Sum;
        //            break;
        //        case Footer.Avg:
        //            txt.SummaryFunc = SummaryFunc.Avg;
        //            break;
        //        case Footer.Min:
        //            txt.SummaryFunc = SummaryFunc.Min;
        //            break;
        //        case Footer.Max:
        //            txt.SummaryFunc = SummaryFunc.Max;
        //            break;
        //        case Footer.Count:
        //            txt.SummaryFunc = SummaryFunc.Count;
        //            break;
        //    }


        //    footer.Controls.Add(txt);

        //    // render the text for datadynamics
        //    // valueObj = string.IsNullOrEmpty(reportControl.DBType) ? reportControl.EvaluateControlValue() : null;

        //    reportControl.Size = size;
        //    reportControl.Point = location;

        //    // object x = reportControl.RenderSingleFormControl(valueObj, RenderFormat.RenderDataDynamics);

        //    // you cant add null objects to the report.  So if for some reason we can&#39;t render the control then just fail
        //    //if (x != null)
        //    //    footer.Controls.Add(x as ARControl);
        //}

        private D.SubReport CreateSubReport(string name, PointF location)
        {
            var subRport = new D.SubReport();
            //subRport.Name = name.Replace(&#39; &#39;, &#39;_&#39;);
            subRport.Size = new SizeF(7.5f, 0.2f);
            subRport.Location = location;
            subRport.Report = new D.ActiveReport();
            return subRport;
        }

        private D.SubReport CreateSubReport(string name)
        {
            return CreateSubReport(name, new PointF(LocX, LocY));
        }

        private void RenderDynamicGrid(F.ControlContainer cont, object parent)
        {
            var dynamicGrid = cont as F.DynamicGrid;
            var report = parent as D.ActiveReport;
            // get all the columns which have Footer attribute set
            // Put them in the dictionary &lt;string. double&gt;
            // in loop update their sum


            if (!string.IsNullOrEmpty(dynamicGrid.Caption))
            {
                RenderCaptionforReport(cont.form, report, dynamicGrid.ParseDynamicString(dynamicGrid.Caption), &quot;&quot;, LocX,
                    LocY, 2);
                LocY += 0.2f;
            }

            D.SubReport subRport = CreateSubReport(dynamicGrid.Name);
            subRport.Report.LoadLayout(HttpContext.Current.Server.MapPath(&quot;~/common/GenericSubReport.rpx&quot;));
            float subReportLocX = 0, subReportLocY = 0;

            foreach (F.xControl reportControl in dynamicGrid.Controls)
            {
                float reportWidth = ConvertWidthToInches(reportControl, 1.5f);
                if (reportControl.Type != F.ControlType.Hidden)
                {
                    RenderReportControlforTable(subRport.Report, reportControl,
                        new PointF(subReportLocX, subReportLocY), new SizeF(reportWidth, 0.2f),
                        0);
                    subReportLocX += (float)Convert.ToDecimal(reportWidth);
                }
            }
            //ReportFooter footer = new ReportFooter();

            //foreach (xControl reportControl in dynamicGrid.Controls)
            //{

            //    float reportWidth = ConvertWidthToInches(reportControl, 1.5f);
            //    if (reportControl.Footer != Footer.None)
            //    {
            //        RenderReportFooterforTable(footer, reportControl,
            //                                    new PointF(subReportLocX, subReportLocY), new SizeF(reportWidth, 0.2f),
            //                                    0);
            //        subReportLocX += (float)Convert.ToDecimal(reportWidth);
            //    }
            //}

            //subRport.Report.Sections.Add(footer);

            subRport.Report.DataSource = dynamicGrid.Table;
            report.Sections[2].Controls.Add(subRport);
            LocY += report.Sections[2].Height + 0.2f;
        }

        private void RenderStage(F.ControlContainer cont, object parent)
        {
            foreach (F.ControlContainer c in cont.Containers)
            {
                c.Render(parent, F.RenderFormat.RenderHtml);
            }
        }

        private void RenderSpacer(F.ControlContainer cont, object parent)
        {
            var report = parent as D.ActiveReport;
            var s = cont as F.Spacer;
            float f;

            // for reports we want to render pagebreaks 
            if (s.PageBreak == &quot;true&quot;)
            {
                var pb = new D.PageBreak();
                pb.Location = new PointF(LocX, LocY);
                report.Sections[2].Controls.Add(pb);
            }
            else
            {
                if (!float.TryParse(s.Height, out f))
                    f = 0.2f;
                else
                    f = f / 100; // assume that there are 100 pixels in each .1 inch

                LocY += f;
                LocX = 0f;
            }
        }

        private DataTable GetReportDataforStaticGrid(F.StaticGrid staticGrid)
        {
            var dtResult = new DataTable();
            foreach (F.xControl ctrl in staticGrid.Containers[0].Controls)
            {
                if (ctrl.Type != F.ControlType.Hidden)
                {
                    dtResult.Columns.Add(ctrl.Name);
                }
            }
            dtResult.AcceptChanges();

            int rowNo = 0;

            foreach (DataRow dr in staticGrid.Table.Select())
            {
                DataRow drNew = dtResult.NewRow();
                int colNo = 0, rowControlNo = 0, ctrlColNo = 0;

                foreach (F.xControl ctrl in staticGrid.Containers[0].Controls)
                {
                    if (ctrl.Type != F.ControlType.Hidden)
                    {
                        int rowCount = 0;
                        foreach (F.ControlContainer cc in staticGrid.Containers)
                        {
                            if (cc is F.Row)
                            {
                                F.xControl rctrl = cc.Controls[ctrlColNo];

                                if (rctrl.Type == F.ControlType.Display &amp;&amp; staticGrid.Table.Rows.Count &gt; rowCount)
                                    staticGrid.Table.Rows[rowCount][colNo] = rctrl.EvaluateControlValue();
                                //rctrl.ParseDynamicString(rctrl.Value);

                                rowCount++;
                            }
                        }
                        drNew[rowControlNo++] = staticGrid.Table.Rows[rowNo][colNo].ToString();
                        ctrlColNo++;
                    }
                    colNo++;
                }
                dtResult.Rows.Add(drNew);
                rowNo++;
            }
            return dtResult;
        }

        private void RenderStaticGrid(F.ControlContainer cont, object parent)
        {
            var staticGrid = cont as F.StaticGrid;
            var report = parent as D.ActiveReport;

            if (!string.IsNullOrEmpty(staticGrid.Caption))
            {
                RenderCaptionforReport(cont.form, report, staticGrid.ParseDynamicString(staticGrid.Caption), &quot;&quot;, LocX,
                    LocY, 2);
                LocY += 0.2f;
            }
            D.SubReport subReport = CreateSubReport(staticGrid.Name);
            subReport.Report.LoadLayout(HttpContext.Current.Server.MapPath(&quot;~/common/GenericSubReport1.rpx&quot;));
            float subReportLocX = 0, subReportLocY = 0;

            DataTable dtStaticGrid = GetReportDataforStaticGrid(staticGrid);
            float reportWidth = (7.5f / dtStaticGrid.Columns.Count);

            foreach (F.xControl reportControl in staticGrid.Containers[0].Controls)
            {
                if (reportControl.Type != F.ControlType.Hidden)
                {
                    RenderReportControlforTable(subReport.Report, reportControl,
                        new PointF(subReportLocX, subReportLocY), new SizeF(reportWidth, 0.2f),
                        0);
                    subReportLocX += (float)Convert.ToDecimal(reportWidth);
                }
            }
            subReport.Report.DataSource = dtStaticGrid;
            report.Sections[2].Controls.Add(subReport);
            LocY += report.Sections[2].Height + 0.2f;
        }

        private void RenderSpacer(D.ActiveReport report, float height)
        {
            var s = new F.Spacer();
            s.Height = height.ToString();

            s.Render(report, F.RenderFormat.RenderDataDynamics);
        }

        //For the time being only two properties need to be assigned.
        //Based on the rquirement, the function can be overloaded in future.
        private F.xControl CreateXControl(string name, string caption, F.ControlContainer parent)
        {
            var control = new F.xControl();
            control.Name = name;
            control.Caption = caption;
            control.ParentObject = parent;
            return control;
        }

        private DataTable GetReportDataforChecklistGroup(F.CheckListGroup checkListGroup)
        {
            DataTable dtResult = new DataTable();
            dtResult.Columns.Add(&quot;Caption&quot;);
            dtResult.Columns.Add(&quot;SlNo&quot;);
            dtResult.Columns.Add(&quot;Description&quot;);
            foreach (F.xControl control in checkListGroup.Controls)
                dtResult.Columns.Add(control.Name);
            dtResult.Columns.Add(&quot;Name&quot;);
            dtResult.AcceptChanges();
            int checkListNo = 0;
            foreach (DataRow dr in checkListGroup.Table.Select())
            {
                DataRow drNew = dtResult.NewRow();
                for (int colNo = 2; colNo &lt; dr.ItemArray.Length; colNo++)
                {
                    drNew[colNo + 1] = checkListGroup.Table.Rows[checkListNo][colNo].ToString();
                }
                dtResult.Rows.Add(drNew);
                checkListNo++;
            }

            int rowNo = 0;
            string emptyGroupCaption = string.Empty;
            foreach (F.ControlContainer c in checkListGroup.Containers)
            {
                var grp = c as F.Group;

                int slNo = 1;
                if (grp.Containers.Count == 0 &amp;&amp; !string.IsNullOrEmpty(grp.Caption))
                    emptyGroupCaption = grp.ParseDynamicString(grp.Caption).Replace(&quot;&lt;br/&gt;&quot;, &quot;&quot;).Replace(&quot;&lt;br /&gt;&quot;, &quot;&quot;) +
                                        Environment.NewLine + Environment.NewLine;
                else
                {
                    foreach (F.ControlContainer clc in grp.Containers)
                    {
                        var ckl = clc as F.CheckList;
                        string caption = grp.ParseDynamicString(grp.Caption);
                        dtResult.Rows[rowNo][&quot;Caption&quot;] = emptyGroupCaption +
                                                          caption.Replace(&quot;&lt;br/&gt;&quot;, &quot;&quot;).Replace(&quot;&lt;br /&gt;&quot;, &quot;&quot;);
                        dtResult.Rows[rowNo][&quot;SlNo&quot;] = slNo++;
                        dtResult.Rows[rowNo][&quot;Description&quot;] = ckl.Description;
                        dtResult.Rows[rowNo][&quot;Name&quot;] = grp.Name;
                        rowNo++;
                        emptyGroupCaption = string.Empty;
                    }
                }
            }
            return dtResult;
        }

        private void RenderCheckListGroup(F.ControlContainer cont, object parent)
        {
            var checkListGroup = cont as F.CheckListGroup;
            var report = parent as D.ActiveReport;
            D.SubReport subRport = CreateSubReport(checkListGroup.Name);
            subRport.Report.LoadLayout(HttpContext.Current.Server.MapPath(&quot;~/common/GenericSubReport2.rpx&quot;));
            subRport.Report.Sections.InsertGroupHF();
            float subReportLocX = 0, subReportLocY = 0;

            RenderCaptionforReport(cont.form, subRport.Report, &quot;&quot;, &quot;Caption&quot;, subReportLocX, subReportLocY, 1);
            ((D.GroupHeader)subRport.Report.Sections[1]).DataField = &quot;Name&quot;;
            subReportLocY += 0.2f;

            DataTable dtChecklistGroup = GetReportDataforChecklistGroup(checkListGroup);
            subRport.Report.DataSource = dtChecklistGroup;
            float reportWidth = (4f / (dtChecklistGroup.Columns.Count - 3));

            if (checkListGroup.SerialNoColumn)
            {
                F.xControl slNo = CreateXControl(&quot;SlNo&quot;, &quot;Sl. No.&quot;, cont);
                RenderReportControlforTable(subRport.Report, slNo, new PointF(subReportLocX, subReportLocY),
                    new SizeF(0.3f, 0.2f), 1);
                subReportLocX = 0.3f;
            }
            F.xControl description = CreateXControl(&quot;Description&quot;, checkListGroup.Description, cont);
            RenderReportControlforTable(subRport.Report, description, new PointF(subReportLocX, subReportLocY),
                new SizeF(3.2f, 0.2f), 1);

            subReportLocX = 3.5f;

            foreach (F.xControl reportControl in checkListGroup.Controls)
            {
                RenderReportControlforTable(subRport.Report, reportControl, new PointF(subReportLocX, subReportLocY),
                    new SizeF(reportWidth, 0.2f), 1);
                subReportLocX += (float)Convert.ToDecimal(reportWidth);
            }

            foreach (D.ARControl rptControl in subRport.Report.Sections[&quot;Detail&quot;].Controls)
            {
                float x = rptControl.Location.X;
                float y = rptControl.Location.Y;
                rptControl.Location = new PointF(x, y - 0.2f);
            }

            report.Sections[2].Controls.Add(subRport);
            LocY += subRport.Height;
        }

        //TODO: Need to see how we can incorporate this with new workflow
        private void RenderWorkFlowSectionForReport(F.Form form, D.ActiveReport report)
        {
            //Get the List of WorkFlow Users for current Module
            //UltraWebGrid InstanceGrid = new UltraWebGrid();
            //DataTable InstanceTable = null;
            //WFitem item = new WFitem(form.instanceID, form.ModuleID, InstanceGrid, InstanceTable);
            //DataTable dtWorkFlowUsers = new WorkflowFactory(InstanceGrid, InstanceTable).GetWorkflowUsersHistory(item.Id, form.instanceID, form.ModuleID);

            //if (dtWorkFlowUsers.Rows.Count &gt; 0)
            //{
            //    #region Getting the List of Valid Users from Brix
            //    DataTable validUsers = UserManager.Instance.GetAllUsersDetails(String.Empty);
            //    foreach (DataRow userRow in validUsers.Rows)
            //    {
            //        if (!userRow.IsNull(&quot;Username&quot;) &amp;&amp; !String.IsNullOrEmpty(userRow[&quot;Username&quot;].ToString()))
            //            userRow[&quot;Username&quot;] = userRow[&quot;Username&quot;].ToString().ToLower();
            //    }
            //    #endregion

            //    RenderSpacer(report, 0.8f);
            //    //Spacer after the End of Fields

            //    int rowCount = 0;
            //    foreach (DataRow wfUserRow in dtWorkFlowUsers.Rows)
            //    {
            //        string wfUserName = (wfUserRow.IsNull(&quot;User&quot;) || String.IsNullOrEmpty(wfUserRow[&quot;User&quot;].ToString())) ? String.Empty : wfUserRow[&quot;User&quot;].ToString();
            //        if (!String.IsNullOrEmpty(wfUserName))
            //        {
            //            DataRow[] selUserRows = validUsers.Select(&quot;Username=&#39;&quot; + wfUserName.ToLower() + &quot;&#39;&quot;);
            //            if (selUserRows.Length &gt; 0)
            //            {
            //                string fullName = (selUserRows[0].IsNull(&quot;FullName&quot;)) ? string.Empty : selUserRows[0][&quot;FullName&quot;].ToString();
            //                rowCount++;
            //                D.TextBox txt1 = CreateTextBoxforReport(&quot;WorkFlowUser&quot; + rowCount, fullName, &quot;&quot;, new PointF(LocX, LocY), new SizeF(2f, 0.2f), StyleType.Caption);
            //                report.Sections[2].Controls.Add(txt1);
            //                LocY += txt1.Height;
            //                LocX = 0f;

            //                RenderSpacer(report, 0.8f);
            //            }
            //        }
            //    }
            //}
        }

        public override void EndRendering(F.Form form)
        {
            //TODO: Need to remove/change this code completely after new workflow
            // RenderWorkFlowSectionForReport(form, report); 

            // set the final height of the report from the renderer
            report.Sections[2].Height = form.Renderer.GetHeight();

            report.Run();
            try
            {
                if (!string.IsNullOrEmpty(form.thepage.Request.QueryString[&quot;Mode&quot;]) &amp;&amp;
                    form.thepage.Request.QueryString[&quot;Mode&quot;] == &quot;Report&quot;)
                {
                    //Lijo
                    //System.IO.MemoryStream strm = new System.IO.MemoryStream();
                    //pdf.Export(report.Document, strm);
                    //form.thepage.Session.Add(&quot;Stream&quot;, strm);
                    //form.thepage.Session.Add(&quot;Stream&quot;, report);
                    form.thepage.Session.Add(&quot;Header&quot;, form.Header);

                    string redirectUrl = @&quot;~/Common/BrixReportPage.aspx?XMLReport=1&quot;;
                    if ((form.thepage.Session[&quot;queryStrings&quot;] == null))
                    {
                        redirectUrl += &quot;&amp;&quot; + form.thepage.Request.QueryString;
                        // + &quot;&amp;InstanceID=&quot; + form.thepage.Request.QueryString[&quot;InstanceID&quot;]; 
                        //As we are adding the InstanceID from the querystring it is not required to add it again.
                    }
                    else
                    {
                        redirectUrl += &quot;&amp;&quot; + form.thepage.Session[&quot;queryStrings&quot;] +
                                       ((form.thepage.Session[&quot;queryStrings&quot;]).ToString2().Contains(&quot;&amp;InstanceID=&quot;)
                                           ? string.Empty
                                           : &quot;&amp;InstanceID=&quot; + form.thepage.Request.QueryString[&quot;InstanceID&quot;]);
                        //If InstanceID is not present in the querystring, then add it.
                        form.thepage.Session.Remove(&quot;queryStrings&quot;);
                    }

                    form.thepage.Response.Redirect(redirectUrl, true);
                }
            }
            catch (Exception e)
            {
                string s = e.Message;
                throw;
            }
            finally
            {
                //pdf.Dispose();
                report.Dispose();
            }
        }

        private void RenderTabs(F.ControlContainer cont, object parent)
        {
            foreach (F.ControlContainer tab in cont.Containers)
            {
                tab.Render(parent, F.RenderFormat.RenderDataDynamics);
            }
        }

        private void RenderTab(F.ControlContainer cont, object parent)
        {
            //First render the name of the tab.
            //For each containers, render the report

            RenderCaptionforReport(cont.form, report, cont.ParseDynamicString((cont as F.xTab).Caption ?? cont.Name), &quot;&quot;,
                LocX, LocY, 2);
            LocY += 0.2f;

            foreach (F.ControlContainer c in cont.Containers)
            {
                c.Render(parent, F.RenderFormat.RenderDataDynamics);
                LocY += 0.2f;
            }
        }


        private void SetContainerRenderers()
        {
            ContainerRenderers[(int)F.ContainerTypes.Stage] = new F.ControlContainer.RenderContainer(RenderStage);
            ContainerRenderers[(int)F.ContainerTypes.Section] = new F.ControlContainer.RenderContainer(RenderSection);
            ContainerRenderers[(int)F.ContainerTypes.DynamicGrid] =
                new F.ControlContainer.RenderContainer(RenderDynamicGrid);
            ContainerRenderers[(int)F.ContainerTypes.Spacer] = new F.ControlContainer.RenderContainer(RenderSpacer);
            ContainerRenderers[(int)F.ContainerTypes.Text] = new F.ControlContainer.RenderContainer(RenderText);
            ContainerRenderers[(int)F.ContainerTypes.StaticGrid] =
                new F.ControlContainer.RenderContainer(RenderStaticGrid);
            ContainerRenderers[(int)F.ContainerTypes.CheckListGroup] =
                new F.ControlContainer.RenderContainer(RenderCheckListGroup);
            ContainerRenderers[(int)F.ContainerTypes.Tabs] = new F.ControlContainer.RenderContainer(RenderTabs);
            ContainerRenderers[(int)F.ContainerTypes.Tab] = new F.ControlContainer.RenderContainer(RenderTab);
        }

        #endregion

        #region Server Side Get Value Routines from basic controls

        private F.FormListItem FindByValue(List&lt;F.FormListItem&gt; Items, string value)
        {
            foreach (F.FormListItem fli in Items)
            {
                if (fli.value == value)
                    return (fli);
            }

            return (null);
        }

        private string GetDropDownListValue(F.xControl ctrl)
        {
            List&lt;F.FormListItem&gt; Items;
            Items = ctrl.GetFormList();
            F.FormListItem fli = FindByValue(Items, ctrl.valueObj.ToString());
            if (fli != null)
                return (fli.display);
            else
                return (string.Empty);
        }

        private string GetRadioButtonListValue(F.xControl ctrl)
        {
            List&lt;F.FormListItem&gt; Items;

            Items = ctrl.GetFormList();
            F.FormListItem fli = FindByValue(Items, ctrl.valueObj.ToString());
            if (fli != null)
                return (fli.display);
            else
                return (string.Empty);
        }

        private string GetOtherValues(F.xControl ctrl)
        {
            if (ctrl != null)
                return (ctrl.valueObj.ToString());
            else
                return (String.Empty);
        }

        private void SetControlGetServerValues()
        {
            F.xControl.GetServerSideValue d = GetOtherValues;

            ServerGetters[(int)F.ControlType.Hidden] = d;
            ServerGetters[(int)F.ControlType.TextBox] = d;
            ServerGetters[(int)F.ControlType.TextArea] = d;
            ServerGetters[(int)F.ControlType.Date] = d;
            ServerGetters[(int)F.ControlType.Numeric] = d;
            ServerGetters[(int)F.ControlType.TimeInput] = d;
            ServerGetters[(int)F.ControlType.CheckBox] = d;
            ServerGetters[(int)F.ControlType.AutoIncrement] = d;
            ServerGetters[(int)F.ControlType.DropDownList] = new F.xControl.GetServerSideValue(GetDropDownListValue);
            ServerGetters[(int)F.ControlType.DropDownTreeDataControl] = new F.xControl.GetServerSideValue((F.xControl ctrl) =&gt; { return ctrl.GetServerValue_For_DropDownTreeDataControl(); });
            ServerGetters[(int)F.ControlType.RadioButtonList] = new F.xControl.GetServerSideValue(GetRadioButtonListValue);
        }

        #endregion

        public DataDynamicsRenderer(BrixFormModel model)
            : base(model)
        {
            SetCellRenderers();
            SetControlGetServerValues();
            SetContainerRenderers();
        }

        public override object BeginRendering(F.Form form)
        {
            base.BeginRendering(form);

            //pdf = new PdfExport();
            report = new D.ActiveReport();

            string reportPath = HttpContext.Current.Server.MapPath(&quot;~/common/GenericListReport.rpx&quot;);
            string logoPath = HttpContext.Current.Server.MapPath(AMP3ApplicationSettings.Instance.AppLogo);

            report.LoadLayout(reportPath);

            if (String.IsNullOrEmpty(form.ReportHeader) || form.ReportHeader == &quot;true&quot;)
            {
                // Set the logo to the report header
                if (File.Exists(logoPath))
                {
                    Image logoImage = new Bitmap(logoPath);
                    var pic = ((D.Picture)report.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                    pic.Image = logoImage;
                    if (logoImage.Height &gt; pic.Height * 100 || logoImage.Width &gt; pic.Width * 100)
                        pic.SizeMode = D.SizeModes.Zoom;
                }

                // Set the header of the report
                ((D.Label)report.Sections[&quot;ReportHeader&quot;].Controls[&quot;lblRptHeader&quot;]).Text = form.Header.ToUpper();
                // set the current date
                ((D.TextBox)report.Sections[&quot;PageFooter&quot;].Controls[&quot;txtGeneratedDate&quot;]).Text = DateTime.UtcNow.ToString_WithFormatDateTime();

                report.Sections.InsertGroupHF();
            }
            else
                report.Sections.InsertGroupHF();

            return (report);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[23,9,39,11,0],[47,9,47,10,0],[48,13,48,65,0],[49,13,49,38,0],[52,21,52,73,0],[54,21,54,77,0],[56,21,56,79,0],[58,21,58,75,0],[60,21,60,77,0],[62,21,62,79,0],[64,21,64,73,0],[66,21,66,97,0],[68,21,68,31,0],[70,9,70,10,0],[74,9,74,10,0],[75,13,75,42,0],[77,13,77,32,0],[78,13,78,42,0],[79,13,79,40,0],[80,13,80,32,0],[81,13,81,45,0],[82,13,82,35,0],[83,13,83,37,0],[84,13,84,36,0],[85,13,85,59,0],[86,13,86,27,0],[87,9,87,10,0],[92,9,92,10,0],[93,13,93,45,0],[95,13,95,34,0],[96,13,96,44,0],[97,13,97,42,0],[98,13,98,34,0],[99,13,99,47,0],[100,13,100,38,0],[102,13,102,29,0],[103,9,103,10,0],[107,9,107,10,0],[108,13,108,93,0],[109,9,109,10,0],[112,9,112,10,0],[113,13,114,71,0],[116,13,116,97,0],[118,13,118,52,0],[119,13,119,14,0],[120,17,121,37,0],[122,17,123,71,0],[125,21,125,22,0],[126,25,126,95,0],[127,21,127,22,0],[128,21,128,26,0],[129,21,129,22,0],[130,25,130,41,0],[131,21,131,22,0],[132,17,133,71,0],[135,21,135,22,0],[136,25,136,85,0],[137,21,137,22,0],[138,21,138,26,0],[139,21,139,22,0],[140,25,140,41,0],[141,21,141,22,0],[144,13,144,14,0],[145,13,145,27,0],[146,9,146,10,0],[187,9,187,10,0],[188,13,188,51,0],[189,13,189,30,0],[190,13,190,34,0],[191,13,191,14,0],[193,17,193,18,0],[196,21,196,55,0],[197,17,197,18,0],[198,17,198,22,0],[199,17,199,18,0],[200,17,200,18,0],[201,13,201,14,0],[203,13,204,122,0],[205,13,205,14,0],[206,17,207,103,0],[208,17,208,57,0],[209,21,209,82,0],[210,13,210,14,0],[211,13,212,35,0],[213,13,213,31,0],[214,13,214,26,0],[215,9,215,10,0],[218,9,218,10,0],[220,13,220,41,0],[221,13,221,24,0],[222,9,222,10,0],[225,9,225,10,0],[226,13,226,41,0],[227,13,227,24,0],[228,9,228,10,0],[231,9,231,10,0],[232,13,232,62,0],[234,13,234,58,0],[235,13,235,62,0],[236,13,236,59,0],[237,13,237,59,0],[238,13,238,60,0],[239,13,239,56,0],[240,13,240,59,0],[241,13,241,59,0],[242,13,242,61,0],[243,13,243,64,0],[244,13,244,75,0],[245,13,245,59,0],[246,13,246,116,0],[247,13,247,67,0],[248,13,248,58,0],[249,13,249,59,0],[250,13,250,61,0],[251,13,251,63,0],[252,13,252,95,0],[253,13,253,60,0],[254,13,254,64,0],[255,13,255,65,0],[256,13,256,113,0],[257,13,257,106,0],[258,13,258,111,0],[259,9,259,10,0],[269,9,269,10,0],[270,13,270,47,0],[271,13,271,14,0],[272,17,272,52,0],[273,17,273,41,0],[275,17,275,24,0],[275,26,275,37,0],[275,38,275,40,0],[275,41,275,46,0],[276,17,276,18,0],[278,21,278,57,0],[279,21,279,46,0],[280,25,280,36,0],[282,25,282,43,0],[284,21,284,48,0],[285,21,285,22,0],[286,21,286,22,0],[287,26,287,50,0],[288,21,288,22,0],[289,25,289,50,0],[290,25,290,38,0],[291,25,291,50,0],[292,29,292,56,0],[293,21,293,22,0],[294,26,294,50,0],[295,25,295,39,0],[297,21,297,34,0],[298,17,298,18,0],[301,17,301,34,0],[302,13,302,14,0],[303,9,303,10,0],[308,9,308,10,0],[309,13,309,45,0],[310,13,310,61,0],[311,13,311,52,0],[312,13,312,60,0],[313,13,313,39,0],[314,13,314,38,0],[315,13,315,38,0],[316,13,316,45,0],[317,13,317,68,0],[318,13,318,67,0],[322,13,322,58,0],[323,9,323,10,0],[326,9,326,10,0],[327,13,327,57,0],[328,17,328,29,0],[330,13,330,45,0],[332,13,332,36,0],[333,13,333,14,0],[334,17,334,112,0],[335,13,335,14,0],[337,17,337,112,0],[338,13,338,41,0],[339,13,339,58,0],[340,17,340,95,0],[342,17,342,59,0],[343,13,343,120,0],[344,17,344,29,0],[345,13,345,26,0],[346,9,346,10,0],[357,9,357,10,0],[358,13,358,55,0],[359,9,359,10,0],[362,9,362,10,0],[363,13,363,50,0],[364,17,364,35,0],[366,13,366,14,0],[367,17,370,39,0],[372,17,372,70,0],[373,17,373,30,0],[375,9,375,10,0],[378,9,378,10,0],[379,13,379,45,0],[380,13,380,51,0],[382,13,382,37,0],[383,13,383,35,0],[384,13,384,35,0],[386,13,386,56,0],[387,13,387,14,0],[388,17,388,123,0],[389,17,389,30,0],[390,17,390,33,0],[391,13,391,14,0],[393,13,393,20,0],[393,22,393,46,0],[393,47,393,49,0],[393,50,393,66,0],[394,13,394,14,0],[398,17,398,92,0],[399,17,399,18,0],[403,21,403,85,0],[404,25,404,50,0],[405,26,405,90,0],[406,25,406,50,0],[407,26,407,91,0],[408,25,408,50,0],[410,25,410,49,0],[412,21,412,42,0],[413,21,413,22,0],[414,25,420,48,0],[422,25,422,63,0],[423,21,423,22,0],[425,21,425,59,0],[426,21,426,22,0],[428,25,428,46,0],[429,29,429,40,0],[431,25,433,98,0],[435,25,436,81,0],[437,25,437,26,0],[438,29,438,90,0],[439,29,439,36,0],[439,38,439,56,0],[439,57,439,59,0],[439,60,439,69,0],[440,29,440,30,0],[441,33,441,71,0],[442,37,442,60,0],[443,29,443,30,0],[444,25,444,26,0],[446,25,446,73,0],[448,29,448,77,0],[450,25,450,105,0],[451,25,451,70,0],[452,25,452,119,0],[453,25,453,64,0],[455,25,455,75,0],[456,21,456,22,0],[458,21,458,22,0],[459,25,459,105,0],[460,29,460,48,0],[462,25,462,32,0],[462,34,462,50,0],[462,51,462,53,0],[462,54,462,76,0],[463,25,463,26,0],[464,29,469,52,0],[470,29,470,67,0],[472,29,472,54,0],[473,29,473,65,0],[474,25,474,26,0],[476,25,476,41,0],[477,25,477,44,0],[479,25,479,32,0],[479,34,479,54,0],[479,55,479,57,0],[479,58,479,80,0],[480,25,480,26,0],[481,29,483,94,0],[485,29,486,81,0],[487,29,487,30,0],[488,33,488,90,0],[489,33,489,40,0],[489,42,489,60,0],[489,61,489,63,0],[489,64,489,73,0],[490,33,490,34,0],[491,37,491,75,0],[492,41,492,64,0],[493,33,493,34,0],[494,29,494,30,0],[496,29,496,73,0],[497,33,497,77,0],[500,29,500,70,0],[501,29,501,101,0],[502,29,502,119,0],[504,29,504,79,0],[505,29,505,68,0],[506,29,506,69,0],[507,25,507,26,0],[508,21,508,22,0],[511,21,511,37,0],[512,21,512,40,0],[513,17,513,18,0],[514,13,514,14,0],[516,13,516,50,0],[516,50,516,83,0],[516,83,516,95,0],[516,13,516,95,0],[517,13,517,14,0],[518,17,518,52,0],[519,17,519,69,0],[520,17,520,18,0],[521,21,522,58,0],[522,58,522,91,0],[522,91,522,99,0],[521,21,522,99,0],[523,17,523,18,0],[525,17,525,45,0],[526,17,526,39,0],[527,17,529,64,0],[530,17,530,47,0],[531,17,531,24,0],[531,26,531,46,0],[531,47,531,49,0],[531,50,531,68,0],[532,17,532,18,0],[533,21,533,58,0],[534,21,534,22,0],[535,25,535,71,0],[536,25,536,60,0],[537,29,537,45,0],[538,25,538,63,0],[539,25,539,83,0],[540,25,540,47,0],[541,21,541,22,0],[542,17,542,18,0],[543,17,543,44,0],[544,13,544,14,0],[545,18,545,55,0],[545,55,545,88,0],[545,88,545,100,0],[545,18,545,100,0],[546,13,546,14,0],[547,17,547,24,0],[547,26,547,46,0],[547,47,547,49,0],[547,50,547,68,0],[548,17,548,18,0],[549,21,549,58,0],[550,21,550,22,0],[551,25,551,77,0],[552,21,552,22,0],[553,17,553,18,0],[554,13,554,14,0],[556,13,556,14,0],[557,17,557,27,0],[558,13,558,14,0],[559,9,559,10,0],[562,9,562,10,0],[563,13,563,39,0],[564,13,564,51,0],[566,13,566,43,0],[568,13,568,51,0],[569,13,569,74,0],[570,13,570,32,0],[571,13,571,83,0],[573,13,573,42,0],[574,17,574,24,0],[574,26,574,39,0],[574,40,574,42,0],[574,43,574,59,0],[575,17,575,18,0],[577,21,577,22,0],[578,25,578,49,0],[579,21,579,22,0],[580,21,580,26,0],[581,21,581,22,0],[582,21,582,22,0],[583,17,583,18,0],[587,13,587,50,0],[589,13,589,32,0],[590,9,590,10,0],[594,9,594,10,0],[597,13,601,56,0],[602,13,602,61,0],[605,13,605,113,0],[607,13,607,61,0],[608,17,608,65,0],[611,13,611,39,0],[612,13,612,44,0],[614,13,614,107,0],[617,13,617,27,0],[618,17,618,74,0],[619,9,619,10,0],[673,9,673,10,0],[674,13,674,46,0],[676,13,676,51,0],[677,13,677,42,0],[678,13,678,52,0],[679,13,679,29,0],[680,9,680,10,0],[683,9,683,10,0],[684,13,684,66,0],[685,9,685,10,0],[688,9,688,10,0],[689,13,689,53,0],[690,13,690,51,0],[696,13,696,60,0],[697,13,697,14,0],[698,17,699,30,0],[700,17,700,30,0],[701,13,701,14,0],[703,13,703,70,0],[704,13,704,109,0],[705,13,705,36,0],[705,38,705,55,0],[707,13,707,20,0],[707,22,707,46,0],[707,47,707,49,0],[707,50,707,70,0],[708,13,708,14,0],[709,17,709,79,0],[710,17,710,64,0],[711,17,711,18,0],[712,21,714,28,0],[715,21,715,76,0],[716,17,716,18,0],[717,13,717,14,0],[735,13,735,60,0],[736,13,736,55,0],[737,13,737,54,0],[738,9,738,10,0],[741,9,741,10,0],[742,13,742,20,0],[742,22,742,42,0],[742,43,742,45,0],[742,46,742,61,0],[743,13,743,14,0],[744,17,744,61,0],[745,13,745,14,0],[746,9,746,10,0],[749,9,749,10,0],[750,13,750,51,0],[751,13,751,38,0],[755,13,755,39,0],[756,13,756,14,0],[757,17,757,44,0],[758,17,758,54,0],[759,17,759,53,0],[760,13,760,14,0],[762,13,762,14,0],[763,17,763,54,0],[764,21,764,30,0],[766,21,766,33,0],[768,17,768,27,0],[769,17,769,27,0],[770,13,770,14,0],[771,9,771,10,0],[774,9,774,10,0],[775,13,775,44,0],[776,13,776,20,0],[776,22,776,37,0],[776,38,776,40,0],[776,41,776,74,0],[777,13,777,14,0],[778,17,778,55,0],[779,17,779,18,0],[780,21,780,53,0],[781,17,781,18,0],[782,13,782,14,0],[783,13,783,38,0],[785,13,785,27,0],[787,13,787,20,0],[787,22,787,32,0],[787,33,787,35,0],[787,36,787,61,0],[788,13,788,14,0],[789,17,789,51,0],[790,17,790,30,0],[790,32,790,48,0],[790,50,790,63,0],[792,17,792,24,0],[792,26,792,41,0],[792,42,792,44,0],[792,45,792,78,0],[793,17,793,18,0],[794,21,794,59,0],[795,21,795,22,0],[796,25,796,42,0],[797,25,797,32,0],[797,34,797,55,0],[797,56,797,58,0],[797,59,797,80,0],[798,25,798,26,0],[799,29,799,45,0],[800,29,800,30,0],[801,33,801,75,0],[803,33,803,115,0],[804,37,804,107,0],[807,33,807,44,0],[808,29,808,30,0],[809,25,809,26,0],[810,25,810,96,0],[811,25,811,37,0],[812,21,812,22,0],[813,21,813,29,0],[814,17,814,18,0],[815,17,815,42,0],[816,17,816,25,0],[817,13,817,14,0],[818,13,818,29,0],[819,9,819,10,0],[822,9,822,10,0],[823,13,823,51,0],[824,13,824,51,0],[826,13,826,59,0],[827,13,827,14,0],[828,17,829,30,0],[830,17,830,30,0],[831,13,831,14,0],[832,13,832,70,0],[833,13,833,111,0],[834,13,834,36,0],[834,38,834,55,0],[836,13,836,77,0],[837,13,837,69,0],[839,13,839,20,0],[839,22,839,46,0],[839,47,839,49,0],[839,50,839,83,0],[840,13,840,14,0],[841,17,841,64,0],[842,17,842,18,0],[843,21,845,28,0],[846,21,846,76,0],[847,17,847,18,0],[848,13,848,14,0],[849,13,849,56,0],[850,13,850,56,0],[851,13,851,54,0],[852,9,852,10,0],[855,9,855,10,0],[856,13,856,36,0],[857,13,857,42,0],[859,13,859,65,0],[860,9,860,10,0],[865,9,865,10,0],[866,13,866,44,0],[867,13,867,33,0],[868,13,868,39,0],[869,13,869,43,0],[870,13,870,28,0],[871,9,871,10,0],[874,9,874,10,0],[875,13,875,50,0],[876,13,876,45,0],[877,13,877,42,0],[878,13,878,49,0],[879,13,879,20,0],[879,22,879,40,0],[879,41,879,43,0],[879,44,879,67,0],[880,17,880,52,0],[881,13,881,42,0],[882,13,882,38,0],[883,13,883,33,0],[884,13,884,20,0],[884,22,884,32,0],[884,33,884,35,0],[884,36,884,65,0],[885,13,885,14,0],[886,17,886,51,0],[887,22,887,35,0],[887,37,887,64,0],[887,66,887,73,0],[888,17,888,18,0],[889,21,889,97,0],[890,17,890,18,0],[891,17,891,42,0],[892,17,892,31,0],[893,13,893,14,0],[895,13,895,27,0],[896,13,896,53,0],[897,13,897,20,0],[897,22,897,42,0],[897,43,897,45,0],[897,46,897,71,0],[898,13,898,14,0],[899,17,899,40,0],[901,17,901,30,0],[902,17,902,85,0],[903,21,904,83,0],[906,17,906,18,0],[907,21,907,28,0],[907,30,907,52,0],[907,53,907,55,0],[907,56,907,70,0],[908,21,908,22,0],[909,25,909,54,0],[910,25,910,78,0],[911,25,912,110,0],[913,25,913,63,0],[914,25,914,79,0],[915,25,915,65,0],[916,25,916,33,0],[917,25,917,58,0],[918,21,918,22,0],[919,17,919,18,0],[920,13,920,14,0],[921,13,921,29,0],[922,9,922,10,0],[925,9,925,10,0],[926,13,926,59,0],[927,13,927,51,0],[928,13,928,73,0],[929,13,929,110,0],[930,13,930,54,0],[931,13,931,36,0],[931,38,931,55,0],[933,13,933,112,0],[934,13,934,77,0],[935,13,935,35,0],[937,13,937,89,0],[938,13,938,59,0],[939,13,939,77,0],[941,13,941,47,0],[942,13,942,14,0],[943,17,943,75,0],[944,17,945,47,0],[946,17,946,38,0],[947,13,947,14,0],[948,13,948,102,0],[949,13,950,43,0],[952,13,952,34,0],[954,13,954,20,0],[954,22,954,46,0],[954,47,954,49,0],[954,50,954,73,0],[955,13,955,14,0],[956,17,957,54,0],[958,17,958,72,0],[959,13,959,14,0],[961,13,961,20,0],[961,22,961,44,0],[961,45,961,47,0],[961,48,961,91,0],[962,13,962,14,0],[963,17,963,49,0],[964,17,964,49,0],[965,17,965,63,0],[966,13,966,14,0],[968,13,968,55,0],[969,13,969,37,0],[970,9,970,10,0],[974,9,974,10,0],[1016,9,1016,10,0],[1019,9,1019,10,0],[1024,13,1024,67,0],[1026,13,1026,26,0],[1028,13,1028,14,0],[1029,17,1030,74,0],[1031,17,1031,18,0],[1037,21,1037,69,0],[1039,21,1039,86,0],[1040,21,1040,72,0],[1041,21,1041,22,0],[1042,25,1042,79,0],[1045,21,1045,22,0],[1047,21,1047,22,0],[1048,25,1051,111,0],[1053,25,1053,69,0],[1054,21,1054,22,0],[1056,21,1056,71,0],[1057,17,1057,18,0],[1058,13,1058,14,0],[1059,13,1059,32,0],[1060,13,1060,14,0],[1061,17,1061,38,0],[1062,17,1062,23,0],[1065,13,1065,14,0],[1067,17,1067,34,0],[1068,13,1068,14,0],[1069,9,1069,10,0],[1072,9,1072,10,0],[1073,13,1073,20,0],[1073,22,1073,44,0],[1073,45,1073,47,0],[1073,48,1073,63,0],[1074,13,1074,14,0],[1075,17,1075,71,0],[1076,13,1076,14,0],[1077,9,1077,10,0],[1080,9,1080,10,0],[1084,13,1085,32,0],[1086,13,1086,26,0],[1088,13,1088,20,0],[1088,22,1088,42,0],[1088,43,1088,45,0],[1088,46,1088,61,0],[1089,13,1089,14,0],[1090,17,1090,69,0],[1091,17,1091,30,0],[1092,13,1092,14,0],[1093,9,1093,10,0],[1097,9,1097,10,0],[1098,13,1098,115,0],[1099,13,1099,119,0],[1100,13,1101,75,0],[1102,13,1102,117,0],[1103,13,1103,113,0],[1104,13,1105,74,0],[1106,13,1107,78,0],[1108,13,1108,113,0],[1109,13,1109,111,0],[1110,9,1110,10,0],[1117,9,1117,10,0],[1118,13,1118,20,0],[1118,22,1118,40,0],[1118,41,1118,43,0],[1118,44,1118,49,0],[1119,13,1119,14,0],[1120,17,1120,40,0],[1121,21,1121,34,0],[1122,13,1122,14,0],[1124,13,1124,27,0],[1125,9,1125,10,0],[1128,9,1128,10,0],[1130,13,1130,40,0],[1131,13,1131,79,0],[1132,13,1132,29,0],[1133,17,1133,38,0],[1135,17,1135,39,0],[1136,9,1136,10,0],[1139,9,1139,10,0],[1142,13,1142,40,0],[1143,13,1143,79,0],[1144,13,1144,29,0],[1145,17,1145,38,0],[1147,17,1147,39,0],[1148,9,1148,10,0],[1151,9,1151,10,0],[1152,13,1152,30,0],[1153,17,1153,51,0],[1155,17,1155,39,0],[1156,9,1156,10,0],[1159,9,1159,10,0],[1160,13,1160,62,0],[1162,13,1162,58,0],[1163,13,1163,59,0],[1164,13,1164,60,0],[1165,13,1165,56,0],[1166,13,1166,59,0],[1167,13,1167,61,0],[1168,13,1168,60,0],[1169,13,1169,65,0],[1170,13,1170,118,0],[1171,13,1171,128,0],[1171,128,1171,129,0],[1171,129,1171,130,0],[1171,130,1171,187,0],[1171,187,1171,188,0],[1171,188,1171,189,0],[1171,189,1171,191,0],[1171,13,1171,191,0],[1172,13,1172,124,0],[1173,9,1173,10,0],[1178,15,1178,26,0],[1179,9,1179,10,0],[1180,13,1180,32,0],[1181,13,1181,41,0],[1182,13,1182,37,0],[1183,9,1183,10,0],[1186,9,1186,10,0],[1187,13,1187,39,0],[1190,13,1190,43,0],[1192,13,1192,102,0],[1193,13,1193,108,0],[1195,13,1195,43,0],[1197,13,1197,88,0],[1198,13,1198,14,0],[1200,17,1200,43,0],[1201,17,1201,18,0],[1202,21,1202,60,0],[1203,21,1203,96,0],[1204,21,1204,43,0],[1205,21,1205,98,0],[1206,25,1206,57,0],[1207,17,1207,18,0],[1210,17,1210,114,0],[1212,17,1212,142,0],[1214,17,1214,49,0],[1215,13,1215,14,0],[1217,17,1217,49,0],[1219,13,1219,29,0],[1220,9,1220,10,0]]);
    </script>
  </body>
</html>