<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\AbstractModels\ModelHelper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Text;
using System.Web;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.Brix.Platform.BusinessLayer.CustomControls;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebCombo;
using Infragistics.WebUI.WebSchedule;
using Telerik.Web.UI;

using Aurigo.Brix.Platform.BusinessLayer.Utility;
using System.Collections;

namespace Aurigo.AMP3.Common
{
    public class ModelHelper
    {
        public static string GetFilterHtml(HtmlTable tblFilter, BrixFilter[] filters)
        {
            var filterArray = new StringBuilder();
            //string prefix = tblFilter.UniqueID.Remove(tblFilter.UniqueID.Length - 9).Replace(&quot;$&quot;, &quot;_&quot;);
            string prefix = tblFilter.NamingContainer.ClientID + &quot;_&quot;;
            // tblFilter.UniqueID.Remove(tblFilter.UniqueID.Length - 9).Replace(&quot;$&quot;, &quot;_&quot;);
            int idx = 1;
            foreach (BrixFilter filter in filters)
            {
                var tr = new HtmlTableRow();
                var td = new HtmlTableCell();
                td.Attributes.Add(&quot;class&quot;, &quot;tdTextAlignRgt&quot;);
                td.Style.Add(HtmlTextWriterStyle.Width, &quot;140px&quot;);
                td.InnerText = filter.Title.EndsWith(&quot;:&quot;) ? filter.Title : filter.Title + &quot; :&quot;;
                tr.Cells.Add(td);

                td = new HtmlTableCell();
                switch (filter.FilterType)
                {
                    case BrixFilter.Type.Text:
                        var txt = new TextBox();
                        txt.MaxLength = filter.MaxLength;
                        txt.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                        txt.ID = &quot;txt&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                        if (!string.IsNullOrEmpty(filter.DataTextField))
                        {
                            txt.Text = filter.DataTextField;
                            txt.Enabled = false;
                        }
                        filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txt.UniqueID);
                        td.Controls.Add(txt);
                        break;
                    case BrixFilter.Type.Real:
                        var txtReal = new TextBox();
                        txtReal.MaxLength = filter.MaxLength;
                        txtReal.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                        txtReal.ID = &quot;real&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                        filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txtReal.UniqueID);
                        td.Controls.Add(txtReal);
                        break;
                    case BrixFilter.Type.Date:
                        var dte = new WebDateChooser();
                        dte.ID = &quot;dc&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                        filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, dte.UniqueID);
                        dte.AllowNull = true;
                        dte.NullDateLabel = &quot;None&quot;;
                        Brix.Platform.BusinessLayer.XmlForm_Framework.XMLDateControl.ApplyPatch_For_DatePickerStyle(dte);
                        td.Controls.Add(dte);
                        break;
                    case BrixFilter.Type.Radio:
                        var rbl = new RadioButtonList();
                        rbl.ID = &quot;rbl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                        filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, rbl.UniqueID);
                        rbl.RepeatDirection = RepeatDirection.Horizontal;
                        rbl.RepeatLayout = RepeatLayout.Table;
                        foreach (var key in filter.Values)
                            rbl.Items.Add(new ListItem(key.Key, key.Value));
                        td.Controls.Add(rbl);
                        break;
                    case BrixFilter.Type.Combo:
                        var ddl = new DropDownList();
                        ddl.ID = &quot;ddl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                        filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, ddl.UniqueID);
                        ddl.DataSource = filter.DataSource;
                        if (!String.IsNullOrEmpty(filter.DataValueField) || !String.IsNullOrEmpty(filter.DataTextField))
                        {
                            if (String.IsNullOrEmpty(filter.DataValueField))
                                ddl.DataValueField = ddl.DataTextField = filter.DataTextField;
                            else if (String.IsNullOrEmpty(filter.DataTextField))
                                ddl.DataValueField = ddl.DataTextField = filter.DataValueField;
                            else
                            {
                                ddl.DataValueField = filter.DataValueField;
                                ddl.DataTextField = filter.DataTextField;
                            }
                        }
                        else if (filter.DataSource.Columns.Count &gt;= 2)
                        {
                            ddl.DataValueField = filter.DataSource.Columns[0].ColumnName;
                            ddl.DataTextField = filter.DataSource.Columns[1].ColumnName;
                        }
                        ddl.DataBind();
                        if (filter.Values != null)
                            foreach (var kvp in filter.Values)
                                ddl.Items.Add(new ListItem(kvp.Key, kvp.Value));

                        td.Controls.Add(ddl);
                        ddl.Items.Insert(0, new ListItem(&quot;Select&quot;));
                        break;
                }
                tr.Cells.Add(td);
                tblFilter.Rows.Insert(idx++, tr);
            }
            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}&#39;&quot;, --idx);
            return filterArray.ToString2();
        }

        public static void SetColumnAndImageInfo(ref DataTable ColumnInfo, ref DataTable ImageInfo)
        {
            ColumnInfo = new BrixDataTable();
            ColumnInfo.Columns.Add(&quot;Key&quot;);
            ColumnInfo.Columns.Add(&quot;ColumnWidth&quot;);
            ColumnInfo.Columns.Add(&quot;Hidden&quot;);
            ColumnInfo.Columns.Add(&quot;Position&quot;);
            ColumnInfo.Columns.Add(&quot;Format&quot;);
            ColumnInfo.Columns.Add(&quot;AllowUpdate&quot;);
            ColumnInfo.Columns.Add(&quot;Caption&quot;);
            ColumnInfo.Columns.Add(&quot;IsTimezoneApplicable&quot;);

            ImageInfo = new BrixDataTable();
            ImageInfo.Columns.Add(&quot;Key&quot;);
            ImageInfo.Columns.Add(&quot;Value&quot;);
            ImageInfo.Columns.Add(&quot;ImageFile&quot;);
            ImageInfo.Columns.Add(&quot;Caption&quot;);
        }

        public static void ModifyColumnProperties(string key, bool hide, int? position, string format,
            string columnWidth,
            bool allowUpdate, string caption, DataTable ColumnInfoTable, bool isTimezoneApplicable = false)
        {
            DataRow[] rows = ColumnInfoTable.Select(&quot;key=&#39;{0}&#39;&quot;.Format2(key));
            DataRow row = rows.Length == 0 ? ColumnInfoTable.NewRow() : rows[0];

            row[&quot;Key&quot;] = key;
            row[&quot;Position&quot;] = position;
            row[&quot;Format&quot;] = format;
            row[&quot;Hidden&quot;] = hide;
            row[&quot;ColumnWidth&quot;] = columnWidth;
            row[&quot;AllowUpdate&quot;] = allowUpdate;
            row[&quot;Caption&quot;] = caption;
            row[&quot;IsTimezoneApplicable&quot;] = isTimezoneApplicable;
            if (rows.Length == 0)
                ColumnInfoTable.Rows.Add(row);
        }

        internal static void ModifyColumnProperties(string key, bool hide, int? position, string format,
            string columnWidth,
            bool allowUpdate, DataTable ColumnInfoTable, bool isTimezoneApplicable = false)
        {
            ModifyColumnProperties(key, hide, position, format, columnWidth, allowUpdate, string.Empty, ColumnInfoTable, isTimezoneApplicable);
        }

        /// &lt;summary&gt;
        /// Display Filter control in 2 column layout
        /// Also include Section for dynamic grid
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;tblFilter&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;displayFilter&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;filterLabels&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal static string GetSearchFilterHtml(HtmlTable tblFilter, bool displayFilter, BrixFilter[] filterLabels)
        {
            var filterArray = new StringBuilder();
            string prefix = tblFilter.NamingContainer.ClientID + &quot;_&quot;;
            int idx = tblFilter.Rows.Count == 0 ? 0 : tblFilter.Rows.Count;
            int filterCount = filterLabels.Length;
            int filterIdx = 0;
            if (displayFilter &amp;&amp; filterLabels != null)
            {
                var trlist = new List&lt;HtmlTableRow&gt;();
                var tr = new HtmlTableRow();
                bool isNewRow = true;
                foreach (BrixFilter filter in filterLabels)
                {
                    if ((filterIdx % 2) == 0)
                    {
                        tr = new HtmlTableRow();
                        isNewRow = true;
                    }
                    else
                        isNewRow = false;

                    var lbltd = new HtmlTableCell();
                    var ctrltd = new HtmlTableCell();
                    lbltd.Attributes.Add(&quot;class&quot;, &quot;tdTextAlignRgt&quot;);
                    if (filterCount &gt; 2)
                        lbltd.Style.Add(HtmlTextWriterStyle.Width, &quot;20%&quot;);
                    else
                        lbltd.Style.Add(HtmlTextWriterStyle.Width, &quot;20%&quot;);

                    if (String.IsNullOrEmpty(filter.Title)) filter.Title = &quot;&quot;;
                    lbltd.InnerText = filter.Title.EndsWith(&quot;:&quot;) ? filter.Title : filter.Title + &quot; :&quot;;
                    tr.Cells.Add(lbltd);

                    if (filterCount &gt; 2 &amp;&amp; (filterIdx % 2) == 1)
                        ctrltd.Style.Add(HtmlTextWriterStyle.Width, &quot;35%&quot;);
                    else if (filterCount &gt; 2 &amp;&amp; (filterIdx % 2) == 0)
                        ctrltd.Style.Add(HtmlTextWriterStyle.Width, &quot;25%&quot;);
                    switch (filter.FilterType)
                    {
                        case BrixFilter.Type.Text:
                            var txt = new TextBox();
                            txt.MaxLength = filter.MaxLength;
                            txt.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                            txt.ID = &quot;txt&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            if (!string.IsNullOrEmpty(filter.DataTextField))
                            {
                                txt.Text = filter.DataTextField;
                                txt.Enabled = false;
                            }
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txt.UniqueID);
                            txt.EnableViewState = false;
                            txt.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            txt.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;,&quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(txt);
                            break;
                        case BrixFilter.Type.Real:
                            var txtReal = new TextBox();
                            txtReal.MaxLength = filter.MaxLength;
                            txtReal.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                            txtReal.ID = &quot;real&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txtReal.UniqueID);
                            txtReal.EnableViewState = false;
                            txtReal.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            txtReal.Attributes.Add(&quot;isReal&quot;, &quot;1&quot;);
                            txtReal.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(txtReal);
                            break;
                        case BrixFilter.Type.Date:
                            var dte = new WebDateChooser();
                            dte.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
                            dte.Style.Add(HtmlTextWriterStyle.Width, &quot;177px&quot;);
                            dte.ID = &quot;dc&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, dte.UniqueID);
                            DateTime DefaultValueDT;
                            if (!string.IsNullOrEmpty(filter.DefaultValue) &amp;&amp;
                                DateTime.TryParse(filter.DefaultValue, out DefaultValueDT))
                                dte.Value = DefaultValueDT;
                            else
                            {
                                dte.AllowNull = true;
                                dte.NullDateLabel = &quot;None&quot;;
                            }
                            dte.EnableViewState = false;
                            dte.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);

                            Brix.Platform.BusinessLayer.XmlForm_Framework.XMLDateControl.ApplyPatch_For_DatePickerStyle(dte);
                            dte.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(dte);
                            break;
                        case BrixFilter.Type.Radio:
                            var rbl = new RadioButtonList();
                            rbl.ID = &quot;rbl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, rbl.UniqueID);
                            rbl.RepeatDirection = RepeatDirection.Horizontal;
                            rbl.RepeatLayout = RepeatLayout.Table;
                            foreach (var key in filter.Values)
                                rbl.Items.Add(new ListItem(key.Key, key.Value));
                            rbl.EnableViewState = false;
                            rbl.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            rbl.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(rbl);
                            break;
                        case BrixFilter.Type.Combo:
                            var ddl = new GroupDropDownList();
                            ddl.CssClass = &quot;ddlControls&quot;;
                            ddl.Style.Add(HtmlTextWriterStyle.Width, &quot;180px&quot;);
                            ddl.ID = &quot;ddl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, ddl.UniqueID);
                            ddl.DataSource = filter.DataSource;
                            if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                !String.IsNullOrEmpty(filter.DataTextField))
                            {
                                if (String.IsNullOrEmpty(filter.DataValueField))
                                    ddl.DataValueField = ddl.DataTextField = filter.DataTextField;
                                else if (String.IsNullOrEmpty(filter.DataTextField))
                                    ddl.DataValueField = ddl.DataTextField = filter.DataValueField;
                                else
                                {
                                    ddl.DataValueField = filter.DataValueField;
                                    ddl.DataTextField = filter.DataTextField;
                                }
                            }
                            else if (filter.DataSource.Columns.Count &gt;= 2)
                            {
                                ddl.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                ddl.DataTextField = filter.DataSource.Columns[1].ColumnName;
                            }
                            if (!string.IsNullOrEmpty(filter.DataGroupField))
                                ddl.DataGroupField = filter.DataGroupField;
                            ddl.DataBind();
                            if (filter.Values != null)
                            {
                                foreach (var kvp in filter.Values)
                                {
                                    if (kvp.Key != &quot;_DBNULL_&quot; &amp;&amp; kvp.Value != &quot;_DBNULL_&quot;)
                                        ddl.Items.Add(new ListItem(kvp.Value, kvp.Key));
                                }
                            }

                            ddl.Items.Insert(0, new ListItem(&quot;Select&quot;));
                            ddl.EnableViewState = false;
                            ddl.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            ddl.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(ddl);
                            break;
                        case BrixFilter.Type.CheckBox:
                            var chkbx = new CheckBox();
                            chkbx.ID = &quot;chkbx&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, chkbx.UniqueID);
                            chkbx.Text = filter.Values[&quot;Text&quot;];
                            chkbx.EnableViewState = false;
                            chkbx.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            chkbx.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                            ctrltd.Controls.Add(chkbx);
                            break;
                        case BrixFilter.Type.MultiColumnCombo:
                            Version ver = Version.Parse(HttpContext.Current.Request.Browser.Version);
                            if (ver.Major &lt;= 9) // 
                            {
                                var webcom = new WebCombo(&quot;webcom&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;));
                                filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix,
                                    webcom.UniqueID);
                                webcom.EnableViewState = false;
                                webcom.DataSource = filter.DataSource;

                                if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                    !String.IsNullOrEmpty(filter.DataTextField))
                                {
                                    if (String.IsNullOrEmpty(filter.DataValueField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataTextField;
                                    else if (String.IsNullOrEmpty(filter.DataTextField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataValueField;
                                    else
                                    {
                                        webcom.DataValueField = filter.DataValueField;
                                        webcom.DataTextField = filter.DataTextField;
                                    }
                                }
                                else if (filter.DataSource.Columns.Count &gt;= 2)
                                {
                                    webcom.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                    webcom.DataTextField = filter.DataSource.Columns[1].ColumnName;
                                }
                                webcom.DataBind();
                                if (filter.ColumnInfo != null)
                                    SetColumnAttributes(webcom, filter.ColumnInfo);

                                webcom.DisplayValue = &quot;Select&quot;;

                                webcom.EnableViewState = false;
                                webcom.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                                webcom.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                                ctrltd.Controls.Add(webcom);
                            }
                            else
                            {
                                var webcom = new DropDownList();
                                webcom.Style.Add(HtmlTextWriterStyle.Width, &quot;180px&quot;);
                                webcom.ID = &quot;webcom&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                                filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix,
                                    webcom.UniqueID);
                                webcom.DataSource = filter.DataSource;
                                if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                    !String.IsNullOrEmpty(filter.DataTextField))
                                {
                                    if (String.IsNullOrEmpty(filter.DataValueField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataTextField;
                                    else if (String.IsNullOrEmpty(filter.DataTextField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataValueField;
                                    else
                                    {
                                        webcom.DataValueField = filter.DataValueField;
                                        webcom.DataTextField = filter.DataTextField;
                                    }
                                }
                                else if (filter.DataSource.Columns.Count &gt;= 2)
                                {
                                    webcom.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                    webcom.DataTextField = filter.DataSource.Columns[1].ColumnName;
                                }
                                webcom.DataBind();
                                if (filter.Values != null)
                                    foreach (var kvp in filter.Values)
                                        webcom.Items.Add(new ListItem(kvp.Key, kvp.Value));

                                webcom.Items.Insert(0, new ListItem(&quot;Select&quot;));
                                webcom.EnableViewState = false;
                                webcom.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                                webcom.Attributes.Add(&quot;aria-label&quot;, filter.Title.EndsWith(&quot;:&quot;) ? filter.Title.Replace(&quot;:&quot;, &quot;&quot;) : filter.Title);
                                ctrltd.Controls.Add(webcom);
                            }
                            break;
                    }
                    tr.Cells.Add(ctrltd);
                    if (isNewRow) trlist.Add(tr);
                    filterIdx++;
                }

                if (filterLabels.Length &gt; 0 &amp;&amp; (filterLabels[0].isGridSection || !string.IsNullOrEmpty(filterLabels[0].sectionCaption)))
                {
                    var table = new HtmlTable();
                    table.Style.Add(HtmlTextWriterStyle.Width, &quot;100%&quot;);
                    foreach (var row in trlist)
                    {
                        table.Rows.Add(row);
                    }
                    HtmlGenericControl divcontrol = new HtmlGenericControl();
                    divcontrol.Attributes[&quot;class&quot;] = &quot;searchDynamicContainer&quot;;
                    divcontrol.TagName = &quot;div&quot;;

                    HtmlGenericControl divcontrolHeader = new HtmlGenericControl();
                    HtmlGenericControl divcontrolContent = new HtmlGenericControl();
                    if (filterLabels[0].isGridSection)
                        divcontrolHeader.InnerText = filterLabels[0].DynamicGridCaption + &quot;: &quot;;
                    else
                        divcontrolHeader.InnerText = filterLabels[0].sectionCaption;

                    divcontrolContent.Attributes.Add(&quot;hidden&quot;, &quot;&quot;);
                    divcontrolHeader.Attributes[&quot;class&quot;] = &quot;searchDynamicContainerheader collapse&quot;;
                    divcontrolHeader.TagName = &quot;div&quot;;
                    divcontrolHeader.Attributes.Add(&quot;onclick&quot;, &quot;SearchDynamicContainerHeaderClick(this)&quot;);
                    divcontrol.Controls.AddAt(0, divcontrolHeader);

                    divcontrolContent.Attributes[&quot;class&quot;] = &quot;searchDynamicContainerContent&quot;;
                    divcontrolContent.TagName = &quot;div&quot;;
                  
                    divcontrolContent.Controls.Add(table);
                    divcontrol.Controls.AddAt(1, divcontrolContent);

                    HtmlTableRow hTR = new HtmlTableRow();
                    HtmlTableCell hTc = new HtmlTableCell();
                    hTc.ColSpan = 4;
                    hTc.Controls.Add(divcontrol);
                    hTR.Cells.Add(hTc);
                    tblFilter.Rows.Add(hTR);
                }
                else
                {
                    foreach (var row in trlist)
                    {
                        tblFilter.Rows.Add(row);
                    }
                }

            }
            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}&#39;&quot;, --idx);
            return filterArray.ToString2();
        }
        
        internal static string GetFilterHtml(HtmlTable tblFilter, bool displayFilter, BrixFilter[] filterLabels)
        {
            var filterArray = new StringBuilder();
            string prefix = tblFilter.NamingContainer.ClientID + &quot;_&quot;;
            // tblFilter.UniqueID.Remove(tblFilter.UniqueID.Length - 9).Replace(&quot;$&quot;, &quot;_&quot;);
            int idx = tblFilter.Rows.Count == 0 ? 0 : 1;
            if (displayFilter &amp;&amp; filterLabels != null)
            {
                foreach (BrixFilter filter in filterLabels)
                {
                    if (filter.isGridSection) continue;
                    var tr = new HtmlTableRow();
                    var td = new HtmlTableCell();
                    td.Attributes.Add(&quot;class&quot;, &quot;tdTextAlignRgt&quot;);
                    td.Style.Add(HtmlTextWriterStyle.Width, &quot;180px&quot;);
                    td.InnerText = filter.Title.EndsWith(&quot;:&quot;) ? filter.Title : filter.Title + &quot; :&quot;;
                    tr.Cells.Add(td);

                    td = new HtmlTableCell();
                    switch (filter.FilterType)
                    {
                        case BrixFilter.Type.Text:
                            var txt = new TextBox();
                            txt.MaxLength = filter.MaxLength;
                            txt.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                            txt.ID = &quot;txt&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            if (!string.IsNullOrEmpty(filter.DataTextField))
                            {
                                txt.Text = filter.DataTextField;
                                txt.Enabled = false;
                            }
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txt.UniqueID);
                            txt.EnableViewState = false;
                            txt.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            td.Controls.Add(txt);
                            break;
                        case BrixFilter.Type.Real:
                            var txtReal = new TextBox();
                            txtReal.MaxLength = filter.MaxLength;
                            txtReal.Style.Add(HtmlTextWriterStyle.Width, &quot;175px&quot;);
                            txtReal.ID = &quot;real&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, txtReal.UniqueID);
                            txtReal.EnableViewState = false;
                            txtReal.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            txtReal.Attributes.Add(&quot;isReal&quot;, &quot;1&quot;);
                            td.Controls.Add(txtReal);
                            break;
                        case BrixFilter.Type.Date:
                            var dte = new WebDateChooser();
                            dte.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
                            dte.Style.Add(HtmlTextWriterStyle.Width, &quot;177px&quot;);
                            dte.ID = &quot;dc&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, dte.UniqueID);
                            DateTime DefaultValueDT;
                            if (!string.IsNullOrEmpty(filter.DefaultValue) &amp;&amp;
                                DateTime.TryParse(filter.DefaultValue, out DefaultValueDT))
                                dte.Value = DefaultValueDT;
                            else
                            {
                                dte.AllowNull = true;
                                dte.NullDateLabel = &quot;None&quot;;
                            }
                            dte.EnableViewState = false;
                            dte.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);

                            Brix.Platform.BusinessLayer.XmlForm_Framework.XMLDateControl.ApplyPatch_For_DatePickerStyle(dte);

                            td.Controls.Add(dte);
                            break;
                        case BrixFilter.Type.Radio:
                            var rbl = new RadioButtonList();
                            rbl.ID = &quot;rbl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, rbl.UniqueID);
                            rbl.RepeatDirection = RepeatDirection.Horizontal;
                            rbl.RepeatLayout = RepeatLayout.Table;
                            foreach (var key in filter.Values)
                                rbl.Items.Add(new ListItem(key.Key, key.Value));
                            rbl.EnableViewState = false;
                            rbl.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            td.Controls.Add(rbl);
                            break;
                        case BrixFilter.Type.Combo:
                            var ddl = new GroupDropDownList();
                            ddl.CssClass = &quot;ddlControls&quot;;
                            ddl.Style.Add(HtmlTextWriterStyle.Width, &quot;180px&quot;);
                            ddl.ID = &quot;ddl&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, ddl.UniqueID);
                            ddl.DataSource = filter.DataSource;
                            if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                !String.IsNullOrEmpty(filter.DataTextField))
                            {
                                if (String.IsNullOrEmpty(filter.DataValueField))
                                    ddl.DataValueField = ddl.DataTextField = filter.DataTextField;
                                else if (String.IsNullOrEmpty(filter.DataTextField))
                                    ddl.DataValueField = ddl.DataTextField = filter.DataValueField;
                                else
                                {
                                    ddl.DataValueField = filter.DataValueField;
                                    ddl.DataTextField = filter.DataTextField;
                                }
                            }
                            else if (filter.DataSource.Columns.Count &gt;= 2)
                            {
                                ddl.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                ddl.DataTextField = filter.DataSource.Columns[1].ColumnName;
                            }
                            if (!string.IsNullOrEmpty(filter.DataGroupField))
                                ddl.DataGroupField = filter.DataGroupField;
                            ddl.DataBind();
                            if (filter.Values != null)
                            {
                                foreach (var kvp in filter.Values)
                                {
                                    if (kvp.Key != &quot;_DBNULL_&quot; &amp;&amp; kvp.Value != &quot;_DBNULL_&quot;)
                                        ddl.Items.Add(new ListItem(kvp.Value, kvp.Key));
                                }
                            }

                            ddl.Items.Insert(0, new ListItem(&quot;Select&quot;));
                            ddl.EnableViewState = false;
                            ddl.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            td.Controls.Add(ddl);
                            break;
                        case BrixFilter.Type.CheckBox:
                            var chkbx = new CheckBox();
                            chkbx.ID = &quot;chkbx&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix, chkbx.UniqueID);
                            chkbx.Text = filter.Values[&quot;Text&quot;];
                            chkbx.EnableViewState = false;
                            chkbx.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                            td.Controls.Add(chkbx);
                            break;
                        case BrixFilter.Type.MultiColumnCombo:
                            Version ver = Version.Parse(HttpContext.Current.Request.Browser.Version);
                            if (ver.Major &lt;= 9) // 
                            {
                                var webcom = new WebCombo(&quot;webcom&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;));
                                filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix,
                                    webcom.UniqueID);
                                webcom.EnableViewState = false;
                                webcom.DataSource = filter.DataSource;

                                if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                    !String.IsNullOrEmpty(filter.DataTextField))
                                {
                                    if (String.IsNullOrEmpty(filter.DataValueField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataTextField;
                                    else if (String.IsNullOrEmpty(filter.DataTextField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataValueField;
                                    else
                                    {
                                        webcom.DataValueField = filter.DataValueField;
                                        webcom.DataTextField = filter.DataTextField;
                                    }
                                }
                                else if (filter.DataSource.Columns.Count &gt;= 2)
                                {
                                    webcom.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                    webcom.DataTextField = filter.DataSource.Columns[1].ColumnName;
                                }
                                webcom.DataBind();
                                if (filter.ColumnInfo != null)
                                    SetColumnAttributes(webcom, filter.ColumnInfo);

                                webcom.DisplayValue = &quot;Select&quot;;

                                webcom.EnableViewState = false;
                                webcom.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                                td.Controls.Add(webcom);
                            }
                            else
                            {
                                var webcom = new DropDownList();
                                webcom.Style.Add(HtmlTextWriterStyle.Width, &quot;180px&quot;);
                                webcom.ID = &quot;webcom&quot; + filter.Name.Replace(&quot; &quot;, &quot;&quot;);
                                filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}{1}&#39;,&quot;, prefix,
                                    webcom.UniqueID);
                                webcom.DataSource = filter.DataSource;
                                if (!String.IsNullOrEmpty(filter.DataValueField) ||
                                    !String.IsNullOrEmpty(filter.DataTextField))
                                {
                                    if (String.IsNullOrEmpty(filter.DataValueField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataTextField;
                                    else if (String.IsNullOrEmpty(filter.DataTextField))
                                        webcom.DataValueField = webcom.DataTextField = filter.DataValueField;
                                    else
                                    {
                                        webcom.DataValueField = filter.DataValueField;
                                        webcom.DataTextField = filter.DataTextField;
                                    }
                                }
                                else if (filter.DataSource.Columns.Count &gt;= 2)
                                {
                                    webcom.DataValueField = filter.DataSource.Columns[0].ColumnName;
                                    webcom.DataTextField = filter.DataSource.Columns[1].ColumnName;
                                }
                                webcom.DataBind();
                                if (filter.Values != null)
                                    foreach (var kvp in filter.Values)
                                        webcom.Items.Add(new ListItem(kvp.Key, kvp.Value));

                                webcom.Items.Insert(0, new ListItem(&quot;Select&quot;));
                                webcom.EnableViewState = false;
                                webcom.Attributes.Add(&quot;skip&quot;, &quot;1&quot;);
                                td.Controls.Add(webcom);
                            }
                            break;
                    }
                    tr.Cells.Add(td);
                    tblFilter.Rows.Insert(idx++, tr);
                }
            }
            filterArray.AppendFormat(CultureInfo.CurrentCulture, &quot;&#39;{0}&#39;&quot;, --idx);
            return filterArray.ToString2();
        }

        /// &lt;summary&gt;
        /// Return Search Control and search criteria in XML Format 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;prefix&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;request&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;filters&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;TimezoneColumns&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isDynamicGrid&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string GetFilterXML(string prefix, HttpRequest request, BrixFilter[] filters, ArrayList TimezoneColumns = null, bool isDynamicGrid = false)
        {
            TimezoneColumns = TimezoneColumns ?? new ArrayList(new List&lt;String&gt;());

            var sbFilterSearch = new StringBuilder();
            sbFilterSearch.Append(&quot;&lt;XMLRoot&gt;&quot;);

            foreach (BrixFilter ftr in filters)
            {
                string name;
                string value = string.Empty;
                string type = string.Empty;
                if (isDynamicGrid &amp;&amp; !ftr.isGridSection)
                    continue;
                if (ftr.FilterType == BrixFilter.Type.Text)
                {
                    name = prefix + &quot;txt&quot; + (isDynamicGrid  ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;);
                    type = &quot;txt&quot;;
                    if (request.Form[name] != null)
                        if (request.Form[name].Length &gt; 0)
                        {
                            value = request.Form[name].EscapeSpecial_XmlCharacters();

                            bool isTimezoneApplicable = ftr.IsTimezoneApplicable || TimezoneColumns.Contains(name);
                            //if timezone is applicable still must send as MWdatetime (not UTC)
                            CreateFilterXml(sbFilterSearch, ftr, value, type, isTimezoneApplicable, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                        }
                }
                else if (ftr.FilterType == BrixFilter.Type.Real)
                {
                    name = prefix + &quot;real&quot; + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;);
                    type = &quot;real&quot;;
                    if (request.Form[name] != null)
                        if (request.Form[name].Length &gt; 0)
                        {
                            value = request.Form[name].EscapeSpecial_XmlCharacters();
                            CreateFilterXml(sbFilterSearch, ftr, value, type,false, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                        }
                }
                else if (ftr.FilterType == BrixFilter.Type.Radio)
                {
                    name = prefix + &quot;rbl&quot; + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;);
                    type = &quot;rbl&quot;;
                    if (request.Form[(prefix + &quot;rbl&quot; + ftr.Name)] != null)
                    {
                        if (ftr.Values.ContainsValue(request.Form[(prefix + &quot;rbl&quot; + ftr.Name)]))
                        {
                            value = request.Form[(prefix + &quot;rbl&quot; + ftr.Name)].EscapeSpecial_XmlCharacters();
                            CreateFilterXml(sbFilterSearch, ftr, value, type, false, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                        }
                    }
                }
                else if (ftr.FilterType == BrixFilter.Type.CheckBox)
                {
                    name = prefix + &quot;chkbx&quot; + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;);
                    type = &quot;chkbx&quot;;
                    if (request.Form[(prefix + &quot;chkbx&quot; + ftr.Name)] != null)
                    {
                        if (request.Form[(prefix + &quot;chkbx&quot; + ftr.Name)].ToString()
                            .Equals(&quot;on&quot;, StringComparison.CurrentCultureIgnoreCase))
                            value = string.IsNullOrEmpty(ftr.DBType)
                                ? &quot;true&quot;
                                : ftr.DBType.ToLower() == &quot;bit&quot; ? &quot;1&quot; : &quot;true&quot;;
                        else
                            value = string.IsNullOrEmpty(ftr.DBType)
                                ? &quot;false&quot;
                                : ftr.DBType.ToLower() == &quot;bit&quot; ? &quot;0&quot; : &quot;false&quot;;
                        CreateFilterXml(sbFilterSearch, ftr, value, type, false, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                    }
                }
                else if (ftr.FilterType == BrixFilter.Type.Date)
                {
                    name = (prefix + &quot;dc&quot; + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;) + &quot;_input&quot;).Replace(&quot;$&quot;, &quot;_&quot;);
                    type = &quot;dc&quot;;

                    if (request.Form[name] != null &amp;&amp; request.Form[name] != &quot;&quot; &amp;&amp; request.Form[name] != &quot;None&quot;)
                    {
                        bool isTimezoneApplicable = ftr.IsTimezoneApplicable || TimezoneColumns.Contains(name);

                        value = Convert.ToDateTime(request.Form[name], DateFormatCulture.GetDateFormatCulture()).ToString_WithFormatDateTime();
                        //Must pass as MWDatetime (not as UTC)
                        CreateFilterXml(sbFilterSearch, ftr, value, type, isTimezoneApplicable, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                    }
                    else if (name.StartsWith(&quot;ctl00_&quot;))
                    {
                        name = (prefix + &quot;dc&quot;  + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;) + &quot;_input&quot;).Replace(&quot;$&quot;, &quot;_&quot;)
                            .Replace(&quot;ctl00_&quot;, &quot;&quot;);
                        type = &quot;dc&quot;;
                        if (request.Form[name] != null &amp;&amp; request.Form[name] != &quot;None&quot;)
                        {
                            bool isTimezoneApplicable = ftr.IsTimezoneApplicable || TimezoneColumns.Contains(name);

                            value = Convert.ToDateTime(request.Form[name], DateFormatCulture.GetDateFormatCulture()).ToString_WithFormatDateTime();
                            //Must pass as MWDatetime (not as UTC)
                            CreateFilterXml(sbFilterSearch, ftr, value, type, isTimezoneApplicable, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                        }
                    }
                }
                else if (ftr.FilterType == BrixFilter.Type.Combo)
                {
                    name = prefix + &quot;ddl&quot; + (isDynamicGrid ? ftr.DynamicGridName : &quot;&quot;) + ftr.Name.Replace(&quot; &quot;, &quot;&quot;);
                    type = &quot;ddl&quot;;
                    if (request.Form[name] != null)
                    {
                        if (ftr.Values != null)
                        {
                            if (ftr.Values.ContainsKey(request.Form[name]))
                            {
                                value = request.Form[name].EscapeSpecial_XmlCharacters();
                                CreateFilterXml(sbFilterSearch, ftr, value, type, false, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                            }
                        }
                        else if (ftr.DataSource != null &amp;&amp; request.Form[name].ToUpper() != &quot;SELECT&quot;)
                        {
                            DataRow[] vals = ftr.DataSource.Select(ftr.DataValueField + &quot;=&#39;&quot; + request.Form[name].Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot;);
                            if (vals.Length &gt; 0)
                            {
                                value = vals[0][ftr.DataValueField].ToString().EscapeSpecial_XmlCharacters();
                                CreateFilterXml(sbFilterSearch, ftr, value, type, false, isDynamicGrid ? ftr.DynamicGridTableName : &quot;&quot;);
                            }
                        }
                    }
                }
            }
            if (sbFilterSearch.ToString() == &quot;&lt;XMLRoot&gt;&quot;)
                return null;
            sbFilterSearch.Append(&quot;&lt;/XMLRoot&gt;&quot;);
            return sbFilterSearch.ToString();
        }
        

        /// &lt;summary&gt;
        /// When passing date object to this method pass it in MWCulture string and if timezone is applicable indicate it so that conversion will happen when XML is getting translated to query
        /// Date passes to this method must be in MWDateTime and must not me in UTC.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sbFilterSearch&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;ftr&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isTimeZoneApplicable&quot;&gt;&lt;/param&gt;
        public static void CreateFilterXml(StringBuilder sbFilterSearch, BrixFilter ftr, string value, string type, bool isTimeZoneApplicable = false,string DynamicTableName=&quot;&quot;)
        {
            string xmlCompatibleName = ftr.Name.Replace(&quot; &quot;, &quot;_&quot;);
            if(string.IsNullOrEmpty(DynamicTableName))
                sbFilterSearch.AppendFormat(&quot;&lt;{0} type=&#39;{2}&#39; DBColumn=&#39;{3}&#39; IsTimeZoneApplicable=&#39;{4}&#39; &gt;{1}&lt;/{0}&gt;&quot;, xmlCompatibleName, value, type, ftr.DBColumnName, isTimeZoneApplicable);
            else
                sbFilterSearch.AppendFormat(&quot;&lt;{0} type=&#39;{2}&#39; DBColumn=&#39;{3}&#39; IsTimeZoneApplicable=&#39;{4}&#39;  DynamicTableName=&#39;{5}&#39; &gt;{1}&lt;/{0}&gt;&quot;, xmlCompatibleName, value, type, ftr.DBColumnName, isTimeZoneApplicable, DynamicTableName);

            //Note:
            //When it is a date type we need to have two range -&gt; Start of UTC and End of UTC for the given MWDate(): This will do when we translate this xml to Query
        }

        public static void SetColumnAttributes(UltraWebGrid brixGrid, DataTable columnInfo)
        {
            if (columnInfo != null)
            {
                ColumnsCollection colColl = brixGrid.Columns;

                foreach (DataRow row in columnInfo.Rows)
                {
                    UltraGridColumn ugCols = colColl.FromKey(row[&quot;Key&quot;].ToString2());
                    bool hide;
                    bool.TryParse(row[&quot;Hidden&quot;].ToString2(), out hide);

                    if (ugCols != null)
                    {
                        if (hide)
                        {
                            ugCols.Hidden = hide;
                        }
                        else
                        {
                            if (!string.IsNullOrEmpty(row[&quot;Format&quot;].ToString2()))
                            {
                                ugCols.Format = row[&quot;Format&quot;].ToString2();
                                if (row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT) ||
                                    row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_QUANTITY))
                                    ugCols.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                            }

                            if (!string.IsNullOrEmpty(row[&quot;Position&quot;].ToString2()))
                            {
                                int position;
                                int.TryParse(row[&quot;Position&quot;].ToString2(), out position);
                                ugCols.Move(position);
                            }

                            if (!string.IsNullOrEmpty(row[&quot;ColumnWidth&quot;].ToString2()))
                            {
                                int columnWidth;
                                if (int.TryParse(row[&quot;ColumnWidth&quot;].ToString2(), out columnWidth))
                                {
                                    ugCols.Width = Unit.Pixel(columnWidth);
                                }
                            }

                            if (!string.IsNullOrEmpty(row[&quot;AllowUpdate&quot;].ToString2()))
                            {
                                bool allowUpdate;
                                bool.TryParse(row[&quot;AllowUpdate&quot;].ToString2(), out allowUpdate);
                                if (allowUpdate)
                                {
                                    ugCols.AllowUpdate = AllowUpdate.Yes;
                                    ugCols.CellStyle.BackColor = Color.Yellow;
                                }
                            }

                            if (!string.IsNullOrEmpty(row[&quot;Caption&quot;].ToString2()))
                            {
                                ugCols.Header.Caption = row[&quot;Caption&quot;].ToString2();
                            }
                        }
                    }
                }
            }
        }

        public static void SetColumnAttributes(RadGrid grid, DataTable columnInfo)
        {
            bool IsBatchEditAllowed = false;
            if (grid != null &amp;&amp; columnInfo != null)
            {
                if (columnInfo.Select(&quot;Position&lt;&gt;&#39;&#39;&quot;).Length &gt; 0)
                {
                    if (columnInfo.Columns.Contains(&quot;PositionForSort&quot;))
                        columnInfo.Columns.Remove(&quot;PositionForSort&quot;);
                    columnInfo.Columns.Add(&quot;PositionForSort&quot;, typeof(int), &quot;Convert(Position, &#39;System.Int32&#39;)&quot;);

                    DataRow[] sortedRows = columnInfo.Select(&quot;&quot;, &quot;PositionForSort&quot;);
                    for (int i = 0; i &lt; sortedRows.Length; i++)
                    {
                        sortedRows[i][&quot;Position&quot;] = i + 1;
                    }
                }

                //Force clientSelectColumn order index to be 0
                GridColumn clientSelectColumn = grid.MasterTableView.GetColumnSafe(&quot;Multi&quot;) as GridColumn;
                if (clientSelectColumn != null)
                {
                    clientSelectColumn.OrderIndex = 0;
                }

                foreach (GridColumn column in grid.MasterTableView.AutoGeneratedColumns)
                {
                    //When AutoPostBackOnFilter is True, the column assumes a filter operation of &quot;Contains&quot; for string types or &quot;EqualTo&quot; for numeric types
                    //column.AutoPostBackOnFilter = true;

                    if (column is GridBoundColumn)
                    {
                        //Set header text 
                        column.HeaderText =
                            Aurigo.Brix.Platform.BusinessLayer.Utility.MWGrid.GetDatabaseFriendlyExpression(
                                column.UniqueName);
                        //Make all columns ReadOnly 
                        (column as GridBoundColumn).ReadOnly = true;
                        //Set a standard width to all filter controls 
                        if (
                            Aurigo.Brix.Platform.BusinessLayer.Utility.MWGrid.GetDatabaseFriendlyExpression(
                                column.UniqueName) != &quot;Multi&quot;)
                        {
                            column.FilterControlWidth = Unit.Pixel(100);
                            //column.HeaderStyle.Width = Unit.Pixel(150);
                        }
                        //Align numeric column to right 
                        if (column.ColumnType == (new GridNumericColumn()).ColumnType)
                        {
                            SetGridColumnAlignment(grid, column, HorizontalAlign.Right);
                        }
                    }
                }

                //Set column styles as defined in the columnInfo collection
                foreach (DataRow row in columnInfo.Rows)
                {
                    GridColumn column =
                        grid.MasterTableView.GetColumnSafe(
                            Aurigo.Brix.Platform.BusinessLayer.Utility.MWGrid.GetGridFriendlyExpression(
                                row[&quot;Key&quot;].ToString2())) as GridColumn;
                    if (column != null)
                    {
                        bool hidden;
                        bool.TryParse(row[&quot;Hidden&quot;].ToString2(), out hidden);

                        if (hidden)
                        {
                            column.Display = false;
                        }
                        else
                        {
                            //Set Column Format
                            if (!string.IsNullOrEmpty(row[&quot;Format&quot;].ToString2()))
                            {
                                //Telerik Grid takes column formts as below 
                                //Date: {0:dd/MM/yyyy} 
                                //Currency: {0:##,##,##0.00} 
                                if ((column as GridBoundColumn) != null)
                                {
                                    string dataFormat = row[&quot;Format&quot;].ToString2();
                                    (column as GridBoundColumn).DataFormatString = &quot;{0:&quot; + dataFormat + &quot;}&quot;;

                                    //DecimalDigits required for Grid Filter
                                    if ((column is GridNumericColumn) &amp;&amp; dataFormat.Contains(&quot;.&quot;))
                                    {
                                        (column as GridNumericColumn).DecimalDigits = dataFormat.Split(&#39;.&#39;)[1].Length;
                                    }
                                }

                                if (column.DataType == Type.GetType(&quot;System.DateTime&quot;) &amp;&amp;
                                    row[&quot;Format&quot;].ToString2().ToLower().Contains(&quot;h&quot;))
                                {
                                    ((GridDateTimeColumn)column).PickerType =
                                        GridDateTimeColumnPickerType.DateTimePicker;
                                }
                                //Set column alignment  
                                //If the column has a format of Amount/Quantity/Percentage/UnitPrice, then align the column to right   
                                if (row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT) ||
                                    row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_QUANTITY) ||
                                    row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE) ||
                                    row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE))
                                {
                                    SetGridColumnAlignment(grid, column, HorizontalAlign.Right);
                                }
                            }

                            //Set Column Position
                            if (!string.IsNullOrEmpty(row[&quot;Position&quot;].ToString2()))
                            {
                                int position;
                                int.TryParse(row[&quot;Position&quot;].ToString2(), out position);
                                column.OrderIndex = position + 1;
                            }

                            //Set Column Width 
                            if (!string.IsNullOrEmpty(row[&quot;ColumnWidth&quot;].ToString2()))
                            {
                                int columnWidth;
                                if (int.TryParse(row[&quot;ColumnWidth&quot;].ToString2(), out columnWidth))
                                {
                                    column.HeaderStyle.Width = Unit.Pixel(columnWidth);
                                }
                            }

                            if (!string.IsNullOrEmpty(row[&quot;allowupdate&quot;].ToString2()))
                            {
                                bool allowupdate;
                                bool.TryParse(row[&quot;allowupdate&quot;].ToString2(), out allowupdate);
                                if (allowupdate)
                                {
                                    //column.ReadOnly = !allowupdate;
                                    (column as GridBoundColumn).ReadOnly = false;
                                    column.ItemStyle.BackColor = Color.Yellow;
                                    IsBatchEditAllowed = true;
                                }
                            }

                            //Set Column HeaderText/Caption 
                            if (!string.IsNullOrEmpty(row[&quot;Caption&quot;].ToString2()))
                            {
                                column.HeaderText = row[&quot;Caption&quot;].ToString2();
                            }
                        }
                    }
                }
                if (IsBatchEditAllowed)
                {
                    grid.MasterTableView.EditMode = GridEditMode.Batch;
                    grid.MasterTableView.BatchEditingSettings.EditType = GridBatchEditingType.Cell;
                }
            }
        }

        private static void SetGridColumnAlignment(RadGrid grid, GridColumn column, HorizontalAlign alignment)
        {
            string cssTextAlignAttributeValue = string.Empty;
            switch (alignment)
            {
                case HorizontalAlign.Right:
                    cssTextAlignAttributeValue = &quot;right&quot;;
                    break;
                case HorizontalAlign.Left:
                    cssTextAlignAttributeValue = &quot;left&quot;;
                    break;
                case HorizontalAlign.Center:
                    cssTextAlignAttributeValue = &quot;center&quot;;
                    break;
                default:
                    cssTextAlignAttributeValue = &quot;left&quot;;
                    break;
            }
            column.HeaderStyle.HorizontalAlign = alignment;
            column.ItemStyle.HorizontalAlign = alignment;
            if (grid.MasterTableView.GetItems(GridItemType.FilteringItem).Length &gt; 0)
            {
                (grid.MasterTableView.GetItems(GridItemType.FilteringItem)[0] as GridFilteringItem)[column.UniqueName]
                    .HorizontalAlign = alignment;
                (grid.MasterTableView.GetItems(GridItemType.FilteringItem)[0] as GridFilteringItem)[column.UniqueName]
                    .Style.Add(&quot;text-align&quot;, cssTextAlignAttributeValue);
            }
        }

        public static void SetColumnAttributes(WebCombo multiColumnCombo, DataTable columnInfo)
        {
            if (columnInfo != null)
            {
                ColumnsCollection colColl = multiColumnCombo.Columns;

                foreach (DataRow row in columnInfo.Rows)
                {
                    UltraGridColumn ugCols = colColl.FromKey(row[&quot;Key&quot;].ToString2());
                    bool hide;
                    bool.TryParse(row[&quot;Hidden&quot;].ToString2(), out hide);

                    if (ugCols != null)
                    {
                        if (hide)
                        {
                            ugCols.Hidden = hide;
                        }
                        else
                        {
                            if (!string.IsNullOrEmpty(row[&quot;Format&quot;].ToString2()))
                            {
                                ugCols.Format = row[&quot;Format&quot;].ToString2();
                                if (row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT) ||
                                    row[&quot;Format&quot;].ToString2().Equals(AMP3ApplicationSettings.Instance.FORMAT_QUANTITY))
                                    ugCols.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                            }

                            if (!string.IsNullOrEmpty(row[&quot;Position&quot;].ToString2()))
                            {
                                int position;
                                int.TryParse(row[&quot;Position&quot;].ToString2(), out position);
                                ugCols.Move(position);
                            }

                            if (!string.IsNullOrEmpty(row[&quot;ColumnWidth&quot;].ToString2()))
                            {
                                int columnWidth;
                                int.TryParse(row[&quot;ColumnWidth&quot;].ToString2(), out columnWidth);
                                ugCols.Width = Unit.Pixel(columnWidth);
                            }

                            if (!string.IsNullOrEmpty(row[&quot;AllowUpdate&quot;].ToString2()))
                            {
                                bool allowUpdate;
                                bool.TryParse(row[&quot;AllowUpdate&quot;].ToString2(), out allowUpdate);
                                if (allowUpdate)
                                {
                                    ugCols.AllowUpdate = AllowUpdate.Yes;
                                    ugCols.CellStyle.BackColor = Color.Yellow;
                                }
                            }

                            if (!string.IsNullOrEmpty(row[&quot;Caption&quot;].ToString2()))
                            {
                                ugCols.Header.Caption = row[&quot;Caption&quot;].ToString2();
                            }
                        }
                    }
                }
            }
        }

        public static Dictionary&lt;string, Type&gt; GetModelObjects(Type type, Type type2 = null)
        {
            var contextDic = new Dictionary&lt;string, Type&gt;();
            //List&lt;AssemblyName&gt; list = new List&lt;AssemblyName&gt;();
            string path = &quot;.\\&quot;;

            if (HttpRuntime.BinDirectory != null)
            {
                path = HttpRuntime.BinDirectory;
            }
            foreach (string dllFile in Directory.GetFiles(path, &quot;Aurigo*.dll&quot;))
            {
                try
                {
                    Assembly privateAssembly = Assembly.LoadFrom(dllFile);

                    try
                    {
                        foreach (Type privateType in privateAssembly.GetTypes())
                        {
                            try
                            {
                                Type tp = privateType;
                                if (!privateType.IsAbstract)
                                {
                                    do
                                    {
                                        if (type.IsInterface
                                            ? tp.GetInterface(type.ToString2()) != null
                                            : tp.IsSubclassOf(type))
                                        {
                                            var attribs = (ContextAttribute[])
                                                tp.GetCustomAttributes(typeof(ContextAttribute), true);
                                            if (attribs != null &amp;&amp; attribs.Length &gt; 0 &amp;&amp;
                                                !string.IsNullOrEmpty(attribs[0].Name) &amp;&amp;
                                                (type2 == null || (type2 != null &amp;&amp; !tp.IsSubclassOf(type2))))
                                            {
                                                string context = attribs[0].Name.ToUpper();
                                                if (tp.Name.StartsWith(&quot;EIS&quot;))
                                                    context = &quot;EIS&quot; + context;
                                                if (!contextDic.ContainsKey(context))
                                                    contextDic.Add(context, tp);
                                                if (contextDic.ContainsKey(context) &amp;&amp;
                                                    tp.IsSubclassOf(contextDic[context]))
                                                    contextDic[context] = tp;
                                                break;
                                            }
                                        }

                                        tp = tp.BaseType;
                                    } while (tp != null);
                                }
                            }
                            catch (Exception ex)
                            {
                                Aurigo.AMP3.Logging.Logger.Log(&quot;ModelHelper1&quot;, ex);
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        Aurigo.AMP3.Logging.Logger.Log(&quot;ModelHelper2&quot;, ex);
                    }
                }
                catch (ReflectionTypeLoadException ex)
                {
                    Aurigo.AMP3.Logging.Logger.Log(&quot;ModelHelper3&quot;, ex);
                }
                catch (Exception ex)
                {
                    Aurigo.AMP3.Logging.Logger.Log(&quot;ModelHelper4&quot;, ex);
                }
            }
            return contextDic;
        }
    }

    public class BrixFilter
    {
        #region Type enum

        public enum Type
        {
            Text = 0,
            Radio = 1,
            Date = 2,
            Real = 3,
            Combo = 4,
            CheckBox = 5,
            MultiColumnCombo = 6
        }

        #endregion

        public DataTable ColumnInfo;

        public DataTable DataSource;
        public string DataTextField = string.Empty;
        public string DataValueField = string.Empty;
        public string DataGroupField = string.Empty;
        public Type FilterType = Type.Text;
        public int MaxLength = 100;
        public string Name = string.Empty;
        public string Title = string.Empty;
        public string DBColumnName = string.Empty;
        public Dictionary&lt;string, string&gt; Values;
        public string DefaultValue = string.Empty;
        public string DBType = string.Empty;
        public bool IsTimezoneApplicable = false;
        public bool isGridSection = false;
        public string DynamicGridName = string.Empty;
        public string DynamicGridCaption = string.Empty;
        public string DynamicGridTableName = string.Empty;
        public string sectionCaption = string.Empty;
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[28,9,28,10,1],[29,13,29,51,1],[31,13,31,70,1],[33,13,33,25,1],[34,13,34,20,1],[34,22,34,39,1],[34,40,34,42,1],[34,43,34,50,1],[35,13,35,14,1],[36,17,36,45,1],[37,17,37,46,1],[38,17,38,62,1],[39,17,39,66,1],[40,17,40,96,1],[41,17,41,34,1],[43,17,43,42,1],[44,17,44,43,1],[47,25,47,49,1],[48,25,48,58,1],[49,25,49,75,1],[50,25,50,71,1],[51,25,51,73,1],[52,25,52,26,0],[53,29,53,61,0],[54,29,54,49,0],[55,25,55,26,0],[56,25,56,113,1],[57,25,57,46,1],[58,25,58,31,1],[60,25,60,53,0],[61,25,61,62,0],[62,25,62,79,0],[63,25,63,76,0],[64,25,64,117,0],[65,25,65,50,0],[66,25,66,31,0],[68,25,68,56,0],[69,25,69,70,0],[70,25,70,113,0],[71,25,71,46,0],[72,25,72,52,0],[73,25,73,122,0],[74,25,74,46,0],[75,25,75,31,0],[77,25,77,57,0],[78,25,78,71,0],[79,25,79,113,0],[80,25,80,74,0],[81,25,81,63,0],[82,25,82,32,0],[82,34,82,41,0],[82,42,82,44,0],[82,45,82,58,0],[83,29,83,77,0],[84,25,84,46,0],[85,25,85,31,0],[87,25,87,54,0],[88,25,88,71,0],[89,25,89,113,0],[90,25,90,60,0],[91,25,91,121,0],[92,25,92,26,0],[93,29,93,77,0],[94,33,94,95,0],[95,34,95,81,0],[96,33,96,96,0],[98,29,98,30,0],[99,33,99,76,0],[100,33,100,74,0],[101,29,101,30,0],[102,25,102,26,0],[103,30,103,71,0],[104,25,104,26,0],[105,29,105,90,0],[106,29,106,89,0],[107,25,107,26,0],[108,25,108,40,0],[109,25,109,51,0],[110,29,110,36,0],[110,38,110,45,0],[110,46,110,48,0],[110,49,110,62,0],[111,33,111,81,0],[113,25,113,46,0],[114,25,114,69,0],[115,25,115,31,0],[117,17,117,34,1],[118,17,118,50,1],[119,13,119,14,1],[120,13,120,82,1],[121,13,121,44,1],[122,9,122,10,1],[125,9,125,10,1],[126,13,126,46,1],[127,13,127,43,1],[128,13,128,51,1],[129,13,129,46,1],[130,13,130,48,1],[131,13,131,46,1],[132,13,132,51,1],[133,13,133,47,1],[134,13,134,60,1],[136,13,136,45,1],[137,13,137,42,1],[138,13,138,44,1],[139,13,139,48,1],[140,13,140,46,1],[141,9,141,10,1],[146,9,146,10,1],[147,13,147,79,1],[148,13,148,81,1],[150,13,150,30,1],[151,13,151,40,1],[152,13,152,36,1],[153,13,153,34,1],[154,13,154,46,1],[155,13,155,46,1],[156,13,156,38,1],[157,13,157,64,1],[158,13,158,34,1],[159,17,159,47,1],[160,9,160,10,1],[165,9,165,10,1],[166,13,166,144,1],[167,9,167,10,1],[178,9,178,10,0],[179,13,179,51,0],[180,13,180,70,0],[181,13,181,76,0],[182,13,182,51,0],[183,13,183,31,0],[184,13,184,55,0],[185,13,185,14,0],[186,17,186,55,0],[187,17,187,45,0],[188,17,188,38,0],[189,17,189,24,0],[189,26,189,43,0],[189,44,189,46,0],[189,47,189,59,0],[190,17,190,18,0],[191,21,191,46,0],[192,21,192,22,0],[193,25,193,49,0],[194,25,194,41,0],[195,21,195,22,0],[197,25,197,42,0],[199,21,199,53,0],[200,21,200,54,0],[201,21,201,69,0],[202,21,202,41,0],[203,25,203,75,0],[205,25,205,75,0],[207,21,207,60,0],[207,61,207,79,0],[208,21,208,103,0],[209,21,209,41,0],[211,21,211,65,0],[212,25,212,76,0],[213,26,213,70,0],[214,25,214,76,0],[215,21,215,47,0],[218,29,218,53,0],[219,29,219,62,0],[220,29,220,79,0],[221,29,221,75,0],[222,29,222,77,0],[223,29,223,30,0],[224,33,224,65,0],[225,33,225,53,0],[226,29,226,30,0],[227,29,227,117,0],[228,29,228,57,0],[229,29,229,61,0],[230,29,230,136,0],[231,29,231,54,0],[232,29,232,35,0],[234,29,234,57,0],[235,29,235,66,0],[236,29,236,83,0],[237,29,237,80,0],[238,29,238,121,0],[239,29,239,61,0],[240,29,240,65,0],[241,29,241,67,0],[242,29,242,141,0],[243,29,243,58,0],[244,29,244,35,0],[246,29,246,60,0],[247,29,247,99,0],[248,29,248,79,0],[249,29,249,74,0],[250,29,250,117,0],[252,29,253,92,0],[254,33,254,60,0],[256,29,256,30,0],[257,33,257,54,0],[258,33,258,60,0],[259,29,259,30,0],[260,29,260,57,0],[261,29,261,61,0],[263,29,263,126,0],[264,29,264,137,0],[265,29,265,54,0],[266,29,266,35,0],[268,29,268,61,0],[269,29,269,75,0],[270,29,270,117,0],[271,29,271,78,0],[272,29,272,67,0],[273,29,273,36,0],[273,38,273,45,0],[273,46,273,48,0],[273,49,273,62,0],[274,33,274,81,0],[275,29,275,57,0],[276,29,276,61,0],[277,29,277,137,0],[278,29,278,54,0],[279,29,279,35,0],[281,29,281,63,0],[282,29,282,58,0],[283,29,283,79,0],[284,29,284,75,0],[285,29,285,117,0],[286,29,286,64,0],[287,29,288,77,0],[289,29,289,30,0],[290,33,290,81,0],[291,37,291,99,0],[292,38,292,85,0],[293,37,293,100,0],[295,33,295,34,0],[296,37,296,80,0],[297,37,297,78,0],[298,33,298,34,0],[299,29,299,30,0],[300,34,300,75,0],[301,29,301,30,0],[302,33,302,94,0],[303,33,303,93,0],[304,29,304,30,0],[305,29,305,78,0],[306,33,306,76,0],[307,29,307,44,0],[308,29,308,55,0],[309,29,309,30,0],[310,33,310,40,0],[310,42,310,49,0],[310,50,310,52,0],[310,53,310,66,0],[311,33,311,34,0],[312,37,312,90,0],[313,41,313,89,0],[314,33,314,34,0],[315,29,315,30,0],[317,29,317,73,0],[318,29,318,57,0],[319,29,319,61,0],[320,29,320,137,0],[321,29,321,54,0],[322,29,322,35,0],[324,29,324,56,0],[325,29,325,79,0],[326,29,326,119,0],[327,29,327,64,0],[328,29,328,59,0],[329,29,329,63,0],[330,29,330,139,0],[331,29,331,56,0],[332,29,332,35,0],[334,29,334,102,0],[335,29,335,48,0],[336,29,336,30,0],[337,33,337,100,0],[338,33,339,54,0],[340,33,340,64,0],[341,33,341,71,0],[343,33,344,81,0],[345,33,345,34,0],[346,37,346,85,0],[347,41,347,109,0],[348,42,348,89,0],[349,41,349,110,0],[351,37,351,38,0],[352,41,352,87,0],[353,41,353,85,0],[354,37,354,38,0],[355,33,355,34,0],[356,38,356,79,0],[357,33,357,34,0],[358,37,358,101,0],[359,37,359,100,0],[360,33,360,34,0],[361,33,361,51,0],[362,33,362,63,0],[363,37,363,84,0],[365,33,365,64,0],[367,33,367,64,0],[368,33,368,68,0],[369,33,369,144,0],[370,33,370,61,0],[371,29,371,30,0],[373,29,373,30,0],[374,33,374,65,0],[375,33,375,86,0],[376,33,376,85,0],[377,33,378,54,0],[379,33,379,71,0],[380,33,381,81,0],[382,33,382,34,0],[383,37,383,85,0],[384,41,384,109,0],[385,42,385,89,0],[386,41,386,110,0],[388,37,388,38,0],[389,41,389,87,0],[390,41,390,85,0],[391,37,391,38,0],[392,33,392,34,0],[393,38,393,79,0],[394,33,394,34,0],[395,37,395,101,0],[396,37,396,100,0],[397,33,397,34,0],[398,33,398,51,0],[399,33,399,59,0],[400,37,400,44,0],[400,46,400,53,0],[400,54,400,56,0],[400,57,400,70,0],[401,41,401,92,0],[403,33,403,80,0],[404,33,404,64,0],[405,33,405,68,0],[406,33,406,144,0],[407,33,407,61,0],[408,29,408,30,0],[409,29,409,35,0],[411,21,411,42,0],[412,21,412,34,0],[412,35,412,50,0],[413,21,413,33,0],[414,17,414,18,0],[416,17,416,137,0],[417,17,417,18,0],[418,21,418,49,0],[419,21,419,72,0],[420,21,420,28,0],[420,30,420,37,0],[420,38,420,40,0],[420,41,420,47,0],[421,21,421,22,0],[422,25,422,45,0],[423,21,423,22,0],[424,21,424,78,0],[425,21,425,79,0],[426,21,426,48,0],[428,21,428,84,0],[429,21,429,85,0],[430,21,430,55,0],[431,25,431,96,0],[433,25,433,85,0],[435,21,435,68,0],[436,21,436,100,0],[437,21,437,54,0],[438,21,438,107,0],[439,21,439,68,0],[441,21,441,93,0],[442,21,442,55,0],[444,21,444,59,0],[445,21,445,69,0],[447,21,447,59,0],[448,21,448,61,0],[449,21,449,37,0],[450,21,450,50,0],[451,21,451,40,0],[452,21,452,45,0],[453,17,453,18,0],[455,17,455,18,0],[456,21,456,28,0],[456,30,456,37,0],[456,38,456,40,0],[456,41,456,47,0],[457,21,457,22,0],[458,25,458,49,0],[459,21,459,22,0],[460,17,460,18,0],[462,13,462,14,0],[463,13,463,82,0],[464,13,464,44,0],[465,9,465,10,0],[468,9,468,10,1],[469,13,469,51,1],[470,13,470,70,1],[472,13,472,57,1],[473,13,473,55,1],[474,13,474,14,1],[475,17,475,24,1],[475,26,475,43,1],[475,44,475,46,1],[475,47,475,59,1],[476,17,476,18,1],[477,21,477,46,1],[477,47,477,56,0],[478,21,478,49,1],[479,21,479,50,1],[480,21,480,66,1],[481,21,481,70,1],[482,21,482,100,1],[483,21,483,38,1],[485,21,485,46,1],[486,21,486,47,1],[489,29,489,53,1],[490,29,490,62,1],[491,29,491,79,1],[492,29,492,75,1],[493,29,493,77,1],[494,29,494,30,0],[495,33,495,65,0],[496,33,496,53,0],[497,29,497,30,0],[498,29,498,117,1],[499,29,499,57,1],[500,29,500,61,1],[501,29,501,50,1],[502,29,502,35,1],[504,29,504,57,1],[505,29,505,66,1],[506,29,506,83,1],[507,29,507,80,1],[508,29,508,121,1],[509,29,509,61,1],[510,29,510,65,1],[511,29,511,67,1],[512,29,512,54,1],[513,29,513,35,1],[515,29,515,60,1],[516,29,516,99,1],[517,29,517,79,1],[518,29,518,74,1],[519,29,519,117,1],[521,29,522,92,1],[523,33,523,60,0],[525,29,525,30,1],[526,33,526,54,1],[527,33,527,60,1],[528,29,528,30,1],[529,29,529,57,1],[530,29,530,61,1],[532,29,532,126,1],[534,29,534,50,1],[535,29,535,35,1],[537,29,537,61,1],[538,29,538,75,1],[539,29,539,117,1],[540,29,540,78,1],[541,29,541,67,1],[542,29,542,36,1],[542,38,542,45,1],[542,46,542,48,1],[542,49,542,62,1],[543,33,543,81,1],[544,29,544,57,1],[545,29,545,61,1],[546,29,546,50,1],[547,29,547,35,1],[549,29,549,63,1],[550,29,550,58,1],[551,29,551,79,1],[552,29,552,75,1],[553,29,553,117,1],[554,29,554,64,1],[555,29,556,77,1],[557,29,557,30,1],[558,33,558,81,1],[559,37,559,99,0],[560,38,560,85,1],[561,37,561,100,0],[563,33,563,34,1],[564,37,564,80,1],[565,37,565,78,1],[566,33,566,34,1],[567,29,567,30,1],[568,34,568,75,1],[569,29,569,30,0],[570,33,570,94,0],[571,33,571,93,0],[572,29,572,30,0],[573,29,573,78,1],[574,33,574,76,0],[575,29,575,44,1],[576,29,576,55,1],[577,29,577,30,1],[578,33,578,40,1],[578,42,578,49,1],[578,50,578,52,1],[578,53,578,66,1],[579,33,579,34,1],[580,37,580,90,1],[581,41,581,89,1],[582,33,582,34,1],[583,29,583,30,1],[585,29,585,73,1],[586,29,586,57,1],[587,29,587,61,1],[588,29,588,50,1],[589,29,589,35,1],[591,29,591,56,1],[592,29,592,79,1],[593,29,593,119,1],[594,29,594,64,1],[595,29,595,59,1],[596,29,596,63,1],[597,29,597,52,1],[598,29,598,35,1],[600,29,600,102,0],[601,29,601,48,0],[602,29,602,30,0],[603,33,603,100,0],[604,33,605,54,0],[606,33,606,64,0],[607,33,607,71,0],[609,33,610,81,0],[611,33,611,34,0],[612,37,612,85,0],[613,41,613,109,0],[614,42,614,89,0],[615,41,615,110,0],[617,37,617,38,0],[618,41,618,87,0],[619,41,619,85,0],[620,37,620,38,0],[621,33,621,34,0],[622,38,622,79,0],[623,33,623,34,0],[624,37,624,101,0],[625,37,625,100,0],[626,33,626,34,0],[627,33,627,51,0],[628,33,628,63,0],[629,37,629,84,0],[631,33,631,64,0],[633,33,633,64,0],[634,33,634,68,0],[635,33,635,57,0],[636,29,636,30,0],[638,29,638,30,0],[639,33,639,65,0],[640,33,640,86,0],[641,33,641,85,0],[642,33,643,54,0],[644,33,644,71,0],[645,33,646,81,0],[647,33,647,34,0],[648,37,648,85,0],[649,41,649,109,0],[650,42,650,89,0],[651,41,651,110,0],[653,37,653,38,0],[654,41,654,87,0],[655,41,655,85,0],[656,37,656,38,0],[657,33,657,34,0],[658,38,658,79,0],[659,33,659,34,0],[660,37,660,101,0],[661,37,661,100,0],[662,33,662,34,0],[663,33,663,51,0],[664,33,664,59,0],[665,37,665,44,0],[665,46,665,53,0],[665,54,665,56,0],[665,57,665,70,0],[666,41,666,92,0],[668,33,668,80,0],[669,33,669,64,0],[670,33,670,68,0],[671,33,671,57,0],[672,29,672,30,0],[673,29,673,35,0],[675,21,675,38,1],[676,21,676,54,1],[677,17,677,18,1],[678,13,678,14,1],[679,13,679,82,1],[680,13,680,44,1],[681,9,681,10,1],[693,9,693,10,1],[694,13,694,84,1],[696,13,696,54,1],[697,13,697,48,1],[699,13,699,20,1],[699,22,699,36,1],[699,37,699,39,1],[699,40,699,47,1],[700,13,700,14,1],[702,17,702,45,1],[703,17,703,44,1],[704,17,704,57,1],[705,21,705,30,0],[706,17,706,60,1],[707,17,707,18,1],[708,21,708,117,1],[709,21,709,34,1],[710,21,710,52,1],[711,25,711,59,1],[712,25,712,26,1],[713,29,713,86,1],[715,29,715,116,1],[717,29,717,148,1],[718,25,718,26,1],[719,17,719,18,1],[720,22,720,65,0],[721,17,721,18,0],[722,21,722,117,0],[723,21,723,35,0],[724,21,724,52,0],[725,25,725,59,0],[726,25,726,26,0],[727,29,727,86,0],[728,29,728,132,0],[729,25,729,26,0],[730,17,730,18,0],[731,22,731,66,0],[732,17,732,18,0],[733,21,733,116,0],[734,21,734,34,0],[735,21,735,75,0],[736,21,736,22,0],[737,25,737,97,0],[738,25,738,26,0],[739,29,739,109,0],[740,29,740,133,0],[741,25,741,26,0],[742,21,742,22,0],[743,17,743,18,0],[744,22,744,69,0],[745,17,745,18,0],[746,21,746,118,0],[747,21,747,36,0],[748,21,748,77,0],[749,21,749,22,0],[750,25,751,86,0],[752,29,754,80,0],[756,29,758,81,0],[759,25,759,129,0],[760,21,760,22,0],[761,17,761,18,0],[762,22,762,65,0],[763,17,763,18,0],[764,21,764,146,0],[765,21,765,33,0],[767,21,767,112,0],[768,21,768,22,0],[769,25,769,112,0],[771,25,771,144,0],[773,25,773,144,0],[774,21,774,22,0],[775,26,775,56,0],[776,21,776,22,0],[777,25,778,52,0],[779,25,779,37,0],[780,25,780,88,0],[781,25,781,26,0],[782,29,782,116,0],[784,29,784,148,0],[786,29,786,148,0],[787,25,787,26,0],[788,21,788,22,0],[789,17,789,18,0],[790,22,790,66,0],[791,17,791,18,0],[792,21,792,116,0],[793,21,793,34,0],[794,21,794,52,0],[795,21,795,22,0],[796,25,796,48,0],[797,25,797,26,0],[798,29,798,76,0],[799,29,799,30,0],[800,33,800,90,0],[801,33,801,137,0],[802,29,802,30,0],[803,25,803,26,0],[804,30,804,101,0],[805,25,805,26,0],[806,29,806,141,0],[807,29,807,49,0],[808,29,808,30,0],[809,33,809,110,0],[810,33,810,137,0],[811,29,811,30,0],[812,25,812,26,0],[813,21,813,22,0],[814,17,814,18,0],[815,13,815,14,1],[816,13,816,58,1],[817,17,817,29,0],[818,13,818,49,1],[819,13,819,46,1],[820,9,820,10,1],[833,9,833,10,1],[834,13,834,67,1],[835,13,835,55,1],[836,17,836,189,1],[838,17,838,231,0],[842,9,842,10,1],[845,9,845,10,1],[846,13,846,36,1],[847,13,847,14,1],[848,17,848,62,1],[850,17,850,24,1],[850,26,850,37,1],[850,38,850,40,1],[850,41,850,56,1],[851,17,851,18,1],[852,21,852,86,1],[854,21,854,72,1],[856,21,856,40,1],[857,21,857,22,1],[858,25,858,34,1],[859,25,859,26,1],[860,29,860,50,1],[861,25,861,26,1],[863,25,863,26,1],[864,29,864,82,1],[865,29,865,30,0],[866,33,866,75,0],[867,33,868,120,0],[869,37,869,94,0],[870,29,870,30,0],[872,29,872,84,1],[873,29,873,30,0],[875,33,875,89,0],[876,33,876,55,0],[877,29,877,30,0],[879,29,879,87,1],[880,29,880,30,0],[882,33,882,99,0],[883,33,883,34,0],[884,37,884,76,0],[885,33,885,34,0],[886,29,886,30,0],[888,29,888,87,1],[889,29,889,30,1],[891,33,891,96,1],[892,33,892,49,1],[893,33,893,34,0],[894,37,894,74,0],[895,37,895,79,0],[896,33,896,34,0],[897,29,897,30,1],[899,29,899,83,1],[900,29,900,30,1],[901,33,901,84,1],[902,29,902,30,1],[903,25,903,26,1],[904,21,904,22,1],[905,17,905,18,1],[906,13,906,14,1],[907,9,907,10,1],[910,9,910,10,1],[911,13,911,45,1],[912,13,912,52,1],[913,13,913,14,1],[914,17,914,66,1],[915,17,915,18,1],[916,21,916,72,1],[917,25,917,70,0],[918,21,918,113,1],[920,21,920,85,1],[921,26,921,35,1],[921,37,921,58,1],[921,60,921,63,1],[922,21,922,22,1],[923,25,923,59,1],[924,21,924,22,1],[925,17,925,18,1],[928,17,928,107,1],[929,17,929,48,1],[930,17,930,18,1],[931,21,931,55,1],[932,17,932,18,1],[934,17,934,24,1],[934,26,934,43,1],[934,44,934,46,1],[934,47,934,88,1],[935,17,935,18,1],[939,21,939,51,1],[940,21,940,22,1],[942,25,944,52,1],[946,25,946,69,1],[948,25,950,63,1],[951,25,951,26,1],[952,29,952,73,1],[954,25,954,26,1],[956,25,956,87,1],[957,25,957,26,1],[958,29,958,89,1],[959,25,959,26,1],[960,21,960,22,1],[961,17,961,18,1],[964,17,964,24,1],[964,26,964,37,1],[964,38,964,40,1],[964,41,964,56,1],[965,17,965,18,1],[966,21,969,72,1],[970,21,970,40,1],[971,21,971,22,1],[973,25,973,78,1],[975,25,975,36,1],[976,25,976,26,1],[977,29,977,52,1],[978,25,978,26,1],[980,25,980,26,1],[982,29,982,82,1],[983,29,983,30,1],[987,33,987,73,1],[988,33,988,34,1],[989,37,989,83,1],[990,37,990,109,1],[993,37,993,99,1],[994,37,994,38,1],[995,41,995,119,1],[996,37,996,38,1],[997,33,997,34,1],[999,33,1000,87,1],[1001,33,1001,34,1],[1002,37,1003,85,1],[1004,33,1004,34,1],[1007,33,1010,122,1],[1011,33,1011,34,1],[1012,37,1012,97,1],[1013,33,1013,34,1],[1014,29,1014,30,1],[1017,29,1017,84,1],[1018,29,1018,30,1],[1020,33,1020,89,1],[1021,33,1021,66,1],[1022,29,1022,30,1],[1025,29,1025,87,1],[1026,29,1026,30,1],[1028,33,1028,99,1],[1029,33,1029,34,1],[1030,37,1030,88,1],[1031,33,1031,34,1],[1032,29,1032,30,1],[1034,29,1034,87,1],[1035,29,1035,30,1],[1037,33,1037,96,1],[1038,33,1038,49,1],[1039,33,1039,34,1],[1041,37,1041,82,1],[1042,37,1042,79,1],[1043,37,1043,63,1],[1044,33,1044,34,1],[1045,29,1045,30,1],[1048,29,1048,83,1],[1049,29,1049,30,1],[1050,33,1050,80,1],[1051,29,1051,30,1],[1052,25,1052,26,1],[1053,21,1053,22,1],[1054,17,1054,18,1],[1055,17,1055,40,1],[1056,17,1056,18,1],[1057,21,1057,72,1],[1058,21,1058,100,1],[1059,17,1059,18,1],[1060,13,1060,14,1],[1061,9,1061,10,1],[1064,9,1064,10,1],[1065,13,1065,62,1],[1066,13,1066,31,1],[1069,21,1069,58,1],[1070,21,1070,27,1],[1072,21,1072,57,0],[1073,21,1073,27,0],[1075,21,1075,59,0],[1076,21,1076,27,0],[1078,21,1078,57,0],[1079,21,1079,27,0],[1081,13,1081,60,1],[1082,13,1082,58,1],[1083,13,1083,86,1],[1084,13,1084,14,1],[1085,17,1086,50,1],[1087,17,1088,74,1],[1089,13,1089,14,1],[1090,9,1090,10,1],[1093,9,1093,10,0],[1094,13,1094,36,0],[1095,13,1095,14,0],[1096,17,1096,70,0],[1098,17,1098,24,0],[1098,26,1098,37,0],[1098,38,1098,40,0],[1098,41,1098,56,0],[1099,17,1099,18,0],[1100,21,1100,86,0],[1102,21,1102,72,0],[1104,21,1104,40,0],[1105,21,1105,22,0],[1106,25,1106,34,0],[1107,25,1107,26,0],[1108,29,1108,50,0],[1109,25,1109,26,0],[1111,25,1111,26,0],[1112,29,1112,82,0],[1113,29,1113,30,0],[1114,33,1114,75,0],[1115,33,1116,120,0],[1117,37,1117,94,0],[1118,29,1118,30,0],[1120,29,1120,84,0],[1121,29,1121,30,0],[1123,33,1123,89,0],[1124,33,1124,55,0],[1125,29,1125,30,0],[1127,29,1127,87,0],[1128,29,1128,30,0],[1130,33,1130,95,0],[1131,33,1131,72,0],[1132,29,1132,30,0],[1134,29,1134,87,0],[1135,29,1135,30,0],[1137,33,1137,96,0],[1138,33,1138,49,0],[1139,33,1139,34,0],[1140,37,1140,74,0],[1141,37,1141,79,0],[1142,33,1142,34,0],[1143,29,1143,30,0],[1145,29,1145,83,0],[1146,29,1146,30,0],[1147,33,1147,84,0],[1148,29,1148,30,0],[1149,25,1149,26,0],[1150,21,1150,22,0],[1151,17,1151,18,0],[1152,13,1152,14,0],[1153,9,1153,10,0],[1156,9,1156,10,1],[1157,13,1157,61,1],[1159,13,1159,33,1],[1161,13,1161,50,1],[1162,13,1162,14,1],[1163,17,1163,49,1],[1164,13,1164,14,1],[1165,13,1165,20,1],[1165,22,1165,36,1],[1165,37,1165,39,1],[1165,40,1165,79,1],[1166,13,1166,14,1],[1168,17,1168,18,1],[1169,21,1169,75,1],[1172,21,1172,22,1],[1173,25,1173,32,1],[1173,34,1173,50,1],[1173,51,1173,53,1],[1173,54,1173,80,1],[1174,25,1174,26,1],[1176,29,1176,30,1],[1177,33,1177,55,1],[1178,33,1178,61,1],[1179,33,1179,34,1],[1181,37,1181,38,1],[1182,41,1184,69,1],[1185,41,1185,42,1],[1186,45,1187,104,1],[1188,45,1190,111,1],[1191,45,1191,46,1],[1192,49,1192,92,1],[1193,49,1193,79,1],[1194,53,1194,79,1],[1195,49,1195,86,1],[1196,53,1196,81,1],[1197,49,1198,90,1],[1199,53,1199,78,1],[1200,49,1200,55,1],[1202,41,1202,42,1],[1204,41,1204,58,1],[1205,37,1205,38,1],[1205,39,1205,58,1],[1206,33,1206,34,1],[1207,29,1207,30,1],[1208,29,1208,49,0],[1209,29,1209,30,0],[1210,33,1210,84,0],[1211,29,1211,30,0],[1212,25,1212,26,1],[1213,21,1213,22,1],[1214,21,1214,41,0],[1215,21,1215,22,0],[1216,25,1216,76,0],[1217,21,1217,22,0],[1218,17,1218,18,1],[1219,17,1219,55,0],[1220,17,1220,18,0],[1221,21,1221,72,0],[1222,17,1222,18,0],[1223,17,1223,37,0],[1224,17,1224,18,0],[1225,21,1225,72,0],[1226,17,1226,18,0],[1227,13,1227,14,1],[1228,13,1228,31,1],[1229,9,1229,10,1],[1252,9,1252,52,1],[1253,9,1253,53,1],[1254,9,1254,53,1],[1255,9,1255,44,1],[1256,9,1256,36,1],[1257,9,1257,43,1],[1258,9,1258,44,1],[1259,9,1259,51,1],[1261,9,1261,51,1],[1262,9,1262,45,1],[1263,9,1263,50,1],[1264,9,1264,43,1],[1265,9,1265,54,1],[1266,9,1266,57,1],[1267,9,1267,59,1],[1268,9,1268,53,1]]);
    </script>
  </body>
</html>