<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Spare Parts Issue\BL\SPRPISSBL.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using Aurigo.AMP3.CONTSPRPISSDAC;
using Aurigo.AMP3.DataAccess.Core;
using System.Collections.Generic;
using Aurigo.AMP3.ContractManager.BusinessLayer;
using Aurigo.AMP3.Common;

namespace Aurigo.AMP3.CONTSPRPISSBL
{
    public class SPRPISSBL
    {
        private static volatile Dictionary&lt;string, SPRPISSBL&gt; _Inst = null;
        private static readonly object _oSync = new object();
        private SPRPISSBL() { }
        public static SPRPISSBL Instance
        {
            get
            {
                lock (_oSync)
                {
                    if (_Inst == null) _Inst = new Dictionary&lt;string, SPRPISSBL&gt;();
                    string currentCompany = ConnectionHelper.GetCurrentCompany();
                    if (!_Inst.ContainsKey(currentCompany))
                        _Inst.Add(currentCompany, new SPRPISSBL());

                    return _Inst[currentCompany];
                }
            }
        }



        public int CreateSparePartIssue(int IssueID, DateTime ReqdDate, int ItemID, string Equipment,
                                        String EquipmentName, int SubItemID, string Activity, int CreatedBy,
                                        DateTime CreatedOn, int ContractID, string Location, string Status,
                                        string Remarks, int? WorkOrderID, string WorkOrderNo, string Contractor,
                                        int? HiredEquipmentID)
        {
            return SPRPISSDAC.Instance.CreateIssue(IssueID, ReqdDate, ItemID, Equipment, EquipmentName, SubItemID,
                                                   Activity, CreatedBy, CreatedOn, ContractID, Location, Status, Remarks,
                                                   WorkOrderID, WorkOrderNo, Contractor, HiredEquipmentID);
        }

        public int UpdateSPRStatusFromERPToBrix(int IssueID, Decimal IssuedQty, string ItemId)
        {
            return SPRPISSDAC.Instance.UpdateSPRStatusFromERPToBrix(IssueID, IssuedQty, ItemId);
        }

        public DataSet GetSparePartsIssue(int IssueID)
        {
            return SPRPISSDAC.Instance.GetIssue(IssueID);
        }

        public DataSet GetSparePartsData(int IssueID, int ContractId)
        {
            return SPRPISSDAC.Instance.GetSparePartsData(IssueID, ContractId);
        }

        public int UpdateSparePartsdata(int InstanceID, int IssueID, string ResItemID, string ParentResItemID,
                                        string Description, string Unit, Decimal Rate, Decimal Quantity,
                                        Decimal IssuedQuantity, int ResourceDetailID, string size, string color,
                                        string configuration)
        {
            return SPRPISSDAC.Instance.UpdateSparePartsdata(InstanceID, IssueID, ResItemID, ParentResItemID, Description,
                                                            Unit, Rate, Quantity, IssuedQuantity, ResourceDetailID, size,
                                                            color, configuration);
        }

        public DataSet GetSparePartsDetails(int ContractID)
        {
            return SPRPISSDAC.Instance.GetSparePartsDetails(ContractID);
        }

        public int DeleteIssue(int IssueID)
        {
            return SPRPISSDAC.Instance.DeleteIssue(IssueID);
        }

        public string ApproveIssue(int IssueID, int Update, char Type, int ApprovedBy, DateTime ApprovedDate)
        {
            return SPRPISSDAC.Instance.ApproveIssue(IssueID, Update, Type, ApprovedBy, ApprovedDate);
        }

        public DataTable GetSparePartIssuesToBeIssued(int? contractID)
        {
            return SPRPISSDAC.Instance.GetSparePartIssuesToBeIssued(contractID);
        }
    }

    [Context(Name = &quot;SPRPISS&quot;)]
    public class COBreadCrumb : ContractBreadCrumb
    {
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[13,9,13,76,0],[14,9,14,62,0],[15,9,15,28,0],[15,29,15,30,0],[15,31,15,32,0],[19,13,19,14,0],[20,17,20,30,0],[21,17,21,18,0],[22,21,22,39,0],[22,40,22,84,0],[23,21,23,82,0],[24,21,24,60,0],[25,25,25,68,0],[27,21,27,50,0],[29,13,29,14,0],[39,9,39,10,0],[40,13,42,108,0],[43,9,43,10,0],[46,9,46,10,0],[47,13,47,97,0],[48,9,48,10,0],[51,9,51,10,0],[52,13,52,58,0],[53,9,53,10,0],[56,9,56,10,0],[57,13,57,79,0],[58,9,58,10,0],[64,9,64,10,0],[65,13,67,83,0],[68,9,68,10,0],[71,9,71,10,0],[72,13,72,73,0],[73,9,73,10,0],[76,9,76,10,0],[77,13,77,61,0],[78,9,78,10,0],[81,9,81,10,0],[82,13,82,102,0],[83,9,83,10,0],[86,9,86,10,0],[87,13,87,81,0],[88,9,88,10,0]]);
    </script>
  </body>
</html>