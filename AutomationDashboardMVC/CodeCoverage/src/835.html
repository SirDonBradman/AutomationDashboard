<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\AbstractModels\ListModel.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Data.Linq;
using System.IO;
using System.Linq;
using System.Text;
using System.Web;
using System.Web.UI.HtmlControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.BL.AuditLog;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.BusinessLayer.XMLForm;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Infragistics.WebUI.UltraWebGrid.ExcelExport;
using Telerik.Web.UI;

namespace Aurigo.AMP3.Core.AbstractModels
{
    public abstract partial class ListModel : BrixModel
    {
        private bool? _updateTree;
        private List&lt;string&gt; _coreModuleComponents = null;

        //public HttpRequest Request;
        //public HttpResponse Response;
        public EISAdditionalInfo AdditionalInfo;

        //public UltraWebGrid brixGrid;
        public RadGrid mwGrid;

        public DataTable dtmwGridModified;
        public string _GridPrimaryKey;
        public Layout layout;
        public XMLListManagerModel listManagerModel;
        public Model model;
        public ModelType modelType;
        public static Dictionary&lt;string, Type&gt; contextDictionary;
        public Guid workflowGuid;
        public BrixFormModel xmlModel;

        protected String rejectNotes;

        private ArrayList timezoneColumns;

        public static readonly string[] workflowHiddenColumns = { &quot;WorkflowInstanceGuid&quot;, &quot;WF_FileID&quot;, &quot;WF_Status&quot;, &quot;buttons&quot; };

        protected List&lt;string&gt; CoreModuleComponents
        {
            get
            {
                if (_coreModuleComponents == null)
                    _coreModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);

                return _coreModuleComponents;
            }
        }

        public virtual string PageUniqueID
        {
            get { return string.Empty; }
        } // this is to identify a unique page - we are usign it for breadcrumb.

        public UltraWebGridExcelExporter BrixExcelExporter { get; set; }
        public string DateEditorControlID { get; set; }

        public virtual string GridPrimaryKey { get; set; }

        public virtual string NewURL
        {
            get { return string.Empty; }
        }

        public virtual string EditURL
        {
            get { return string.Empty; }
        }

        public virtual int MaxLen
        {
            get { return 128; }
        }

        public virtual string ViewURL
        {
            get { return string.Empty; }
        }

        public virtual string PreWorkFlowValidation(string action, object obj)
        {
            return string.Empty;
        }

        public virtual object PerformModuleSpecificTask(string context, Dictionary&lt;string, object&gt; parameteres)
        {
            return null;
        }

        public virtual bool IgnoreWorkflow
        {
            get
            {
                return false;
            }
        }

        public string ExportFileDownloadTokenID
        {
            get; set;
        }

        public string ExportFileDownloadTokenValue
        {
            get; set;
        }

        static ListModel()
        {
            if (contextDictionary == null)
            {
                contextDictionary = ModelHelper.GetModelObjects(typeof(ListModel), typeof(ItemListModel));
                //if (contextDictionary != null &amp;&amp; contextDictionary.Count &gt; 0)
                //{
                //    foreach (string key in contextDictionary.Keys)
                //    {
                //        Layout layout = new Layout();// { Name = key };
                //        layout.Name = key;
                //        ModelFactory.controller.Layouts.Add(layout);
                //    }
                //    ModelFactory.controller.LoadLayouts();
                //}
            }
        }

        /// &lt;summary&gt;
        /// Returns the Project Mode
        /// I --&gt; Integration Mode
        /// L --&gt; Live Mode
        /// &lt;/summary&gt;
        public string ProjectMode
        {
            get
            {
                return (CacheManager.Instance.IsIntegrated(Request[Constants.QRY_PROJECTID].ToInt32_2()) ? &quot;I&quot; : &quot;L&quot;);
            }
        }

        #region Properties

        public bool ShowMapView { get; set; }
        public ReportPageOrientation ReportPageOrientation { get; set; }
        public ReportPageSize ReportPageSize { get; set; }

        protected DataTable columnInfo;
        private bool enableAddMulti = true;
        private bool enableAddendumItemButtons = true;
        private bool enableDelete = true;
        protected bool enableEdit = true;
        private bool enableGridDblClick = true;
        private bool enableImport = true;
        protected bool enableNewCO = true;
        protected DataTable gridImageInfo;
        protected string header = string.Empty;
        protected ToolBar mainToolBar;

        public virtual string Header
        {
            get { return header; }
            set { header = value; }
        }

        public DataTable ColumnInfo
        {
            get { return columnInfo; }
        }

        public DataTable GridImageInfo
        {
            get { return gridImageInfo; }
        }

        public ToolBar MainToolBar
        {
            set { mainToolBar = value; }
            get { return mainToolBar; }
        }

        public bool EnableAddendumItemButtons
        {
            get { return enableAddendumItemButtons; }
            set { enableAddendumItemButtons = value; }
        }

        public bool EnableNewCO
        {
            get { return enableNewCO; }
            set { enableNewCO = value; }
        }

        public bool EnableEdit
        {
            get { return enableEdit; }
            set { enableEdit = value; }
        }

        public bool EnableDelete
        {
            get { return enableDelete; }
            set { enableDelete = value; }
        }

        public bool EnableAddMulti
        {
            get { return enableAddMulti; }
            set { enableAddMulti = value; }
        }

        public bool EnableImport
        {
            get { return enableImport; }
            set { enableImport = value; }
        }

        public bool EnableGridDblClick
        {
            get { return enableGridDblClick; }
            set { enableGridDblClick = value; }
        }

        public bool HasHierarchicalGrid { get; set; }

        public bool UpdateTree
        {
            get { return _updateTree.HasValue ? _updateTree.Value : false; }
            set { _updateTree = value; }
        }

        public bool FilterOrSortHasPendingOnUser { get; set; }

        /// &lt;summary&gt;
        /// Name of the Product Template used for the ASPX page
        /// &lt;/summary&gt;
        public virtual string ProductTemplateName { get; }

        #endregion Properties

        #region Abstract Methods

        /// &lt;summary&gt;
        /// This is the primary key used for sorting
        /// &lt;/summary&gt;
        public abstract string QueryStringName { get; }

        /// &lt;summary&gt;
        /// This will be the actual module id
        /// Eg PROJECT, LIBRARY
        /// &lt;/summary&gt;
        public abstract string ModuleId { get; }

        /// &lt;summary&gt;
        /// This will contain the context of the Module.
        /// Eg
        /// for Project it will be PROJECTS
        /// for LIBRARY the Context = &#39;CheckListID&#39;
        /// ie the sub module under library
        /// &lt;/summary&gt;
        public virtual string Context { get; set; }

        /// &lt;summary&gt;
        /// This can be used to determine where the page is being show.
        /// For example:-
        ///     if project page is being shown from Planning module when we counld put ContextIdentifier =&quot;PP&quot;
        /// &lt;/summary&gt;
        public virtual string ContextIdentifier { get; set; }

        public virtual string WorkflowModuleID
        {
            get { return null; }
        }

        public virtual int GetProjectIdFromInstanceId()
        {
            return (string.IsNullOrEmpty(Request.QueryString[&quot;PID&quot;]) ? 0 : Request.QueryString[&quot;PID&quot;].ToInt32_2());
        }

        public virtual string PIDKey
        {
            get { return &quot;PID&quot;; }
        }

        public virtual string ParentIDKey
        {
            get { return &quot;ParentID&quot;; }
        }

        public virtual bool RecreateMenuItemsOnMenuItemClick
        {
            get { return true; }
        }

        public abstract void SetUIDetails();

        public abstract void HandleNew();

        public abstract void HandleEdit();

        public virtual string GetEditPageURL(string pID, string parentID, string instanceID, string context)
        {
            string url = string.Empty;
            if (this.listManagerModel != null)
                url = this.listManagerModel.GetEditPageURL(pID, parentID, instanceID, context);
            if (!string.IsNullOrEmpty(url))
                return url;
            string lmid = &quot;0&quot;;
            // if projecid is 0 , assume it is land and parentid is parcel so get land id and put in lmid
            if (string.IsNullOrEmpty(pID) || pID == &quot;0&quot;)
            {
                object lmidObj =
                    ComponentHelper.Instance.ExecuteScalar(@&quot;if exists (select 1 from sys.tables where name = &#39;landmgtparcel&#39;)
                                        select masterid from landmgtparcel where parcelid = {0}&quot;, parentID);
                if (lmidObj != null)
                    lmid = lmidObj.ToString();
            }

            return
                string.Format(
                    &quot;~/Common/BrixForm.aspx?PID={0}&amp;ParentID={1}&amp;InstanceID={2}&amp;Context={3}&amp;Mode=Edit&amp;LMID={4}&quot;, pID,
                    parentID, instanceID, context, lmid);
        }

        public virtual string GetViewPageURL(string pID, string parentID, string instanceID, string context)
        {
            string url = string.Empty;
            if (this.listManagerModel != null)
                url = this.listManagerModel.GetViewPageURL(pID, parentID, instanceID, context);
            if (!string.IsNullOrEmpty(url))
                return url;
            string lmid = &quot;0&quot;;
            // if projecid is 0 , assume it is land and parentid is parcel so get land id and put in lmid
            if (string.IsNullOrEmpty(pID) || pID == &quot;0&quot;)
            {
                object lmidObj =
                    ComponentHelper.Instance.ExecuteScalar(@&quot;if exists (select 1 from sys.tables where name = &#39;landmgtparcel&#39;)
                                        select masterid from landmgtparcel where parcelid = {0}&quot;, parentID);
                if (lmidObj != null)
                    lmid = lmidObj.ToString();
            }

            return
                string.Format(
                    &quot;~/Common/BrixForm.aspx?PID={0}&amp;ParentID={1}&amp;InstanceID={2}&amp;Context={3}&amp;Mode=View&amp;LMID={4}&quot;, pID,
                    parentID, instanceID, context, lmid);
        }

        public abstract void HandleView();

        #endregion Abstract Methods

        #region For Mail Merge

        public virtual bool HasAttachments
        {
            get { return false; }
        }

        public virtual bool HasAnnotations
        {
            get { return false; }
        }

        private Dictionary&lt;int, int&gt; folderIDs = new Dictionary&lt;int, int&gt;();

        public virtual int FolderID(string pID, string parentID, string instanceID, string context)
        {
            if (!folderIDs.ContainsKey(parentID.ToInt32_2()))
                folderIDs.Add(parentID.ToInt32_2(),
                    DocumentManager.Instance.GetParentFolderIdForModule(instanceID, context,
                        xmlModel.form.ParentModuleID, parentID.ToInt32_2()));
            return folderIDs[parentID.ToInt32_2()];
        }

        #endregion For Mail Merge

        #region Virtual Methods

        public virtual string DefaultSortColumn
        {
            get { return QueryStringName; }
        }

        public virtual bool HasMultiApprove
        {
            get { return false; }
        }

        public string BackUrl { get; set; }

        public virtual string DocumentUrl
        {
            get
            {
                return
                    &quot;~/Modules/DOCMGMT/DocumentView.aspx?PID={0}&amp;parent={1}&amp;context={2}&amp;module={3}&quot;.Format2(
                        Request[&quot;PID&quot;], Request[&quot;ParentID&quot;], QueryStringName, ModuleId);
            }
        }

        public virtual OtherAction[] OtherActions
        {
            get
            {
                OtherAction[] list = { };
                return list;
            }
        }

        public virtual OtherAction[] TabDetails
        {
            get
            {
                OtherAction[] list = { };
                return list;
            }
        }

        public virtual string[] DataSourceFilters
        {
            get { return null; }
        }

        public virtual Dictionary&lt;string, string&gt; DataSourceFiltersWithValue
        {
            get { return null; }
        }

        public virtual CIDictionary HierarchicalGridColumnMapping
        {
            get { return null; }
        }

        public event EventHandler BindGridData;

        public void BindData()
        {
            if (BindGridData != null)
                BindGridData(this, new EventArgs());
        }

        public virtual int HandleDelete()
        {
            string table = layout.DataTable;
            if (string.IsNullOrEmpty(table))
            {
                table = ((ListModelContextAttribute)(GetType().GetCustomAttributes(typeof(ListModelContextAttribute), true)[0])).Table;
            }

            return CoreDatabaseHelper.GenericLibraryDelete(table, layout.PrimaryKeyName, GetSelectedIds().Trim(&#39;,&#39;));
        }

        public static string FilterIdsToDeleteBasedOnWFDefinitions(string formName, string pid, string parentid, string formInstanceIds = &quot;&quot;)
        {
            if (string.IsNullOrEmpty(formName))
                throw new InvalidDataException(&quot;Internal exception: Form name not specified&quot;);
            if (string.IsNullOrEmpty(formInstanceIds)) return &quot;&quot;;

            string finalIdsToDelete = &quot;&quot;;
            DataTable mappingDetails = BrixWorkflowManager.Instance.GetWorkflowMappingDetails(formInstanceIds, formName);

            if (mappingDetails.Rows.Count &lt; 1)
                return formInstanceIds;

            foreach (DataRow dr in mappingDetails.Rows)
            {
                string id = (null != dr[&quot;FormInstanceID&quot;]) ? dr[&quot;FormInstanceID&quot;].ToString() : &quot;&quot;;
                string currentState = (null != dr[&quot;CurrentStatus&quot;]) ? dr[&quot;CurrentStatus&quot;].ToString() : &quot;&quot;;
                string guid = (null != dr[&quot;WorkflowInstanceGuid&quot;]) ? dr[&quot;WorkflowInstanceGuid&quot;].ToString() : &quot;&quot;;
                string canDelete = (null != dr[&quot;CanDeleteInState&quot;]) ? dr[&quot;CanDeleteInState&quot;].ToString() : &quot;&quot;;

                if (DeleteValidation.AllowDelete.ToString() == canDelete)
                    finalIdsToDelete += id + &quot;,&quot;;
                else if (DeleteValidation.DonotDelete.ToString() == canDelete)
                    throw new Exception(&quot;The workflow status of one or more records does not permit delete operation.&quot;);
                else if (DeleteValidation.UseDeleteValidator.ToString() == canDelete)
                {
                    IStateMachineWFTemplate template = BrixWorkflowManager.Instance.GetWorkflow(guid);
                    if (null == template) continue;
                    IDeleteValidator dv = template.GetDeleteValidator();
                    string errors;
                    string validIds = dv.Validate(currentState, id, out errors);
                    if (!string.IsNullOrEmpty(validIds)) finalIdsToDelete += id + &quot;,&quot;;
                }
                else
                    finalIdsToDelete += id + &quot;,&quot;;
            }

            finalIdsToDelete = finalIdsToDelete.Trim(&#39;,&#39;);
            return finalIdsToDelete;
        }

        public static bool ForceDeleteWorkflowsForThisForm(string formInstanceIds = &quot;&quot;, string formName = &quot;&quot;)
        {
            if (string.IsNullOrEmpty(formName))
                throw new InvalidDataException(&quot;Internal exception: Form name not specified&quot;);

            if (string.IsNullOrEmpty(formInstanceIds))
                return true;

            bool bSuccess = false;
            try
            {
                BrixWorkflowManager.Instance.DeleteWorkflowInstances(formInstanceIds, formName);
                bSuccess = true;
            }
            catch (Exception)
            {
            }

            return bSuccess;
        }

        public virtual BrixFilter[] GetApplyFilterLabels()
        {
            return new BrixFilter[] { };
        }

        public virtual BrixFilter[] GetApplySearchFilterLabels()
        {
            return new BrixFilter[] { };
        }

        public virtual void ApplyToolBarCustomisation(ToolBar toolBarArg)
        {
        }

        public virtual void HandleGridRowInitialization&lt;T&gt;(object sender, T row)
        {
        }

        public virtual DataSet GetList(int pageSize, string sortOrder, string filter, ref int CurrentPage, out int count)
        {
            sortOrder = string.IsNullOrEmpty(sortOrder)
                ? DefaultSortColumn + (DefaultSortIndicator == GridSortOrder.Ascending ? &quot; ASC&quot; : &quot; DESC&quot;)
                : sortOrder;

            if (!string.IsNullOrEmpty(sortOrder) &amp;&amp; sortOrder.Contains(&quot;img_&quot;))
                sortOrder = sortOrder.Replace(&quot;img_&quot;, string.Empty);

            count = 0;
            var attribs = (ListModelContextAttribute[])
                GetType().GetCustomAttributes(typeof(ListModelContextAttribute), true);

            var dicDataSourceFilter = new Dictionary&lt;string, string&gt;();
            if (DataSourceFilters != null)
            {
                foreach (string key in DataSourceFilters)
                {
                    dicDataSourceFilter.Add(key,
                        string.IsNullOrEmpty(HttpContext.Current.Request[key])
                            ? null
                            : HttpContext.Current.Request[key]);
                }
            }

            if (DataSourceFiltersWithValue != null &amp;&amp; DataSourceFiltersWithValue.Count &gt; 0)
            {
                foreach (KeyValuePair&lt;string, string&gt; keyValuePair in DataSourceFiltersWithValue)
                {
                    if (!dicDataSourceFilter.ContainsKey(keyValuePair.Key))
                        dicDataSourceFilter.Add(keyValuePair.Key, keyValuePair.Value);
                }
            }

            DataSet dsReturn = null;
            if (attribs.Length &gt; 0)
            {
                dsReturn = CoreDatabaseHelper.GetODSData(attribs[0].Table, pageSize, sortOrder, filter,
                    filter.Trim().StartsWith(&quot;&lt;&quot;),
                    ref CurrentPage, out count, dicDataSourceFilter, null, null,
                    null, false, ModuleId, QueryStringName, null, pid: (Request[&quot;PID&quot;] ?? &quot;0&quot;).ToInt32_2(),
                    ignoreWorkflow: IgnoreWorkflow, filterOrSortHasPendingOnUser: FilterOrSortHasPendingOnUser);
            }

            return dsReturn;
        }

        public virtual List&lt;string&gt; GetMapDetails(string filter)
        {
            return new List&lt;string&gt;();
        }

        public virtual object GetList(int pageSize, string sortOrder, string filter, ref int CurrentPage, out int count, bool isLinq)
        {
            count = 0;
            return null;
        }

        public virtual int GetPageCount(string filter)
        {
            return 0;
        }

        public virtual bool CheckAccess(UserDetail ud)
        {
            //For a bidder role, no need to check permissions if the module is contbid.
            if (AMP3ApplicationSettings.Instance.IsContractorBidderUser &amp;&amp; ModuleId == Constants.MODID_CONTBID)
                return true;

            // Putting general logic to check list item access
            List&lt;string&gt; permissions = new List&lt;string&gt;();

            if (ModuleId.Equals(&quot;LIBRARY&quot;, StringComparison.InvariantCultureIgnoreCase) &amp;&amp; !CoreModuleComponents.Contains(&quot;ShowUnifiedLibraryPermissions&quot;))
                permissions = ModuleManager.Instance.GetPermissionByUserOrRole(Context, ud.UID, ud.RID, string.IsNullOrEmpty(Request[PIDKey]) ? 0 : Request[PIDKey].ToInt32_2());
            else
                permissions = ModuleManager.Instance.GetPermissionByUserOrRole(ModuleId, ud.UID, ud.RID, string.IsNullOrEmpty(Request[PIDKey]) ? 0 : Request[PIDKey].ToInt32_2());

            return permissions.Contains(Constants.MODFEAT_VISIBILITY);
        }

        public virtual int HandleActivate()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual int HandleLock()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual int HandleUnlock()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual MenuHandlerStatus HandleApprove()
        {
            return MenuHandlerStatus.GetErrorObject(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual MenuHandlerStatus HandleUnApprove()
        {
            return MenuHandlerStatus.GetErrorObject(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual void HandleReply()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual void HandleTransmittal()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual bool PerformServerValidation(string key)
        {
            return true;
        }

        public virtual string HandleMenuItem(string eventString)
        {
            isMenuClickHandled = false;
            return String.Empty;
        }

        //e.Item.OwnerTableView.Items[e.Item.RowIndex][&quot;ProjectId&quot;].Text
        public virtual void HandleGridDblClick&lt;T&gt;(T row)
        {
            if (DisplayView &amp;&amp; row is GridDataItem)
            {
                GridDataItem item = (row as GridDataItem);
                if (item.OwnerTableView.GetColumnSafe(&quot;Multi&quot;) != null)
                {
                    if (!item.OwnerTableView.GetColumnSafe(&quot;Multi&quot;).Display)
                        HandleView();
                    else if (!string.IsNullOrEmpty(GetSelectedItemsFromGrid()))
                        HandleView();
                }
                else
                {
                    HandleView();
                }
            }
        }

        //e.Item.OwnerTableView.Items[e.Item.RowIndex][&quot;ProjectId&quot;].Text
        public virtual void HandleGridDblClick(GridItem item)
        {
            //if (item is GridDataItem &amp;&amp; DisplayView)
            if (item is GridDataItem &amp;&amp; DisplayView)
            {
                //if (!(string.IsNullOrEmpty(item.OwnerTableView.GetColumnSafe(&quot;Multi&quot;).ToString2())))
                //{
                //    if (!item.OwnerTableView.GetColumnSafe(&quot;Multi&quot;).Display)
                //        HandleView();
                //    else if (string.IsNullOrEmpty(GetSelectedItemsFromGrid()))
                //        HandleView();
                //}
                //else
                //{
                HandleView();
                //}
            }
        }

        protected virtual void SetModuleLevelPermissions(List&lt;string&gt; permissions)
        {
        }

        public virtual void CustomizeToolBarMenu(ToolBar toolBar)
        {
            // Get the information from setUI and customise the toolbar
        }

        public virtual void CustomizeContextMenu(List&lt;BrixContextMenu&gt; cMenu)
        {
        }

        public virtual void SetUIDetails(ListModel listModel)
        {
        }

        public virtual void SetToolbarDetails()
        {
        }

        public virtual string HandleLogView(UltraWebGridExcelExporter UltraWebGridExcelExporter1)
        {
            return String.Empty;
        }

        public virtual void HandleListSave()
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        public virtual void SetHierarchicalGridProperties(DataSet sourceDataSet)
        {
        }

        public virtual void OnPreRender()
        {
        }

        public virtual void FormatColumns(RadGrid grid)
        {
        }

        public virtual string SetSessionValuesforReport()
        {
            return Request.Url.AbsoluteUri.Replace(&quot;Page.aspx&quot;, &quot;ReportPage.aspx&quot;);
        }

        public virtual bool IsSynchWithServer(int ID)
        {
            return false;
        }

        public virtual void OnInit()
        {
        }

        public virtual void Page_Load()
        {
        }

        public virtual GridSortOrder DefaultSortIndicator
        {
            get { return GridSortOrder.None; }
        }

        public virtual string GetStateBagKey(string context)
        {
            return context;
        }

        public virtual void HandleDataFromWorkFlow()
        {
        }

        public virtual void WorkflowActionComplete()
        {
            if (this.listManagerModel != null)
                listManagerModel.WorkflowActionComplete();
        }

        public virtual ArrayList TimezoneColumns
        {
            get
            {
                if (timezoneColumns == null)
                {
                    timezoneColumns = new ArrayList();
                    if (ColumnInfo != null)
                    {
                        foreach (DataRow row in ColumnInfo.Rows)
                        {
                            if (row[&quot;IsTimezoneApplicable&quot;] != null)

                                if (!string.IsNullOrEmpty(row[&quot;IsTimezoneApplicable&quot;].ToString2()))
                                {
                                    bool isTimezoneApplicable;
                                    bool.TryParse(row[&quot;IsTimezoneApplicable&quot;].ToString2(), out isTimezoneApplicable);
                                    if (isTimezoneApplicable)
                                    {
                                        timezoneColumns.Add(row[&quot;Key&quot;].ToString2());
                                    }
                                }
                        }
                    }
                }
                return timezoneColumns;
            }
        }

        public virtual void HandleSytemDataAfterWorkFlow(UserDetail ud)
        {
            try
            {
                if (this.xmlModel != null &amp;&amp; this.xmlModel.form != null)
                {
                    string[] ids = GetSelectedIds().Trim(&#39;,&#39;).Split(&#39;,&#39;);
                    foreach (var i in ids)
                    {
                        CoreDatabaseHelper.UpdateSytemDateAfterWorkflow(this.xmlModel.form.ActualTableNameInDatabase,
                            this.xmlModel.form.PrimaryKeyName, i.ToInt32_2(), ud.FirstName + (string.IsNullOrEmpty(ud.MiddleName) ? &quot;&quot; : &quot; &quot; + ud.MiddleName + &quot;&quot;) + (string.IsNullOrEmpty(ud.LastName) ? &quot;&quot; : &quot; &quot; + ud.LastName));
                    }
                }
            }
            catch (Exception)
            {
            }
        }

        #endregion Virtual Methods

        #region Utility functions

        protected string type;

        public object ListGrid
        {
            set { mwGrid = value as RadGrid; }
        }

        public String RejectNotes
        {
            get { return rejectNotes; }
            set { rejectNotes = value; }
        }

        public string GetFilterHtml(HtmlTable tblFilter)
        {
            return ModelHelper.GetFilterHtml(tblFilter, DisplayApplyFilter, GetApplyFilterLabels());
        }

        public string GetFilterXML(string prefix, HttpRequest request)
        {
            BrixFilter[] filters = GetApplyFilterLabels();
            return ModelHelper.GetFilterXML(prefix, request, filters, TimezoneColumns);
        }

        /// &lt;summary&gt;
        /// When passing date object to this method pass it in MWCulture string and if timezone is applicable indicate it so that conversion will happen when XML is getting translated to query
        /// Date passes to this method must be in MWDateTime and must not me in UTC.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sbFilterSearch&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;ftr&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isTimeZoneApplicable&quot;&gt;&lt;/param&gt;
        public void CreateFilterXml(StringBuilder sbFilterSearch, BrixFilter ftr, string value, string type, bool isTimeZoneApplicable = false)
        {
            ModelHelper.CreateFilterXml(sbFilterSearch, ftr, value, type, isTimeZoneApplicable);
        }

        public string GetSelectedIds()
        {
            //return Request.Form[&quot;hdnMulti&quot;] != String.Empty ? Request.Form[&quot;hdnMulti&quot;].Trim(&#39;,&#39;) : GetSelectedItemFromGrid();
            string selectedItems = GetSelectedItemsFromGrid();
            return (selectedItems != String.Empty) ? selectedItems : GetSelectedItemFromGrid();
        }

        protected string GetSelectedItemFromGrid()
        {
            string value = string.Empty;
            if (mwGrid.MasterTableView.GetSelectedItems() != null &amp;&amp;
                mwGrid.MasterTableView.GetSelectedItems().Count() &gt; 0)
            {
                value = mwGrid.MasterTableView.GetSelectedItems()[0][QueryStringName].Text;
            }
            return value;
        }

        protected string GetActiveItemFromGrid()
        {
            string activeItem = string.Empty;
            GridDataItem[] dataItems = mwGrid.MasterTableView.GetSelectedItems();
            if (dataItems != null &amp;&amp; dataItems.Count() &gt; 0 &amp;&amp;
                mwGrid.MasterTableView.GetColumnSafe(QueryStringName) != null)
            {
                activeItem = dataItems[0][QueryStringName].Text;
            }
            return activeItem;

            //return MWGrid.GetCellValue(mwGrid, QueryStringName);
        }

        protected string GetActiveItemValue(string key)
        {
            string activeItem = string.Empty;
            GridDataItem[] dataItems = mwGrid.MasterTableView.GetSelectedItems();
            if (dataItems != null &amp;&amp; dataItems.Count() &gt; 0 &amp;&amp; mwGrid.MasterTableView.GetColumnSafe(key) != null)
            {
                activeItem = dataItems[0][key].Text;
            }
            return activeItem;
        }

        protected string GetSelectedItemsFromGrid()
        {
            var ids = new StringBuilder();
            foreach (GridDataItem item in mwGrid.MasterTableView.GetSelectedItems())
            {
                if (item.OwnerTableView.GetColumnSafe(QueryStringName) != null)
                    ids.AppendFormat(&quot;{0},&quot;, item[QueryStringName].Text);
            }
            return ids.ToString().Trim(&#39;,&#39;);
        }

        protected string GetSelectedActiveItemFromGrid(string columnName)
        {
            foreach (GridDataItem item in mwGrid.MasterTableView.GetSelectedItems())
            {
                if (item.OwnerTableView.GetColumnSafe(columnName) != null)
                    return item[columnName].Text.ToString();
            }

            return string.Empty;
        }

        protected string GetSelectedItemsFromGrid(string columnName)
        {
            var ids = new StringBuilder();
            foreach (GridDataItem item in mwGrid.MasterTableView.GetSelectedItems())
            {
                if (item.OwnerTableView.GetColumnSafe(columnName) != null)
                    ids.AppendFormat(&quot;{0},&quot;, item[columnName].Text);
            }
            return ids.ToString().Trim(&#39;,&#39;);
        }

        public void ModifyColumnProperties(string key, bool hide,
            int? position, string format, string columnWidth, bool allowUpdate, bool isTimezoneApplicable = false)
        {
            ModelHelper.ModifyColumnProperties(key, hide, position, format, columnWidth, allowUpdate, columnInfo, isTimezoneApplicable);
        }

        public void ModifyColumnProperties(string key, bool hide,
            int? position, string format, string columnWidth, bool allowUpdate,
            string caption, bool isTimezoneApplicable = false)
        {
            ModelHelper.ModifyColumnProperties(key, hide, position, format, columnWidth, allowUpdate, caption,
                columnInfo, isTimezoneApplicable);
        }

        public void SetImageForRowValue(string key, string caption, string value, string image)
        {
            DataRow row = gridImageInfo.NewRow();

            row[&quot;Key&quot;] = key;
            row[&quot;Value&quot;] = value;
            row[&quot;ImageFile&quot;] = image;
            row[&quot;Caption&quot;] = caption;

            gridImageInfo.Rows.Add(row);
        }

        public virtual string HandleMenuItems(string eventString,
            UltraWebGridExcelExporter UltraWebGridExcelExporter1, string filter = &quot;&quot;)
        {
            //object bindingTable;
            string error = String.Empty;
            switch (eventString)
            {
                case &quot;Excel Export (xls)&quot;:
                case &quot;Excel Export (xlsx)&quot;:

                    DataSet ds = new DataSet();
                    int pageno = 0;
                    int count = 0;
                    DataTable bindingTable = GetList(Int32.MaxValue, null, filter, ref pageno, out count).Tables[0];

                    DataColumnCollection columns = bindingTable.Columns;

                    if (count &gt; 0)
                    {
                        if (Request.QueryString[&quot;context&quot;].Equals(&quot;LIBCONT&quot;))
                        {
                            if (columns.Contains(&quot;Zipcode&quot;))
                            {
                                bindingTable.Columns[&quot;Zipcode&quot;].ColumnName = GlobalizationUtility.SetResource(
                                    &quot;ZipCode&quot;, false);
                            }
                        }

                        bindingTable.TableName = Header;

                        ModifyColumnsForExport(bindingTable, Request.QueryString[&quot;context&quot;].ToString2());

                        DataTable dt = bindingTable.Copy();
                        ds.Tables.Add(dt);
                        string fileName = this.Header;
                        if (string.IsNullOrEmpty(fileName) || string.IsNullOrWhiteSpace(fileName))
                        {
                            fileName = Request[&quot;context&quot;] + &quot;data&quot;;
                        }
                        else
                        {
                            fileName = RemoveIllegalCharsFromFileName(fileName);
                        }
                        ds.DataSetName = fileName;

                        ExcelExportEntity excelExportEntity = new ExcelExportEntity(ds);
                        ExcelHelper.ExportToExcel(eventString, excelExportEntity);
                    }
                    else
                    {
                        error = &quot;No Records to Export&quot;;
                    }
                    break;

                default:
                    error = HandleMenuItem(eventString);
                    break;
            }
            return error;
        }

        public void SetColumnInfo()
        {
            ModelHelper.SetColumnAndImageInfo(ref columnInfo, ref gridImageInfo);
        }

        public static ListModel GetInstance(HttpRequest request, HttpResponse response, string additionalInfo)
        {
            string context = request.QueryString[&quot;context&quot;];
            //context = GetEISContextMap(context, eisContextList);

            return GetInstance(context, request, response, additionalInfo);
        }

        /// &lt;summary&gt;
        /// Set Grid column properties after the binding to the grid...
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;grid&quot;&gt;&lt;/param&gt;
        public virtual void SetGridColumnProperties&lt;T&gt;(T grid)
        {
        }

        public virtual DataTable SetInLineEditingDataColumn()
        {
            return null;
        }

        public static ListModel GetInstance(string context, HttpRequest request, HttpResponse response,
            string additionalInfo)
        {
            //if (!contextDictionary.ContainsKey(context))
            //{
            //    return null;
            //}

            //ListModel listModel = ModelFactory.GetListModelInstance(context, request, response, additionalInfo);
            if (!contextDictionary.ContainsKey(context)
                || contextDictionary[context] == null)
            {
                return null;
            }

            ListModel listModel = (ListModel)Activator.CreateInstance(contextDictionary[context]);
            if (null == listModel) return null;
            listModel.Request = request;
            listModel.Response = response;
            if (listModel.layout == null)
                listModel.layout = new Layout();
            var attribs =
                (ListModelContextAttribute[])
                    listModel.GetType().GetCustomAttributes(typeof(ListModelContextAttribute), true);
            if (attribs != null &amp;&amp; attribs.Length &gt; 0)
                listModel.layout.DataTable = attribs[0].Table;
            listModel.layout.Name = context;
            listModel.layout.ParentModuleID = listModel.ModuleId;
            if (listModel is IWorkflowEnabledList)
                listModel.layout.PrimaryKeyName = (listModel as IWorkflowEnabledList).ListPrimaryKey;
            else
                listModel.layout.PrimaryKeyName = string.IsNullOrEmpty(listModel.GridPrimaryKey)
                    ? listModel.QueryStringName
                    : listModel.GridPrimaryKey;

            LoadReports(context, listModel);

            listModel.SetColumnInfo();

            listModel.SetUIDetails();

            listModel.RemoveExternalColumns();

            // If any ERP is uploaded this AdditionalInfo will be used by the ERP
            // In case of AX this is Company Name
            // Without ERP this value will be null
            if (!string.IsNullOrEmpty(additionalInfo))
            {
                var objAdditionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                objAdditionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, additionalInfo);
                listModel.AdditionalInfo = objAdditionalInfo;
            }

            return listModel;
        }

        private void RemoveExternalColumns()
        {
            ModifyColumnProperties(&quot;rowguid&quot;, true, null, null, null, false);
        }

        public static ListModel GetXMLInstance(string context, HttpRequest request, HttpResponse response,
            string additionalInfo, Dictionary&lt;string, object&gt; requestParams = null)
        {
            //ListModel listModel = ModelFactory.GetXMLListModelInstance(context, request, response, additionalInfo, requestParams);
            string listModelContext = UIHelper.IsOfflineMode ? &quot;OFFLINEXMLFORMHANDLER&quot; : &quot;WEBXMLFORMHANDLER&quot;;
            if (!contextDictionary.ContainsKey(listModelContext) || contextDictionary[listModelContext] == null)
                return null;

            ListModel listModel = (ListModel)Activator.CreateInstance(contextDictionary[listModelContext]);
            BrixFormModel model;
            string moduleID = string.Empty;
            if (request == null || string.IsNullOrEmpty(request.QueryString[&quot;module&quot;]))
                moduleID = XMLForms.GetXMLFormModuleID(context);
            else
                moduleID = request.QueryString[&quot;module&quot;];
            try
            {
                model = new BrixFormModel(moduleID, context + &quot;.xml&quot;, XMLType.Form, request, response);
            }
            catch (Exception)
            {
                model = null;
            }
            if (model != null)
            {
                if (listModel.layout == null)
                    listModel.layout = new Layout();
                listModel.Request = request;
                listModel.Response = response;

                listModel.xmlModel = model;
                listModel.RequestParams = requestParams;
                model.RequestParams = requestParams;
                if (null != model.form) model.form.RequestParameters = requestParams;
                if (!string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp; !string.IsNullOrEmpty(model.form.ListManagerClass))
                {
                    listModel.listManagerModel = AMP3InterfaceFactory.GetInstance&lt;XMLListManagerModel&gt;(model.form.ManagerDLL, model.form.ListManagerClass);

                    listModel.listManagerModel.OnShowSuccess += listModel.ShowSuccess;
                    listModel.listManagerModel.OnShowError += listModel.ShowError;
                    listModel.listManagerModel.OnShowWarning += listModel.ShowWarning;
                    listModel.listManagerModel.OnShowInfo += listModel.ShowInfo;

                    listModel.listManagerModel.OnRegisterClientScriptBlock += listModel.RegisterClientScriptBlock;
                    listModel.listManagerModel.OnRegisterStartupScript += listModel.RegisterStartupScript;
                    listModel.listManagerModel.OnRegisterClientScriptInclude += listModel.RegisterClientScriptInclude;
                }

                LoadReports(context, listModel);
                listModel.modelType = ModelType.List;
                listModel.SetColumnInfo();
                listModel.SetUIDetails();

                // If any ERP is uploaded this AdditionalInfo will be used by the ERP
                // In case of AX this is Company Name
                // Without ERP this value will be null
                var objAdditionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                objAdditionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, additionalInfo);
                listModel.AdditionalInfo = objAdditionalInfo;

                return listModel;
            }
            else
                return null;
        }

        private static void LoadReports(string context, ListModel listModel)
        {
            //loading reports

            #region Loading List of Reports belonging to that Layout

            string connectionString = ConnectionHelper.GetConnectionString();

            using (DataContext dataContext = new DataContext(connectionString))
            {
                Table&lt;ReportDetails&gt; rptTable = dataContext.GetTable&lt;ReportDetails&gt;();
                IQueryable&lt;ReportDetails&gt; formReports =
                    from reports in rptTable
                    where reports.ParentContext.ToLower() == context.ToLower() &amp;&amp;
                          (reports.ModelType.ToLower().Contains(ModelType.List.ToString().ToLower()) ||
                           (reports.ModelType.ToLower().Contains(ModelType.ContextMenu.ToString().ToLower())))
                    select reports;
                listModel.layout.Reports.Clear();
                foreach (ReportDetails report in formReports)
                {
                    if (listModel.layout.Reports.Find(x =&gt; x.Context == report.Context) == null)
                        listModel.layout.Reports.Add(report);
                }
            }

            #endregion Loading List of Reports belonging to that Layout
        }

        public static ListModel GetXMLInstance(HttpRequest request, HttpResponse response, string additionalInfo,
            string xcontext = null, Dictionary&lt;string, object&gt; requestParams = null)
        {
            return GetXMLInstance(string.IsNullOrEmpty(xcontext) ? request.QueryString[&quot;xcontext&quot;] : xcontext, request,
                response, additionalInfo, requestParams);
        }

        protected static string GetEISContextMap(string context, List&lt;string&gt; contextList)
        {
            if (IntegrationConnectorManager.Instance.NoOfEISConnectorsAttached &gt; 0)
            {
                if (contextList.Contains(context))
                {
                    context = &quot;EIS&quot; + context;
                }
            }
            return context;
        }

        protected void ApplyModifiedColumnProperties(DataTable dt)
        {
            foreach (DataRow row in ColumnInfo.Rows)
            {
                bool hide;
                bool.TryParse(row[&quot;Hidden&quot;].ToString2(), out hide);
                if (hide &amp;&amp; dt.Columns.Contains(row[&quot;Key&quot;].ToString2()))
                    dt.Columns.Remove(row[&quot;Key&quot;].ToString2());
                else if (dt.Columns.Contains(row[&quot;Key&quot;].ToString2()) &amp;&amp; !string.IsNullOrEmpty(row[&quot;Caption&quot;].ToString2()))
                    dt.Columns[row[&quot;Key&quot;].ToString2()].Caption = row[&quot;Caption&quot;].ToString2();
            }
        }

        protected static void ApplyCustomizedColumnVisiblityCondition(DataTable dt, string context)
        {
            string scope = &quot;User&quot;;
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            Dictionary&lt;string, ColumnDetails&gt; cols = ColumnSettingManager.Instance.GetColumnSettings(context, ud.UID,
                ud.RID, ref scope);
            foreach (var col in cols)
            {
                if (!col.Value.IsVisible &amp;&amp; dt.Columns.Contains(col.Key))
                    dt.Columns.Remove(col.Key);
                else if (dt.Columns.Contains(col.Key))
                    dt.Columns[col.Key].Caption = col.Value.ColumnCaption;
            }
        }

        protected static void FormatWorkflowColumns(DataTable dt)
        {
            //Hide Columns
            foreach (string col in workflowHiddenColumns)
            {
                if (dt.Columns.Contains(col))
                    dt.Columns.Remove(col);
            }

            //Change Header Text
            if (dt.Columns.Contains(&quot;WF_FStatus&quot;))
                dt.Columns[&quot;WF_FStatus&quot;].Caption = &quot;Workflow Status&quot;;
            if (dt.Columns.Contains(&quot;WF_PendingOnRole&quot;))
                dt.Columns[&quot;WF_PendingOnRole&quot;].Caption = &quot;Pending On Role(s)&quot;;
            if (dt.Columns.Contains(&quot;WF_PendingOnUser&quot;))
                dt.Columns[&quot;WF_PendingOnUser&quot;].Caption = &quot;Pending On User(s)&quot;;
        }

        protected void ModifyColumnsForExport(DataTable dt, string context)
        {
            //Apply Modified Column properties
            ApplyModifiedColumnProperties(dt);

            //Apply Customized Column Visibility Settings
            ApplyCustomizedColumnVisiblityCondition(dt, context);

            //Format Workflow Columns
            FormatWorkflowColumns(dt);
        }

        public Dictionary&lt;string, string&gt; GetGridImageKeys()
        {
            var dic = new Dictionary&lt;string, string&gt;();
            foreach (DataRow row in gridImageInfo.Rows)
            {
                dic[row[&quot;Key&quot;].ToString()] = row[&quot;Caption&quot;].ToString();
            }

            return dic;
        }

        private bool CheckForAuditLogColumnsInFormModel(BrixFormModel xmlModel)
        {
            Dictionary&lt;string, List&lt;xControl&gt;&gt; returnTableAndColumnList = new Dictionary&lt;string, List&lt;xControl&gt;&gt;();

            if (xmlModel != null)
            {
                xmlModel.form?.ProcessAllContainersDeeply(
                    cont =&gt;
                    {
                        if (cont != null &amp;&amp; !(cont is Picker) &amp;&amp; !(cont is Form))
                        {
                            List&lt;xControl&gt; cols = cont.Controls?.Where(o =&gt; ((!string.IsNullOrWhiteSpace(o.Name) &amp;&amp; o.Name.Contains(&quot;AUR_ModifiedBy&quot;)) ||
                            (!string.IsNullOrWhiteSpace(o.Name) &amp;&amp; o.Name.Contains(&quot;AUR_ModifiedOn&quot;)))).ToList();

                            string parentContainerTableName = string.Empty;
                            if (cont is DataBaseContainer)
                            {
                                parentContainerTableName = ((DataBaseContainer)cont).ActualTableNameInDatabase;
                                if (cont is StaticGrid)
                                {
                                    cols = cols.Where(p =&gt; p.ParentObject.GetType() != typeof(Row)).ToList();
                                }
                                returnTableAndColumnList.Add(parentContainerTableName, cols);
                            }
                            else
                            {
                                if (!(cont is Row))
                                {
                                    DataBaseContainer parentCont = ControlContainer.GetParent&lt;DataBaseContainer&gt;(cont);
                                    parentContainerTableName = parentCont.ActualTableNameInDatabase;
                                    if (parentCont is Form || parentCont is StaticGrid)
                                    {
                                        List&lt;xControl&gt; existingcolumns = new List&lt;xControl&gt;();
                                        if (returnTableAndColumnList.ContainsKey(parentContainerTableName))
                                            returnTableAndColumnList[parentContainerTableName].AddRange(cols);
                                        else
                                            returnTableAndColumnList.Add(parentContainerTableName, cols);
                                    }
                                }
                            }
                        }
                    });
            }

            foreach (var item in returnTableAndColumnList)
            {
                if (item.Value.Count &lt; 2)
                    return false;
            }
            return true;
        }

        public void ValidateFormForAuditLog(BrixFormModel xmlModel)
        {
            if (xmlModel != null)
            {
                if (CheckForAuditLogColumnsInFormModel(xmlModel))
                {
                    string id = string.Empty;
                    id = GetSelectedIds();

                    if (id.Split(&#39;,&#39;).Length &gt; 1)
                        throw new ApplicationException(&quot;Multiple selection not allowed. Please select a record to view change log.&quot;);

                    if (string.IsNullOrWhiteSpace(id))
                        Response.Redirect(string.Format(&quot;~/Common/Auditlog.aspx?&quot;) + Request.QueryString);
                    else
                        Response.Redirect(string.Format(&quot;~/Common/Auditlog.aspx?ID={0}&amp;&quot;, id) + Request.QueryString);
                }
                else
                {
                    throw new ApplicationException(&quot;This form has not been configured for Audit Log. Please contact your Administrator.&quot;);
                }
            }
        }
        public string RemoveIllegalCharsFromFileName(string fileName)
        {
            try
            {
                string invalid = new string(Path.GetInvalidFileNameChars());

                foreach (char c in invalid)
                {
                    fileName = fileName.Replace(c.ToString(), &quot;&quot;);
                }
            }
            catch (Exception e)
            {
                Logging.Logger.Log(&quot;RemoveIllegalCharsFromFileName&quot;, e);
            }

            return fileName;
        }

        public bool IsAuditLogEnabled(string tableName)
        {
            bool isAuditLogEnabledForTable =
               ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMIsAuditLogEnabledInDB, null,
                   ConnectionHelper.GetCurrentDBDetails().DBName, tableName).ToBoolean2();
            bool hasAuditLogPermission = false;
            List&lt;string&gt; perms = AuditLogManager.GetAuditPermissions(ModuleId, UserDetail.GetCurrentUserDetail().UID,
                UserDetail.GetCurrentUserDetail().RID);
            hasAuditLogPermission = (perms.Contains(&quot;Audit&quot;) &amp;&amp; perms.Contains(&quot;View&quot;) &amp;&amp; perms.Contains(&quot;Visibility&quot;));

            return (isAuditLogEnabledForTable &amp;&amp; hasAuditLogPermission);
        }
    #endregion
}

[Serializable]
public enum ListMenuOperations
{
    Create,
    Update,
    Delete,
    View,
    Approve,
    Reject,
    BulkInsert,
    ImportItems,
    Reply,
    Transmittal
}

public enum ValidateSelection
{
    ZeroOrMoreItemsAndContainers = 0,
    OneItemOrContainer = 1,
    OneOrMoreItemsAndContainers = 2,
    OneItem = 3,
    OneOrMoreItems = 4,
    OneContainer = 5,
    OneOrMoreContainers = 6,
    OneSubItem = 7,
    OneOrMoreSubItems = 8,
    OneActivity = 9,
    None = 10,
    ZeroOrOneContainer = 11
}

public class OtherAction
{
    public bool AllowMultipleSelection;
    public string ID;
    public string ImagePath;
    public bool IsMainItem;
    public string Link;
    public string Name;
    public bool RequireSelection;
    public ValidateSelection ValidateSel = ValidateSelection.ZeroOrMoreItemsAndContainers;
}

/// &lt;summary&gt;
/// Class to be used by HandleXYZ method for their return type
/// &lt;/summary&gt;
public class MenuHandlerStatus
{
    public Resources.MessageResources.Enumerations.MessageType ReturnMessageType { get; private set; }

    public string Message { get; private set; }

    public object CustomData { get; private set; }

    /// &lt;summary&gt;
    ///
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;returnMessageType&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;customData&quot;&gt;&lt;/param&gt;
    public MenuHandlerStatus(Resources.MessageResources.Enumerations.MessageType returnMessageType, string message, object customData = null)
    {
        this.ReturnMessageType = returnMessageType;
        this.Message = message;
        this.CustomData = customData;
    }

    public override string ToString()
    {
        return this.Message;
    }

    public static MenuHandlerStatus GetErrorObject(string message = null, object customData = null)
    {
        if (message == null)
            message = &quot;The method or operation is not implemented.&quot;;

        return new MenuHandlerStatus(Resources.MessageResources.Enumerations.MessageType.ErrorMessage, message, customData);
    }

    public static MenuHandlerStatus GetErrorObject(Exception ex, object customData = null)
    {
        string message = string.Empty;
        if (ex == null)
            message = &quot;Exception was raised but no exception object passed&quot;;
        else
            message = ex.Message;

        return new MenuHandlerStatus(Resources.MessageResources.Enumerations.MessageType.ErrorMessage, message, customData);
    }

    public static MenuHandlerStatus GetSuccessObject(string message, object customData = null)
    {
        return new MenuHandlerStatus(Resources.MessageResources.Enumerations.MessageType.InfoMessage, message, customData);
    }

    public static MenuHandlerStatus GetWarningObject(string message = null, object customData = null)
    {
        return new MenuHandlerStatus(Resources.MessageResources.Enumerations.MessageType.WarningMessage, message, customData);
    }
}
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[36,9,36,59,1],[59,9,59,129,1],[64,13,64,14,0],[65,17,65,51,0],[66,21,66,111,0],[68,17,68,46,0],[69,13,69,14,0],[74,17,74,18,1],[74,19,74,39,1],[74,40,74,41,1],[77,62,77,66,1],[77,67,77,71,1],[78,45,78,49,0],[78,50,78,54,1],[80,48,80,52,1],[80,53,80,57,0],[84,17,84,18,1],[84,19,84,39,1],[84,40,84,41,1],[89,17,89,18,1],[89,19,89,39,1],[89,40,89,41,1],[94,17,94,18,1],[94,19,94,30,1],[94,31,94,32,1],[99,17,99,18,1],[99,19,99,39,1],[99,40,99,41,1],[103,9,103,10,1],[104,13,104,33,1],[105,9,105,10,1],[108,9,108,10,0],[109,13,109,25,0],[110,9,110,10,0],[115,13,115,14,1],[116,17,116,30,1],[117,13,117,14,1],[122,13,122,17,1],[122,18,122,22,1],[127,13,127,17,1],[127,18,127,22,1],[131,9,131,10,1],[132,13,132,43,1],[133,13,133,14,1],[134,17,134,107,1],[145,13,145,14,1],[146,9,146,10,1],[156,13,156,14,0],[157,17,157,119,0],[158,13,158,14,0],[163,35,163,39,1],[163,40,163,44,1],[164,62,164,66,0],[164,67,164,71,0],[165,48,165,52,0],[165,53,165,57,0],[168,9,168,44,1],[169,9,169,55,1],[170,9,170,42,1],[171,9,171,42,1],[172,9,172,48,1],[173,9,173,42,1],[174,9,174,43,1],[176,9,176,48,1],[181,17,181,18,1],[181,19,181,33,1],[181,34,181,35,1],[182,17,182,18,1],[182,19,182,34,1],[182,35,182,36,1],[187,17,187,18,1],[187,19,187,37,1],[187,38,187,39,1],[192,17,192,18,1],[192,19,192,40,1],[192,41,192,42,1],[197,17,197,18,1],[197,19,197,39,1],[197,40,197,41,1],[198,17,198,18,1],[198,19,198,38,1],[198,39,198,40,1],[203,17,203,18,1],[203,19,203,52,1],[203,53,203,54,1],[204,17,204,18,1],[204,19,204,53,1],[204,54,204,55,1],[209,17,209,18,1],[209,19,209,38,1],[209,39,209,40,1],[210,17,210,18,0],[210,19,210,39,0],[210,40,210,41,0],[215,17,215,18,1],[215,19,215,37,1],[215,38,215,39,1],[216,17,216,18,1],[216,19,216,38,1],[216,39,216,40,1],[221,17,221,18,1],[221,19,221,39,1],[221,40,221,41,1],[222,17,222,18,1],[222,19,222,40,1],[222,41,222,42,1],[227,17,227,18,1],[227,19,227,41,1],[227,42,227,43,1],[228,17,228,18,1],[228,19,228,42,1],[228,43,228,44,1],[233,17,233,18,1],[233,19,233,39,1],[233,40,233,41,1],[234,17,234,18,1],[234,19,234,40,1],[234,41,234,42,1],[239,17,239,18,1],[239,19,239,45,1],[239,46,239,47,1],[240,17,240,18,1],[240,19,240,46,1],[240,47,240,48,1],[243,43,243,47,1],[243,48,243,52,1],[247,17,247,18,0],[247,19,247,75,0],[247,76,247,77,0],[248,17,248,18,0],[248,19,248,39,0],[248,40,248,41,0],[251,52,251,56,1],[251,57,251,61,1],[256,53,256,57,0],[280,41,280,45,1],[280,46,280,50,1],[287,51,287,55,1],[287,56,287,60,1],[291,17,291,18,1],[291,19,291,31,1],[291,32,291,33,1],[295,9,295,10,1],[296,13,296,116,1],[297,9,297,10,1],[301,17,301,18,1],[301,19,301,32,1],[301,33,301,34,1],[306,17,306,18,0],[306,19,306,37,0],[306,38,306,39,0],[311,17,311,18,1],[311,19,311,31,1],[311,32,311,33,1],[321,9,321,10,1],[322,13,322,39,1],[323,13,323,47,1],[324,17,324,96,1],[325,13,325,44,1],[326,17,326,28,0],[327,13,327,31,1],[329,13,329,57,1],[330,13,330,14,1],[331,17,333,109,1],[334,17,334,37,1],[335,21,335,47,0],[336,13,336,14,1],[338,13,341,58,1],[342,9,342,10,1],[345,9,345,10,0],[346,13,346,39,0],[347,13,347,47,0],[348,17,348,96,0],[349,13,349,44,0],[350,17,350,28,0],[351,13,351,31,0],[353,13,353,57,0],[354,13,354,14,0],[355,17,357,109,0],[358,17,358,37,0],[359,21,359,47,0],[360,13,360,14,0],[362,13,365,58,0],[366,9,366,10,0],[376,17,376,18,1],[376,19,376,32,1],[376,33,376,34,1],[381,17,381,18,1],[381,19,381,32,1],[381,33,381,34,1],[384,9,384,77,1],[387,9,387,10,0],[388,13,388,62,0],[389,17,391,78,0],[392,13,392,52,0],[393,9,393,10,0],[401,17,401,18,1],[401,19,401,42,1],[401,43,401,44,1],[406,17,406,18,0],[406,19,406,32,0],[406,33,406,34,0],[409,33,409,37,0],[409,38,409,42,1],[414,13,414,14,0],[415,17,417,89,0],[418,13,418,14,0],[424,13,424,14,0],[425,17,425,42,0],[426,17,426,29,0],[427,13,427,14,0],[433,13,433,14,0],[434,17,434,42,0],[435,17,435,29,0],[436,13,436,14,0],[441,17,441,18,1],[441,19,441,31,1],[441,32,441,33,1],[446,17,446,18,1],[446,19,446,31,1],[446,32,446,33,1],[451,17,451,18,0],[451,19,451,31,0],[451,32,451,33,0],[457,9,457,10,1],[458,13,458,38,1],[459,17,459,53,1],[460,9,460,10,1],[463,9,463,10,0],[464,13,464,45,0],[465,13,465,45,0],[466,13,466,14,0],[467,17,467,136,0],[468,13,468,14,0],[470,13,470,118,0],[471,9,471,10,0],[474,9,474,10,1],[475,13,475,48,1],[476,17,476,95,0],[477,13,477,55,1],[477,56,477,66,1],[479,13,479,42,1],[480,13,480,122,1],[482,13,482,47,1],[483,17,483,40,1],[485,13,485,20,1],[485,22,485,32,1],[485,33,485,35,1],[485,36,485,55,1],[486,13,486,14,1],[487,17,487,99,1],[488,17,488,107,1],[489,17,489,113,1],[490,17,490,110,1],[492,17,492,74,1],[493,21,493,50,1],[494,22,494,79,1],[495,21,495,121,1],[496,22,496,86,1],[497,17,497,18,0],[498,21,498,103,0],[499,21,499,42,0],[499,43,499,52,0],[500,21,500,73,0],[502,21,502,81,0],[503,21,503,57,0],[503,58,503,87,0],[504,17,504,18,0],[506,21,506,50,1],[507,13,507,14,1],[509,13,509,59,1],[510,13,510,37,1],[511,9,511,10,1],[514,9,514,10,1],[515,13,515,48,1],[516,17,516,95,0],[518,13,518,55,1],[519,17,519,29,0],[521,13,521,35,1],[523,13,523,14,1],[524,17,524,97,1],[525,17,525,33,1],[526,13,526,14,1],[527,13,527,30,0],[528,13,528,14,0],[529,13,529,14,0],[531,13,531,29,1],[532,9,532,10,1],[535,9,535,10,1],[536,13,536,41,1],[537,9,537,10,1],[540,9,540,10,0],[541,13,541,41,0],[542,9,542,10,0],[545,9,545,10,1],[546,9,546,10,1],[549,9,549,10,1],[550,9,550,10,1],[553,9,553,10,1],[554,13,556,29,1],[558,13,558,80,1],[559,17,559,69,0],[561,13,561,23,1],[562,13,563,88,1],[565,13,565,72,1],[566,13,566,43,1],[567,13,567,14,0],[568,17,568,24,0],[568,26,568,36,0],[568,37,568,39,0],[568,40,568,57,0],[569,17,569,18,0],[570,21,573,65,0],[574,17,574,18,0],[575,13,575,14,0],[577,13,577,92,1],[578,13,578,14,1],[579,17,579,24,1],[579,26,579,67,1],[579,68,579,70,1],[579,71,579,97,1],[580,17,580,18,1],[581,21,581,76,1],[582,25,582,87,1],[583,17,583,18,1],[584,13,584,14,1],[586,13,586,37,1],[587,13,587,36,1],[588,13,588,14,1],[589,17,593,113,1],[594,13,594,14,1],[596,13,596,29,1],[597,9,597,10,1],[600,9,600,10,0],[601,13,601,39,0],[602,9,602,10,0],[605,9,605,10,0],[606,13,606,23,0],[607,13,607,25,0],[608,9,608,10,0],[611,9,611,10,0],[612,13,612,22,0],[613,9,613,10,0],[616,9,616,10,1],[618,13,618,112,1],[619,17,619,29,0],[622,13,622,59,1],[624,13,624,156,1],[625,17,625,178,0],[627,17,627,179,1],[629,13,629,71,1],[630,9,630,10,1],[633,9,633,10,0],[634,13,634,80,0],[638,9,638,10,0],[639,13,639,80,0],[643,9,643,10,0],[644,13,644,80,0],[648,9,648,10,0],[649,13,649,100,0],[650,9,650,10,0],[653,9,653,10,0],[654,13,654,100,0],[655,9,655,10,0],[658,9,658,10,0],[659,13,659,80,0],[663,9,663,10,0],[664,13,664,80,0],[668,9,668,10,0],[669,13,669,25,0],[670,9,670,10,0],[673,9,673,10,1],[674,13,674,40,1],[675,13,675,33,1],[676,9,676,10,1],[680,9,680,10,1],[681,13,681,52,1],[682,13,682,14,1],[683,17,683,59,1],[684,17,684,72,1],[685,17,685,18,1],[686,21,686,77,1],[687,25,687,38,1],[688,26,688,80,0],[689,25,689,38,0],[690,17,690,18,0],[692,17,692,18,0],[693,21,693,34,0],[694,17,694,18,0],[695,13,695,14,0],[696,9,696,10,0],[700,9,700,10,0],[702,13,702,53,0],[703,13,703,14,0],[713,17,713,30,0],[715,13,715,14,0],[716,9,716,10,0],[719,9,719,10,1],[720,9,720,10,1],[723,9,723,10,1],[725,9,725,10,1],[728,9,728,10,1],[729,9,729,10,1],[732,9,732,10,0],[733,9,733,10,0],[736,9,736,10,1],[737,9,737,10,1],[740,9,740,10,0],[741,13,741,33,0],[742,9,742,10,0],[745,9,745,10,0],[746,13,746,80,0],[750,9,750,10,1],[751,9,751,10,1],[754,9,754,10,1],[755,9,755,10,1],[758,9,758,10,1],[759,9,759,10,1],[762,9,762,10,0],[763,13,763,84,0],[764,9,764,10,0],[767,9,767,10,0],[768,13,768,26,0],[769,9,769,10,0],[772,9,772,10,1],[773,9,773,10,1],[776,9,776,10,1],[777,9,777,10,1],[781,17,781,18,1],[781,19,781,45,1],[781,46,781,47,1],[785,9,785,10,1],[786,13,786,28,1],[787,9,787,10,1],[790,9,790,10,1],[791,9,791,10,1],[794,9,794,10,1],[795,13,795,47,1],[796,17,796,59,1],[797,9,797,10,1],[802,13,802,14,1],[803,17,803,45,1],[804,17,804,18,1],[805,21,805,55,1],[806,21,806,44,1],[807,21,807,22,1],[808,25,808,32,1],[808,34,808,45,1],[808,46,808,48,1],[808,49,808,64,1],[809,25,809,26,1],[810,29,810,69,1],[812,33,812,100,1],[813,33,813,34,1],[815,37,815,118,1],[816,37,816,62,1],[817,37,817,38,1],[818,41,818,85,1],[819,37,819,38,1],[820,33,820,34,1],[821,25,821,26,1],[822,21,822,22,1],[823,17,823,18,1],[824,17,824,40,1],[825,13,825,14,1],[829,9,829,10,1],[831,13,831,14,1],[832,17,832,73,1],[833,17,833,18,1],[834,21,834,74,1],[835,21,835,28,1],[835,30,835,35,1],[835,36,835,38,1],[835,39,835,42,1],[836,21,836,22,1],[837,25,838,228,1],[839,21,839,22,1],[840,17,840,18,1],[841,13,841,14,1],[842,13,842,30,0],[843,13,843,14,0],[844,13,844,14,0],[845,9,845,10,1],[855,17,855,18,1],[855,19,855,45,1],[855,46,855,47,1],[860,17,860,18,0],[860,19,860,38,0],[860,39,860,40,0],[861,17,861,18,0],[861,19,861,39,0],[861,40,861,41,0],[865,9,865,10,1],[866,13,866,101,1],[867,9,867,10,1],[870,9,870,10,0],[871,13,871,59,0],[872,13,872,88,0],[873,9,873,10,0],[885,9,885,10,0],[886,13,886,97,0],[887,9,887,10,0],[890,9,890,10,1],[892,13,892,63,1],[893,13,893,96,1],[894,9,894,10,1],[897,9,897,10,1],[898,13,898,41,1],[899,13,900,71,1],[901,13,901,14,1],[902,17,902,92,1],[903,13,903,14,1],[904,13,904,26,1],[905,9,905,10,1],[908,9,908,10,1],[909,13,909,46,1],[910,13,910,82,1],[911,13,912,79,1],[913,13,913,14,1],[914,17,914,65,1],[915,13,915,14,1],[916,13,916,31,1],[919,9,919,10,1],[922,9,922,10,1],[923,13,923,46,1],[924,13,924,82,1],[925,13,925,113,1],[926,13,926,14,1],[927,17,927,53,1],[928,13,928,14,1],[929,13,929,31,1],[930,9,930,10,1],[933,9,933,10,1],[934,13,934,43,1],[935,13,935,20,1],[935,22,935,39,1],[935,40,935,42,1],[935,43,935,84,1],[936,13,936,14,1],[937,17,937,80,1],[938,21,938,74,1],[939,13,939,14,1],[940,13,940,45,1],[941,9,941,10,1],[944,9,944,10,0],[945,13,945,20,0],[945,22,945,39,0],[945,40,945,42,0],[945,43,945,84,0],[946,13,946,14,0],[947,17,947,75,0],[948,21,948,61,0],[949,13,949,14,0],[951,13,951,33,0],[952,9,952,10,0],[955,9,955,10,0],[956,13,956,43,0],[957,13,957,20,0],[957,22,957,39,0],[957,40,957,42,0],[957,43,957,84,0],[958,13,958,14,0],[959,17,959,75,0],[960,21,960,69,0],[961,13,961,14,0],[962,13,962,45,0],[963,9,963,10,0],[967,9,967,10,1],[968,13,968,137,1],[969,9,969,10,1],[974,9,974,10,1],[975,13,976,51,1],[977,9,977,10,1],[980,9,980,10,1],[981,13,981,50,1],[983,13,983,30,1],[984,13,984,34,1],[985,13,985,38,1],[986,13,986,38,1],[988,13,988,41,1],[989,9,989,10,1],[993,9,993,10,0],[995,13,995,41,0],[996,13,996,33,0],[1001,21,1001,48,0],[1002,21,1002,36,0],[1003,21,1003,35,0],[1004,21,1004,117,0],[1006,21,1006,73,0],[1008,21,1008,35,0],[1009,21,1009,22,0],[1010,25,1010,78,0],[1011,25,1011,26,0],[1012,29,1012,61,0],[1013,29,1013,30,0],[1014,33,1015,55,0],[1016,29,1016,30,0],[1017,25,1017,26,0],[1019,25,1019,57,0],[1021,25,1021,106,0],[1023,25,1023,60,0],[1024,25,1024,43,0],[1025,25,1025,55,0],[1026,25,1026,99,0],[1027,25,1027,26,0],[1028,29,1028,68,0],[1029,25,1029,26,0],[1031,25,1031,26,0],[1032,29,1032,81,0],[1033,25,1033,26,0],[1034,25,1034,51,0],[1036,25,1036,89,0],[1037,25,1037,83,0],[1038,21,1038,22,0],[1040,21,1040,22,0],[1041,25,1041,56,0],[1042,21,1042,22,0],[1043,21,1043,27,0],[1046,21,1046,57,0],[1047,21,1047,27,0],[1049,13,1049,26,0],[1050,9,1050,10,0],[1053,9,1053,10,1],[1054,13,1054,82,1],[1055,9,1055,10,1],[1058,9,1058,10,1],[1059,13,1059,61,1],[1062,13,1062,76,1],[1063,9,1063,10,1],[1070,9,1070,10,1],[1071,9,1071,10,1],[1074,9,1074,10,0],[1075,13,1075,25,0],[1076,9,1076,10,0],[1080,9,1080,10,1],[1087,13,1088,55,1],[1089,13,1089,14,0],[1090,17,1090,29,0],[1093,13,1093,99,1],[1094,13,1094,35,1],[1094,36,1094,48,0],[1095,13,1095,41,1],[1096,13,1096,43,1],[1097,13,1097,42,1],[1098,17,1098,49,1],[1099,13,1101,102,1],[1102,13,1102,55,1],[1103,17,1103,63,1],[1104,13,1104,45,1],[1105,13,1105,66,1],[1106,13,1106,51,1],[1107,17,1107,102,1],[1109,17,1111,48,1],[1113,13,1113,45,1],[1115,13,1115,39,1],[1117,13,1117,38,1],[1119,13,1119,47,1],[1124,13,1124,55,1],[1125,13,1125,14,0],[1126,17,1126,81,0],[1127,17,1127,90,0],[1128,17,1128,62,0],[1129,13,1129,14,0],[1131,13,1131,30,1],[1132,9,1132,10,1],[1135,9,1135,10,1],[1136,13,1136,78,1],[1137,9,1137,10,1],[1141,9,1141,10,1],[1143,13,1143,110,1],[1144,13,1144,113,1],[1145,17,1145,29,0],[1147,13,1147,108,1],[1149,13,1149,44,1],[1150,13,1150,88,1],[1151,17,1151,65,1],[1153,17,1153,58,1],[1155,13,1155,14,1],[1156,17,1156,104,1],[1157,13,1157,14,1],[1158,13,1158,30,0],[1159,13,1159,14,0],[1160,17,1160,30,0],[1161,13,1161,14,0],[1162,13,1162,31,1],[1163,13,1163,14,1],[1164,17,1164,46,1],[1165,21,1165,53,1],[1166,17,1166,45,1],[1167,17,1167,47,1],[1169,17,1169,44,1],[1170,17,1170,57,1],[1171,17,1171,53,1],[1172,17,1172,40,1],[1172,41,1172,86,1],[1173,17,1173,120,1],[1174,17,1174,18,1],[1175,21,1175,156,1],[1177,21,1177,87,1],[1178,21,1178,83,1],[1179,21,1179,87,1],[1180,21,1180,81,1],[1182,21,1182,115,1],[1183,21,1183,107,1],[1184,21,1184,119,1],[1185,17,1185,18,1],[1187,17,1187,49,1],[1188,17,1188,54,1],[1189,17,1189,43,1],[1190,17,1190,42,1],[1195,17,1195,81,1],[1196,17,1196,90,1],[1197,17,1197,62,1],[1199,17,1199,34,1],[1202,17,1202,29,0],[1203,9,1203,10,1],[1206,9,1206,10,1],[1211,13,1211,78,1],[1213,20,1213,79,1],[1214,13,1214,14,1],[1215,17,1215,87,1],[1216,17,1221,36,1],[1222,17,1222,50,1],[1223,17,1223,24,1],[1223,26,1223,46,1],[1223,47,1223,49,1],[1223,50,1223,61,1],[1224,17,1224,18,1],[1225,21,1225,60,1],[1225,60,1225,87,0],[1225,87,1225,97,1],[1225,21,1225,97,1],[1226,25,1226,62,1],[1227,17,1227,18,1],[1228,13,1228,14,1],[1231,9,1231,10,1],[1235,9,1235,10,1],[1236,13,1237,58,1],[1238,9,1238,10,1],[1241,9,1241,10,1],[1242,13,1242,84,1],[1243,13,1243,14,0],[1244,17,1244,51,0],[1245,17,1245,18,0],[1246,21,1246,47,0],[1247,17,1247,18,0],[1248,13,1248,14,0],[1249,13,1249,28,1],[1250,9,1250,10,1],[1253,9,1253,10,1],[1254,13,1254,20,1],[1254,22,1254,33,1],[1254,34,1254,36,1],[1254,37,1254,52,1],[1255,13,1255,14,1],[1257,17,1257,68,1],[1258,17,1258,73,1],[1259,21,1259,63,1],[1260,22,1260,123,1],[1261,21,1261,93,1],[1262,13,1262,14,1],[1263,9,1263,10,1],[1266,9,1266,10,1],[1267,13,1267,35,1],[1268,13,1268,63,1],[1269,13,1270,36,1],[1271,13,1271,20,1],[1271,22,1271,29,0],[1271,30,1271,32,1],[1271,33,1271,37,1],[1272,13,1272,14,0],[1273,17,1273,74,0],[1274,21,1274,48,0],[1275,22,1275,55,0],[1276,21,1276,75,0],[1277,13,1277,14,0],[1278,9,1278,10,1],[1281,9,1281,10,1],[1283,13,1283,20,1],[1283,22,1283,32,1],[1283,33,1283,35,1],[1283,36,1283,57,1],[1284,13,1284,14,1],[1285,17,1285,46,1],[1286,21,1286,44,1],[1287,13,1287,14,1],[1290,13,1290,51,1],[1291,17,1291,70,1],[1292,13,1292,57,1],[1293,17,1293,79,1],[1294,13,1294,57,1],[1295,17,1295,79,1],[1296,9,1296,10,1],[1299,9,1299,10,1],[1301,13,1301,47,1],[1304,13,1304,66,1],[1307,13,1307,39,1],[1308,9,1308,10,1],[1311,9,1311,10,0],[1312,13,1312,56,0],[1313,13,1313,20,0],[1313,22,1313,33,0],[1313,34,1313,36,0],[1313,37,1313,55,0],[1314,13,1314,14,0],[1315,17,1315,72,0],[1316,13,1316,14,0],[1318,13,1318,24,0],[1319,9,1319,10,0],[1322,9,1322,10,0],[1323,13,1323,116,0],[1325,13,1325,34,0],[1326,13,1326,14,0],[1327,17,1329,21,0],[1329,21,1329,22,0],[1329,22,1330,25,0],[1330,25,1330,82,0],[1330,82,1331,25,0],[1331,25,1331,26,0],[1331,26,1332,29,0],[1332,29,1332,77,0],[1332,77,1333,103,0],[1333,103,1333,114,0],[1332,29,1333,114,0],[1333,114,1335,29,0],[1335,29,1335,76,0],[1335,76,1336,29,0],[1336,29,1336,59,0],[1336,59,1337,29,0],[1337,29,1337,30,0],[1337,30,1338,33,0],[1338,33,1338,112,0],[1338,112,1339,33,0],[1339,33,1339,56,0],[1339,56,1340,33,0],[1340,33,1340,34,0],[1340,34,1341,37,0],[1341,37,1341,60,0],[1341,60,1341,99,0],[1341,99,1341,110,0],[1341,37,1341,110,0],[1341,110,1342,33,0],[1342,33,1342,34,0],[1342,34,1343,33,0],[1343,33,1343,94,0],[1343,94,1344,29,0],[1344,29,1344,30,0],[1344,30,1346,29,0],[1346,29,1346,30,0],[1346,30,1347,33,0],[1347,33,1347,52,0],[1347,52,1348,33,0],[1348,33,1348,34,0],[1348,34,1349,37,0],[1349,37,1349,120,0],[1349,120,1350,37,0],[1350,37,1350,101,0],[1350,101,1351,37,0],[1351,37,1351,88,0],[1351,88,1352,37,0],[1352,37,1352,38,0],[1352,38,1353,41,0],[1353,41,1353,95,0],[1353,95,1354,41,0],[1354,41,1354,108,0],[1354,108,1355,45,0],[1355,45,1355,111,0],[1355,111,1357,45,0],[1357,45,1357,106,0],[1357,106,1358,37,0],[1358,37,1358,38,0],[1358,38,1359,33,0],[1359,33,1359,34,0],[1359,34,1360,29,0],[1360,29,1360,30,0],[1360,30,1361,25,0],[1361,25,1361,26,0],[1361,26,1362,21,0],[1362,21,1362,22,0],[1362,22,1362,24,0],[1327,17,1362,24,0],[1363,13,1363,14,0],[1365,13,1365,20,0],[1365,22,1365,30,0],[1365,31,1365,33,0],[1365,34,1365,58,0],[1366,13,1366,14,0],[1367,17,1367,42,0],[1368,21,1368,34,0],[1369,13,1369,14,0],[1370,13,1370,25,0],[1371,9,1371,10,0],[1374,9,1374,10,0],[1375,13,1375,34,0],[1376,13,1376,14,0],[1377,17,1377,66,0],[1378,17,1378,18,0],[1379,21,1379,46,0],[1380,21,1380,43,0],[1382,21,1382,50,0],[1383,25,1383,134,0],[1385,21,1385,55,0],[1386,25,1386,107,0],[1388,25,1388,118,0],[1389,17,1389,18,0],[1391,17,1391,18,0],[1392,21,1392,139,0],[1394,13,1394,14,0],[1395,9,1395,10,0],[1397,9,1397,10,0],[1399,13,1399,14,0],[1400,17,1400,77,0],[1402,17,1402,24,0],[1402,26,1402,32,0],[1402,33,1402,35,0],[1402,36,1402,43,0],[1403,17,1403,18,0],[1404,21,1404,67,0],[1405,17,1405,18,0],[1406,13,1406,14,0],[1407,13,1407,32,0],[1408,13,1408,14,0],[1409,17,1409,73,0],[1410,13,1410,14,0],[1412,13,1412,29,0],[1413,9,1413,10,0],[1416,9,1416,10,0],[1417,13,1419,91,0],[1420,13,1420,48,0],[1421,13,1422,56,0],[1423,13,1423,121,0],[1425,13,1425,73,0],[1426,9,1426,10,0],[1470,5,1470,91,1],[1478,84,1478,88,1],[1478,89,1478,101,1],[1480,29,1480,33,0],[1480,34,1480,46,1],[1482,32,1482,36,0],[1482,37,1482,49,1],[1490,5,1490,142,1],[1491,5,1491,6,1],[1492,9,1492,52,1],[1493,9,1493,32,1],[1494,9,1494,38,1],[1495,5,1495,6,1],[1498,5,1498,6,0],[1499,9,1499,29,0],[1500,5,1500,6,0],[1503,5,1503,6,0],[1504,9,1504,29,0],[1505,13,1505,69,0],[1507,9,1507,125,0],[1508,5,1508,6,0],[1511,5,1511,6,0],[1512,9,1512,39,0],[1513,9,1513,24,0],[1514,13,1514,77,0],[1516,13,1516,34,0],[1518,9,1518,125,0],[1519,5,1519,6,0],[1522,5,1522,6,1],[1523,9,1523,124,1],[1524,5,1524,6,1],[1527,5,1527,6,0],[1528,9,1528,127,0],[1529,5,1529,6,0]]);
    </script>
  </body>
</html>