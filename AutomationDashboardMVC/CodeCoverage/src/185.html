<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Measurement Book\Attachments.ascx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Web.UI;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;

namespace Aurigo.Brix.Construction.ContractManager.MBUI
{
    public partial class Attachments : UserControl
    {
        public bool ReadOnly
        {
            get { return ((AttachmentsControl)attachments).ReadOnly; }
            set { ((AttachmentsControl)attachments).ReadOnly = value; }
        }

        public string GUID
        {
            get { return (ViewState[&quot;GUID&quot;] ?? &quot;&quot;).ToString(); }
            set { ViewState[&quot;GUID&quot;] = value; }
        }

        private string ModuleID
        {
            get { return &quot;MBIITMS&quot;; }
        }

        public string ItemName
        {
            get { return lblName.Text; }
            set { lblName.Text = value; }
        }

        public string Location
        {
            get { return lblLocation.Text; }
            set { lblLocation.Text = value; }
        }

        public void LoadAttachments()
        {
            LinksUserControl.SetInstanceAndType(GUID, ModuleID);
            ((AttachmentsControl)attachments).InstanceID = GUID;
            ((AttachmentsControl)attachments).SrcType = ModuleID;
            ((AttachmentsControl)attachments).LoadAttachments();
        }

        public bool SaveAttachments(int ParentInstanceID, string ParentModuleID)
        {
            ((AttachmentsControl)attachments).ParentInstanceID = ParentInstanceID;
            ((AttachmentsControl)attachments).ParentModuleID = ParentModuleID;
            return ((AttachmentsControl)attachments).SaveAttachments(GUID, ModuleID,
                                                                      UserDetail.GetCurrentUserDetail().UID,
                                                                      UserDetail.GetCurrentUserDetail().UserName,
                                                                      ModuleID + &quot; Activity Attachments.&quot;);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,17,11,18,0],[11,19,11,69,0],[11,70,11,71,0],[12,17,12,18,0],[12,19,12,70,0],[12,71,12,72,0],[17,17,17,18,0],[17,19,17,63,0],[17,64,17,65,0],[18,17,18,18,0],[18,19,18,45,0],[18,46,18,47,0],[23,17,23,18,0],[23,19,23,36,0],[23,37,23,38,0],[28,17,28,18,0],[28,19,28,39,0],[28,40,28,41,0],[29,17,29,18,0],[29,19,29,40,0],[29,41,29,42,0],[34,17,34,18,0],[34,19,34,43,0],[34,44,34,45,0],[35,17,35,18,0],[35,19,35,44,0],[35,45,35,46,0],[39,9,39,10,0],[40,13,40,65,0],[41,13,41,65,0],[42,13,42,66,0],[43,13,43,65,0],[44,9,44,10,0],[47,9,47,10,0],[48,13,48,83,0],[49,13,49,79,0],[50,13,53,108,0],[54,9,54,10,0]]);
    </script>
  </body>
</html>