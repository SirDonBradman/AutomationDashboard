<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Core Modules\Submittals\ViewSubmittal.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.SubmittalsBL;
using Aurigo.AMP3.SubmittalsDTO;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebSchedule;
using System.Web;
using Aurigo.Common;
using Aurigo.Brix.Platform.BusinessLayer.DataResouces;
using System.Threading;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.AMP3.Submittals.UI
{
    public partial class ViewSubmittal : BrixPageBase, IWorkflowEnabled, IXMLControl
    {
        protected LinksUserControl LinksCtlHist;
        protected LinksUserControl LinksCtlSubmtal;
        protected ModalPopupExtender PopupExtender;
        protected PagerControl mypager;
        private BrixFormModel model;
        private XMLFormManagerModel managerModel;
        private bool _IsApprovedOrRejected = false;
        #region IWorkflowEnabled Members
        public void CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            throw new NotImplementedException();
        }
        public string ClientValidationFunction
        {
            get { return string.Empty; }
        }
        public string FormInstanceId
        {
            get
            {
                int id = String.IsNullOrEmpty(Request.QueryString[&quot;RegisterID&quot;])
                             ? -1
                             : int.TryParse(Request.QueryString[&quot;RegisterID&quot;], out id) ? id : -1;
                return id.ToString();
            }
        }
        public string FormKey { get { return string.Format(&quot;Submittal Type : {0}, Submittal Requirement : {1}&quot;, lblSubmittalType.Text, lblSubmittalReq.Text); } }

        public string FormName
        {
            get { return &quot;SUBREGR&quot;; }
        }
        public bool IsOldWorkflow
        {
            get { return true; }
        }

        public int PID
        {
            get { return Request.QueryString[&quot;PID&quot;].ToInt32_2(); }
        }

        public int ParentModuleId
        {
            get
            {
                int id = String.IsNullOrEmpty(Request.QueryString[&quot;LinkID&quot;])
                             ? -1
                             : int.TryParse(Request.QueryString[&quot;LinkID&quot;], out id) ? id : -1;
                return id;
            }
        }

        public string PostCancelRedirectUrl
        {
            get
            {
                return String.Format(CultureInfo.CurrentCulture, &quot;~/Common/BrixListPage.aspx?context=SUBMTAL&amp;PID={0}&amp;Link={1}&amp;LinkID={2}&quot;,
                                     PID, Request[&quot;Link&quot;], ParentModuleId);
            }
        }

        public string PostSaveRedirectUrl(string sSavedToken = &quot;&quot;)
        {
            return PostCancelRedirectUrl;
        }
        public bool SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors,
                             out string sRedirectTo)
        {
            sSavedInstanceToken = &quot;-1&quot;;
            sRedirectTo = &quot;&quot;;
            sErrors = &quot;&quot;;
            try
            {


                var submittals = new List&lt;DTOSubmittals&gt;();
                var dto = new DTOSubmittals();

                dto.SubmittalID = Request[&quot;RegisterID&quot;].ToInt32_2();
                dto.Reference = txtSubmittalRef.Text;
                dto.Notes = txtSubmittalNotes.Text;
                dto.Remarks = txtRemarks.Text;
                dto.DueDate = wdcDuedt.Value.ToUtcNullable();

                submittals.Add(dto);
                SubmittalsManager.BLInstance.CUDSubmittals(Operations.Update, submittals);

                //using hasattachments() from updated linksUI dll reference.
                ((AttachmentsControl)attachments).ParentModuleID = Request[&quot;Link&quot;];
                if (Request[&quot;Link&quot;].Equals(&quot;PROJECT&quot;))
                    ((AttachmentsControl)attachments).ParentInstanceID = Request[&quot;PID&quot;].ToInt32_2();
                else
                    ((AttachmentsControl)attachments).ParentInstanceID = Request[&quot;LinkID&quot;].ToInt32_2();

                string moduleCode = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);

                if (((AttachmentsControl)attachments).SaveAttachments(Request[&quot;RegisterID&quot;], moduleCode,
                                                                       UserDetail.GetCurrentUserDetail().UID,
                                                                       UserDetail.GetCurrentUserDetail().UserName,
                                                                       &quot;Submittal Attachments&quot;))
                {
                    SubmittalsManager.BLInstance.UpdateAttachmentStatus(Request[&quot;RegisterID&quot;].ToInt32_2(),
                                                                        ((AttachmentsControl)attachments).
                                                                            HasAttachments(), SubConstants.SUBMITTAL);
                }

                sSavedInstanceToken = dto.SubmittalID.ToString();
                return true;
            }
            catch (Exception ex)
            {
                sErrors = ex.Message;
                return false;
            }

        }
        #endregion
        protected override void OnPreInit(EventArgs e)
        {
            //if (!String.IsNullOrEmpty(Request[&quot;PID&quot;]))
            //    ModuleId = Request[&quot;PID&quot;].Equals(&quot;0&quot;) ? &quot;LANDMGT&quot; : &quot;SUBMTAL&quot;;

            this.ModuleId = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);

            base.OnPreInit(e);
            SetManagerModel();
            if (managerModel != null)
                managerModel.OnPreInit(model, new XmlFormArgs());
        }
        private void SetManagerModel()
        {
            model = BrixFormModel.GetInstance(&quot;SUBREGR&quot;, &quot;SUBREGR&quot;, Request, Response);

            if (!string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp; !string.IsNullOrEmpty(model.form.FormManagerClass))
            {
                managerModel = AMP3InterfaceFactory.GetInstance&lt;XMLFormManagerModel&gt;(model.form.ManagerDLL,
                                                                                 model.form.FormManagerClass);
                // managerModel.PageViewState = ViewState;
            }
        }

        public override Dictionary&lt;string, string&gt; PassInformationToWorkFlow()
        {
            Dictionary&lt;string, string&gt; sParams = base.PassInformationToWorkFlow();
            if (managerModel != null)
                sParams = managerModel.PassInformationToWorkFlow(model, sParams, new XmlFormArgs());
            return sParams;
        }

        protected override void OnInit(EventArgs e)
        {
            if (!String.IsNullOrEmpty(Request[&quot;Mode&quot;]))
            {
                PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);

                if (Request[&quot;Mode&quot;] == &quot;Edit&quot;)
                    PermissionsToCheck.Add(Constants.MODFEAT_EDIT);//this is same for all 4 submittal pages 
                else if (Request[&quot;Mode&quot;] == &quot;View&quot;)
                    PermissionsToCheck.Add(Constants.MODFEAT_VIEW);//this is same for all 4 submittal pages 

                (mypager).ItemClicked += HandlePagerEvent;
                grdHistory.Columns.FromKey(&quot;Multi&quot;).AllowUpdate = AllowUpdate.Yes;
                //grdHistory.SortColumn += new SortColumnEventHandler(grdHistory_SortColumn);
                mypager.EnableViewState = true;

                //ModalPopupExtender PopupExtender = (ModalPopupExtender)this.Master.FindControl(&quot;filterExtender&quot;);
                PopupExtender.Visible = true;
                PopupExtender.AddNewPopup(aspPnlWF.ClientID, btnMPGhost.ClientID, btnWFClose.ClientID, 500, 600);
                PopupExtender.AddNewPopup(pnlMessage.ClientID, btnMessage.ClientID, btnMsg.ClientID, 550, 600);
                PopupExtender.AddNewPopup(aspPnlApprove.ClientID, btnApprove.ClientID, btnCncl.ClientID, 500, 600);
                wdcDuedt.ValueChanged += wdcDuedt_ValueChanged;
                wdcDuedt.AutoPostBack.ValueChanged = true;
                base.PageUniqueID = HttpContext.Current.Request.QueryString[&quot;Link&quot;];


                XmlFormArgs args = new XmlFormArgs();
                if (managerModel != null)
                    managerModel.OnInit(model, args);
            }

            base.OnInit(e);
        }

        protected override void CreateChildControls()
        {
            var menus = new MenuArray();
            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));
            CreateToolBarMenu(menus, null);
            base.CreateChildControls();
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += new EventHandler(btnSave_Click);

                }
            }
            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += new EventHandler(btnCancel_Click);
            base.CustomizeToolBar();
        }
        protected void Page_Load(object sender, EventArgs e)
        {
            #region URL Validation

            if (string.IsNullOrEmpty(Request[&quot;Mode&quot;]) || string.IsNullOrEmpty(Request[&quot;PID&quot;]) ||
                string.IsNullOrEmpty(Request[&quot;RegisterID&quot;]) || string.IsNullOrEmpty(Request[&quot;Link&quot;]) ||
                string.IsNullOrEmpty(Request[&quot;LinkID&quot;]))
            {
                GoBack();
            }

            try
            {
                Request[&quot;PID&quot;].ToInt32_2();
                Request[&quot;RegisterID&quot;].ToInt32_2();
                Request[&quot;LinkID&quot;].ToInt32_2();
            }
            catch
            {
                GoBack();
            }

            if (!(Request[&quot;Mode&quot;] == &quot;View&quot; || Request[&quot;Mode&quot;] == &quot;Edit&quot;))
            {
                GoBack();
            }
            if (
                !(Request[&quot;Link&quot;] == &quot;PROJECT&quot; || Request[&quot;Link&quot;] == &quot;LANDMGT&quot; || Request[&quot;Link&quot;] == &quot;CONTMGT&quot; ||
                  Request[&quot;Link&quot;] == &quot;ESTMATE&quot;))
            {
                GoBack();
            }

            #endregion

            #region Authorization

            UIHelper.DisableRoleSelection(Page);

            string strModID = SubmittalsManager.Helper_GetModuleId_ForSubmittals_ByLinkId(Request[&quot;Link&quot;], Constants.MODID_PROJECT_Submittals);

            List&lt;string&gt; featurelist = ModuleManager.Instance.GetPermissionByUserOrRole(strModID, UserDetail.GetCurrentUserDetail().UID,
                            UserDetail.GetCurrentUserDetail().RID, Request.QueryString[&quot;PID&quot;].ToInt32_2());
            if (!(featurelist.Contains(&quot;View&quot;) || featurelist.Contains(&quot;Edit&quot;)))
                UIHelper.RedirectURL(
                    &quot;The current role does not have the required permissions to view this page.&quot;,
                    ResolveUrl(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                               &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                               Request[&quot;LinkID&quot;]), null, Context);

            if (Request[&quot;Mode&quot;] == &quot;Edit&quot;)
            {
                btnSave.Enabled = featurelist.Contains(&quot;Create&quot;);
            }
            btnApprove.Enabled = featurelist.Contains(&quot;Approve&quot;);
            ddlStatus.Enabled = btnStatusUpdate.Enabled = featurelist.Contains(&quot;Approve&quot;) &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;Edit&quot;);
            wdcDuedt.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();

            #endregion

            SetPageTitle();
            Page.ClientScript.RegisterStartupScript(GetType(), &quot;ShowDetailsTab&quot;, &quot;&lt;script&gt;showTab(&#39;&quot; + lnkDetails.ClientID + &quot;&#39;);&lt;/script&gt;&quot;);
            if (!IsPostBack)
            {
                if (!String.IsNullOrEmpty(Request[&quot;Mode&quot;]) &amp;&amp; (Request[&quot;Mode&quot;] == &quot;View&quot; || Request[&quot;Mode&quot;] == &quot;Edit&quot;))
                {
                    PopulateDetails();
                    LoadGrid();
                    SetLocalization();
                    LoadAttachments();
                    ((AttachmentsControl)attachments).ReadOnly = (Request[&quot;Mode&quot;] == &quot;View&quot;);
                }
            }

            btnpdf.Click += btnpdf_Click;
            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnPageLoad(model, args);
        }

        private void LoadAttachments()
        {
            ((AttachmentsControl)attachments).InstanceID = Request[&quot;RegisterID&quot;].ToString();
            string moduleCode = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);
            ((AttachmentsControl)attachments).SrcType = moduleCode;
            ((AttachmentsControl)attachments).LoadAttachments();
        }
        protected override void OnPreRender(EventArgs e)
        {
            if (((!String.IsNullOrEmpty(Request[&quot;Mode&quot;]) &amp;&amp; Request[&quot;Mode&quot;] == &quot;View&quot;)) || _IsApprovedOrRejected)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;);
                    }
                }
            }

            base.OnPreRender(e);
        }
        private void SetPageTitle()
        {
            if (String.IsNullOrEmpty(Request[&quot;Mode&quot;]))
            {
                PageTitle = &quot;Submittals&quot;;
            }
            else if (Request[&quot;Mode&quot;] == &quot;Edit&quot;)
            {
                PageTitle = &quot;Edit Submittals&quot;;
            }
            else if (Request[&quot;Mode&quot;] == &quot;View&quot;)
            {
                PageTitle = &quot;View Submittals&quot;;
            }
        }

        private void GoBack()
        {
            Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, true);
        }

        private void SetLocalization()
        {
            tdIDesc.InnerText = &quot;Item Description :&quot;;
            tdComp.InnerText = &quot;Item Component :&quot;;
        }

        private void PopulateDetails()
        {
            DataTable dtSubDetails =
                SubmittalsManager.BLInstance.GetSubmittals(Request[&quot;RegisterID&quot;].ToString2().ToInt32_2(),
                                                           Request[Constants.QRY_PROJECTID].ToInt32_2(),
                                                           null, null, null, null, Request[&quot;Link&quot;],
                                                           Request[&quot;LinkID&quot;].ToInt32_2(), &#39;N&#39;);

            lblSubmittalType.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;SubmittalType&quot;].ToString2());
            lblSubmittalReq.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Requirement&quot;].ToString2());
            lblSubmittalDesc.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Description&quot;].ToString2());
            lblCreatedOn.Text = dtSubDetails.Rows[0][&quot;CreatedOn&quot;].ToMWDateTimeString_FormatDate();
            lblCreatedBy.Text = dtSubDetails.Rows[0][&quot;CreatedBy1&quot;].ToString2();

            if (Request[&quot;Link&quot;] != &quot;PROJECT&quot; &amp;&amp; Request[&quot;Link&quot;] != &quot;LANDMGT&quot;)
            {
                lblLineNo.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;LineNo&quot;].ToString2());
                lblItemDescription.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;ItemDescription&quot;].ToString2());
                lblItemComponent.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Component&quot;].ToString2());
            }

            if (Request[&quot;Mode&quot;] == &quot;Edit&quot;)
            {
                txtSubmittalRef.Text = dtSubDetails.Rows[0][&quot;Reference&quot;].ToString2();
                txtSubmittalNotes.Text = dtSubDetails.Rows[0][&quot;Notes&quot;].ToString2();
                txtRemarks.Text = dtSubDetails.Rows[0][&quot;Remarks&quot;].ToString2();
                wdcDuedt.Value = Convert.ToDateTime(dtSubDetails.Rows[0][&quot;DueDate&quot;],
                                                    DateFormatCulture.GetDateFormatCulture()).ToMWDateTime();
                if (dtSubDetails.Rows[0][&quot;Status&quot;].ToString2().Trim() == &quot;A&quot; || dtSubDetails.Rows[0][&quot;Status&quot;].ToString2().Trim() == &quot;R&quot;)
                {
                    _IsApprovedOrRejected = true;
                }
            }
            else
            {
                lblSubmittalRef.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Reference&quot;].ToString2());
                lblSubmittalNotes.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Notes&quot;].ToString2());
                lblRemarks.Text = HttpUtility.HtmlEncode(dtSubDetails.Rows[0][&quot;Remarks&quot;].ToString2());
                lblDuedt.Text = dtSubDetails.Rows[0][&quot;DueDate&quot;].ToMWDateTimeString_FormatDate();
            }
        }

        private void LoadGrid()
        {
            int startIdx = (startIdx = (mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value.ToInt32_2() - 1) ==
                           -1
                               ? 0
                               : startIdx;
            startIdx = 1 + (grdHistory.DisplayLayout.Pager.PageSize * startIdx);

            DataTable dtHistory =
                SubmittalsManager.BLInstance.GetSubmittalHistory(Request[&quot;RegisterID&quot;].ToString2().ToInt32_2(),
                                                                 ddlFilter.SelectedValue, startIdx,
                                                                 grdHistory.DisplayLayout.Pager.PageSize,
                                                                 ViewState[Constants.ODS_SORTORDER] == null
                                                                     ? null
                                                                     : ViewState[Constants.ODS_SORTORDER].ToString2(),
                                                                 &#39;N&#39;);
            grdHistory.DataSource = dtHistory.ToMWDateTime();
            grdHistory.DataBind();
            SetGridColumns();
        }

        private void SetGridColumns()
        {
            ColumnsCollection cols;

            cols = grdHistory.Bands[0].Columns;
            cols.FromKey(&quot;HistoryID&quot;).Hidden = true;
            cols.FromKey(&quot;PostedTo&quot;).Hidden = true;
            cols.FromKey(&quot;SubmittalID&quot;).Hidden = true;
            cols.FromKey(&quot;Message&quot;).Hidden = true;

            cols.FromKey(&quot;HasAttachment&quot;).Width = Unit.Pixel(50);
            cols.FromKey(&quot;HasAttachment&quot;).Header.Image.Url = &quot;../../Images/Toolbar/IcnAttachment.gif&quot;;
            cols.FromKey(&quot;HasAttachment&quot;).Header.Caption = &quot;&quot;;

            cols.FromKey(&quot;HasAttachment&quot;).CellStyle.HorizontalAlign = HorizontalAlign.Center;
            cols.FromKey(&quot;HasAttachment&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Center;
            cols.FromKey(&quot;HasAttachment&quot;).Move(1);

            cols.FromKey(&quot;PostedBy&quot;).Header.Caption = &quot;Posted By&quot;;
            cols.FromKey(&quot;PostedBy&quot;).Width = Unit.Pixel(200);
            //cols.FromKey(&quot;Subject&quot;).Width = Unit.Pixel(250);
            cols.FromKey(&quot;PostedDate&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_DATETIME;
            cols.FromKey(&quot;PostedDate&quot;).Header.Caption = &quot;Posted On&quot;;

            cols.FromKey(&quot;PostedDate&quot;).Width = cols.FromKey(&quot;Status&quot;).Width = Unit.Pixel(75);
            cols.FromKey(&quot;TransactionType&quot;).Width = Unit.Pixel(20);
            cols.FromKey(&quot;TransactionType&quot;).Header.Caption = &quot;&quot;;


            grdHistory.DisplayLayout.ScrollBar = ScrollBar.Auto;
            grdHistory.DisplayLayout.FrameStyle.Height = Unit.Pixel(300);
            grdHistory.DisplayLayout.Pager.PagerStyle.CustomRules = &quot;display:none&quot;;

            foreach (UltraGridColumn col in grdHistory.Columns)
            {
                if (!col.BaseColumnName.Equals(&quot;subject&quot;, StringComparison.CurrentCultureIgnoreCase))
                    col.HTMLEncodeContent = true;
            }
        }

        private void GetPageCount()
        {
            double rCnt;

            string pageCount;

            rCnt = SubmittalsManager.BLInstance.GetHistoryCount(Request[&quot;RegisterID&quot;].ToInt32_2(),
                                                                ViewState[Constants.ODS_FILTER] == null
                                                                    ? null
                                                                    : ViewState[Constants.ODS_FILTER].ToString2(), &#39;N&#39;);

            (mypager.FindControl(&quot;pageCount&quot;) as HtmlInputHidden).Value =
                pageCount = rCnt &gt; grdHistory.DisplayLayout.Pager.PageSize
                                ? Convert.ToString(Math.Ceiling(rCnt / grdHistory.DisplayLayout.Pager.PageSize),
                                                   CultureInfo.CurrentCulture)
                                : rCnt &gt; 0 ? &quot;1&quot; : &quot;0&quot;;

            (mypager).Set_Page((mypager.FindControl(&quot;currentPage&quot;) as HtmlInputHidden).Value.ToInt32_2(),
                               pageCount.ToInt32_2());
        }

        public void HandlePagerEvent(object sender, ItemClickEventArgs e)
        {
            LoadGrid();
            grdHistory.DisplayLayout.Pager.CurrentPageIndex = 1;
        }

        protected void ddlFilter_SelectedIndexChanged(object sender, EventArgs e)
        {
            LoadGrid();
        }

        protected void btnApprove_Click(object sender, EventArgs e)
        {
            try
            {
                if (rblApprove.Items[0].Selected == false &amp;&amp; rblApprove.Items[1].Selected == false)
                    return;

                SubmittalsManager.BLInstance.SubmittalUpdateStatus(Request[&quot;RegisterID&quot;].ToInt32_2(), txtNotes.Text,
                                                                   rblApprove.Items[0].Selected ? &quot;A&quot; : &quot;R&quot;,
                                                                   UserDetail.GetCurrentUserDetail().UID, null);
                //Clear....
                txtNotes.Text = string.Empty;
                rblApprove.ClearSelection();
                LoadGrid();
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;ShowTab&quot;,
                                                        &quot;&lt;script&gt;showTab(&#39;&quot; + lnkDetails.ClientID + &quot;&#39;);&lt;/script&gt;&quot;);
            }
            catch
            {
                //Go back to respective submittal register list
                Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                  &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                                  Request[&quot;LinkID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
            }
        }

        protected void btnSave_Click(object sender, EventArgs e)
        {

            WorkflowEnabledSaveHandler();

        }

        protected void btnpdf_Click(object sender, EventArgs e)
        {
            string selID = string.Empty;
            if (grdHistory.DisplayLayout.SelectedRows.Count == 1)
                selID = grdHistory.DisplayLayout.SelectedRows[0].Cells.FromKey(&quot;HistoryID&quot;).Value.ToString();

            if (!String.IsNullOrEmpty(selID))
            {
                string code = &quot;S&quot;;
                if (grdHistory.DisplayLayout.SelectedRows[0].Cells.FromKey(&quot;TransactionType&quot;).Value.Equals(&quot;O&quot;))
                    code = &quot;T&quot;;
                int historyID = 0;
                int.TryParse(selID, out historyID);
                Response.Redirect(
                    string.Format(
                        &quot;~/Common/BrixListReportPage.aspx?Context=TRANSMITTAL&amp;ModuleId=SUBMTAL&amp;historyID={0}&amp;code={1}&amp;PID={2}&amp;Link={3}&amp;LinkID={4}&amp;LMID={5}&amp;RegisterID={6}&amp;Mode={7}&quot;,
                        historyID, code, Request[Constants.QRY_PROJECTID], Request[&quot;Link&quot;], Request[&quot;LinkID&quot;],
                        Request[&quot;LinkID&quot;], Request[&quot;RegisterID&quot;], Request[&quot;Mode&quot;]), false);
            }
        }

        protected void btnStatusUpdate_Click(object sender, EventArgs e)
        {
            var historyID = new List&lt;int&gt;();
            try
            {
                if (grdHistory.Rows.Count &gt; 0)
                {
                    int HistColIndx = grdHistory.Rows[0].Cells.IndexOf(&quot;HistoryID&quot;);
                    foreach (UltraGridRow row in grdHistory.Rows)
                    {
                        if (row.Cells[0].Value.ToBoolean2())
                        {
                            int ID = Convert.ToString(row.Cells[HistColIndx], CultureInfo.CurrentCulture).ToInt32_2();
                            /*
                            string state = string.Empty;
                            WFitem item = new WFitem(ID, &quot;TRNMTAL&quot;);
                            if (ddlStatus.SelectedItem.Text.Equals(&quot;Approve&quot;))
                            {
                                state = item.ApproveWorkflowItem(UserDetail.GetCurrentUserDetail().UserID, UserDetail.GetCurrentUserDetail().RoleName, string.Empty);
                                if (state == &quot;Completed&quot;)
                                    historyID.Add(ID);
                            }
                            else
                            {
                                state = item.RejectWorkflowItem(UserDetail.GetCurrentUserDetail().UserID, UserDetail.GetCurrentUserDetail().RoleName, string.Empty);
                                if (state == &quot;Open&quot;)
                                    historyID.Add(ID);
                            }
                            */
                            historyID.Add(ID);
                        }
                    }
                    SubmittalsManager.BLInstance.HistoryStatusUpdate(historyID, Request[&quot;RegisterID&quot;].ToInt32_2(),
                                                                     ddlStatus.SelectedValue);
                    LoadGrid();
                }
            }
            catch
            {
                //Go back to respective submittal register list
                Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                  &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                                  Request[&quot;LinkID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
            }
        }

        protected void lnkDetails_Click(object sender, EventArgs e)
        {
            (attachments as AttachmentsControl).InstanceID = Request[&quot;RegisterID&quot;];
            (attachments as AttachmentsControl).SrcType = &quot;SUBMTAL&quot;;
            LinksUserControl.SetInstanceAndType(Request[&quot;RegisterID&quot;], &quot;SUBMTAL&quot;);
            Page.ClientScript.RegisterStartupScript(GetType(), &quot;ShowTab&quot;,
                                                    &quot;&lt;script&gt;showTab(&#39;&quot; + ((LinkButton)sender).ClientID +
                                                    &quot;&#39;);&lt;/script&gt;&quot;);
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            //Go back to respective submittal register list
            Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                              &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; + Request[&quot;LinkID&quot;]
                              + &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
        }

        protected void btnABack_Click(object sender, EventArgs e)
        {
            //Go back to respective submittal register list
            Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                              &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; + Request[&quot;LinkID&quot;] 
                              + &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
        }

        protected void grdHistory_InitializeRow(object sender, RowEventArgs e)
        {
            try
            {
                UltraGridCell cellStatus = e.Row.Cells.FromKey(&quot;TransactionType&quot;);
                string subject = e.Row.Cells.FromKey(&quot;Subject&quot;).Value != null
                                     ? e.Row.Cells.FromKey(&quot;Subject&quot;).Value.ToString2()
                                     : String.Empty;
                switch (cellStatus.Value.ToString2().ToUpper2())
                {
                    case &quot;I&quot;:
                        cellStatus.Style.BackgroundImage = &quot;../../Images/BtnRemove.gif&quot;;
                        cellStatus.Style.CustomRules =
                            &quot;Background-repeat:no-repeat;background-position: center center&quot;;
                        cellStatus.Style.Font.Size = FontUnit.Point(1);
                        cellStatus.Title = &quot;Response&quot;;
                        e.Row.Cells[0].AllowEditing = AllowEditing.Yes;
                        if (subject == &quot;Direct Approval&quot;) {
                            e.Row.Cells[0].AllowEditing = AllowEditing.No;
                        }
                        break;
                    case &quot;O&quot;:
                        cellStatus.Style.BackgroundImage = &quot;../../Images/BtnAdd.gif&quot;;
                        cellStatus.Style.CustomRules =
                            &quot;Background-repeat:no-repeat;background-position: center center&quot;;
                        if (e.Row.Cells.FromKey(&quot;Status&quot;).Value == null) e.Row.Cells.FromKey(&quot;Status&quot;).Value = &quot;&quot;;
                        cellStatus.Style.Font.Size = FontUnit.Point(1);
                        cellStatus.Title = &quot;Transmittal&quot;;
                        e.Row.Cells[0].AllowEditing = AllowEditing.No;
                        break;
                }
                string sub = e.Row.Cells.FromKey(&quot;Subject&quot;).Value == null
                                 ? &quot;&quot;
                                 : Convert.ToString(e.Row.Cells.FromKey(&quot;Subject&quot;).Value, CultureInfo.CurrentCulture).
                                       Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);
                e.Row.Cells.FromKey(&quot;Subject&quot;).Value =
                    &quot;&lt;a  style=\&quot;cursor:hand;color:blue;text-decoration:underline;\&quot; onclick=\&quot;return ActivateGhost(&#39;&quot; +
                    e.Row.Index + &quot;&#39;,&#39;&quot;
                    + sub + &quot;&#39;,&#39;&quot; + e.Row.Cells.FromKey(&quot;TransactionType&quot;).Value + &quot;&#39;);\&quot;&gt;&quot; +
                    e.Row.Cells.FromKey(&quot;Subject&quot;).Value + &quot;&lt;/a&gt;&quot;;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.ToString2(), &quot;CONTMGT&quot;);
            }
        }

        protected void btnGhostHistory_Click(object sender, EventArgs e)
        {
            try
            {
                int Indx = hdnHistRowID.Value.ToInt32_2();
                int HistoryID;
                UltraGridRow row = grdHistory.DisplayLayout.Rows[Indx];

                HistoryID =
                    Convert.ToString(row.Cells.FromKey(&quot;HistoryID&quot;).Value, CultureInfo.CurrentCulture).ToInt32_2();
                lblSubject.Text = hdnHistSubject.Value;
                txtMessage.Text = Convert.ToString(row.Cells.FromKey(&quot;Message&quot;).Value, CultureInfo.CurrentCulture);
                //txtRemarksHistory.Text = row.Cells.FromKey(&quot;Remarks&quot;).Value == null ? String.Empty : row.Cells.FromKey(&quot;Remarks&quot;).Value.ToString2();

                (attachments as AttachmentsControl).InstanceID = HistoryID.ToString2();
                (attachments as AttachmentsControl).SrcType = &quot;HISTORY&quot;;
                LinksUserControl.SetInstanceAndType(HistoryID.ToString2(), &quot;HISTORY&quot;);
                LinksCtlHist.ClearAndLoadDefaults(HistoryID.ToString2(), &quot;HISTORY&quot;);
                lblToDiv.InnerText = SubmittalsManager.BLInstance.GetPostedTo(HistoryID);

                Page.ClientScript.RegisterStartupScript(GetType(), &quot;clickMsg&quot;,
                                                        &quot;&lt;script&gt;document.getElementById(&#39;&quot; + btnMessage.ClientID +
                                                        &quot;&#39;).click();&lt;/script&gt;&quot;);
            }
            catch
            {
                //Go back to respective submittal register list
                Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                  &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                                  Request[&quot;LinkID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
            }
        }

        protected void lnkWorkFlow_Click(object sender, EventArgs e)
        {
            try
            {
                //int ID = BrixDatatypeHelper.ToInt32_2(grdHistory.DisplayLayout.ActiveRow.Cells.FromKey(&quot;HistoryID&quot;).Text);
                ////Workflow
                //WFitem item = new WFitem(ID, &quot;TRNMTAL&quot;);
                //DataTable dt = new WorkflowFactory().GetWorkflowUsers(item.Id, &quot;TRNMTAL&quot;);
                //grdWorkFlow.DataSource = dt;
                //grdWorkFlow.DataBind();
                //grdWorkFlow.DisplayLayout.ViewType = ViewType.OutlookGroupBy;
                //grdWorkFlow.Columns.FromKey(&quot;State&quot;).AllowGroupBy = AllowGroupBy.Yes;
                //grdWorkFlow.Columns.FromKey(&quot;State&quot;).IsGroupByColumn = true;
                //grdWorkFlow.PerformGroupRows();
                //grdWorkFlow.ExpandAll(true);
            }
            catch (Exception)
            {
            }
        }

        protected void wdcDuedt_ValueChanged(object sender, WebDateChooser.WebDateChooserEventArgs e)
        {
            if (Request[&quot;Mode&quot;] != null &amp;&amp;
                Convert.ToDateTime(
                    Convert.ToDateTime(wdcDuedt.Value, CultureInfo.CurrentCulture).ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE,
                                                                                            CultureInfo.CurrentCulture),
                    DateFormatCulture.GetDateFormatCulture()) &lt;
                Convert.ToDateTime(lblCreatedOn.Text, DateFormatCulture.GetDateFormatCulture()))
            {
                //lblError.Text = &quot;Approval due date is before the created date of submittal.&quot;;
                //lblError.ForeColor = Color.Red;
                ShowNotificationMessage(&quot;Approval due date is before the created date of submittal.&quot;, NotificationType.Error);
            }
            else
                lblError.Text = String.Empty;
        }

        public override int GetProjectIdFromInstanceId()
        {
            //If the Link is Project or Land then no need to check the PID as land is outside of project 
            //and Project submittals has only PID

            string strModID = Request[&quot;Link&quot;];

            if (strModID.Equals(Constants.MODID_CONTMGT, StringComparison.CurrentCultureIgnoreCase) ||
                strModID.Equals(Constants.MODID_ESTMATE, StringComparison.CurrentCultureIgnoreCase))
            {
                return SubmittalsManager.BLInstance.GetPIDFromLinkModule(strModID, Request[&quot;LinkID&quot;].ToInt32_2());
            }
            else
                return base.GetProjectIdFromInstanceId();
        }

        #region IXMLControl Members
        public HtmlGenericControl XMLContainterDiv
        {
            get { return divExtension; }
            set { throw new NotImplementedException(); }
        }

        public object[] ParentFormInstanceID
        {
            get { return new object[] { Request[&quot;RegisterID&quot;] == null ? &quot;0&quot; : Request[&quot;RegisterID&quot;].ToString() }; }
        }

        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        { }

        public void HandleInjectionAfterSave(object model, string parentFormInstanceId)
        { }

        public bool SkipDefaultXMLInjectionSave { get; set; }
        #endregion

    }

}

    </pre>
    <script type="text/javascript">
      highlightRanges([[38,9,38,52,1],[41,9,41,10,0],[42,13,42,49,0],[46,17,46,18,1],[46,19,46,39,1],[46,40,46,41,1],[51,13,51,14,1],[52,17,54,98,1],[55,17,55,38,1],[56,13,56,14,1],[58,37,58,38,1],[58,39,58,158,1],[58,159,58,160,1],[62,17,62,18,1],[62,19,62,36,1],[62,37,62,38,1],[66,17,66,18,0],[66,19,66,31,0],[66,32,66,33,0],[71,17,71,18,1],[71,19,71,65,1],[71,66,71,67,1],[77,13,77,14,1],[78,17,80,94,1],[81,17,81,27,1],[82,13,82,14,1],[88,13,88,14,1],[89,17,90,76,1],[91,13,91,14,1],[95,9,95,10,1],[96,13,96,42,1],[97,9,97,10,1],[100,9,100,10,1],[101,13,101,40,1],[102,13,102,30,1],[103,13,103,26,1],[105,13,105,14,1],[108,17,108,60,1],[109,17,109,47,1],[111,17,111,69,1],[112,17,112,54,1],[113,17,113,52,1],[114,17,114,47,1],[115,17,115,62,1],[117,17,117,37,1],[118,17,118,91,1],[121,17,121,84,1],[122,17,122,55,1],[123,21,123,101,1],[125,21,125,104,0],[127,17,127,134,1],[129,17,132,97,1],[133,17,133,18,1],[134,21,136,119,1],[137,17,137,18,1],[139,17,139,66,1],[140,17,140,29,1],[142,13,142,33,0],[143,13,143,14,0],[144,17,144,38,0],[145,17,145,30,0],[148,9,148,10,1],[151,9,151,10,1],[155,13,155,126,1],[157,13,157,31,1],[158,13,158,31,1],[159,13,159,38,1],[160,17,160,66,0],[161,9,161,10,1],[163,9,163,10,1],[164,13,164,88,1],[166,13,166,116,1],[167,13,167,14,0],[168,17,169,111,0],[171,13,171,14,0],[172,9,172,10,1],[175,9,175,10,0],[176,13,176,83,0],[177,13,177,38,0],[178,17,178,101,0],[179,13,179,28,0],[180,9,180,10,0],[183,9,183,10,1],[184,13,184,56,1],[185,13,185,14,1],[186,17,186,70,1],[188,17,188,47,1],[189,21,189,68,1],[190,22,190,52,1],[191,21,191,68,1],[193,17,193,59,1],[194,17,194,83,1],[196,17,196,48,1],[199,17,199,46,1],[200,17,200,114,1],[201,17,201,112,1],[202,17,202,116,1],[203,17,203,64,1],[204,17,204,59,1],[205,17,205,85,1],[208,17,208,54,1],[209,17,209,42,1],[210,21,210,54,0],[211,13,211,14,1],[213,13,213,28,1],[214,9,214,10,1],[217,9,217,10,1],[218,13,218,41,1],[219,13,219,34,1],[220,13,220,82,1],[221,13,221,44,1],[222,13,222,40,1],[223,9,223,10,1],[226,9,226,10,1],[227,13,227,31,1],[228,13,228,14,1],[229,17,229,78,1],[230,17,230,37,1],[231,17,231,18,1],[232,21,232,70,1],[234,17,234,18,1],[235,13,235,14,1],[236,13,236,98,1],[237,13,237,37,1],[238,9,238,10,1],[240,9,240,10,1],[243,13,245,57,1],[246,13,246,14,0],[247,17,247,26,0],[248,13,248,14,0],[251,13,251,14,1],[252,17,252,44,1],[253,17,253,51,1],[254,17,254,47,1],[255,13,255,14,1],[256,13,256,18,0],[257,13,257,14,0],[258,17,258,26,0],[259,13,259,14,0],[261,13,261,75,1],[262,13,262,14,0],[263,17,263,26,0],[264,13,264,14,0],[265,13,267,49,1],[268,13,268,14,0],[269,17,269,26,0],[270,13,270,14,0],[276,13,276,49,1],[278,13,278,144,1],[280,13,281,108,1],[282,13,282,81,1],[283,17,287,67,0],[289,13,289,43,1],[290,13,290,14,1],[291,17,291,66,1],[292,13,292,14,1],[293,13,293,66,1],[294,13,294,125,1],[295,13,295,88,1],[299,13,299,28,1],[300,13,300,142,1],[301,13,301,29,1],[302,13,302,14,1],[303,17,303,120,1],[304,17,304,18,1],[305,21,305,39,1],[306,21,306,32,1],[307,21,307,39,1],[308,21,308,39,1],[309,21,309,94,1],[310,17,310,18,1],[311,13,311,14,1],[313,13,313,42,1],[314,13,314,50,1],[315,13,315,38,1],[316,17,316,54,0],[317,9,317,10,1],[320,9,320,10,1],[321,13,321,93,1],[322,13,322,130,1],[323,13,323,68,1],[324,13,324,65,1],[325,9,325,10,1],[327,9,327,10,1],[328,13,328,114,1],[329,13,329,14,1],[330,17,330,35,1],[331,17,331,18,1],[332,21,332,82,1],[333,21,333,41,1],[334,21,334,22,1],[335,25,335,57,1],[336,21,336,22,1],[337,17,337,18,1],[338,13,338,14,1],[340,13,340,33,1],[341,9,341,10,1],[343,9,343,10,1],[344,13,344,55,1],[345,13,345,14,0],[346,17,346,42,0],[347,13,347,14,0],[348,18,348,48,1],[349,13,349,14,1],[350,17,350,47,1],[351,13,351,14,1],[352,18,352,48,1],[353,13,353,14,1],[354,17,354,47,1],[355,13,355,14,1],[356,9,356,10,1],[359,9,359,10,0],[360,13,360,83,0],[361,9,361,10,0],[364,9,364,10,1],[365,13,365,54,1],[366,13,366,51,1],[367,9,367,10,1],[370,9,370,10,1],[371,13,375,96,1],[377,13,377,111,1],[378,13,378,108,1],[379,13,379,109,1],[380,13,380,99,1],[381,13,381,80,1],[383,13,383,78,1],[384,13,384,14,0],[385,17,385,101,0],[386,17,386,119,0],[387,17,387,111,0],[388,13,388,14,0],[390,13,390,43,1],[391,13,391,14,1],[392,17,392,86,1],[393,17,393,84,1],[394,17,394,79,1],[395,17,396,110,1],[397,17,397,138,1],[398,17,398,18,1],[399,21,399,50,1],[400,17,400,18,1],[401,13,401,14,1],[403,13,403,14,1],[404,17,404,110,1],[405,17,405,108,1],[406,17,406,103,1],[407,17,407,97,1],[408,13,408,14,1],[409,9,409,10,1],[412,9,412,10,1],[413,13,416,43,1],[417,13,417,81,1],[419,13,426,71,1],[427,13,427,62,1],[428,13,428,35,1],[429,13,429,30,1],[430,9,430,10,1],[433,9,433,10,1],[436,13,436,48,1],[437,13,437,53,1],[438,13,438,52,1],[439,13,439,55,1],[440,13,440,51,1],[442,13,442,66,1],[443,13,443,103,1],[444,13,444,63,1],[446,13,446,94,1],[447,13,447,97,1],[448,13,448,51,1],[450,13,450,67,1],[451,13,451,62,1],[453,13,453,98,1],[454,13,454,69,1],[456,13,456,94,1],[457,13,457,68,1],[458,13,458,65,1],[461,13,461,65,1],[462,13,462,74,1],[463,13,463,84,1],[465,13,465,20,1],[465,22,465,41,1],[465,42,465,44,1],[465,45,465,63,1],[466,13,466,14,1],[467,17,467,102,1],[468,21,468,50,1],[469,13,469,14,1],[470,9,470,10,1],[473,9,473,10,0],[478,13,481,121,0],[483,13,487,56,0],[489,13,490,55,0],[491,9,491,10,0],[494,9,494,10,0],[495,13,495,24,0],[496,13,496,65,0],[497,9,497,10,0],[500,9,500,10,1],[501,13,501,24,1],[502,9,502,10,1],[505,9,505,10,0],[507,13,507,14,0],[508,17,508,100,0],[509,21,509,28,0],[511,17,513,113,0],[515,17,515,46,0],[516,17,516,45,0],[517,17,517,28,0],[518,17,519,117,0],[520,13,520,14,0],[521,13,521,18,0],[522,13,522,14,0],[524,17,526,89,0],[527,13,527,14,0],[528,9,528,10,0],[531,9,531,10,1],[533,13,533,42,1],[535,9,535,10,0],[538,9,538,10,0],[539,13,539,41,0],[540,13,540,66,0],[541,17,541,110,0],[543,13,543,46,0],[544,13,544,14,0],[545,17,545,35,0],[546,17,546,113,0],[547,21,547,32,0],[548,17,548,35,0],[549,17,549,52,0],[550,17,554,92,0],[555,13,555,14,0],[556,9,556,10,0],[559,9,559,10,0],[560,13,560,45,0],[562,13,562,14,0],[563,17,563,47,0],[564,17,564,18,0],[565,21,565,85,0],[566,21,566,28,0],[566,30,566,46,0],[566,47,566,49,0],[566,50,566,65,0],[567,21,567,22,0],[568,25,568,61,0],[569,25,569,26,0],[570,29,570,119,0],[587,29,587,47,0],[588,25,588,26,0],[589,21,589,22,0],[590,21,591,95,0],[592,21,592,32,0],[593,17,593,18,0],[594,13,594,14,0],[595,13,595,18,0],[596,13,596,14,0],[598,17,600,89,0],[601,13,601,14,0],[602,9,602,10,0],[605,9,605,10,1],[606,13,606,84,1],[607,13,607,69,1],[608,13,608,83,1],[609,13,611,69,1],[612,9,612,10,1],[615,9,615,10,1],[617,13,619,67,1],[620,9,620,10,0],[623,9,623,10,1],[625,13,627,67,1],[628,9,628,10,0],[631,9,631,10,1],[633,13,633,14,1],[634,17,634,83,1],[635,17,637,53,1],[638,17,638,65,1],[641,25,641,89,1],[642,25,643,94,1],[644,25,644,72,1],[645,25,645,55,1],[646,25,646,72,1],[647,25,647,58,1],[647,59,647,60,1],[648,29,648,75,1],[649,25,649,26,1],[650,25,650,31,1],[652,25,652,86,0],[653,25,654,94,0],[655,25,655,73,0],[655,74,655,115,0],[656,25,656,72,0],[657,25,657,58,0],[658,25,658,71,0],[659,25,659,31,0],[661,17,664,59,1],[665,17,669,67,1],[670,13,670,14,1],[671,13,671,33,0],[672,13,672,14,0],[673,17,673,83,0],[674,13,674,14,0],[675,9,675,10,1],[678,9,678,10,0],[680,13,680,14,0],[681,17,681,59,0],[683,17,683,72,0],[685,17,686,116,0],[687,17,687,56,0],[688,17,688,116,0],[691,17,691,88,0],[692,17,692,73,0],[693,17,693,87,0],[694,17,694,85,0],[695,17,695,90,0],[697,17,699,81,0],[700,13,700,14,0],[701,13,701,18,0],[702,13,702,14,0],[704,17,706,89,0],[707,13,707,14,0],[708,9,708,10,0],[711,9,711,10,0],[713,13,713,14,0],[725,13,725,14,0],[726,13,726,30,0],[727,13,727,14,0],[728,13,728,14,0],[729,9,729,10,0],[732,9,732,10,0],[733,13,738,97,0],[739,13,739,14,0],[742,17,742,127,0],[743,13,743,14,0],[745,17,745,46,0],[746,9,746,10,0],[749,9,749,10,1],[753,13,753,47,1],[755,13,756,101,1],[757,13,757,14,0],[758,17,758,115,0],[761,17,761,58,1],[762,9,762,10,1],[767,17,767,18,0],[767,19,767,39,0],[767,40,767,41,0],[768,17,768,18,0],[768,19,768,55,0],[773,17,773,18,1],[773,19,773,114,1],[773,115,773,116,1],[777,9,777,10,0],[777,11,777,12,0],[780,9,780,10,0],[780,11,780,12,0],[782,51,782,55,0],[782,56,782,60,0]]);
    </script>
  </body>
</html>