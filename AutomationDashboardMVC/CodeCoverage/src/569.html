<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Planning Management\ProgramForecast.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.Linq;
using System.Text;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.Resources.TerminologyResources;
//using Aurigo.Brix.Construction.ContractManager.QuantityPlanningUI.BL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using System.Collections.Generic;
using System.Web.UI.WebControls;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Core.AbstractModels;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.UltraWebGrid.ExcelExport;
using Infragistics.Documents.Excel;
using System.Globalization;
using System.Web;
using Aurigo.Common.Utility;

namespace Aurigo.Brix.Construction.PlanningManagement
{
    public partial class ProgramForecast : BrixPageBase
    {
        protected HierarchicalGrid HGrid;
        protected UltraWebGridExcelExporter UltraWebGridExcelExporter1;
        private UltraWebGridExcelExporter excelExporter;
        private bool ProgramType;
        private string WPStatus = &quot;&quot;;
        private int InstanceId { get; set; }

        private int ContractId { get; set; }

        private int BucketCount { get; set; }

        private bool isSnapshot;
        private int SnapshotID;
        private ForecastModel model;
        
        private bool ForecastUpdated //used to notify User if Forecast is Updated Successfully
        {
            get { return Convert.ToBoolean(Session[&quot;forecast&quot;] == null ? false : Session[&quot;forecast&quot;]); }
            set { Session[&quot;forecast&quot;] = value; }
        }
        private string UIContext { get { return Request[&quot;context&quot;]; } }
        bool IsRequiredProjectForecastUpdated
        {
            get { return (Request[&quot;SnapshotID&quot;] == null) ? true : false; }
        }

        private int StartNo
        {
            get { return Convert.ToInt32(Session[&quot;QPStartNo&quot;]); }
            set { Session[&quot;QPStartNo&quot;] = value; }
        }

        private int EndNo
        {
            get { return Convert.ToInt32(Session[&quot;QPEndNo&quot;]); }
            set { Session[&quot;QPEndNo&quot;] = value; }
        }

        private int CurrentLowerLimit
        {
            get { return Convert.ToInt32(Session[&quot;QPCurrentLowerLimit&quot;]); }
            set { Session[&quot;QPCurrentLowerLimit&quot;] = value; }
        }

        private int CurrentUpperLimit
        {
            get { return Convert.ToInt32(Session[&quot;QPCurrentUpperLimit&quot;]); }
            set { Session[&quot;QPCurrentUpperLimit&quot;] = value; }
        }

        private DataSet ScheduleData
        {
            get { return Session[&quot;QPScheduleDataForProgram&quot;] as DataSet; }
            set { Session[&quot;QPScheduleDataForProgram&quot;] = value; }
        }


        protected override void OnPreInit(EventArgs e)
        {
            ContextElement = &quot;Program Item List&quot;;
            base.OnPreInit(e);
        }

        protected override void OnInit(EventArgs e)
        {
            if(HGrid != null)
                HGrid.ColumnsToExcludeFromHTMLEncoding = &quot;ProjectForecastUpdated&quot;;

            InstanceId = string.IsNullOrEmpty(Request[&quot;InstanceId&quot;]) ? 0 : Request[&quot;InstanceId&quot;].ToInt32_2();

            isSnapshot = !string.IsNullOrEmpty(Request[&quot;SnapshotID&quot;]);

            if (isSnapshot &amp;&amp; !int.TryParse(Request[&quot;SnapshotID&quot;], out SnapshotID))
                throw new Exception(&quot;Invalid Snapshot ID&quot;);

            string pageMode = Request[&quot;Mode&quot;];

            switch (pageMode)
            {
                case &quot;View&quot;:
                    PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);
                    PermissionsToCheck.Add(Constants.MODFEAT_VIEW);
                    break;
                case &quot;Edit&quot;:
                    PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);
                    PermissionsToCheck.Add(Constants.MODFEAT_EDIT);
                    break;
                default:
                    //if (!isSnapshot)
                    //{
                    PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);
                    PermissionsToCheck.Add(Constants.MODFEAT_EDIT);
                    //}
                    break;
            }

            ContextElementHGrid = HGrid;
            if (!string.IsNullOrEmpty(UIContext))
            {
                model = ForecastModel.GetInstance(UIContext);
                model.InstanceId = InstanceId;
                model.ScheduleData = ScheduleData;
                model.SnapshotID = SnapshotID;
            }
            base.OnInit(e);
        }

        protected override void CreateChildControls()
        {
            EnsureChildControls();
            CreateControlCollection();

            List&lt;MenuGroup&gt; menuGroups = new List&lt;MenuGroup&gt;();
            MenuGroup generalGroup = new MenuGroup(&quot;General&quot;);
            //if (!(Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) &amp;&amp; !isSnapshot)
            //Master Program forcast save button should be disabled/Hidden
            //if (AllowSave)
            //generalGroup.AddMenu(new LargeButton(&quot;lnkSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;));
            generalGroup.AddMenu(new LargeButton(&quot;lnkCancel&quot;, &quot;Back&quot;, &quot;Icn_Back.png&quot;));
            generalGroup.AddMenu(new TextIcon(&quot;lnkPrevious&quot;, &quot;Previous Period&quot;, &quot;Icn_Previous_16.png&quot;));
            generalGroup.AddMenu(new TextIcon(&quot;lnkNext&quot;, &quot;Next Period&quot;, &quot;Icn_Next_16.png&quot;));
            if (!isSnapshot)
            {
                generalGroup.AddMenu(new TextIcon(&quot;lnkSnapshot&quot;, &quot;Forecast Snapshot&quot;, &quot;Icn_Snap_16.png&quot;));
                generalGroup.AddMenu(new TextIcon(&quot;lnkUpdate&quot;, &quot;Update Forecast&quot;, &quot;Icn_BtnUp_16.png&quot;));
            }

            if (!Request[&quot;Mode&quot;].Equals(&quot;View&quot;))
            {
                //if (WPStatus.ToUpper() != &quot;APPROVED&quot; &amp;&amp; WPStatus.ToUpper() != &quot;CLOSED&quot; &amp;&amp; !isSnapshot)
                //    generalGroup.AddMenu(new TextIcon(&quot;lnkExcelImport&quot;, &quot;Excel Import&quot;, &quot;Icn_importxl_16.png&quot;,
                //          &quot;~/Common/Import.aspx?Context=PROGRAM&amp;ParentID=0&amp;InstanceID=&quot; + InstanceId + &quot;&amp;Mode=&quot; + Request[&quot;Mode&quot;]));

                generalGroup.AddMenu(new TextIcon(&quot;lnkExcelExport&quot;, &quot;Excel Export (xls)&quot;, &quot;Icn_export_16.png&quot;));
                generalGroup.AddMenu(new TextIcon(&quot;lnkExcelExportXlsx&quot;, &quot;Excel Export (xlsx)&quot;, &quot;Icn_export_16.png&quot;));

            }
            menuGroups.Add(generalGroup);

            CreateToolBarMenu(menuGroups, null);


            if (!IsPostBack)
                FormatNavigatorButtons();
            base.CreateChildControls();


            excelExporter = (UltraWebGridExcelExporter1);
        }

        private void lnkExport_Click(object sender, EventArgs e)
        {
            string retMsg = String.Empty;
            string eventstring = ((Aurigo.AMP3.Core.UserControls.ToolBarEventArg)(e)).Text;
            try
            {
                DataSet ds = null;
                if (isSnapshot)
                {
                    ds = PlanningManagementManager.Instance.GetProgramForecastSnapshot(InstanceId, SnapshotID);
                }
                else
                {
                    ds = PlanningManagementManager.Instance.GetProgramForecastDetails(InstanceId);
                }

                ds.DataSetName = string.Format(LocalizationManager.GetString(&quot;LOC_QuantityPlanning&quot;) + &quot;_{0}.xls&quot;, InstanceId + (isSnapshot ? &quot;-&quot; + SnapshotID : &quot;&quot;));

                AppendScheduleInfo(ds);
                UltraWebGrid grid = new UltraWebGrid(&quot;grd_TempExport&quot;);
                excelExporter.DownloadName = string.Format(LocalizationManager.GetString(&quot;LOC_QuantityPlanning&quot;) + &quot;_{0}.xls&quot;, InstanceId + (isSnapshot ? &quot;-&quot; + SnapshotID : &quot;&quot;));
                Workbook book = new Workbook();

                if (ds == null || ds.Tables == null || ds.Tables.Count &lt; 1)
                    return;

                string[] hiddencolumns = new string[] { &quot;RowNum&quot;, &quot;ProjectCode&quot; , &quot;ItemID&quot;, &quot;PlanningID&quot;, &quot;QPID&quot;, &quot;ContainerID&quot;, &quot;IsNonContract&quot;, &quot;IsLocked&quot;, &quot;Status&quot;, &quot;Type&quot;, &quot;ModuleID&quot;, &quot;CumulativeValueBeforeForecastWindow&quot;, &quot;CumulativeValueAfterForecastWindow&quot; };

                Dictionary&lt;string, string&gt; renameColumns = new Dictionary&lt;string, string&gt;();
                Dictionary&lt;string, string&gt; totalColumns = new Dictionary&lt;string, string&gt;();
                totalColumns.Add(&quot;Amount&quot;, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
                totalColumns.Add(&quot;RemainingAmount&quot;, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
                totalColumns.Add(&quot;Before&quot;, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
                totalColumns.Add(&quot;After&quot;, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
                DataTable dtItems = new DataTable();

                renameColumns.Add(&quot;ProjectName&quot;, &quot;Name&quot;);
                renameColumns.Add(&quot;RemainingAmount&quot;, &quot;Remaining Amount in &quot;+ LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                renameColumns.Add(&quot;TotalCost&quot;, &quot;Amount in &quot;+ LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                renameColumns.Add(&quot;UpdatedDate&quot;, &quot;Updated Date&quot;);
                renameColumns.Add(&quot;ProjectForecastUpdated&quot;, &quot;Project Forecast Updated&quot;);
                

                dtItems = ds.Tables[1];

                DataTable dtCalendar = ds.Tables[2];
                //Items
                Dictionary&lt;string, string&gt; editColumns = new Dictionary&lt;string, string&gt;();

                int tempScheduleID = 0;
                string header = &quot;&quot;;
                for (int i = 0; i &lt; dtItems.Columns.Count; i++)
                {

                    if (Int32.TryParse(dtItems.Columns[i].ColumnName, out tempScheduleID))
                    {

                        header = GetColumnHeader(tempScheduleID);
                        dtItems.Columns[i].ColumnName = header;
                        editColumns.Add(header, AMP3ApplicationSettings.Instance.FORMAT_QUANTITY);
                        totalColumns.Add(header, null);
                    }
                }

                PlanningManagementManager.Instance.ExportGridData(eventstring, dtItems, ItemNameAbbr + &quot;s&quot;, &quot;Forecast&quot; + InstanceId, hiddencolumns, editColumns, renameColumns, totalColumns);

            }
            catch (Exception ex)
            {
                retMsg = ex.Message;
            }
        }

        private void lnkUpdate_Click(object sender, EventArgs e)
        {
            string retMsg = String.Empty;            
            try
            {
               
                //update forecast for projects
                List&lt;int&gt; projects = PlanningManagementManager.Instance.GetUpdatedProjectsforProgram(InstanceId);
                if(projects.Any())
                {
                    PlanningManagementManager.Instance.CaptureCurrentProgramForecastSnapshot(InstanceId, &quot;Auto-generated snapshot driven by Forecast Update from Project&quot;);

                    PlanningManagementManager.Instance.UpdateProgramForecast(string.Join(&quot;,&quot;, projects), InstanceId);
                    ForecastUpdated = true;
                    Response.Redirect(Request.RawUrl);
                }
                //refresh project scores                
                PlanningManagementManager.Instance.RefreshPlanningScores(InstanceId);
                ShowNotificationMessage(&quot; Forecast Already Updated &quot;, Platform.BusinessLayer.UserControls.NotificationType.Warning);


            }
            catch (Exception ex)
            {
                retMsg = ex.Message;
            }
        }

        private void FormatNavigatorButtons()
        {
            if (CurrentLowerLimit + BucketCount &gt; EndNo)
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            if (CurrentUpperLimit - BucketCount &lt; StartNo)
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
        }

        protected override void CustomizeToolBar()
        {
            if (!(Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) &amp;&amp; !isSnapshot)
            {

                //Program forcast save button should be disabled/Hidden
                if (MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
                {
                    //MainToolBar.GetMenuReference(&quot;lnkSave&quot;).Click += btnSave_Click;
                    //MainToolBar.GetMenuReference(&quot;lnkSave&quot;).OnClientClick = &quot;return SaveAndProceed(&#39;3&#39;);&quot;;

                    //if (WPStatus.ToUpper() == &quot;APPROVED&quot; || WPStatus.ToUpper() == &quot;CLOSED&quot;)
                    //{
                    //    MainToolBar.HideMenu(&quot;lnkSave&quot;);
                    //}
                    MainToolBar.HideMenu(&quot;lnkSave&quot;);
                }
            }
            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;
            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;

            MainToolBar.GetMenuReference(&quot;lnkNext&quot;).Click += btnFwdGhost_Click;
            MainToolBar.GetMenuReference(&quot;lnkNext&quot;).OnClientClick = &quot;return SaveAndProceed(&#39;1&#39;);&quot;;

            MainToolBar.GetMenuReference(&quot;lnkPrevious&quot;).Click += btnBwdGhost_Click;
            MainToolBar.GetMenuReference(&quot;lnkPrevious&quot;).OnClientClick = &quot;return SaveAndProceed(&#39;2&#39;);&quot;;

            if (MainToolBar.GetMenuReference(&quot;lnkExcelExport&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkExcelExport&quot;).Click += lnkExport_Click;
            if (MainToolBar.GetMenuReference(&quot;lnkExcelExportXlsx&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkExcelExportXlsx&quot;).Click += lnkExport_Click;

            if (MainToolBar.GetMenuReference(&quot;lnkUpdate&quot;) != null)
            {
                string Status = PlanningManagementManager.Instance.GetPlanningStatus(InstanceId, &quot;PROGRAM&quot;);
                if (string.Equals(Status, &quot;Approved&quot;, StringComparison.OrdinalIgnoreCase) ||
                    string.Equals(Status, &quot;Closed&quot;, StringComparison.OrdinalIgnoreCase))
                {
                    MainToolBar.HideMenu(&quot;lnkUpdate&quot;);
                }
                else
                {
                    MainToolBar.GetMenuReference(&quot;lnkUpdate&quot;).Click += lnkUpdate_Click;
                }
            }
            var requestObj = HttpContext.Current.Request;
            string encryptedURL = SecurityHelpers.Encrypt_Simple(requestObj.Url.PathAndQuery);
            string retUrl = HttpContext.Current.Server.UrlEncode(encryptedURL);

            if (!isSnapshot)
            {
                string SnapshotListPageURL = string.Format(CultureInfo.CurrentCulture,
                    &quot;~/Common/BrixListPage.aspx?xContext=PGFSNAP&amp;PID=0&amp;ParentID=0&amp;Mode={0}&amp;ProgramInstanceID={1}&amp;RetUrl={2}&quot;,
                    string.IsNullOrEmpty(Request[&quot;Mode&quot;]) ? &quot;Edit&quot; : Request[&quot;Mode&quot;], InstanceId,retUrl);
                MainToolBar.GetMenuReference(&quot;lnkSnapshot&quot;).PostBackUrl = SnapshotListPageURL;
            }
        }

        protected void btnSave_Click(object sender, EventArgs e)
        {
            //PlanningManager.Instance.CaptureCurrentProgramForecastSnapshot(InstanceId);

            if (model != null)
                model.HandleSave(sender, e);
            FetchData();
            FormatNavigatorButtons();
            BindItemDetailsGrid(string.Empty);
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            if (isSnapshot)
            {
                string SnapshotListPageURL = string.Format(CultureInfo.CurrentCulture,
                    &quot;~/Common/BrixListPage.aspx?xContext=PGFSNAP&amp;PID=0&amp;ParentID=0&amp;Mode={0}&amp;ProgramInstanceID={1}&quot;,
                    string.IsNullOrEmpty(Request[&quot;Mode&quot;]) ? &quot;Edit&quot; : Request[&quot;Mode&quot;], InstanceId);
                Response.Redirect(SnapshotListPageURL);
            }
            else
            {
                Response.Redirect(
                    string.Format(
                        &quot;~/Common/BrixForm.aspx?Context=PROGRAM&amp;PID=0&amp;ParentID=0&amp;Mode={0}&amp;InstanceID={1}&quot;,
                             string.IsNullOrEmpty(Request[&quot;Mode&quot;]) ? &quot;Edit&quot; : Request[&quot;Mode&quot;], InstanceId));
            }
        }

        protected void btnFwdGhost_Click(object sender, EventArgs e)
        {
            CurrentLowerLimit += BucketCount;
            if (CurrentUpperLimit + BucketCount &gt; EndNo) CurrentUpperLimit = EndNo;
            else CurrentUpperLimit += BucketCount;
            if (CurrentLowerLimit &gt; StartNo)
            {
                HideMenu(&quot;lnkPrevious&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
            }
            if (CurrentUpperLimit &lt; EndNo)
            {
                HideMenu(&quot;lnkNext&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            }
            BindItemDetailsGrid(string.Empty);
        }

        protected void btnBwdGhost_Click(object sender, EventArgs e)
        {
            int newVal = CurrentLowerLimit - 1;
            if (newVal &lt;= EndNo &amp;&amp; newVal &gt;= StartNo) CurrentUpperLimit = CurrentLowerLimit - 1;
            newVal = CurrentLowerLimit - BucketCount;
            if (newVal &lt;= EndNo &amp;&amp; newVal &gt;= StartNo) CurrentLowerLimit -= BucketCount;
            if (CurrentLowerLimit &gt; StartNo)
            {
                HideMenu(&quot;lnkPrevious&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
            }
            if (CurrentUpperLimit &lt; EndNo)
            {
                HideMenu(&quot;lnkNext&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            }

            BindItemDetailsGrid(string.Empty);
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            WPStatus = PlanningManagementManager.Instance.GetPlanningStatus(InstanceId, &quot;PROGRAM&quot;);

            ContractId = Request[&quot;ParentID&quot;].ToInt32_2();
            PageTitle = ItemNameAbbr + &quot; Details&quot;;

            //TODO: Obtain bucket count from the user
            BucketCount = 5;

            if (!IsPostBack)
            {
                FetchData();
                if (ForecastUpdated)
                {
                    ShowNotificationMessage(&quot; Forecast Updated Successfully &quot;, Platform.BusinessLayer.UserControls.NotificationType.Success);
                    ForecastUpdated = false;
                }
            }

            BindItemDetailsGrid(string.Empty);
            if (!ClientScript.IsStartupScriptRegistered(&quot;QP_HGrid_ActivateRow&quot;))
                ClientScript.RegisterStartupScript(Page.GetType(), &quot;QP_HGrid_ActivateRow&quot;,
                    &quot;$(\&quot;#topGridDiv\&quot;).bind(&#39;contextmenu&#39;,function(e){return ActivateRow(e);}); &quot;, true);

            
        }

        private void FetchData()
        {
            if (isSnapshot)
            {
                ScheduleData = PlanningManagementManager.Instance.GetProgramForecastSnapshot(InstanceId, SnapshotID);
            }
            else
            {
                ScheduleData = PlanningManagementManager.Instance.GetProgramForecastDetails(InstanceId);
            }

            ProgramType = false;
            ProgramType = PlanningManagementManager.Instance.GetProgramType(InstanceId).ToBoolean2();

            ScheduleData = ScheduleData.ToMWDateTime();
            AppendScheduleInfo(ScheduleData);
            int rowCount = ScheduleData.Tables[2].Rows.Count;

            if (rowCount &gt; 0)
            {
                StartNo = CurrentLowerLimit = ScheduleData.Tables[2].Rows[0][&quot;Number&quot;].ToInt32_2();
                EndNo = ScheduleData.Tables[2].Rows[rowCount - 1][&quot;Number&quot;].ToInt32_2();
                if (CurrentLowerLimit + BucketCount &gt; EndNo)
                {
                    CurrentUpperLimit = EndNo;
                }
                else CurrentUpperLimit = CurrentLowerLimit + (BucketCount - 1);
            }

        }

        private void AppendScheduleInfo(DataSet DSSrc)
        {
            DataTable scheduleInfo = DSSrc.Tables[3];
            int tempScheduleID;
            //Add Column CumulativeValueBeforeForecastWindow and CumulativeValueAfterForecastWindow
            DSSrc.Tables[1].Columns.Add(&quot;CumulativeValueBeforeForecastWindow&quot;);
            DSSrc.Tables[1].Columns.Add(&quot;CumulativeValueAfterForecastWindow&quot;);
            DSSrc.Tables[0].Columns.Add(&quot;CumulativeValueBeforeForecastWindow&quot;, Type.GetType(&quot;System.Decimal&quot;));
            DSSrc.Tables[0].Columns.Add(&quot;CumulativeValueAfterForecastWindow&quot;, Type.GetType(&quot;System.Decimal&quot;));

            //Add month-wise schedule to the table
            foreach (DataColumn scheduleID in scheduleInfo.Columns)
            {
                if (Int32.TryParse(scheduleID.ColumnName, out tempScheduleID))
                {
                    DSSrc.Tables[1].Columns.Add(tempScheduleID.ToString2(), Type.GetType(&quot;System.Decimal&quot;));
                    DSSrc.Tables[0].Columns.Add(tempScheduleID.ToString2(), Type.GetType(&quot;System.Decimal&quot;));
                }
            }

            int itemId;
            foreach (DataRow itemInfo in DSSrc.Tables[1].Select())
            {
                itemId = itemInfo[&quot;ItemID&quot;].ToInt32_2();
                DataRow[] itemScheduleInfo = scheduleInfo.Select(&quot;ItemID = &#39;&quot; + itemId + &quot;&#39;&quot;);
                if (itemScheduleInfo.Length &gt; 0)
                {
                    //Add values to CumulativeValueBeforeForecastWindow and CumulativeValueAfterForecastWindow
                    itemInfo[&quot;CumulativeValueBeforeForecastWindow&quot;] = itemScheduleInfo[0][&quot;CumulativeValueBeforeForecastWindow&quot;];
                    itemInfo[&quot;CumulativeValueAfterForecastWindow&quot;] = itemScheduleInfo[0][&quot;CumulativeValueAfterForecastWindow&quot;];

                    //Add values for month-wise schedule  
                    foreach (DataColumn scheduleID in scheduleInfo.Columns)
                    {
                        if (Int32.TryParse(scheduleID.ColumnName, out tempScheduleID))
                        {
                            itemInfo[tempScheduleID.ToString2()] = itemScheduleInfo[0][tempScheduleID.ToString2()];
                        }
                    }
                }
            }


            if (ProgramType)
                AppendConProjectSchedule(DSSrc, scheduleInfo);
            else
                AppendProjectSchedule(DSSrc, scheduleInfo);

        }

        private void AppendConProjectSchedule(DataSet DsSource, DataTable scheduleInfo)
        {
            int tempScheduleID;
            DataView dv;
            DataView DvPar;
            DataView DVBudgetClone;
            DataView DVBudget;
            DataView DVBudgetContainer;

            dv = null;
            DvPar = null;

            DvPar = new DataView(DsSource.Tables[0]);
            DvPar.RowFilter = &quot;ContainerID=1&quot;;
            dv = new DataView(DsSource.Tables[0]);

            DVBudget = new DataView(DsSource.Tables[3]);
            DVBudget.RowFilter = &quot;ContainerID=1 AND ItemID=0&quot;;

            DVBudgetContainer = new DataView(DsSource.Tables[1]);
            DVBudgetContainer.RowFilter = &quot;ContainerID=1 AND ItemID=0&quot;;

            DVBudgetClone = new DataView(DsSource.Tables[3].Copy());
            DVBudgetClone.RowFilter = &quot;ContainerID=1 AND ItemID=0&quot;;

            foreach (DataColumn scheduleID in scheduleInfo.Columns)
            {
                if (Int32.TryParse(scheduleID.ColumnName, out tempScheduleID))
                {
                    var query = from items in scheduleInfo.AsEnumerable()
                                where items.Field&lt;Int32&gt;(&quot;ItemID&quot;) &gt; 0
                                group items by items.Field&lt;Int32&gt;(&quot;ContainerID&quot;) into g
                                select new
                                {
                                    PlanningID = g.Key,
                                    TotalAmount = g.Sum(items =&gt; items.Field&lt;decimal?&gt;(scheduleID.ColumnName)),
                                };

                    if (query.Count() &gt; 0)
                    {
                        foreach (var item in query)
                        {
                            dv.RowFilter = &quot;ContainerID=&quot; + item.PlanningID;

                            if (dv.Count &gt; 0)
                            {
                                dv[0][scheduleID.ColumnName] = item.TotalAmount;
                            }
                            if (DvPar.Count &gt; 0 &amp;&amp; DVBudgetClone.Count &gt; 0)
                            {
                                //Top Container
                                DvPar[0][scheduleID.ColumnName] = (string.IsNullOrEmpty(DVBudgetClone[0][scheduleID.ColumnName].ToString()) ? 0 : Convert.ToDecimal(DVBudgetClone[0][scheduleID.ColumnName]));
                                //Budget record 
                                DVBudget[0][scheduleID.ColumnName] = (string.IsNullOrEmpty(DVBudgetClone[0][scheduleID.ColumnName].ToString()) ? 0 : Convert.ToDecimal(DVBudgetClone[0][scheduleID.ColumnName])) - (string.IsNullOrEmpty(item.TotalAmount.ToString()) ? 0 : item.TotalAmount);
                                //Budget container record 
                                DVBudgetContainer[0][scheduleID.ColumnName] = (string.IsNullOrEmpty(DVBudgetClone[0][scheduleID.ColumnName].ToString()) ? 0 : Convert.ToDecimal(DVBudgetClone[0][scheduleID.ColumnName])) - (string.IsNullOrEmpty(item.TotalAmount.ToString()) ? 0 : item.TotalAmount);
                            }
                        }
                    }
                    else
                    {
                        if (DvPar.Count &gt; 0 &amp;&amp; DVBudgetClone.Count &gt; 0)
                            DvPar[0][scheduleID.ColumnName] = (string.IsNullOrEmpty(DVBudgetClone[0][scheduleID.ColumnName].ToString()) ? 0 : Convert.ToDecimal(DVBudgetClone[0][scheduleID.ColumnName]));
                    }
                }
            }

            if (DvPar.Count &gt; 0)
                DvPar[0][&quot;TotalCost&quot;] = getTotalValue(DsSource.Tables[1]);
        }

        private decimal getTotalValue(DataTable dt)
        {
            decimal value;
            value = 0;
            var query = from items in dt.AsEnumerable()
                        group items by items.Field&lt;string&gt;(&quot;Type&quot;) into g
                        select new
                        {
                            Type = g.Key,
                            TotalAmount = g.Sum(items =&gt; items.Field&lt;decimal&gt;(&quot;TotalCost&quot;)),
                        };

            foreach (var item in query)
            {
                value += item.TotalAmount;
            }
            return value;
        }

        private void AppendProjectSchedule(DataSet DsSource, DataTable scheduleInfo)
        {
            int tempScheduleID;

            DataView dv = new DataView(DsSource.Tables[0]);
            DataView DvPar = new DataView(DsSource.Tables[0]);

            foreach (DataColumn column in scheduleInfo.Columns)
            {
                if (column.ColumnName == &quot;CumulativeValueBeforeForecastWindow&quot; || column.ColumnName == &quot;CumulativeValueAfterForecastWindow&quot; || Int32.TryParse(column.ColumnName, out tempScheduleID))
                {
                    RollupValues(scheduleInfo, dv, DvPar, column);
                }
            }
        }

        private void RollupValues(DataTable scheduleInfo, DataView dv, DataView DvPar, DataColumn column)
        {
            var query = from items in scheduleInfo.AsEnumerable()
                        group items by items.Field&lt;Int32&gt;(&quot;ContainerID&quot;) into g
                        select new
                        {
                            PlanningID = g.Key,
                            TotalAmount = g.Sum(items =&gt; items.Field&lt;decimal?&gt;(column.ColumnName)),
                        };

            foreach (var item in query)
            {
                dv.RowFilter = &quot;ContainerID=&quot; + item.PlanningID;
                DvPar.RowFilter = &quot;ContainerID=1&quot;;

                if (dv.Count &gt; 0)
                {
                    dv[0][column.ColumnName] = item.TotalAmount;

                    if (!string.IsNullOrEmpty(DvPar[0][column.ColumnName].ToString()))
                        DvPar[0][column.ColumnName] = Convert.ToDecimal(DvPar[0][column.ColumnName]) + Convert.ToDecimal(item.TotalAmount);
                    else
                        DvPar[0][column.ColumnName] = Convert.ToDecimal(item.TotalAmount);
                }
            }
        }

        private void BindItemDetailsGrid(string filter)
        {
            if (ScheduleData == null)
            {
                if (isSnapshot)
                {
                    ScheduleData = PlanningManagementManager.Instance.GetProgramForecastSnapshot(InstanceId, SnapshotID);
                }
                else
                {
                    ScheduleData = PlanningManagementManager.Instance.GetProgramForecastDetails(InstanceId);
                }
            }


            ScheduleData.Tables[0].TableName = &quot;Container&quot;;
            ScheduleData.Tables[1].TableName = &quot;Items&quot;;
            //ScheduleData.Tables[2].TableName = &quot;ItemSummary&quot;;

            HGrid.ContainerTable = ScheduleData.Tables[&quot;Container&quot;];
            HGrid.ItemTable = ScheduleData.Tables[&quot;Items&quot;];
            //HGrid.ItemSummaryTable = ScheduleData.Tables[&quot;ItemSummary&quot;];
            HGrid.ContainerIDColumn = &quot;ContainerID&quot;;
            HGrid.ParentContainerIDColumn = &quot;ParentContainerID&quot;;
            HGrid.ContainerNameColumn = &quot;Title&quot;;

            HGrid.ItemIDColumn = &quot;ItemID&quot;;
            HGrid.ItemNameColumn = &quot;ProjectName&quot;;
            HGrid.ItemContainerIDColumn = &quot;ContainerID&quot;;


            ////HGrid.ContainerTable = dt;
            ////HGrid.ItemTable = ScheduleData.Tables[&quot;Container&quot;];
            //////HGrid.ItemSummaryTable = ScheduleData.Tables[&quot;ItemSummary&quot;];
            ////HGrid.ContainerIDColumn = &quot;ID&quot;;
            //////HGrid.ParentContainerIDColumn = &quot;ParentContainerID&quot;;
            ////HGrid.ContainerNameColumn = &quot;Item&quot;;

            ////HGrid.ItemIDColumn = &quot;ContainerID&quot;;
            ////HGrid.ItemNameColumn = &quot;ContainerName&quot;;
            ////HGrid.ItemContainerIDColumn = &quot;ContainerID&quot;;

            HGrid.AmountColumn = AmountColumn();
            //If there is no mode or the mode is View then the user should not able to modify the grid column values
            if ((Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) ||
                (!string.IsNullOrEmpty(ViewState[&quot;QPStatus&quot;].ToString2()) &amp;&amp;
                 ViewState[&quot;QPStatus&quot;].ToString2().Equals(&quot;approved&quot;, StringComparison.CurrentCultureIgnoreCase)))
            {
               HGrid.IsReadOnly = true;
            }
            else
            {
                HGrid.IsCompleteReadOnly = HGrid.IsReadOnly = false;
            }

            HGrid.Columns = HGridColumns(CurrentLowerLimit);
            HGrid.IsItemSummaryVisible = false;
            HGrid.disableGridSaveButton = true;

            HGrid.FetchActivities += HGrid_FetchActivities;
            HGrid.FetchSubItems += HGrid_FetchSubItems;
            HGrid.saveEditedItems += HGrid_saveEditedItems;
            HGrid.SaveControlSettings += HGrid_SaveControlSettings;
            HGrid.MoveForward += btnFwdGhost_Click;
            HGrid.MoveBackward += btnBwdGhost_Click;
            HGrid.PersistPlanningDatatoDatabase += btnSave_Click;
            HGrid.FindControl(&quot;ESI&quot;).EnableViewState = false;

            HGrid.Bind();
        }

        private void HGrid_SaveControlSettings(object sender, EventArgs e)
        {
            throw new NotImplementedException();
        }

        private void HGrid_saveEditedItems(object sender, ItemsArgs e)
        {
            foreach (var dic in e.Items)
            {
                string itemId = dic[&quot;ItemID&quot;];
                if (ScheduleData.Tables[1].Select(&quot;ItemID = &#39;&quot; + itemId + &quot;&#39;&quot;).Length &gt; 0)
                {
                    DataRow itemRow = ScheduleData.Tables[1].Select(&quot;ItemID = &#39;&quot; + itemId + &quot;&#39;&quot;)[0];
                    foreach (var pair in dic)
                    {
                        if (itemRow[pair.Key] != null)
                        {
                            if (string.IsNullOrEmpty(pair.Value.Trim()))
                                itemRow[pair.Key] = DBNull.Value;
                            else
                                itemRow[pair.Key] = pair.Value.Trim().ToDecimal2();
                        }
                    }
                    decimal plannedQty = 0, quantity;
                    int scheduleId;
                    foreach (DataColumn schedule in itemRow.Table.Columns)
                    {
                        if (int.TryParse(schedule.ColumnName, out scheduleId))
                            plannedQty += (decimal.TryParse(itemRow[schedule].ToString2(), out quantity) ? quantity : 0);
                    }
                    itemRow[&quot;RemainingAmount&quot;] = itemRow[&quot;TotalCost&quot;].ToDecimal2() - plannedQty;
                }
            }

            try
            {
                HGrid.CallbackResult = &quot;1&quot;;
            }
            catch (Exception ex)
            {
                HGrid.CallbackResult = &quot;Error:&quot; + ex.Message;
            }
        }

        private void HGrid_FetchSubItems(HierarchicalGrid sender, int itemID)
        {
            sender.SubItemTable = new DataTable();
        }

        private void HGrid_FetchActivities(HierarchicalGrid sender, int itemID)
        {
            sender.ActivityTable = new DataTable();
        }

        private HierarchicalGridColumns HGridColumns(int lowerLimit)
        {
            var tempHGridColumns = new HierarchicalGridColumns();

            List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
            string qtyColumnName = ModuleComponents.Contains(&quot;UnitQuantityModel&quot;) ?
                LocalizationManager.GetString(&quot;Amount&quot;) : LocalizationManager.GetString(&quot;Quantity&quot;);

            tempHGridColumns.TreeColumnWidth = 180;
            HGrid.TreeColumnShowChildCount = true;
            HGrid.TreeColumnShowChildCountForRoot = false;
            HGrid.TreeColumnContainerNavigateUrl = string.Format(&quot;/Default.aspx#/Common/BrixForm.aspx?Context=PROGRAM&amp;PID=0&amp;ParentID=0&amp;Mode=Edit&amp;InstanceID={0}&quot;, InstanceId);
            HGrid.TreeColumnNavigateURL =
                &quot;/Default.aspx#/Modules/PROJECT/CreateProjects.aspx?PID={PARENTINSTANCEID}&amp;PP=1&amp;nt=1&amp;Mode=Edit&quot;;

            if (IsRequiredProjectForecastUpdated)
            {
                tempHGridColumns.Add(new HierarchicalGridColumn(&quot;ProjectForecastUpdated&quot;, 200, false, null, false, &quot;Project Forecast Updated&quot;));
                tempHGridColumns.Add(new HierarchicalGridColumn(&quot;UpdatedDate&quot;, 200, false, null, false, &quot;Updated Date&quot;));
            }

            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;Description&quot;, 200, false, 3));
            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;StatusName&quot;, 200, false, null, false, &quot;Project Status&quot;));


            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;TotalCost&quot;, 100, false, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, true, &quot;Amount&quot;, 3));
            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;RemainingAmount&quot;, 100, false, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, true,
                                                        &quot;Remaining Amount&quot;, 3));

            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;CumulativeValueBeforeForecastWindow&quot;, 100, false, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, true, &quot;Before&quot;, 3));
            tempHGridColumns.Add(new HierarchicalGridColumn(&quot;CumulativeValueAfterForecastWindow&quot;, 100, false, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, true, &quot;After&quot;, 3));

            int currentScheduleNumber = 0;
            //if (ScheduleData.Tables.Count &gt; 5 &amp;&amp; ScheduleData.Tables[5].Rows.Count &gt; 0)
            //{
            //    currentScheduleNumber = ScheduleData.Tables[5].Rows[0][&quot;Number&quot;].ToInt32_2();
            //}

            if (CurrentUpperLimit &gt; 0)
            {
                for (int i = lowerLimit; i &lt;= CurrentUpperLimit; i++)
                    tempHGridColumns.Add(new HierarchicalGridColumn(i.ToString2(), 100, (WPStatus.ToUpper() != &quot;APPROVED&quot; &amp;&amp; WPStatus.ToUpper() != &quot;CLOSED&quot;) &amp;&amp; i &gt;= currentScheduleNumber &amp;&amp; !isSnapshot, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                        true, GetColumnHeader(i), 3));
            }
            return tempHGridColumns;
        }

        private string GetColumnHeader(int number)
        {
            if (ScheduleData.Tables.Count &gt;= 2 &amp;&amp; ScheduleData.Tables[2].Rows.Count &gt; 0)
            {
                DataRow currentRow = ScheduleData.Tables[2].Select(&quot;Number = &#39;&quot; + number + &quot;&#39;&quot;)[0];
                DateTime dateColName;

                if (ScheduleData.Tables[2].Columns.Contains(&quot;Name&quot;))
                {
                    if (currentRow[&quot;PeriodBasis&quot;].ToString2().Equals(&quot;2&quot;) &amp;&amp;
                        DateTime.TryParse(currentRow[&quot;Name&quot;].ToString2(), out dateColName))
                        return dateColName.ToMWDateTimeString_FormatDate();
                    else
                        return currentRow[&quot;Name&quot;].ToString2();
                }
                else
                    return @&quot;Week &quot; + (number - StartNo + 1) + &quot;: &quot; +
                           currentRow[&quot;StartDate&quot;].ToDateTimeAndSetKindToUtc().ToMWDateTimeString_FormatDate()
                           + &quot; - &quot; + currentRow[&quot;EndDate&quot;].ToDateTimeAndSetKindToUtc().ToMWDateTimeString_FormatDate();
            }
            else
                return string.Empty;
        }

        public HierarchicalGridColumn AmountColumn()
        {
            var col = new HierarchicalGridColumn(&quot;Amount&quot;, 120, AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, false);
            col.Caption = &quot;Amount in &quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
            return col;
        }


        private void HideMenu(string buttonID, bool bUnHide)
        {
            if (bUnHide) MainToolBar.ShowMenu(buttonID);
            else MainToolBar.HideMenu(buttonID);
        }

        protected override void CreateContextMenu()
        {
            HGrid.GetContextMenu(CMenu.CMenuArray);

            base.CreateContextMenu();
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[32,9,32,38,1],[33,34,33,38,1],[33,39,33,43,1],[35,34,35,38,0],[35,39,35,43,1],[37,35,37,39,1],[37,40,37,44,1],[45,17,45,18,1],[45,19,45,103,1],[45,104,45,105,1],[46,17,46,18,0],[46,19,46,47,0],[46,48,46,49,0],[48,40,48,41,1],[48,42,48,68,1],[48,69,48,70,1],[51,17,51,18,1],[51,19,51,73,1],[51,74,51,75,1],[56,17,56,18,1],[56,19,56,64,1],[56,65,56,66,1],[57,17,57,18,1],[57,19,57,48,1],[57,49,57,50,1],[62,17,62,18,1],[62,19,62,62,1],[62,63,62,64,1],[63,17,63,18,1],[63,19,63,46,1],[63,47,63,48,1],[68,17,68,18,1],[68,19,68,74,1],[68,75,68,76,1],[69,17,69,18,1],[69,19,69,58,1],[69,59,69,60,1],[74,17,74,18,1],[74,19,74,74,1],[74,75,74,76,1],[75,17,75,18,1],[75,19,75,58,1],[75,59,75,60,1],[80,17,80,18,1],[80,19,80,73,1],[80,74,80,75,1],[81,17,81,18,1],[81,19,81,63,1],[81,64,81,65,1],[86,9,86,10,1],[87,13,87,50,1],[88,13,88,31,1],[89,9,89,10,1],[92,9,92,10,1],[93,13,93,30,1],[94,17,94,83,1],[96,13,96,110,1],[98,13,98,71,1],[100,13,100,84,1],[101,17,101,60,0],[103,13,103,47,1],[105,13,105,30,1],[108,21,108,74,1],[109,21,109,68,1],[110,21,110,27,1],[112,21,112,74,1],[113,21,113,68,1],[114,21,114,27,1],[118,21,118,74,0],[119,21,119,68,0],[121,21,121,27,0],[124,13,124,41,1],[125,13,125,50,1],[126,13,126,14,1],[127,17,127,62,1],[128,17,128,47,1],[129,17,129,51,1],[130,17,130,47,1],[131,13,131,14,1],[132,13,132,28,1],[133,9,133,10,1],[136,9,136,10,1],[137,13,137,35,1],[138,13,138,39,1],[140,13,140,64,1],[141,13,141,63,1],[146,13,146,88,1],[147,13,147,105,1],[148,13,148,93,1],[149,13,149,29,1],[150,13,150,14,1],[151,17,151,107,1],[152,17,152,104,1],[153,13,153,14,1],[155,13,155,49,1],[156,13,156,14,1],[161,17,161,113,1],[162,17,162,118,1],[164,13,164,14,1],[165,13,165,42,1],[167,13,167,49,1],[170,13,170,29,1],[171,17,171,42,1],[172,13,172,40,1],[175,13,175,58,1],[176,9,176,10,1],[179,9,179,10,0],[180,13,180,42,0],[181,13,181,92,0],[183,13,183,14,0],[184,17,184,35,0],[185,17,185,32,0],[186,17,186,18,0],[187,21,187,112,0],[188,17,188,18,0],[190,17,190,18,0],[191,21,191,99,0],[192,17,192,18,0],[194,17,194,167,0],[196,17,196,40,0],[197,17,197,72,0],[198,17,198,179,0],[199,17,199,48,0],[201,17,201,76,0],[202,21,202,28,0],[204,17,204,267,0],[206,17,206,93,0],[207,17,207,92,0],[208,17,208,92,0],[209,17,209,101,0],[210,17,210,92,0],[211,17,211,91,0],[212,17,212,53,0],[214,17,214,58,0],[215,17,215,143,0],[216,17,216,127,0],[217,17,217,66,0],[218,17,218,89,0],[221,17,221,40,0],[223,17,223,53,0],[225,17,225,91,0],[227,17,227,40,0],[228,17,228,36,0],[229,22,229,31,0],[229,33,229,58,0],[229,60,229,63,0],[230,17,230,18,0],[232,21,232,91,0],[233,21,233,22,0],[235,25,235,66,0],[236,25,236,64,0],[237,25,237,99,0],[238,25,238,56,0],[239,21,239,22,0],[240,17,240,18,0],[242,17,242,191,0],[244,13,244,14,0],[245,13,245,33,0],[246,13,246,14,0],[247,17,247,37,0],[248,13,248,14,0],[249,9,249,10,0],[252,9,252,10,0],[253,13,253,42,0],[255,13,255,14,0],[258,17,258,114,0],[259,17,259,35,0],[260,17,260,18,0],[261,21,261,172,0],[263,21,263,118,0],[264,21,264,44,0],[265,21,265,55,0],[266,17,266,18,0],[268,17,268,86,0],[269,17,269,133,0],[272,13,272,14,0],[273,13,273,33,0],[274,13,274,14,0],[275,17,275,37,0],[276,13,276,14,0],[277,9,277,10,0],[280,9,280,10,1],[281,13,281,57,1],[282,17,282,49,1],[283,13,283,59,1],[284,17,284,53,1],[285,9,285,10,1],[288,9,288,10,1],[289,13,289,93,1],[290,13,290,14,1],[293,17,293,69,1],[294,17,294,18,0],[302,21,302,53,0],[303,17,303,18,0],[304,13,304,14,1],[305,13,305,80,1],[306,13,306,80,1],[308,13,308,80,1],[309,13,309,99,1],[311,13,311,84,1],[312,13,312,103,1],[314,13,314,72,1],[315,17,315,89,1],[316,13,316,76,1],[317,17,317,93,1],[319,13,319,67,1],[320,13,320,14,1],[321,17,321,109,1],[322,17,323,89,1],[324,17,324,18,1],[325,21,325,55,1],[326,17,326,18,1],[328,17,328,18,1],[329,21,329,88,1],[330,17,330,18,1],[331,13,331,14,1],[332,13,332,58,1],[333,13,333,95,1],[334,13,334,80,1],[336,13,336,29,1],[337,13,337,14,1],[338,17,340,106,1],[341,17,341,95,1],[342,13,342,14,1],[343,9,343,10,1],[346,9,346,10,0],[349,13,349,31,0],[350,17,350,45,0],[351,13,351,25,0],[352,13,352,38,0],[353,13,353,47,0],[354,9,354,10,0],[357,9,357,10,1],[358,13,358,28,1],[359,13,359,14,0],[360,17,362,99,0],[363,17,363,56,0],[364,13,364,14,0],[366,13,366,14,1],[367,17,370,109,1],[371,13,371,14,0],[372,9,372,10,0],[375,9,375,10,1],[376,13,376,46,1],[377,13,377,57,1],[377,58,377,84,0],[378,18,378,51,1],[379,13,379,45,1],[380,13,380,14,1],[381,17,381,47,1],[382,13,382,14,1],[384,13,384,14,0],[385,17,385,53,0],[386,13,386,14,0],[387,13,387,43,1],[388,13,388,14,1],[389,17,389,43,1],[390,13,390,14,1],[392,13,392,14,1],[393,17,393,49,1],[394,13,394,14,1],[395,13,395,47,1],[396,9,396,10,1],[399,9,399,10,1],[400,13,400,48,1],[401,13,401,54,1],[401,55,401,97,1],[402,13,402,54,1],[403,13,403,54,1],[403,55,403,88,1],[404,13,404,45,1],[405,13,405,14,1],[406,17,406,47,1],[407,13,407,14,1],[409,13,409,14,1],[410,17,410,53,1],[411,13,411,14,1],[412,13,412,43,1],[413,13,413,14,1],[414,17,414,43,1],[415,13,415,14,1],[417,13,417,14,0],[418,17,418,49,0],[419,13,419,14,0],[421,13,421,47,1],[422,9,422,10,1],[425,9,425,10,1],[426,13,426,100,1],[428,13,428,58,1],[429,13,429,51,1],[432,13,432,29,1],[434,13,434,29,1],[435,13,435,14,1],[436,17,436,29,1],[437,17,437,37,1],[438,17,438,18,0],[439,21,439,142,0],[440,21,440,45,0],[441,17,441,18,0],[442,13,442,14,1],[444,13,444,47,1],[445,13,445,81,1],[446,17,447,107,1],[450,9,450,10,1],[453,9,453,10,1],[454,13,454,28,1],[455,13,455,14,0],[456,17,456,118,0],[457,13,457,14,0],[459,13,459,14,1],[460,17,460,105,1],[461,13,461,14,1],[463,13,463,33,1],[464,13,464,102,1],[466,13,466,56,1],[467,13,467,46,1],[468,13,468,62,1],[470,13,470,30,1],[471,13,471,14,1],[472,17,472,100,1],[473,17,473,89,1],[474,17,474,61,1],[475,17,475,18,1],[476,21,476,47,1],[477,17,477,18,1],[478,22,478,80,1],[479,13,479,14,1],[481,9,481,10,1],[484,9,484,10,1],[485,13,485,54,1],[488,13,488,80,1],[489,13,489,79,1],[490,13,490,112,1],[491,13,491,111,1],[494,13,494,20,1],[494,22,494,43,1],[494,44,494,46,1],[494,47,494,67,1],[495,13,495,14,1],[496,17,496,79,1],[497,17,497,18,1],[498,21,498,109,1],[499,21,499,109,1],[500,17,500,18,1],[501,13,501,14,1],[504,13,504,20,1],[504,22,504,38,1],[504,39,504,41,1],[504,42,504,66,1],[505,13,505,14,1],[506,17,506,57,1],[507,17,507,95,1],[508,17,508,49,1],[509,17,509,18,1],[511,21,511,130,1],[512,21,512,128,1],[515,21,515,28,1],[515,30,515,51,1],[515,52,515,54,1],[515,55,515,75,1],[516,21,516,22,1],[517,25,517,87,1],[518,25,518,26,1],[519,29,519,116,1],[520,25,520,26,1],[521,21,521,22,1],[522,17,522,18,1],[523,13,523,14,1],[526,13,526,29,1],[527,17,527,63,0],[529,17,529,60,1],[531,9,531,10,1],[534,9,534,10,0],[542,13,542,23,0],[543,13,543,26,0],[545,13,545,54,0],[546,13,546,47,0],[547,13,547,51,0],[549,13,549,57,0],[550,13,550,63,0],[552,13,552,66,0],[553,13,553,72,0],[555,13,555,69,0],[556,13,556,68,0],[558,13,558,20,0],[558,22,558,43,0],[558,44,558,46,0],[558,47,558,67,0],[559,13,559,14,0],[560,17,560,79,0],[561,17,561,18,0],[562,21,563,39,0],[563,39,563,71,0],[563,71,564,48,0],[564,48,564,81,0],[564,81,565,40,0],[565,40,568,66,0],[568,66,568,110,0],[568,110,569,34,0],[565,40,569,34,0],[569,34,569,35,0],[562,21,569,35,0],[571,21,571,43,0],[572,21,572,22,0],[573,25,573,32,0],[573,34,573,42,0],[573,43,573,45,0],[573,46,573,51,0],[574,25,574,26,0],[575,29,575,77,0],[577,29,577,46,0],[578,29,578,30,0],[579,33,579,81,0],[580,29,580,30,0],[581,29,581,76,0],[582,29,582,30,0],[584,33,584,207,0],[586,33,586,287,0],[588,33,588,296,0],[589,29,589,30,0],[590,25,590,26,0],[591,21,591,22,0],[593,21,593,22,0],[594,25,594,72,0],[595,29,595,203,0],[596,21,596,22,0],[597,17,597,18,0],[598,13,598,14,0],[600,13,600,33,0],[601,17,601,75,0],[602,9,602,10,0],[605,9,605,10,0],[607,13,607,23,0],[608,13,609,40,0],[609,40,609,67,0],[609,67,610,32,0],[610,32,613,58,0],[613,58,613,91,0],[613,91,614,26,0],[610,32,614,26,0],[614,26,614,27,0],[608,13,614,27,0],[616,13,616,20,0],[616,22,616,30,0],[616,31,616,33,0],[616,34,616,39,0],[617,13,617,14,0],[618,17,618,43,0],[619,13,619,14,0],[620,13,620,26,0],[621,9,621,10,0],[624,9,624,10,1],[627,13,627,60,1],[628,13,628,63,1],[630,13,630,20,1],[630,22,630,39,1],[630,40,630,42,1],[630,43,630,63,1],[631,13,631,14,1],[632,17,632,198,1],[633,17,633,18,1],[634,21,634,67,1],[635,17,635,18,1],[636,13,636,14,1],[637,9,637,10,1],[640,9,640,10,1],[641,13,642,40,1],[642,40,642,73,1],[642,73,643,32,1],[643,32,646,58,1],[646,58,646,98,1],[646,98,647,26,1],[643,32,647,26,1],[647,26,647,27,1],[641,13,647,27,1],[649,13,649,20,1],[649,22,649,30,1],[649,31,649,33,1],[649,34,649,39,1],[650,13,650,14,1],[651,17,651,65,1],[652,17,652,51,1],[654,17,654,34,1],[655,17,655,18,1],[656,21,656,65,1],[658,21,658,87,1],[659,25,659,140,0],[661,25,661,91,1],[662,17,662,18,1],[663,13,663,14,1],[664,9,664,10,1],[667,9,667,10,1],[668,13,668,38,1],[669,13,669,14,0],[670,17,670,32,0],[671,17,671,18,0],[672,21,672,122,0],[673,17,673,18,0],[675,17,675,18,0],[676,21,676,109,0],[677,17,677,18,0],[678,13,678,14,0],[681,13,681,60,1],[682,13,682,56,1],[685,13,685,69,1],[686,13,686,60,1],[688,13,688,53,1],[689,13,689,65,1],[690,13,690,49,1],[692,13,692,43,1],[693,13,693,50,1],[694,13,694,57,1],[708,13,708,49,1],[710,13,712,115,1],[713,13,713,14,1],[714,16,714,40,1],[715,13,715,14,1],[717,13,717,14,1],[718,17,718,69,1],[719,13,719,14,1],[721,13,721,61,1],[722,13,722,48,1],[723,13,723,48,1],[725,13,725,60,1],[726,13,726,56,1],[727,13,727,60,1],[728,13,728,68,1],[729,13,729,52,1],[730,13,730,53,1],[731,13,731,66,1],[732,13,732,62,1],[734,13,734,26,1],[735,9,735,10,1],[738,9,738,10,0],[739,13,739,49,0],[743,9,743,10,0],[744,13,744,20,0],[744,22,744,29,0],[744,30,744,32,0],[744,33,744,40,0],[745,13,745,14,0],[746,17,746,47,0],[747,17,747,91,0],[748,17,748,18,0],[749,21,749,101,0],[750,21,750,28,0],[750,30,750,38,0],[750,39,750,41,0],[750,42,750,45,0],[751,21,751,22,0],[752,25,752,55,0],[753,25,753,26,0],[754,29,754,73,0],[755,33,755,66,0],[757,33,757,84,0],[758,25,758,26,0],[759,21,759,22,0],[760,21,760,43,0],[762,21,762,28,0],[762,30,762,49,0],[762,50,762,52,0],[762,53,762,74,0],[763,21,763,22,0],[764,25,764,79,0],[765,29,765,122,0],[766,21,766,22,0],[767,21,767,97,0],[768,17,768,18,0],[769,13,769,14,0],[772,13,772,14,0],[773,17,773,44,0],[774,13,774,14,0],[775,13,775,33,0],[776,13,776,14,0],[777,17,777,62,0],[778,13,778,14,0],[779,9,779,10,0],[782,9,782,10,0],[783,13,783,51,0],[784,9,784,10,0],[787,9,787,10,0],[788,13,788,52,0],[789,9,789,10,0],[792,9,792,10,1],[793,13,793,66,1],[795,13,795,111,1],[796,13,797,101,1],[799,13,799,52,1],[800,13,800,51,1],[801,13,801,59,1],[802,13,802,175,1],[803,13,804,113,1],[806,13,806,50,1],[807,13,807,14,1],[808,17,808,145,1],[809,17,809,122,1],[810,13,810,14,1],[812,13,812,92,1],[813,13,813,119,1],[816,13,816,154,1],[817,13,818,81,1],[820,13,820,180,1],[821,13,821,178,1],[823,13,823,43,1],[829,13,829,39,1],[830,13,830,14,1],[831,22,831,40,1],[831,42,831,64,1],[831,66,831,69,1],[832,21,833,55,1],[834,13,834,14,1],[835,13,835,37,1],[836,9,836,10,1],[839,9,839,10,1],[840,13,840,89,1],[841,13,841,14,1],[842,17,842,100,1],[845,17,845,69,1],[846,17,846,18,1],[847,21,848,92,1],[849,25,849,76,0],[851,25,851,63,1],[854,21,856,120,0],[859,17,859,37,0],[860,9,860,10,1],[863,9,863,10,1],[864,13,864,120,1],[865,13,865,106,1],[866,13,866,24,1],[867,9,867,10,1],[871,9,871,10,1],[872,13,872,25,1],[872,26,872,57,1],[873,18,873,49,0],[874,9,874,10,1],[877,9,877,10,1],[878,13,878,52,1],[880,13,880,38,1],[881,9,881,10,1]]);
    </script>
  </body>
</html>