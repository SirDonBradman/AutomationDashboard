<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\UserControls\TelerikRibbonBar.ascx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Xml.Serialization;
using Aurigo.AMP3.Core.AbstractModels;
using Telerik.Web.UI;
using System.Text;
using System.Web;

namespace Aurigo.AMP3.Core.UserControls
{
    [Serializable]
    public enum MenuStyle
    {
        LargeButton,
        TextIcon,
        Icon,
        MenuButton
    };

    public enum ButtonSize
    {
        Large,
        Medium,
        Small
    };

    /// &lt;summary&gt;
    /// Represents Toolbar that holds all the buttons.
    /// &lt;/summary&gt;
    [Serializable]
    public partial class ToolBar : UserControl
    {
        public List&lt;MenuGroup&gt; Groups;
        private RibbonBarTab _defaultRibbonTab;
        private string _baseImagePath;

        public event EventHandler MenuItemClick;

        public string RadRibbonBarControl_ClientId { get { return RadRibbonBarControl.ClientID; } }

        public ToolBar()
        {
            Groups = new List&lt;MenuGroup&gt;();

            _defaultRibbonTab = new RibbonBarTab();
        }

        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;m&quot;&gt;menu item reference&lt;/param&gt;
        /// &lt;param name=&quot;isCompareWithTextValue&quot;&gt;by default it compares with the ID field&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        private void GenerateAndAppendJSValidationFunctions(ref StringBuilder sbrReference, Menu m, bool isCompareWithTextValue = false)
        {
            if (m == null) return;

            if ((m is LargeButton &amp;&amp; (m as LargeButton).HasSubMenus) ||
                (m is TextIcon &amp;&amp; (m as TextIcon).SubMenus.Count &gt; 0) ||
                (m is MenuButton &amp;&amp; (m as MenuButton).SubMenus.Count &gt; 0) ||
                (m is SplitButton &amp;&amp; (m as SplitButton).SubMenus.Count &gt; 0)
                )
            {
                List&lt;Menu&gt; subMenus = new List&lt;Menu&gt;();

                if (m is LargeButton) subMenus = (m as LargeButton).SubMenus;
                else if (m is TextIcon) subMenus = (m as TextIcon).SubMenus;
                else if (m is SplitButton) subMenus = (m as SplitButton).SubMenus;
                else if (m is MenuButton) subMenus = (m as MenuButton).SubMenus;

                for (int k = 0; k &lt; subMenus.Count; k++)
                {
                    GenerateAndAppendJSValidationFunctions(ref sbrReference, subMenus[k], isCompareWithTextValue);
                }
            }

            string compareString = !isCompareWithTextValue ? m.ID : System.Web.HttpUtility.HtmlDecode(m.Text);//BugFix: This decode has been done as the Text returned will be in decoded form

            sbrReference.Append(&quot; if (button === &#39;&quot; + System.Web.HttpUtility.JavaScriptStringEncode(compareString) + &quot;&#39;) {&quot;);// Encode has to be done here as the compare string can contain javascript special symbols like a single quote

            if (!string.IsNullOrEmpty(m.OnClientClick))
                sbrReference.Append(&quot; if (&quot; + m.OnClientClick + &quot; === false) { args.set_cancel(true); }; &quot;);

            sbrReference.Append(&quot;}&quot;);
        }

        // This function can be called n times,just to refresh the configuration and take the latest changes from the MenuGroup.
        // Note that we just change the Menus&#39; properties and refer to the same instance of Menus (linkbuttons) every time we call RenderToolBar
        private void RenderToolBar()
        {
            _defaultRibbonTab.Groups.Clear();

            Groups.ForEach(
                grp =&gt;
                {
                    List&lt;LargeButton&gt; largeButtons = grp.Menus.OfType&lt;LargeButton&gt;().ToList();
                    List&lt;TextIcon&gt; textIcon = grp.Menus.OfType&lt;TextIcon&gt;().ToList();
                    List&lt;Icon&gt; icons = grp.Menus.OfType&lt;Icon&gt;().ToList();
                    List&lt;MenuButton&gt; menuButtons = grp.Menus.OfType&lt;MenuButton&gt;().ToList();
                    List&lt;SplitButton&gt; splitButtons = grp.Menus.OfType&lt;SplitButton&gt;().ToList();

                    if ((largeButtons.Count &gt; 0 || textIcon.Count &gt; 0 || icons.Count &gt; 0 || splitButtons.Any() || menuButtons.Count&gt;0) &amp;&amp;
                        (largeButtons.Any(lb =&gt; lb.Visible) || textIcon.Any(ti =&gt; ti.Visible) || icons.Any(icn =&gt; icn.Visible) || splitButtons.Any(icn =&gt; icn.Visible) || menuButtons.Any(icn =&gt; icn.Visible)))
                    {
                        RibbonBarGroup ribbonBarGroup =
                           _defaultRibbonTab.Groups.Find(g =&gt; g.Value.ToLower() == grp.Title.ToLower());

                        if (ribbonBarGroup == null)
                        {
                            ribbonBarGroup = new RibbonBarGroup();
                            ribbonBarGroup.Value = grp.Title;
                            ribbonBarGroup.Text = grp.Title;
                            ribbonBarGroup.ID = grp.Title;
                            //ribbonBarGroup.ToolTip = grp.Title;
                            _defaultRibbonTab.Groups.Add(ribbonBarGroup);
                        }

                        RenderLargerButtons(largeButtons, ribbonBarGroup);

                        RenderTextIcons(textIcon, ribbonBarGroup);

                        RenderIcons(icons, ribbonBarGroup);

                        RenderMenuButtons(menuButtons, ribbonBarGroup);

                        RenderSplitButtons(splitButtons, ribbonBarGroup);
                    }
                }
                );
        }

        private void RenderLargerButtons(List&lt;LargeButton&gt; largeButtons, RibbonBarGroup group)
        {
            for (var i = 0; i &lt; largeButtons.Count; i++)
            {
                LargeButton button = largeButtons[i];

                if (button.HasSubMenus)
                {
                    RenderSplitButtons(button, group);
                    continue;
                }

                RibbonBarButton ribbonBarButton = CreateRibbonBarButton(button);

                button.RibbonBarItem = ribbonBarButton;

                group.Items.Add(ribbonBarButton);
            }
        }

        private void RenderTextIcons(List&lt;TextIcon&gt; textIcons, RibbonBarGroup group)
        {
            if (!textIcons.Any(ti =&gt; ti.Visible)) return;

            for (int i = 0; i &lt; textIcons.Count; i++)
            {
                TextIcon textIcon = textIcons[i];

                if (textIcon.SubMenus.Count &gt; 0)
                {
                    RenderSplitButtons(textIcon, group);
                    continue;
                }

                RibbonBarButton ribbonBarButton = CreateRibbonBarButton(textIcon);

                textIcon.RibbonBarItem = ribbonBarButton;

                group.Items.Add(ribbonBarButton);
            }
        }

        private void RenderIcons(List&lt;Icon&gt; icons, RibbonBarGroup group)
        {
            if (!icons.Any(ti =&gt; ti.Visible)) return;

            for (int i = 0; i &lt; icons.Count; i++)
            {
                Icon icon = icons[i];

                RibbonBarButton ribbonBarButton = CreateRibbonBarButton(icon);

                icon.RibbonBarItem = ribbonBarButton;

                group.Items.Add(ribbonBarButton);
            }
        }

        private void RenderMenuButtons(List&lt;MenuButton&gt; menuButtons, RibbonBarGroup ribbonBarGroup)
        {
            for (int i = 0; i &lt; menuButtons.Count; i++)
            {
                RibbonBarMenu ribbonBarMenu = null;
                MenuButton menuButton = menuButtons[i];

                for (int k = 0; k &lt; ribbonBarGroup.Items.Count; k++)
                {
                    if (ribbonBarGroup.Items[k] is RibbonBarMenu &amp;&amp;
                        (ribbonBarGroup.Items[k] as RibbonBarMenu).Text == menuButton.Text)
                    {
                        ribbonBarMenu = (ribbonBarGroup.Items[k] as RibbonBarMenu);
                        break;
                    }
                }

                if (ribbonBarMenu == null)
                {
                    ribbonBarMenu = new RibbonBarMenu();
                    ribbonBarGroup.Items.Add(ribbonBarMenu);
                }

                RibbonBarItemSize buttonSize = RibbonBarItemSize.Large;

                if (menuButton.ButtonSize == ButtonSize.Large) buttonSize = RibbonBarItemSize.Large;
                else if (menuButton.ButtonSize == ButtonSize.Medium) buttonSize = RibbonBarItemSize.Medium;
                else if (menuButton.ButtonSize == ButtonSize.Small) buttonSize = RibbonBarItemSize.Small;

                ribbonBarMenu.Text = HttpUtility.HtmlDecode(menuButton.Text);
                ribbonBarMenu.ID = menuButton.ID;
                ribbonBarMenu.ImageUrl = _baseImagePath + menuButton.ImageURL;
                ribbonBarMenu.ImageUrlLarge = _baseImagePath + menuButton.ImageURL;
                ribbonBarMenu.Enabled = menuButton.Enabled;
                ribbonBarMenu.Size = buttonSize;

                ribbonBarMenu.Attributes.Add(&quot;aria-label&quot;, menuButton.Text);

                ribbonBarMenu.DisabledImageUrlLarge = !string.IsNullOrEmpty(menuButton.DisabledImageURL)
                    ? menuButton.DisabledImageURL
                    : _baseImagePath +
                      ((menuButton.ImageURL.Contains(&quot;_Disable&quot;))
                          ? menuButton.ImageURL
                          : menuButton.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
                ribbonBarMenu.DisabledImageUrl = !string.IsNullOrEmpty(menuButton.DisabledImageURL)
                    ? menuButton.DisabledImageURL
                    : _baseImagePath +
                      ((menuButton.ImageURL.Contains(&quot;_Disable&quot;))
                          ? menuButton.ImageURL
                          : menuButton.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
                ribbonBarMenu.Visible = menuButton.Visible;

                menuButton.RibbonBarItem = ribbonBarMenu;

                for (int j = 0; j &lt; menuButton.SubMenus.Count; j++)
                {
                    Menu menuItemButton = menuButton.SubMenus[j];
                    RibbonBarMenuItem ribbonBarMenuItem = CreateRibbonBarMenuItem(menuItemButton);

                    menuItemButton.RibbonBarItem = ribbonBarMenuItem;

                    ribbonBarMenu.Items.Add(ribbonBarMenuItem);
                }
            }
        }

        private void RenderSplitButtons(Menu parent, RibbonBarGroup group)
        {
            RibbonBarSplitButton button = new RibbonBarSplitButton();
            List&lt;Menu&gt; subMenus = new List&lt;Menu&gt;();
            RibbonBarItemSize buttonSize = RibbonBarItemSize.Large;

            if (parent is LargeButton)
            {
                subMenus = (parent as LargeButton).SubMenus;
                buttonSize = RibbonBarItemSize.Large;
            }
            else if (parent is TextIcon)
            {
                subMenus = (parent as TextIcon).SubMenus;
                buttonSize = RibbonBarItemSize.Medium;
            }

            button.ID = parent.ID + &quot;_SplitButton&quot;;
            button.Text = HttpUtility.HtmlDecode(parent.Text);
            button.Size = buttonSize;
            //button.ToolTip = parent.ToolTip;

            button.ImageUrl = _baseImagePath + parent.ImageURL;
            button.ImageUrlLarge = _baseImagePath + parent.ImageURL;

            button.DisabledImageUrl = !string.IsNullOrEmpty(parent.DisabledImageURL)
                ? parent.DisabledImageURL
                : _baseImagePath +
                  ((parent.ImageURL.Contains(&quot;_Disable&quot;)) ? parent.ImageURL : parent.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
            button.DisabledImageUrlLarge = !string.IsNullOrEmpty(parent.DisabledImageURL)
                ? parent.DisabledImageURL
                : _baseImagePath +
                  ((parent.ImageURL.Contains(&quot;_Disable&quot;)) ? parent.ImageURL : parent.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));

            button.EnableButtonSelection = false;
            button.ClientIDMode = System.Web.UI.ClientIDMode.Static;

            RibbonBarButton b = CreateRibbonBarButton(parent);
            b.Size = RibbonBarItemSize.Medium;
            b.ImageUrlLarge = &quot;&quot;;
            button.Buttons.Add(b);

            parent.RibbonBarItem = b;

            parent.SynchronizeCustomClientAttributes(button);

            for (int i = 0; i &lt; subMenus.Count; i++)
            {
                Menu menu = subMenus[i];
                RibbonBarButton subMenu = CreateRibbonBarButton(menu);

                subMenu.Size = RibbonBarItemSize.Medium;

                menu.RibbonBarItem = subMenu;

                button.Buttons.Add(subMenu);
            }

            group.Items.Add(button);
        }

        private void RenderSplitButtons(List&lt;SplitButton&gt; buttons, RibbonBarGroup group)
        {
            for (int i = 0; i &lt; buttons.Count; i++)
            {
                SplitButton splitButton = buttons[i];

                if (!splitButton.Visible) continue;

                RibbonBarSplitButton ribbonBarSplitButton = new RibbonBarSplitButton();
                RibbonBarItemSize buttonSize = RibbonBarItemSize.Large;

                if (splitButton.ButtonSize == ButtonSize.Large) buttonSize = RibbonBarItemSize.Large;
                else if (splitButton.ButtonSize == ButtonSize.Medium) buttonSize = RibbonBarItemSize.Medium;
                else if (splitButton.ButtonSize == ButtonSize.Small) buttonSize = RibbonBarItemSize.Small;

                ribbonBarSplitButton.ID = splitButton.ID;
                ribbonBarSplitButton.Text = HttpUtility.HtmlDecode(splitButton.Text);
                ribbonBarSplitButton.Size = buttonSize;
                //ribbonBarSplitButton.ToolTip = splitButton.ToolTip;
                ribbonBarSplitButton.ClientIDMode = System.Web.UI.ClientIDMode.Static;

                ribbonBarSplitButton.ImageUrl = _baseImagePath + splitButton.ImageURL;
                ribbonBarSplitButton.ImageUrlLarge = _baseImagePath + splitButton.ImageURL;


                ribbonBarSplitButton.Attributes.Add(&quot;aria-label&quot;, splitButton.Text);

                ribbonBarSplitButton.DisabledImageUrl = !string.IsNullOrEmpty(splitButton.DisabledImageURL)
                    ? splitButton.DisabledImageURL
                    : _baseImagePath +
                      ((splitButton.ImageURL.Contains(&quot;_Disable&quot;))
                          ? splitButton.ImageURL
                          : splitButton.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
                ribbonBarSplitButton.DisabledImageUrlLarge = !string.IsNullOrEmpty(splitButton.DisabledImageURL)
                    ? splitButton.DisabledImageURL
                    : _baseImagePath +
                      ((splitButton.ImageURL.Contains(&quot;_Disable&quot;))
                          ? splitButton.ImageURL
                          : splitButton.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));

                ribbonBarSplitButton.EnableButtonSelection = true;
                ribbonBarSplitButton.SelectedButtonIndex = 0;

                splitButton.SynchronizeCustomClientAttributes(ribbonBarSplitButton);

                splitButton.RibbonBarItem = ribbonBarSplitButton;

                for (int j = 0; j &lt; splitButton.SubMenus.Count; j++)
                {
                    Menu submenu = splitButton.SubMenus[j];
                    RibbonBarButton ribbonBarButton = CreateRibbonBarButton(submenu);

                    submenu.RibbonBarItem = ribbonBarButton;

                    ribbonBarSplitButton.Buttons.Add(ribbonBarButton);
                }

                group.Items.Add(ribbonBarSplitButton);
            }
        }

        private RibbonBarButton CreateRibbonBarButton(Menu menu)
        {
            RibbonBarButton ribbonBarButton = new RibbonBarButton();
            RibbonBarItemSize buttonSize = RibbonBarItemSize.Large;

            if (menu is LargeButton)
                buttonSize = RibbonBarItemSize.Large;
            else if (menu is TextIcon)
                buttonSize = RibbonBarItemSize.Medium;
            else if (menu is Icon)
                buttonSize = RibbonBarItemSize.Small;

            ribbonBarButton.ID = menu.ID;
            ribbonBarButton.Value = menu.ID;
            ribbonBarButton.Text = HttpUtility.HtmlDecode(menu.Text);
           // ribbonBarButton.ImageAltText = &quot;&quot;;
            ribbonBarButton.Size = buttonSize;
            ribbonBarButton.Enabled = menu.Enabled;
            //ribbonBarButton.ToolTip = menu.ToolTip;
            ribbonBarButton.ClientIDMode = System.Web.UI.ClientIDMode.Static;

            ribbonBarButton.ImageUrl = _baseImagePath + menu.ImageURL;
            ribbonBarButton.ImageUrlLarge = _baseImagePath + menu.ImageURL;

           ribbonBarButton.Attributes.Add(&quot;aria-label&quot;, menu.Text);

            ribbonBarButton.DisabledImageUrl = !string.IsNullOrEmpty(menu.DisabledImageURL)
                ? menu.DisabledImageURL
                : _baseImagePath +
                  ((menu.ImageURL.Contains(&quot;_Disable&quot;)) ? menu.ImageURL : menu.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
            ribbonBarButton.DisabledImageUrlLarge = !string.IsNullOrEmpty(menu.DisabledImageURL)
                ? menu.DisabledImageURL
                : _baseImagePath +
                  ((menu.ImageURL.Contains(&quot;_Disable&quot;)) ? menu.ImageURL : menu.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));

            if (!string.IsNullOrEmpty(menu.PostBackUrl))
                ribbonBarButton.Attributes.Add(&quot;data-postbackurl&quot;, menu.PostBackUrl);

            if (menu.CausesValidation)
                ribbonBarButton.Attributes.Add(&quot;data-causesvalidation&quot;, &quot;true&quot;);
            else
                ribbonBarButton.Attributes.Remove(&quot;data-causesvalidation&quot;);

            if (!string.IsNullOrEmpty(menu.ValidationGroup))
                ribbonBarButton.Attributes.Add(&quot;data-validationgroup&quot;, menu.ValidationGroup);
            else
                ribbonBarButton.Attributes.Remove(&quot;data-validationgroup&quot;);

            ribbonBarButton.Visible = menu.Visible;

            if (menu.Visible)
                ribbonBarButton.Style.Add(&quot;display&quot;, !menu.IsHiddenInUI ? &quot;block&quot; : &quot;none&quot;);

            menu.SynchronizeCustomClientAttributes(ribbonBarButton);

            return ribbonBarButton;
        }

        private RibbonBarMenuItem CreateRibbonBarMenuItem(Menu menu)
        {
            RibbonBarMenuItem ribbonBarMenuItem = new RibbonBarMenuItem();

            ribbonBarMenuItem.ID = menu.ID;
            ribbonBarMenuItem.Text = HttpUtility.HtmlDecode(menu.Text);
            ribbonBarMenuItem.Value = menu.ID;
            ribbonBarMenuItem.Enabled = menu.Enabled;
            ribbonBarMenuItem.ImageUrl = string.IsNullOrEmpty(menu.ImageURL) ? &quot;&quot; : _baseImagePath + menu.ImageURL;
            ribbonBarMenuItem.DisabledImageUrl = !string.IsNullOrEmpty(menu.DisabledImageURL)
                ? menu.DisabledImageURL
                : string.IsNullOrEmpty(menu.ImageURL)
                    ? &quot;&quot;
                    : _baseImagePath +
                      ((menu.ImageURL.Contains(&quot;_Disable&quot;)) ? menu.ImageURL : menu.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;));
            //ribbonBarMenuItem.ToolTip = menu.ToolTip;
            ribbonBarMenuItem.ClientIDMode = System.Web.UI.ClientIDMode.Static;
            ribbonBarMenuItem.Attributes.Add(&quot;aria-label&quot;, menu.Text);
            if (!string.IsNullOrEmpty(menu.PostBackUrl))
                ribbonBarMenuItem.Attributes.Add(&quot;data-postbackurl&quot;, menu.PostBackUrl);

            if (menu.CausesValidation)
                ribbonBarMenuItem.Attributes.Add(&quot;data-causesvalidation&quot;, &quot;true&quot;);
            else
                ribbonBarMenuItem.Attributes.Remove(&quot;data-causesvalidation&quot;);

            if (!string.IsNullOrEmpty(menu.ValidationGroup))
                ribbonBarMenuItem.Attributes.Add(&quot;data-validationgroup&quot;, menu.ValidationGroup);
            else
                ribbonBarMenuItem.Attributes.Remove(&quot;data-validationgroup&quot;);

            ribbonBarMenuItem.Visible = menu.Visible;

            if (menu.Visible)
                ribbonBarMenuItem.Style.Add(&quot;display&quot;, menu.IsHiddenInUI ? &quot;block&quot; : &quot;none&quot;);

            menu.SynchronizeCustomClientAttributes(ribbonBarMenuItem);
            return ribbonBarMenuItem;
        }

        private Menu FindMenu(string menuID)
        {
            Menu menuFound = null;
            Groups.ForEach(
                group =&gt;
                {
                    group.Menus.ForEach(
                        menu =&gt;
                        {
                            if (menu.ID == menuID)
                            {
                                menuFound = menu;
                                return;
                            }
                            else if (menu is LargeButton)
                                (menu as LargeButton).SubMenus.ForEach(
                                    subMenu =&gt;
                                    {
                                        if (subMenu.ID == menuID)
                                        {
                                            menuFound = subMenu;
                                            return;
                                        }
                                    }
                                    );

                            else if (menu is TextIcon)
                                (menu as TextIcon).SubMenus.ForEach(
                                    subMenu =&gt;
                                    {
                                        if (subMenu.ID == menuID)
                                        {
                                            menuFound = subMenu;
                                            return;
                                        }
                                    }
                                    );
                            else if (menu is MenuButton)
                                (menu as MenuButton).SubMenus.ForEach(
                                    subMenu =&gt;
                                    {
                                        if (subMenu.ID == menuID)
                                        {
                                            menuFound = subMenu;
                                            return;
                                        }
                                    }
                                    );
                            else if (menu is SplitButton)
                                (menu as SplitButton).SubMenus.ForEach(
                                    subMenu =&gt;
                                    {
                                        if (subMenu.ID == menuID)
                                        {
                                            menuFound = subMenu;
                                            return;
                                        }
                                    }
                                    );
                        }
                        );
                }
                );

            return menuFound;
        }

        private Menu FindSubMenu(string menuID, string subMenuID)
        {
            Menu menuFound = null;
            Groups.ForEach(
                group =&gt;
                {
                    group.Menus.ForEach(
                        menu =&gt;
                        {
                            if (menu.ID == menuID)
                            {
                                menuFound = menu;

                                if (menu is LargeButton)
                                    (menu as LargeButton).SubMenus.ForEach(
                                        subMenu =&gt;
                                        {
                                            if (subMenu.ID == subMenuID)
                                            {
                                                menuFound = subMenu;
                                                return;
                                            }
                                        }
                                        );

                                else if (menu is TextIcon)
                                    (menu as TextIcon).SubMenus.ForEach(
                                        subMenu =&gt;
                                        {
                                            if (subMenu.ID == subMenuID)
                                            {
                                                menuFound = subMenu;
                                                return;
                                            }
                                        }
                                        );
                                else if (menu is MenuButton)
                                    (menu as MenuButton).SubMenus.ForEach(
                                        subMenu =&gt;
                                        {
                                            if (subMenu.ID == subMenuID)
                                            {
                                                menuFound = subMenu;
                                                return;
                                            }
                                        }
                                        );
                            }
                        }
                        );
                }
                );

            return menuFound;
        }

        /*
        private void AddMenuToViewState(Menu menu, string groupName)
        {
            Dictionary&lt;string, Tuple&lt;Menu, string&gt;&gt; toolbarButtons = null;

            toolbarButtons = (Dictionary&lt;string, Tuple&lt;Menu, string&gt;&gt;)ViewState[&quot;ToolbarButtons&quot;];

            if (toolbarButtons == null)
            {
                toolbarButtons = new Dictionary&lt;string, Tuple&lt;Menu, string&gt;&gt;();
            }

            if (toolbarButtons.ContainsKey(menu.ID))
                toolbarButtons.Remove(menu.ID);

            Tuple&lt;Menu, string&gt; tupleMenuGroup = new Tuple&lt;Menu, string&gt;(menu, groupName);
            toolbarButtons.Add(menu.ID, tupleMenuGroup);

            ViewState[&quot;ToolbarButtons&quot;] = toolbarButtons;
        }
        
        private void AddToolbarButtonsFromViewState()
        {
            Dictionary&lt;string, Tuple&lt;Menu, string&gt;&gt; toolbarButtons = (Dictionary&lt;string, Tuple&lt;Menu, string&gt;&gt;)ViewState[&quot;ToolbarButtons&quot;];

            if (toolbarButtons == null) return;

            foreach(KeyValuePair&lt;string, Tuple&lt;Menu, string&gt;&gt; menuItem in toolbarButtons)
            {
                Tuple&lt;Menu, string&gt; menu = menuItem.Value;

                RibbonBarGroup ribbonBarGroup = _defaultRibbonTab.Groups.Find(x =&gt; x.Text == menu.Item2);

                if (ribbonBarGroup == null)
                {
                    ribbonBarGroup = new RibbonBarGroup();
                    ribbonBarGroup.Text = menu.Item2;
                    ribbonBarGroup.ID = menu.Item2;
                    ribbonBarGroup.Value = menu.Item2;
                    ribbonBarGroup.ToolTip = menu.Item2;

                    _defaultRibbonTab.Groups.Add(ribbonBarGroup);
                }

                if (menu.Item1 is LargeButton)
                {
                    RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.Item1.ID);

                    if (button != null)
                        ribbonBarGroup.Items.Remove(button);

                    List&lt;LargeButton&gt; tempList = new List&lt;LargeButton&gt;();
                    tempList.Add((menu.Item1 as LargeButton));
                    RenderLargerButtons(tempList, ribbonBarGroup);
                }
                else if (menu.Item1 is TextIcon)
                {
                    RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.Item1.ID);

                    if (button != null)
                        ribbonBarGroup.Items.Remove(button);

                    List&lt;TextIcon&gt; tempList = new List&lt;TextIcon&gt;();
                    tempList.Add((menu.Item1 as TextIcon));
                    RenderTextIcons(tempList, ribbonBarGroup);
                }
                else if (menu.Item1 is Icon)
                {
                    RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.Item1.ID);

                    if (button != null)
                        ribbonBarGroup.Items.Remove(button);

                    List&lt;Icon&gt; tempList = new List&lt;Icon&gt;();
                    tempList.Add((menu.Item1 as Icon));
                    RenderIcons(tempList, ribbonBarGroup);
                }
                else if (menu.Item1 is MenuButton)
                {
                    RibbonBarItem button = ribbonBarGroup.Items.Find(x =&gt; x is RibbonBarMenu &amp;&amp; (x as RibbonBarMenu).ID == menu.Item1.ID);

                    if (button != null)
                        ribbonBarGroup.Items.Remove(button);

                    List&lt;MenuButton&gt; tempList = new List&lt;MenuButton&gt;();
                    tempList.Add((menu.Item1 as MenuButton));
                    RenderMenuButtons(tempList, ribbonBarGroup);
                }
            }
        }
          */

        internal void CallRibbonBarButtonClick(object sender, EventArgs e)
        {
            RibbonBarButton b = new RibbonBarButton();

            if (e is RibbonBarButtonClickEventArgs)
                b = ((RibbonBarButtonClickEventArgs)e).Button;

            var eArg = new ToolBarEventArg();
            eArg.Text = b.Text;


            RadRibbonBar toolBar = (RadRibbonBar)sender;

            RibbonBarButton ribbonBarButton = toolBar.FindButtonByValue(b.Value);
            Menu menu = FindMenu(b.Value);

            if (menu != null)
            {
                eArg.Tag = menu.Tag;
                menu.RaiseClickEvent(sender, eArg);
            }

            if (MenuItemClick != null)
                MenuItemClick(sender, eArg);
        }

        internal void CallRibbonBarSplitButtonClick(object sender, EventArgs e)
        {
            RibbonBarButton b = new RibbonBarButton();

            if (e is RibbonBarSplitButtonClickEventArgs)
                b = ((RibbonBarSplitButtonClickEventArgs)e).Button;

            var eArg = new ToolBarEventArg();
            eArg.Text = b.Text;
            //eArg.Tag = b.Value;

            RadRibbonBar toolBar = (RadRibbonBar)sender;

            RibbonBarButton ribbonBarButton = toolBar.FindButtonByValue(b.Value);
            Menu menu = FindMenu(b.Value);

            if (menu != null)
            {
                eArg.Tag = menu.Tag;
                menu.RaiseClickEvent(sender, eArg);
            }

            if (MenuItemClick != null)
                MenuItemClick(sender, eArg);
        }

        internal void CallRibbonBarMenuItemClick(object sender, EventArgs e)
        {
            RibbonBarMenuItem b = new RibbonBarMenuItem();

            if (e is RibbonBarMenuItemClickEventArgs)
                b = ((RibbonBarMenuItemClickEventArgs)e).Item;

            var eArg = new ToolBarEventArg();
            eArg.Text = b.Text;
            //eArg.Tag = b.Value;

            RadRibbonBar toolBar = (RadRibbonBar)sender;

            Menu menu = FindMenu(b.Value);

            if (menu != null)
            {
                eArg.Tag = menu.Tag;
                menu.RaiseClickEvent(sender, eArg);
            }

            if (MenuItemClick != null)
                MenuItemClick(sender, eArg);
        }

        protected override void OnInit(EventArgs e)
        {
            string url = Request.Url.AbsoluteUri;

            //url = url.Replace(Request.Url.PathAndQuery, &quot;&quot;);
            //_baseImagePath = url + &quot;/Images/Officebar/&quot;;

            _baseImagePath = &quot;~/Images/Officebar/&quot;;

            RadRibbonBarControl.ButtonClick += CallRibbonBarButtonClick;
            RadRibbonBarControl.SplitButtonClick += CallRibbonBarSplitButtonClick;
            RadRibbonBarControl.MenuItemClick += CallRibbonBarMenuItemClick;

            RadRibbonBarControl.OnClientButtonClicking = &quot;TelerikRibbonBar_OnClientClicking&quot;;
            RadRibbonBarControl.OnClientSplitButtonClicking = &quot;TelerikRibbonBar_OnClientSplitButtonClicking&quot;;
            RadRibbonBarControl.OnClientMenuItemClicking = &quot;TelerikRibbonBar_OnClientMenuItemClicking&quot;;
            RadRibbonBarControl.OnClientLoad = &quot;TelerikRibbonBar_OnClientLoad&quot;;

            RadRibbonBarControl.Tabs.Add(_defaultRibbonTab);

            EnableUpdatePanelForToolBar();
            base.OnInit(e);
        }

        protected override void OnLoad(EventArgs e)
        {
            base.OnLoad(e);

            //AddToolbarButtonsFromViewState();
        }

        protected override void OnPreRender(EventArgs e)
        {
            StringBuilder runtimeJS = new StringBuilder(), menuItemRuntimeJS = new StringBuilder(), splitButtonRuntimeJS = new StringBuilder();

            runtimeJS.Append(&quot;var buttonToValidate = null; function TelerikRibbonBar_OnClientClicking (sender, args) { if(canRejectEvent(args, &#39;buttonToValidate&#39;)) { args.set_cancel(true); return; }&quot;);
            runtimeJS.Append(&quot;var button = buttonToValidate = args.get_button().get_value(); var element = args.get_button().get_element(); &quot;);

            menuItemRuntimeJS.Append(&quot;function TelerikRibbonBar_OnClientMenuItemClicking (sender, args) {  var button = args.get_item().get_value(); var element = args.get_item().get_element(); &quot;);

            //For Split Button, the value that comes in the argument is always that of the main button, hence compare it with text
            splitButtonRuntimeJS.Append(&quot;function TelerikRibbonBar_OnClientSplitButtonClicking (sender, args) { var button = args.get_button().get_text(); var element = args.get_button().get_element(); &quot;);

            for (int i = 0; i &lt; Groups.Count; i++)
            {
                for (int j = 0; j &lt; Groups[i].Menus.Count; j++)
                {
                    Menu menuItem = Groups[i].Menus[j];
                    if (menuItem is MenuButton)
                        GenerateAndAppendJSValidationFunctions(ref menuItemRuntimeJS, menuItem);
                    else if (menuItem is SplitButton)//For Split Button, the value that comes in the argument is always that of the main button, hence compare it with text
                        GenerateAndAppendJSValidationFunctions(ref splitButtonRuntimeJS, menuItem, isCompareWithTextValue: true);
                    else
                        GenerateAndAppendJSValidationFunctions(ref runtimeJS, menuItem);
                }
            }

            runtimeJS.Append(&quot; ; resetButtonReference(args, &#39;buttonToValidate&#39;); };&quot;);
            menuItemRuntimeJS.Append(&quot; };&quot;);
            splitButtonRuntimeJS.Append(&quot; };&quot;);

            ScriptManager.RegisterClientScriptBlock(upToolbar, upToolbar.GetType(), &quot;RuntimeScript&quot;, runtimeJS.ToString(), true);
            ScriptManager.RegisterClientScriptBlock(upToolbar, upToolbar.GetType(), &quot;MenuItemRuntimeScript&quot;, menuItemRuntimeJS.ToString(), true);
            ScriptManager.RegisterClientScriptBlock(upToolbar, upToolbar.GetType(), &quot;SplitButtonRuntimeScript&quot;, splitButtonRuntimeJS.ToString(), true);

            base.OnPreRender(e);
        }

        /// &lt;summary&gt;
        /// Obsolete method. Use CreateToolBar(List&lt;MenuGroup&gt; groups) instead.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menus&quot;&gt;&lt;/param&gt;
        public void CreateToolBar(MenuArray menus)
        {
            Groups.Clear();
            var General = new MenuGroup(&quot;General&quot;);
            Groups.Add(General);

            foreach (BrixMenu menu in menus)
            {
                var button = new Menu();
                if (menu.MenuStyle == MenuStyle.TextIcon)
                    button = new TextIcon(menu.Id, menu.Name, menu.ImagePath, menu.Link);
                else if (menu.MenuStyle == MenuStyle.Icon)
                    button = new Icon(menu.Id, menu.Name, menu.ImagePath, menu.Link);
                else
                    button = new LargeButton(menu.Id, menu.Name, menu.ImagePath, menu.Link);

                button.Title = menu.ToolTip;
                if (menu.MenuStyle != MenuStyle.TextIcon &amp;&amp; menu.MenuStyle != MenuStyle.Icon
                    &amp;&amp; menu.subMenus != null &amp;&amp; menu.subMenus.Count &gt; 0)
                    foreach (BrixMenu submenu in menu.subMenus)
                    {
                        var submenubutton = new LargeButton(submenu.Id, submenu.Name, submenu.ImagePath, submenu.Link);
                        submenubutton.Title = submenu.ToolTip;
                        ((LargeButton)button).AddSubMenu(submenubutton);
                    }

                General.AddMenu(button);
            }
            RenderToolBar();
        }

        /// &lt;summary&gt;
        /// Creates the toolbar.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;groups&quot;&gt;Groups from which the toolbar is to be created.&lt;/param&gt;
        public void CreateToolBar(List&lt;MenuGroup&gt; groups)
        {
            Groups = groups;
            //if (Groups != null &amp;&amp; Groups.Count &gt; 0 &amp;&amp; !Groups[0].Menus.Any(m =&gt; m.ID == &quot;lnkDummy&quot;))
            //{
            //    //Groups[0].AddMenu(new LargeButton(&quot;lnkDummy&quot;, &quot;Dummy&quot;, &quot;Icn_Save.png&quot;), 0);
            //    //GetMenuReference(&quot;lnkDummy&quot;).Attributes.Add(&quot;class&quot;, &quot;lnkDummyClass&quot;);
            //}
            RenderToolBar();
        }

        public void Bind()
        {
            RenderToolBar();
        }

        /// &lt;summary&gt;
        /// Gets a reference to the toolbar menu.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu&lt;/param&gt;
        /// &lt;returns&gt;object of Menu class&lt;/returns&gt;
        public Menu GetMenuReference(string menuID)
        {
            Menu menu = FindMenu(menuID);

            return menu;
        }

        /// &lt;summary&gt;
        /// Gets a reference to the toolbar sub menu.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu to which the sub menu belongs&lt;/param&gt;
        /// &lt;param name=&quot;subMenuID&quot;&gt;ID of the sub menu&lt;/param&gt;
        /// &lt;returns&gt;object of Menu class&lt;/returns&gt;
        public Menu GetSubMenuReference(string menuID, string subMenuID)
        {
            Menu menu = FindSubMenu(menuID, subMenuID);

            return menu;
        }

        /// &lt;summary&gt;
        /// Adds attribute to the menu.
        /// This method should be used if the attribute is to be added after the toolbar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;id&quot;&gt;ID of the menu to which the attribute is to be added&lt;/param&gt;
        /// &lt;param name=&quot;attibute&quot;&gt;Name of the attribute to be added&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;Value of the attribute&lt;/param&gt;
        public void AddAttributeToMenu(string id, string attibute, string value)
        {
            Menu lnkbutton = GetMenuReference(id);
            if (lnkbutton != null)
                lnkbutton.AddAttribute(attibute, value);
        }

        /// &lt;summary&gt;
        /// Adds attribute to the sub menu.
        /// This method should be used if the attribute is to be added after the toolbar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parentId&quot;&gt;ID of the menu to which the sub menu belongs&lt;/param&gt;
        /// &lt;param name=&quot;id&quot;&gt;ID of the sub menu to which the attribute is to be added&lt;/param&gt;
        /// &lt;param name=&quot;attibute&quot;&gt;Name of the attribute to be added&lt;/param&gt;
        /// &lt;param name=&quot;value&quot;&gt;Value of the attribute&lt;/param&gt;
        public void AddAttributeToSubMenu(string parentId, string id, string attibute, string value)
        {
            Menu lnkbutton = GetSubMenuReference(parentId, id);
            if (lnkbutton != null)
                lnkbutton.AddAttribute(attibute, value);
        }

        /// &lt;summary&gt;
        /// Hides the menu.
        /// This method should be used if the menu needs to be hidden after the tool bar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu to be hidden&lt;/param&gt;
        /// &lt;param name=&quot;doBind&quot;&gt;Obsolete parameter. Has no effect&lt;/param&gt;
        public void HideMenu(string menuID, bool doBind = true)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.Visible = false;
                //if (menu.lnkButton.Parent != null) menu.lnkButton.Parent.Visible = false;
                //if (doBind) Bind();
            }
        }

        /// &lt;summary&gt;
        /// Makes the menu visible.
        /// This method should be used if the menu needs to be made visible after the tool bar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu to be made visible&lt;/param&gt;
        /// &lt;param name=&quot;doBind&quot;&gt;Obsolete parameter. Has no effect&lt;/param&gt;
        public void ShowMenu(string menuID, bool doBind = true)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.Visible = true;
                //if (menu.lnkButton.Parent != null) menu.lnkButton.Parent.Visible = true;
                //if (doBind) Bind();
            }
        }

        /// &lt;summary&gt;
        /// Enables the menu.
        /// This method should be used if the menu needs to be enabled after the toolbar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu that needs to be enabled&lt;/param&gt;
        /// &lt;param name=&quot;doBind&quot;&gt;Obsolete parameter. Has no effect&lt;/param&gt;
        public void EnableMenu(string menuID, bool doBind = true)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.Enabled = true;
                if (menu.ImageURL.IndexOf(&quot;.&quot;, StringComparison.OrdinalIgnoreCase) != -1 &amp;&amp;
                    menu.ImageURL.Contains(&quot;_Disable&quot;))
                {
                    //if (menu.lnkButton.Controls.Count &gt; 0 &amp;&amp; menu.lnkButton.Controls[0] is Image)
                    menu.ImageURL = menu.ImageURL.Replace(&quot;_Disable.&quot;, &quot;.&quot;);
                    //(menu.lnkButton.Controls[0] as Image).ImageUrl = (menu.lnkButton.Controls[0] as Image).ImageUrl.Replace(&quot;_Disable.&quot;, &quot;.&quot;);

                    menu.RemoveAttribute(&quot;IsDisabled&quot;);
                }
                //if (doBind) Bind();
            }
        }

        /// &lt;summary&gt;
        /// Disables the menu.
        /// This method should be used if the menu needs to be disabled after the toolbar has been created.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu that needs to be disabled&lt;/param&gt;
        /// &lt;param name=&quot;doBind&quot;&gt;Obsolete parameter. Has no effect&lt;/param&gt;
        public void DisableMenu(string menuID, bool doBind = true)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.Enabled = false;
                if (menu.ImageURL.IndexOf(&quot;.&quot;, StringComparison.OrdinalIgnoreCase) != -1 &amp;&amp;
                    !menu.ImageURL.Contains(&quot;_Disable&quot;))
                {
                    //if (menu.lnkButton.Controls.Count &gt; 0 &amp;&amp; menu.lnkButton.Controls[0] is Image)
                    if (!menu.ImageURL.Contains(&quot;_Disable&quot;))
                        menu.ImageURL = menu.ImageURL.Replace(&quot;.&quot;, &quot;_Disable.&quot;);
                    //if (!(menu.lnkButton.Controls[0] as Image).ImageUrl.Contains(&quot;_Disable&quot;))
                    //  (menu.lnkButton.Controls[0] as Image).ImageUrl = (menu.lnkButton.Controls[0] as Image).ImageUrl.Replace(&quot;.&quot;, &quot;_Disable.&quot;);

                    menu.AddAttribute(&quot;IsDisabled&quot;, &quot;disabled&quot;);
                }
                //if (doBind) Bind();
            }
        }

        /// &lt;summary&gt;
        /// Renames the menu.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menuID&quot;&gt;ID of the menu to be renamed&lt;/param&gt;
        /// &lt;param name=&quot;text&quot;&gt;New text to which the menu is to be renamed&lt;/param&gt;
        /// &lt;param name=&quot;doBind&quot;&gt;Obsolete parameter. Has no effect&lt;/param&gt;
        public void RenameMenu(string menuID, string text, bool doBind = true)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.Text =
                    menu.CommandArgument = text;

                //if (menu.lnkButton.Controls.Count &gt; 0 &amp;&amp; menu.lnkButton.Controls[1] is Literal)
                //{
                //    bool hasSubMenus = (menu is LargeButton) &amp;&amp; (menu as LargeButton).HasSubMenus;
                //    (menu.lnkButton.Controls[1] as Literal).Text = hasSubMenus ? &quot;&lt;span&gt;&quot; + menu.Text + &quot;&lt;/span&gt;&quot; : menu.Text;
                //}

                menu.Rename(text);

                //if (doBind) Bind();
            }
        }

        public void ChangeMenuImage(string menuID, string newImageName)
        {
            Menu menu = FindMenu(menuID);
            if (menu != null)
            {
                menu.ImageURL = newImageName;
                menu.ChangeImage(newImageName, _baseImagePath);
            }
        }

        /// &lt;summary&gt;
        /// Obsolete method. Use AddMenuToToolbar instead.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menu&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        public void AddMenu(BrixMenu menu, MenuStyle type = MenuStyle.TextIcon)
        {
            // This is being used by workflow 
            // as of now add this button in the first section of the toolbar
            if (Groups.Count &gt; 0)
            {
                if (type == MenuStyle.TextIcon)
                    Groups[0].AddMenu(new TextIcon(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
                else if (type == MenuStyle.LargeButton)
                    Groups[0].AddMenu(new LargeButton(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
                else if (type == MenuStyle.TextIcon)
                    Groups[0].AddMenu(new Icon(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
            }
            else
                AddMenuToSection(menu, &quot;General&quot;, type);
        }

        /// &lt;summary&gt;
        /// Obsolete method. Use AddMenuToToolbar instead.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menu&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;groupName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;type&quot;&gt;&lt;/param&gt;
        public void AddMenuToSection(BrixMenu menu, string groupName, MenuStyle type = MenuStyle.TextIcon)
        {
            MenuGroup group = Groups.Find(g =&gt; g.Title == groupName);
            if (group == null)
            {
                group = new MenuGroup(groupName);
                Groups.Add(group);
            }
            if (type == MenuStyle.TextIcon)
                group.AddMenu(new TextIcon(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
            else if (type == MenuStyle.LargeButton)
                group.AddMenu(new LargeButton(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
            else if (type == MenuStyle.TextIcon)
                group.AddMenu(new Icon(menu.Id, menu.Name, menu.ImagePath, &quot;&quot;, menu.ToolTip));
        }

        //Call this method on OnInit
        public void EnableUpdatePanelForToolBar()
        {
            upToolbar.UpdateMode = UpdatePanelUpdateMode.Always;
            ScriptManager.RegisterStartupScript(upToolbar, this.GetType(), &quot;showLoadDone&quot;,
                &quot;if(parent!= null &amp;&amp; parent.notifyLoad) parent.notifyLoad(\&quot;hide\&quot;);&quot;, true);
        }
     
        /// &lt;summary&gt;
        /// Adds menu directly to the toolbar.
        /// This method should be called if a menu needs to be added after the toolbar has been created.
        /// Menu should be added only in the OnInit event, otherwise, the serverside event won&#39;t work.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;menu&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;groupName&quot;&gt;&lt;/param&gt;
        public void AddMenuToToolbar(Menu menu, string groupName)
        {
            if (_defaultRibbonTab == null) return;

            //AddMenuToViewState(menu, groupName);

            MenuGroup toolbarGroup = Groups.Find(x =&gt; x.Title == groupName);

            if (toolbarGroup == null)
            {
                toolbarGroup = new MenuGroup(groupName);
                Groups.Add(toolbarGroup);
            }

            toolbarGroup.Menus.Add(menu);

            RibbonBarGroup ribbonBarGroup = _defaultRibbonTab.Groups.Find(x =&gt; x.Text == groupName);

            if (ribbonBarGroup == null)
            {
                ribbonBarGroup = new RibbonBarGroup();
                ribbonBarGroup.Text = groupName;
                ribbonBarGroup.ID = groupName;
                ribbonBarGroup.Value = groupName;
                //ribbonBarGroup.ToolTip = groupName;

                _defaultRibbonTab.Groups.Add(ribbonBarGroup);
            }

            if (menu is LargeButton)
            {
                RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.ID);

                if (button != null)
                    ribbonBarGroup.Items.Remove(button);

                List&lt;LargeButton&gt; tempList = new List&lt;LargeButton&gt;();
                tempList.Add((menu as LargeButton));
                RenderLargerButtons(tempList, ribbonBarGroup);
            }
            else if (menu is TextIcon)
            {
                RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.ID);

                if (button != null)
                    ribbonBarGroup.Items.Remove(button);

                List&lt;TextIcon&gt; tempList = new List&lt;TextIcon&gt;();
                tempList.Add((menu as TextIcon));
                RenderTextIcons(tempList, ribbonBarGroup);
            }
            else if (menu is Icon)
            {
                RibbonBarButton button = ribbonBarGroup.FindButtonByValue(menu.ID);

                if (button != null)
                    ribbonBarGroup.Items.Remove(button);

                List&lt;Icon&gt; tempList = new List&lt;Icon&gt;();
                tempList.Add((menu as Icon));
                RenderIcons(tempList, ribbonBarGroup);
            }
            else if (menu is MenuButton)
            {
                RibbonBarItem button =
                    ribbonBarGroup.Items.Find(x =&gt; x is RibbonBarMenu &amp;&amp; (x as RibbonBarMenu).ID == menu.ID);

                if (button != null)
                    ribbonBarGroup.Items.Remove(button);

                List&lt;MenuButton&gt; tempList = new List&lt;MenuButton&gt;();
                tempList.Add((menu as MenuButton));
                RenderMenuButtons(tempList, ribbonBarGroup);
            }
        }
    }

    [Serializable]
    public class MenuGroup
    {
        public string p;

        public MenuGroup()
        {
            Menus = new List&lt;Menu&gt;();
        }

        public MenuGroup(string title)
        {
            // TODO: Complete member initialization
            Title = title;
            Menus = new List&lt;Menu&gt;();
        }

        [XmlAttribute(&quot;Title&quot;)]
        public string Title { get; set; }

        [XmlElement(Type = typeof(Icon), ElementName = &quot;Icon&quot;),
         XmlElement(Type = typeof(TextIcon), ElementName = &quot;TextIcon&quot;),
         XmlElement(Type = typeof(LargeButton), ElementName = &quot;LargeButton&quot;),
         XmlElement(Type = typeof(MenuButton), ElementName = &quot;MenuButton&quot;)]
        public List&lt;Menu&gt; Menus { get; private set; }

        public void AddMenu(Menu menu, int index = -1)
        {
            if (index != -1)
                Menus.Insert(index, menu);
            else Menus.Add(menu);
        }
    }

    [Serializable]
    public class Menu
    {
        private string _postbackURL;
        private bool _visible = true;
        private bool _enabled = true;
        private bool _causesValidation = true;
        private string _validationGroup = &quot;&quot;;
        private string _onClientBeforeClick = &quot;&quot;;
        private string _toolTip = &quot;&quot;;

        public string ID { get; set; }
        public string Title { get; set; }
        public string Text { get; set; }       
        public string ImageURL { get; set; }
        public string DisabledImageURL { get; set; }
        public bool IsOption { get; set; }
        public ValidateSelection ValidateSelection { get; set; }
        public bool ShowRedirectConfirmMessage = false;
        public string Tag { get; set; }

        public string PostBackUrl
        {
            get { return _postbackURL; }
            set
            {
                _postbackURL = (System.Web.HttpContext.Current.Handler as Page).ResolveUrl(value);

                // to prevent XSS attack
                OnClientClick = &quot;window.location.href = &#39;&quot; + System.Web.HttpUtility.JavaScriptStringEncode(_postbackURL) + &quot;&#39;; return false;&quot;;
            }
        }

        public event EventHandler Click;

        public WebControl RibbonBarItem { get; set; }

        public string ClientID
        {
            get { return RibbonBarItem == null ? &quot;ControlNotYetCreatedCheckCode&quot; : RibbonBarItem.ClientID; }
        }

        public bool CausesValidation
        {
            get { return _causesValidation; }
            set
            {
                _causesValidation = value;
                if (RibbonBarItem != null)
                {
                    if (value)
                        RibbonBarItem.Attributes.Add(&quot;data-causesValidation&quot;, value.ToString().ToLower());
                    else
                        RibbonBarItem.Attributes.Remove(&quot;data-causesValidation&quot;);
                }
            }
        }

        public string ValidationGroup
        {
            get { return _validationGroup; }
            set
            {
                _validationGroup = value;
                if (RibbonBarItem != null)
                {
                    if (!string.IsNullOrEmpty(value))
                        RibbonBarItem.Attributes.Add(&quot;data-validationgroup&quot;, value);
                    else
                        RibbonBarItem.Attributes.Remove(&quot;data-validationgroup&quot;);
                }
            }
        }

        public string CommandArgument { get; set; }

        public string OnClientClick
        {
            get { return _onClientBeforeClick; }
            set { _onClientBeforeClick = &quot;(function () { &quot; + value + &quot; })() &quot;; }
        }

        public string ToolTip
        {
            get { return _toolTip; }
            set
            {
                _toolTip = value;
                //if (RibbonBarItem != null)
                //    RibbonBarItem.ToolTip = value;
            }
        }

        public bool Enabled
        {
            get { return _enabled; }
            set
            {
                _enabled = value;
                if (RibbonBarItem != null)
                    RibbonBarItem.Enabled = value;
            }
        }

        public bool Visible
        {
            get
            {
                if (RibbonBarItem != null)
                    return _visible &amp;&amp; RibbonBarItem.Visible;
                return _visible;
            }
            set
            {
                _visible = value;

                if (RibbonBarItem != null)
                    RibbonBarItem.Style.Add(&quot;display&quot;, value ? &quot;&quot; : &quot;none&quot;);
            }
        }

        public bool _isHiddenInUI;
        /// &lt;summary&gt;
        /// This property will make the control available in UI but with display: none
        /// User must make the Visible = true explicitly for this to work
        /// &lt;/summary&gt;
        public bool IsHiddenInUI
        {
            get { return _isHiddenInUI; }
            set
            {
                _isHiddenInUI = value;

                if (RibbonBarItem != null)
                    RibbonBarItem.Style.Add(&quot;display&quot;, value ? &quot;block&quot; : &quot;none&quot;);
            }
        }

        public Dictionary&lt;string, string&gt; CustomClientAttributes { get; private set; } = new Dictionary&lt;string, string&gt;();

        public Menu()
        {
            CommandArgument = &quot;&quot;;
        }

        public void RaiseClickEvent(object sender, EventArgs e)
        {
            if (Click != null)
                Click(this, e);
        }

        public void AddAttribute(string key, string value)
        {
            if (RibbonBarItem != null)
            {
                RibbonBarItem.Attributes.Add(key, value);
            }
        }

        public void RemoveAttribute(string key)
        {
            if (RibbonBarItem != null)
            {
                RibbonBarItem.Attributes.Remove(key);
            }
        }

        public void Hide()
        {
            RibbonBarItem.Visible = false;
        }

        public void Show()
        {
            RibbonBarItem.Visible = true;
        }

        public void Rename(string newName)
        {
            this.Text = newName;

            if (RibbonBarItem == null) return;

            if (RibbonBarItem is RibbonBarButton)
                (RibbonBarItem as RibbonBarButton).Text = newName;
        }

        public void ChangeImage(string newImageName, string _baseImagePath)
        {
            if (RibbonBarItem == null) return;

            if (RibbonBarItem is RibbonBarButton)
            {
                (RibbonBarItem as RibbonBarButton).ImageUrl = _baseImagePath + newImageName;
                (RibbonBarItem as RibbonBarButton).ImageUrlLarge = _baseImagePath + newImageName;
            }

        }

        /// &lt;summary&gt;
        /// This methods add custom html attributes to the element with &#39;data-&#39; as prefix
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;button&quot;&gt;&lt;/param&gt;
        public void SynchronizeCustomClientAttributes(WebControl button)
        {
            if (button != null &amp;&amp; CustomClientAttributes.Any())
            {
                foreach (string key in CustomClientAttributes.Keys)
                {
                    button.Attributes.Add(&quot;data-&quot; + key, CustomClientAttributes[key]);
                }
            }
        }
    }

    [Serializable]
    public class Icon : Menu
    {
        public Icon()
        {
        }

        public Icon(string ID, string Text, string ImageURL, string postBackUrl = &quot;&quot;, string tooltip = &quot;&quot;,
            bool showRedirectConfirmMessage = false)
        {
            this.ID = ID;
            this.Text = Text;
            this.ImageURL = ImageURL;
            this.Title = String.IsNullOrEmpty(tooltip) ? Text : tooltip;
            if (!string.IsNullOrEmpty(postBackUrl))
                PostBackUrl = postBackUrl;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
        }
    }

    [Serializable]
    public class TextIcon : Menu
    {
        public TextIcon()
        {
            SubMenus = new List&lt;Menu&gt;();
        }

        public TextIcon(string ID, string Text, string ImageURL, string postBackUrl = &quot;&quot;, string tooltip = &quot;&quot;,
            ValidateSelection validateSelection = AbstractModels.ValidateSelection.None,
            bool showRedirectConfirmMessage = false, string tag = &quot;&quot;)
        {
            SubMenus = new List&lt;Menu&gt;();
            this.ID = ID;
            this.Text = Text;
            this.ImageURL = ImageURL;
            this.Title = String.IsNullOrEmpty(tooltip) ? Text : tooltip;
            if (!string.IsNullOrEmpty(postBackUrl))
                PostBackUrl = postBackUrl;
            this.ValidateSelection = validateSelection;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
            this.Tag = tag;
        }

        public List&lt;Menu&gt; SubMenus { get; private set; }

        public void AddSubMenu(Menu subMenu)
        {
            //AddSubMenu(subMenu);
            SubMenus.Add(subMenu);
            //subMenu.lnkButton = CreateMenuListItem(subMenu);
        }
    }

    [Serializable]
    public class LargeButton : Menu
    {
        public LargeButton()
        {
            SubMenus = new List&lt;Menu&gt;();
        }

        public LargeButton(string ID, string Text, string ImageURL, string postBackUrl = &quot;&quot;, string tooltip = &quot;&quot;,
            bool showRedirectConfirmMessage = false)
        {
            SubMenus = new List&lt;Menu&gt;();
            this.ID = ID;
            this.Text = Text;
            this.ImageURL = ImageURL;
            this.Title = String.IsNullOrEmpty(tooltip) ? Text : tooltip;
            if (!string.IsNullOrEmpty(postBackUrl))
                PostBackUrl = postBackUrl;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
        }

        public List&lt;Menu&gt; SubMenus { get; private set; }

        public bool HasSubMenus
        {
            get { return SubMenus.Count &gt; 0; }
        }

        public void AddSubMenu(Menu subMenu)
        {
            SubMenus.Add(subMenu);
            //subMenu.lnkButton = CreateMenuListItem(subMenu);
        }
    }

    [Serializable]
    public class MenuButton : Menu
    {
        public MenuButton()
        {
            SubMenus = new List&lt;Menu&gt;();
        }

        public MenuButton(string ID, string Text, string ImageURL, string postBackUrl = &quot;&quot;, string tooltip = &quot;&quot;,
            bool showRedirectConfirmMessage = false, ButtonSize buttonSize = ButtonSize.Large)
        {
            SubMenus = new List&lt;Menu&gt;();
            this.ID = ID;
            this.Text = Text;
            this.ImageURL = ImageURL;
            this.Title = String.IsNullOrEmpty(tooltip) ? Text : tooltip;
            if (!string.IsNullOrEmpty(postBackUrl))
                PostBackUrl = postBackUrl;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
            this.ButtonSize = buttonSize;
        }

        public List&lt;Menu&gt; SubMenus { get; private set; }

        public ButtonSize ButtonSize { get; set; }

        public bool HasSubMenus
        {
            get { return SubMenus.Count &gt; 0; }
        }

        public void AddSubMenu(Menu subMenu)
        {
            SubMenus.Add(subMenu);
        }

        public void RemoveSubMenu(Menu subMenu)
        {
            SubMenus.Remove(subMenu);
        }
    }

    [Serializable]
    public class SplitButton : Menu
    {
        public SplitButton()
        {
            SubMenus = new List&lt;Menu&gt;();
        }

        public SplitButton(string ID, string Text, string ImageURL, string postBackUrl = &quot;&quot;, string tooltip = &quot;&quot;,
            bool showRedirectConfirmMessage = false, ButtonSize buttonSize = ButtonSize.Large)
        {
            SubMenus = new List&lt;Menu&gt;();
            this.ID = ID;
            this.Text = Text;
            this.ImageURL = ImageURL;
            this.Title = String.IsNullOrEmpty(tooltip) ? Text : tooltip;
            if (!string.IsNullOrEmpty(postBackUrl))
                PostBackUrl = postBackUrl;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
            this.ButtonSize = buttonSize;
        }

        public List&lt;Menu&gt; SubMenus { get; private set; }

        public ButtonSize ButtonSize { get; set; }

        public bool HasSubMenus
        {
            get { return SubMenus.Count &gt; 0; }
        }

        public void AddSubMenu(Menu subMenu)
        {
            SubMenus.Add(subMenu);
        }
    }

    [Serializable]
    public class ToolBarEventArg : EventArgs
    {
        public string Text;
        public string Tag;
    }

    [Serializable]
    public class BrixMenu
    {
        [XmlAttribute(&quot;EventHandler&quot;)]
        public string EventHandler;

        [XmlElement(&quot;SubMenuItem&quot;)]
        public List&lt;BrixMenu&gt; SubMenuItems = new List&lt;BrixMenu&gt;();
        private ValidateSelection selectionType = ValidateSelection.OneItem;
        private int subMenuWidth;
        public MenuArray subMenus;
        private int width;
        public MenuStyle MenuStyle;
        public bool showRedirectConfirmMessage;

        public BrixMenu()
        {
            subMenus = new MenuArray();
        }

        public BrixMenu(string ID, string Name, string IconImagePath)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
        }

        public BrixMenu(string ID, string Name, string IconImagePath, MenuStyle MenuStyle)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            this.MenuStyle = MenuStyle;
        }

        public BrixMenu(string ID, string Name, string IconImagePath, bool showRedirectConfirmMessage)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            this.ShowRedirectConfirmMessage = showRedirectConfirmMessage;
        }

        public BrixMenu(string ID, string Name, string PostBackURL, string IconImagePath)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            Link = PostBackURL;
        }


        public BrixMenu(string ID, string Name, string IconImagePath, int PixelWidth)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            width = PixelWidth;
        }

        public BrixMenu(string ID, string Name, string PostBackURL, string IconImagePath, int PixelWidth)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            Link = PostBackURL;
            width = PixelWidth;
        }

        public BrixMenu(string ID, string Name, string IconImagePath, int PixelMenuWidth, int PixelSubMenuWidth)
            : this()
        {
            Id = ID;
            this.Name = Name;
            ImagePath = IconImagePath;
            width = PixelMenuWidth;
            subMenuWidth = PixelSubMenuWidth;
        }

        [XmlAttribute(&quot;Id&quot;)]
        public string Id { get; set; }

        [XmlAttribute(&quot;Name&quot;)]
        public string Name { get; set; }

        [XmlAttribute(&quot;Link&quot;)]
        public string Link { get; set; }

        [XmlAttribute(&quot;ImagePath&quot;)]
        public string ImagePath { get; set; }

        [XmlAttribute(&quot;MessageType&quot;)]
        public string MessageType { get; set; }

        [XmlAttribute(&quot;Message&quot;)]
        public string Message { get; set; }

        [XmlAttribute(&quot;ToolTip&quot;)]
        public string ToolTip { get; set; }

        [XmlAttribute(&quot;Width&quot;)]
        public int Width
        {
            get { return width; }
            set
            {
                int localwidth = 60;
                Int32.TryParse(value.ToString(), out localwidth);
                width = localwidth;
            }
        }

        [XmlAttribute(&quot;SelectionType&quot;)]
        public ValidateSelection SelectionType
        {
            get { return selectionType; }
            set { selectionType = value; }
        }

        [XmlAttribute(&quot;SubMenuWidth&quot;)]
        public int SubMenuWidth
        {
            get { return subMenuWidth; }
            set
            {
                int localwidth = 200;
                Int32.TryParse(value.ToString(), out localwidth);
                subMenuWidth = localwidth;
            }
        }

        [XmlAttribute(&quot;ShowRedirectConfirmMessage&quot;)]
        public bool ShowRedirectConfirmMessage
        {
            get { return showRedirectConfirmMessage; }
            set { showRedirectConfirmMessage = value; }
        }
    }

    [Serializable]
    public class MenuArray : ArrayList
    {
        private new BrixMenu this[int index]
        {
            get { return ((BrixMenu)base[index]); }
        }

        private int Add(BrixMenu subMenu)
        {
            return base.Add(subMenu);
        }

        private void Insert(int index, BrixMenu subMenu)
        {
            base.Insert(index, subMenu);
        }

        private void Remove(BrixMenu subMenu)
        {
            base.Remove(subMenu);
        }

        private bool Contains(BrixMenu subMenu)
        {
            return base.Contains(subMenu);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[43,58,43,59,1],[43,60,43,96,1],[43,97,43,98,1],[45,9,45,25,1],[46,9,46,10,1],[47,13,47,44,1],[49,13,49,52,1],[50,9,50,10,1],[59,9,59,10,1],[60,13,60,27,1],[60,28,60,35,0],[62,13,66,18,1],[67,13,67,14,1],[68,17,68,56,1],[70,17,70,38,1],[70,39,70,78,0],[71,22,71,40,1],[71,41,71,77,0],[72,22,72,43,1],[72,44,72,83,1],[73,22,73,42,1],[73,43,73,81,1],[75,22,75,31,1],[75,33,75,51,1],[75,53,75,56,1],[76,17,76,18,1],[77,21,77,115,1],[78,17,78,18,1],[79,13,79,14,1],[81,13,81,111,1],[83,13,83,126,1],[85,13,85,56,1],[86,17,86,109,1],[88,13,88,38,1],[89,9,89,10,1],[94,9,94,10,1],[95,13,95,46,1],[97,13,99,17,1],[99,17,99,18,1],[99,18,100,21,1],[100,21,100,95,1],[100,95,101,21,1],[101,21,101,85,1],[101,85,102,21,1],[102,21,102,74,1],[102,74,103,21,1],[103,21,103,92,1],[103,92,104,21,1],[104,21,104,95,1],[104,95,106,21,1],[106,21,107,49,1],[107,49,107,59,1],[107,59,107,83,1],[107,83,107,93,1],[107,93,107,115,1],[107,115,107,126,0],[107,126,107,155,1],[107,155,107,166,0],[107,166,107,194,1],[107,194,107,205,1],[107,205,107,208,1],[106,21,107,208,1],[107,208,108,21,1],[108,21,108,22,1],[108,22,109,25,1],[109,25,110,63,1],[110,63,110,103,1],[110,103,110,105,1],[109,25,110,105,1],[110,105,112,25,1],[112,25,112,52,1],[112,52,113,25,1],[113,25,113,26,1],[113,26,114,29,1],[114,29,114,67,1],[114,67,115,29,1],[115,29,115,62,1],[115,62,116,29,1],[116,29,116,61,1],[116,61,117,29,1],[117,29,117,59,1],[117,59,119,29,1],[119,29,119,74,1],[119,74,120,25,1],[120,25,120,26,1],[120,26,122,25,1],[122,25,122,75,1],[122,75,124,25,1],[124,25,124,67,1],[124,67,126,25,1],[126,25,126,60,1],[126,60,128,25,1],[128,25,128,72,1],[128,72,130,25,1],[130,25,130,74,1],[130,74,131,21,1],[131,21,131,22,1],[131,22,132,17,1],[132,17,132,18,1],[132,18,133,19,1],[97,13,133,19,1],[134,9,134,10,1],[137,9,137,10,1],[138,18,138,27,1],[138,29,138,51,1],[138,53,138,56,1],[139,13,139,14,1],[140,17,140,54,1],[142,17,142,40,1],[143,17,143,18,0],[144,21,144,55,0],[145,21,145,30,0],[148,17,148,81,1],[150,17,150,56,1],[152,17,152,50,1],[153,13,153,14,1],[154,9,154,10,1],[157,9,157,10,1],[158,13,158,38,1],[158,38,158,48,1],[158,48,158,50,1],[158,13,158,50,1],[158,51,158,58,1],[160,18,160,27,1],[160,29,160,48,1],[160,50,160,53,1],[161,13,161,14,1],[162,17,162,50,1],[164,17,164,49,1],[165,17,165,18,0],[166,21,166,57,0],[167,21,167,30,0],[170,17,170,83,1],[172,17,172,58,1],[174,17,174,50,1],[175,13,175,14,1],[176,9,176,10,1],[179,9,179,10,1],[180,13,180,34,1],[180,34,180,44,0],[180,44,180,46,1],[180,13,180,46,1],[180,47,180,54,1],[182,18,182,27,0],[182,29,182,44,0],[182,46,182,49,0],[183,13,183,14,0],[184,17,184,38,0],[186,17,186,79,0],[188,17,188,54,0],[190,17,190,50,0],[191,13,191,14,0],[192,9,192,10,1],[195,9,195,10,1],[196,18,196,27,1],[196,29,196,50,1],[196,52,196,55,1],[197,13,197,14,1],[198,17,198,52,1],[199,17,199,56,1],[201,22,201,31,1],[201,33,201,63,1],[201,65,201,68,1],[202,17,202,18,1],[203,21,204,92,1],[205,21,205,22,0],[206,25,206,84,0],[207,25,207,31,0],[209,17,209,18,1],[211,17,211,43,1],[212,17,212,18,1],[213,21,213,57,1],[214,21,214,61,1],[215,17,215,18,1],[217,17,217,72,1],[219,17,219,63,1],[219,64,219,101,1],[220,22,220,69,1],[220,70,220,108,1],[221,22,221,68,0],[221,69,221,106,0],[223,17,223,78,1],[224,17,224,50,1],[225,17,225,79,1],[226,17,226,84,1],[227,17,227,60,1],[228,17,228,49,1],[230,17,230,77,1],[232,17,237,76,1],[238,17,243,76,1],[244,17,244,60,1],[246,17,246,58,1],[248,22,248,31,1],[248,33,248,62,1],[248,64,248,67,1],[249,17,249,18,1],[250,21,250,66,1],[251,21,251,99,1],[253,21,253,70,1],[255,21,255,64,1],[256,17,256,18,1],[257,13,257,14,1],[258,9,258,10,1],[261,9,261,10,0],[262,13,262,70,0],[263,13,263,52,0],[264,13,264,68,0],[266,13,266,39,0],[267,13,267,14,0],[268,17,268,61,0],[269,17,269,54,0],[270,13,270,14,0],[271,18,271,41,0],[272,13,272,14,0],[273,17,273,58,0],[274,17,274,55,0],[275,13,275,14,0],[277,13,277,52,0],[278,13,278,63,0],[279,13,279,38,0],[282,13,282,64,0],[283,13,283,69,0],[285,13,288,122,0],[289,13,292,122,0],[294,13,294,50,0],[295,13,295,69,0],[297,13,297,63,0],[298,13,298,47,0],[299,13,299,34,0],[300,13,300,35,0],[302,13,302,38,0],[304,13,304,62,0],[306,18,306,27,0],[306,29,306,47,0],[306,49,306,52,0],[307,13,307,14,0],[308,17,308,41,0],[309,17,309,71,0],[311,17,311,57,0],[313,17,313,46,0],[315,17,315,45,0],[316,13,316,14,0],[318,13,318,37,0],[319,9,319,10,0],[322,9,322,10,1],[323,18,323,27,1],[323,29,323,46,1],[323,48,323,51,1],[324,13,324,14,1],[325,17,325,54,1],[327,17,327,42,1],[327,43,327,52,0],[329,17,329,88,1],[330,17,330,72,1],[332,17,332,64,1],[332,65,332,102,1],[333,22,333,70,0],[333,71,333,109,0],[334,22,334,69,0],[334,70,334,107,0],[336,17,336,58,1],[337,17,337,86,1],[338,17,338,56,1],[340,17,340,87,1],[342,17,342,87,1],[343,17,343,92,1],[346,17,346,85,1],[348,17,353,77,1],[354,17,359,77,1],[361,17,361,67,1],[362,17,362,62,1],[364,17,364,85,1],[366,17,366,66,1],[368,22,368,31,1],[368,33,368,63,1],[368,65,368,68,1],[369,17,369,18,1],[370,21,370,60,1],[371,21,371,86,1],[373,21,373,61,1],[375,21,375,71,1],[376,17,376,18,1],[378,17,378,55,1],[379,13,379,14,1],[380,9,380,10,1],[383,9,383,10,1],[384,13,384,69,1],[385,13,385,68,1],[387,13,387,37,1],[388,17,388,54,1],[389,18,389,39,1],[390,17,390,55,1],[391,18,391,35,0],[392,17,392,54,0],[394,13,394,42,1],[395,13,395,45,1],[396,13,396,70,1],[398,13,398,47,1],[399,13,399,52,1],[401,13,401,78,1],[403,13,403,71,1],[404,13,404,76,1],[406,12,406,68,1],[408,13,411,116,1],[412,13,415,116,1],[417,13,417,57,1],[418,17,418,86,1],[420,13,420,39,1],[421,17,421,81,1],[423,17,423,76,1],[425,13,425,61,1],[426,17,426,94,1],[428,17,428,75,1],[430,13,430,52,1],[432,13,432,30,1],[433,17,433,93,1],[435,13,435,69,1],[437,13,437,36,1],[438,9,438,10,1],[441,9,441,10,1],[442,13,442,75,1],[444,13,444,44,1],[445,13,445,72,1],[446,13,446,47,1],[447,13,447,54,1],[448,13,448,116,1],[449,13,454,120,1],[456,13,456,80,1],[457,13,457,71,1],[458,13,458,57,1],[459,17,459,88,1],[461,13,461,39,1],[462,17,462,83,1],[464,17,464,78,0],[466,13,466,61,1],[467,17,467,96,0],[469,17,469,77,1],[471,13,471,54,1],[473,13,473,30,1],[474,17,474,94,1],[476,13,476,71,1],[477,13,477,38,1],[478,9,478,10,1],[481,9,481,10,1],[482,13,482,35,1],[483,13,485,17,1],[485,17,485,18,1],[485,18,486,21,1],[486,21,488,25,1],[488,25,488,26,1],[488,26,489,29,1],[489,29,489,51,1],[489,51,490,29,1],[490,29,490,30,1],[490,30,491,33,1],[491,33,491,50,1],[491,50,492,33,1],[492,33,492,40,1],[492,40,494,34,1],[494,34,494,58,1],[494,58,495,33,1],[495,33,497,37,1],[497,37,497,38,0],[497,38,498,41,1],[498,41,498,66,0],[498,66,499,41,1],[499,41,499,42,0],[499,42,500,45,1],[500,45,500,65,0],[500,65,501,45,1],[501,45,501,52,0],[501,52,503,37,1],[503,37,503,38,0],[503,38,504,39,1],[495,33,504,39,1],[504,39,506,34,1],[506,34,506,55,1],[506,55,507,33,1],[507,33,509,37,1],[509,37,509,38,0],[509,38,510,41,1],[510,41,510,66,0],[510,66,511,41,1],[511,41,511,42,0],[511,42,512,45,1],[512,45,512,65,0],[512,65,513,45,1],[513,45,513,52,0],[513,52,515,37,1],[515,37,515,38,0],[515,38,516,39,1],[507,33,516,39,1],[516,39,517,34,1],[517,34,517,57,1],[517,57,518,33,1],[518,33,520,37,1],[520,37,520,38,1],[520,38,521,41,1],[521,41,521,66,1],[521,66,522,41,1],[522,41,522,42,1],[522,42,523,45,1],[523,45,523,65,1],[523,65,524,45,1],[524,45,524,52,1],[524,52,526,37,1],[526,37,526,38,1],[526,38,527,39,1],[518,33,527,39,1],[527,39,528,34,1],[528,34,528,58,1],[528,58,529,33,1],[529,33,531,37,1],[531,37,531,38,1],[531,38,532,41,1],[532,41,532,66,1],[532,66,533,41,1],[533,41,533,42,1],[533,42,534,45,1],[534,45,534,65,1],[534,65,535,45,1],[535,45,535,52,1],[535,52,537,37,1],[537,37,537,38,1],[537,38,538,39,1],[529,33,538,39,1],[538,39,539,25,1],[539,25,539,26,1],[539,26,540,27,1],[486,21,540,27,1],[540,27,541,17,1],[541,17,541,18,1],[541,18,542,19,1],[483,13,542,19,1],[544,13,544,30,1],[545,9,545,10,1],[548,9,548,10,1],[549,13,549,35,1],[550,13,552,17,1],[552,17,552,18,1],[552,18,553,21,1],[553,21,555,25,1],[555,25,555,26,1],[555,26,556,29,1],[556,29,556,51,1],[556,51,557,29,1],[557,29,557,30,1],[557,30,558,33,1],[558,33,558,50,1],[558,50,560,33,1],[560,33,560,57,1],[560,57,561,37,1],[561,37,563,41,0],[563,41,563,42,0],[563,42,564,45,0],[564,45,564,73,0],[564,73,565,45,0],[565,45,565,46,0],[565,46,566,49,0],[566,49,566,69,0],[566,69,567,49,0],[567,49,567,56,0],[567,56,569,41,0],[569,41,569,42,0],[569,42,570,43,0],[561,37,570,43,0],[570,43,572,38,1],[572,38,572,59,1],[572,59,573,37,1],[573,37,575,41,0],[575,41,575,42,0],[575,42,576,45,0],[576,45,576,73,0],[576,73,577,45,0],[577,45,577,46,0],[577,46,578,49,0],[578,49,578,69,0],[578,69,579,49,0],[579,49,579,56,0],[579,56,581,41,0],[581,41,581,42,0],[581,42,582,43,0],[573,37,582,43,0],[582,43,583,38,1],[583,38,583,61,1],[583,61,584,37,1],[584,37,586,41,1],[586,41,586,42,1],[586,42,587,45,1],[587,45,587,73,1],[587,73,588,45,1],[588,45,588,46,1],[588,46,589,49,1],[589,49,589,69,1],[589,69,590,49,1],[590,49,590,56,1],[590,56,592,41,1],[592,41,592,42,1],[592,42,593,43,1],[584,37,593,43,1],[593,43,594,29,1],[594,29,594,30,1],[594,30,595,25,1],[595,25,595,26,1],[595,26,596,27,1],[553,21,596,27,1],[596,27,597,17,1],[597,17,597,18,1],[597,18,598,19,1],[550,13,598,19,1],[600,13,600,30,1],[601,9,601,10,1],[696,9,696,10,1],[697,13,697,55,1],[699,13,699,52,1],[700,17,700,63,1],[702,13,702,46,1],[703,13,703,32,1],[706,13,706,57,1],[708,13,708,82,1],[709,13,709,43,1],[711,13,711,30,1],[712,13,712,14,1],[713,17,713,37,1],[714,17,714,52,1],[715,13,715,14,1],[717,13,717,39,1],[718,17,718,45,1],[719,9,719,10,1],[722,9,722,10,0],[723,13,723,55,0],[725,13,725,57,0],[726,17,726,68,0],[728,13,728,46,0],[729,13,729,32,0],[732,13,732,57,0],[734,13,734,82,0],[735,13,735,43,0],[737,13,737,30,0],[738,13,738,14,0],[739,17,739,37,0],[740,17,740,52,0],[741,13,741,14,0],[743,13,743,39,0],[744,17,744,45,0],[745,9,745,10,0],[748,9,748,10,1],[749,13,749,59,1],[751,13,751,54,1],[752,17,752,63,1],[754,13,754,46,1],[755,13,755,32,1],[758,13,758,57,1],[760,13,760,43,1],[762,13,762,30,1],[763,13,763,14,1],[764,17,764,37,1],[765,17,765,52,1],[766,13,766,14,1],[768,13,768,39,1],[769,17,769,45,1],[770,9,770,10,1],[773,9,773,10,1],[774,13,774,50,1],[779,13,779,52,1],[781,13,781,73,1],[782,13,782,83,1],[783,13,783,77,1],[785,13,785,94,1],[786,13,786,110,1],[787,13,787,104,1],[788,13,788,80,1],[790,13,790,61,1],[792,13,792,43,1],[793,13,793,28,1],[794,9,794,10,1],[797,9,797,10,1],[798,13,798,28,1],[801,9,801,10,1],[804,9,804,10,1],[805,13,805,58,1],[805,60,805,99,1],[805,101,805,143,1],[807,13,807,202,1],[808,13,808,144,1],[810,13,810,198,1],[813,13,813,206,1],[815,18,815,27,1],[815,29,815,45,1],[815,47,815,50,1],[816,13,816,14,1],[817,22,817,31,1],[817,33,817,58,1],[817,60,817,63,1],[818,17,818,18,1],[819,21,819,56,1],[820,21,820,48,1],[821,25,821,97,1],[822,26,822,54,1],[823,25,823,130,1],[825,25,825,89,1],[826,17,826,18,1],[827,13,827,14,1],[829,13,829,87,1],[830,13,830,45,1],[831,13,831,48,1],[833,13,833,130,1],[834,13,834,146,1],[835,13,835,152,1],[837,13,837,33,1],[838,9,838,10,1],[845,9,845,10,1],[846,13,846,28,1],[847,13,847,52,1],[848,13,848,33,1],[850,13,850,20,1],[850,22,850,35,1],[850,36,850,38,1],[850,39,850,44,1],[851,13,851,14,1],[852,17,852,41,1],[853,17,853,58,1],[854,21,854,90,1],[855,22,855,59,1],[856,21,856,86,0],[858,21,858,93,1],[860,17,860,45,1],[861,17,862,73,1],[863,21,863,28,0],[863,30,863,46,0],[863,47,863,49,0],[863,50,863,63,0],[864,21,864,22,0],[865,25,865,120,0],[866,25,866,63,0],[867,25,867,73,0],[868,21,868,22,0],[870,17,870,41,1],[871,13,871,14,1],[872,13,872,29,1],[873,9,873,10,1],[880,9,880,10,1],[881,13,881,29,1],[887,13,887,29,1],[888,9,888,10,1],[891,9,891,10,1],[892,13,892,29,1],[893,9,893,10,1],[901,9,901,10,1],[902,13,902,42,1],[904,13,904,25,1],[905,9,905,10,1],[914,9,914,10,1],[915,13,915,56,1],[917,13,917,25,1],[918,9,918,10,1],[928,9,928,10,0],[929,13,929,51,0],[930,13,930,35,0],[931,17,931,57,0],[932,9,932,10,0],[943,9,943,10,0],[944,13,944,64,0],[945,13,945,35,0],[946,17,946,57,0],[947,9,947,10,0],[956,9,956,10,1],[957,13,957,42,1],[958,13,958,30,1],[959,13,959,14,1],[960,17,960,38,1],[963,13,963,14,1],[964,9,964,10,1],[973,9,973,10,1],[974,13,974,42,1],[975,13,975,30,1],[976,13,976,14,1],[977,17,977,37,1],[980,13,980,14,1],[981,9,981,10,1],[990,9,990,10,1],[991,13,991,42,1],[992,13,992,30,1],[993,13,993,14,1],[994,17,994,37,1],[995,17,996,56,1],[997,17,997,18,1],[999,21,999,77,1],[1002,21,1002,56,1],[1003,17,1003,18,1],[1005,13,1005,14,1],[1006,9,1006,10,1],[1015,9,1015,10,1],[1016,13,1016,42,1],[1017,13,1017,30,1],[1018,13,1018,14,1],[1019,17,1019,38,1],[1020,17,1021,57,1],[1022,17,1022,18,1],[1024,21,1024,61,1],[1025,25,1025,81,1],[1029,21,1029,65,1],[1030,17,1030,18,1],[1032,13,1032,14,1],[1033,9,1033,10,1],[1042,9,1042,10,1],[1043,13,1043,42,1],[1044,13,1044,30,1],[1045,13,1045,14,1],[1046,17,1047,49,1],[1055,17,1055,35,1],[1058,13,1058,14,1],[1059,9,1059,10,1],[1062,9,1062,10,1],[1063,13,1063,42,1],[1064,13,1064,30,1],[1065,13,1065,14,1],[1066,17,1066,46,1],[1067,17,1067,64,1],[1068,13,1068,14,1],[1069,9,1069,10,1],[1077,9,1077,10,1],[1080,13,1080,34,1],[1081,13,1081,14,1],[1082,17,1082,48,1],[1083,21,1083,107,1],[1084,22,1084,56,0],[1085,21,1085,110,0],[1086,22,1086,53,0],[1087,21,1087,103,0],[1088,13,1088,14,1],[1090,17,1090,57,0],[1091,9,1091,10,1],[1100,9,1100,10,0],[1101,13,1101,48,0],[1101,48,1101,68,0],[1101,68,1101,70,0],[1101,13,1101,70,0],[1102,13,1102,31,0],[1103,13,1103,14,0],[1104,17,1104,50,0],[1105,17,1105,35,0],[1106,13,1106,14,0],[1107,13,1107,44,0],[1108,17,1108,99,0],[1109,18,1109,52,0],[1110,17,1110,102,0],[1111,18,1111,49,0],[1112,17,1112,95,0],[1113,9,1113,10,0],[1117,9,1117,10,1],[1118,13,1118,65,1],[1119,13,1120,94,1],[1121,9,1121,10,1],[1131,9,1131,10,1],[1132,13,1132,43,1],[1132,44,1132,51,0],[1136,13,1136,55,1],[1136,55,1136,75,1],[1136,75,1136,77,1],[1136,13,1136,77,1],[1138,13,1138,38,1],[1139,13,1139,14,1],[1140,17,1140,57,1],[1141,17,1141,42,1],[1142,13,1142,14,1],[1144,13,1144,42,1],[1146,13,1146,80,1],[1146,80,1146,99,1],[1146,99,1146,101,1],[1146,13,1146,101,1],[1148,13,1148,40,1],[1149,13,1149,14,1],[1150,17,1150,55,1],[1151,17,1151,49,1],[1152,17,1152,47,1],[1153,17,1153,50,1],[1156,17,1156,62,1],[1157,13,1157,14,1],[1159,13,1159,37,1],[1160,13,1160,14,0],[1161,17,1161,84,0],[1163,17,1163,36,0],[1164,21,1164,57,0],[1166,17,1166,70,0],[1167,17,1167,53,0],[1168,17,1168,63,0],[1169,13,1169,14,0],[1170,18,1170,39,1],[1171,13,1171,14,1],[1172,17,1172,84,1],[1174,17,1174,36,1],[1175,21,1175,57,0],[1177,17,1177,64,1],[1178,17,1178,50,1],[1179,17,1179,59,1],[1180,13,1180,14,1],[1181,18,1181,35,1],[1182,13,1182,14,0],[1183,17,1183,84,0],[1185,17,1185,36,0],[1186,21,1186,57,0],[1188,17,1188,56,0],[1189,17,1189,46,0],[1190,17,1190,55,0],[1191,13,1191,14,0],[1192,18,1192,41,1],[1193,13,1193,14,1],[1194,17,1195,52,1],[1195,52,1195,108,1],[1195,108,1195,110,1],[1194,17,1195,110,1],[1197,17,1197,36,1],[1198,21,1198,57,1],[1200,17,1200,68,1],[1201,17,1201,52,1],[1202,17,1202,61,1],[1203,13,1203,14,1],[1204,9,1204,10,1],[1212,9,1212,27,0],[1213,9,1213,10,0],[1214,13,1214,38,0],[1215,9,1215,10,0],[1217,9,1217,39,1],[1218,9,1218,10,1],[1220,13,1220,27,1],[1221,13,1221,38,1],[1222,9,1222,10,1],[1225,31,1225,35,1],[1225,36,1225,40,1],[1231,35,1231,39,1],[1231,40,1231,52,1],[1234,9,1234,10,1],[1235,13,1235,29,1],[1236,17,1236,43,1],[1237,18,1237,34,1],[1238,9,1238,10,1],[1245,9,1245,38,1],[1246,9,1246,38,1],[1247,9,1247,47,1],[1248,9,1248,46,1],[1249,9,1249,50,1],[1250,9,1250,38,1],[1252,28,1252,32,1],[1252,33,1252,37,1],[1253,31,1253,35,1],[1253,36,1253,40,1],[1254,30,1254,34,1],[1254,35,1254,39,1],[1255,34,1255,38,1],[1255,39,1255,43,1],[1256,42,1256,46,1],[1256,47,1256,51,0],[1257,32,1257,36,0],[1257,37,1257,41,0],[1258,54,1258,58,1],[1258,59,1258,63,1],[1259,9,1259,56,1],[1260,29,1260,33,1],[1260,34,1260,38,1],[1264,17,1264,18,1],[1264,19,1264,39,1],[1264,40,1264,41,1],[1266,13,1266,14,1],[1267,17,1267,99,1],[1270,17,1270,143,1],[1271,13,1271,14,1],[1276,43,1276,47,1],[1276,48,1276,52,1],[1280,17,1280,18,1],[1280,19,1280,107,1],[1280,108,1280,109,1],[1285,17,1285,18,1],[1285,19,1285,44,1],[1285,45,1285,46,1],[1287,13,1287,14,1],[1288,17,1288,43,1],[1289,17,1289,43,1],[1290,17,1290,18,1],[1291,21,1291,31,1],[1292,25,1292,107,1],[1294,25,1294,82,1],[1295,17,1295,18,1],[1296,13,1296,14,1],[1301,17,1301,18,1],[1301,19,1301,43,1],[1301,44,1301,45,1],[1303,13,1303,14,1],[1304,17,1304,42,1],[1305,17,1305,43,1],[1306,17,1306,18,1],[1307,21,1307,54,1],[1308,25,1308,85,1],[1310,25,1310,81,0],[1311,17,1311,18,1],[1312,13,1312,14,1],[1315,41,1315,45,1],[1315,46,1315,50,1],[1319,17,1319,18,1],[1319,19,1319,47,1],[1319,48,1319,49,1],[1320,17,1320,18,1],[1320,19,1320,79,1],[1320,80,1320,81,1],[1325,17,1325,18,0],[1325,19,1325,35,0],[1325,36,1325,37,0],[1327,13,1327,14,1],[1328,17,1328,34,1],[1331,13,1331,14,1],[1336,17,1336,18,1],[1336,19,1336,35,1],[1336,36,1336,37,1],[1338,13,1338,14,1],[1339,17,1339,34,1],[1340,17,1340,43,1],[1341,21,1341,51,1],[1342,13,1342,14,1],[1348,13,1348,14,1],[1349,17,1349,43,1],[1350,21,1350,62,1],[1351,17,1351,33,1],[1352,13,1352,14,1],[1354,13,1354,14,1],[1355,17,1355,34,1],[1357,17,1357,43,1],[1358,21,1358,77,1],[1359,13,1359,14,1],[1369,17,1369,18,1],[1369,19,1369,40,1],[1369,41,1369,42,1],[1371,13,1371,14,1],[1372,17,1372,39,1],[1374,17,1374,43,1],[1375,21,1375,82,0],[1376,13,1376,14,1],[1379,68,1379,72,1],[1379,73,1379,85,0],[1379,90,1379,122,1],[1381,9,1381,22,1],[1382,9,1382,10,1],[1383,13,1383,34,1],[1384,9,1384,10,1],[1387,9,1387,10,1],[1388,13,1388,31,1],[1389,17,1389,32,1],[1390,9,1390,10,1],[1393,9,1393,10,1],[1394,13,1394,39,1],[1395,13,1395,14,1],[1396,17,1396,58,1],[1397,13,1397,14,1],[1398,9,1398,10,1],[1401,9,1401,10,1],[1402,13,1402,39,1],[1403,13,1403,14,1],[1404,17,1404,54,1],[1405,13,1405,14,1],[1406,9,1406,10,1],[1409,9,1409,10,1],[1410,13,1410,43,1],[1411,9,1411,10,1],[1414,9,1414,10,0],[1415,13,1415,42,0],[1416,9,1416,10,0],[1419,9,1419,10,1],[1420,13,1420,33,1],[1422,13,1422,39,1],[1422,40,1422,47,0],[1424,13,1424,50,1],[1425,17,1425,67,1],[1426,9,1426,10,1],[1429,9,1429,10,1],[1430,13,1430,39,1],[1430,40,1430,47,0],[1432,13,1432,50,1],[1433,13,1433,14,1],[1434,17,1434,93,1],[1435,17,1435,98,1],[1436,13,1436,14,1],[1438,9,1438,10,1],[1445,9,1445,10,1],[1446,13,1446,64,1],[1447,13,1447,14,1],[1448,17,1448,24,1],[1448,26,1448,36,1],[1448,37,1448,39,1],[1448,40,1448,67,1],[1449,17,1449,18,1],[1450,21,1450,87,1],[1451,17,1451,18,1],[1452,13,1452,14,1],[1453,9,1453,10,1],[1459,9,1459,22,0],[1460,9,1460,10,0],[1461,9,1461,10,0],[1463,9,1464,53,0],[1465,9,1465,10,0],[1466,13,1466,26,0],[1467,13,1467,30,0],[1468,13,1468,38,0],[1469,13,1469,73,0],[1470,13,1470,52,0],[1471,17,1471,43,0],[1472,13,1472,74,0],[1473,9,1473,10,0],[1479,9,1479,26,1],[1480,9,1480,10,1],[1481,13,1481,41,1],[1482,9,1482,10,1],[1484,9,1486,70,1],[1487,9,1487,10,1],[1488,13,1488,41,1],[1489,13,1489,26,1],[1490,13,1490,30,1],[1491,13,1491,38,1],[1492,13,1492,73,1],[1493,13,1493,52,1],[1494,17,1494,43,1],[1495,13,1495,56,1],[1496,13,1496,74,1],[1497,13,1497,28,1],[1498,9,1498,10,1],[1500,38,1500,42,1],[1500,43,1500,55,1],[1503,9,1503,10,0],[1505,13,1505,35,0],[1507,9,1507,10,0],[1513,9,1513,29,0],[1514,9,1514,10,0],[1515,13,1515,41,0],[1516,9,1516,10,0],[1518,9,1519,53,1],[1520,9,1520,10,1],[1521,13,1521,41,1],[1522,13,1522,26,1],[1523,13,1523,30,1],[1524,13,1524,38,1],[1525,13,1525,73,1],[1526,13,1526,52,1],[1527,17,1527,43,0],[1528,13,1528,74,1],[1529,9,1529,10,1],[1531,38,1531,42,1],[1531,43,1531,55,1],[1535,17,1535,18,1],[1535,19,1535,45,1],[1535,46,1535,47,1],[1539,9,1539,10,0],[1540,13,1540,35,0],[1542,9,1542,10,0],[1548,9,1548,28,0],[1549,9,1549,10,0],[1550,13,1550,41,0],[1551,9,1551,10,0],[1553,9,1554,95,1],[1555,9,1555,10,1],[1556,13,1556,41,1],[1557,13,1557,26,1],[1558,13,1558,30,1],[1559,13,1559,38,1],[1560,13,1560,73,1],[1561,13,1561,52,1],[1562,17,1562,43,0],[1563,13,1563,74,1],[1564,13,1564,42,1],[1565,9,1565,10,1],[1567,38,1567,42,1],[1567,43,1567,55,1],[1569,40,1569,44,1],[1569,45,1569,49,1],[1573,17,1573,18,1],[1573,19,1573,45,1],[1573,46,1573,47,1],[1577,9,1577,10,1],[1578,13,1578,35,1],[1579,9,1579,10,1],[1582,9,1582,10,0],[1583,13,1583,38,0],[1584,9,1584,10,0],[1590,9,1590,29,0],[1591,9,1591,10,0],[1592,13,1592,41,0],[1593,9,1593,10,0],[1595,9,1596,95,1],[1597,9,1597,10,1],[1598,13,1598,41,1],[1599,13,1599,26,1],[1600,13,1600,30,1],[1601,13,1601,38,1],[1602,13,1602,73,1],[1603,13,1603,52,1],[1604,17,1604,43,0],[1605,13,1605,74,1],[1606,13,1606,42,1],[1607,9,1607,10,1],[1609,38,1609,42,1],[1609,43,1609,55,1],[1611,40,1611,44,1],[1611,45,1611,49,1],[1615,17,1615,18,0],[1615,19,1615,45,0],[1615,46,1615,47,0],[1619,9,1619,10,1],[1620,13,1620,35,1],[1621,9,1621,10,1],[1638,9,1638,67,1],[1639,9,1639,77,1],[1646,9,1646,26,1],[1647,9,1647,10,1],[1648,13,1648,40,1],[1649,9,1649,10,1],[1652,15,1652,21,1],[1653,9,1653,10,1],[1654,13,1654,21,1],[1655,13,1655,30,1],[1656,13,1656,39,1],[1657,9,1657,10,1],[1660,15,1660,21,1],[1661,9,1661,10,1],[1662,13,1662,21,1],[1663,13,1663,30,1],[1664,13,1664,39,1],[1665,13,1665,40,1],[1666,9,1666,10,1],[1669,15,1669,21,0],[1670,9,1670,10,0],[1671,13,1671,21,0],[1672,13,1672,30,0],[1673,13,1673,39,0],[1674,13,1674,74,0],[1675,9,1675,10,0],[1678,15,1678,21,0],[1679,9,1679,10,0],[1680,13,1680,21,0],[1681,13,1681,30,0],[1682,13,1682,39,0],[1683,13,1683,32,0],[1684,9,1684,10,0],[1688,15,1688,21,1],[1689,9,1689,10,1],[1690,13,1690,21,1],[1691,13,1691,30,1],[1692,13,1692,39,1],[1693,13,1693,32,1],[1694,9,1694,10,1],[1697,15,1697,21,0],[1698,9,1698,10,0],[1699,13,1699,21,0],[1700,13,1700,30,0],[1701,13,1701,39,0],[1702,13,1702,32,0],[1703,13,1703,32,0],[1704,9,1704,10,0],[1707,15,1707,21,0],[1708,9,1708,10,0],[1709,13,1709,21,0],[1710,13,1710,30,0],[1711,13,1711,39,0],[1712,13,1712,36,0],[1713,13,1713,46,0],[1714,9,1714,10,0],[1717,28,1717,32,1],[1717,33,1717,37,1],[1720,30,1720,34,1],[1720,35,1720,39,1],[1723,30,1723,34,1],[1723,35,1723,39,0],[1726,35,1726,39,1],[1726,40,1726,44,1],[1729,37,1729,41,0],[1729,42,1729,46,0],[1732,33,1732,37,0],[1732,38,1732,42,0],[1735,33,1735,37,1],[1735,38,1735,42,0],[1740,17,1740,18,0],[1740,19,1740,32,0],[1740,33,1740,34,0],[1742,13,1742,14,0],[1743,17,1743,37,0],[1744,17,1744,66,0],[1745,17,1745,36,0],[1746,13,1746,14,0],[1752,17,1752,18,0],[1752,19,1752,40,0],[1752,41,1752,42,0],[1753,17,1753,18,0],[1753,19,1753,41,0],[1753,42,1753,43,0],[1759,17,1759,18,0],[1759,19,1759,39,0],[1759,40,1759,41,0],[1761,13,1761,14,0],[1762,17,1762,38,0],[1763,17,1763,66,0],[1764,17,1764,43,0],[1765,13,1765,14,0],[1771,17,1771,18,0],[1771,19,1771,53,0],[1771,54,1771,55,0],[1772,17,1772,18,0],[1772,19,1772,54,0],[1772,55,1772,56,0],[1781,17,1781,18,0],[1781,19,1781,50,0],[1781,51,1781,52,0],[1785,9,1785,10,0],[1786,13,1786,38,0],[1787,9,1787,10,0],[1790,9,1790,10,0],[1791,13,1791,41,0],[1792,9,1792,10,0],[1795,9,1795,10,0],[1796,13,1796,34,0],[1797,9,1797,10,0],[1800,9,1800,10,0],[1801,13,1801,43,0],[1802,9,1802,10,0]]);
    </script>
  </body>
</html>