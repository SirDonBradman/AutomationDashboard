<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Core Modules\Submittals\Response.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using System.Text;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.LinksBL;
using Aurigo.AMP3.LinksDTO;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.SubmittalsBL;
using Aurigo.AMP3.SubmittalsDTO;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using System.Web;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.AMP3.Submittals.UI
{
    public partial class Response : BrixPageBase
    {
        protected ModalPopupExtender PopupExtender;
        private BrixFormModel model;
        private XMLFormManagerModel managerModel;
        protected global::Aurigo.Brix.Platform.BusinessLayer.UserControls.PickerGrid pickerExternalUsers;
        protected global::Aurigo.Brix.Platform.BusinessLayer.UserControls.PickerGrid pickerInternalUsers;

        protected override void OnPreInit(EventArgs e)
        {
            //if (!String.IsNullOrEmpty(Request[&quot;PID&quot;]))
            //    ModuleId = Request[&quot;PID&quot;].Equals(&quot;0&quot;) ? &quot;LANDMGT&quot; : &quot;SUBMTAL&quot;;

            this.ModuleId = SubmittalsManager.Helper_GetModuleId_ForRelevant_SubmittalsPage(Request[&quot;PID&quot;], Request[&quot;Link&quot;]);

            base.OnPreInit(e);
            SetManagerModel();
            if (managerModel != null)
                managerModel.OnPreInit(model, new XmlFormArgs());
        }
        private void SetManagerModel()
        {
            model = BrixFormModel.GetInstance(&quot;SUBRESP&quot;, &quot;SUBRESP&quot;, Request, Response);

            if (!string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp; !string.IsNullOrEmpty(model.form.FormManagerClass))
            {
                managerModel = AMP3InterfaceFactory.GetInstance&lt;XMLFormManagerModel&gt;(model.form.ManagerDLL,
                                                                                 model.form.FormManagerClass);
                // managerModel.PageViewState = ViewState;
            }
        }
        protected override void OnInit(EventArgs e)
        {
            PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);

            //Based on whether it is reply or transmittals need to set the permission
            string modeParamValue = Request[ProjectSubmittalsListModel.CONST_QueryParamName_Mode];

            if (modeParamValue == SubConstants.DIRECTION_IN) //Indicating that it is &quot;Reply&quot;
                PermissionsToCheck.Add(&quot;Reply&quot;);
            else if (modeParamValue == SubConstants.DIRECTION_OUT) //Indicating that it is &quot;Transmittal&quot;
                PermissionsToCheck.Add(&quot;Transmit&quot;);

            foreach (Control ctl in mypager.Controls)
            {
                if (ctl.GetType() == typeof(ImageButton))
                {
                    ((ImageButton)ctl).OnClientClick = &quot;PreserveSelection(false)&quot;;
                }
            }

            ((PagerControl)mypager).ItemClicked += HandlePagerEvent;
            mypager.EnableViewState = true;
            //usergrid.InitializeLayout += new InitializeLayoutEventHandler(usergrid_InitializeLayout);

            //ModalPopupExtender PopupExtender = (ModalPopupExtender)this.Master.FindControl(&quot;filterExtender&quot;);
            //We need to clean up the Old Picker that is built explicitly in this page as we are now using the pickerInternalUsers Picker in place of it
            //PopupExtender.AddNewPopup(aspPnlUsers.ClientID, btnUsers.ClientID, btnClose.ClientID, 500, 815, &quot;Users&quot;);
            //PopupExtender.AddNewPopup(aspPnlFilter.ClientID, lbFilter.ClientID, btnStdCncl.ClientID, 500, 815);
            //filter is disable temporarly as it is not working --sumit
            lbFilter.Visible = false;
            if (!IsPostBack)
            {
                AttachmentsControl attCtrl = (attachments as AttachmentsControl);
                List&lt;LinkDetails&gt; links = LinksManager.Instance.GetLinksForModuleInstance(Request[&quot;RegisterID&quot;], &quot;SUBMTAL&quot;, &quot;&quot;);
                if (links != null &amp;&amp; links.Count &gt; 0)
                    foreach (LinkDetails link in links)
                        if (link.DestType.Equals(&quot;DOCMGMT&quot;))
                            attCtrl.AddNewAttachment(link, &quot;Linked&quot;, -1);
            }
            base.PageUniqueID = HttpContext.Current.Request.QueryString[&quot;Link&quot;];
            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnInit(model, args);
            base.OnInit(e);
            InitializePicker(&quot;_table:vw_LIBRARYContactList&quot;, &quot;ExternalUsers&quot;);
            InitializePicker(&quot;_table:vw_GetUSRMGMTUserDetails&quot;, &quot;InternalUsers&quot;);
        }
        private void InitializePicker(string dataSource, string type)
        {

            string json = &quot;{&quot;;
            json += &quot;\&quot;DataSource\&quot; : \&quot;&quot; + dataSource + &quot;\&quot;&quot;;
            json += &quot;}&quot;;
            switch (type)
            {
                case &quot;ExternalUsers&quot;:
                    pickerExternalUsers.InitializePicker(&quot;/api/GenericXMLPicker/&quot;, GetPickerColumns(type), &quot;ID&quot;);
                    pickerExternalUsers.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                    pickerExternalUsers.EnableMultiSelect = true;
                    pickerExternalUsers.BeforePickerLoadScript = &quot;GetUserBasedOnTransmittalType()&quot;;
                    pickerExternalUsers.AfterPickerSelectScript = &quot;AddSelectedUser({0},&#39;&quot; + type + &quot;&#39;)&quot;;
                    pickerExternalUsers.Title = &quot;Users&quot;;
                    btnExUsers.OnClientClick = &quot;return openPickerPopUp(&#39;&quot; + pickerExternalUsers.TriggerButton.ClientID + &quot;&#39;);&quot;;
                    pickerExternalUsers.GetCheckedItemScript = &quot;GetCheckedItems(&#39;&quot; + type + &quot;&#39;)&quot;;
                    pickerExternalUsers.OptionalParamaters = pickerExternalUsers.BuildOptionalParameters(json);
                    break;

                case &quot;InternalUsers&quot;:
                    pickerInternalUsers.InitializePicker(&quot;/api/GenericXMLPicker/&quot;, GetPickerColumns(type), &quot;ID&quot;);
                    pickerInternalUsers.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                    pickerInternalUsers.EnableMultiSelect = true;
                    pickerInternalUsers.AfterPickerSelectScript = &quot;AddSelectedUser({0},&#39;&quot; + type + &quot;&#39;)&quot;;
                    pickerInternalUsers.Title = &quot;Users&quot;;
                    btnUsers.OnClientClick = &quot;return openPickerPopUp(&#39;&quot; + pickerInternalUsers.TriggerButton.ClientID + &quot;&#39;);&quot;;
                    pickerInternalUsers.GetCheckedItemScript = &quot;GetCheckedItems(&#39;&quot; + type + &quot;&#39;)&quot;;
                    pickerInternalUsers.OptionalParamaters = pickerInternalUsers.BuildOptionalParameters(json);
                    break;

            }

        }
        private List&lt;PickerColumnDetails&gt; GetPickerColumns(string type)
        {

            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();
            List&lt;string&gt; allColumns = null;
            Dictionary&lt;string, string&gt; visibleColumns = null;

            switch (type)
            {
                case &quot;ExternalUsers&quot;:
                    allColumns = new List&lt;string&gt;() {&quot;ID&quot;,&quot;Name&quot;, &quot;Contact&quot;,&quot;Address1&quot;,
            &quot;Address2&quot;, &quot;Address3&quot;,&quot;City&quot;, &quot;State&quot;,&quot;ZipCode&quot; ,&quot;FaxNo&quot;, &quot;EmailID&quot;,&quot;Contractor&quot;};

                    visibleColumns = new Dictionary&lt;string, string&gt;();
                    visibleColumns.Add(&quot;Name&quot;, &quot;Name&quot;);
                    visibleColumns.Add(&quot;ContactNo&quot;, &quot;ContactNo&quot;);
                    visibleColumns.Add(&quot;Address1&quot;, &quot;Address 1&quot;);
                    visibleColumns.Add(&quot;Address2&quot;, &quot;Address 2&quot;);
                    visibleColumns.Add(&quot;Address3&quot;, &quot;Address 3&quot;);
                    visibleColumns.Add(&quot;City&quot;, &quot;City&quot;);
                    visibleColumns.Add(&quot;State&quot;, &quot;State&quot;);
                    visibleColumns.Add(&quot;ZipCode&quot;, &quot;ZipCode&quot;);
                    visibleColumns.Add(&quot;FaxNo&quot;, &quot;Fax&quot;);
                    visibleColumns.Add(&quot;EmailID&quot;, &quot;Email&quot;);
                    visibleColumns.Add(&quot;Contractor&quot;, &quot;Contractor&quot;);
                    break;

                case &quot;InternalUsers&quot;:
                    allColumns = new List&lt;string&gt;() {&quot;ID&quot;,&quot;UserName&quot;, &quot;FirstName&quot;,&quot;MiddleName&quot;,
            &quot;LastName&quot;, &quot;Email&quot;};

                    visibleColumns = new Dictionary&lt;string, string&gt;();
                    visibleColumns.Add(&quot;UserName&quot;, &quot;User Name&quot;);
                    visibleColumns.Add(&quot;FirstName&quot;, &quot;First Name&quot;);
                    visibleColumns.Add(&quot;MiddleName&quot;, &quot;Middle Name&quot;);
                    visibleColumns.Add(&quot;LastName&quot;, &quot;Last Name&quot;);
                    visibleColumns.Add(&quot;Email&quot;, &quot;Email&quot;);
                    break;
            }
            foreach (string col in allColumns)
            {
                if (!visibleColumns.ContainsKey(col))
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = col, ColumnName = col, Hidden = true };
                    gridColumns.Add(tCol);
                }
                else
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = visibleColumns[col], ColumnName = col, Hidden = false, Width = 200, Type = &quot;string&quot; };
                    gridColumns.Add(tCol);
                }
            }

            return gridColumns;
        }
        private void GoBack()
        {
            Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, true);
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            #region URL Validation

            try
            {
                Request[&quot;PID&quot;].ToInt32_2();
                Request[&quot;RegisterID&quot;].ToInt32_2();
                Request[&quot;LinkID&quot;].ToInt32_2();
            }
            catch
            {
                GoBack();
            }

            if (string.IsNullOrEmpty(Request[&quot;Mode&quot;]) || string.IsNullOrEmpty(Request[&quot;PID&quot;]) ||
                string.IsNullOrEmpty(Request[&quot;RegisterID&quot;]) || string.IsNullOrEmpty(Request[&quot;Link&quot;]) ||
                string.IsNullOrEmpty(Request[&quot;LinkID&quot;]))
            {
                GoBack();
            }
            if (!(Request[&quot;Mode&quot;] == &quot;I&quot; || Request[&quot;Mode&quot;] == &quot;O&quot;))
            {
                GoBack();
            }
            if (
                !(Request[&quot;Link&quot;] == &quot;PROJECT&quot; || Request[&quot;Link&quot;] == &quot;CONTMGT&quot; || Request[&quot;Link&quot;] == &quot;ESTMATE&quot; ||
                  Request[&quot;Link&quot;] == &quot;LANDMGT&quot;))
            {
                GoBack();
            }

            #endregion

            #region Authorization

            UIHelper.DisableRoleSelection(Page);

            string strModID = SubmittalsManager.Helper_GetModuleId_ForSubmittals_ByLinkId(Request[&quot;Link&quot;], Constants.MODID_PROJECT_Submittals);

            List&lt;string&gt; featurelist = ModuleManager.Instance.GetPermissionByUserOrRole(strModID, UserDetail.GetCurrentUserDetail().UID,
                            UserDetail.GetCurrentUserDetail().RID, Request.QueryString[&quot;PID&quot;].ToInt32_2());
            if (!(featurelist.Contains(&quot;Reply&quot;) || featurelist.Contains(&quot;Transmit&quot;)))
                UIHelper.RedirectURL(
                    &quot;The current role does not have the required permissions to view this page.&quot;,
                    ResolveUrl(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                               &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                               Request[&quot;LinkID&quot;]), null, Context);

            if (Request[&quot;Mode&quot;] == &quot;I&quot;)
            {
                btnSave.Enabled = featurelist.Contains(&quot;Reply&quot;);
                trTransmittalType.Visible = false;
            }
            if (Request[&quot;Mode&quot;] == &quot;O&quot;)
            {
                btnSave.Enabled = featurelist.Contains(&quot;Transmit&quot;);
            }

            #endregion

            SetPageTitle();
            usergrid.DisplayLayout.Pager.PageSize = 17;
            PopulateDetails();
            if (!String.IsNullOrEmpty(Request[&quot;Mode&quot;]) &amp;&amp; Request[&quot;Mode&quot;] == &quot;O&quot;)
            {
                ViewState[&quot;FILTER&quot;] = UIHelper.GenerateFilterXML(aspPnlFilter);
                BindData();
            }
            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnPageLoad(model, args);

            txtTo.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);
            txtToEx.Attributes.Add(&quot;readonly&quot;, &quot;readonly&quot;);

            if (!Page.IsPostBack)
            {
                string errDocuSign = string.Empty;
                if (Session[&quot;DocuSignErr&quot;] != null)
                    errDocuSign = Session[&quot;DocuSignErr&quot;].ToString();

                if (!string.IsNullOrEmpty(errDocuSign))
                {
                    ShowError(errDocuSign);
                    Session.Remove(&quot;DocuSignErr&quot;);
                }
            }
        }

        private void SetPageTitle()
        {
            if (String.IsNullOrEmpty(Request[&quot;Link&quot;]))
            {
                PageTitle = &quot;Submittals&quot;;
            }
            else if (Request[&quot;Mode&quot;] == &quot;I&quot;)
            {
                PageTitle = &quot;Responding to Submittal&quot;;
            }
            else if (Request[&quot;Mode&quot;] == &quot;O&quot;)
            {
                PageTitle = &quot;Transmitting a Submittal&quot;;
            }
        }

        private void SetLocalization()
        {
            tdIDesc.InnerText = &quot;Item Description :&quot;;
            tdComp.InnerText = &quot;Item Component :&quot;;
        }

        public void HandlePagerEvent(object sender, ItemClickEventArgs e)
        {
            BindData();
            usergrid.DisplayLayout.Pager.CurrentPageIndex = 1;
        }

        private void PopulateDetails()
        {
            txtMessage.Attributes.Add(&quot;MaxLength&quot;, &quot;2000&quot;);
            if (!IsPostBack)
            {
                DataTable dtSubDetails =
                    SubmittalsManager.BLInstance.GetSubmittals(Request[&quot;RegisterID&quot;].ToString2().ToInt32_2(),
                                                               Request[Constants.QRY_PROJECTID].ToInt32_2(),
                                                               null, null, null, null, Request[&quot;Link&quot;],
                                                               Request[&quot;LinkID&quot;].ToInt32_2(), &#39;N&#39;);


                if (Request[&quot;Link&quot;] != &quot;PROJECT&quot; &amp;&amp; Request[&quot;Link&quot;] != &quot;LANDMGT&quot;)
                {
                    lblLineNo.Text = dtSubDetails.Rows[0][&quot;LineNo&quot;].ToString2();
                    lblItemDescription.Text = dtSubDetails.Rows[0][&quot;ItemDescription&quot;].ToString2();
                    lblItemComponent.Text = dtSubDetails.Rows[0][&quot;Component&quot;].ToString2();
                }

                lblSubmittalRef.Text = dtSubDetails.Rows[0][&quot;Reference&quot;].ToString2();
                lblSubmittalNotes.Text = dtSubDetails.Rows[0][&quot;Notes&quot;].ToString2();
                lblRemarks.Text = dtSubDetails.Rows[0][&quot;Remarks&quot;].ToString2();
                lblDuedt.Text = dtSubDetails.Rows[0][&quot;DueDate&quot;].ToMWDateTimeString_FormatDate();
                lblSubmittalType.Text = dtSubDetails.Rows[0][&quot;SubmittalType&quot;].ToString2();
                lblSubmittalReq.Text = dtSubDetails.Rows[0][&quot;Requirement&quot;].ToString2();
                lblSubmittalDesc.Text = dtSubDetails.Rows[0][&quot;Description&quot;].ToString2();
            }
        }

        protected void btnSaveResponse_Click(object sender, EventArgs e)
        {
            try
            {
                DTOHistory dtoHistory = new DTOHistory();
                dtoHistory.SubmittalID = Request[&quot;RegisterID&quot;].ToInt32_2();
                dtoHistory.HistoryID = null;
                dtoHistory.HistoryIDSXML = null;
                dtoHistory.Subject = txtSubject.Text;
                dtoHistory.Message = txtMessage.Text.Trim();
                dtoHistory.Remarks = txtRemarks.Text.Trim();
                dtoHistory.PostedBy = UserDetail.GetCurrentUserDetail().UID;
                dtoHistory.PostedOn = DateTime.UtcNow;
                dtoHistory.Status = (Request[&quot;Mode&quot;] == &quot;O&quot;) ? SubConstants.REPLY_AWAITED : SubConstants.PENDING;
                dtoHistory.TransactionType = Request[&quot;Mode&quot;];
                if (Request[&quot;Mode&quot;] == &quot;O&quot;)
                {
                    dtoHistory.PostedTo = hdnUserIDS.Value;
                    dtoHistory.PostedToExtUsr = hdnExUserIDS.Value;
                }
                int historyID = SubmittalsManager.BLInstance.AddResponse(Operations.Reply, dtoHistory);
                ((AttachmentsControl)attachments).SrcModuleID = &quot;SUBMTAL&quot;;
                ((AttachmentsControl)attachments).ParentModuleID = Request[&quot;Link&quot;];
                ((AttachmentsControl)attachments).ParentInstanceID = Request[&quot;Link&quot;] == &quot;PROJECT&quot; ? string.IsNullOrEmpty(Request[&quot;PID&quot;]) ? 0 : Request[&quot;PID&quot;].ToInt32_2() : string.IsNullOrEmpty(Request[&quot;LinkID&quot;]) ? 0 : Request[&quot;LinkID&quot;].ToInt32_2();

                if (((AttachmentsControl)attachments).SaveAttachments(historyID.ToString2(), &quot;HISTORY&quot;,
                                                                       UserDetail.GetCurrentUserDetail().UID,
                                                                       UserDetail.GetCurrentUserDetail().UserName,
                                                                       &quot;History Attachments&quot;))
                {
                    SubmittalsManager.BLInstance.UpdateAttachmentStatus(historyID,
                                                                        ((AttachmentsControl)attachments).
                                                                            HasAttachments(), SubConstants.HISTORY);
                }
                if (Request[&quot;Mode&quot;] == &quot;O&quot; &amp;&amp; rblTransmittalType.Text == &quot;true&quot; &amp;&amp; (sender as LargeButton).ID != &quot;lnkSaveDraft&quot;)
                {
                    SendEmail(historyID);
                }
                XmlFormArgs args = new XmlFormArgs();
                if (managerModel != null)
                    managerModel.AfterSave(model, args);
                //Go back to respective submittal register list
                Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                  &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; +
                                  Request[&quot;LinkID&quot;]);
            }
            catch (Exception ex)
            {
                ScriptManager.RegisterStartupScript(upGhost, GetType(), &quot;alert&quot;, &quot;ShowError(&#39;&quot; +
                                                                                 ex.Message.Replace(&quot;&#39;&quot;, &quot;\\&#39;&quot;).Replace(
                                                                                     &quot;\r\n&quot;, &quot;\\n&quot;) + &quot;&#39;);&quot;, true);
            }
        }

        private void SendEmail(int historyID)
        {
            var sb = new StringBuilder();

            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;b&gt;Transmittal&lt;/b&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;br/&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;b&gt;From: &lt;/b&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;br/&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;b&gt;User ID: &lt;b&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, UserDetail.GetCurrentUserDetail().UserID);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;br/&gt;&quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;User Name: &quot;);
            sb.AppendFormat(CultureInfo.CurrentCulture,
                            UserDetail.GetCurrentUserDetail().FirstName + &quot; &quot; +
                            UserDetail.GetCurrentUserDetail().MiddleName + &quot; &quot; +
                            UserDetail.GetCurrentUserDetail().LastName);


            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Submittal Description: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblSubmittalDesc.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Submittal Type: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblSubmittalType.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Submittal Requirement: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblSubmittalReq.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Submittal Reference: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblSubmittalRef.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Submittal Notes: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblSubmittalNotes.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Approved Due Date: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&lt;/td&gt;&lt;/tr&gt;&quot;,
                            lblDuedt.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Message: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&lt;/td&gt;&lt;/tr&gt;&quot;,
                            txtMessage.Text);
            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Remarks: &lt;/b&gt;\&quot;{0}\&quot; &lt;/td&gt;&lt;/tr&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;,
                            txtRemarks.Text);

            string sendToAddress = string.Empty;
            if (hdnTo.Value.Length &gt; 0)
            {
                sendToAddress += hdnTo.Value.Trim(&quot;, &quot;.ToCharArray());
            }
            if (hdnToEx.Value.Length &gt; 0)
            {
                if (sendToAddress != &quot;&quot;)
                {
                    sendToAddress += &quot;, &quot;;
                }
                sendToAddress += hdnToEx.Value.Trim(&quot;, &quot;.ToCharArray());
            }


            Mailer.SendEmails(UserDetail.GetCurrentUserDetail().Email, sendToAddress.Replace(&quot;,&quot;, &quot;;&quot;),
                          txtSubject.Text, sb.ToString2(), historyID.ToString(), &quot;HISTORY&quot;, &quot;&quot;);
        }

        private void GetPageCount()
        {
            double rCnt;
            string pageCount;

            rCnt =
                UserManager.Instance.GetAllUsersCount(ViewState[&quot;FILTER&quot;] == null
                                                          ? null
                                                          : ViewState[&quot;FILTER&quot;].ToString2());

            ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value = rCnt &gt; 0
                                                                               ? ((HtmlInputHidden)
                                                                                  mypager.FindControl(&quot;currentPage&quot;)).
                                                                                     Value
                                                                               : &quot;0&quot;;

            ((HtmlInputHidden)mypager.FindControl(&quot;pageCount&quot;)).Value = pageCount =
                                                                         rCnt &gt; usergrid.DisplayLayout.Pager.PageSize
                                                                             ? Convert.ToString(
                                                                                 Math.Ceiling(rCnt /
                                                                                              usergrid.DisplayLayout.
                                                                                                  Pager.PageSize),
                                                                                 CultureInfo.CurrentCulture)
                                                                             : rCnt &gt; 0 ? &quot;1&quot; : &quot;0&quot;;

            (mypager as PagerControl).Set_Page((mypager.FindControl(&quot;currentPage&quot;)
                                                as HtmlInputHidden).Value.ToInt32_2(), pageCount.ToInt32_2());
        }

        public void BindData()
        {
            try
            {
                int startIdx = ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value.ToInt32_2() - 1;
                //if (startIdx &gt; 1)
                {
                    startIdx = 1 + (usergrid.DisplayLayout.Pager.PageSize * startIdx);
                }
                Dictionary&lt;int, object&gt; userList = UserManager.Instance.GetAllUsers(startIdx,
                                                                                    usergrid.DisplayLayout.Pager.
                                                                                        PageSize,
                                                                                    ViewState[&quot;SORTORDER&quot;] == null
                                                                                        ? null
                                                                                        : ViewState[&quot;SORTORDER&quot;].
                                                                                              ToString2(),
                                                                                    ViewState[&quot;FILTER&quot;] == null
                                                                                        ? null
                                                                                        : ViewState[&quot;FILTER&quot;].ToString2());
                usergrid.Visible = true;
                usergrid.DataSource = userList.Values;
                usergrid.DataBind();
                GetPageCount();
                SetGridColumns();
                //Restore Selections...
                if (!String.IsNullOrEmpty(hdnUserIDS.Value))
                {
                    int IdIndex = usergrid.Columns.IndexOf(&quot;UserId&quot;);
                    int ChkBoxIndex = usergrid.Columns.IndexOf(&quot;Multi&quot;);
                    String[] userIDs = hdnUserIDS.Value.Split(&#39;,&#39;);

                    foreach (UltraGridRow row in usergrid.Rows)
                    {
                        foreach (string id in userIDs)
                        {
                            if (IdIndex != -1 &amp;&amp; id == row.Cells[IdIndex].Value.ToString2())
                            {
                                row.Cells[ChkBoxIndex].Value = true;
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                ScriptManager.RegisterStartupScript(upGhost, GetType(), &quot;alert&quot;, &quot;ShowError(&#39;&quot; +
                                                                                 ex.Message.Replace(&quot;&#39;&quot;, &quot;\\&#39;&quot;).Replace(
                                                                                     &quot;\r\n&quot;, &quot;\\n&quot;) + &quot;&#39;);&quot;, true);
            }
        }

        protected void SetGridColumns()
        {
            ColumnsCollection cols;
            //UltraGridColumn c;
            foreach (UltraGridColumn col in usergrid.Columns)
            {
                col.Hidden = true;
            }

            cols = usergrid.Bands[0].Columns;

            cols.FromKey(&quot;UserName&quot;).Hidden = false;
            cols.FromKey(&quot;UserName&quot;).Width = Unit.Pixel(120);
            cols.FromKey(&quot;FirstName&quot;).Hidden = false;
            cols.FromKey(&quot;FirstName&quot;).Width = Unit.Pixel(120);
            cols.FromKey(&quot;MiddleName&quot;).Hidden = false;
            cols.FromKey(&quot;MiddleName&quot;).Width = Unit.Pixel(120);
            cols.FromKey(&quot;LastName&quot;).Hidden = false;
            cols.FromKey(&quot;LastName&quot;).Width = Unit.Pixel(120);
            cols.FromKey(&quot;Email&quot;).Hidden = false;
            cols.FromKey(&quot;Email&quot;).Width = Unit.Pixel(220);
            cols.FromKey(&quot;Multi&quot;).Hidden = false;

            cols.FromKey(&quot;UserName&quot;).Header.Caption = &quot;User Name&quot;;
            cols.FromKey(&quot;FirstName&quot;).Header.Caption = &quot;First Name&quot;;
            cols.FromKey(&quot;MiddleName&quot;).Header.Caption = &quot;Middle Name&quot;;
            cols.FromKey(&quot;LastName&quot;).Header.Caption = &quot;Last Name&quot;;

            cols.FromKey(&quot;Multi&quot;).AllowUpdate = AllowUpdate.Yes;

            usergrid.DisplayLayout.ScrollBar = ScrollBar.Auto;
            usergrid.DisplayLayout.FrameStyle.Height = Unit.Percentage(100);
            usergrid.DisplayLayout.Pager.PagerStyle.CustomRules = &quot;display:none&quot;;

            foreach (UltraGridColumn col in usergrid.Columns)
            {
                col.HTMLEncodeContent = true;
            }
        }

        protected void btnCancelResponse_Click(object sender, EventArgs e)
        {
            //Go back to respective submittal register list
            Response.Redirect(&quot;~/Common/BrixListPage.aspx&quot; + &quot;?context=SUBMTAL&amp;Mode=Edit&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                              &quot;&amp;Link=&quot; + Request[&quot;Link&quot;] + &quot;&amp;LinkID=&quot; + Request[&quot;LinkID&quot;] + &quot;&amp;LMID=&quot; + Request[&quot;LinkID&quot;] +&quot;&amp;ParentID=&quot; + Request[&quot;LinkID&quot;]);
        }

        protected void usergrid_SortColumn(object sender, SortColumnEventArgs e)
        {
            ApplySort(e.ColumnNo);
            e.Cancel = true;
        }

        protected void ApplySort(int colNo)
        {
            string sortKey;
            sortKey = usergrid.Columns[colNo].BaseColumnName;


            foreach (UltraGridColumn uwgcol in usergrid.DisplayLayout.Bands[0].Columns)
            {
                if (uwgcol.SortIndicator != SortIndicator.None)
                    uwgcol.SortIndicator = SortIndicator.None;
            }
            if (ViewState[&quot;SORTORDER&quot;] != null
                &amp;&amp; ViewState[&quot;SORTORDER&quot;].ToString2().EndsWith(&quot;ASC&quot;, StringComparison.OrdinalIgnoreCase)
                &amp;&amp; ViewState[&quot;SORTORDER&quot;].ToString2().StartsWith(sortKey, StringComparison.OrdinalIgnoreCase))
            {
                ViewState[&quot;SORTORDER&quot;] = sortKey + &quot; DESC&quot;;
                usergrid.Bands[0].Columns[colNo].SortIndicator = SortIndicator.Descending;
            }
            else
            {
                ViewState[&quot;SORTORDER&quot;] = sortKey + &quot; ASC&quot;;
                usergrid.Bands[0].Columns[colNo].SortIndicator = SortIndicator.Ascending;
            }
            BindData();
        }

        protected void btnFilterGhost_Click(object sender, EventArgs e)
        {
            ApplyFilter();
        }

        protected void ApplyFilter()
        {
            try
            {
                ViewState[&quot;FILTER&quot;] = UIHelper.GenerateFilterXML(aspPnlFilter);
                ((HtmlInputHidden)mypager.FindControl(&quot;currentPage&quot;)).Value = &quot;1&quot;;
                BindData();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_USRMGMT);
                throw;
            }
        }

        protected override void CreateChildControls()
        {
            var menus = new MenuArray();
            if (!string.IsNullOrEmpty(Request[&quot;mode&quot;]) &amp;&amp; Request[&quot;mode&quot;].Equals(&quot;O&quot;))
            {
                menus.Add(new BrixMenu(&quot;lnkSaveDraft&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;, 55));
            }
            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkImport&quot;, &quot;Reset&quot;, &quot;Icn_importxl.png&quot;, 55));
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));
            CreateToolBarMenu(menus, null);
            base.CreateChildControls();
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += btnSaveResponse_Click;
                    lnkSave.OnClientClick = &quot;return Validate()&quot;;
                    lnkSave.ToolTip = &quot;Save&quot;;
                    lnkSave.CausesValidation = false;
                }

                if (MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
                {
                    MainToolBar.RenameMenu(&quot;lnkSave&quot;, &quot;Send&quot;);
                    MainToolBar.ChangeMenuImage(&quot;lnkSave&quot;, &quot;Icn_Send_file_32.png&quot;);
                }
            }
            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancelResponse_Click;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkImport&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).OnClientClick = &quot;return resetData()&quot;;
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).ToolTip = &quot;Reset&quot;;
                MainToolBar.GetMenuReference(&quot;lnkImport&quot;).CausesValidation = false;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkSaveDraft&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkSaveDraft&quot;).Click += btnSaveResponse_Click;
                MainToolBar.GetMenuReference(&quot;lnkSaveDraft&quot;).ToolTip = &quot;Save as Draft&quot;;
                MainToolBar.GetMenuReference(&quot;lnkSaveDraft&quot;).CausesValidation = false;
                MainToolBar.HideMenu(&quot;lnkSaveDraft&quot;);
            }
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (!String.IsNullOrEmpty(Request[&quot;Mode&quot;]) &amp;&amp; Request[&quot;Mode&quot;] == &quot;View&quot;)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;);
                    }
                }
            }
            base.OnPreRender(e);

            if (!string.IsNullOrEmpty(hdnExUserIDS.Value))
                pickerExternalUsers.CheckedItemIDs = hdnExUserIDS.Value.Trim(&#39;,&#39;);

            if (!string.IsNullOrEmpty(hdnUserIDS.Value))
                pickerInternalUsers.CheckedItemIDs = hdnUserIDS.Value.Trim(&#39;,&#39;);
        }

        public override int GetProjectIdFromInstanceId()
        {
            //If the Link is Project or Land then no need to check the PID as land is outside of project 
            //and Project submittals has only PID

            string strModID = Request[&quot;Link&quot;];

            if (strModID.Equals(Constants.MODID_CONTMGT, StringComparison.CurrentCultureIgnoreCase) ||
                strModID.Equals(Constants.MODID_ESTMATE, StringComparison.CurrentCultureIgnoreCase))
            {
                return SubmittalsManager.BLInstance.GetPIDFromLinkModule(strModID, Request[&quot;LinkID&quot;].ToInt32_2());
            }
            else
                return base.GetProjectIdFromInstanceId();

        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[39,9,39,10,1],[43,13,43,126,1],[45,13,45,31,1],[46,13,46,31,1],[47,13,47,38,1],[48,17,48,66,0],[49,9,49,10,1],[51,9,51,10,1],[52,13,52,88,1],[54,13,54,116,1],[55,13,55,14,0],[56,17,57,111,0],[59,13,59,14,0],[60,9,60,10,1],[62,9,62,10,1],[63,13,63,66,1],[66,13,66,99,1],[68,13,68,61,1],[69,17,69,49,1],[70,18,70,67,1],[71,17,71,52,1],[73,13,73,20,1],[73,22,73,33,1],[73,34,73,36,1],[73,37,73,53,1],[74,13,74,14,1],[75,17,75,58,1],[76,17,76,18,1],[77,21,77,83,1],[78,17,78,18,1],[79,13,79,14,1],[81,13,81,69,1],[82,13,82,44,1],[90,13,90,38,1],[91,13,91,29,1],[92,13,92,14,1],[93,17,93,82,1],[94,17,94,129,1],[95,17,95,54,1],[96,21,96,28,0],[96,30,96,46,0],[96,47,96,49,0],[96,50,96,55,0],[97,25,97,61,0],[98,29,98,74,0],[99,13,99,14,1],[100,13,100,81,1],[101,13,101,50,1],[102,13,102,38,1],[103,17,103,50,0],[104,13,104,28,1],[105,13,105,79,1],[106,13,106,82,1],[107,9,107,10,1],[109,9,109,10,1],[111,13,111,31,1],[112,13,112,63,1],[113,13,113,25,1],[114,13,114,26,1],[117,21,117,114,1],[118,21,118,102,1],[119,21,119,66,1],[120,21,120,100,1],[121,21,121,105,1],[122,21,122,57,1],[123,21,123,128,1],[124,21,124,98,1],[125,21,125,112,1],[126,21,126,27,1],[129,21,129,114,1],[130,21,130,102,1],[131,21,131,66,1],[132,21,132,105,1],[133,21,133,57,1],[134,21,134,126,1],[135,21,135,98,1],[136,21,136,112,1],[137,21,137,27,1],[141,9,141,10,1],[143,9,143,10,1],[145,13,145,85,1],[146,13,146,44,1],[147,13,147,62,1],[149,13,149,26,1],[152,21,153,96,1],[155,21,155,71,1],[156,21,156,56,1],[157,21,157,66,1],[158,21,158,65,1],[159,21,159,65,1],[160,21,160,65,1],[161,21,161,56,1],[162,21,162,58,1],[163,21,163,62,1],[164,21,164,56,1],[165,21,165,60,1],[166,21,166,68,1],[167,21,167,27,1],[170,21,171,34,1],[173,21,173,71,1],[174,21,174,65,1],[175,21,175,67,1],[176,21,176,69,1],[177,21,177,65,1],[178,21,178,58,1],[179,21,179,27,1],[181,13,181,20,1],[181,22,181,32,1],[181,33,181,35,1],[181,36,181,46,1],[182,13,182,14,1],[183,17,183,54,1],[184,17,184,18,1],[185,21,185,123,1],[186,21,186,43,1],[187,17,187,18,1],[189,17,189,18,1],[190,21,190,170,1],[191,21,191,43,1],[192,17,192,18,1],[193,13,193,14,1],[195,13,195,32,1],[196,9,196,10,1],[198,9,198,10,0],[199,13,199,83,0],[200,9,200,10,0],[203,9,203,10,1],[207,13,207,14,1],[208,17,208,44,1],[209,17,209,51,1],[210,17,210,47,1],[211,13,211,14,1],[212,13,212,18,0],[213,13,213,14,0],[214,17,214,26,0],[215,13,215,14,0],[217,13,219,57,1],[220,13,220,14,0],[221,17,221,26,0],[222,13,222,14,0],[223,13,223,69,1],[224,13,224,14,0],[225,17,225,26,0],[226,13,226,14,0],[227,13,229,49,1],[230,13,230,14,0],[231,17,231,26,0],[232,13,232,14,0],[238,13,238,49,1],[240,13,240,144,1],[242,13,243,108,1],[244,13,244,86,1],[245,17,249,67,0],[251,13,251,40,1],[252,13,252,14,1],[253,17,253,65,1],[254,17,254,51,1],[255,13,255,14,1],[256,13,256,40,1],[257,13,257,14,1],[258,17,258,68,1],[259,13,259,14,1],[263,13,263,28,1],[264,13,264,56,1],[265,13,265,31,1],[266,13,266,82,1],[267,13,267,14,1],[268,17,268,80,1],[269,17,269,28,1],[270,13,270,14,1],[271,13,271,50,1],[272,13,272,38,1],[273,17,273,54,0],[275,13,275,58,1],[276,13,276,60,1],[278,13,278,34,1],[279,13,279,14,1],[280,17,280,51,1],[281,17,281,52,1],[282,21,282,69,0],[284,17,284,56,1],[285,17,285,18,0],[286,21,286,44,0],[287,21,287,51,0],[288,17,288,18,0],[289,13,289,14,1],[290,9,290,10,1],[293,9,293,10,1],[294,13,294,55,1],[295,13,295,14,0],[296,17,296,42,0],[297,13,297,14,0],[298,18,298,45,1],[299,13,299,14,1],[300,17,300,55,1],[301,13,301,14,1],[302,18,302,45,1],[303,13,303,14,1],[304,17,304,56,1],[305,13,305,14,1],[306,9,306,10,1],[309,9,309,10,0],[310,13,310,54,0],[311,13,311,51,0],[312,9,312,10,0],[315,9,315,10,0],[316,13,316,24,0],[317,13,317,63,0],[318,9,318,10,0],[321,9,321,10,1],[322,13,322,60,1],[323,13,323,29,1],[324,13,324,14,1],[325,17,329,100,1],[332,17,332,82,1],[333,17,333,18,0],[334,21,334,81,0],[335,21,335,99,0],[336,21,336,91,0],[337,17,337,18,0],[339,17,339,86,1],[340,17,340,84,1],[341,17,341,79,1],[342,17,342,97,1],[343,17,343,91,1],[344,17,344,88,1],[345,17,345,89,1],[346,13,346,14,1],[347,9,347,10,1],[350,9,350,10,1],[352,13,352,14,1],[353,17,353,58,1],[354,17,354,76,1],[355,17,355,45,1],[356,17,356,49,1],[357,17,357,54,1],[358,17,358,61,1],[359,17,359,61,1],[360,17,360,77,1],[361,17,361,55,1],[362,17,362,114,1],[363,17,363,62,1],[364,17,364,44,1],[365,17,365,18,0],[366,21,366,60,0],[367,21,367,68,0],[368,17,368,18,0],[369,17,369,104,1],[370,17,370,75,1],[371,17,371,84,1],[372,17,372,249,1],[374,17,377,95,1],[378,17,378,18,1],[379,21,381,117,1],[382,17,382,18,1],[383,17,383,129,1],[384,17,384,18,0],[385,21,385,42,0],[386,17,386,18,0],[387,17,387,54,1],[388,17,388,42,1],[389,21,389,57,0],[391,17,393,54,1],[394,13,394,14,0],[395,13,395,33,1],[396,13,396,14,1],[397,17,399,116,1],[400,13,400,14,1],[401,9,401,10,1],[404,9,404,10,0],[405,13,405,42,0],[407,13,407,79,0],[408,13,408,66,0],[409,13,409,74,0],[410,13,410,66,0],[411,13,411,76,0],[412,13,412,99,0],[413,13,413,66,0],[414,13,414,72,0],[415,13,418,73,0],[421,13,422,52,0],[423,13,424,52,0],[425,13,426,51,0],[427,13,428,51,0],[429,13,430,53,0],[431,13,432,44,0],[433,13,434,46,0],[435,13,436,46,0],[438,13,438,49,0],[439,13,439,40,0],[440,13,440,14,0],[441,17,441,71,0],[442,13,442,14,0],[443,13,443,42,0],[444,13,444,14,0],[445,17,445,41,0],[446,17,446,18,0],[447,21,447,43,0],[448,17,448,18,0],[449,17,449,73,0],[450,13,450,14,0],[453,13,454,97,0],[455,9,455,10,0],[458,9,458,10,1],[462,13,465,94,1],[467,13,471,86,1],[473,13,480,101,1],[482,13,483,111,1],[484,9,484,10,1],[487,9,487,10,1],[489,13,489,14,1],[490,17,490,108,1],[492,17,492,18,1],[493,21,493,87,1],[494,17,494,18,1],[495,17,504,124,1],[505,17,505,41,1],[506,17,506,55,1],[507,17,507,37,1],[508,17,508,32,1],[509,17,509,34,1],[511,17,511,61,1],[512,17,512,18,1],[513,21,513,70,1],[514,21,514,73,1],[515,21,515,68,1],[517,21,517,28,1],[517,30,517,46,1],[517,47,517,49,1],[517,50,517,63,1],[518,21,518,22,1],[519,25,519,32,1],[519,34,519,43,1],[519,44,519,46,1],[519,47,519,54,1],[520,25,520,26,1],[521,29,521,93,1],[522,29,522,30,0],[523,33,523,69,0],[524,29,524,30,0],[525,25,525,26,1],[526,21,526,22,1],[527,17,527,18,1],[528,13,528,14,1],[529,13,529,33,0],[530,13,530,14,0],[531,17,533,116,0],[534,13,534,14,0],[535,9,535,10,1],[538,9,538,10,1],[541,13,541,20,1],[541,22,541,41,1],[541,42,541,44,1],[541,45,541,61,1],[542,13,542,14,1],[543,17,543,35,1],[544,13,544,14,1],[546,13,546,46,1],[548,13,548,53,1],[549,13,549,62,1],[550,13,550,54,1],[551,13,551,63,1],[552,13,552,55,1],[553,13,553,64,1],[554,13,554,53,1],[555,13,555,62,1],[556,13,556,50,1],[557,13,557,59,1],[558,13,558,50,1],[560,13,560,67,1],[561,13,561,69,1],[562,13,562,71,1],[563,13,563,67,1],[565,13,565,65,1],[567,13,567,63,1],[568,13,568,77,1],[569,13,569,82,1],[571,13,571,20,1],[571,22,571,41,1],[571,42,571,44,1],[571,45,571,61,1],[572,13,572,14,1],[573,17,573,46,1],[574,13,574,14,1],[575,9,575,10,1],[578,9,578,10,1],[580,13,581,157,1],[582,9,582,10,0],[585,9,585,10,0],[586,13,586,35,0],[587,13,587,29,0],[588,9,588,10,0],[591,9,591,10,0],[593,13,593,62,0],[596,13,596,20,0],[596,22,596,44,0],[596,45,596,47,0],[596,48,596,87,0],[597,13,597,14,0],[598,17,598,64,0],[599,21,599,63,0],[600,13,600,14,0],[601,13,603,111,0],[604,13,604,14,0],[605,17,605,60,0],[606,17,606,91,0],[607,13,607,14,0],[609,13,609,14,0],[610,17,610,59,0],[611,17,611,90,0],[612,13,612,14,0],[613,13,613,24,0],[614,9,614,10,0],[617,9,617,10,0],[618,13,618,27,0],[619,9,619,10,0],[622,9,622,10,0],[624,13,624,14,0],[625,17,625,80,0],[626,17,626,83,0],[627,17,627,28,0],[628,13,628,14,0],[629,13,629,33,0],[630,13,630,14,0],[631,17,631,93,0],[632,17,632,23,0],[634,9,634,10,0],[637,9,637,10,1],[638,13,638,41,1],[639,13,639,87,1],[640,13,640,14,1],[641,17,641,85,1],[642,13,642,14,1],[643,13,643,34,1],[644,13,644,83,1],[645,13,645,82,1],[646,13,646,44,1],[647,13,647,40,1],[648,9,648,10,1],[651,9,651,10,1],[652,13,652,31,1],[653,13,653,14,1],[654,17,654,78,1],[655,17,655,37,1],[656,17,656,18,1],[657,21,657,60,1],[658,21,658,65,1],[659,21,659,46,1],[660,21,660,54,1],[661,17,661,18,1],[663,17,663,69,1],[664,17,664,18,1],[665,21,665,63,1],[666,21,666,84,1],[667,17,667,18,1],[668,13,668,14,1],[669,13,669,67,1],[670,13,670,14,1],[671,17,671,92,1],[672,17,672,84,1],[673,13,673,14,1],[674,13,674,67,1],[675,13,675,14,1],[676,17,676,96,1],[677,17,677,77,1],[678,17,678,84,1],[679,13,679,14,1],[680,13,680,70,1],[681,13,681,14,1],[682,17,682,93,1],[683,17,683,88,1],[684,17,684,87,1],[685,17,685,54,1],[686,13,686,14,1],[687,9,687,10,1],[690,9,690,10,1],[691,13,691,85,1],[692,13,692,14,0],[693,17,693,35,0],[694,17,694,18,0],[695,21,695,82,0],[696,21,696,41,0],[697,21,697,22,0],[698,25,698,57,0],[699,21,699,22,0],[700,17,700,18,0],[701,13,701,14,0],[702,13,702,33,1],[704,13,704,59,1],[705,17,705,83,0],[707,13,707,57,1],[708,17,708,81,0],[709,9,709,10,1],[712,9,712,10,1],[716,13,716,47,1],[718,13,719,101,1],[720,13,720,14,0],[721,17,721,115,0],[724,17,724,58,1],[726,9,726,10,1]]);
    </script>
  </body>
</html>