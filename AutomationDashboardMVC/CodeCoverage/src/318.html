<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Contract Manager\UI\ContractContractors.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Drawing;
using System.IO;
using System.Reflection;
using System.Runtime.Serialization.Json;
using System.Text;
using System.Web.Configuration;
using System.Web.Script.Serialization;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.ContmgtDTO;
using Aurigo.AMP3.ContractManager.BusinessLayer;
using Aurigo.AMP3.ContractManager.BusinessLayer.DAC;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.LibraryBL;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.WORKORDBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;

namespace Aurigo.AMP3.ContmgtUI
{
    public partial class ContractContractors : BrixPageBase
    {
        private bool MasterEdit;
        protected global::Infragistics.WebUI.UltraWebGrid.UltraWebGrid scGrid;

        protected global::Aurigo.Brix.Platform.BusinessLayer.UserControls.PickerGrid pickerPrime;
        protected global::Aurigo.Brix.Platform.BusinessLayer.UserControls.PickerGrid pickerSub;

        private bool SubmitMaster;
        private DataTable dtContractMap;
        private string mappedCompany;
        private string viewState;

        private int pickerPageSize = 19;

        private string MappedCompany
        {
            get
            {
                string mappedCompany = null;
                if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
                {
                    if (dtContractMap == null)
                    {
                        dtContractMap = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(Request[&quot;ContractID&quot;],
                                                                                                 AMP3Object.CONTMGT,
                                                                                                 null,
                                                                                                 AMP3Object.UNKNOWN,
                                                                                                 RegisteredEIS.AX);
                    }
                    if (dtContractMap.Rows.Count &gt; 0)
                        mappedCompany = dtContractMap.Rows[0][&quot;ERPCompany&quot;].ToString();
                    else
                        mappedCompany = Session[Constants.EIS_ADDITIONAL_INFO].ToString();
                }
                return mappedCompany;
            }
        }

        private bool HasLabourManagement
        {
            get
            {
                if (ViewState[&quot;hasLabourManagement&quot;] == null)
                {
                    DataSet ds =
                        ContMgtComponent.Instance.GetContractXmlTree(Request[Constants.QRY_PROJECTID].ToInt32_2(), UserDetail.GetCurrentUserDetail().UID,
                                                                     UserDetail.GetCurrentUserDetail().RID, &quot;W_W_WEB&quot;);
                    ViewState[&quot;hasLabourManagement&quot;] = (ds.Tables.Count &gt; 1 &amp;&amp;
                                                        (ds.Tables[1].Select(&quot;ID=&quot; + Request[&quot;ContractID&quot;] +
                                                                             &quot;AND ModuleID=&#39;LABMGMT&#39;&quot;).Length &gt; 0));
                }
                return ViewState[&quot;hasLabourManagement&quot;].ToBoolean2();
            }
        }

        protected override void OnInit(EventArgs e)
        {
            var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];
            if (featurelist.Contains(&quot;Contractors View&quot;))
            {
                PermissionsToCheck.Add(Constants.MODFEAT_VIEW);
            }

            base.OnInit(e);

            InitializePCPicker();
            InitializeSCPicker();

            var menus = new MenuArray();
            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;Icn_Edit.png&quot;, 55));
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));
            if ((WebConfigurationManager.AppSettings[&quot;EPSModeMultiple&quot;] == &quot;ON&quot;))
                menus.Add(new BrixMenu(&quot;lnkBack&quot;, &quot;Back&quot;, &quot;Icn_Back.png&quot;, 55));
            CreateToolBarMenu(menus, null);
        }

        private List&lt;PickerColumnDetails&gt; GetPickerColumns()
        {
            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();

            List&lt;string&gt; allColumns = new List&lt;string&gt;() {&quot;RecordID&quot;, &quot;Name&quot;, &quot;Contact&quot;, &quot;ID&quot; ,&quot;PhoneNo&quot;, &quot;FaxNo&quot;, &quot;EmailID&quot;,&quot;Address1&quot;,
            &quot;Address2&quot;, &quot;Address3&quot;,&quot;City&quot;, &quot;State&quot;,&quot;ZipCode&quot;,&quot;Type&quot;,&quot;RowNum&quot;};

            Dictionary&lt;string, string&gt; visibleColumns = new Dictionary&lt;string, string&gt;();
            visibleColumns.Add(&quot;Name&quot;, &quot;Contractor&quot;);
            visibleColumns.Add(&quot;Contact&quot;, &quot;Contact&quot;);
            visibleColumns.Add(&quot;ID&quot;, &quot;ID&quot;);
            visibleColumns.Add(&quot;Type&quot;, &quot;Contract Type&quot;);
            foreach (string col in allColumns)
            {
                if (!visibleColumns.ContainsKey(col))
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = col, ColumnName = col, Hidden = true };
                    gridColumns.Add(tCol);
                }
                else
                {
                    PickerColumnDetails tCol = new PickerColumnDetails { Caption = visibleColumns[col], ColumnName = col, Hidden = false, Width = 200, Type = &quot;string&quot; };
                    gridColumns.Add(tCol);
                }
            }

            return gridColumns;
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            try
            {
                MasterEdit =
                    SubmitMaster =
                    btnPCDelete.Visible =
                    btnSCDelete.Visible =
                    btnPCPick.Visible = btnSCPick.Visible = false;
                bool editMode = false;
                viewState = &quot;CONTMGTDTO&quot;;

                List&lt;string&gt; components = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CONTMGT);
                hdnAllowPrimeInSub.Value = components.Contains(&quot;AllowPrimeInSub&quot;).ToString();

                if (String.IsNullOrEmpty(Request[Constants.QRY_PROJECTID]) ||
                    String.IsNullOrEmpty(Request[&quot;ContractID&quot;]))
                    Response.Redirect(
                        &quot;~/Common/BrixListPage.aspx?context=CONTMGT&amp;PID=&quot; + Request[Constants.QRY_PROJECTID], true);

                scGrid.Height = Unit.Pixel(250);

                var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];
                if (!String.IsNullOrEmpty(Request[&quot;ContractID&quot;]))
                {
                    if (!featurelist.Contains(&quot;Contractors View&quot;))
                    {
                        UIHelper.RedirectURL(
                            &quot;The current role does not have the required permissions to view this page.&quot;,
                            ResolveUrl(&quot;~/Common/BrixListPage.aspx?context=CONTMGT&amp;PID=&quot; +
                                       Request[Constants.QRY_PROJECTID]), null, Context);
                    }
                }

                //Disable Role Selection
                UIHelper.DisableRoleSelection(Page);

                if (featurelist.Contains(&quot;Contractors Create&quot;) || featurelist.Contains(&quot;Contractors Edit&quot;))
                {
                    SubmitMaster = btnPCPick.Visible = btnSCPick.Visible = true;
                }
                if (featurelist.Contains(&quot;Contractors Delete&quot;) || featurelist.Contains(&quot;Contractors Edit&quot;))
                {
                    SubmitMaster = true;
                    btnPCDelete.Visible = !string.IsNullOrEmpty(hdnSelectedPC.Value);
                    btnSCDelete.Visible = (scGrid.Rows.Count != 0);
                }

                try
                {
                    DTO dtoLocked = null;
                    dtoLocked = BL.Instance.GetContract(Request[&quot;ContractID&quot;].ToInt32_2(), FetchSet.Contractors);

                    if (dtoLocked.IsDeleted == &quot;Y&quot;)
                        Response.Redirect(&quot;CreateContract.aspx?Mode=View&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                          &quot;&amp;ContractID=&quot; + Request[&quot;ContractID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ContractID&quot;], true);

                    ViewState[&quot;LockStatus&quot;] = dtoLocked;
                }
                catch
                {
                    Response.Redirect(
                        &quot;~/Common/BrixListPage.aspx?context=CONTMGT&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] ??
                        String.Empty, true);
                }

                if (!IsPostBack)
                {
                    DTO dto = null;
                    try
                    {
                        dto = BL.Instance.GetContract(Request[&quot;ContractID&quot;].ToInt32_2(), FetchSet.Contractors);

                        if (dto.IsDeleted == &quot;Y&quot;)
                            Response.Redirect(&quot;CreateContract.aspx?Mode=View&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                                              &quot;&amp;ContractID=&quot; + Request[&quot;ContractID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ContractID&quot;], true);

                        ViewState[viewState] = dto;
                    }
                    catch
                    {
                        Response.Redirect(
                            &quot;~/Common/BrixListPage.aspx?context=CONTMGT&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] ??
                            String.Empty, true);
                    }

                    BindData(dto);
                    if (dto.SC.Count &gt; 0)
                    {
                        editMode = true;
                    }
                    divSCGrid.Visible = scGrid.Visible = (scGrid.Rows.Count != 0);
                    btnSCDelete.Visible = (scGrid.Rows.Count != 0) &amp;&amp;
                                          (featurelist.Contains(CMConstans.MODFEAT_DELETE) ||
                                           featurelist.Contains(CMConstans.MODFEAT_EDIT));

                    #region Check If AX Vendor Group Filter is supported - AX 4.0

                    var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                    dictAdditionalInfo.Add(RegisteredEIS.AX,
                                           new EISAdditionalInfo(RegisteredEIS.AX).AddInfo(&quot;AXCompany&quot;,
                                                                                           Session[
                                                                                               Constants.
                                                                                                   EIS_ADDITIONAL_INFO].
                                                                                               ToString()));
                    var connectorParameters =
                        new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(),
                                                AMP3ObjectType.Unknown,
                                                new ConnectionFilter(null, null, null, null, null), null);
                    if (IntegrationConnectorManager.Instance.IsTriggerPointEnabled(connectorParameters))
                    {
                        // ToDO:
                        ddlVendorGroups.Visible = true;
                        lblVendorGroups.Visible = true;
                        DataSet dsVendorGroups = new BrixDataSet();
                        int vendorGroupCount = 0;
                        IntegrationConnectorManager.HandleIntegration(connectorParameters, ref vendorGroupCount,
                                                                      ref dsVendorGroups, true);
                        ddlVendorGroups.DataSource = dsVendorGroups.Tables.Count &gt; 1
                                                         ? dsVendorGroups.Tables[1]
                                                         : new BrixDataTable();
                        ddlVendorGroups.DataTextField = &quot;Name&quot;;
                        ddlVendorGroups.DataValueField = &quot;VendGroup&quot;;
                        ddlVendorGroups.DataBind();
                    }

                    #endregion Check If AX Vendor Group Filter is supported - AX 4.0
                }
                if (editMode)
                {
                    DefMode();
                }
                //trPCButtons.Visible = (ViewState[&quot;CONTMGTDTO&quot;] != null &amp;&amp; (ViewState[&quot;CONTMGTDTO&quot;] as DTO).Locked != &quot;Y&quot;);
                if (!string.IsNullOrEmpty(hdnSelectedPC.Value))
                    trPCButtons.Visible = BL.Instance.AllowPCUpdate(Convert.ToInt32(Request[&quot;ContractID&quot;]), Convert.ToInt32(hdnSelectedPC.Value));

                if (!HasLabourManagement)
                    trLabContr.Style.Add(&quot;display&quot;, &quot;none&quot;);
                else
                    lblIsLaborContractor.Text = &quot;Is &quot; + LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString() + &quot; Contractor&quot;;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.StackTrace, &quot;ContractContractors.aspx - Page_Load()&quot;);
            }

            lblSuccMsg.Text = string.Empty;
            PageTitle = &quot;Contractors&quot;;
        }

        private void BindData(DTO dto)
        {
            var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];

            DataTable dtLabourContractors = new BrixDataTable();
            if (HasLabourManagement)
            {
                dtLabourContractors = BL.Instance.GetLabourContractors(Request[&quot;ContractID&quot;].ToInt32_2());
            }
            if (!string.IsNullOrEmpty(dto.PC.CID))
            {
                hdnSelectedPC.Value = dto.PC.ID;

                if (HasLabourManagement &amp;&amp; dtLabourContractors.Rows.Count &gt; 0)
                {
                    if (dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + dto.PC.Company + &quot;&#39;&quot;).Length &gt; 0)
                    {
                        chkPCIsLC.Checked = true;
                        chkPCIsLC.Enabled =
                            !(dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + dto.PC.Company + &quot;&#39;&quot;))[0][&quot;HasLabour&quot;].
                                 Equals(1);
                    }
                }
                lblPCID.Text = dto.PC.Company;
                lblPCName.Text = dto.PC.Contact;
                lblAddress.Text = dto.PC.Address;
                lblcity.Text = dto.PC.City;
                lblstate.Text = dto.PC.State;
                lblzipcode.Text = dto.PC.ZipCode;
            }
            btnPCDelete.Visible = (!string.IsNullOrEmpty(hdnSelectedPC.Value)) &amp;&amp;
                                  (featurelist.Contains(CMConstans.MODFEAT_DELETE) ||
                                   featurelist.Contains(CMConstans.MODFEAT_EDIT));

            scGrid.Clear();

            AddColumnsToGrid(scGrid, 1);

            for (int i = 0; i &lt; dto.SC.Count; i++)
            {
                if (HasLabourManagement &amp;&amp; dtLabourContractors.Rows.Count &gt; 0)
                {
                    Boolean isChecked = false;
                    Boolean isLabour = false;
                    if (dtLabourContractors.Select(&quot;[Company]=&#39;&quot; + dto.SC[i].Company + &quot;&#39;&quot;).Length &gt; 0)
                    {
                        isChecked = true;
                        if (
                            (dtLabourContractors.Select(&quot;[Company]=&#39;&quot; + dto.SC[i].Company + &quot;&#39;&quot;))[0][&quot;HasLabour&quot;].Equals
                                (1))
                            isLabour = true;
                    }

                    scGrid.Rows.Add(
                        new UltraGridRow(
                            new object[]
                                {
                                    false, dto.SC[i].ID, dto.SC[i].Contact, dto.SC[i].CID, dto.SC[i].Company,
                                    dto.SC[i].Address, dto.SC[i].Address2, dto.SC[i].Address3, dto.SC[i].City,
                                    dto.SC[i].State, dto.SC[i].ZipCode, dto.SC[i].Phone, dto.SC[i].Fax, dto.SC[i].Email,
                                    isChecked
                                }));
                    scGrid.Rows[scGrid.Rows.Count - 1].Cells.FromKey(&quot;IsLabour&quot;).AllowEditing = isLabour
                                                                                                    ? AllowEditing.No
                                                                                                    : AllowEditing.Yes;
                }
                else
                {
                    scGrid.Rows.Add(
                        new UltraGridRow(
                            new object[]
                                {
                                    false, dto.SC[i].ID, dto.SC[i].Contact, dto.SC[i].CID, dto.SC[i].Company,
                                    dto.SC[i].Address, dto.SC[i].Address2, dto.SC[i].Address3, dto.SC[i].City,
                                    dto.SC[i].State, dto.SC[i].ZipCode, dto.SC[i].Phone, dto.SC[i].Fax, dto.SC[i].Email
                                }));
                }
            }
        }

        protected void btnSubmitMaster_Click(object sender, EventArgs e)
        {
            try
            {
                DTO dto;

                if ((dto = ViewState[viewState] as DTO) == null)
                    dto = new DTO();

                if (dto.IDs.Count == 0)
                {
                    dto.IDs.Add(Request[&quot;ContractID&quot;].ToInt32_2());
                }
                int LabContNum = 0;
                String contractorIDList = String.Empty;
                if (HasLabourManagement)
                {
                    if (chkPCIsLC.Checked)
                        contractorIDList = lblPCID.Text + &quot;,&quot;;
                    foreach (UltraGridRow ugr in scGrid.Rows)
                    {
                        if (ugr.Cells.FromKey(&quot;IsLabour&quot;).Value.ToBoolean2())
                            contractorIDList += ugr.Cells.FromKey(&quot;ID&quot;).Text + &quot;,&quot;;
                    }
                    if (contractorIDList.Length &gt; 0)
                    {
                        if (contractorIDList.Substring(contractorIDList.Length - 1) == &quot;,&quot;)
                            contractorIDList = contractorIDList.Substring(0, contractorIDList.Length - 1);

                        LabContNum = BL.Instance.CopyLabourListFromLibrary(contractorIDList,
                                                                           Request[&quot;ContractID&quot;].ToInt32_2());
                    }
                    else
                    {
                        LabContNum = BL.Instance.CopyLabourListFromLibrary(String.Empty,
                                                                           Request[&quot;ContractID&quot;].ToInt32_2());
                    }
                }

                //README: This adds the contractor to Brix
                BL.Instance.CUDContractContractors(dto);

                var ConBrixInfo = new List&lt;ConnectionBrixInfo&gt;();
                ConBrixInfo.Add(new ConnectionBrixInfo(AMP3Object.CONTMGT, Request[&quot;ContractId&quot;], AMP3Object.UNKNOWN,
                                                       null));
                ConBrixInfo.Add(new ConnectionBrixInfo(AMP3Object.CONTRACTOR, dto.PC.Company,
                                                       AMP3Object.CONTMGT, (Request[&quot;ContractId&quot;])));
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX,
                                       (new EISAdditionalInfo(RegisteredEIS.AX)).AddInfo(Constants.EIS_ADDITIONAL_INFO,
                                                                                         Session[
                                                                                             Constants.
                                                                                                 EIS_ADDITIONAL_INFO].
                                                                                             ToString()));
                var connectorParameters =
                    new ConnectorParameters(dictAdditionalInfo,
                                            MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                                            EISObjectType.Contractor, null, ConBrixInfo);
                IntegrationConnectorManager.HandleMap(connectorParameters);

                DefMode();

                ShowNotificationMessage(&quot;Saved Successfully. &quot; +
                                  (LabContNum.Equals(contractorIDList.Split(&#39;,&#39;).Length)
                                       ? String.Empty
                                       : ((LabContNum == 0)
                                              ? String.Empty
                                              : &quot;Some &quot; + LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString() + &quot; Contractors could not be edited&quot;)), NotificationType.Success);

                BindData(BL.Instance.GetContract(Request[&quot;ContractID&quot;].ToInt32_2(), FetchSet.Contractors));
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, &quot;CONTMGT&quot;, ex);
            }
        }

        private void DefMode()
        {
            try
            {
                var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];
                if (featurelist.Contains(CMConstans.MODFEAT_EDIT))
                {
                    SubmitMaster = MasterEdit = true;
                }

                SubmitMaster = btnPCPick.Enabled = btnSCPick.Enabled = btnPCDelete.Enabled = btnSCDelete.Enabled = false;
            }
            catch
            {
            }
        }

        protected void btnEditMaster_Click(object sender, EventArgs e)
        {
            try
            {
                MasterEdit = SubmitMaster = lblSuccMsg.Visible = false;

                var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];

                if (featurelist.Contains(CMConstans.MODFEAT_CREATE) || featurelist.Contains(CMConstans.MODFEAT_EDIT))
                {
                    SubmitMaster = btnSCPick.Enabled = true;
                    btnPCPick.Enabled = chkPCIsLC.Enabled;
                }
                if (featurelist.Contains(CMConstans.MODFEAT_DELETE) || featurelist.Contains(CMConstans.MODFEAT_EDIT))
                {
                    SubmitMaster = true;
                    btnPCDelete.Enabled = (!string.IsNullOrEmpty(hdnSelectedPC.Value)) &amp;&amp; chkPCIsLC.Enabled;
                    btnSCDelete.Enabled = (scGrid.Rows.Count != 0);
                }
            }
            catch
            {
            }
        }

        private void CheckLockStatus()
        {
            if ((ViewState[&quot;LockStatus&quot;] as DTO).Locked == &quot;Y&quot;)
            {
                throw new Exception(&quot;Items are locked. Request denied.&quot;);
            }
        }

        protected void btnBack_Click(object sender, EventArgs e)
        {
            Response.Redirect(&quot;~/Common/BrixListPage.aspx?context=CONTMGT&amp;PID=&quot; + Request[Constants.QRY_PROJECTID],
                              false);
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Response.Redirect(Request.RawUrl);
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    lnkSave.Click += btnSubmitMaster_Click;
                    lnkSave.OnClientClick = &quot;return ValidateData();&quot;;
                    MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;
                }
            }
            if (MainToolBar.GetMenuReference(&quot;lnkBack&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkBack&quot;).Click += btnBack_Click;
                MainToolBar.GetMenuReference(&quot;lnkBack&quot;).CausesValidation = false;
            }
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Click += btnEditMaster_Click;
            }
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (!SubmitMaster)
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.HideMenu(&quot;lnkSave&quot;);
                        MainToolBar.HideMenu(&quot;lnkCancel&quot;);
                    }
                }
            }
            else
            {
                if (HasSaveButton)
                {
                    Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                    if (null != lnkSave)
                    {
                        MainToolBar.ShowMenu(&quot;lnkSave&quot;);
                        MainToolBar.ShowMenu(&quot;lnkCancel&quot;);
                    }
                }
            }

            if (!MasterEdit &amp;&amp; MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
                MainToolBar.HideMenu(&quot;lnkEdit&quot;);
            else
                MainToolBar.ShowMenu(&quot;lnkEdit&quot;);

            base.OnPreRender(e);
        }

        protected void btnPCDelete_Click(object sender, EventArgs e)
        {
            //CheckLockStatus();

            BL.Instance.DeletePrimeContractor(Request[&quot;ContractID&quot;].ToInt32_2());

            Response.Redirect(
                &quot;ContractContractors.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + Request[Constants.QRY_PROJECTID] +
                &quot;&amp;ContractID=&quot; + Request[&quot;ContractID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ContractID&quot;], true);
        }

        protected void btnSCDelete_Click(object sender, EventArgs e)
        {
            try
            {
                var contList = new ListItemCollection();

                var dto = ViewState[viewState] as DTO;
                bool hasChecked = false;
                string cid;
                for (int i = 0; i &lt; scGrid.Rows.Count; i++)
                {
                    if (scGrid.Rows[i].Cells.FromKey(&quot;To&quot;).Value.ToBoolean2())
                    {
                        if (!hasChecked)
                            hasChecked = true;
                        cid = scGrid.Rows[i].Cells.FromKey(&quot;RecordID&quot;).Text;
                        if (checkIfLocked(cid.ToInt32_2()))
                            dto.SC.Remove(dto.SC.Find(sc =&gt; sc.ID == cid));
                        else
                            throw new Exception(&quot;Sub-contractor is associated with a Work Order and cannot be deleted.&quot;);
                    }
                }

                if (!hasChecked)
                    throw new Exception(&quot;Please select at least one sub-contractor to delete.&quot;);
                else
                {
                    scGrid.Clear();
                    for (int i = 0; i &lt; dto.SC.Count; i++)
                    {
                        DataTable dtLabourContractors = new BrixDataTable();
                        if (HasLabourManagement)
                        {
                            dtLabourContractors = BL.Instance.GetLabourContractors(Request[&quot;ContractID&quot;].ToInt32_2());
                        }
                        Boolean isChecked = false;
                        Boolean isLabour = false;
                        if (HasLabourManagement &amp;&amp; dtLabourContractors.Rows.Count &gt; 0)
                        {
                            if (dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + dto.SC[i].Company + &quot;&#39;&quot;).Length &gt; 0)
                            {
                                isChecked = true;
                                if (
                                    (dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + dto.SC[i].Company + &quot;&#39;&quot;))[0][
                                        &quot;HasLabour&quot;].Equals(1))
                                    isLabour = true;
                            }
                            scGrid.Rows.Add(
                                new UltraGridRow(
                                    new object[]
                                        {
                                            false, dto.SC[i].ID, dto.SC[i].Contact, dto.SC[i].CID, dto.SC[i].Company,
                                            dto.SC[i].Address, dto.SC[i].Address2, dto.SC[i].Address3, dto.SC[i].City,
                                            dto.SC[i].State, dto.SC[i].ZipCode, dto.SC[i].Phone, dto.SC[i].Fax,
                                            dto.SC[i].Email, isChecked
                                        }));
                            scGrid.Rows[scGrid.Rows.Count - 1].Cells.FromKey(&quot;IsLabour&quot;).AllowEditing = isLabour
                                                                                                            ? AllowEditing
                                                                                                                  .No
                                                                                                            : AllowEditing
                                                                                                                  .Yes;
                        }
                        else
                        {
                            scGrid.Rows.Add(
                                new UltraGridRow(
                                    new object[]
                                        {
                                            false, dto.SC[i].ID, dto.SC[i].Contact, dto.SC[i].CID, dto.SC[i].Company,
                                            dto.SC[i].Address, dto.SC[i].Address2, dto.SC[i].Address3, dto.SC[i].City,
                                            dto.SC[i].State, dto.SC[i].ZipCode, dto.SC[i].Phone, dto.SC[i].Fax,
                                            dto.SC[i].Email
                                        }));
                        }
                    }
                }

                ViewState[viewState] = dto;
                divSCGrid.Visible = scGrid.Visible = btnSCDelete.Visible = (scGrid.Rows.Count != 0);
                lblSuccMsg.Text = string.Empty;
            }
            catch (Exception ex)
            {
                JavaScriptSerializer JS = new JavaScriptSerializer();
                lblSuccMsg.Visible = true;
                lblSuccMsg.ForeColor = Color.Red;
                lblSuccMsg.Text = ex.Message;
                Page.ClientScript.RegisterStartupScript(typeof(Page), &quot;Locked&quot;, @&quot;ShowError(&quot; + JS.Serialize(ex.Message) + &quot;);&quot;, true);
            }
        }

        private bool checkIfLocked(int SelectedContractorID)
        {
            DataSet ds = WORKORDManager.Instance.GetWOList(Request[&quot;ContractID&quot;].ToInt32_2(), 1, 10,
                                                           &quot;WorkOrderDate desc&quot;, null);
            DataTable dt = ds.Tables[0];
            foreach (DataRow dr in dt.Rows)
            {
                if (!dr[&quot;ContractorID&quot;].Equals(DBNull.Value))
                    if (SelectedContractorID == dr[&quot;ContractorID&quot;].ToString().ToInt32_2())
                        return false;
            }
            return true;
        }

        private void AddColumnsToGrid(UltraWebGrid grid, int count)
        {
            try
            {
                if (grid.Columns.Count == count)
                {
                    var col = new UltraGridColumn();
                    col.Key = &quot;RecordID&quot;;
                    col.Header.Caption = &quot;RecordID&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;Name&quot;;
                    col.Header.Caption = &quot;Name&quot;;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;ID&quot;;
                    col.Header.Caption = &quot;ID&quot;;
                    grid.Columns.Add(col);
                    col.Hidden = true;

                    col = new UltraGridColumn();
                    col.Key = &quot;Company&quot;;
                    col.Header.Caption = &quot;Contractor ID&quot;;
                    //col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;Address1&quot;;
                    col.Header.Caption = &quot;Address1&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;Address2&quot;;
                    col.Header.Caption = &quot;Address2&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;Address3&quot;;
                    col.Header.Caption = &quot;Address3&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;City&quot;;
                    col.Header.Caption = &quot;City&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;State&quot;;
                    col.Header.Caption = &quot;State&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;ZipCode&quot;;
                    col.Header.Caption = &quot;Zip Code&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;PhoneNo&quot;;
                    col.Header.Caption = &quot;Phone No&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;FaxNo&quot;;
                    col.Header.Caption = &quot;Fax No&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    col = new UltraGridColumn();
                    col.Key = &quot;EmailID&quot;;
                    col.Header.Caption = &quot;Email ID&quot;;
                    col.Hidden = true;
                    grid.Columns.Add(col);

                    if (HasLabourManagement)
                    {
                        col = new UltraGridColumn();
                        col.Key = &quot;IsLabour&quot;;
                        col.Type = ColumnType.CheckBox;
                        col.AllowUpdate = AllowUpdate.Yes;
                        col.Header.Caption = &quot;Is &quot; + LocalizationManager.GetString(KeyConstants.LOC_ICA_MANPOWER).ToString() + &quot; Contractor&quot;;
                        grid.Columns.Add(col);
                    }
                }

                foreach (UltraGridColumn col in scGrid.Columns)
                {
                    col.HTMLEncodeContent = true;
                }
            }
            catch
            {
            }
        }

        #region Picker

        private void InitializePCPicker()
        {
            pickerPrime.InitializePicker(&quot;/api/Contractor&quot;, GetPickerColumns(), &quot;ID&quot;);
            pickerPrime.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            pickerPrime.PostBackAfterSelect = true;
            pickerPrime.BeforePickerLoadScript = &quot;FilterSelectedContractors(&#39;Prime&#39;)&quot;;
            pickerPrime.Title = &quot;Contractors List&quot;;
            pickerPrime.OnItemSelected += new PickerGrid.SelectedItems(pickerPrime_OnItemSelected);
        }

        private void InitializeSCPicker()
        {
            pickerSub.InitializePicker(&quot;/api/Contractor&quot;, GetPickerColumns(), &quot;ID&quot;);
            pickerSub.TriggerButton.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
            pickerSub.PostBackAfterSelect = true;
            pickerSub.EnableMultiSelect = true;
            pickerSub.BeforePickerLoadScript = &quot;FilterSelectedContractors(&#39;Sub&#39;)&quot;;
            pickerSub.Title = &quot;Contractors List&quot;;
            pickerSub.OnItemSelected += new PickerGrid.SelectedItems(pickerSub_OnItemSelected);
        }

        private void pickerPrime_OnItemSelected(PickerGrid grid, List&lt;Dictionary&lt;string, object&gt;&gt; selectedRows)
        {
            DTO dto;

            if ((dto = ViewState[viewState] as DTO) == null)
                dto = new DTO();

            lblPCID.Text = selectedRows[0][&quot;ID&quot;].ToString();
            lblPCName.Text = selectedRows[0][&quot;Name&quot;].ToString();
            lblAddress.Text = selectedRows[0][&quot;Address1&quot;].ToString();
            lblcity.Text = selectedRows[0][&quot;City&quot;].ToString();
            lblstate.Text = selectedRows[0][&quot;State&quot;].ToString();
            lblzipcode.Text = selectedRows[0][&quot;ZipCode&quot;].ToString();
            hdnSelectedPC.Value = selectedRows[0][&quot;ID&quot;].ToString();

            dto.PC.ID = selectedRows[0][&quot;ID&quot;].ToString();
            dto.PC.Contact = selectedRows[0][&quot;Name&quot;].ToString();
            dto.PC.CID = selectedRows[0][&quot;ID&quot;].ToString();
            dto.PC.Company = selectedRows[0][&quot;ID&quot;].ToString();
            dto.PC.Address = selectedRows[0][&quot;Address1&quot;].ToString();
            dto.PC.Address2 = selectedRows[0][&quot;Address2&quot;].ToString();
            dto.PC.Address3 = selectedRows[0][&quot;Address3&quot;].ToString();
            dto.PC.City = selectedRows[0][&quot;City&quot;].ToString();
            dto.PC.State = selectedRows[0][&quot;State&quot;].ToString();
            dto.PC.ZipCode = selectedRows[0][&quot;ZipCode&quot;].ToString();
            dto.PC.Phone = selectedRows[0][&quot;PhoneNo&quot;].ToString();
            dto.PC.Fax = selectedRows[0][&quot;FaxNo&quot;].ToString();
            dto.PC.Email = selectedRows[0][&quot;EmailID&quot;].ToString();

            ViewState[viewState] = dto;

            divSCGrid.Visible =
                scGrid.Visible = btnSCDelete.Visible = btnSCDelete.Enabled = (scGrid.Rows.Count != 0);
        }

        private void pickerSub_OnItemSelected(PickerGrid grid, List&lt;Dictionary&lt;string, object&gt;&gt; selectedRows)
        {
            DTO dto;

            if ((dto = ViewState[viewState] as DTO) == null)
                dto = new DTO();
            DataTable dtLabourContractors = new BrixDataTable();
            if (HasLabourManagement)
            {
                dtLabourContractors = BL.Instance.GetLabourContractors(Request[&quot;ContractID&quot;].ToInt32_2());
            }
            Boolean isChecked = false;
            Boolean isLabour = false;

            foreach (Dictionary&lt;string, object&gt; selectedRow in selectedRows)
            {
                if (HasLabourManagement &amp;&amp; dtLabourContractors.Rows.Count &gt; 0)
                {
                    if (dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + selectedRow[&quot;ID&quot;] + &quot;&#39;&quot;).Length &gt; 0)
                    {
                        isChecked = true;
                        if (
                            (dtLabourContractors.Select(&quot;[ContractorID]=&#39;&quot; + selectedRow[&quot;ID&quot;] + &quot;&#39;&quot;))[0][
                                &quot;HasLabour&quot;].Equals(1))
                            isLabour = true;
                    }
                    scGrid.Rows.Add(
                        new UltraGridRow(
                            new object[]
                                                    {
                                                        false, selectedRow[&quot;ID&quot;], selectedRow[&quot;Name&quot;], selectedRow[&quot;ID&quot;], selectedRow[&quot;ID&quot;], selectedRow[&quot;Address1&quot;],
                                        selectedRow[&quot;Address2&quot;],selectedRow[&quot;Address3&quot;], selectedRow[&quot;City&quot;], selectedRow[&quot;State&quot;], selectedRow[&quot;ZipCode&quot;],
                                        selectedRow[&quot;PhoneNo&quot;],selectedRow[&quot;FaxNo&quot;], selectedRow[&quot;EmailID&quot;], isChecked
                                                    }));
                    scGrid.Rows[scGrid.Rows.Count - 1].Cells.FromKey(&quot;IsLabour&quot;).AllowEditing = isLabour
                                                                                                    ? AllowEditing
                                                                                                          .No
                                                                                                    : AllowEditing
                                                                                                          .Yes;
                }
                else
                {
                    scGrid.Rows.Add(
                        new UltraGridRow(
                            new object[]
                                                    {
                                                        false, selectedRow[&quot;ID&quot;], selectedRow[&quot;Name&quot;], selectedRow[&quot;ID&quot;], selectedRow[&quot;ID&quot;], selectedRow[&quot;Address1&quot;],
                                        selectedRow[&quot;Address2&quot;],selectedRow[&quot;Address3&quot;], selectedRow[&quot;City&quot;], selectedRow[&quot;State&quot;], selectedRow[&quot;ZipCode&quot;],
                                        selectedRow[&quot;PhoneNo&quot;],selectedRow[&quot;FaxNo&quot;], selectedRow[&quot;EmailID&quot;]
                                                    }));
                }
            }

            dto.SC.Clear();
            foreach (UltraGridRow row in scGrid.Rows)
            {
                Contractors cont = new Contractors();

                if (row.Cells.FromKey(&quot;ID&quot;).Value != null)
                {
                    cont.ID = row.Cells.FromKey(&quot;ID&quot;).Value.ToString();
                    cont.CID = row.Cells.FromKey(&quot;ID&quot;).Value.ToString(); ;
                    cont.Company = row.Cells.FromKey(&quot;ID&quot;).Value.ToString();
                }
                if (row.Cells.FromKey(&quot;Name&quot;).Value != null)
                    cont.Contact = row.Cells.FromKey(&quot;Name&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;Address1&quot;).Value != null)
                    cont.Address = row.Cells.FromKey(&quot;Address1&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;Address2&quot;).Value != null)
                    cont.Address2 = row.Cells.FromKey(&quot;Address2&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;Address3&quot;).Value != null)
                    cont.Address3 = row.Cells.FromKey(&quot;Address3&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;City&quot;).Value != null)
                    cont.City = row.Cells.FromKey(&quot;City&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;State&quot;).Value != null)
                    cont.State = row.Cells.FromKey(&quot;State&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;ZipCode&quot;).Value != null)
                    cont.ZipCode = row.Cells.FromKey(&quot;ZipCode&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;PhoneNo&quot;).Value != null)
                    cont.Phone = row.Cells.FromKey(&quot;PhoneNo&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;FaxNo&quot;).Value != null)
                    cont.Fax = row.Cells.FromKey(&quot;FaxNo&quot;).Value.ToString();
                if (row.Cells.FromKey(&quot;EmailID&quot;).Value != null)
                    cont.Email = row.Cells.FromKey(&quot;EmailID&quot;).Value.ToString();

                dto.SC.Add(cont);
            }

            ViewState[viewState] = dto;

            divSCGrid.Visible =
                scGrid.Visible = btnSCDelete.Visible = btnSCDelete.Enabled = (scGrid.Rows.Count != 0);
        }

        #endregion Picker

        private bool GetPCRemovalStatus(int PCid)
        {
            return true;
        }

        public override int GetProjectIdFromInstanceId()
        {
            if (!string.IsNullOrEmpty(Request[&quot;ContractID&quot;]))
                return BL.Instance.GetPIDFromContractId(Request[&quot;ContractID&quot;].ToInt32_2());
            else
                return -1;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[47,9,47,41,1],[52,13,52,14,0],[53,17,53,45,0],[54,17,54,107,0],[55,17,55,18,0],[56,21,56,47,0],[57,21,57,22,0],[58,25,62,116,0],[63,21,63,22,0],[64,21,64,54,0],[65,25,65,88,0],[67,25,67,91,0],[68,17,68,18,0],[69,17,69,38,0],[70,13,70,14,0],[76,13,76,14,1],[77,17,77,62,1],[78,17,78,18,1],[79,21,81,120,1],[82,21,84,117,1],[85,17,85,18,1],[86,17,86,70,1],[87,13,87,14,1],[91,9,91,10,1],[92,13,92,89,1],[93,13,93,58,1],[94,13,94,14,1],[95,17,95,64,1],[96,13,96,14,1],[98,13,98,28,1],[100,13,100,34,1],[101,13,101,34,1],[103,13,103,41,1],[104,13,104,34,1],[105,13,105,76,1],[106,13,106,82,1],[107,13,107,82,1],[108,17,108,80,0],[109,13,109,44,1],[110,9,110,10,1],[113,9,113,10,1],[114,13,114,85,1],[116,13,117,79,1],[119,13,119,90,1],[120,13,120,54,1],[121,13,121,54,1],[122,13,122,44,1],[123,13,123,57,1],[124,13,124,20,1],[124,22,124,32,1],[124,33,124,35,1],[124,36,124,46,1],[125,13,125,14,1],[126,17,126,54,1],[127,17,127,18,1],[128,21,128,123,1],[129,21,129,43,1],[130,17,130,18,1],[132,17,132,18,1],[133,21,133,170,1],[134,21,134,43,1],[135,17,135,18,1],[136,13,136,14,1],[138,13,138,32,1],[139,9,139,10,1],[142,9,142,10,1],[144,13,144,14,1],[145,17,149,67,1],[150,17,150,39,1],[151,17,151,42,1],[153,17,153,112,1],[154,17,154,94,1],[156,17,157,65,1],[158,21,159,117,0],[161,17,161,49,1],[163,17,163,93,1],[164,17,164,66,1],[165,17,165,18,1],[166,21,166,67,1],[167,21,167,22,0],[168,25,171,90,0],[172,21,172,22,0],[173,17,173,18,1],[176,17,176,53,1],[178,17,178,108,1],[179,17,179,18,1],[180,21,180,81,1],[181,17,181,18,1],[182,17,182,108,1],[183,17,183,18,1],[184,21,184,41,1],[185,21,185,86,1],[186,21,186,68,1],[187,17,187,18,1],[190,17,190,18,1],[191,21,191,42,1],[192,21,192,114,1],[194,21,194,52,1],[195,25,196,128,0],[198,21,198,57,1],[199,17,199,18,1],[200,17,200,22,0],[201,17,201,18,0],[202,21,204,45,0],[205,17,205,18,0],[207,17,207,33,1],[208,17,208,18,1],[209,21,209,36,1],[211,21,211,22,1],[212,25,212,112,1],[214,25,214,50,1],[215,29,216,132,0],[218,25,218,52,1],[219,21,219,22,1],[220,21,220,26,0],[221,21,221,22,0],[222,25,224,49,0],[225,21,225,22,0],[227,21,227,35,1],[228,21,228,42,1],[229,21,229,22,0],[230,25,230,41,0],[231,21,231,22,0],[232,21,232,83,1],[233,21,235,91,1],[239,21,239,97,1],[240,21,245,109,1],[246,21,249,107,1],[250,21,250,105,1],[251,21,251,22,0],[253,25,253,56,0],[254,25,254,56,0],[255,25,255,68,0],[256,25,256,50,0],[257,25,258,97,0],[259,25,261,80,0],[262,25,262,64,0],[263,25,263,70,0],[264,25,264,52,0],[265,21,265,22,0],[268,17,268,18,1],[269,17,269,30,1],[270,17,270,18,0],[271,21,271,31,0],[272,17,272,18,0],[274,17,274,64,1],[275,21,275,147,1],[277,17,277,42,1],[278,21,278,61,1],[280,21,280,145,0],[281,13,281,14,1],[282,13,282,33,0],[283,13,283,14,0],[284,17,284,113,0],[285,13,285,14,0],[287,13,287,44,1],[288,13,288,39,1],[289,9,289,10,1],[292,9,292,10,1],[293,13,293,89,1],[295,13,295,65,1],[296,13,296,37,1],[297,13,297,14,0],[298,17,298,107,0],[299,13,299,14,0],[300,13,300,51,1],[301,13,301,14,1],[302,17,302,49,1],[304,17,304,79,1],[305,17,305,18,0],[306,21,306,106,0],[307,21,307,22,0],[308,25,308,50,0],[309,25,311,44,0],[312,21,312,22,0],[313,17,313,18,0],[314,17,314,47,1],[315,17,315,49,1],[316,17,316,50,1],[317,17,317,44,1],[318,17,318,46,1],[319,17,319,50,1],[320,13,320,14,1],[321,13,323,83,1],[325,13,325,28,1],[327,13,327,41,1],[329,18,329,27,1],[329,29,329,45,1],[329,47,329,50,1],[330,13,330,14,1],[331,17,331,79,1],[332,17,332,18,0],[333,21,333,47,0],[334,21,334,46,0],[335,21,335,104,0],[336,21,336,22,0],[337,25,337,42,0],[338,25,340,37,0],[341,29,341,45,0],[342,21,342,22,0],[344,21,352,37,0],[353,21,355,120,0],[356,17,356,18,0],[358,17,358,18,1],[359,21,366,37,1],[367,17,367,18,1],[368,13,368,14,1],[369,9,369,10,1],[372,9,372,10,0],[374,13,374,14,0],[377,17,377,65,0],[378,21,378,37,0],[380,17,380,40,0],[381,17,381,18,0],[382,21,382,68,0],[383,17,383,18,0],[384,17,384,36,0],[385,17,385,56,0],[386,17,386,41,0],[387,17,387,18,0],[388,21,388,43,0],[389,25,389,63,0],[390,21,390,28,0],[390,30,390,46,0],[390,47,390,49,0],[390,50,390,61,0],[391,21,391,22,0],[392,25,392,78,0],[393,29,393,84,0],[394,21,394,22,0],[395,21,395,53,0],[396,21,396,22,0],[397,25,397,92,0],[398,29,398,107,0],[400,25,401,111,0],[402,21,402,22,0],[404,21,404,22,0],[405,25,406,111,0],[407,21,407,22,0],[408,17,408,18,0],[411,17,411,57,0],[413,17,413,66,0],[414,17,415,63,0],[416,17,417,102,0],[418,17,418,93,0],[419,17,424,107,0],[425,17,428,90,0],[429,17,429,76,0],[431,17,431,27,0],[433,17,438,197,0],[440,17,440,108,0],[441,13,441,14,0],[442,13,442,33,0],[443,13,443,14,0],[444,17,444,83,0],[445,13,445,14,0],[446,9,446,10,0],[449,9,449,10,1],[451,13,451,14,1],[452,17,452,93,1],[453,17,453,67,1],[454,17,454,18,1],[455,21,455,54,1],[456,17,456,18,1],[458,17,458,122,1],[459,13,459,14,1],[460,13,460,18,0],[461,13,461,14,0],[462,13,462,14,0],[463,9,463,10,1],[466,9,466,10,1],[468,13,468,14,1],[469,17,469,72,1],[471,17,471,93,1],[473,17,473,118,1],[474,17,474,18,1],[475,21,475,61,1],[476,21,476,59,1],[477,17,477,18,1],[478,17,478,118,1],[479,17,479,18,1],[480,21,480,41,1],[481,21,481,109,1],[482,21,482,68,1],[483,17,483,18,1],[484,13,484,14,1],[485,13,485,18,0],[486,13,486,14,0],[487,13,487,14,0],[488,9,488,10,1],[491,9,491,10,0],[492,13,492,64,0],[493,13,493,14,0],[494,17,494,74,0],[496,9,496,10,0],[499,9,499,10,0],[500,13,501,38,0],[502,9,502,10,0],[505,9,505,10,0],[506,13,506,47,0],[507,9,507,10,0],[510,9,510,10,1],[511,13,511,31,1],[512,13,512,14,1],[513,17,513,78,1],[514,17,514,37,1],[515,17,515,18,1],[516,21,516,60,1],[517,21,517,70,1],[518,21,518,88,1],[519,17,519,18,1],[520,13,520,14,1],[521,13,521,65,1],[522,13,522,14,0],[523,17,523,80,0],[524,17,524,82,0],[525,13,525,14,0],[526,13,526,65,1],[527,13,527,14,1],[528,17,528,86,1],[529,13,529,14,1],[530,9,530,10,1],[533,9,533,10,1],[534,13,534,31,1],[535,13,535,14,1],[536,17,536,35,1],[537,17,537,18,1],[538,21,538,82,1],[539,21,539,41,1],[540,21,540,22,1],[541,25,541,57,1],[542,25,542,59,1],[543,21,543,22,1],[544,17,544,18,1],[545,13,545,14,1],[547,13,547,14,1],[548,17,548,35,1],[549,17,549,18,1],[550,21,550,82,1],[551,21,551,41,1],[552,21,552,22,1],[553,25,553,57,1],[554,25,554,59,1],[555,21,555,22,1],[556,17,556,18,1],[557,13,557,14,1],[559,13,559,80,1],[560,17,560,49,1],[562,17,562,49,1],[564,13,564,33,1],[565,9,565,10,1],[568,9,568,10,1],[571,13,571,82,1],[573,13,575,102,1],[576,9,576,10,0],[579,9,579,10,0],[581,13,581,14,0],[582,17,582,57,0],[584,17,584,55,0],[585,17,585,41,0],[587,22,587,31,0],[587,33,587,54,0],[587,56,587,59,0],[588,17,588,18,0],[589,21,589,79,0],[590,21,590,22,0],[591,25,591,41,0],[592,29,592,47,0],[593,25,593,77,0],[594,25,594,60,0],[595,29,595,61,0],[595,61,595,73,0],[595,73,595,76,0],[595,29,595,76,0],[597,29,597,122,0],[598,21,598,22,0],[599,17,599,18,0],[601,17,601,33,0],[602,21,602,97,0],[604,17,604,18,0],[605,21,605,36,0],[606,26,606,35,0],[606,37,606,53,0],[606,55,606,58,0],[607,21,607,22,0],[608,25,608,77,0],[609,25,609,49,0],[610,25,610,26,0],[611,29,611,119,0],[612,25,612,26,0],[613,25,613,51,0],[614,25,614,50,0],[615,25,615,87,0],[616,25,616,26,0],[617,29,617,117,0],[618,29,618,30,0],[619,33,619,50,0],[620,33,622,64,0],[623,37,623,53,0],[624,29,624,30,0],[625,29,633,45,0],[634,29,638,120,0],[639,25,639,26,0],[641,25,641,26,0],[642,29,650,45,0],[651,25,651,26,0],[652,21,652,22,0],[653,17,653,18,0],[655,17,655,44,0],[656,17,656,101,0],[657,17,657,48,0],[658,13,658,14,0],[659,13,659,33,0],[660,13,660,14,0],[661,17,661,70,0],[662,17,662,43,0],[663,17,663,50,0],[664,17,664,46,0],[665,17,665,136,0],[666,13,666,14,0],[667,9,667,10,0],[670,9,670,10,0],[671,13,672,88,0],[673,13,673,41,0],[674,13,674,20,0],[674,22,674,32,0],[674,33,674,35,0],[674,36,674,43,0],[675,13,675,14,0],[676,17,676,62,0],[677,21,677,91,0],[678,25,678,38,0],[679,13,679,14,0],[680,13,680,25,0],[681,9,681,10,0],[684,9,684,10,1],[686,13,686,14,1],[687,17,687,49,1],[688,17,688,18,1],[689,21,689,53,1],[690,21,690,42,1],[691,21,691,53,1],[692,21,692,39,1],[693,21,693,43,1],[695,21,695,49,1],[696,21,696,38,1],[697,21,697,49,1],[698,21,698,43,1],[700,21,700,49,1],[701,21,701,36,1],[702,21,702,47,1],[703,21,703,43,1],[704,21,704,39,1],[706,21,706,49,1],[707,21,707,41,1],[708,21,708,58,1],[710,21,710,43,1],[712,21,712,49,1],[713,21,713,42,1],[714,21,714,53,1],[715,21,715,39,1],[716,21,716,43,1],[718,21,718,49,1],[719,21,719,42,1],[720,21,720,53,1],[721,21,721,39,1],[722,21,722,43,1],[724,21,724,49,1],[725,21,725,42,1],[726,21,726,53,1],[727,21,727,39,1],[728,21,728,43,1],[730,21,730,49,1],[731,21,731,38,1],[732,21,732,49,1],[733,21,733,39,1],[734,21,734,43,1],[736,21,736,49,1],[737,21,737,39,1],[738,21,738,50,1],[739,21,739,39,1],[740,21,740,43,1],[742,21,742,49,1],[743,21,743,41,1],[744,21,744,53,1],[745,21,745,39,1],[746,21,746,43,1],[748,21,748,49,1],[749,21,749,41,1],[750,21,750,53,1],[751,21,751,39,1],[752,21,752,43,1],[754,21,754,49,1],[755,21,755,39,1],[756,21,756,51,1],[757,21,757,39,1],[758,21,758,43,1],[760,21,760,49,1],[761,21,761,41,1],[762,21,762,53,1],[763,21,763,39,1],[764,21,764,43,1],[766,21,766,45,1],[767,21,767,22,0],[768,25,768,53,0],[769,25,769,46,0],[770,25,770,56,0],[771,25,771,59,0],[772,25,772,142,0],[773,25,773,47,0],[774,21,774,22,0],[775,17,775,18,1],[777,17,777,24,1],[777,26,777,45,1],[777,46,777,48,1],[777,49,777,63,1],[778,17,778,18,1],[779,21,779,50,1],[780,17,780,18,1],[781,13,781,14,1],[782,13,782,18,0],[783,13,783,14,0],[784,13,784,14,0],[785,9,785,10,1],[790,9,790,10,1],[791,13,791,87,1],[792,13,792,86,1],[793,13,793,52,1],[794,13,794,87,1],[795,13,795,52,1],[796,13,796,100,1],[797,9,797,10,1],[800,9,800,10,1],[801,13,801,85,1],[802,13,802,84,1],[803,13,803,50,1],[804,13,804,48,1],[805,13,805,83,1],[806,13,806,50,1],[807,13,807,96,1],[808,9,808,10,1],[811,9,811,10,1],[814,13,814,61,1],[815,17,815,33,0],[817,13,817,61,1],[818,13,818,65,1],[819,13,819,70,1],[820,13,820,63,1],[821,13,821,65,1],[822,13,822,69,1],[823,13,823,68,1],[825,13,825,58,1],[826,13,826,65,1],[827,13,827,59,1],[828,13,828,63,1],[829,13,829,69,1],[830,13,830,70,1],[831,13,831,70,1],[832,13,832,62,1],[833,13,833,64,1],[834,13,834,68,1],[835,13,835,66,1],[836,13,836,62,1],[837,13,837,66,1],[839,13,839,40,1],[841,13,842,103,1],[843,9,843,10,1],[846,9,846,10,1],[849,13,849,61,1],[850,17,850,33,0],[851,13,851,65,1],[852,13,852,37,1],[853,13,853,14,0],[854,17,854,107,0],[855,13,855,14,0],[856,13,856,39,1],[857,13,857,38,1],[859,13,859,20,1],[859,22,859,60,1],[859,61,859,63,1],[859,64,859,76,1],[860,13,860,14,1],[861,17,861,79,1],[862,17,862,18,0],[863,21,863,109,0],[864,21,864,22,0],[865,25,865,42,0],[866,25,868,56,0],[869,29,869,45,0],[870,21,870,22,0],[871,21,878,57,0],[879,21,883,112,0],[884,17,884,18,0],[886,17,886,18,1],[887,21,894,57,1],[895,17,895,18,1],[896,13,896,14,1],[898,13,898,28,1],[899,13,899,20,1],[899,22,899,38,1],[899,39,899,41,1],[899,42,899,53,1],[900,13,900,14,1],[901,17,901,54,1],[903,17,903,59,1],[904,17,904,18,1],[905,21,905,72,1],[906,21,906,73,1],[906,74,906,75,1],[907,21,907,77,1],[908,17,908,18,1],[909,17,909,61,1],[910,21,910,79,1],[911,17,911,65,1],[912,21,912,83,1],[913,17,913,65,1],[914,21,914,84,1],[915,17,915,65,1],[916,21,916,84,1],[917,17,917,61,1],[918,21,918,76,1],[919,17,919,62,1],[920,21,920,78,1],[921,17,921,64,1],[922,21,922,82,1],[923,17,923,64,1],[924,21,924,80,1],[925,17,925,62,1],[926,21,926,76,1],[927,17,927,64,1],[928,21,928,80,1],[930,17,930,34,1],[931,13,931,14,1],[933,13,933,40,1],[935,13,936,103,1],[937,9,937,10,1],[942,9,942,10,0],[943,13,943,25,0],[944,9,944,10,0],[947,9,947,10,1],[948,13,948,62,1],[949,17,949,92,1],[951,17,951,27,0],[952,9,952,10,1]]);
    </script>
  </body>
</html>