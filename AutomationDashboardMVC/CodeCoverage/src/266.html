<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Quantity Planning\LDPDetail.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.LibraryBL;
using Aurigo.Brix.Construction.ContractManager.QuantityPlanningUI.BL;
using Aurigo.Brix.Construction.ContractManager.QuantityPlanningUI.DTO;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebDataInput;
using System.Collections.Generic;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.Brix.Construction.ContractManager.QuantityPlanningUI
{
    public partial class LDPDetail : BrixPageBase
    {
        protected ModalPopupExtender PopupExtender;
        private string ResItemIdColumn = string.Empty;
        private GenericPickerControl resourcePicker;

        private bool IsERPConnected
        {
            get { return IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX); }
        }

        private int InstanceId { get; set; }

        private int ContractId { get; set; }

        private int QPID { get; set; }

        private int BucketCount { get; set; }

        private int StartNo
        {
            get { return Convert.ToInt32(Session[&quot;LDPStartNo&quot;]); }
            set { Session[&quot;LDPStartNo&quot;] = value; }
        }

        private int EndNo
        {
            get { return Convert.ToInt32(Session[&quot;LDPEndNo&quot;]); }
            set { Session[&quot;LDPEndNo&quot;] = value; }
        }

        private int CurrentLowerLimit
        {
            get { return Convert.ToInt32(Session[&quot;LDPCurrentLowerLimit&quot;]); }
            set { Session[&quot;LDPCurrentLowerLimit&quot;] = value; }
        }

        private int CurrentUpperLimit
        {
            get { return Convert.ToInt32(Session[&quot;LDPCurrentUpperLimit&quot;]); }
            set { Session[&quot;LDPCurrentUpperLimit&quot;] = value; }
        }

        private DataSet ScheduleData
        {
            get { return (DataSet)Session[&quot;LDPScheduleData&quot;]; }
            set { Session[&quot;LDPScheduleData&quot;] = value; }
        }

        private DataTable CurrentSource
        {
            get { return (DataTable)Session[&quot;LDPCurrentSource&quot;]; }
            set { Session[&quot;LDPCurrentSource&quot;] = value; }
        }

        private int tempDetailId
        {
            get { return Convert.ToInt32(Session[&quot;LDPtempDetailId&quot;]); }
            set { Session[&quot;LDPtempDetailId&quot;] = value; }
        }

        private string deletedResourceIDs
        {
            get { return Convert.ToString(Session[&quot;LDPdeletedResourceIDs&quot;]); }
            set { Session[&quot;LDPdeletedResourceIDs&quot;] = value; }
        }

        private int ResourceSource
        {
            get { return Convert.ToInt32(Session[&quot;LDPResourceSource&quot;]); }
            set { Session[&quot;LDPResourceSource&quot;] = value; }
        }

        //0 - Rate Analysis &amp; 1 - Library

        /// &lt;summary&gt;
        /// Gets the Project Mode : I-Integration, L-Live
        /// &lt;/summary&gt;
        private string ProjectMode
        {
            get { return (CacheManager.Instance.IsIntegrated(Request[Constants.QRY_PROJECTID].ToInt32_2()) ? &quot;I&quot; : &quot;L&quot;); }
        }

        protected override void OnPreInit(EventArgs e)
        {
            ModuleId = &quot;QTYPLAN&quot;;
            base.OnPreInit(e);
        }

        protected override void OnInit(EventArgs e)
        {
            ResItemIdColumn = (IsERPConnected ? &quot;ParentResItemID&quot; : &quot;ResItemID&quot;);
            resourcePicker = (ucResourcePicker as GenericPickerControl);
            ConfigureResourcePicker();
            QPID = Request[&quot;QPID&quot;].ToInt32_2();
            InstanceId = string.IsNullOrEmpty(Request[&quot;InstanceId&quot;]) ? 0 : Request[&quot;InstanceId&quot;].ToInt32_2();
            ContractId = Request[&quot;ParentID&quot;].ToInt32_2();
            DPMaster dto = QuantityPlanningManager.Instance.GetDeploymentDetails(InstanceId, &quot;QTYPLDP&quot;);
            ViewState[&quot;Status&quot;] = dto.Status;
            base.OnInit(e);
        }

        protected override void CreateChildControls()
        {
            EnsureChildControls();
            CreateControlCollection();

            //var menus = new MenuArray();
            //if (!(Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) &amp;&amp;
            //    Convert.ToInt32(ViewState[&quot;Status&quot;].ToString2()) &lt;= 2)
            //{
            //    menus.Add(new BrixMenu(&quot;lnkSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;, 55));
            //    menus.Add(new BrixMenu(&quot;lnkDelete&quot;, &quot;Delete&quot;, &quot;Icn_Delete.png&quot;, 55));

            //    var addResource = new BrixMenu(&quot;lnkAddResource&quot;, &quot;Add Labour&quot;, &quot;Icn_Add.png&quot;, 55, 200);
            //    addResource.subMenus.Add(new BrixMenu(&quot;lnkFromRateAnalysis&quot;, &quot;Add From Rate Analysis&quot;, &quot;IcnAdd.gif&quot;));
            //    addResource.subMenus.Add(new BrixMenu(&quot;lnkFromLibrary&quot;, &quot;Add From Library&quot;, &quot;IcnAdd.gif&quot;));
            //    menus.Add(addResource);
            //}
            //menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Back&quot;, &quot;Icn_back.png&quot;, 55));
            //menus.Add(new BrixMenu(&quot;lnkPrevious&quot;, &quot;Previous Period&quot;, &quot;previous.png&quot;, 55));
            //menus.Add(new BrixMenu(&quot;lnkNext&quot;, &quot;Next Period&quot;, &quot;next.png&quot;, 55));
            //menus.Add(new BrixMenu(&quot;lnkFilter&quot;, &quot;Filter&quot;, &quot;IcnFilterApply.png&quot;, 70));
            //menus.Add(new BrixMenu(&quot;lnkFilterClr&quot;, &quot;Remove Filter&quot;, &quot;IcnFilterRem.png&quot;, 70));
            //CreateToolBarMenu(menus, null);

            List&lt;MenuGroup&gt; menuGroups = new List&lt;MenuGroup&gt;();
            MenuGroup generalGroup = new MenuGroup(&quot;General&quot;);
            if (!(Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) &amp;&amp;
                Convert.ToInt32(ViewState[&quot;Status&quot;].ToString2()) &lt;= 2)
            {
                if (AllowSave)
                generalGroup.AddMenu(new LargeButton(&quot;lnkSave&quot;, &quot;Save&quot;, &quot;Icn_Save.png&quot;));
                generalGroup.AddMenu(new TextIcon(&quot;lnkDelete&quot;, &quot;Delete&quot;, &quot;Icn_Delete_16.png&quot;));

                var addResource = new LargeButton(&quot;lnkAddResource&quot;, &quot;Labour&quot;, &quot;Icn_AddMore.png&quot;);
                addResource.AddSubMenu(new TextIcon(&quot;lnkFromRateAnalysis&quot;, &quot;Add From Rate Analysis&quot;, &quot;Icn_Rateanalysis_16.png&quot;));
                addResource.AddSubMenu(new TextIcon(&quot;lnkFromLibrary&quot;, &quot;Add From Library&quot;, &quot;Icn_Lib_16.png&quot;));
                generalGroup.AddMenu(addResource);
            }
            generalGroup.AddMenu(new TextIcon(&quot;lnkCancel&quot;, &quot;Back&quot;, &quot;Icn_Back_16.png&quot;));
            generalGroup.AddMenu(new TextIcon(&quot;lnkPrevious&quot;, &quot;Previous Period&quot;, &quot;Icn_Previous_16.png&quot;));
            generalGroup.AddMenu(new TextIcon(&quot;lnkNext&quot;, &quot;Next Period&quot;, &quot;Icn_Next_16.png&quot;));
            LargeButton btnFilter = new LargeButton(&quot;lnkFilter&quot;, &quot;Filter&quot;, &quot;Icn_Filter.png&quot;);
            btnFilter.AddSubMenu(new TextIcon(&quot;lnkFilterClr&quot;, &quot;Remove Filter&quot;, &quot;Icn_Filterremove_16.png&quot;));
            generalGroup.AddMenu(btnFilter);
            menuGroups.Add(generalGroup);
            CreateToolBarMenu(menuGroups, null);

            InitFilter();
            SetPopUpDetails();
            ClientScript.RegisterStartupScript(aspPnlFilter.GetType(), &quot;showHideFilterButtons&quot;,
                                               &quot;showHideFilterButtons(&#39;&quot; +
                                               MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).ClientID + &quot;&#39;, &#39;&quot; +
                                               MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;).ClientID + &quot;&#39;);&quot;, true);

            if (!IsPostBack)
                FormatNavigatorButtons();
        }

        private void SetPopUpDetails()
        {
            //PopupExtender = (ModalPopupExtender)this.Master.FindControl(&quot;filterExtender&quot;);
            PopupExtender.Visible = true;
            //PopupExtender.AddNewPopup(aspPnl.ClientID, btnHelper.ClientID, btnActCancel);

            if (MainToolBar.GetMenuReference(&quot;lnkFilter&quot;) != null &amp;&amp;
                MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;) != null)
            {
                //MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;).Style.Add(&quot;display&quot;, &quot;block&quot;);
                PopupExtender.AddNewPopup(aspPnlFilter.ClientID,
                                          ((Request[&quot;Mode&quot;] == &quot;View&quot;)
                                               ? MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).ClientID
                                               : btnGhostCheck.ClientID), btnCancel.ClientID, 300, 550);
                btnFilter.OnClientClick = &quot;document.getElementById(&#39;&quot; + btnCancel.ClientID + &quot;&#39;).click();applyFilter(&#39;&quot; +
                                          btnFilterGhost.ClientID + &quot;&#39;, &#39;&quot; +
                                          MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).ClientID + &quot;&#39;, &#39;&quot; +
                                          MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;).ClientID + &quot;&#39;);return false;&quot;;
                btnReset.Attributes.Add(&quot;onClick&quot;,
                                        &quot;document.getElementById(&#39;&quot; + btnCancel.ClientID +
                                        &quot;&#39;).click();return resetFilters(&#39;&quot; + btnFilterGhost.ClientID + &quot;&#39;, &#39;&quot; +
                                        MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).ClientID + &quot;&#39;, &#39;&quot; +
                                        MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;).ClientID + &quot;&#39;);&quot;);
                MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;).OnClientClick = &quot;return resetFilters(&#39;&quot; +
                                                                             btnFilterGhost.ClientID + &quot;&#39;, &#39;&quot; +
                                                                             MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).
                                                                                 ClientID + &quot;&#39;, &#39;&quot; +
                                                                             MainToolBar.GetMenuReference(&quot;lnkFilterClr&quot;)
                                                                                 .ClientID + &quot;&#39;);&quot;;
            }
            // PopupExtender.Title = ((Request[hdnPickerClicked.ClientID] ?? &quot;R&quot;).Equals(&quot;P&quot;)) ? &quot;Filter&quot; : &quot;Activities&quot;;
        }


        private void InitFilter()
        {
            ClientScript.RegisterArrayDeclaration(&quot;FilterFields&quot;,
                                                  ModelHelper.GetFilterHtml(tblFilter, GetApplyFilterLabels()));
        }

        public BrixFilter[] GetApplyFilterLabels()
        {
            var filters = new BrixFilter[2];
            filters[0] = new BrixFilter();
            filters[0].Name = &quot;ResItemID&quot;;
            filters[0].Title = &quot;ResourceID&quot;;
            filters[0].FilterType = BrixFilter.Type.Text;

            filters[1] = new BrixFilter();
            filters[1].Title = filters[1].Name = &quot;Description&quot;;
            filters[1].FilterType = BrixFilter.Type.Text;

            return filters;
        }

        protected void btnFilterGhost_Click(object sender, EventArgs e)
        {
            string filter = ModelHelper.GetFilterXML(tblFilter.UniqueID.Remove(tblFilter.UniqueID.Length - 9), Request,
                                                     GetApplyFilterLabels());
            //LoadSubContractingData();
            FetchAndBindData(filter);
            FormatNavigatorButtons();
        }

        private void FormatNavigatorButtons()
        {
            if (CurrentLowerLimit + BucketCount &gt; EndNo)
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            else if (CurrentLowerLimit == StartNo &amp;&amp; (BucketCount &gt; 0 &amp;&amp; EndNo &gt; (CurrentLowerLimit + BucketCount)))
                MainToolBar.ShowMenu(&quot;lnkNext&quot;);

            if (CurrentUpperLimit - BucketCount &lt; StartNo)
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
        }

        protected override void CustomizeToolBar()
        {
            if (!(Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;)) &amp;&amp;
                Convert.ToInt32(ViewState[&quot;Status&quot;].ToString2()) &lt;= 2)
            {
                if (MainToolBar.GetMenuReference(&quot;lnkSave&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkSave&quot;).Click += btnSave_Click;             
                if (MainToolBar.GetMenuReference(&quot;lnkDelete&quot;) != null)
                {
                    MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).Click += btnDeleteResource_Click;
                    MainToolBar.GetMenuReference(&quot;lnkDelete&quot;).OnClientClick += &quot;return ValidateDelete();&quot;;
                }
                MainToolBar.GetMenuReference(&quot;lnkFilter&quot;).OnClientClick = &quot;return CheckSave();&quot;;

                if (MainToolBar.GetMenuReference(&quot;lnkFromRateAnalysis&quot;) != null)
                    MainToolBar.GetMenuReference(&quot;lnkFromRateAnalysis&quot;).Click += lnkFromRateAnalysis_Click;
                if (MainToolBar.GetMenuReference(&quot;lnkFromLibrary&quot;) != null)
                    MainToolBar.GetMenuReference(&quot;lnkFromLibrary&quot;).Click += lnkFromLibrary_Click;
            }

            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;
            MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;

            MainToolBar.GetMenuReference(&quot;lnkNext&quot;).Click += btnFwdGhost_Click;
            MainToolBar.GetMenuReference(&quot;lnkNext&quot;).OnClientClick = &quot;return SaveAndProceed(&#39;1&#39;);&quot;;

            MainToolBar.GetMenuReference(&quot;lnkPrevious&quot;).Click += btnBwdGhost_Click;
            MainToolBar.GetMenuReference(&quot;lnkPrevious&quot;).OnClientClick = &quot;return SaveAndProceed(&#39;2&#39;);&quot;;
        }

        private void lnkFromRateAnalysis_Click(object sender, EventArgs e)
        {
            AddResource(0);
        }

        private void lnkFromLibrary_Click(object sender, EventArgs e)
        {
            AddResource(1);
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            //TODO: Obtain bucket count from the user
            BucketCount = 5;

            if (!IsPostBack)
            {
                ResourceSource = 0; //RA
                FetchAndBindData(string.Empty);
            }
            else
                FormatNavigatorButtons();
        }

        private void FetchAndBindData(string filter)
        {
            ScheduleData = QuantityPlanningManager.Instance.GetDPScheduleData(InstanceId, QPID, ContractId, filter);
            AppendScheduleInfo();
            FormCurrentSource(ScheduleData.Tables[0]);
            int rowCount = ScheduleData.Tables[1].Rows.Count;
            StartNo = CurrentLowerLimit = ScheduleData.Tables[1].Rows[0][&quot;Number&quot;].ToInt32_2();
            EndNo = ScheduleData.Tables[1].Rows[rowCount - 1][&quot;Number&quot;].ToInt32_2();
            if (CurrentLowerLimit + BucketCount &gt; EndNo)
            {
                CurrentUpperLimit = EndNo;
            }
            else CurrentUpperLimit = CurrentLowerLimit + (BucketCount - 1);
            LoadLDPData(true);
            tempDetailId = -1;
            deletedResourceIDs = &quot;&quot;;
        }

        private void AppendScheduleInfo()
        {
            DataTable scheduleInfo = ScheduleData.Tables[2];
            int tempScheduleID;
            foreach (DataColumn scheduleID in scheduleInfo.Columns)
                if (Int32.TryParse(scheduleID.ColumnName, out tempScheduleID))
                    ScheduleData.Tables[0].Columns.Add(tempScheduleID.ToString2());
            int resourceDetailId;
            foreach (DataRow resourceInfo in ScheduleData.Tables[0].Select())
            {
                resourceDetailId = resourceInfo[&quot;LDPDetailID&quot;].ToInt32_2();
                DataRow[] resourceScheduleInfo = scheduleInfo.Select(&quot;SchItemID = &#39;&quot; + resourceDetailId + &quot;&#39;&quot;);
                if (resourceScheduleInfo.Length &gt; 0)
                {
                    foreach (DataColumn scheduleID in scheduleInfo.Columns)
                    {
                        if (Int32.TryParse(scheduleID.ColumnName, out tempScheduleID))
                        {
                            resourceInfo[tempScheduleID.ToString2()] =
                                resourceScheduleInfo[0][tempScheduleID.ToString2()];
                        }
                    }
                }
            }
        }

        protected void btnFwdGhost_Click(object sender, EventArgs e)
        {
            SaveEditedItems();
            CurrentLowerLimit += BucketCount;
            if (CurrentUpperLimit + BucketCount &gt; EndNo) CurrentUpperLimit = EndNo;
            else CurrentUpperLimit += BucketCount;
            if (CurrentLowerLimit &gt; StartNo)
            {
                HideMenu(&quot;lnkPrevious&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
            }
            if (CurrentUpperLimit &lt; EndNo)
            {
                HideMenu(&quot;lnkNext&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            }

            LoadLDPData(false);
        }

        protected void btnBwdGhost_Click(object sender, EventArgs e)
        {
            SaveEditedItems();
            CurrentUpperLimit = CurrentLowerLimit - 1;
            CurrentLowerLimit -= BucketCount;
            if (CurrentLowerLimit &gt; StartNo)
            {
                HideMenu(&quot;lnkPrevious&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkPrevious&quot;);
            }
            if (CurrentUpperLimit &lt; EndNo)
            {
                HideMenu(&quot;lnkNext&quot;, true);
            }
            else
            {
                MainToolBar.HideMenu(&quot;lnkNext&quot;);
            }

            LoadLDPData(false);
        }

        protected void btnSave_Click(object sender, EventArgs e)
        {
            SaveEditedItems();
            int scheduleId;
            int quantity;
            var sb = new StringBuilder();
            var sbNewResources = new StringBuilder();
            var resourceRow = new UltraGridRow();
            sbNewResources.Append(&quot;&lt;Resources&gt;&quot;);
            sb.Append(&quot;&lt;Schedules&gt;&quot;);
            foreach (DataRow resource in ScheduleData.Tables[0].Select())
            {
                foreach (DataColumn scheduleData in resource.Table.Columns)
                {
                    if (int.TryParse(scheduleData.ColumnName, out scheduleId))
                    {
                        if (int.TryParse(resource[scheduleData].ToString2(), out quantity) &amp;&amp; quantity != 0)
                        {
                            sb.Append(&quot;&lt;Schedule&gt;&quot;);
                            sb.AppendFormat(
                                &quot;&lt;LDPDetailID&gt;{0}&lt;/LDPDetailID&gt;&lt;ScheduleID&gt;{1}&lt;/ScheduleID&gt;&lt;Quantity&gt;{2}&lt;/Quantity&gt;&quot;,
                                resource[&quot;LDPDetailID&quot;], scheduleId, quantity);
                            sb.Append(&quot;&lt;/Schedule&gt;&quot;);
                        }
                    }
                }
                if (resource[&quot;LDPDetailID&quot;].ToInt32_2() &lt; 0)
                {
                    sbNewResources.Append(&quot;&lt;Resource&gt;&quot;);
                    sbNewResources.AppendFormat(
                        &quot;&lt;LDPDetailID&gt;{0}&lt;/LDPDetailID&gt;&lt;ResItemID&gt;{1}&lt;/ResItemID&gt;&lt;Description&gt;{2}&lt;/Description&gt;&lt;Unit&gt;{3}&lt;/Unit&gt;&quot;,
                        UIHelper.ReplaceXMLCharEntities(resource[&quot;LDPDetailID&quot;].ToString2()),
                        UIHelper.ReplaceXMLCharEntities(resource[&quot;ResItemID&quot;].ToString2()),
                        UIHelper.ReplaceXMLCharEntities(resource[&quot;Description&quot;].ToString2()),
                        UIHelper.ReplaceXMLCharEntities(resource[&quot;Unit&quot;].ToString2()));
                    sbNewResources.Append(&quot;&lt;/Resource&gt;&quot;);
                }
            }
            sb.Append(&quot;&lt;/Schedules&gt;&quot;);
            sbNewResources.Append(&quot;&lt;/Resources&gt;&quot;);
            string xmlArgument = sb.ToString2();
            string xmlNewResources = sbNewResources.ToString2();

            int result = 0;
            if (
                int.TryParse(
                    QuantityPlanningManager.Instance.SaveDPScheduleData(QPID, InstanceId, deletedResourceIDs,
                                                                        xmlNewResources, xmlArgument, string.Empty, &#39;L&#39;)
                        .ToString2(), out result))
            {
                if (result == 1)
                    ClientScript.RegisterStartupScript(GetType(), &quot;alertMessage&quot;, &quot;ShowSuccess(&#39;Saved successfully.&#39;);&quot;, true);
                else
                    ClientScript.RegisterStartupScript(GetType(), &quot;alertMessage&quot;,
                                                       &quot;ShowError(&#39;The save was unsuccessful due to some unknown reason. Please try again.&#39;);&quot;,
                                                       true);
            }
            FetchAndBindData(string.Empty);
            FormatNavigatorButtons();
        }

        protected void btnCancel_Click(object sender, EventArgs e)
        {
            Response.Redirect(
                string.Format(
                    &quot;~/Modules/QTYPLAN/CreateDP.aspx?PID={0}&amp;ContractID={1}&amp;QPID={2}&amp;Context=QTYPLDP&amp;ID={3}&amp;Mode={4}&quot;,
                    Request[&quot;PID&quot;], ContractId, QPID, InstanceId, Request[&quot;Mode&quot;]));
        }

        private void FormCurrentSource(DataTable scheduleData)
        {
            CurrentSource = new DataTable();
            string hiddenColumns = &quot;SchItemID&quot;;

            int tempScheduleId;
            foreach (DataColumn col in scheduleData.Columns)
            {
                if (!hiddenColumns.Split(&#39;,&#39;).Contains(col.ColumnName) &amp;&amp;
                    !int.TryParse(col.ColumnName, out tempScheduleId))
                    CurrentSource.Columns.Add(col.ColumnName);
            }
            CurrentSource.Columns.Add(&quot;IsEdited&quot;);
            CurrentSource.AcceptChanges();

            string fixedColumns = &quot;LDPDetailID,ResItemID,Description,Unit,TotalNo&quot;;
            foreach (DataRow dr in scheduleData.Select())
            {
                DataRow newRow = CurrentSource.NewRow();
                foreach (string colName in fixedColumns.Split(&#39;,&#39;))
                    newRow[colName] = dr[colName];
                newRow[&quot;IsEdited&quot;] = false;
                CurrentSource.Rows.Add(newRow);
            }
        }

        private DataTable GetCurrentDataSource(DataTable scheduleData)
        {
            int tempScheduleId;
            DataColumn currentCol;
            for (int colCount = CurrentSource.Columns.Count - 1; colCount &gt;= 0; colCount--)
            {
                if (int.TryParse(CurrentSource.Columns[colCount].ColumnName, out tempScheduleId))
                {
                    currentCol = CurrentSource.Columns[colCount];
                    CurrentSource.Columns.Remove(currentCol);
                }
            }

            for (int colNo = CurrentLowerLimit; colNo &lt;= CurrentUpperLimit; colNo++)
            {
                CurrentSource.Columns.Add(colNo.ToString2());
            }
            CurrentSource.AcceptChanges();

            Int32 totalNo;
            foreach (DataRow dr in scheduleData.Select())
            {
                DataRow correspondingRow = CurrentSource.Select(&quot;LDPDetailID = &#39;&quot; + dr[&quot;LDPDetailID&quot;] + &quot;&#39;&quot;)[0];
                for (int colNo = CurrentLowerLimit; colNo &lt;= CurrentUpperLimit; colNo++)
                {
                    correspondingRow[colNo.ToString2()] = dr[colNo.ToString2()];
                }

                correspondingRow[&quot;TotalNo&quot;] = Int32.TryParse(dr[&quot;TotalNo&quot;].ToString2(), out totalNo)
                                                  ? totalNo
                                                  : dr[&quot;TotalNo&quot;];
                correspondingRow[&quot;IsEdited&quot;] = false;
            }

            return CurrentSource;
        }

        private void LoadLDPData(bool reFetch)
        {
            if (ScheduleData.Tables.Count.Equals(0))
                ScheduleData = QuantityPlanningManager.Instance.GetDPScheduleData(InstanceId, QPID, ContractId,
                                                                                  string.Empty);

            uwgLDP.DataSource = GetCurrentDataSource(ScheduleData.Tables[0]);
            try
            {
                uwgLDP.DataBind();
            }
            catch
            {
            }
            SetLDPGridColumnProperties();
        }

        private void SetLDPGridColumnProperties()
        {
            foreach (UltraGridColumn col in uwgLDP.Columns)
            {
                int scheduleId;
                if (int.TryParse(col.Key, out scheduleId))
                {
                    if (scheduleId &gt;= CurrentLowerLimit &amp;&amp; scheduleId &lt;= CurrentUpperLimit)
                    {
                        col.Header.Caption = GetColumnHeader(scheduleId);
                        col.Format =
                            CoreDatabaseHelper.GetNumberFormat(
                                CoreDatabaseHelper.GetDigitsGrouping(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT), 0);
                        //If there is no mode or the mode is View then the user should not able to modify the grid column values as well as 
                        //the background color will be transparent
                        if (Request[&quot;Mode&quot;] != null &amp;&amp; Request[&quot;Mode&quot;].Equals(&quot;View&quot;))
                        {
                            col.AllowUpdate = AllowUpdate.No;
                            col.CellStyle.BackColor = Color.Transparent;
                        }
                        else
                        {
                            col.AllowUpdate = AllowUpdate.Yes;
                            col.CellStyle.BackColor = Color.Yellow;
                        }
                        col.Hidden = false;
                        col.EditorControlID = &quot;wneCell&quot;;
                        col.Type = ColumnType.Custom;
                        col.CellStyle.HorizontalAlign = HorizontalAlign.Right;
                        wneCell.DataMode = NumericDataMode.Int;
                        col.Footer.Total = SummaryInfo.Sum;
                        col.Footer.Style.HorizontalAlign = HorizontalAlign.Right;
                    }
                    else
                        col.Hidden = true;
                }
            }
            uwgLDP.Bands[0].Columns.FromKey(&quot;Multi&quot;).AllowUpdate = AllowUpdate.Yes;
            if (uwgLDP.Columns.Exists(&quot;LDPDetailID&quot;)) uwgLDP.Columns.FromKey(&quot;LDPDetailID&quot;).Hidden = true;
            if (uwgLDP.Columns.Exists(&quot;IsEdited&quot;)) uwgLDP.Columns.FromKey(&quot;IsEdited&quot;).Hidden = true;
            if (uwgLDP.Columns.Exists(&quot;ResItemID&quot;)) uwgLDP.Columns.FromKey(&quot;ResItemID&quot;).Header.Caption = &quot;Resource ID&quot;;
            if (uwgLDP.Columns.Exists(&quot;TotalNo&quot;))
            {
                uwgLDP.Columns.FromKey(&quot;TotalNo&quot;).Format =
                    CoreDatabaseHelper.GetNumberFormat(CoreDatabaseHelper.GetDigitsGrouping(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT), 0);
                uwgLDP.Columns.FromKey(&quot;TotalNo&quot;).Header.Caption = &quot;Total Nos&quot;;
                uwgLDP.Columns.FromKey(&quot;TotalNo&quot;).Footer.Total = SummaryInfo.Sum;
                uwgLDP.Columns.FromKey(&quot;TotalNo&quot;).Footer.Style.HorizontalAlign = HorizontalAlign.Right;
                uwgLDP.Columns.FromKey(&quot;TotalNo&quot;).CellStyle.HorizontalAlign = HorizontalAlign.Right;
            }
            if (uwgLDP.Columns.Exists(&quot;Unit&quot;)) uwgLDP.Columns.FromKey(&quot;Unit&quot;).Footer.Caption = &quot;Total&quot;;
        }

        private string GetColumnHeader(int number)
        {
            DataRow currentRow = ScheduleData.Tables[1].Select(&quot;Number = &#39;&quot; + number + &quot;&#39;&quot;)[0];
            DateTime dateColName;
            if (ScheduleData.Tables[1].Columns.Contains(&quot;Name&quot;))
            {
                if (currentRow[&quot;PeriodBasis&quot;].ToString2().Equals(&quot;2&quot;) &amp;&amp;
                    DateTime.TryParse(currentRow[&quot;Name&quot;].ToString2(), out dateColName))
                    return dateColName.ToMWDateTimeString_FormatDate();
                else
                    return currentRow[&quot;Name&quot;].ToString2();
            }
            else
                return @&quot;Week &quot; + (number - StartNo + 1) + &quot;: &quot; +
                       currentRow[&quot;StartDate&quot;].ToMWDateTimeString_FormatDate()
                       + &quot; - &quot; + currentRow[&quot;EndDate&quot;].ToMWDateTimeString_FormatDate();
        }

        private void SaveEditedItems()
        {
            int tempScheduleId, resourceDetailId;
            int quantity, newValue;

            foreach (UltraGridRow editedRow in uwgLDP.Rows)
            {
                if (editedRow.Cells.FromKey(&quot;IsEdited&quot;).Value != null &amp;&amp;
                    editedRow.Cells.FromKey(&quot;IsEdited&quot;).Value.Equals(&quot;true&quot;))
                {
                    resourceDetailId = editedRow.Cells.FromKey(&quot;LDPDetailID&quot;).Value.ToInt32_2();
                    DataRow[] resources = ScheduleData.Tables[0].Select(&quot;LDPDetailID = &#39;&quot; + resourceDetailId + &quot;&#39;&quot;);
                    if (resources.Length &gt; 0)
                    {
                        DataRow resource = resources[0];
                        foreach (DataColumn scheduleCol in CurrentSource.Columns)
                        {
                            if (int.TryParse(scheduleCol.ColumnName, out tempScheduleId))
                            {
                                newValue =
                                    int.TryParse(editedRow.Cells.FromKey(scheduleCol.ColumnName).Value.ToString2(),
                                                 out quantity)
                                        ? quantity
                                        : 0;
                                //difference += newValue - (int.TryParse(resource[scheduleCol.ColumnName].ToString2(), out quantity) ? quantity : 0);
                                resource[scheduleCol.ColumnName] = (newValue == 0
                                                                        ? DBNull.Value
                                                                        : editedRow.Cells.FromKey(scheduleCol.ColumnName)
                                                                              .Value);
                            }
                        }

                        resource[&quot;TotalNo&quot;] = GetMaximumNumber(resource);
                    }
                }
            }
        }

        private Int32 GetMaximumNumber(DataRow row)
        {
            int tempscheduleId, tempValue, maxValue = 0;
            foreach (DataColumn scheduleCol in row.Table.Columns)
            {
                if (int.TryParse(scheduleCol.ColumnName, out tempscheduleId))
                {
                    if (int.TryParse(row[scheduleCol].ToString2(), out tempValue) &amp;&amp; tempValue &gt; maxValue)
                        maxValue = row[scheduleCol].ToInt32_2();
                }
            }
            return maxValue;
        }

        public void AddResource(int source)
        {
            ResourceSource = source;
            SaveEditedItems();
            divResourcePicker.Visible = true;
            MainToolBar.Visible = false;
            resourcePicker.ChangeTableOrViewAndBind(&quot;&quot;);
            resourcePicker.StateMgmtContext = &quot;Resource Labour&quot;;
            divItemDetails.Style.Value = &quot;display:none&quot;;
        }

        public void btnDeleteResource_Click(object sender, EventArgs e)
        {
            int delResourceID;
            //foreach (UltraGridRow resource in uwgLDP.Rows)
            for (int rowCount = uwgLDP.Rows.Count - 1; rowCount &gt;= 0; rowCount--)
            {
                if (uwgLDP.Rows[rowCount].Cells.FromKey(&quot;Multi&quot;).Value.ToString2().ToLower2().Equals(&quot;true&quot;))
                {
                    delResourceID = uwgLDP.Rows[rowCount].Cells.FromKey(&quot;LDPDetailID&quot;).Value.ToInt32_2();
                    if (delResourceID &gt; 0)
                    {
                        if (!string.IsNullOrEmpty(deletedResourceIDs))
                            deletedResourceIDs += &quot;,&quot; + delResourceID.ToString2();
                        else
                            deletedResourceIDs = delResourceID.ToString2();
                    }
                    uwgLDP.Rows.Remove(uwgLDP.Rows[rowCount]);

                    if (CurrentSource.Select(&quot;LDPDetailID = &#39;&quot; + delResourceID + &quot;&#39;&quot;).Length &gt; 0)
                        CurrentSource.Rows.Remove(CurrentSource.Select(&quot;LDPDetailID = &#39;&quot; + delResourceID + &quot;&#39;&quot;)[0]);
                    if (ScheduleData.Tables[0].Select(&quot;LDPDetailID = &#39;&quot; + delResourceID + &quot;&#39;&quot;).Length &gt; 0)
                        ScheduleData.Tables[0].Rows.Remove(
                            ScheduleData.Tables[0].Select(&quot;LDPDetailID = &#39;&quot; + delResourceID + &quot;&#39;&quot;)[0]);
                }
            }
        }

        private void ConfigureResourcePicker()
        {
            
            resourcePicker.BackClicked += resourcePicker_BackClicked;
            resourcePicker.BindData += resourcePicker_BindData;
            resourcePicker.ItemSelected += resourcePicker_ItemSelected;
            resourcePicker.GridNoDataMessage = &quot;No Data exist&quot;;
            resourcePicker.IsFilterXml = true;
            resourcePicker.DisplayFilter = true;
            resourcePicker.Filters = GetFilters();
            resourcePicker.DataSourceCommandType = DataSourceType.StoredProcedure;
            resourcePicker.DefaultSortColumn = ResItemIdColumn;
            resourcePicker.ModifyColumnProperties(&quot;ID&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;RowNum&quot;, true, null, null, null, false);
            if(!ResItemIdColumn.Equals(&quot;ResItemID&quot;))
                resourcePicker.ModifyColumnProperties(&quot;ResItemID&quot;, true, null, null, null, false);
            else
                resourcePicker.ModifyColumnProperties(&quot;ParentResItemID&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(ResItemIdColumn, false, null, null, null, false, &quot;Resource ID&quot;);
            resourcePicker.ModifyColumnProperties(&quot;ProjId&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;ResourceGroupId&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Unit&quot;, false, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Rate&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Size&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Color&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Configuration&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Table2_InventSizeId&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Table2_InventColorId&quot;, true, null, null, null, false);
            resourcePicker.ModifyColumnProperties(&quot;Table2_ConfigId&quot;, true, null, null, null, false);
            resourcePicker.StateMgmtContext = &quot;Resource Labour&quot;;
            resourcePicker.EnableMultipleSelect = true;
        }

        private void resourcePicker_ItemSelected(object sender, ItemSelectedEventArgs e)
        {
            DataTable newResources = e.SelectedItems;
            bool hasDuplicateResource = CheckDuplication(newResources);

            foreach (DataRow validResource in newResources.Select())
            {
                var newRowValues = new object[5];
                DataRow newCurrentResourceRow = CurrentSource.NewRow(),
                        newScheduleDataRow = ScheduleData.Tables[0].NewRow();
                newRowValues[0] = false;
                newRowValues[1] =
                    newCurrentResourceRow[&quot;LDPDetailID&quot;] = newScheduleDataRow[&quot;LDPDetailID&quot;] = tempDetailId--;
                newRowValues[2] =
                    newCurrentResourceRow[&quot;ResItemID&quot;] =
                    newScheduleDataRow[&quot;ResItemID&quot;] = validResource[ResItemIdColumn];
                newRowValues[3] =
                    newCurrentResourceRow[&quot;Description&quot;] =
                    newScheduleDataRow[&quot;Description&quot;] = validResource[&quot;Description&quot;];
                newRowValues[4] = newCurrentResourceRow[&quot;Unit&quot;] = newScheduleDataRow[&quot;Unit&quot;] = validResource[&quot;Unit&quot;];
                var newRow = new UltraGridRow(newRowValues);
                uwgLDP.Rows.Add(newRow);
                CurrentSource.Rows.Add(newCurrentResourceRow);
                ScheduleData.Tables[0].Rows.Add(newScheduleDataRow);
            }

            if (hasDuplicateResource)
                ClientScript.RegisterStartupScript(GetType(), &quot;ShowAlert&quot;, &quot;ShowError(&#39;Duplicate entries are discarded.&#39;);&quot;,
                                                   true);

            resourcePicker_BackClicked(sender, e);
        }

        private bool CheckDuplication(DataTable newResources)
        {
            bool hasDuplicateResources = false;
            for (int rowCount = newResources.Rows.Count - 1; rowCount &gt;= 0; rowCount--)
            {
                UltraGridRow existingResource = uwgLDP.Rows.OfType&lt;UltraGridRow&gt;().ToList().Find(
                    row =&gt;
                    (row.Cells.FromKey(&quot;ResItemID&quot;).Value.ToString2().Equals(
                        newResources.Rows[rowCount][ResItemIdColumn].ToString2(),
                        StringComparison.CurrentCultureIgnoreCase) &amp;&amp;
                     row.Cells.FromKey(&quot;Unit&quot;).Value.ToString2().Equals(
                         newResources.Rows[rowCount][&quot;Unit&quot;].ToString2(), StringComparison.CurrentCultureIgnoreCase)
                    ));
                if (existingResource != null)
                {
                    newResources.Rows.Remove(newResources.Rows[rowCount]);
                    hasDuplicateResources = true;
                }
            }

            return hasDuplicateResources;
        }

        private BrixFilter[] GetFilters()
        {
            var filters = new BrixFilter[2];

            filters[0] = new BrixFilter();
            filters[0].Title = &quot;Resource ID :&quot;;
            filters[0].Name = ResItemIdColumn;
            filters[0].FilterType = BrixFilter.Type.Text;

            filters[1] = new BrixFilter();
            filters[1].Title = &quot;Description :&quot;;
            filters[1].Name = &quot;Description&quot;;
            filters[1].FilterType = BrixFilter.Type.Text;

            return filters;
        }

        private void resourcePicker_BindData(string Filter, string SortOrder, out DataSet DsResult, ref int CurrentPage,
                                             int PageSize, out int PageCount)
        {
            if (ResourceSource.Equals(1))
            {
                string mappedCompany = Session[Constants.EIS_ADDITIONAL_INFO].ToString2();
                string resourceType = &quot;manpower&quot;;

                string materialHierarchyFilter = &quot;&lt;MaterialHierarchy type=&#39;txt&#39;&gt;True&lt;/MaterialHierarchy&gt;&quot;;
                string groupLevelFilter = &quot;&lt;IsGroupLevelResource type=&#39;txt&#39;&gt;True&lt;/IsGroupLevelResource&gt;&lt;/XMLRoot&gt;&quot;;
                if (string.IsNullOrEmpty(Filter))
                    Filter = &quot;&lt;XMLRoot&gt;&quot; + materialHierarchyFilter + groupLevelFilter;
                else
                    Filter = Filter.Replace(&quot;&lt;/XMLRoot&gt;&quot;, materialHierarchyFilter + groupLevelFilter);

                PageCount = (int)Math.Ceiling(GetPageCount(resourceType, SortOrder, Filter) / PageSize);
                DsResult = new BrixDataSet();
                DsResult.Tables.Add(
                    LibraryInterface.Instance.GetResourceItems(mappedCompany, resourceType, ((CurrentPage - 1) * PageSize) + 1, PageSize,
                                                SortOrder, Filter).Copy());
            }
            else
            {
                DsResult = new DataSet();
                PageCount = 0;
                if (string.IsNullOrEmpty(Filter))
                    Filter = &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot;;
                else
                    Filter = Filter.Replace(ResItemIdColumn, &quot;ResItemID&quot;);
                DataTable dtResources =
                    QuantityPlanningManager.Instance.GetRAResourcesForDP(QPID, &#39;L&#39;, Filter, SortOrder, PageSize,
                                                                         ref CurrentPage, out PageCount).Tables[0].Copy();

                DsResult.Tables.Add(dtResources);
            }
        }

        private double GetPageCount(string resType, string sort, string filter)
        {
            string mappedCompany = string.Empty;
            //if (ConfigurationManager.AppSettings[&quot;CompanyFilter&quot;] != null &amp;&amp; ConfigurationManager.AppSettings[&quot;CompanyFilter&quot;] == &quot;On&quot;)
            mappedCompany = Session[Constants.EIS_ADDITIONAL_INFO].ToString2();
            return LibraryInterface.Instance.GetResourceItemsCount(mappedCompany, resType, 0, sort, filter);
        }

        private void resourcePicker_BackClicked(object sender, EventArgs e)
        {
            divResourcePicker.Visible = false;
            MainToolBar.Visible = true;
            divItemDetails.Style.Value = &quot;display:block&quot;;
            LoadLDPData(false);
            FormatNavigatorButtons();
        }

        private void HideMenu(string buttonID, bool bUnHide)
        {
            if (bUnHide) MainToolBar.ShowMenu(buttonID);
            else MainToolBar.HideMenu(buttonID);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[26,9,26,55,0],[31,17,31,18,0],[31,19,31,112,0],[31,113,31,114,0],[34,34,34,38,0],[34,39,34,43,0],[36,34,36,38,0],[36,39,36,43,0],[38,28,38,32,0],[38,33,38,37,0],[40,35,40,39,0],[40,40,40,44,0],[44,17,44,18,0],[44,19,44,65,0],[44,66,44,67,0],[45,17,45,18,0],[45,19,45,49,0],[45,50,45,51,0],[50,17,50,18,0],[50,19,50,63,0],[50,64,50,65,0],[51,17,51,18,0],[51,19,51,47,0],[51,48,51,49,0],[56,17,56,18,0],[56,19,56,75,0],[56,76,56,77,0],[57,17,57,18,0],[57,19,57,59,0],[57,60,57,61,0],[62,17,62,18,0],[62,19,62,75,0],[62,76,62,77,0],[63,17,63,18,0],[63,19,63,59,0],[63,60,63,61,0],[68,17,68,18,0],[68,19,68,62,0],[68,63,68,64,0],[69,17,69,18,0],[69,19,69,54,0],[69,55,69,56,0],[74,17,74,18,0],[74,19,74,65,0],[74,66,74,67,0],[75,17,75,18,0],[75,19,75,55,0],[75,56,75,57,0],[80,17,80,18,0],[80,19,80,70,0],[80,71,80,72,0],[81,17,81,18,0],[81,19,81,54,0],[81,55,81,56,0],[86,17,86,18,0],[86,19,86,77,0],[86,78,86,79,0],[87,17,87,18,0],[87,19,87,60,0],[87,61,87,62,0],[92,17,92,18,0],[92,19,92,72,0],[92,73,92,74,0],[93,17,93,18,0],[93,19,93,56,0],[93,57,93,58,0],[103,17,103,18,0],[103,19,103,121,0],[103,122,103,123,0],[107,9,107,10,0],[108,13,108,34,0],[109,13,109,31,0],[110,9,110,10,0],[113,9,113,10,0],[114,13,114,82,0],[115,13,115,73,0],[116,13,116,39,0],[117,13,117,48,0],[118,13,118,110,0],[119,13,119,58,0],[120,13,120,105,0],[121,13,121,46,0],[122,13,122,28,0],[123,9,123,10,0],[126,9,126,10,0],[127,13,127,35,0],[128,13,128,39,0],[149,13,149,64,0],[150,13,150,63,0],[151,13,152,71,0],[153,13,153,14,0],[154,17,154,31,0],[155,17,155,90,0],[156,17,156,96,0],[158,17,158,98,0],[159,17,159,130,0],[160,17,160,110,0],[161,17,161,51,0],[162,13,162,14,0],[163,13,163,88,0],[164,13,164,105,0],[165,13,165,93,0],[166,13,166,94,0],[167,13,167,108,0],[168,13,168,45,0],[169,13,169,42,0],[170,13,170,49,0],[172,13,172,26,0],[173,13,173,31,0],[174,13,177,117,0],[179,13,179,29,0],[180,17,180,42,0],[181,9,181,10,0],[184,9,184,10,0],[186,13,186,42,0],[189,13,190,70,0],[191,13,191,14,0],[193,17,196,105,0],[197,17,200,118,0],[201,17,205,104,0],[206,17,211,100,0],[212,13,212,14,0],[214,9,214,10,0],[218,9,218,10,0],[219,13,220,113,0],[221,9,221,10,0],[224,9,224,10,0],[225,13,225,45,0],[226,13,226,43,0],[227,13,227,43,0],[228,13,228,45,0],[229,13,229,58,0],[231,13,231,43,0],[232,13,232,64,0],[233,13,233,58,0],[235,13,235,28,0],[236,9,236,10,0],[239,9,239,10,0],[240,13,241,78,0],[243,13,243,38,0],[244,13,244,38,0],[245,9,245,10,0],[248,9,248,10,0],[249,13,249,57,0],[250,17,250,49,0],[251,18,251,117,0],[252,17,252,49,0],[254,13,254,59,0],[255,17,255,53,0],[256,9,256,10,0],[259,9,259,10,0],[260,13,261,71,0],[262,13,262,14,0],[263,17,263,69,0],[264,17,264,80,0],[265,17,265,71,0],[266,17,266,18,0],[267,21,267,96,0],[268,21,268,107,0],[269,17,269,18,0],[270,17,270,97,0],[272,17,272,81,0],[273,21,273,108,0],[274,17,274,76,0],[275,21,275,98,0],[276,13,276,14,0],[278,13,278,80,0],[279,13,279,80,0],[281,13,281,80,0],[282,13,282,99,0],[284,13,284,84,0],[285,13,285,103,0],[286,9,286,10,0],[289,9,289,10,0],[290,13,290,28,0],[291,9,291,10,0],[294,9,294,10,0],[295,13,295,28,0],[296,9,296,10,0],[299,9,299,10,0],[301,13,301,29,0],[303,13,303,29,0],[304,13,304,14,0],[305,17,305,36,0],[306,17,306,48,0],[307,13,307,14,0],[309,17,309,42,0],[310,9,310,10,0],[313,9,313,10,0],[314,13,314,117,0],[315,13,315,34,0],[316,13,316,55,0],[317,13,317,62,0],[318,13,318,96,0],[319,13,319,85,0],[320,13,320,57,0],[321,13,321,14,0],[322,17,322,43,0],[323,13,323,14,0],[324,18,324,76,0],[325,13,325,31,0],[326,13,326,31,0],[327,13,327,37,0],[328,9,328,10,0],[331,9,331,10,0],[332,13,332,61,0],[334,13,334,20,0],[334,22,334,43,0],[334,44,334,46,0],[334,47,334,67,0],[335,17,335,79,0],[336,21,336,84,0],[338,13,338,20,0],[338,22,338,42,0],[338,43,338,45,0],[338,46,338,77,0],[339,13,339,14,0],[340,17,340,76,0],[341,17,341,112,0],[342,17,342,53,0],[343,17,343,18,0],[344,21,344,28,0],[344,30,344,51,0],[344,52,344,54,0],[344,55,344,75,0],[345,21,345,22,0],[346,25,346,87,0],[347,25,347,26,0],[348,29,349,85,0],[350,25,350,26,0],[351,21,351,22,0],[352,17,352,18,0],[353,13,353,14,0],[354,9,354,10,0],[357,9,357,10,0],[358,13,358,31,0],[359,13,359,46,0],[360,13,360,57,0],[360,58,360,84,0],[361,18,361,51,0],[362,13,362,45,0],[363,13,363,14,0],[364,17,364,47,0],[365,13,365,14,0],[367,13,367,14,0],[368,17,368,53,0],[369,13,369,14,0],[370,13,370,43,0],[371,13,371,14,0],[372,17,372,43,0],[373,13,373,14,0],[375,13,375,14,0],[376,17,376,49,0],[377,13,377,14,0],[379,13,379,32,0],[380,9,380,10,0],[383,9,383,10,0],[384,13,384,31,0],[385,13,385,55,0],[386,13,386,46,0],[387,13,387,45,0],[388,13,388,14,0],[389,17,389,47,0],[390,13,390,14,0],[392,13,392,14,0],[393,17,393,53,0],[394,13,394,14,0],[395,13,395,43,0],[396,13,396,14,0],[397,17,397,43,0],[398,13,398,14,0],[400,13,400,14,0],[401,17,401,49,0],[402,13,402,14,0],[404,13,404,32,0],[405,9,405,10,0],[408,9,408,10,0],[409,13,409,31,0],[412,13,412,42,0],[413,13,413,54,0],[414,13,414,50,0],[415,13,415,50,0],[416,13,416,38,0],[417,13,417,20,0],[417,22,417,38,0],[417,39,417,41,0],[417,42,417,73,0],[418,13,418,14,0],[419,17,419,24,0],[419,26,419,49,0],[419,50,419,52,0],[419,53,419,75,0],[420,17,420,18,0],[421,21,421,79,0],[422,21,422,22,0],[423,25,423,109,0],[424,25,424,26,0],[425,29,425,53,0],[426,29,428,80,0],[429,29,429,54,0],[430,25,430,26,0],[431,21,431,22,0],[432,17,432,18,0],[433,17,433,61,0],[434,17,434,18,0],[435,21,435,57,0],[436,21,441,88,0],[442,21,442,58,0],[443,17,443,18,0],[444,13,444,14,0],[445,13,445,39,0],[446,13,446,51,0],[447,13,447,49,0],[448,13,448,65,0],[450,13,450,28,0],[451,13,455,51,0],[456,13,456,14,0],[457,17,457,33,0],[458,21,458,128,0],[460,21,462,62,0],[463,13,463,14,0],[464,13,464,44,0],[465,13,465,38,0],[466,9,466,10,0],[469,9,469,10,0],[470,13,473,85,0],[474,9,474,10,0],[477,9,477,10,0],[478,13,478,45,0],[479,13,479,48,0],[482,13,482,20,0],[482,22,482,36,0],[482,37,482,39,0],[482,40,482,60,0],[483,13,483,14,0],[484,17,485,71,0],[486,21,486,63,0],[487,13,487,14,0],[488,13,488,51,0],[489,13,489,43,0],[491,13,491,84,0],[492,13,492,20,0],[492,22,492,32,0],[492,33,492,35,0],[492,36,492,57,0],[493,13,493,14,0],[494,17,494,57,0],[495,17,495,24,0],[495,26,495,40,0],[495,41,495,43,0],[495,44,495,67,0],[496,21,496,51,0],[497,17,497,44,0],[498,17,498,48,0],[499,13,499,14,0],[500,9,500,10,0],[503,9,503,10,0],[506,18,506,64,0],[506,66,506,79,0],[506,81,506,91,0],[507,13,507,14,0],[508,17,508,98,0],[509,17,509,18,0],[510,21,510,66,0],[511,21,511,62,0],[512,17,512,18,0],[513,13,513,14,0],[515,18,515,47,0],[515,49,515,75,0],[515,77,515,84,0],[516,13,516,14,0],[517,17,517,62,0],[518,13,518,14,0],[519,13,519,43,0],[522,13,522,20,0],[522,22,522,32,0],[522,33,522,35,0],[522,36,522,57,0],[523,13,523,14,0],[524,17,524,113,0],[525,22,525,51,0],[525,53,525,79,0],[525,81,525,88,0],[526,17,526,18,0],[527,21,527,81,0],[528,17,528,18,0],[530,17,532,67,0],[533,17,533,54,0],[534,13,534,14,0],[536,13,536,34,0],[537,9,537,10,0],[540,9,540,10,0],[541,13,541,53,0],[542,17,543,97,0],[545,13,545,78,0],[547,13,547,14,0],[548,17,548,35,0],[549,13,549,14,0],[550,13,550,18,0],[551,13,551,14,0],[552,13,552,14,0],[553,13,553,42,0],[554,9,554,10,0],[557,9,557,10,0],[558,13,558,20,0],[558,22,558,41,0],[558,42,558,44,0],[558,45,558,59,0],[559,13,559,14,0],[561,17,561,59,0],[562,17,562,18,0],[563,21,563,92,0],[564,21,564,22,0],[565,25,565,74,0],[566,25,568,122,0],[571,25,571,87,0],[572,25,572,26,0],[573,29,573,62,0],[574,29,574,73,0],[575,25,575,26,0],[577,25,577,26,0],[578,29,578,63,0],[579,29,579,68,0],[580,25,580,26,0],[581,25,581,44,0],[582,25,582,57,0],[583,25,583,54,0],[584,25,584,79,0],[585,25,585,64,0],[586,25,586,60,0],[587,25,587,82,0],[588,21,588,22,0],[590,25,590,43,0],[591,17,591,18,0],[592,13,592,14,0],[593,13,593,84,0],[594,13,594,54,0],[594,55,594,107,0],[595,13,595,51,0],[595,52,595,101,0],[596,13,596,52,0],[596,53,596,120,0],[597,13,597,50,0],[598,13,598,14,0],[599,17,600,145,0],[601,17,601,80,0],[602,17,602,82,0],[603,17,603,104,0],[604,17,604,101,0],[605,13,605,14,0],[606,13,606,47,0],[606,48,606,104,0],[607,9,607,10,0],[610,9,610,10,0],[611,13,611,96,0],[613,13,613,65,0],[614,13,614,14,0],[615,17,616,88,0],[617,21,617,72,0],[619,21,619,59,0],[622,17,624,88,0],[625,9,625,10,0],[628,9,628,10,0],[632,13,632,20,0],[632,22,632,44,0],[632,45,632,47,0],[632,48,632,59,0],[633,13,633,14,0],[634,17,635,78,0],[636,17,636,18,0],[637,21,637,97,0],[638,21,638,117,0],[639,21,639,46,0],[640,21,640,22,0],[641,25,641,57,0],[642,25,642,32,0],[642,34,642,56,0],[642,57,642,59,0],[642,60,642,81,0],[643,25,643,26,0],[644,29,644,90,0],[645,29,645,30,0],[646,33,650,45,0],[652,33,655,87,0],[656,29,656,30,0],[657,25,657,26,0],[659,25,659,74,0],[660,21,660,22,0],[661,17,661,18,0],[662,13,662,14,0],[663,9,663,10,0],[666,9,666,10,0],[667,44,667,56,0],[668,13,668,20,0],[668,22,668,44,0],[668,45,668,47,0],[668,48,668,65,0],[669,13,669,14,0],[670,17,670,78,0],[671,17,671,18,0],[672,21,672,107,0],[673,25,673,65,0],[674,17,674,18,0],[675,13,675,14,0],[676,13,676,29,0],[677,9,677,10,0],[680,9,680,10,0],[681,13,681,37,0],[682,13,682,31,0],[683,13,683,46,0],[684,13,684,41,0],[685,13,685,57,0],[686,13,686,65,0],[687,13,687,57,0],[688,9,688,10,0],[691,9,691,10,0],[694,18,694,54,0],[694,56,694,69,0],[694,71,694,81,0],[695,13,695,14,0],[696,17,696,110,0],[697,17,697,18,0],[698,21,698,106,0],[699,21,699,43,0],[700,21,700,22,0],[701,25,701,71,0],[702,29,702,83,0],[704,29,704,76,0],[705,21,705,22,0],[706,21,706,63,0],[708,21,708,98,0],[709,25,709,117,0],[710,21,710,107,0],[711,25,712,104,0],[713,17,713,18,0],[714,13,714,14,0],[715,9,715,10,0],[718,9,718,10,0],[720,13,720,70,0],[721,13,721,64,0],[722,13,722,72,0],[723,13,723,64,0],[724,13,724,47,0],[725,13,725,49,0],[726,13,726,51,0],[727,13,727,83,0],[728,13,728,64,0],[729,13,729,88,0],[730,13,730,92,0],[731,13,731,53,0],[732,17,732,99,0],[734,17,734,105,0],[735,13,735,115,0],[736,13,736,92,0],[737,13,737,101,0],[738,13,738,91,0],[739,13,739,90,0],[740,13,740,90,0],[741,13,741,91,0],[742,13,742,99,0],[743,13,743,105,0],[744,13,744,106,0],[745,13,745,101,0],[746,13,746,65,0],[747,13,747,56,0],[748,9,748,10,0],[751,9,751,10,0],[752,13,752,54,0],[753,13,753,72,0],[755,13,755,20,0],[755,22,755,43,0],[755,44,755,46,0],[755,47,755,68,0],[756,13,756,14,0],[757,17,757,50,0],[758,17,758,71,0],[759,25,759,77,0],[760,17,760,41,0],[761,17,762,111,0],[763,17,765,86,0],[766,17,768,86,0],[769,17,769,118,0],[770,17,770,61,0],[771,17,771,41,0],[772,17,772,63,0],[773,17,773,69,0],[774,13,774,14,0],[776,13,776,38,0],[777,17,778,58,0],[780,13,780,51,0],[781,9,781,10,0],[784,9,784,10,0],[785,13,785,48,0],[786,18,786,60,0],[786,62,786,75,0],[786,77,786,87,0],[787,13,787,14,0],[788,17,790,21,0],[790,21,795,22,0],[795,22,795,24,0],[788,17,795,24,0],[796,17,796,46,0],[797,17,797,18,0],[798,21,798,75,0],[799,21,799,50,0],[800,17,800,18,0],[801,13,801,14,0],[803,13,803,42,0],[804,9,804,10,0],[807,9,807,10,0],[808,13,808,45,0],[810,13,810,43,0],[811,13,811,48,0],[812,13,812,47,0],[813,13,813,58,0],[815,13,815,43,0],[816,13,816,48,0],[817,13,817,45,0],[818,13,818,58,0],[820,13,820,28,0],[821,9,821,10,0],[825,9,825,10,0],[826,13,826,42,0],[827,13,827,14,0],[828,17,828,91,0],[829,17,829,50,0],[831,17,831,107,0],[832,17,832,116,0],[833,17,833,50,0],[834,21,834,87,0],[836,21,836,103,0],[838,17,838,105,0],[839,17,839,46,0],[840,17,842,76,0],[843,13,843,14,0],[845,13,845,14,0],[846,17,846,42,0],[847,17,847,31,0],[848,17,848,50,0],[849,21,849,52,0],[851,21,851,75,0],[852,17,854,123,0],[856,17,856,50,0],[857,13,857,14,0],[858,9,858,10,0],[861,9,861,10,0],[862,13,862,49,0],[864,13,864,80,0],[865,13,865,109,0],[866,9,866,10,0],[869,9,869,10,0],[870,13,870,47,0],[871,13,871,40,0],[872,13,872,58,0],[873,13,873,32,0],[874,13,874,38,0],[875,9,875,10,0],[878,9,878,10,0],[879,13,879,25,0],[879,26,879,57,0],[880,18,880,49,0],[881,9,881,10,0]]);
    </script>
  </body>
</html>