<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Estimator\BusinessLayer\BL\EstimatorComponent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Common;
using System.Reflection;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.EstimatorDTO;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Construction.Estimator.BusinessLayer.BL;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Microsoft.Practices.EnterpriseLibrary.Data;
using System.Configuration;
using Aurigo.AMP3.ProjectDAC;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.AMP3.EstimatorDAC
{
    internal class EstimateComponent
    {
        private const string ESTIMATOR = &quot;ESTMATE&quot;;

        private static volatile Dictionary&lt;string, EstimateComponent&gt; _Inst = null;
        private static readonly object _oSync = new object();
        public static EstimateComponent Instance
        {
            get
            {
                lock (_oSync)
                {
                    if (_Inst == null) _Inst = new Dictionary&lt;string, EstimateComponent&gt;();
                    string currentCompany = ConnectionHelper.GetCurrentCompany();
                    if (!_Inst.ContainsKey(currentCompany))
                        if (!_Inst.ContainsKey(currentCompany))
                            _Inst.Add(currentCompany, new EstimateComponent());

                    return _Inst[currentCompany];
                }
            }
        }

        private readonly object lockObj = new object();

        private EstimateComponent()
        {

        }

        internal DataTable GetEstimates(int projectID, bool isDeleted, int pageType, int? parentid)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetEstimateList&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddInParameter(cmd, &quot;ISDeleted&quot;, DbType.Int32, (isDeleted) ? 1 : 0);
                    conn.DB.AddInParameter(cmd, &quot;PageType&quot;, DbType.Int32, pageType);
                    if (parentid != null)
                        conn.DB.AddInParameter(cmd, &quot;PARENTID&quot;, DbType.Int32, parentid);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateEstimate(EstimatorDTO.Estimator estimateDTO, int projectEstimateID, int projectID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    Dictionary&lt;string, string&gt; estmateAttributes = estimateDTO.EstmateAttributes;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateEstimate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATEID&quot;, DbType.String, estimateDTO.EstimateId);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, estimateDTO.EstimateDescription);
                    conn.DB.AddInParameter(cmd, &quot;ISLOCKED&quot;, DbType.Boolean, estimateDTO.EstimateIsLocked);
                    conn.DB.AddInParameter(cmd, &quot;TOTAL&quot;, DbType.Decimal, estimateDTO.EstimateTotal);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTENGINEER&quot;, DbType.String, estimateDTO.ProjectEngineer);
                    conn.DB.AddInParameter(cmd, &quot;CREATEDDATE&quot;, DbType.DateTime, estimateDTO.CreatedDate);
                    conn.DB.AddInParameter(cmd, &quot;LETTINGDATE&quot;, DbType.DateTime, estimateDTO.LettingDate);
                    conn.DB.AddInParameter(cmd, &quot;STATES&quot;, DbType.String, estimateDTO.States);
                    conn.DB.AddInParameter(cmd, &quot;ESTNAME&quot;, DbType.String, estimateDTO.EstimateName);
                    conn.DB.AddInParameter(cmd, &quot;WORKTYPE&quot;, DbType.String, estimateDTO.WorkType);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATETYPE&quot;, DbType.String, estimateDTO.EstimateType);
                    conn.DB.AddInParameter(cmd, &quot;STDITEMTABLEID&quot;, DbType.Int32, estimateDTO.StdItemTable);
                    conn.DB.AddInParameter(cmd, &quot;MEASUREMENTSYSID&quot;, DbType.Int32, estimateDTO.MeasurementSysID);
                    conn.DB.AddInParameter(cmd, &quot;GroupType&quot;, DbType.String, estimateDTO.GroupType);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddInParameter(cmd, &quot;DocTemplateID&quot;, DbType.Int32, estimateDTO.DocumentTemplateID);
                    conn.DB.AddInParameter(cmd, &quot;CreateContractFromBid&quot;, DbType.Boolean, estimateDTO.CreateContractFromBid);
                    conn.DB.ExecuteNonQuery(cmd);
                    int rtnValue = conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToInt32_2();
                    if (rtnValue != -2)
                    {
                        //Attributes
                        cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDelAllEstmtAttribs&quot;);
                        conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                        conn.DB.ExecuteNonQuery(cmd);

                        foreach (var objAttributes in estmateAttributes)
                        {
                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddAttributes&quot;);
                            conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                            conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEID&quot;, DbType.String, objAttributes.Key);
                            conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEVALUE&quot;, DbType.String, objAttributes.Value);
                            conn.DB.AddOutParameter(cmd, &quot;RETURNPARAMETER&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd);
                        }
                    }
                    return rtnValue;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int CreateEstimate(EstimatorDTO.Estimator estimateDTO)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    Dictionary&lt;string, string&gt; estmateAttributes = estimateDTO.EstmateAttributes;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddEstimate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, estimateDTO.ProjectId);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATEID&quot;, DbType.String, estimateDTO.EstimateId);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, estimateDTO.EstimateDescription);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTENGINEER&quot;, DbType.String, estimateDTO.ProjectEngineer);
                    conn.DB.AddInParameter(cmd, &quot;CREATEDDATE&quot;, DbType.DateTime, estimateDTO.CreatedDate);
                    conn.DB.AddInParameter(cmd, &quot;LETTINGDATE&quot;, DbType.DateTime, estimateDTO.LettingDate);
                    conn.DB.AddInParameter(cmd, &quot;ISLOCKED&quot;, DbType.Boolean, estimateDTO.EstimateIsLocked);
                    conn.DB.AddInParameter(cmd, &quot;ISAPPROVED&quot;, DbType.Boolean, estimateDTO.EStimateIsApproved);
                    conn.DB.AddInParameter(cmd, &quot;TOTAL&quot;, DbType.Decimal, estimateDTO.EstimateTotal);
                    conn.DB.AddInParameter(cmd, &quot;STATES&quot;, DbType.String, estimateDTO.States);
                    conn.DB.AddInParameter(cmd, &quot;ESTNAME&quot;, DbType.String, estimateDTO.EstimateName);
                    conn.DB.AddInParameter(cmd, &quot;WORKTYPE&quot;, DbType.String, estimateDTO.WorkType);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATETYPE&quot;, DbType.String, estimateDTO.EstimateType);
                    conn.DB.AddInParameter(cmd, &quot;STDITEMTABLEID&quot;, DbType.Int32, estimateDTO.StdItemTable);
                    conn.DB.AddInParameter(cmd, &quot;MEASUREMENTSYSID&quot;, DbType.Int32, estimateDTO.MeasurementSysID);
                    conn.DB.AddInParameter(cmd, &quot;MULTIESTIMATES&quot;, DbType.Boolean, estimateDTO.MultiEstimates);
                    conn.DB.AddInParameter(cmd, &quot;GroupType&quot;, DbType.String, estimateDTO.GroupType);
                    conn.DB.AddInParameter(cmd, &quot;DocTemplateID&quot;, DbType.Int32, estimateDTO.DocumentTemplateID);
                    conn.DB.AddInParameter(cmd, &quot;CreatedByID&quot;, DbType.Int32, estimateDTO.CreatedByID);
                    conn.DB.AddInParameter(cmd, &quot;CreateContractFromBid&quot;, DbType.Boolean, estimateDTO.CreateContractFromBid);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    int projEstID = conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                    if (estmateAttributes != null)
                    {
                        foreach (var objAttributes in estmateAttributes)
                        {
                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddAttributes&quot;);

                            conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projEstID);
                            conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEID&quot;, DbType.String, objAttributes.Key);
                            conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEVALUE&quot;, DbType.String, objAttributes.Value);
                            conn.DB.AddOutParameter(cmd, &quot;RETURNPARAMETER&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd);
                        }
                    }
                    return projEstID;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal Dictionary&lt;string, string&gt; GetAttributesValues(int projectID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var iDict = new Dictionary&lt;string, string&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetEstimateAttribs&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectID);
                    DataTable attributeDt = conn.DB.ExecuteDataSet(cmd).Tables[0];
                    if (attributeDt.Rows != null)
                    {
                        foreach (DataRow dr in attributeDt.Rows)
                        {
                            iDict.Add(dr[&quot;ATTRIBUTENAME&quot;].ToString2(), dr[&quot;ATTRIBUTEVALUE&quot;].ToString2());
                        }
                    }
                    return iDict;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal EstimatorDTO.Estimator GetEstimateDetails(int projEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var estimatorDTO = new EstimatorDTO.Estimator();

                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetEstimateDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);

                    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;

                    DataRow dtRow;
                    var estmateAttributes = new Dictionary&lt;string, string&gt;();
                    if (dtColl[0].Rows.Count != 0)
                    {
                        dtRow = dtColl[0].Rows[0];
                        estimatorDTO.ProjectId = dtRow[&quot;ProjectId&quot;].ToInt32_2();
                        estimatorDTO.EstimateId = dtRow[&quot;EstimateId&quot;].ToString2();
                        estimatorDTO.EstimateDescription = dtRow[&quot;Description&quot;].ToString2();
                        //estimatorDTO.EstimateTotal = BrixDatatypeHelper.ToDecimal2(dtRow[&quot;Total&quot;].ToString2());
                        estimatorDTO.ProjectEstimateId = projEstimateID;
                        estimatorDTO.ProjectName = dtRow[&quot;ProjectName&quot;].ToString2();
                        estimatorDTO.ProjectEngineer = dtRow[&quot;ProjectEngineer&quot;].ToString2();
                        estimatorDTO.CreatedDate = dtRow[&quot;CreatedDate&quot;].ToDateTime_MWCulture();
                        //estimatorDTO.LettingDate = BrixDatatypeHelper.ToDateTime2(dtRow[&quot;LettingDate&quot;].ToString2());
                        estimatorDTO.States = dtRow[&quot;State&quot;].ToString2();
                        estimatorDTO.ProjectCode = dtRow[&quot;ProjectCode&quot;].ToString2();
                        estimatorDTO.EstimateType = dtRow[&quot;EstimateType&quot;].ToString2();
                        estimatorDTO.EstimateName = dtRow[&quot;EstimateName&quot;].ToString2();
                        estimatorDTO.WorkType = dtRow[&quot;WorkType&quot;].ToString2();
                        int result;
                        int.TryParse(dtRow[&quot;StdItemTableID&quot;].ToString2(), out result);
                        estimatorDTO.StdItemTable = result;
                        int.TryParse(dtRow[&quot;MeasurementSysID&quot;].ToString2(), out result);
                        estimatorDTO.MeasurementSysID = result;
                        estimatorDTO.MeasurementSysName = dtRow[&quot;MeasurementSystem&quot;].ToString2();
                        estimatorDTO.StdTableName = dtRow[&quot;StandardItemTable&quot;].ToString2();
                        estimatorDTO.LettingDate = (dtRow[&quot;LetDate&quot;].ToString2() != &quot;&quot;)
                                                       ? dtRow[&quot;LetDate&quot;].ToDateTime_MWCulture()
                                                       : DateTime.MinValue;
                        estimatorDTO.DatePublished = (dtRow[&quot;AdvDate&quot;].ToString2() != &quot;&quot;)
                                                         ? dtRow[&quot;AdvDate&quot;].ToDateTime_MWCulture()
                                                         : DateTime.MinValue;
                        estimatorDTO.ERPCurrency = dtRow[&quot;ERPCurrency&quot;].ToString2();
                        estimatorDTO.DocumentTemplateID = dtRow[&quot;DocTemplateID&quot;].Equals(DBNull.Value) ? 0 : dtRow[&quot;DocTemplateID&quot;].ToInt32_2();
                        estimatorDTO.DocumentTemplateName = dtRow[&quot;DocTemplateName&quot;].Equals(DBNull.Value) ? string.Empty : dtRow[&quot;DocTemplateName&quot;].ToString2();
                        estimatorDTO.IsVersion = dtRow[&quot;ParentChildStatus&quot;].ToBoolean2();
                    }

                    if (dtColl[1].Rows.Count != 0)
                    {
                        foreach (DataRow dtSubRow in dtColl[1].Rows)
                        {
                            estmateAttributes.Add(
                                dtSubRow[&quot;AttributeId&quot;].ToString2() + &quot;,&quot; + dtSubRow[&quot;AttributeType&quot;].ToString2(),
                                dtSubRow[&quot;AttributeValue&quot;].ToString2());
                        }
                    }

                    if (dtColl[2].Rows.Count != 0)
                    {
                        dtRow = dtColl[2].Rows[0];
                        estimatorDTO.EstimateTotal = dtRow[&quot;TotalCost&quot;].ToString2().ToDecimal2();
                    }

                    estimatorDTO.EstmateAttributes = estmateAttributes;
                    return estimatorDTO;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetGroupDetails(int projEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetGroupList&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int RemoveGroup(int estimateGroupID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteGroup&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATEGROUPID&quot;, DbType.Int32, estimateGroupID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int[] RemoveEstimate(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteEstimate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddOutParameter(cmd, &quot;ORIGINALESTIMATE&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return (new[]
                                {
                                    conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToInt32_2(),
                                    conn.DB.GetParameterValue(cmd, &quot;ORIGINALESTIMATE&quot;).ToInt32_2()
                                });
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteEstimateFromView(string projectEstimateID, bool blnDelete)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATERestore&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEIDS&quot;, DbType.String, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ISDELETED&quot;, DbType.Int32, (blnDelete) ? 1 : 0);
                    conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetItemsByGroups(int projectEstimateID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEViewByGroups&quot;);
                conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int ImportBids(DataSet dsBids, int enterpriseID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEImportBids&quot;);
                conn.DB.AddInParameter(cmd, &quot;ENTERPRISEID&quot;, DbType.Int32, enterpriseID);
                conn.DB.AddInParameter(cmd, &quot;DSBIDSXML&quot;, DbType.String,
                                  dsBids.GetXml().ToString2().Replace(&quot;_x0020_&quot;, &quot;&quot;).Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;));
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);
                return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetAttributes()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                try
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAttributes&quot;);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
                catch (Exception ex)
                {
                    Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                    throw;
                }
            }
        }

        internal int CreateAttribute(string attributeName, string attributeType, string catalogName)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATECreateAttribute&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ATTRIBUTENAME&quot;, DbType.String, attributeName);
                    conn.DB.AddInParameter(cmd, &quot;ATTRIBUTETYPE&quot;, DbType.String, attributeType);
                    conn.DB.AddInParameter(cmd, &quot;CATALOGNAME&quot;, DbType.String, catalogName);
                    conn.DB.AddOutParameter(cmd, &quot;ATTRIBUTEID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;ATTRIBUTEID&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int CopyEstimate(int srcProjectEstID, int destProjectID, string newEstimateID, string newEstDescription,
                                  string copyElements, string initiatedBy, int initiatedById, out Int64 NewEstimateID, string CopyFund = &quot;&quot;)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATECopy&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;SRCPROJECTESTID&quot;, DbType.Int32, srcProjectEstID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;DESPROJECTID&quot;, DbType.Int32, destProjectID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ESTIMATEID&quot;, DbType.String, newEstimateID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;DESCRIPTION&quot;, DbType.String, newEstDescription);
                    conn.DB.AddInParameter(storedProcCommand, &quot;OPERATION&quot;, DbType.String, copyElements);
                    conn.DB.AddInParameter(storedProcCommand, &quot;INTIATEDBY&quot;, DbType.String, initiatedBy);
                    conn.DB.AddInParameter(storedProcCommand, &quot;INTIATEDBYID&quot;, DbType.Int32, initiatedById);
                    conn.DB.AddInParameter(storedProcCommand, &quot;CopyFund&quot;, DbType.String, CopyFund);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;NEWESTIMATEID&quot;, DbType.Int64, 4);
                    int timeOut = storedProcCommand.CommandTimeout;
                    if (!String.IsNullOrEmpty(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;]) &amp;&amp;
                        Int32.TryParse(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;], out timeOut))
                        storedProcCommand.CommandTimeout = timeOut;
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    NewEstimateID = conn.DB.GetParameterValue(storedProcCommand, &quot;NEWESTIMATEID&quot;).ToString2().ToInt64_2();
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal string GetAttributeDetails(int attributeID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAttributeDetails&quot;);
                    string CatalogName = &quot;&quot;;
                    conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEID&quot;, DbType.Int32, attributeID);
                    using (IDataReader reader = conn.DB.ExecuteReader(cmd))
                    {
                        while (reader.Read())
                        {
                            CatalogName = reader.GetString(0);
                        }
                    }
                    return CatalogName;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateIsLocked(int projectEstimateID, bool isLocked)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateIsLocked&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ISLOCKED&quot;, DbType.Int32, (isLocked) ? 1 : 0);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    if (ds == null || ds.Tables.Count == 0)
                        throw new Exception(&quot;dataset null&quot;);
                    if (ds.Tables[0].Rows.Count &gt; 0)
                    {
                        string exception = ds.Tables[0].Rows[0][0].ToString();
                        throw new Exception(exception);
                    }
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateIsApproved(int projectEstimateID, bool isApproved)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    //TODO: Implement Spenum
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateIsApproved&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ISAPPROVED&quot;, DbType.Int32, (isApproved) ? 1 : 0);
                    conn.DB.AddInParameter(cmd, &quot;ApprovedBy&quot;, DbType.Int32, UserDetail.GetCurrentUserDetail().UID);
                    conn.DB.AddInParameter(cmd, &quot;ApprovedOn&quot;, DbType.DateTime, MWDateTimeHelper.MWToday.ToUtc().ToDateTimeString_ForDatabaseOpenXml());
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal bool GetLockStatus(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetLockStatus&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;LOCKSTATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    string strOutput = conn.DB.GetParameterValue(cmd, &quot;LOCKSTATUS&quot;).ToString2();
                    if (String.IsNullOrEmpty(strOutput)) return false;
                    return (strOutput.ToInt32_2() == 1);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal bool GetApprovedStatus(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetApprovedStatus&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;APPROVEDSTATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    string strOutput = conn.DB.GetParameterValue(cmd, &quot;APPROVEDSTATUS&quot;).ToString2();
                    if (String.IsNullOrEmpty(strOutput)) return false;
                    return (strOutput.ToInt32_2() == 1);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidList(int projectEstimateID, int flag, string altIDList, object startRowIdx,
                                      object maxRows, string sortOrder, string getCount)
        {
            return GetBidList(projectEstimateID, flag, altIDList, startRowIdx, maxRows, sortOrder, string.Empty, getCount);
        }

        internal DataTable GetBidList(int projectEstimateID, int flag, string altIDList, object startRowIdx,
                                      object maxRows, string sortOrder, string filter, string getCount)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidList&quot;);

                    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(storedProcCommand, &quot;@ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                    if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(storedProcCommand, &quot;@MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                    if (!string.IsNullOrWhiteSpace(sortOrder))
                        conn.DB.AddInParameter(storedProcCommand, &quot;@SORTORDER&quot;, DbType.String, sortOrder);
                    if (!string.IsNullOrWhiteSpace(filter))
                        conn.DB.AddInParameter(storedProcCommand, &quot;@FILTERTEXT&quot;, DbType.String, filter);

                    conn.DB.AddInParameter(storedProcCommand, &quot;@getCount&quot;, DbType.String, getCount);
                    conn.DB.AddInParameter(storedProcCommand, &quot;@PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;@FLAG&quot;, DbType.Int32, flag);
                    conn.DB.AddInParameter(storedProcCommand, &quot;@ALTLIST&quot;, DbType.String, altIDList);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;@STATUS&quot;, DbType.Int32, 4);


                    return (((conn.DB.ExecuteDataSet(storedProcCommand).Tables)).Count &gt; 0)
                               ? conn.DB.ExecuteDataSet(storedProcCommand).Tables[0]
                               : new BrixDataTable();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetBidListCount(int projEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidList&quot;);

                    conn.DB.AddInParameter(cmd, &quot;@PROJECTESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;@FLAG&quot;, DbType.Int32, 0);
                    conn.DB.AddInParameter(cmd, &quot;@ALTLIST&quot;, DbType.String, &quot;Dummy Pass&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                    conn.DB.AddOutParameter(cmd, &quot;@STATUS&quot;, DbType.Int32, 4);

                    return conn.DB.ExecuteScalar(cmd).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidAnalysis(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidAnalysis&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int AddBidInfo(EstimateBid dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddBidInfo&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORID&quot;, DbType.String, dtoObj.ContractorID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORNAME&quot;, DbType.String, dtoObj.ContractorName);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS1&quot;, DbType.String, dtoObj.Address1);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS2&quot;, DbType.String, dtoObj.Address2);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS3&quot;, DbType.String, dtoObj.Address3);
                    conn.DB.AddInParameter(cmd, &quot;CITY&quot;, DbType.String, dtoObj.City);
                    conn.DB.AddInParameter(cmd, &quot;STATE&quot;, DbType.String, dtoObj.State);
                    conn.DB.AddInParameter(cmd, &quot;ZIP&quot;, DbType.String, dtoObj.Zip);
                    conn.DB.AddInParameter(cmd, &quot;TELEPHONE&quot;, DbType.String, dtoObj.Telephone);
                    conn.DB.AddInParameter(cmd, &quot;TELEPHONEEXTN&quot;, DbType.String, dtoObj.TelephoneExtn);
                    conn.DB.AddInParameter(cmd, &quot;FAX&quot;, DbType.String, dtoObj.Fax);
                    conn.DB.AddInParameter(cmd, &quot;FAXEXTN&quot;, DbType.String, dtoObj.FaxExtn);
                    conn.DB.AddInParameter(cmd, &quot;EMAIL&quot;, DbType.String, dtoObj.Email);
                    conn.DB.AddInParameter(cmd, &quot;CREATEDON&quot;, DbType.DateTime, DateTime.UtcNow.ToDateTime_MWCulture());
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int AddBidUnitPrice(string unitPriceDetails, int projectEstimateID, int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddBidUnitPrice&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.AddInParameter(cmd, &quot;UnitPriceXml&quot;, DbType.String, unitPriceDetails);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int GetBidId(string contractorID, string contractorName, int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidId&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORID&quot;, DbType.String, contractorID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORNAME&quot;, DbType.String, contractorName);
                    conn.DB.AddOutParameter(cmd, &quot;BIDID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;BIDID&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidDetails(int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidUnitPrcDetail&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateBidUnitPrice(string unitPriceDetails, int projectEstimateID, int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateBidUnitPrice&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;UnitPriceXml&quot;, DbType.String, unitPriceDetails);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal double GetBidTotal(int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidTotal&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.AddParameter(cmd, &quot;TOTAL&quot;, DbType.Double, 17, ParameterDirection.Output, false, 17, 2, &quot;&quot;,
                                    DataRowVersion.Default, 1);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;TOTAL&quot;).ToDouble2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable UnitPriceSearch(string executionSQL)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetSqlStringCommand(executionSQL);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateAwardedStatus(int awardStatus, int bidID, int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateStatus&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.AddInParameter(cmd, &quot;AWARDED&quot;, DbType.Int32, awardStatus);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteBid(int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteBid&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetWorkbook(int itemID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetWorkBook&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ITEMID&quot;, DbType.Int32, itemID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int AddToWorkbook(int itemID, string dtWorkBookXML)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddtoWorkBook&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ITEMID&quot;, DbType.Int32, itemID);
                    conn.DB.AddInParameter(cmd, &quot;DSITEMSXML&quot;, DbType.String, dtWorkBookXML);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteWorkbook(string workIDs)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteWorkBook&quot;);
                    conn.DB.AddInParameter(cmd, &quot;WORKIDS&quot;, DbType.String, workIDs);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int GetBidAwardStatus(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidAwardStatus&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;AWARDEDSTATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;AWARDEDSTATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }
        internal string GetWorkFlowStatus(int instanceID, int parentID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetWorkFlowStatus&quot;);
                    conn.DB.AddInParameter(cmd, &quot;FormInstanceID&quot;, DbType.Int32, instanceID);
                    conn.DB.AddInParameter(cmd, &quot;ParentID&quot;, DbType.Int32, parentID);
                    conn.DB.AddOutParameter(cmd, &quot;CurrentStatus&quot;, DbType.String, 100);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;CurrentStatus&quot;).ToString2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }
        internal int GetBidCount(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidCount&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;BIDCOUNT&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;BIDCOUNT&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateDesignContigency(int projectEstimateID, decimal desgCont, decimal estTotal)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateEstTotal&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;DESGCONT&quot;, DbType.Decimal, desgCont);
                    conn.DB.AddInParameter(cmd, &quot;ESTTOTAL&quot;, DbType.Decimal, estTotal);
                    conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidItems(int projectEstimateID, int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidItems&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;BIDID&quot;, DbType.Int32, bidID);
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int CreateSnapShot(EstimatorDTO.Estimator dtoObj, out int NewEstimateId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATESnapShot&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateId);
                    conn.DB.AddInParameter(cmd, &quot;DESPROJECTID&quot;, DbType.Int32, dtoObj.ProjectId);
                    conn.DB.AddInParameter(cmd, &quot;ESTIMATEID&quot;, DbType.String, dtoObj.EstimateId);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, dtoObj.EstimateDescription);
                    conn.DB.AddInParameter(cmd, &quot;INTIATEDBY&quot;, DbType.String, dtoObj.ProjectEngineer);
                    conn.DB.AddInParameter(cmd, &quot;INTIATEDBYID&quot;, DbType.Int32, UserDetail.GetCurrentUserDetail().UID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddOutParameter(cmd, &quot;NEWESTIMATEID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    NewEstimateId = conn.DB.GetParameterValue(cmd, &quot;NEWESTIMATEID&quot;).ToString2().ToInt32_2();
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetSnapShotEstimates(int projectID, bool isDeleted)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetSnapShotEstmt&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddInParameter(cmd, &quot;ISDELETED&quot;, DbType.Boolean, isDeleted);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal EstimateBid GetContractorDetails(int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var dtoBid = new EstimateBid();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetCntrctrDetail&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    using (IDataReader reader = conn.DB.ExecuteReader(cmd))
                    {
                        while (reader.Read())
                        {
                            dtoBid.EstimateID = (reader.IsDBNull(CONTDETAILS.ESTIMATEID_INDEX.ToByte2())
                                                     ? &quot;&quot;
                                                     : reader.GetString(CONTDETAILS.ESTIMATEID_INDEX.ToByte2()));
                            dtoBid.ContractorID = (reader.IsDBNull(CONTDETAILS.CONTRACTORID_INDEX.ToByte2())
                                                       ? &quot;&quot;
                                                       : reader.GetString(CONTDETAILS.CONTRACTORID_INDEX.ToByte2()));
                            dtoBid.ContractorName = (reader.IsDBNull(CONTDETAILS.CONTRACTOR_NAME_INDEX.ToByte2())
                                                         ? &quot;&quot;
                                                         : reader.GetString(
                                                             CONTDETAILS.CONTRACTOR_NAME_INDEX.ToByte2()));
                            dtoBid.Address1 = (reader.IsDBNull(CONTDETAILS.ADDRESS1_INDEX.ToByte2())
                                                   ? &quot;&quot;
                                                   : reader.GetString(CONTDETAILS.ADDRESS1_INDEX.ToByte2()));
                            dtoBid.Address2 = (reader.IsDBNull(CONTDETAILS.ADDRESS2_INDEX.ToByte2())
                                                   ? &quot;&quot;
                                                   : reader.GetString(CONTDETAILS.ADDRESS2_INDEX.ToByte2()));
                            dtoBid.Address3 = (reader.IsDBNull(CONTDETAILS.ADDRESS3_INDEX.ToByte2())
                                                   ? &quot;&quot;
                                                   : reader.GetString(CONTDETAILS.ADDRESS3_INDEX.ToByte2()));
                            dtoBid.City = (reader.IsDBNull(CONTDETAILS.CITY_INDEX.ToByte2())
                                               ? &quot;&quot;
                                               : reader.GetString(CONTDETAILS.CITY_INDEX.ToByte2()));
                            dtoBid.State = (reader.IsDBNull(CONTDETAILS.STATE_INDEX.ToByte2())
                                                ? &quot;&quot;
                                                : reader.GetString(CONTDETAILS.STATE_INDEX.ToByte2()));
                            dtoBid.Zip = (reader.IsDBNull(CONTDETAILS.ZIP_INDEX.ToByte2())
                                              ? &quot;&quot;
                                              : reader.GetString(CONTDETAILS.ZIP_INDEX.ToByte2()));
                            dtoBid.Telephone = (reader.IsDBNull(CONTDETAILS.TEL_INDEX.ToByte2())
                                                    ? &quot;&quot;
                                                    : reader.GetString(CONTDETAILS.TEL_INDEX.ToByte2()));
                            dtoBid.TelephoneExtn = (reader.IsDBNull(CONTDETAILS.TEL_EXTN_INDEX.ToByte2())
                                                        ? &quot;&quot;
                                                        : reader.GetString(CONTDETAILS.TEL_EXTN_INDEX.ToByte2()));
                            dtoBid.Fax = (reader.IsDBNull(CONTDETAILS.FAX_INDEX.ToByte2())
                                              ? &quot;&quot;
                                              : reader.GetString(CONTDETAILS.FAX_INDEX.ToByte2()));
                            dtoBid.FaxExtn = (reader.IsDBNull(CONTDETAILS.FAX_EXTN_INDEX.ToByte2())
                                                  ? &quot;&quot;
                                                  : reader.GetString(CONTDETAILS.FAX_EXTN_INDEX.ToByte2()));
                            dtoBid.Email = (reader.IsDBNull(CONTDETAILS.EMAIL_INDEX.ToByte2())
                                                ? &quot;&quot;
                                                : reader.GetString(CONTDETAILS.EMAIL_INDEX.ToByte2()));
                            dtoBid.Status = (reader.IsDBNull(CONTDETAILS.STATUS_INDEX.ToByte2())
                                             ? 0
                                             : reader.GetInt32(CONTDETAILS.STATUS_INDEX.ToByte2()));

                            dtoBid.Remarks = (reader.IsDBNull(CONTDETAILS.REMARKS_INDEX.ToByte2())
                                               ? &quot;&quot;
                                               : reader.GetString(CONTDETAILS.REMARKS_INDEX.ToByte2()));


                        }
                        reader.Close();
                        reader.Dispose();
                    }
                    return dtoBid;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateContractorDetails(EstimateBid dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateCntrctrDetail&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, dtoObj.BidID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORID&quot;, DbType.String, dtoObj.ContractorID);
                    conn.DB.AddInParameter(cmd, &quot;CONTRACTORNAME&quot;, DbType.String, dtoObj.ContractorName);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS1&quot;, DbType.String, dtoObj.Address1);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS2&quot;, DbType.String, dtoObj.Address2);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS3&quot;, DbType.String, dtoObj.Address3);
                    conn.DB.AddInParameter(cmd, &quot;CITY&quot;, DbType.String, dtoObj.City);
                    conn.DB.AddInParameter(cmd, &quot;STATE&quot;, DbType.String, dtoObj.State);
                    conn.DB.AddInParameter(cmd, &quot;ZIP&quot;, DbType.String, dtoObj.Zip);
                    conn.DB.AddInParameter(cmd, &quot;TELEPHONE&quot;, DbType.String, dtoObj.Telephone);
                    conn.DB.AddInParameter(cmd, &quot;TELEPHONEEXTN&quot;, DbType.String, dtoObj.TelephoneExtn);
                    conn.DB.AddInParameter(cmd, &quot;FAX&quot;, DbType.String, dtoObj.Fax);
                    conn.DB.AddInParameter(cmd, &quot;FAXEXTN&quot;, DbType.String, dtoObj.FaxExtn);
                    conn.DB.AddInParameter(cmd, &quot;EMAIL&quot;, DbType.String, dtoObj.Email);
                    conn.DB.AddInParameter(cmd, &quot;CREATEDON&quot;, DbType.DateTime, DateTime.UtcNow.ToDateTime_MWCulture());
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetItemsBySection(int projectEstimateID, int sectionID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetItemsBySection&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;SECTIONID&quot;, DbType.Int32, sectionID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int AddBidLetInfo(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddBidLetInfo&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateId);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.String, dtoObj.BidLettingID);
                    conn.DB.AddInParameter(cmd, &quot;DESCRIPTION&quot;, DbType.String, dtoObj.BidLettingDescription);
                    conn.DB.AddInParameter(cmd, &quot;DATEPUBLISHED&quot;, DbType.DateTime, dtoObj.DatePublished);
                    conn.DB.AddInParameter(cmd, &quot;LETTINGDATE&quot;, DbType.DateTime, dtoObj.LettingDate);
                    conn.DB.AddInParameter(cmd, &quot;CREATEDBY&quot;, DbType.String, dtoObj.CreatedBy);
                    conn.DB.AddInParameter(cmd, &quot;ADDRESS&quot;, DbType.String, dtoObj.Address);
                    conn.DB.AddInParameter(cmd, &quot;BIDMODE&quot;, DbType.String, dtoObj.Status);
                    conn.DB.AddInParameter(cmd, &quot;APPROVEDBY&quot;, DbType.String, dtoObj.ApprovedBy);
                    conn.DB.AddInParameter(cmd, &quot;BallInCourt&quot;, DbType.String, dtoObj.BallInCourt);
                    if (dtoObj.BidDueDateTime == null)
                    {
                        conn.DB.AddInParameter(cmd, &quot;BIDDUEDATETIME&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(cmd, &quot;BIDDUEDATETIME&quot;, DbType.DateTime, dtoObj.BidDueDateTime);
                    }
                    conn.DB.AddInParameter(cmd, &quot;LETTINGTYPE&quot;, DbType.String,
                                      (dtoObj.IsCreateLetting.Equals(&quot;Y&quot;) ? &quot;Letting&quot; : &quot;Addendum&quot;));
                    if (dtoObj.IssueDate == null)
                    {
                        conn.DB.AddInParameter(cmd, &quot;ISSUEDATE&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(cmd, &quot;ISSUEDATE&quot;, DbType.DateTime, dtoObj.IssueDate);
                    }
                    if (dtoObj.PreBidMeetingDate == null)
                    {
                        conn.DB.AddInParameter(cmd, &quot;PreBidMeetingDate&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(cmd, &quot;PreBidMeetingDate&quot;, DbType.DateTime, dtoObj.PreBidMeetingDate);
                    }
                    if (dtoObj.AddendumIssueDate == null)
                    {
                        conn.DB.AddInParameter(cmd, &quot;AddendumIssueDate&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(cmd, &quot;AddendumIssueDate&quot;, DbType.DateTime, dtoObj.AddendumIssueDate);
                    }
                    conn.DB.AddInParameter(cmd, &quot;LETTINGDESC&quot;, DbType.String, dtoObj.LettingDesc);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidLetInfo(int projectEstimateID, object startRowIdx, object maxRows, string sortOrder,
                                 string getCount, string flag)
        {
            return GetBidLetInfo(projectEstimateID, startRowIdx, maxRows, sortOrder, string.Empty, getCount, flag);
        }

        internal DataTable GetBidLetInfo(int projectEstimateID, object startRowIdx, object maxRows, string sortOrder,
                                         string filter, string getCount, string flag)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidLetInfo&quot;);

                    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;@ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);
                    if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;@MAXROWSINPAGE&quot;, DbType.Int32, maxRows);
                    if (!string.IsNullOrWhiteSpace(sortOrder))
                        conn.DB.AddInParameter(cmd, &quot;@SORTORDER&quot;, DbType.String, sortOrder);
                    if (!string.IsNullOrWhiteSpace(filter))
                        conn.DB.AddInParameter(cmd, &quot;@FILTERTEXT&quot;, DbType.String, filter);
                    conn.DB.AddInParameter(cmd, &quot;@getCount&quot;, DbType.String, getCount);
                    conn.DB.AddInParameter(cmd, &quot;@flag&quot;, DbType.String, flag);
                    conn.DB.AddInParameter(cmd, &quot;@PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);


                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int GetBidLetInfoCount(int projEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidLetInfo&quot;);

                    conn.DB.AddInParameter(cmd, &quot;@PROJECTESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;@GETCOUNT&quot;, DbType.String, &quot;Y&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@flag&quot;, DbType.String, &quot;0&quot;);

                    return conn.DB.ExecuteScalar(cmd).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteBidLetInfo(int ID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteBidLetInfo&quot;);

                    conn.DB.AddInParameter(cmd, &quot;ID&quot;, DbType.Int32, ID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetUPSMeasureUnits()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetUPSUnits&quot;);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteAttribute(int attributeID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteAttribute&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ATTRIBUTEID&quot;, DbType.Int32, attributeID);
                    conn.DB.AddOutParameter(cmd, &quot;RETVAL&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;RETVAL&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetProjectList(string erpCompany)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetProjectList&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetAlternates(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAlternateList&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int AddAlternateInfo(EstimateItem dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddAlternate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int16, dtoObj.ProjectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ALTCODE&quot;, DbType.String, dtoObj.AlternateCode);
                    conn.DB.AddInParameter(cmd, &quot;ALTNAME&quot;, DbType.String, dtoObj.AlternateName);
                    conn.DB.AddInParameter(cmd, &quot;NOTES&quot;, DbType.String, dtoObj.AlternateNotes);
                    conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateAlternateInfo(EstimateItem dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateAlternate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ALTID&quot;, DbType.Int32, dtoObj.AlternateID);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ALTCODE&quot;, DbType.String, dtoObj.AlternateCode);
                    conn.DB.AddInParameter(cmd, &quot;ALTNAME&quot;, DbType.String, dtoObj.AlternateName);
                    conn.DB.AddInParameter(cmd, &quot;NOTES&quot;, DbType.String, dtoObj.AlternateNotes);
                    conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int DeleteAlternateInfo(int alternateID, int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDeleteAlternate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ALTID&quot;, DbType.Int32, alternateID);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable[] GetGSAList(int projEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    //DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetGSAUList&quot;,
                    //    new object[] { projEstimateID, null, null, null, null });
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetGSAUList&quot;);

                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;@STATUS&quot;, DbType.Int32, 4);

                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    return (new[] { ds.Tables[0], ds.Tables[1], ds.Tables[2], ds.Tables[3] });
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal bool GetAddendumStatus(int addendumID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAddendumStatus&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ADDENDUMID&quot;, DbType.Int32, addendumID);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return (conn.DB.GetParameterValue(storedProcCommand, &quot;STATUS&quot;).ToString2().ToInt32_2() == 0)
                               ? false
                               : true;
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetStdItems(int projEstimateID, int stdItemID, object startRowIdx, object maxRows,
                                       string sortOrder, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdItems4StdTbl&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;in_StandardTableID&quot;, DbType.Int32, projEstimateID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECESTIMATEID&quot;, DbType.Int32, stdItemID);

                    if ((startRowIdx != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);

                    if ((maxRows != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);

                    if (sortOrder != null)
                        conn.DB.AddInParameter(storedProcCommand, &quot;SORTORDER&quot;, DbType.String, sortOrder);

                    if ((filterSearch != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetStdItemCount(int stdTableID, int projEstimateID, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdItems4StdTbl&quot;);

                    conn.DB.AddInParameter(storedProcCommand, &quot;IN_STANDARDTABLEID&quot;, DbType.Int32, stdTableID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    if (filterSearch != null)
                        conn.DB.AddInParameter(storedProcCommand, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                    //conn.DB.AddInParameter(storedProcCommand, &quot;SORTORDER&quot;, DbType.String, &quot;A.StandardItemNo asc&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);

                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0].Rows[0][0].ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetStdItemCount4UPS(int projEstimateID, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdItems4UPS&quot;);

                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECESTIMATEID&quot;, DbType.Int32, projEstimateID);
                    if (filterSearch != null)
                        conn.DB.AddInParameter(storedProcCommand, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);
                    //conn.DB.AddInParameter(storedProcCommand, &quot;SORTORDER&quot;, DbType.String, &quot;A.StandardItemNo asc&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;GETCOUNT&quot;, DbType.String, &quot;Y&quot;);

                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0].Rows[0][0].ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetStdItems4UPS(int projEstimateID, object startRowIdx, object maxRows,
                                        string sortOrder, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdItems4UPS&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECESTIMATEID&quot;, DbType.Int32, projEstimateID);

                    if ((startRowIdx != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;ROWSTARTIDX&quot;, DbType.Int32, startRowIdx);

                    if ((maxRows != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;MAXROWSINPAGE&quot;, DbType.Int32, maxRows);

                    if (sortOrder != null)
                        conn.DB.AddInParameter(storedProcCommand, &quot;SORTORDER&quot;, DbType.String, sortOrder);

                    if ((filterSearch != null) &amp;&amp; (startRowIdx != Type.Missing))
                        conn.DB.AddInParameter(storedProcCommand, &quot;FILTERTEXT&quot;, DbType.String, filterSearch);

                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetStandardItemTables(string AXCompany)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdTableList&quot;);
                    if (!string.IsNullOrEmpty(AXCompany))
                        conn.DB.AddInParameter(storedProcCommand, &quot;ERPCompany&quot;, DbType.String, AXCompany);
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetBidLetStaus(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidLetStatus&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetBidLetDetail(int id, int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidLetDetail&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ID&quot;, DbType.Int32, id);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable[] GetBidTabulationList(string alternateIDList, int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    //DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEBidTabDetails&quot;,
                    //                          new object[] { alternateIDList, projectEstimateID, null, null });

                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEBidTabDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ALTIDLIST&quot;, DbType.String, alternateIDList);
                    conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);

                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    return (new[] { ds.Tables[0], ds.Tables[1] });
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal List&lt;int&gt; GetRolesForFeatureList(string moduleID, string featureCode)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var list = new List&lt;int&gt;();
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetRoles4FtureList&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;MODULEID&quot;, DbType.String, moduleID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;FEATURECODE&quot;, DbType.String, featureCode);
                    using (IDataReader reader = conn.DB.ExecuteReader(storedProcCommand))
                    {
                        while (reader.Read())
                        {
                            list.Add(reader.GetInt32(reader.GetOrdinal(&quot;RoleID&quot;)));
                        }
                    }
                    return list;
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetProjectUsers(int projectID)
        {
            try
            {
                return ProjectComponent.Instance.GetProjectUsers(projectID);
                //commenting old code , getting the project users from the platform directly

                //using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                //{
                //    var dictionary = new Dictionary&lt;int, int&gt;();
                //    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectUsers&quot;);
                //    conn.DB.AddInParameter(storedProcCommand, &quot;IN_PROJECTID&quot;, DbType.Int32, projectID);
                //    DataTable table = conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                //    if (table.Rows != null)
                //    {
                //        foreach (DataRow row in table.Rows)
                //        {
                //            dictionary.Add(row[&quot;USERID&quot;].ToString2().ToInt32_2(),
                //                           row[&quot;ROLEID&quot;].ToString2().ToInt32_2());
                //        }
                //    }
                //    return dictionary;
                //}
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetUserInformation(string listofUsers)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_USRMGMTGetAllActiveUsers&quot;);
                    if (!string.IsNullOrEmpty(listofUsers))
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;Userlist&quot;, DbType.String, listofUsers);
                    }
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetBLStatusList()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBLStatusList&quot;);
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int UpdateBidLetInfo(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateBidLetInfo&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateId);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ADDENDUMID&quot;, DbType.Int32, dtoObj.AddendumID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;BIDID&quot;, DbType.String, dtoObj.BidLettingID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;DESCRIPTION&quot;, DbType.String, dtoObj.BidLettingDescription);
                    conn.DB.AddInParameter(storedProcCommand, &quot;DATEPUBLISHED&quot;, DbType.DateTime, dtoObj.DatePublished);
                    conn.DB.AddInParameter(storedProcCommand, &quot;LETTINGDATE&quot;, DbType.DateTime, dtoObj.LettingDate);
                    conn.DB.AddInParameter(storedProcCommand, &quot;CREATEDBY&quot;, DbType.String, dtoObj.CreatedBy);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ADDRESS&quot;, DbType.String, dtoObj.Address);
                    conn.DB.AddInParameter(storedProcCommand, &quot;BALLINCOURT&quot;, DbType.String, dtoObj.BallInCourt);
                    conn.DB.AddInParameter(storedProcCommand, &quot;STATUS&quot;, DbType.String, dtoObj.Status);
                    conn.DB.AddInParameter(storedProcCommand, &quot;APPROVEDBY&quot;, DbType.String, dtoObj.ApprovedBy);
                    if (dtoObj.BidDueDateTime == null)
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;BIDDUEDATETIME&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;BIDDUEDATETIME&quot;, DbType.DateTime, dtoObj.BidDueDateTime);
                    }
                    if (dtoObj.IssueDate == null)
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;ISSUEDATE&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;ISSUEDATE&quot;, DbType.DateTime, dtoObj.IssueDate);
                    }
                    if (dtoObj.PreBidMeetingDate == null)
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;PreBidMeetingDate&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;PreBidMeetingDate&quot;, DbType.DateTime, dtoObj.PreBidMeetingDate);
                    }
                    if (dtoObj.AddendumIssueDate == null)
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;AddendumIssueDate&quot;, DbType.DateTime, DBNull.Value);
                    }
                    else
                    {
                        conn.DB.AddInParameter(storedProcCommand, &quot;AddendumIssueDate&quot;, DbType.DateTime, dtoObj.AddendumIssueDate);
                    }
                    conn.DB.AddInParameter(storedProcCommand, &quot;LETTINGDESC&quot;, DbType.String, dtoObj.LettingDesc);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;ERROR&quot;, DbType.Int32, 4);
                    int timeOut = storedProcCommand.CommandTimeout;
                    if (!String.IsNullOrEmpty(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;]) &amp;&amp;
                        Int32.TryParse(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;], out timeOut))
                        storedProcCommand.CommandTimeout = timeOut;
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable[] GetChoosenAlternates(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetChoosenAlts&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);

                    DataTable[] tableArray = new BrixDataTable[2];
                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    return (new[] { ds.Tables[0], ds.Tables[1] });
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int AddEstimateSettings(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEAddEstimateSettings&quot;);

                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateId);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PREFIX&quot;, DbType.String, dtoObj.Prefix);
                    conn.DB.AddInParameter(storedProcCommand, &quot;SEPERATOR&quot;, DbType.String, dtoObj.Seperator);
                    conn.DB.AddInParameter(storedProcCommand, &quot;LINEINCREMENTBY&quot;, DbType.Int32, dtoObj.IncrementBy);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTID&quot;, DbType.Int32, dtoObj.ProjectId);
                    conn.DB.AddInParameter(storedProcCommand, &quot;START&quot;, DbType.Int32, dtoObj.LineNoStart);
                    conn.DB.AddInParameter(storedProcCommand, &quot;MULTIESTIMATES&quot;, DbType.Boolean, dtoObj.MultiEstimates);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int UpdateEstimateSettings(EstimatorDTO.Estimator dtoObj)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateEstmtSetting&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ESTSETTINGSID&quot;, DbType.Int32, dtoObj.EstimateSettingsID);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, dtoObj.ProjectEstimateId);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PREFIX&quot;, DbType.String, dtoObj.Prefix);
                    conn.DB.AddInParameter(storedProcCommand, &quot;SEPERATOR&quot;, DbType.String, dtoObj.Seperator);
                    conn.DB.AddInParameter(storedProcCommand, &quot;LINEINCREMENTBY&quot;, DbType.Int32, dtoObj.IncrementBy);
                    conn.DB.AddInParameter(storedProcCommand, &quot;START&quot;, DbType.Int32, dtoObj.LineNoStart);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int DeleteEstimateSettings(int estSettingsID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEDelEstmtSettings&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;ESTSETTINGSID&quot;, DbType.Int32, estSettingsID);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;ERROR&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(storedProcCommand);
                    return conn.DB.GetParameterValue(storedProcCommand, &quot;ERROR&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetEstimateSettings(int projectID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand storedProcCommand = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetEstSettingsList&quot;);
                    conn.DB.AddInParameter(storedProcCommand, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddOutParameter(storedProcCommand, &quot;ERROR&quot;, DbType.Int32, 4);
                    return conn.DB.ExecuteDataSet(storedProcCommand).Tables[0];
                }
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetEstimateStdTable(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetStdTblID&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STDTBLID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STDTBLID&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetPublishItemsToCont(int projectID, int bidID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAwardedItems&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetEstimateForVersion(int projectID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetEstmt4Version&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetProjectsList(object startRowIdx, object maxRows, string sortOrder, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetProjectsList_UPS&quot;);

                    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);

                    if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);

                    if (sortOrder != null)
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);

                    if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int GetProjectsCount(string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetProjectsList_UPS&quot;);
                    conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;Y&quot;);

                    if (!string.IsNullOrEmpty(filterSearch))
                        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable[] GetIWTExportDetails(int projectEstimateID, int addendumID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEIWTExport&quot;,
                                                            new object[]
                                                                {
                                                                    projectEstimateID, addendumID, null, null, null, null,
                                                                    null
                                                                });
                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    return (new[] { ds.Tables[0], ds.Tables[1], ds.Tables[2], ds.Tables[3], ds.Tables[4] });
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal string[] CheckSnapShot(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATESnapShotCheck&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.AddOutParameter(cmd, &quot;ESTIMATEID&quot;, DbType.String, 50);
                    conn.DB.ExecuteScalar(cmd);

                    var rtnValues = new string[2];
                    rtnValues[0] = conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2();
                    rtnValues[1] = conn.DB.GetParameterValue(cmd, &quot;ESTIMATEID&quot;).ToString2();
                    return rtnValues;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int GetProjectID(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetProjectID&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddOutParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;PROJECTID&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal int UpdateIWTExpSuccess(int projectEstimateID, int addendumID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEUpdateIWTExpSucess&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ADDENDUMID&quot;, DbType.Int32, addendumID);
                    conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable[] GetExportDataToContract(int bidID, int projectEstimateID, int projectID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var dtResultSet = new DataTable[6];

                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEContractExport&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, projectID);
                    conn.DB.AddInParameter(cmd, &quot;GETESTIMATES&quot;, DbType.String, &quot;N&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;GETBIDDERS&quot;, DbType.String, &quot;N&quot;);
                    conn.DB.AddInParameter(cmd, &quot;GETBIDITEMS&quot;, DbType.String, &quot;Y&quot;);
                    conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);

                    DataSet dsTemp = conn.DB.ExecuteDataSet(cmd);

                    dtResultSet[0] = dsTemp.Tables[0];
                    dtResultSet[1] = dsTemp.Tables[1];
                    dtResultSet[2] = dsTemp.Tables[2];
                    dtResultSet[3] = dsTemp.Tables[3];
                    dtResultSet[4] = dsTemp.Tables[4];
                    dtResultSet[5] = dsTemp.Tables[5];

                    return dtResultSet;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetEngineerEstReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidSummary&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidSheetReport(int projectEstimateID, int upFraction, int amtFraction, string flag)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidSheet&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;UNITPRICEFRACTION&quot;, DbType.Int32, upFraction);
                    conn.DB.AddInParameter(cmd, &quot;AMOUNTFRACTION&quot;, DbType.Int32, amtFraction);
                    conn.DB.AddInParameter(cmd, &quot;FLAG&quot;, DbType.String, flag);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetCostSheetReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATECostSummaryReport&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetCostSheetSubReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATECostSummaryReport_SubReport&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidTabulationReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidTabulationReport1&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidTabSummaryReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBidList_Report&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetItemBidders(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetBiddersDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetSectionSummary(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetSectionSummary&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetAddendumReport(int projectEstimateID, int addendumId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetAddendumReport&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;ADDENDUMID&quot;, DbType.Int32, addendumId);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        internal DataTable GetBidLettingReport(int projectEstimateID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEBidAdvReport&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// for the new report for demo on 04-14-2008
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectEstimateID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataSet GetCostSheetReportInfo(int projectEstimateID, string equipment, string manpower,
                                                string materials, string misc, string subContract)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;[usp_ESTMATECostSheetReport]&quot;);
                    conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);
                    conn.DB.AddInParameter(cmd, &quot;EQUIPMENT&quot;, DbType.String, equipment);
                    conn.DB.AddInParameter(cmd, &quot;MANPOWER&quot;, DbType.String, manpower);
                    conn.DB.AddInParameter(cmd, &quot;MATERIALS&quot;, DbType.String, materials);
                    conn.DB.AddInParameter(cmd, &quot;MISC&quot;, DbType.String, misc);
                    conn.DB.AddInParameter(cmd, &quot;SUBCONTRACT&quot;, DbType.String, subContract);
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }

        // ODS Contractor 
        internal DataTable GetContractor(string strAdditionalInfo, object startRowIdx, object maxRows, string sortOrder,
                                         string filterSearch, string filterValues = null)
        {
            try
            {
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX,
                                       new EISAdditionalInfo(RegisteredEIS.AX).AddInfo(Constants.EIS_ADDITIONAL_INFO,
                                                                                       strAdditionalInfo));

                var connectorParameters =
                    new ConnectorParameters(dictAdditionalInfo,
                                            MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                                            new ConnectionFilter(filterSearch, sortOrder, (int?)startRowIdx,
                                                                 (int?)maxRows, null), null);
                DataSet ds = new BrixDataSet();
                int count = 0;
                if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true))
                {
                    return ds.Tables[0];
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetContractors&quot;);

                        if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@rowStartIdx&quot;, DbType.Int32, startRowIdx);
                        }
                        if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@maxRowsInPage&quot;, DbType.Int32, maxRows);
                        }
                        if (sortOrder != null)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@sortOrder&quot;, DbType.String, sortOrder);
                        }
                        if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@filterText&quot;, DbType.String, filterSearch);
                        }
                        if (filterValues != null)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@filterValues&quot;, DbType.String, filterValues);
                        }

                        return conn.DB.ExecuteDataSet(cmd).Tables[0];
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        internal int GetContractorCount(string strAdditionalInfo, string filterSearch)
        {
            try
            {
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX,
                                       new EISAdditionalInfo(RegisteredEIS.AX).AddInfo(Constants.EIS_ADDITIONAL_INFO,
                                                                                       strAdditionalInfo));
                var connectorParameters =
                    new ConnectorParameters(dictAdditionalInfo,
                                            MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                                            new ConnectionFilter(filterSearch, null, null, null, null), null);

                DataSet ds = new BrixDataSet();
                int count = 0;
                if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true))
                {
                    return count;
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_LIBRARYGetContractors&quot;);

                        if (filterSearch != null)
                        {
                            conn.DB.AddInParameter(cmd, &quot;@filterText&quot;, DbType.String, filterSearch);
                        }

                        conn.DB.AddInParameter(cmd, &quot;@getCount&quot;, DbType.String, &quot;Y&quot;);

                        return conn.DB.ExecuteScalar(cmd).ToString2().ToInt32_2();
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }

        internal int GetLIBContRecID(string contID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATELibContRecID&quot;);

                conn.DB.AddInParameter(cmd, &quot;CONTID&quot;, DbType.String, contID);

                return conn.DB.ExecuteScalar(cmd).ToString2().ToInt32_2();
            }
        }

        internal DataTable GetProjectAssociation(int projectID, string moduleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectModules&quot;);
                conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectID);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetEstimateSubmittals(int projectEstimateID, int projectID, string moduleCategory)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_SUBMTALGETRegister&quot;);

                conn.DB.AddInParameter(cmd, &quot;ProjectID&quot;, DbType.Int32, projectID);
                conn.DB.AddInParameter(cmd, &quot;ModuleLinkID&quot;, DbType.Int32, projectEstimateID);
                conn.DB.AddInParameter(cmd, &quot;ModuleCategory&quot;, DbType.String, moduleCategory);
                conn.DB.AddInParameter(cmd, &quot;FilterText&quot;, DbType.String, &quot;&lt;XMLRoot&gt;&lt;Status&gt;P&lt;/Status&gt;&lt;/XMLRoot&gt;&quot;);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataTable GetReportDetails(int projectID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ESTMATEGetReportDetails&quot;);
                conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetEstimateAndWorkType()
        {
            return ComponentHelper.Instance.ExecuteDataSet(EstimatorStoredProcedure.usp_ESTMATEGetEstimateAndWorkType,
                                                           null, null);
        }

        public int GetProjectEstimateIDFromBidId(int BidId)
        {
            Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(EstimatorStoredProcedure.usp_ESTMATEGetProjectEstimateIDFromBidId, dic, BidId);

            if (dic != null &amp;&amp; dic.ContainsKey(&quot;ProjectEstimateId&quot;))
                return dic[&quot;ProjectEstimateId&quot;].ToInt32_2();
            else
                return 0;
        }

        internal int CancelBidLetting(int bidLettingID)
        {
            return ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(EstimatorStoredProcedure.usp_ESTMATECancelBidLetting, null, bidLettingID);
        }

        internal DataTable GetBidLettingDetail(int projectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(EstimatorStoredProcedure.usp_ESTMATEGetBidLettingDetail, null, projectEstimateID).Tables[0];
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable HasUnitPrice(string bidIDs)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(EstimatorStoredProcedure.usp_ESTMATEHasUnitPrice, null, bidIDs).Tables[0];
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal void UpdateEstimateBidSettings(params object[] estimateSettings)
        {
            try
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(EstimatorStoredProcedure.usp_ESTMATEUpdateEstimateBidSetings, null, estimateSettings);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal object GetContractIdFromEstimateId(int projectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_GetContractIdFromEstimateId, null, projectEstimateID);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal object GetAutoCreateContract(int projectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_GetAutoCreateContract, null, projectEstimateID);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal object GetBidStatus(int bidId)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_GetBidStatus, null, bidId);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataTable GetBidInformation(int bidID, int projectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(EstimatorStoredProcedure.usp_ESTMATEBidInformation, null, bidID, projectEstimateID).Tables[0];
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int GetAddendumItemsCount(int parentId)
        {
            try
            {
                // object AddendumItemsCount = ComponentHelper.Instance.ExecuteScalar(&quot;select Count(ItemID) from CORITEMItemDetails where ModuleID = &#39;ESTMADD&#39; and ParentInstanceID = &quot; + parentId );
                object AddendumItemsCount = ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTIMATECheckIfBidBelongsToBidder, null, parentId);
                return AddendumItemsCount.ToInt32_2();
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataSet GetAddendumIssuedMail(int projectEstimateId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(EstimatorStoredProcedure.usp_ESTMATEGetAddendumIssuedMail,
                                                           null, projectEstimateId);
        }

        internal int GetInviteBidderInfo(int projectid, int ProjectEstimateID, int userID)
        {
            try
            {
                object countbidder = ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATECheckIfBidderExists,
                                                           null, projectid, ProjectEstimateID, userID);
                return countbidder.ToInt32_2();
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }
        internal object GetEstimateContractorLoginID(string ContractorID, int PID, int ProjectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATEContractorLoginID, null, ContractorID, PID, ProjectEstimateID);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal DataSet GetEstimateBidInfo(int EstimateId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_getEstimateBidInfo&quot;);
                    conn.DB.AddInParameter(cmd, &quot;estimateId&quot;, DbType.Int32, EstimateId);
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, ESTIMATOR);
                throw;
            }
        }


        #region Nested type: CONTDETAILS

        private enum CONTDETAILS : byte
        {
            ESTIMATEID_INDEX,
            CONTRACTORID_INDEX = 2,
            CONTRACTOR_NAME_INDEX,
            ADDRESS1_INDEX,
            ADDRESS2_INDEX,
            ADDRESS3_INDEX,
            CITY_INDEX,
            STATE_INDEX,
            ZIP_INDEX,
            TEL_INDEX,
            TEL_EXTN_INDEX,
            FAX_INDEX,
            FAX_EXTN_INDEX,
            EMAIL_INDEX,
            STATUS_INDEX,
            REMARKS_INDEX
        }

        #endregion

        #region Nested type: COSTSHEET

        private enum COSTSHEET : byte
        {
            GRAND_TOTAL_INDEX,
            EQP_TOTAL_INDEX,
            WF_TOTAL_INDEX,
            MATERIAL_TOTAL_INDEX,
            OTHER_ITEM_TOTAL_INDEX
        }

        #endregion

        #region Nested type: ESTTOTAL

        private enum ESTTOTAL : byte
        {
            AMOUNT_INDEX,
            TAXAMOUNT_INDEX,
            DESG_CONTIGENCY_INDEX
        }

        #endregion


        internal bool isExistsAddendum(int projectEstimateID)
        {
            try
            {
                //object AddendumCount = ComponentHelper.Instance.ExecuteScalar(&quot;select 1 from estmatebidlettinginfo where Type = &#39;Addendum&#39; and ProjectestimateID = &quot; + projectEstimateID);
                object AddendumCount = ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTIMATECheckIfAddendumExists, null, projectEstimateID);
                return (AddendumCount.ToInt32_2() == 1);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal int DeleteCORITEMDetail(int ParentInstanceID, string ModuleID, int Error)
        {
            try
            {
                Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
                int rows = ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(EstimatorStoredProcedure.usp_DeleteCORITEMItemDetails, dic, ParentInstanceID, ModuleID);

                if (dic != null &amp;&amp; dic.ContainsKey(&quot;Error&quot;))
                    Error = dic[&quot;Error&quot;].ToInt32_2();
                else
                    Error = 0;

                return rows;
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        public bool BidBelongsToBidder(int CurrentUserId, int bidID)
        {
            try
            {
                //object BidBelongsToBidder = ComponentHelper.Instance.ExecuteScalar(&quot;select 1 from ESTMATEBidInfo BI LEFT OUTER JOIN LIBRARYContractors C on c.ID = BI.ContractorId where C.ContractorLoginID  = &quot; + CurrentUserId.ToString() + &quot; and BidId =  &quot; + bidID.ToString());
                object BidBelongsToBidder = ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATEGetAddendumItemsCount, null, CurrentUserId, bidID);
                return (BidBelongsToBidder.ToInt32_2() == 1);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal object GetEstimateBidSettings(int projectEstimateID, string EstBidSettingName)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_GetEstimateBidSettings, null, projectEstimateID, EstBidSettingName);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }
        internal object GetEstmateInfo(int projectid)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTIMATEGetFirstEstimateOfProject, null, projectid);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }
        internal object GetEstmateInfoEstimate(string EstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATEGetEstimateIDFromName, null, EstimateID);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }
        internal object GetProjectName(int ProjectEstimateID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTIMATEGetProjectName, null, ProjectEstimateID);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }
        internal object CUBidInformation(int BidID, string Remarks, int projectID, int ProjectEstimateID, string ModifiedBy)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteScalar(EstimatorStoredProcedure.usp_ESTMATECUBidInformation, null, BidID, Remarks, projectID, ProjectEstimateID, ModifiedBy);
            }
            catch (Exception exception)
            {
                Logger.Log(Enumerations.LogType.Error, exception.Message, &quot;ESTMATE&quot;);
                throw;
            }
        }

        internal object GetPIDFromEstimateId(int id)
        {
            return ComponentHelper.Instance.ExecuteScalar(
                       EstimatorStoredProcedure.usp_ESTMATEGetPIDFromContractId, null, id);
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[25,9,25,84,1],[26,9,26,62,1],[30,13,30,14,1],[31,17,31,30,1],[32,17,32,18,1],[33,21,33,39,1],[33,40,33,92,1],[34,21,34,82,1],[35,21,35,60,1],[36,25,36,64,1],[37,29,37,80,1],[39,21,39,50,1],[41,13,41,14,1],[44,9,44,56,1],[46,9,46,36,1],[47,9,47,10,1],[49,9,49,10,1],[52,9,52,10,1],[54,13,54,14,1],[55,24,55,89,1],[56,17,56,18,1],[57,21,57,96,1],[58,21,58,87,1],[59,21,59,97,1],[60,21,60,85,1],[61,21,61,42,1],[62,25,62,89,1],[64,21,64,66,1],[67,13,67,33,0],[68,13,68,14,0],[69,17,69,79,0],[70,17,70,23,0],[72,9,72,10,1],[75,9,75,10,0],[77,13,77,14,0],[78,24,78,89,0],[79,17,79,18,0],[80,21,80,98,0],[81,21,81,95,0],[82,21,82,103,0],[83,21,83,87,0],[84,21,84,102,0],[85,21,85,112,0],[86,21,86,107,0],[87,21,87,101,0],[88,21,88,112,0],[89,21,89,106,0],[90,21,90,106,0],[91,21,91,94,0],[92,21,92,101,0],[93,21,93,98,0],[94,21,94,106,0],[95,21,95,107,0],[96,21,96,113,0],[97,21,97,100,0],[98,21,98,77,0],[99,21,99,112,0],[100,21,100,125,0],[101,21,101,50,0],[102,21,102,89,0],[103,21,103,40,0],[104,21,104,22,0],[106,25,106,93,0],[107,25,107,107,0],[108,25,108,54,0],[110,25,110,32,0],[110,34,110,51,0],[110,52,110,54,0],[110,55,110,72,0],[111,25,111,26,0],[112,29,112,92,0],[113,29,113,111,0],[114,29,114,106,0],[115,29,115,111,0],[116,29,116,94,0],[117,29,117,58,0],[118,25,118,26,0],[119,21,119,22,0],[120,21,120,37,0],[123,13,123,33,0],[124,13,124,14,0],[125,17,125,79,0],[126,17,126,23,0],[128,9,128,10,0],[131,9,131,10,0],[133,13,133,14,0],[134,24,134,89,0],[135,17,135,18,0],[136,21,136,98,0],[137,21,137,92,0],[138,21,138,99,0],[139,21,139,102,0],[140,21,140,112,0],[141,21,141,112,0],[142,21,142,106,0],[143,21,143,106,0],[144,21,144,107,0],[145,21,145,111,0],[146,21,146,101,0],[147,21,147,94,0],[148,21,148,101,0],[149,21,149,98,0],[150,21,150,106,0],[151,21,151,107,0],[152,21,152,113,0],[153,21,153,111,0],[154,21,154,100,0],[155,21,155,112,0],[156,21,156,103,0],[157,21,157,125,0],[158,21,158,77,0],[159,21,159,50,0],[160,21,160,102,0],[161,21,161,51,0],[162,21,162,22,0],[163,25,163,32,0],[163,34,163,51,0],[163,52,163,54,0],[163,55,163,72,0],[164,25,164,26,0],[165,29,165,92,0],[167,29,167,103,0],[168,29,168,106,0],[169,29,169,111,0],[170,29,170,94,0],[171,29,171,58,0],[172,25,172,26,0],[173,21,173,22,0],[174,21,174,38,0],[177,13,177,33,0],[178,13,178,14,0],[179,17,179,79,0],[180,17,180,23,0],[182,9,182,10,0],[185,9,185,10,0],[187,13,187,14,0],[188,24,188,89,0],[189,17,189,18,0],[190,21,190,66,0],[191,21,191,99,0],[192,21,192,95,0],[193,21,193,83,0],[194,21,194,50,0],[195,21,195,22,0],[196,25,196,32,0],[196,34,196,44,0],[196,45,196,47,0],[196,48,196,64,0],[197,25,197,26,0],[198,29,198,106,0],[199,25,199,26,0],[200,21,200,22,0],[201,21,201,34,0],[204,13,204,33,0],[205,13,205,14,0],[206,17,206,79,0],[207,17,207,23,0],[209,9,209,10,0],[212,9,212,10,0],[214,13,214,14,0],[215,24,215,89,0],[216,17,216,18,0],[217,21,217,69,0],[219,21,219,99,0],[220,21,220,100,0],[221,21,221,77,0],[223,21,223,85,0],[226,21,226,78,0],[227,21,227,51,0],[228,21,228,22,0],[229,25,229,51,0],[230,25,230,81,0],[231,25,231,83,0],[232,25,232,93,0],[234,25,234,73,0],[235,25,235,85,0],[236,25,236,93,0],[237,25,237,96,0],[239,25,239,74,0],[240,25,240,85,0],[241,25,241,87,0],[242,25,242,87,0],[243,25,243,79,0],[245,25,245,87,0],[246,25,246,60,0],[247,25,247,89,0],[248,25,248,64,0],[249,25,249,98,0],[250,25,250,92,0],[251,25,253,76,0],[254,25,256,78,0],[257,25,257,85,0],[258,25,258,144,0],[259,25,259,161,0],[260,25,260,90,0],[261,21,261,22,0],[263,21,263,51,0],[264,21,264,22,0],[265,25,265,32,0],[265,34,265,50,0],[265,51,265,53,0],[265,54,265,68,0],[266,25,266,26,0],[267,29,269,73,0],[270,25,270,26,0],[271,21,271,22,0],[273,21,273,51,0],[274,21,274,22,0],[275,25,275,51,0],[276,25,276,98,0],[277,21,277,22,0],[279,21,279,72,0],[280,21,280,41,0],[283,13,283,33,0],[284,13,284,14,0],[285,17,285,79,0],[286,17,286,23,0],[288,9,288,10,0],[291,9,291,10,0],[293,13,293,14,0],[294,24,294,89,0],[295,17,295,18,0],[296,21,296,93,0],[297,21,297,100,0],[298,21,298,77,0],[299,21,299,66,0],[302,13,302,33,0],[303,13,303,14,0],[304,17,304,79,0],[305,17,305,23,0],[307,9,307,10,0],[310,9,310,10,0],[312,13,312,14,0],[313,24,313,89,0],[314,17,314,18,0],[315,21,315,92,0],[316,21,316,99,0],[317,21,317,77,0],[318,21,318,50,0],[319,21,319,93,0],[322,13,322,33,0],[323,13,323,14,0],[324,17,324,79,0],[325,17,325,23,0],[327,9,327,10,0],[330,9,330,10,0],[332,13,332,14,0],[333,24,333,89,0],[334,17,334,18,0],[335,21,335,95,0],[336,21,336,103,0],[337,21,337,77,0],[338,21,338,87,0],[339,21,339,50,0],[341,21,345,36,0],[348,13,348,33,0],[349,13,349,14,0],[350,17,350,79,0],[351,17,351,23,0],[353,9,353,10,0],[356,9,356,10,0],[358,13,358,14,0],[359,24,359,89,0],[360,17,360,18,0],[361,21,361,88,0],[362,21,362,105,0],[363,21,363,97,0],[364,21,364,76,0],[365,21,365,50,0],[366,21,366,92,0],[369,13,369,33,0],[370,13,370,14,0],[371,17,371,79,0],[372,17,372,23,0],[374,9,374,10,0],[377,9,377,10,0],[378,20,378,85,0],[379,13,379,14,0],[380,17,380,89,0],[381,17,381,99,0],[382,17,382,73,0],[383,17,383,62,0],[385,9,385,10,0],[388,9,388,10,0],[389,20,389,85,0],[390,13,390,14,0],[391,17,391,87,0],[392,17,392,89,0],[393,17,394,106,0],[395,17,395,73,0],[396,17,396,46,0],[397,17,397,89,0],[399,9,399,10,0],[402,9,402,10,0],[403,20,403,85,0],[404,13,404,14,0],[406,17,406,18,0],[407,21,407,94,0],[408,21,408,66,0],[410,17,410,37,0],[411,17,411,18,0],[412,21,412,83,0],[413,21,413,27,0],[416,9,416,10,0],[419,9,419,10,0],[421,13,421,14,0],[422,24,422,89,0],[423,17,423,18,0],[424,21,424,96,0],[425,21,425,96,0],[426,21,426,96,0],[427,21,427,92,0],[428,21,428,82,0],[429,21,429,50,0],[430,21,430,98,0],[433,13,433,33,0],[434,13,434,14,0],[435,17,435,79,0],[436,17,436,23,0],[438,9,438,10,0],[442,9,442,10,1],[444,13,444,14,1],[445,24,445,89,1],[446,17,446,18,1],[447,21,447,99,1],[448,21,448,113,1],[449,21,449,108,1],[450,21,450,107,1],[451,21,451,112,1],[452,21,452,105,1],[453,21,453,105,1],[454,21,454,108,1],[455,21,455,100,1],[456,21,456,91,1],[457,21,457,98,1],[458,21,458,68,1],[459,21,460,108,1],[461,25,461,68,1],[462,21,462,64,1],[463,21,463,123,1],[464,21,464,107,1],[467,13,467,40,0],[468,13,468,14,0],[469,17,469,86,0],[470,17,470,23,0],[472,9,472,10,1],[475,9,475,10,0],[477,13,477,14,0],[478,24,478,89,0],[479,17,479,18,0],[480,21,480,100,0],[481,21,481,45,0],[482,21,482,91,0],[483,28,483,75,0],[484,21,484,22,0],[485,25,485,46,0],[486,25,486,26,0],[487,29,487,63,0],[488,25,488,26,0],[489,21,489,22,0],[490,21,490,40,0],[493,13,493,33,0],[494,13,494,14,0],[495,17,495,79,0],[496,17,496,23,0],[498,9,498,10,0],[501,9,501,10,1],[503,13,503,14,1],[504,24,504,89,1],[505,17,505,18,1],[506,21,506,95,1],[507,21,507,103,1],[508,21,508,95,1],[509,21,509,77,1],[510,21,510,62,1],[511,21,511,60,1],[512,25,512,61,0],[513,21,513,53,1],[514,21,514,22,0],[515,25,515,79,0],[516,25,516,56,0],[518,21,518,93,1],[521,13,521,33,0],[522,13,522,14,0],[523,17,523,79,0],[524,17,524,23,0],[526,9,526,10,1],[529,9,529,10,1],[531,13,531,14,1],[532,24,532,89,1],[533,17,533,18,1],[535,21,535,97,1],[536,21,536,103,1],[537,21,537,99,1],[538,21,538,116,1],[539,21,539,152,1],[540,21,540,77,1],[541,21,541,50,1],[542,21,542,93,1],[545,13,545,33,0],[546,13,546,14,0],[547,17,547,79,0],[548,17,548,23,0],[550,9,550,10,1],[553,9,553,10,1],[555,13,555,14,1],[556,24,556,89,1],[557,17,557,18,1],[558,21,558,94,1],[559,21,559,103,1],[560,21,560,81,1],[561,21,561,50,1],[562,21,562,97,1],[563,21,563,57,1],[563,58,563,71,0],[564,21,564,57,1],[567,13,567,33,0],[568,13,568,14,0],[569,17,569,79,0],[570,17,570,23,0],[572,9,572,10,1],[575,9,575,10,1],[577,13,577,14,1],[578,24,578,89,1],[579,17,579,18,1],[580,21,580,98,1],[581,21,581,103,1],[582,21,582,85,1],[583,21,583,50,1],[584,21,584,101,1],[585,21,585,57,1],[585,58,585,71,0],[586,21,586,57,1],[589,13,589,33,0],[590,13,590,14,0],[591,17,591,79,0],[592,17,592,23,0],[594,9,594,10,1],[598,9,598,10,0],[599,13,599,124,0],[600,9,600,10,0],[604,9,604,10,1],[606,13,606,14,1],[607,24,607,89,1],[608,17,608,18,1],[609,21,609,105,1],[611,21,611,76,1],[612,25,612,110,1],[613,21,613,72,1],[614,25,614,108,1],[615,21,615,63,1],[616,25,616,107,1],[617,21,617,60,1],[618,25,618,105,1],[620,21,620,101,1],[621,21,621,118,1],[622,21,622,92,1],[623,21,623,101,1],[624,21,624,92,1],[627,21,629,54,1],[632,13,632,40,0],[633,13,633,14,0],[634,17,634,86,0],[635,17,635,23,0],[637,9,637,10,1],[640,9,640,10,1],[642,13,642,14,1],[643,24,643,89,1],[644,17,644,18,1],[645,21,645,91,1],[647,21,647,101,1],[648,21,648,75,1],[649,21,649,90,1],[650,21,650,82,1],[651,21,651,78,1],[653,21,653,79,1],[656,13,656,33,0],[657,13,657,14,0],[658,17,658,79,0],[659,17,659,23,0],[661,9,661,10,1],[664,9,664,10,0],[666,13,666,14,0],[667,24,667,89,0],[668,17,668,18,0],[669,21,669,95,0],[670,21,670,103,0],[671,21,671,66,0],[674,13,674,33,0],[675,13,675,14,0],[676,17,676,79,0],[677,17,677,23,0],[679,9,679,10,0],[682,9,682,10,1],[684,13,684,14,1],[685,24,685,89,1],[686,17,686,18,1],[687,21,687,91,1],[688,21,688,110,1],[689,21,689,101,1],[690,21,690,105,1],[691,21,691,93,1],[692,21,692,93,1],[693,21,693,93,1],[694,21,694,85,1],[695,21,695,87,1],[696,21,696,83,1],[697,21,697,95,1],[698,21,698,103,1],[699,21,699,83,1],[700,21,700,91,1],[701,21,701,87,1],[702,21,702,119,1],[703,21,703,77,1],[704,21,704,50,1],[705,21,705,93,1],[708,13,708,33,0],[709,13,709,14,0],[710,17,710,79,0],[711,17,711,23,0],[713,9,713,10,1],[716,9,716,10,0],[718,13,718,14,0],[719,24,719,89,0],[720,17,720,18,0],[721,21,721,96,0],[722,21,722,103,0],[723,21,723,79,0],[724,21,724,98,0],[725,21,725,77,0],[726,21,726,50,0],[727,21,727,93,0],[730,13,730,33,0],[731,13,731,14,0],[732,17,732,79,0],[733,17,733,23,0],[735,9,735,10,0],[738,9,738,10,1],[740,13,740,14,1],[741,24,741,89,1],[742,17,742,18,1],[743,21,743,89,1],[744,21,744,103,1],[745,21,745,94,1],[746,21,746,98,1],[747,21,747,76,1],[748,21,748,50,1],[749,21,749,92,1],[752,13,752,33,0],[753,13,753,14,0],[754,17,754,79,0],[755,17,755,23,0],[757,9,757,10,1],[760,9,760,10,0],[762,13,762,14,0],[763,24,763,89,0],[764,17,764,18,0],[765,21,765,100,0],[766,21,766,79,0],[767,21,767,50,0],[768,21,768,66,0],[771,13,771,33,0],[772,13,772,14,0],[773,17,773,79,0],[774,17,774,23,0],[776,9,776,10,0],[779,9,779,10,1],[781,13,781,14,1],[782,24,782,89,1],[783,17,783,18,1],[784,21,784,99,1],[785,21,785,103,1],[786,21,786,98,1],[787,21,787,79,1],[788,21,788,77,1],[789,21,789,50,1],[790,21,790,93,1],[793,13,793,33,0],[794,13,794,14,0],[795,17,795,79,0],[796,17,796,23,0],[798,9,798,10,1],[801,9,801,10,1],[803,13,803,14,1],[804,24,804,89,1],[805,17,805,18,1],[806,21,806,92,1],[807,21,807,79,1],[808,21,809,64,1],[810,21,810,50,1],[811,21,811,80,1],[814,13,814,33,0],[815,13,815,14,0],[816,17,816,79,0],[817,17,817,23,0],[819,9,819,10,1],[822,9,822,10,1],[824,13,824,14,1],[825,24,825,89,1],[826,17,826,18,1],[827,21,827,79,1],[828,21,828,66,1],[831,13,831,33,0],[832,13,832,14,0],[833,17,833,79,0],[834,17,834,23,0],[836,9,836,10,1],[839,9,839,10,1],[841,13,841,14,1],[842,24,842,89,1],[843,17,843,18,1],[844,21,844,93,1],[845,21,845,103,1],[846,21,846,79,1],[847,21,847,87,1],[848,21,848,77,1],[849,21,849,50,1],[850,21,850,93,1],[853,13,853,33,0],[854,13,854,14,0],[855,17,855,79,0],[856,17,856,23,0],[858,9,858,10,1],[861,9,861,10,1],[863,13,863,14,1],[864,24,864,89,1],[865,17,865,18,1],[866,21,866,90,1],[867,21,867,79,1],[868,21,868,77,1],[869,21,869,50,1],[870,21,870,93,1],[873,13,873,33,0],[874,13,874,14,0],[875,17,875,79,0],[876,17,876,23,0],[878,9,878,10,1],[881,9,881,10,0],[883,13,883,14,0],[884,24,884,89,0],[885,17,885,18,0],[886,21,886,92,0],[887,21,887,81,0],[888,21,888,66,0],[891,13,891,33,0],[892,13,892,14,0],[893,17,893,79,0],[894,17,894,23,0],[896,9,896,10,0],[899,9,899,10,0],[901,13,901,14,0],[902,24,902,89,0],[903,17,903,18,0],[904,21,904,94,0],[905,21,905,81,0],[906,21,906,93,0],[907,21,907,77,0],[908,21,908,50,0],[909,21,909,93,0],[912,13,912,33,0],[913,13,913,14,0],[914,17,914,79,0],[915,17,915,23,0],[917,9,917,10,0],[920,9,920,10,0],[922,13,922,14,0],[923,24,923,89,0],[924,17,924,18,0],[925,21,925,95,0],[926,21,926,84,0],[927,21,927,77,0],[928,21,928,50,0],[929,21,929,93,0],[932,13,932,33,0],[933,13,933,14,0],[934,17,934,79,0],[935,17,935,23,0],[937,9,937,10,0],[940,9,940,10,1],[942,13,942,14,1],[943,24,943,89,1],[944,17,944,18,1],[945,21,945,98,1],[946,21,946,103,1],[947,21,947,84,1],[948,21,948,50,1],[949,21,949,100,1],[952,13,952,33,0],[953,13,953,14,0],[954,17,954,79,0],[955,17,955,23,0],[957,9,957,10,1],[959,9,959,10,1],[961,13,961,14,1],[962,24,962,89,1],[963,17,963,18,1],[964,21,964,98,1],[965,21,965,93,1],[966,21,966,85,1],[967,21,967,87,1],[968,21,968,50,1],[969,21,969,88,1],[972,13,972,33,0],[973,13,973,14,0],[974,17,974,79,0],[975,17,975,23,0],[977,9,977,10,1],[979,9,979,10,0],[981,13,981,14,0],[982,24,982,89,0],[983,17,983,18,0],[984,21,984,92,0],[985,21,985,103,0],[986,21,986,79,0],[987,21,987,50,0],[988,21,988,95,0],[991,13,991,33,0],[992,13,992,14,0],[993,17,993,79,0],[994,17,994,23,0],[996,9,996,10,0],[999,9,999,10,0],[1001,13,1001,14,0],[1002,24,1002,89,0],[1003,17,1003,18,0],[1004,21,1004,95,0],[1005,21,1005,103,0],[1006,21,1006,87,0],[1007,21,1007,87,0],[1008,21,1008,76,0],[1009,21,1009,50,0],[1010,21,1010,92,0],[1013,13,1013,33,0],[1014,13,1014,14,0],[1015,17,1015,79,0],[1016,17,1016,23,0],[1018,9,1018,10,0],[1021,9,1021,10,1],[1023,13,1023,14,1],[1024,24,1024,89,1],[1025,17,1025,18,1],[1026,21,1026,106,1],[1027,21,1027,117,1],[1028,21,1028,93,1],[1029,21,1029,80,1],[1032,13,1032,40,0],[1033,13,1033,14,0],[1034,17,1034,86,0],[1035,17,1035,23,0],[1037,9,1037,10,1],[1040,9,1040,10,0],[1042,13,1042,14,0],[1043,24,1043,89,0],[1044,17,1044,18,0],[1045,21,1045,89,0],[1046,21,1046,110,0],[1047,21,1047,97,0],[1048,21,1048,97,0],[1049,21,1049,107,0],[1050,21,1050,102,0],[1051,21,1051,118,0],[1052,21,1052,77,0],[1053,21,1053,84,0],[1054,21,1054,50,0],[1055,21,1055,109,0],[1056,21,1056,93,0],[1059,13,1059,33,0],[1060,13,1060,14,0],[1061,17,1061,79,0],[1062,17,1062,23,0],[1064,9,1064,10,0],[1067,9,1067,10,0],[1069,13,1069,14,0],[1070,24,1070,89,0],[1071,17,1071,18,0],[1072,21,1072,97,0],[1073,21,1073,87,0],[1074,21,1074,89,0],[1075,21,1075,77,0],[1076,21,1076,66,0],[1079,13,1079,33,0],[1080,13,1080,14,0],[1081,17,1081,79,0],[1082,17,1082,23,0],[1084,9,1084,10,0],[1087,9,1087,10,1],[1089,13,1089,14,1],[1090,24,1090,89,1],[1091,17,1091,18,1],[1092,21,1092,52,1],[1093,21,1093,97,1],[1094,21,1094,79,1],[1095,28,1095,75,1],[1096,21,1096,22,1],[1097,25,1097,46,1],[1098,25,1098,26,1],[1099,29,1101,114,1],[1102,29,1104,118,1],[1105,29,1108,108,1],[1109,29,1111,110,1],[1112,29,1114,110,1],[1115,29,1117,110,1],[1118,29,1120,102,1],[1121,29,1123,104,1],[1124,29,1126,100,1],[1127,29,1129,106,1],[1130,29,1132,115,1],[1133,29,1135,100,1],[1136,29,1138,109,1],[1139,29,1141,104,1],[1142,29,1144,101,1],[1146,29,1148,105,1],[1151,25,1151,26,1],[1152,25,1152,40,1],[1153,25,1153,42,1],[1154,21,1154,22,1],[1155,21,1155,35,1],[1158,13,1158,33,0],[1159,13,1159,14,0],[1160,17,1160,79,0],[1161,17,1161,23,0],[1163,9,1163,10,1],[1166,9,1166,10,1],[1168,13,1168,14,1],[1169,24,1169,89,1],[1170,17,1170,18,1],[1171,21,1171,100,1],[1172,21,1172,86,1],[1173,21,1173,101,1],[1174,21,1174,105,1],[1175,21,1175,93,1],[1176,21,1176,93,1],[1177,21,1177,93,1],[1178,21,1178,85,1],[1179,21,1179,87,1],[1180,21,1180,83,1],[1181,21,1181,95,1],[1182,21,1182,103,1],[1183,21,1183,83,1],[1184,21,1184,91,1],[1185,21,1185,87,1],[1186,21,1186,119,1],[1187,21,1187,77,1],[1188,21,1188,50,1],[1189,21,1189,93,1],[1192,13,1192,33,0],[1193,13,1193,14,0],[1194,17,1194,79,0],[1195,17,1195,23,0],[1197,9,1197,10,1],[1200,9,1200,10,0],[1202,13,1202,14,0],[1203,24,1203,89,0],[1204,17,1204,18,0],[1205,21,1205,98,0],[1206,21,1206,103,0],[1207,21,1207,87,0],[1208,21,1208,66,0],[1211,13,1211,33,0],[1212,13,1212,14,0],[1213,17,1213,79,0],[1214,17,1214,23,0],[1216,9,1216,10,0],[1219,9,1219,10,1],[1221,13,1221,14,1],[1222,24,1222,89,1],[1223,17,1223,18,1],[1224,21,1224,94,1],[1225,21,1225,110,1],[1226,21,1226,94,1],[1227,21,1227,109,1],[1228,21,1228,105,1],[1229,21,1229,101,1],[1230,21,1230,95,1],[1231,21,1231,91,1],[1232,21,1232,90,1],[1233,21,1233,97,1],[1234,21,1234,99,1],[1235,21,1235,55,1],[1236,21,1236,22,1],[1237,25,1237,102,1],[1238,21,1238,22,1],[1240,21,1240,22,0],[1241,25,1241,111,0],[1242,21,1242,22,0],[1243,21,1244,102,1],[1245,21,1245,50,1],[1246,21,1246,22,0],[1247,25,1247,97,0],[1248,21,1248,22,0],[1250,21,1250,22,1],[1251,25,1251,101,1],[1252,21,1252,22,1],[1253,21,1253,58,1],[1254,21,1254,22,0],[1255,25,1255,105,0],[1256,21,1256,22,0],[1258,21,1258,22,1],[1259,25,1259,117,1],[1260,21,1260,22,1],[1261,21,1261,58,1],[1262,21,1262,22,0],[1263,25,1263,105,0],[1264,21,1264,22,0],[1266,21,1266,22,1],[1267,25,1267,117,1],[1268,21,1268,22,1],[1269,21,1269,99,1],[1270,21,1270,77,1],[1271,21,1271,50,1],[1272,21,1272,93,1],[1275,13,1275,33,0],[1276,13,1276,14,0],[1277,17,1277,79,0],[1278,17,1278,23,0],[1280,9,1280,10,1],[1284,9,1284,10,0],[1285,13,1285,116,0],[1286,9,1286,10,0],[1290,9,1290,10,1],[1292,13,1292,14,1],[1293,24,1293,89,1],[1294,17,1294,18,1],[1295,21,1295,94,1],[1297,21,1297,76,1],[1298,25,1298,96,1],[1299,21,1299,72,1],[1300,25,1300,94,1],[1301,21,1301,63,1],[1302,25,1302,93,1],[1303,21,1303,60,1],[1304,25,1304,91,0],[1305,21,1305,87,1],[1306,21,1306,79,1],[1307,21,1307,104,1],[1310,21,1310,66,1],[1313,13,1313,33,0],[1314,13,1314,14,0],[1315,17,1315,79,0],[1316,17,1316,23,0],[1318,9,1318,10,1],[1321,9,1321,10,1],[1323,13,1323,14,1],[1324,24,1324,89,1],[1325,17,1325,18,1],[1326,21,1326,94,1],[1328,21,1328,101,1],[1329,21,1329,82,1],[1330,21,1330,78,1],[1332,21,1332,79,1],[1335,13,1335,33,0],[1336,13,1336,14,0],[1337,17,1337,79,0],[1338,17,1338,23,0],[1340,9,1340,10,1],[1343,9,1343,10,1],[1345,13,1345,14,1],[1346,24,1346,89,1],[1347,17,1347,18,1],[1348,21,1348,97,1],[1350,21,1350,73,1],[1351,21,1351,77,1],[1352,21,1352,50,1],[1353,21,1353,93,1],[1356,13,1356,33,0],[1357,13,1357,14,0],[1358,17,1358,79,0],[1359,17,1359,23,0],[1361,9,1361,10,1],[1364,9,1364,10,1],[1366,13,1366,14,1],[1367,24,1367,89,1],[1368,17,1368,18,1],[1369,21,1369,92,1],[1370,21,1370,66,1],[1373,13,1373,33,0],[1374,13,1374,14,0],[1375,17,1375,79,0],[1376,17,1376,23,0],[1378,9,1378,10,1],[1381,9,1381,10,0],[1383,13,1383,14,0],[1384,24,1384,89,0],[1385,17,1385,18,0],[1386,21,1386,96,0],[1387,21,1387,91,0],[1388,21,1388,77,0],[1389,21,1389,50,0],[1390,21,1390,93,0],[1393,13,1393,33,0],[1394,13,1394,14,0],[1395,17,1395,79,0],[1396,17,1396,23,0],[1398,9,1398,10,0],[1401,9,1401,10,0],[1403,13,1403,14,0],[1404,24,1404,89,0],[1405,17,1405,18,0],[1406,21,1406,95,0],[1407,21,1407,90,0],[1408,21,1408,66,0],[1411,13,1411,33,0],[1412,13,1412,14,0],[1413,17,1413,79,0],[1414,17,1414,23,0],[1416,9,1416,10,0],[1419,9,1419,10,1],[1421,13,1421,14,1],[1422,24,1422,89,1],[1423,17,1423,18,1],[1424,21,1424,97,1],[1425,21,1425,103,1],[1426,21,1426,66,1],[1429,13,1429,33,0],[1430,13,1430,14,0],[1431,17,1431,79,0],[1432,17,1432,23,0],[1434,9,1434,10,1],[1437,9,1437,10,1],[1439,13,1439,14,1],[1440,24,1440,89,1],[1441,17,1441,18,1],[1442,21,1442,93,1],[1443,21,1443,110,1],[1444,21,1444,97,1],[1445,21,1445,97,1],[1446,21,1446,96,1],[1447,21,1447,76,1],[1448,21,1448,50,1],[1449,21,1449,92,1],[1452,13,1452,33,0],[1453,13,1453,14,0],[1454,17,1454,79,0],[1455,17,1455,23,0],[1457,9,1457,10,1],[1460,9,1460,10,0],[1462,13,1462,14,0],[1463,24,1463,89,0],[1464,17,1464,18,0],[1465,21,1465,96,0],[1466,21,1466,92,0],[1467,21,1467,110,0],[1468,21,1468,97,0],[1469,21,1469,97,0],[1470,21,1470,96,0],[1471,21,1471,76,0],[1472,21,1472,50,0],[1473,21,1473,92,0],[1476,13,1476,33,0],[1477,13,1477,14,0],[1478,17,1478,79,0],[1479,17,1479,23,0],[1481,9,1481,10,0],[1484,9,1484,10,1],[1486,13,1486,14,1],[1487,24,1487,89,1],[1488,17,1488,18,1],[1489,21,1489,96,1],[1490,21,1490,85,1],[1491,21,1491,103,1],[1492,21,1492,77,1],[1493,21,1493,50,1],[1494,21,1494,93,1],[1497,13,1497,33,0],[1498,13,1498,14,0],[1499,17,1499,79,0],[1500,17,1500,23,0],[1502,9,1502,10,1],[1505,9,1505,10,0],[1507,13,1507,14,0],[1508,24,1508,89,0],[1509,17,1509,18,0],[1512,21,1512,92,0],[1514,21,1514,100,0],[1515,21,1515,78,0],[1517,21,1517,62,0],[1518,21,1518,95,0],[1521,13,1521,40,0],[1522,13,1522,14,0],[1523,17,1523,86,0],[1524,17,1524,23,0],[1526,9,1526,10,0],[1529,9,1529,10,1],[1531,13,1531,14,1],[1532,24,1532,89,1],[1533,17,1533,18,1],[1534,21,1534,112,1],[1535,21,1535,103,1],[1536,21,1536,91,1],[1537,21,1537,64,1],[1538,21,1540,39,1],[1543,13,1543,40,0],[1544,13,1544,14,0],[1545,17,1545,86,0],[1546,17,1546,23,0],[1548,9,1548,10,1],[1552,9,1552,10,0],[1554,13,1554,14,0],[1555,24,1555,89,0],[1556,17,1556,18,0],[1557,21,1557,113,0],[1558,21,1558,115,0],[1559,21,1559,108,0],[1561,21,1561,80,0],[1562,25,1562,109,0],[1564,21,1564,76,0],[1565,25,1565,107,0],[1567,21,1567,43,0],[1568,25,1568,106,0],[1570,21,1570,81,0],[1571,25,1571,110,0],[1573,21,1573,80,0],[1576,13,1576,40,0],[1577,13,1577,14,0],[1578,17,1578,86,0],[1579,17,1579,23,0],[1581,9,1581,10,0],[1584,9,1584,10,0],[1586,13,1586,14,0],[1587,24,1587,89,0],[1588,17,1588,18,0],[1589,21,1589,113,0],[1591,21,1591,111,0],[1592,21,1592,113,0],[1593,21,1593,46,0],[1594,25,1594,110,0],[1596,21,1596,95,0],[1598,21,1598,115,0],[1601,13,1601,40,0],[1602,13,1602,14,0],[1603,17,1603,86,0],[1604,17,1604,23,0],[1606,9,1606,10,0],[1609,9,1609,10,1],[1611,13,1611,14,1],[1612,24,1612,89,1],[1613,17,1613,18,1],[1614,21,1614,110,1],[1616,21,1616,113,1],[1617,21,1617,46,1],[1618,25,1618,110,0],[1620,21,1620,95,1],[1622,21,1622,115,1],[1625,13,1625,40,0],[1626,13,1626,14,0],[1627,17,1627,86,0],[1628,17,1628,23,0],[1630,9,1630,10,1],[1634,9,1634,10,1],[1636,13,1636,14,1],[1637,24,1637,89,1],[1638,17,1638,18,1],[1639,21,1639,110,1],[1640,21,1640,113,1],[1642,21,1642,80,1],[1643,25,1643,109,1],[1645,21,1645,76,1],[1646,25,1646,107,1],[1648,21,1648,43,1],[1649,25,1649,106,0],[1651,21,1651,81,1],[1652,25,1652,110,0],[1654,21,1654,80,1],[1657,13,1657,40,0],[1658,13,1658,14,0],[1659,17,1659,86,0],[1660,17,1660,23,0],[1662,9,1662,10,1],[1665,9,1665,10,0],[1667,13,1667,14,0],[1668,24,1668,89,0],[1669,17,1669,18,0],[1670,21,1670,110,0],[1671,21,1671,58,0],[1672,25,1672,107,0],[1673,21,1673,80,0],[1676,13,1676,40,0],[1677,13,1677,14,0],[1678,17,1678,86,0],[1679,17,1679,23,0],[1681,9,1681,10,0],[1684,9,1684,10,1],[1686,13,1686,14,1],[1687,24,1687,89,1],[1688,17,1688,18,1],[1689,21,1689,110,1],[1690,21,1690,117,1],[1691,21,1691,91,1],[1692,21,1692,64,1],[1693,21,1693,107,1],[1696,13,1696,40,0],[1697,13,1697,14,0],[1698,17,1698,86,0],[1699,17,1699,23,0],[1701,9,1701,10,1],[1704,9,1704,10,1],[1706,13,1706,14,1],[1707,24,1707,89,1],[1708,17,1708,18,1],[1709,21,1709,110,1],[1710,21,1710,87,1],[1711,21,1711,117,1],[1712,21,1712,80,1],[1715,13,1715,40,0],[1716,13,1716,14,0],[1717,17,1717,86,0],[1718,17,1718,23,0],[1720,9,1720,10,1],[1723,9,1723,10,1],[1725,13,1725,14,1],[1726,24,1726,89,1],[1727,17,1727,18,1],[1731,21,1731,94,1],[1732,21,1732,103,1],[1733,21,1733,94,1],[1734,21,1734,76,1],[1736,21,1736,62,1],[1737,21,1737,67,1],[1740,13,1740,40,0],[1741,13,1741,14,0],[1742,17,1742,86,0],[1743,17,1743,23,0],[1745,9,1745,10,1],[1748,9,1748,10,1],[1750,13,1750,14,1],[1751,24,1751,89,1],[1752,17,1752,18,1],[1753,21,1753,48,1],[1754,21,1754,113,1],[1755,21,1755,100,1],[1756,21,1756,106,1],[1757,28,1757,89,1],[1758,21,1758,22,1],[1759,25,1759,46,1],[1760,25,1760,26,1],[1761,29,1761,84,1],[1762,25,1762,26,1],[1763,21,1763,22,1],[1764,21,1764,33,1],[1767,13,1767,40,0],[1768,13,1768,14,0],[1769,17,1769,86,0],[1770,17,1770,23,0],[1772,9,1772,10,1],[1775,9,1775,10,1],[1777,13,1777,14,1],[1778,17,1778,77,1],[1798,13,1798,40,0],[1799,13,1799,14,0],[1800,17,1800,86,0],[1801,17,1801,23,0],[1803,9,1803,10,1],[1806,9,1806,10,1],[1808,13,1808,14,1],[1809,24,1809,89,1],[1810,17,1810,18,1],[1811,21,1811,112,1],[1812,21,1812,60,1],[1813,21,1813,22,1],[1814,25,1814,107,1],[1815,21,1815,22,1],[1816,21,1816,80,1],[1819,13,1819,40,0],[1820,13,1820,14,0],[1821,17,1821,86,0],[1822,17,1822,23,0],[1824,9,1824,10,1],[1827,9,1827,10,1],[1829,13,1829,14,1],[1830,24,1830,89,1],[1831,17,1831,18,1],[1832,21,1832,110,1],[1833,21,1833,80,1],[1836,13,1836,40,0],[1837,13,1837,14,0],[1838,17,1838,86,0],[1839,17,1839,23,0],[1841,9,1841,10,1],[1844,9,1844,10,1],[1846,13,1846,14,1],[1847,24,1847,89,1],[1848,17,1848,18,1],[1849,21,1849,111,1],[1850,21,1850,124,1],[1851,21,1851,110,1],[1852,21,1852,108,1],[1853,21,1853,123,1],[1854,21,1854,119,1],[1855,21,1855,115,1],[1856,21,1856,109,1],[1857,21,1857,105,1],[1858,21,1858,113,1],[1859,21,1859,103,1],[1860,21,1860,111,1],[1861,21,1861,55,1],[1862,21,1862,22,1],[1863,25,1863,116,1],[1864,21,1864,22,1],[1866,21,1866,22,0],[1867,25,1867,125,0],[1868,21,1868,22,0],[1869,21,1869,50,1],[1870,21,1870,22,0],[1871,25,1871,111,0],[1872,21,1872,22,0],[1874,21,1874,22,1],[1875,25,1875,115,1],[1876,21,1876,22,1],[1877,21,1877,58,1],[1878,21,1878,22,0],[1879,25,1879,119,0],[1880,21,1880,22,0],[1882,21,1882,22,1],[1883,25,1883,131,1],[1884,21,1884,22,1],[1885,21,1885,58,1],[1886,21,1886,22,0],[1887,25,1887,119,0],[1888,21,1888,22,0],[1890,21,1890,22,1],[1891,25,1891,131,1],[1892,21,1892,22,1],[1893,21,1893,113,1],[1894,21,1894,90,1],[1895,21,1895,68,1],[1896,21,1897,108,1],[1898,25,1898,68,1],[1899,21,1899,64,1],[1900,21,1900,106,1],[1903,13,1903,40,0],[1904,13,1904,14,0],[1905,17,1905,86,0],[1906,17,1906,23,0],[1908,9,1908,10,1],[1911,9,1911,10,1],[1913,13,1913,14,1],[1914,24,1914,89,1],[1915,17,1915,18,1],[1916,21,1916,95,1],[1917,21,1917,103,1],[1919,21,1919,67,1],[1920,21,1920,62,1],[1921,21,1921,67,1],[1924,13,1924,40,0],[1925,13,1925,14,0],[1926,17,1926,86,0],[1927,17,1927,23,0],[1929,9,1929,10,1],[1932,9,1932,10,0],[1934,13,1934,14,0],[1935,24,1935,89,0],[1936,17,1936,18,0],[1937,21,1937,114,0],[1939,21,1939,124,0],[1940,21,1940,103,0],[1941,21,1941,109,0],[1942,21,1942,116,0],[1943,21,1943,108,0],[1944,21,1944,106,0],[1945,21,1945,120,0],[1946,21,1946,90,0],[1947,21,1947,64,0],[1948,21,1948,106,0],[1951,13,1951,40,0],[1952,13,1952,14,0],[1953,17,1953,86,0],[1954,17,1954,23,0],[1956,9,1956,10,0],[1959,9,1959,10,0],[1961,13,1961,14,0],[1962,24,1962,89,0],[1963,17,1963,18,0],[1964,21,1964,113,0],[1965,21,1965,121,0],[1966,21,1966,124,0],[1967,21,1967,103,0],[1968,21,1968,109,0],[1969,21,1969,116,0],[1970,21,1970,106,0],[1971,21,1971,90,0],[1972,21,1972,64,0],[1973,21,1973,106,0],[1976,13,1976,40,0],[1977,13,1977,14,0],[1978,17,1978,86,0],[1979,17,1979,23,0],[1981,9,1981,10,0],[1984,9,1984,10,0],[1986,13,1986,14,0],[1987,24,1987,89,0],[1988,17,1988,18,0],[1989,21,1989,111,0],[1990,21,1990,109,0],[1991,21,1991,90,0],[1992,21,1992,64,0],[1993,21,1993,106,0],[1996,13,1996,40,0],[1997,13,1997,14,0],[1998,17,1998,86,0],[1999,17,1999,23,0],[2001,9,2001,10,0],[2004,9,2004,10,0],[2006,13,2006,14,0],[2007,24,2007,89,0],[2008,17,2008,18,0],[2009,21,2009,113,0],[2010,21,2010,101,0],[2011,21,2011,90,0],[2012,21,2012,80,0],[2015,13,2015,40,0],[2016,13,2016,14,0],[2017,17,2017,86,0],[2018,17,2018,23,0],[2020,9,2020,10,0],[2023,9,2023,10,0],[2025,13,2025,14,0],[2026,24,2026,89,0],[2027,17,2027,18,0],[2028,21,2028,92,0],[2029,21,2029,103,0],[2030,21,2030,79,0],[2031,21,2031,50,0],[2032,21,2032,95,0],[2035,13,2035,33,0],[2036,13,2036,14,0],[2037,17,2037,79,0],[2038,17,2038,23,0],[2040,9,2040,10,0],[2043,9,2043,10,0],[2045,13,2045,14,0],[2046,24,2046,89,0],[2047,17,2047,18,0],[2048,21,2048,96,0],[2049,21,2049,87,0],[2050,21,2050,79,0],[2051,21,2051,66,0],[2054,13,2054,33,0],[2055,13,2055,14,0],[2056,17,2056,79,0],[2057,17,2057,23,0],[2059,9,2059,10,0],[2062,9,2062,10,0],[2064,13,2064,14,0],[2065,24,2065,89,0],[2066,17,2066,18,0],[2067,21,2067,97,0],[2068,21,2068,87,0],[2069,21,2069,66,0],[2072,13,2072,33,0],[2073,13,2073,14,0],[2074,17,2074,79,0],[2075,17,2075,23,0],[2077,9,2077,10,0],[2080,9,2080,10,1],[2082,13,2082,14,1],[2083,24,2083,89,1],[2084,17,2084,18,1],[2085,21,2085,100,1],[2087,21,2087,76,1],[2088,25,2088,95,1],[2090,21,2090,72,1],[2091,25,2091,93,1],[2093,21,2093,43,1],[2094,25,2094,92,1],[2096,21,2096,77,1],[2097,25,2097,96,0],[2099,21,2099,66,1],[2102,13,2102,33,0],[2103,13,2103,14,0],[2104,17,2104,79,0],[2105,17,2105,23,0],[2107,9,2107,10,1],[2110,9,2110,10,1],[2112,13,2112,14,1],[2113,24,2113,89,1],[2114,17,2114,18,1],[2115,21,2115,100,1],[2116,21,2116,81,1],[2118,21,2118,61,1],[2119,25,2119,96,0],[2121,21,2121,89,1],[2124,13,2124,33,0],[2125,13,2125,14,0],[2126,17,2126,79,0],[2127,17,2127,23,0],[2129,9,2129,10,1],[2132,9,2132,10,0],[2134,13,2134,14,0],[2135,24,2135,89,0],[2136,17,2136,18,0],[2137,21,2142,68,0],[2143,21,2143,62,0],[2144,21,2144,109,0],[2147,13,2147,33,0],[2148,13,2148,14,0],[2149,17,2149,79,0],[2150,17,2150,23,0],[2152,9,2152,10,0],[2155,9,2155,10,0],[2157,13,2157,14,0],[2158,24,2158,89,0],[2159,17,2159,18,0],[2160,21,2160,94,0],[2161,21,2161,103,0],[2162,21,2162,77,0],[2163,21,2163,83,0],[2164,21,2164,48,0],[2166,21,2166,51,0],[2167,21,2167,89,0],[2168,21,2168,93,0],[2169,21,2169,38,0],[2172,13,2172,33,0],[2173,13,2173,14,0],[2174,17,2174,79,0],[2175,17,2175,23,0],[2177,9,2177,10,0],[2180,9,2180,10,0],[2182,13,2182,14,0],[2183,24,2183,89,0],[2184,17,2184,18,0],[2185,21,2185,93,0],[2186,21,2186,103,0],[2187,21,2187,80,0],[2188,21,2188,50,0],[2189,21,2189,96,0],[2192,13,2192,33,0],[2193,13,2193,14,0],[2194,17,2194,79,0],[2195,17,2195,23,0],[2197,9,2197,10,0],[2200,9,2200,10,0],[2202,13,2202,14,0],[2203,24,2203,89,0],[2204,17,2204,18,0],[2205,21,2205,99,0],[2206,21,2206,103,0],[2207,21,2207,89,0],[2208,21,2208,77,0],[2209,21,2209,50,0],[2210,21,2210,93,0],[2213,13,2213,33,0],[2214,13,2214,14,0],[2215,17,2215,79,0],[2216,17,2216,23,0],[2218,9,2218,10,0],[2221,9,2221,10,1],[2223,13,2223,14,1],[2224,24,2224,89,1],[2225,17,2225,18,1],[2226,21,2226,56,1],[2228,21,2228,95,1],[2229,21,2229,87,1],[2230,21,2230,85,1],[2231,21,2231,103,1],[2232,21,2232,83,1],[2233,21,2233,84,1],[2234,21,2234,79,1],[2236,21,2236,66,1],[2238,21,2238,55,1],[2239,21,2239,55,1],[2240,21,2240,55,1],[2241,21,2241,55,1],[2242,21,2242,55,1],[2243,21,2243,55,1],[2245,21,2245,40,1],[2248,13,2248,33,0],[2249,13,2249,14,0],[2250,17,2250,79,0],[2251,17,2251,23,0],[2253,9,2253,10,1],[2256,9,2256,10,0],[2258,13,2258,14,0],[2259,24,2259,89,0],[2260,17,2260,18,0],[2261,21,2261,94,0],[2262,21,2262,103,0],[2263,21,2263,66,0],[2266,13,2266,33,0],[2267,13,2267,14,0],[2268,17,2268,79,0],[2269,17,2269,23,0],[2271,9,2271,10,0],[2274,9,2274,10,0],[2276,13,2276,14,0],[2277,24,2277,89,0],[2278,17,2278,18,0],[2279,21,2279,92,0],[2280,21,2280,103,0],[2281,21,2281,96,0],[2282,21,2282,94,0],[2283,21,2283,78,0],[2284,21,2284,66,0],[2287,13,2287,33,0],[2288,13,2288,14,0],[2289,17,2289,79,0],[2290,17,2290,23,0],[2292,9,2292,10,0],[2295,9,2295,10,0],[2297,13,2297,14,0],[2298,24,2298,89,0],[2299,17,2299,18,0],[2300,21,2300,98,0],[2301,21,2301,103,0],[2302,21,2302,66,0],[2305,13,2305,33,0],[2306,13,2306,14,0],[2307,17,2307,79,0],[2308,17,2308,23,0],[2310,9,2310,10,0],[2313,9,2313,10,0],[2315,13,2315,14,0],[2316,24,2316,89,0],[2317,17,2317,18,0],[2318,21,2318,108,0],[2319,21,2319,103,0],[2320,21,2320,66,0],[2323,13,2323,33,0],[2324,13,2324,14,0],[2325,17,2325,79,0],[2326,17,2326,23,0],[2328,9,2328,10,0],[2331,9,2331,10,0],[2333,13,2333,14,0],[2334,24,2334,89,0],[2335,17,2335,18,0],[2336,21,2336,104,0],[2337,21,2337,103,0],[2338,21,2338,66,0],[2341,13,2341,33,0],[2342,13,2342,14,0],[2343,17,2343,79,0],[2344,17,2344,23,0],[2346,9,2346,10,0],[2349,9,2349,10,0],[2351,13,2351,14,0],[2352,24,2352,89,0],[2353,17,2353,18,0],[2354,21,2354,98,0],[2355,21,2355,103,0],[2356,21,2356,66,0],[2359,13,2359,33,0],[2360,13,2360,14,0],[2361,17,2361,79,0],[2362,17,2362,23,0],[2364,9,2364,10,0],[2367,9,2367,10,0],[2369,13,2369,14,0],[2370,24,2370,89,0],[2371,17,2371,18,0],[2372,21,2372,98,0],[2373,21,2373,103,0],[2374,21,2374,66,0],[2377,13,2377,33,0],[2378,13,2378,14,0],[2379,17,2379,79,0],[2380,17,2380,23,0],[2382,9,2382,10,0],[2385,9,2385,10,0],[2387,13,2387,14,0],[2388,24,2388,89,0],[2389,17,2389,18,0],[2390,21,2390,98,0],[2391,21,2391,103,0],[2392,21,2392,66,0],[2395,13,2395,33,0],[2396,13,2396,14,0],[2397,17,2397,79,0],[2398,17,2398,23,0],[2400,9,2400,10,0],[2403,9,2403,10,0],[2405,13,2405,14,0],[2406,24,2406,89,0],[2407,17,2407,18,0],[2408,21,2408,98,0],[2409,21,2409,103,0],[2410,21,2410,89,0],[2411,21,2411,66,0],[2414,13,2414,33,0],[2415,13,2415,14,0],[2416,17,2416,79,0],[2417,17,2417,23,0],[2419,9,2419,10,0],[2422,9,2422,10,0],[2424,13,2424,14,0],[2425,24,2425,89,0],[2426,17,2426,18,0],[2427,21,2427,93,0],[2428,21,2428,103,0],[2429,21,2429,66,0],[2432,13,2432,33,0],[2433,13,2433,14,0],[2434,17,2434,79,0],[2435,17,2435,23,0],[2437,9,2437,10,0],[2446,9,2446,10,0],[2448,13,2448,14,0],[2449,24,2449,89,0],[2450,17,2450,18,0],[2451,21,2451,98,0],[2452,21,2452,103,0],[2453,21,2453,88,0],[2454,21,2454,86,0],[2455,21,2455,88,0],[2456,21,2456,78,0],[2457,21,2457,92,0],[2458,21,2458,56,0],[2461,13,2461,33,0],[2462,13,2462,14,0],[2463,17,2463,79,0],[2464,17,2464,23,0],[2466,9,2466,10,0],[2471,9,2471,10,1],[2473,13,2473,14,1],[2474,17,2474,93,1],[2475,17,2477,108,1],[2479,17,2483,94,1],[2484,17,2484,48,1],[2485,17,2485,31,1],[2486,17,2486,113,1],[2487,17,2487,18,0],[2488,21,2488,41,0],[2491,17,2491,18,1],[2492,28,2492,93,1],[2493,21,2493,22,1],[2494,25,2494,99,1],[2496,25,2496,80,1],[2497,25,2497,26,1],[2498,29,2498,100,1],[2499,25,2499,26,1],[2500,25,2500,76,1],[2501,25,2501,26,1],[2502,29,2502,98,1],[2503,25,2503,26,1],[2504,25,2504,47,1],[2505,25,2505,26,0],[2506,29,2506,97,0],[2507,25,2507,26,0],[2508,25,2508,81,1],[2509,25,2509,26,0],[2510,29,2510,101,0],[2511,25,2511,26,0],[2512,25,2512,50,1],[2513,25,2513,26,0],[2514,29,2514,103,0],[2515,25,2515,26,0],[2517,25,2517,70,1],[2521,13,2521,33,0],[2522,13,2522,14,0],[2523,17,2523,26,0],[2525,9,2525,10,1],[2528,9,2528,10,1],[2530,13,2530,14,1],[2531,17,2531,93,1],[2532,17,2534,108,1],[2535,17,2538,111,1],[2540,17,2540,48,1],[2541,17,2541,31,1],[2542,17,2542,113,1],[2543,17,2543,18,0],[2544,21,2544,34,0],[2547,17,2547,18,1],[2548,28,2548,93,1],[2549,21,2549,22,1],[2550,25,2550,99,1],[2552,25,2552,50,1],[2553,25,2553,26,0],[2554,29,2554,101,0],[2555,25,2555,26,0],[2557,25,2557,86,1],[2559,25,2559,83,1],[2563,13,2563,33,0],[2564,13,2564,14,0],[2565,17,2565,26,0],[2567,9,2567,10,1],[2570,9,2570,10,0],[2571,20,2571,85,0],[2572,13,2572,14,0],[2573,17,2573,89,0],[2575,17,2575,78,0],[2577,17,2577,75,0],[2579,9,2579,10,0],[2582,9,2582,10,1],[2583,20,2583,85,1],[2584,13,2584,14,1],[2585,17,2585,94,1],[2586,17,2586,86,1],[2587,17,2587,82,1],[2589,17,2589,62,1],[2591,9,2591,10,1],[2594,9,2594,10,0],[2595,20,2595,85,0],[2596,13,2596,14,0],[2597,17,2597,88,0],[2599,17,2599,83,0],[2600,17,2600,94,0],[2601,17,2601,94,0],[2602,17,2602,115,0],[2604,17,2604,52,0],[2606,9,2606,10,0],[2609,9,2609,10,0],[2610,20,2610,85,0],[2611,13,2611,14,0],[2612,17,2612,93,0],[2613,17,2613,91,0],[2615,17,2615,62,0],[2617,9,2617,10,0],[2620,9,2620,10,0],[2621,13,2622,72,0],[2623,9,2623,10,0],[2626,9,2626,10,1],[2627,13,2627,79,1],[2628,13,2628,155,1],[2630,13,2630,69,1],[2631,17,2631,61,1],[2633,17,2633,26,0],[2634,9,2634,10,1],[2637,9,2637,10,0],[2638,13,2638,157,0],[2639,9,2639,10,0],[2642,9,2642,10,1],[2644,13,2644,14,1],[2645,17,2645,156,1],[2647,13,2647,40,0],[2648,13,2648,14,0],[2649,17,2649,86,0],[2650,17,2650,23,0],[2652,9,2652,10,1],[2655,9,2655,10,1],[2657,13,2657,14,1],[2658,17,2658,138,1],[2660,13,2660,40,0],[2661,13,2661,14,0],[2662,17,2662,86,0],[2663,17,2663,23,0],[2665,9,2665,10,1],[2668,9,2668,10,0],[2670,13,2670,14,0],[2671,17,2671,166,0],[2672,13,2672,14,0],[2673,13,2673,40,0],[2674,13,2674,14,0],[2675,17,2675,86,0],[2676,17,2676,23,0],[2678,9,2678,10,0],[2681,9,2681,10,0],[2683,13,2683,14,0],[2684,17,2684,146,0],[2686,13,2686,40,0],[2687,13,2687,14,0],[2688,17,2688,86,0],[2689,17,2689,23,0],[2691,9,2691,10,0],[2694,9,2694,10,1],[2696,13,2696,14,1],[2697,17,2697,140,1],[2699,13,2699,40,0],[2700,13,2700,14,0],[2701,17,2701,86,0],[2702,17,2702,23,0],[2704,9,2704,10,1],[2707,9,2707,10,0],[2709,13,2709,14,0],[2710,17,2710,119,0],[2712,13,2712,40,0],[2713,13,2713,14,0],[2714,17,2714,86,0],[2715,17,2715,23,0],[2717,9,2717,10,0],[2720,9,2720,10,1],[2722,13,2722,14,1],[2723,17,2723,158,1],[2725,13,2725,40,0],[2726,13,2726,14,0],[2727,17,2727,86,0],[2728,17,2728,23,0],[2730,9,2730,10,1],[2733,9,2733,10,0],[2735,13,2735,14,0],[2737,17,2737,164,0],[2738,17,2738,55,0],[2740,13,2740,40,0],[2741,13,2741,14,0],[2742,17,2742,86,0],[2743,17,2743,23,0],[2745,9,2745,10,0],[2748,9,2748,10,0],[2749,13,2750,85,0],[2751,9,2751,10,0],[2754,9,2754,10,0],[2756,13,2756,14,0],[2757,17,2758,104,0],[2759,17,2759,48,0],[2761,13,2761,40,0],[2762,13,2762,14,0],[2763,17,2763,86,0],[2764,17,2764,23,0],[2766,9,2766,10,0],[2768,9,2768,10,1],[2770,13,2770,14,1],[2771,17,2771,162,1],[2773,13,2773,40,0],[2774,13,2774,14,0],[2775,17,2775,86,0],[2776,17,2776,23,0],[2778,9,2778,10,1],[2781,9,2781,10,0],[2783,13,2783,14,0],[2784,24,2784,89,0],[2785,17,2785,18,0],[2786,21,2786,92,0],[2787,21,2787,89,0],[2788,21,2788,56,0],[2791,13,2791,33,0],[2792,13,2792,14,0],[2793,17,2793,79,0],[2794,17,2794,23,0],[2796,9,2796,10,0],[2849,9,2849,10,0],[2851,13,2851,14,0],[2853,17,2853,164,0],[2854,17,2854,57,0],[2856,13,2856,40,0],[2857,13,2857,14,0],[2858,17,2858,86,0],[2859,17,2859,23,0],[2861,9,2861,10,0],[2864,9,2864,10,0],[2866,13,2866,14,0],[2867,17,2867,83,0],[2868,17,2868,179,0],[2870,17,2870,61,0],[2871,21,2871,54,0],[2873,21,2873,31,0],[2875,17,2875,29,0],[2877,13,2877,40,0],[2878,13,2878,14,0],[2879,17,2879,86,0],[2880,17,2880,23,0],[2882,9,2882,10,0],[2885,9,2885,10,0],[2887,13,2887,14,0],[2889,17,2889,171,0],[2890,17,2890,62,0],[2892,13,2892,33,0],[2893,13,2893,14,0],[2894,17,2894,79,0],[2895,17,2895,23,0],[2897,9,2897,10,0],[2900,9,2900,10,1],[2902,13,2902,14,1],[2903,17,2903,160,1],[2905,13,2905,40,0],[2906,13,2906,14,0],[2907,17,2907,86,0],[2908,17,2908,23,0],[2910,9,2910,10,1],[2912,9,2912,10,1],[2914,13,2914,14,1],[2915,17,2915,144,1],[2917,13,2917,40,0],[2918,13,2918,14,0],[2919,17,2919,86,0],[2920,17,2920,23,0],[2922,9,2922,10,1],[2924,9,2924,10,1],[2926,13,2926,14,1],[2927,17,2927,140,1],[2929,13,2929,40,0],[2930,13,2930,14,0],[2931,17,2931,86,0],[2932,17,2932,23,0],[2934,9,2934,10,1],[2936,9,2936,10,0],[2938,13,2938,14,0],[2939,17,2939,141,0],[2941,13,2941,40,0],[2942,13,2942,14,0],[2943,17,2943,86,0],[2944,17,2944,23,0],[2946,9,2946,10,0],[2948,9,2948,10,0],[2950,13,2950,14,0],[2951,17,2951,181,0],[2953,13,2953,40,0],[2954,13,2954,14,0],[2955,17,2955,86,0],[2956,17,2956,23,0],[2958,9,2958,10,0],[2961,9,2961,10,1],[2962,13,2963,92,1],[2964,9,2964,10,1]]);
    </script>
  </body>
</html>