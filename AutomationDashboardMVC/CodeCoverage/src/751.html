<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\Utility\CoreDatabaseHelper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.DataAccess.Core;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common.Utility;
using System;
using System.Collections;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;
using System.Drawing;
using System.Drawing.Imaging;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Runtime.Serialization;
using System.Text;
using System.Threading;
using System.Web;
using System.Web.Configuration;
using System.Xml;

namespace Aurigo.AMP3.Common
{
    public class DateFormatCulture : SingletonManagerBase&lt;DateFormatCulture&gt;
    {
        private DateFormatCulture() { }

        /// &lt;summary&gt;
        /// This culture is specifically for the Infragistics Date formatting 
        /// based on the application settings E.g.MM/dd/yyyy, dd/MM/yyyy
        /// &lt;/summary&gt;
        private CultureInfo _dateCulture;

        public static bool IsSetMWDateFormatCulture { get { return (Instance._dateCulture != null); } }
        public static CultureInfo MWDateFormatCulture
        {
            get
            {
                if (Instance._dateCulture != null)
                    return (CultureInfo)Instance._dateCulture.Clone();
                return null;
            }
        }

        public static CultureInfo GetDateFormatCulture()
        {
            if ((CultureInfo)Instance._dateCulture != null)
                return (CultureInfo)Instance._dateCulture.Clone();

            return null;
        }

        public void SetDateFormat(string culture, string dateFormat)
        {
            _dateCulture = CultureInfo.CreateSpecificCulture(culture);
            _dateCulture.DateTimeFormat.ShortDatePattern = dateFormat;
        }

        public void SetDateSeperatorFormat(string culture, string dateSeperator)
        {
            _dateCulture.DateTimeFormat.DateSeparator = dateSeperator;
        }

        /// &lt;summary&gt;
        /// This method will set the current thread culture to MWCulture 
        /// (ie MWCulture may be hybrid of multiple culture as in it may have a different  separator symbol for date and different date format)
        /// &lt;/summary&gt;
        public static void SyncCurrentThreadCultureToMWCulture_IfRequired()
        {
            var currentCulture = DateFormatCulture.MWDateFormatCulture;

            if (currentCulture != null)
            {
                if (currentCulture.DateTimeFormat.ShortDatePattern != Thread.CurrentThread.CurrentCulture.DateTimeFormat.ShortDatePattern
                    || currentCulture.DateTimeFormat.DateSeparator != Thread.CurrentThread.CurrentCulture.DateTimeFormat.DateSeparator
                    )
                    Thread.CurrentThread.CurrentCulture = currentCulture;

                if (currentCulture.DateTimeFormat.ShortDatePattern != Thread.CurrentThread.CurrentUICulture.DateTimeFormat.ShortDatePattern
                   || currentCulture.DateTimeFormat.DateSeparator != Thread.CurrentThread.CurrentUICulture.DateTimeFormat.DateSeparator
                   )
                    Thread.CurrentThread.CurrentUICulture = currentCulture;
            }
        }

        public static void SetDefaultThreadCultureToMWCulture_IfRequired()
        {
            var currentCulture = DateFormatCulture.MWDateFormatCulture;
            if (currentCulture != null)
            {

                if (System.Globalization.CultureInfo.DefaultThreadCurrentCulture == null || currentCulture.DateTimeFormat.ShortDatePattern != System.Globalization.CultureInfo.DefaultThreadCurrentCulture.DateTimeFormat.ShortDatePattern
                    || currentCulture.DateTimeFormat.DateSeparator != System.Globalization.CultureInfo.DefaultThreadCurrentCulture.DateTimeFormat.DateSeparator
                    )
                    System.Globalization.CultureInfo.DefaultThreadCurrentCulture = currentCulture;

                if (System.Globalization.CultureInfo.DefaultThreadCurrentUICulture == null || currentCulture.DateTimeFormat.ShortDatePattern != System.Globalization.CultureInfo.DefaultThreadCurrentUICulture.DateTimeFormat.ShortDatePattern
                   || currentCulture.DateTimeFormat.DateSeparator != System.Globalization.CultureInfo.DefaultThreadCurrentUICulture.DateTimeFormat.DateSeparator
                   )
                    System.Globalization.CultureInfo.DefaultThreadCurrentUICulture = currentCulture;
            }
        }
    }

    public static class CoreDatabaseHelper
    {
        private const string IMGPATHCATALOG = &quot;~/Images/IcnPage.gif&quot;;

        private static readonly Object lockObj = new object();
        private static readonly ConcurrentDictionary&lt;string, DataRow&gt; ModuleDetails = new ConcurrentDictionary&lt;string, DataRow&gt;();

        /// &lt;summary&gt;
        /// Fetches all the application settings and returns dictionary object
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static Dictionary&lt;string, string&gt; GetApplicationSettings()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var appSettings = new Dictionary&lt;string, string&gt;();
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3GetApplicationSettings&quot;);

                using (IDataReader reader = conn.DB.ExecuteReader(cmd))
                {
                    while (reader.Read())
                    {
                        if (appSettings.ContainsKey(reader.GetString(0)))
                        {
                            appSettings[reader.GetString(0)] = reader.GetString(1);
                        }
                        else
                        {
                            appSettings.Add(reader.GetString(0), reader.GetString(1));
                        }
                    }
                }
                return appSettings;
            }
        }


        /// &lt;summary&gt;
        /// Inserts or updates application settings
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;appSettings&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static int SetApplicationSettings(Dictionary&lt;string, string&gt; appSettings, string integrationDateSettings,
            string connectionString = &quot;&quot;)
        {
            var sWr = new StringWriter(CultureInfo.CurrentCulture);
            var xWr = new XmlTextWriter(sWr);

            xWr.WriteStartElement(&quot;AppSettings&quot;);

            Dictionary&lt;string, string&gt;.Enumerator en = appSettings.GetEnumerator();
            while (en.MoveNext())
            {
                xWr.WriteStartElement(&quot;Setting&quot;);
                xWr.WriteElementString(&quot;SettingName&quot;, en.Current.Key);
                xWr.WriteElementString(&quot;SettingValue&quot;, en.Current.Value);
                xWr.WriteEndElement(); // &quot;Setting&quot;
            }

            xWr.WriteEndElement(); // AppSettings

            xWr.Flush();
            string xmlStr = sWr.ToString();
            sWr.Close();
            using (
                var conn =
                    new ConnHolder(connectionString == &quot;&quot; ? ConnectionHelper.GetConnectionString() : connectionString))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3AddApplicationSettings&quot;);

                conn.DB.AddInParameter(cmd, &quot;in_appSettings&quot;, DbType.String, xmlStr);
                conn.DB.AddInParameter(cmd, &quot;in_integrationDateSettings&quot;, DbType.String, integrationDateSettings);
                conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);
                int rtn = Convert.ToInt32(conn.DB.GetParameterValue(cmd, &quot;Result&quot;), CultureInfo.CurrentCulture);

                //if (rtn &gt; 0)
                //    Constants.SetFormatConstants();
                return rtn;
            }
        }

        public static void ClearModuleDetails()
        {
            ModuleDetails.Clear();
        }

        public static void ClearModuleDetails(string moduleID)
        {
            string companycode = ConnectionHelper.GetCurrentCompany().ToLower();
            if (ModuleDetails.ContainsKey(&quot;{0}-{1}&quot;.Format2(companycode, moduleID.ToLower())))
            {
                DataRow removedRow = null;
                ModuleDetails.TryRemove(&quot;{0}-{1}&quot;.Format2(companycode, moduleID.ToLower()), out removedRow);
            }
        }

        /// &lt;summary&gt;
        /// Gets details of a module as DataRow object
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static DataRow GetModuleDetails(string moduleID, string company = null)
        {
            string companycode = null == company ? ConnectionHelper.GetCurrentCompany().ToLower() : company;
            if (!ModuleDetails.ContainsKey(&quot;{0}-{1}&quot;.Format2(companycode, moduleID.ToLower())))
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleDetail&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);
                    DataTable dtModuleDetails = conn.DB.ExecuteDataSet(cmd).Tables[0];
                    if (dtModuleDetails.Rows.Count &gt; 0)
                        ModuleDetails.TryAdd(&quot;{0}-{1}&quot;.Format2(companycode, moduleID.ToLower()), dtModuleDetails.Rows[0]);
                    else
                        return null;
                }
            }
            return ModuleDetails[&quot;{0}-{1}&quot;.Format2(companycode, moduleID.ToLower())];
        }

        public static object GetDataFromAssembly(string moduleId, string methodName, object[] param)
        {
            try
            {
                DataRow dr = GetModuleDetails(moduleId);

                if (dr == null)
                    return null;

                object obj = null;
                string mainDll = string.Format(&quot;{0}&quot;, dr[&quot;MainDll&quot;]);
                string BLClassName = string.Format(&quot;{0}&quot;, dr[&quot;BLClassName&quot;]);
                if (dr[&quot;NavigateUrl&quot;].ToString2().ToLower2() == &quot;xmlform&quot;)
                    mainDll = ListModel.GetXMLInstance(&quot;LANDMGT&quot;, null, null, null).xmlModel.form.ManagerDLL;
                //mainDll = ModelFactory.GetXMLListModelInstance(&quot;LANDMGT&quot;, null, null, null).xmlModel.form.ManagerDLL;

                Assembly dynDll =
                    Assembly.LoadFrom(string.Format(CultureInfo.CurrentCulture, &quot;{0}/{1}&quot;, HttpRuntime.BinDirectory,
                        mainDll));

                if (string.IsNullOrEmpty(BLClassName))
                    return null;
                Type tt = dynDll.GetType(BLClassName);
                if (tt != null)
                {
                    if (tt.GetMethod(methodName) != null)
                        obj = tt.GetMethod(methodName).Invoke(Activator.CreateInstance(tt), param);
                }
                return obj;
            }
            catch (Exception)
            {
                return null;
            }
        }

        public static object GetDataFromAssembly(string assembly, string className, string methodName, object[] param)
        {
            try
            {
                Assembly dynDll =
                    Assembly.LoadFrom(string.Format(CultureInfo.CurrentCulture, &quot;{0}/{1}&quot;, HttpRuntime.BinDirectory,
                        assembly));
                object obj = null;

                Type tt = dynDll.GetType(className);
                if (tt != null)
                {
                    if (tt.GetMethod(methodName) != null)
                        obj = tt.GetMethod(methodName).Invoke(Activator.CreateInstance(tt), param);
                }
                return obj;
            }
            catch (FileNotFoundException)
            {
                return null;
            }
        }

        public static TNode GetXmlTreeData(TNode parentNode, string moduleId, int projectId, int userId, int rid,
            string platformKey)
        {
            DataRow dr = GetModuleDetails(moduleId);

            if (dr == null)
                return null;

            IXmlTree xmlTree = null;

            string dll = dr[&quot;MainDll&quot;].ToString(), blClassName = dr[&quot;BLClassName&quot;].ToString();

            if (!string.IsNullOrEmpty(dll) &amp;&amp; !string.IsNullOrEmpty(blClassName))
                xmlTree = AMP3InterfaceFactory.GetInstance&lt;IXmlTree&gt;(dll, blClassName);

            if (xmlTree != null)
            {
                TNode node = xmlTree.GetXmlForTree(projectId, userId, rid, platformKey);
                DataSet dsTN =
                    ComponentHelper.Instance.ExecuteDataSet(&quot;select * from APPMGMTTreeNodeOrder where ModuleID={0}&quot;, xmlTree.ModuleID);
                if (dsTN.Tables.Count &gt; 0 &amp;&amp; dsTN.Tables[0].Rows.Count &gt; 0)
                    ReOrderChildren(node, dsTN.Tables[0]);
                return node;
            }
            return null;
        }

        public static void ReOrderChildren(TNode node, DataTable dt)
        {
            //Find all rows from dt where parentName matches
            //Order by NodeOrder Column 
            //Arrand all the immediate children of node
            //call the same function for every child recursively
            string parentName = node.text ?? &quot;&quot;;
            //Esacpe the &#39; character
            parentName = parentName.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);
            foreach (DataRow row in dt.Select(&quot;ParentName = &#39;&quot; + parentName + &quot;&#39; or ParentName = &#39;&#39;&quot;, &quot;NodeOrder asc&quot;))
            {
                TNode tempNode = node.Nodes.Find(n =&gt; n.text.Trim() == row[&quot;Name&quot;].ToString().Trim());
                if (tempNode == null) continue;
                try
                {
                    node.Nodes.Remove(tempNode);
                    node.Nodes.Insert(row[&quot;NodeOrder&quot;].ToInt32_2() - 1, tempNode);
                }
                catch
                {
                    if (!node.Nodes.Contains(tempNode))
                        node.Nodes.Add(tempNode);
                }
            }
            foreach (TNode childNode in node.Nodes)
            {
                if (childNode == null) continue;
                ReOrderChildren(childNode, dt);
            }
        }

        public static int GetDigitsAfterDecimal(string numberFormat)
        {
            return ((numberFormat.Contains(&quot;.&quot;)) ? numberFormat.Length - numberFormat.IndexOf(&#39;.&#39;) - 1 : 0);
        }

        public static string GetDateSeparator(string dateFormat)
        {
            return (dateFormat.Contains(&quot;/&quot;) ? &quot;/&quot; : (dateFormat.Contains(&quot;-&quot;) ? &quot;-&quot; : &quot;.&quot;));
        }

        public static string SetDisplayDateSeparator(string dateformat)
        {
            return dateformat.Replace(&quot;-&quot;, &quot;/&quot;).Replace(&quot;.&quot;, &quot;/&quot;);
        }

        public static string GetNumberFormat(string digitGrouping, int noDigits)
        {
            string numberFormat = string.Empty;
            string formatString = string.Empty;
            switch (digitGrouping)
            {
                case &quot;123456789&quot;:
                    numberFormat = &quot;########0&quot;;
                    break;
                case &quot;123,456,789&quot;:
                    numberFormat = &quot;###,###,##0&quot;;
                    break;
                case &quot;12,34,56,789&quot;:
                    numberFormat = &quot;##,##,##,##0&quot;;
                    break;
            }
            return (noDigits == 0) ? numberFormat : (numberFormat + &quot;.&quot; + new String(&#39;0&#39;, noDigits));
        }

        public static string GetDigitsGrouping(string numberFormat)
        {
            numberFormat = (numberFormat.Contains(&quot;.&quot;)
                ? numberFormat.Remove(numberFormat.IndexOf(&quot;.&quot;, StringComparison.OrdinalIgnoreCase))
                : numberFormat);
            string digitGrouping = string.Empty;
            switch (numberFormat)
            {
                case &quot;########0&quot;:
                    digitGrouping = &quot;123456789&quot;;
                    break;
                case &quot;###,###,##0&quot;:
                    digitGrouping = &quot;123,456,789&quot;;
                    break;
                case &quot;##,##,##,##0&quot;:
                    digitGrouping = &quot;12,34,56,789&quot;;
                    break;
            }
            return digitGrouping;
        }

        public static string GetUnitFromLookup(int ID)
        {
            try
            {
                lock (lockObj)
                {
                    object tempObj = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_ERPMGMTGetUnit, null, ID);
                    return tempObj.ToString();
                }
            }
            catch (SqlException)
            {
                return &quot;-1&quot;;
            }
            catch
            {
                throw;
            }
        }

        public static int GenericLibraryUpdate(string UpdateQuery, string WhereClause, string objectname)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTGenericUpdate&quot;);
                    objectname = &quot;dbo.&quot; + objectname;
                    conn.DB.AddInParameter(cmd, &quot;@ObjectName&quot;, DbType.String, objectname);
                    if (UpdateQuery != null)
                        conn.DB.AddInParameter(cmd, &quot;@UpdateQuery&quot;, DbType.String, UpdateQuery);
                    if (WhereClause != null)
                        conn.DB.AddInParameter(cmd, &quot;@WhereClause&quot;, DbType.String, WhereClause);
                    //conn.DB.ExecuteDataSet(cmd).Tables[0];
                    return (int)(conn.DB.ExecuteScalar(cmd));
                }
            }
            catch (SqlException)
            {
                return -1;
            }
            catch
            {
                throw;
            }
        }

        public static int GenericLibraryInsert(string values, string objectname)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTGenericInsert&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@ObjectName&quot;, DbType.String, objectname);
                    if (values != null)
                        conn.DB.AddInParameter(cmd, &quot;@Values&quot;, DbType.String, values);
                    conn.DB.ExecuteNonQuery(cmd);
                    return 1;
                }
            }
            catch (SqlException)
            {
                return 0;
            }
            catch
            {
                throw;
            }
        }

        public static int GenericLibraryInsert(string columnNames, string values, string objectname)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                        StoredProcedure.usp_LIBRARYGenericInsert, null, columnNames, values, objectname);
                    return 1;
                }
            }
            catch (SqlException)
            {
                return 0;
            }
            catch
            {
                throw;
            }
        }

        public static int GenericLibraryDelete(string TableName, string PrimaryKeyName, string IDs)
        {
            try
            {
                lock (lockObj)
                {
                    ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                        StoredProcedure.USP_APPMGMTGenericDelete, null, TableName, PrimaryKeyName, IDs);
                    return 1;
                }
            }
            catch (SqlException)
            {
                throw;
            }
            catch
            {
                throw;
            }
        }

        public static DataTable GenericLibraryGetData(string objectname, string primaryColumnName, int primaryID)
        {
            try
            {
                lock (lockObj)
                {
                    return
                        ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_APPMGMTGenericGetData, null,
                            objectname, primaryColumnName, primaryID, 0).Tables[0];
                }
            }
            catch (SqlException)
            {
                return null;
            }
            catch
            {
                throw;
            }
        }

        public static DataTable GetIntegrationDateSettings(string axCompany)
        {
            try
            {
                lock (lockObj)
                {
                    return
                        ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_APPMGMTGetIntegrationDateSettings,
                            null, axCompany).Tables[0];
                }
            }
            catch (SqlException)
            {
                return null;
            }
            catch
            {
                throw;
            }
        }

        public static DataSet GetODSData(string tableName, string primaryKeyName, string instanceIds)
        {
            DataSet sourceData = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_ODS_Data, null, tableName, primaryKeyName, instanceIds);
            sourceData = sourceData?.ToMWDateTime();
            return sourceData;

        }

        public static DataTable GetAssociatedXMLControl(string moduleId)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_COREMODGetAssociatedXMLControl, null, moduleId);

            if (ds == null || ds.Tables.Count == 0)
                return new DataTable();
            return ds.Tables[0];
        }
        public static DataSet GetODSData(string objectName, object maxRows, string sortOrder, string filterSearch,
            bool xml, ref int CurrentPage, out int count, string[] dataSourceFilters,
            int? RID, int? UID, string AXCompany)
        {
            var dicDataSourceFilter = new Dictionary&lt;string, string&gt;();
            if (dataSourceFilters != null)
            {
                foreach (string key in dataSourceFilters)
                {
                    dicDataSourceFilter.Add(key,
                        string.IsNullOrEmpty(HttpContext.Current.Request[key])
                            ? null
                            : HttpContext.Current.Request[key]);
                }
            }
            return GetODSData(objectName, maxRows, sortOrder, filterSearch, xml, ref CurrentPage, out count,
                dicDataSourceFilter, RID, UID, AXCompany);
        }

        public static string GetSanitizedDataForSQL(string input)
        {
            return input.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);
        }

        public static DataSet GetODSData(string objectName, object maxRows, string sortOrder, string filterSearch,
            bool xml, ref int CurrentPage, out int count, string[] dataSourceFilters,
            Dictionary&lt;string, string&gt; dataSourceFiltersWithValue = null)
        {
            var dicDataSourceFilter = new Dictionary&lt;string, string&gt;();
            if (dataSourceFilters != null)
                foreach (string key in dataSourceFilters)
                    dicDataSourceFilter.Add(key,
                        string.IsNullOrEmpty(HttpContext.Current.Request[key])
                            ? null
                            : HttpUtility.HtmlEncode(HttpContext.Current.Request[key]));
            if (dataSourceFiltersWithValue != null)
                foreach (var filterValue in dataSourceFiltersWithValue)
                    dicDataSourceFilter.Add(filterValue.Key, filterValue.Value);
            return GetODSData(objectName, maxRows, sortOrder, filterSearch, xml, ref CurrentPage, out count,
                dicDataSourceFilter, null, null, null);
        }

        public static DataSet GetODSData(string objectName, object maxRows, string sortOrder, string filterSearch,
            bool xml, ref int CurrentPage, out int count,
            Dictionary&lt;string, string&gt; dataSourceFilters, int? RID, int? UID,
            string AXCompany,
            bool viewPermissionConfigured = false, string formID = null,
            string primaryKeyName = null, string currentRole = null, int pid = 0, bool ignoreWorkflow = false,
            bool filterOrSortHasPendingOnUser = false)
        {
            try
            {
                if (ModuleManagementBL.ModuleManager.Instance.IsEffectivePermissionOfRoles())
                    RID = 0;


                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;CurrentPage&quot;] = CurrentPage;
                if (!string.IsNullOrEmpty(filterSearch) &amp;&amp; xml)
                {
                    filterSearch = FormatFilterText(filterSearch);
                }
                if (dataSourceFilters != null)
                {
                    var dbFilter = new StringBuilder();

                    foreach (string key in dataSourceFilters.Keys)
                    {
                        if (!(String.IsNullOrEmpty(dataSourceFilters[key]) &amp;&amp;
                              String.IsNullOrEmpty(HttpContext.Current.Request[key])))
                        {
                            dbFilter.AppendFormat(&quot;{0}={1} AND &quot;, key,
                                (string.IsNullOrEmpty(dataSourceFilters[key])
                                    ? String.IsNullOrEmpty(HttpContext.Current.Request[key])
                                        ? &quot;&#39;&quot; + GetSanitizedDataForSQL(dataSourceFilters[key]) + &quot;&#39;&quot;
                                        : &quot;&#39;&quot; + GetSanitizedDataForSQL(HttpContext.Current.Request[key]) + &quot;&#39;&quot;
                                    : &quot;&#39;&quot; + GetSanitizedDataForSQL(dataSourceFilters[key]) + &quot;&#39;&quot;));
                        }
                    }
                    filterSearch = filterSearch +
                                   (string.IsNullOrEmpty(filterSearch) ? dbFilter.ToString() : &quot; AND &quot; + dbFilter);
                    if (filterSearch.EndsWith(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase))
                        filterSearch =
                            filterSearch.Remove(filterSearch.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase));
                }

                filterSearch = string.IsNullOrEmpty(filterSearch) ? null : filterSearch;

                UserDetail ud = UserDetail.GetCurrentUserDetail();

                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_ODS, dic, filterSearch,
                    maxRows, sortOrder, objectName, RID, UID,
                    AXCompany, formID, primaryKeyName, pid, ignoreWorkflow,
                    UserManager.Instance.GetRoleNames(ud.UID, pid, ud.RID, ud.RoleName), filterOrSortHasPendingOnUser);


                Int32.TryParse(dic[&quot;PageCount&quot;].ToString(), out count);
                Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString(), out CurrentPage);
                return ds;

            }
            catch
            {
                throw;
            }
        }

        /// &lt;summary&gt;
        /// return record set for Enterprise Search
        /// Parameter xmlFilterCriteriaDynamicGrid used for filter dynamic grid column 
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static DataSet GetSearchODSData(string objectName, object maxRows, string sortOrder, string filterSearch,
          bool xml, ref int CurrentPage, out int count,
          Dictionary&lt;string, string&gt; dataSourceFilters, int? RID, int? UID,
          string AXCompany,
          bool viewPermissionConfigured = false, string formID = null,
          string primaryKeyName = null, string currentRole = null, int pid = 0, bool ignoreWorkflow = false,
          bool filterOrSortHasPendingOnUser = false, string xmlFilterCriteriaDynamicGrid = &quot;&quot;)
        {
            try
            {
                if (ModuleManagementBL.ModuleManager.Instance.IsEffectivePermissionOfRoles())
                    RID = 0;


                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;CurrentPage&quot;] = CurrentPage;
                if (!string.IsNullOrEmpty(filterSearch) &amp;&amp; xml)
                {
                    filterSearch = FormatFilterText(filterSearch);
                }
                if (dataSourceFilters != null)
                {
                    var dbFilter = new StringBuilder();

                    foreach (string key in dataSourceFilters.Keys)
                    {
                        if (!(String.IsNullOrEmpty(dataSourceFilters[key]) &amp;&amp;
                              String.IsNullOrEmpty(HttpContext.Current.Request[key])))
                        {
                            dbFilter.AppendFormat(&quot;{0}={1} AND &quot;, key,
                                (string.IsNullOrEmpty(dataSourceFilters[key])
                                    ? String.IsNullOrEmpty(HttpContext.Current.Request[key])
                                        ? &quot;&#39;&quot; + GetSanitizedDataForSQL(dataSourceFilters[key]) + &quot;&#39;&quot;
                                        : &quot;&#39;&quot; + GetSanitizedDataForSQL(HttpContext.Current.Request[key]) + &quot;&#39;&quot;
                                    : &quot;&#39;&quot; + GetSanitizedDataForSQL(dataSourceFilters[key]) + &quot;&#39;&quot;));
                        }
                    }
                    filterSearch = filterSearch +
                                   (string.IsNullOrEmpty(filterSearch) ? dbFilter.ToString() : &quot; AND &quot; + dbFilter);
                    if (filterSearch.EndsWith(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase))
                        filterSearch =
                            filterSearch.Remove(filterSearch.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase));
                }

                filterSearch = string.IsNullOrEmpty(filterSearch) ? null : filterSearch;

                UserDetail ud = UserDetail.GetCurrentUserDetail();

                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_ODS_Search, dic, filterSearch,
                    maxRows, sortOrder, objectName, RID, UID,
                    AXCompany, formID, primaryKeyName, pid, ignoreWorkflow,
                    UserManager.Instance.GetRoleNames(ud.UID, pid, ud.RID, ud.RoleName), filterOrSortHasPendingOnUser, xmlFilterCriteriaDynamicGrid);


                Int32.TryParse(dic[&quot;PageCount&quot;].ToString(), out count);
                Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString(), out CurrentPage);
                return ds;

            }
            catch
            {
                throw;
            }
        }

        public static DataSet GetMyTasksData(object maxRows, string sortOrder, string filterSearch,
            bool xml, ref int CurrentPage, out int count,
            string[] dataSourceFilters, Dictionary&lt;string, string&gt; dataSourceFiltersWithValue,
            int RID, int UID, int PID)
        {
            try
            {
                if (ModuleManagementBL.ModuleManager.Instance.IsEffectivePermissionOfRoles())
                    RID = 0;

                var dicDataSourceFilter = new Dictionary&lt;string, string&gt;();
                if (dataSourceFilters != null)
                    foreach (string key in dataSourceFilters)
                        dicDataSourceFilter.Add(key,
                            string.IsNullOrEmpty(HttpContext.Current.Request[key])
                                ? null
                                : HttpUtility.HtmlEncode(HttpContext.Current.Request[key]));
                if (dataSourceFiltersWithValue != null)
                    foreach (var filterValue in dataSourceFiltersWithValue)
                        dicDataSourceFilter.Add(filterValue.Key, filterValue.Value);


                lock (lockObj)
                {
                    var dic = new Dictionary&lt;string, object&gt;();
                    dic[&quot;CurrentPage&quot;] = CurrentPage;
                    if (!string.IsNullOrEmpty(filterSearch) &amp;&amp; xml)
                    {
                        filterSearch = FormatFilterText(filterSearch);
                    }
                    if (dataSourceFilters != null)
                    {
                        var dbFilter = new StringBuilder();

                        foreach (string key in dicDataSourceFilter.Keys)
                        {
                            if (!(String.IsNullOrEmpty(dicDataSourceFilter[key]) &amp;&amp;
                                  String.IsNullOrEmpty(HttpContext.Current.Request[key])))
                            {
                                dbFilter.AppendFormat(&quot;{0}={1} AND &quot;, key,
                                    (string.IsNullOrEmpty(dicDataSourceFilter[key])
                                        ? String.IsNullOrEmpty(HttpContext.Current.Request[key])
                                            ? &quot;&#39;&quot; + GetSanitizedDataForSQL(dicDataSourceFilter[key]) + &quot;&#39;&quot;
                                            : &quot;&#39;&quot; + GetSanitizedDataForSQL(HttpContext.Current.Request[key]) + &quot;&#39;&quot;
                                        : &quot;&#39;&quot; + GetSanitizedDataForSQL(dicDataSourceFilter[key]) + &quot;&#39;&quot;));
                            }
                        }
                        filterSearch = filterSearch +
                                       (string.IsNullOrEmpty(filterSearch) ? dbFilter.ToString() : &quot; AND &quot; + dbFilter);
                        if (filterSearch.EndsWith(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase))
                            filterSearch =
                                filterSearch.Remove(filterSearch.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase));
                    }

                    filterSearch = string.IsNullOrEmpty(filterSearch) ? null : filterSearch;

                    DataSet ds = new DataSet();


                    ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_COREMODGetMyTasks, dic,
                        filterSearch,
                        maxRows, sortOrder, RID, UID, PID);

                    Int32.TryParse(dic[&quot;PageCount&quot;].ToString(), out count);
                    Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString(), out CurrentPage);
                    return ds;
                }
            }
            catch
            {
                throw;
            }
        }

        public static DataSet GetODSData(string objectName, object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, ref int CurrentPage, out int count,
            string[] dataSourceFilters)
        {
            return GetODSData(objectName, maxRows, sortOrder, filterSearch, true, ref CurrentPage, out count,
                dataSourceFilters, null, null, null);
        }

        public static string FormatFilterText(string filterSearch)
        {
            //&lt;XMLRoot&gt;
            //    &lt;Work_Order_No type=&#39;txt&#39; DBColumn=&#39;Work Order No&#39;&gt;valueid&lt;/Work_Order_No&gt;
            //    &lt;Name type=&#39;txt&#39;&gt;valuename&lt;/Name&gt;
            //    &lt;Contact type=&#39;txt&#39;&gt;valuecontact&lt;/Contact&gt;
            //&lt;/XMLRoot&gt;

            string strQuery;
            var strBQuery = new StringBuilder();
            var xDoc = new XmlDocument();
            xDoc.LoadXml(filterSearch);
            XmlNode node;
            if ((node = xDoc.SelectSingleNode(&quot;XMLRoot&quot;)) != null)
            {
                IEnumerator en = node.ChildNodes.GetEnumerator();
                while (en.MoveNext())
                {
                    node = en.Current as XmlNode;

                    string itemName = node.Name;
                    if (node.Attributes[&quot;DBColumn&quot;] != null &amp;&amp; !string.IsNullOrEmpty(node.Attributes[&quot;DBColumn&quot;].Value))
                        itemName = node.Attributes[&quot;DBColumn&quot;].Value;

                    if (node.InnerText == string.Empty) //node.Attributes[&quot;type&quot;].Value == &quot;txt&quot; &amp;&amp; 
                        continue;

                    string temp = node.InnerText;
                    if (temp.Contains(&quot;%&quot;) || temp.Contains(&quot;_&quot;) || temp.Contains(&quot;[&quot;) || temp.Contains(&quot;&#39;&quot;))
                    {
                        // -- oracle
                        temp = temp.Replace(&quot;[&quot;, &quot;[[]&quot;);
                        temp = temp.Replace(&quot;%&quot;, &quot;[%]&quot;);
                        temp = temp.Replace(&quot;_&quot;, &quot;[_]&quot;);
                        temp = temp.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);

                        //temp = temp.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;);
                        //temp = temp.Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;);
                        //temp = temp.Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);
                        //temp = temp.Replace(&#39;&quot;&#39;, &quot;&amp;quot;&quot;);
                        //temp = temp.Replace(&quot;&#39;&quot;, &quot;&amp;apos;&quot;);

                        //temp = temp.Replace(&quot;\\&quot;, &quot;\\\\&quot;);
                        //temp = temp.Replace(&quot;%&quot;, &quot;\\%&quot;);
                        //temp = temp.Replace(&quot;_&quot;, &quot;\\_&quot;);
                    }

                    string attributeType = node.Attributes[&quot;type&quot;].Value;
                    bool isTimeZoneApplicable = false;

                    if (node.Attributes[&quot;IsTimeZoneApplicable&quot;] != null &amp;&amp; node.Attributes[&quot;IsTimeZoneApplicable&quot;].Value.ToBoolean2() == true)
                        isTimeZoneApplicable = true;

                    if (attributeType == &quot;ddl&quot;)
                        strBQuery.AppendFormat(&quot;([{0}] = &#39;{1}&#39;) AND &quot;, itemName, temp);
                    else if (attributeType == &quot;dc&quot; || isTimeZoneApplicable) //timezone can be applicable for text field. 
                    {
                        DateTime mwDateTime;
                        if (temp.TryParseObjectAsDateTime(out mwDateTime, DateFormatCulture.MWDateFormatCulture))
                        {
                            //means its datetime value (and it is in format of CurrentCulture and MWDateTime
                            //We need to translate to checking of UTC range
                            string utcDateEquivalent_ofStartOfMWDate = mwDateTime.ToUtc().ToDateTimeString_ForDatabaseOpenXml();
                            string utcDateEquivalent_ofEndOfMWDate = mwDateTime.AddDays(1).AddMilliseconds(-1).ToUtc().ToDateTimeString_ForDatabaseOpenXml();

                            //Timezone Bugfix: Timezone DesignFix: A day in MWTime is not equivalent to the same day in UTC (ie it can span accross multiple UTC days)
                            //also the format has to be in Database understood value.
                            string columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND CAST(&#39;{1}&#39; AS DATETIME) &lt;= [{0}] AND [{0}] &lt;= CAST(&#39;{2}&#39; AS DATETIME) )&quot; + &quot; AND &quot;;
                            // Parameter Sequence =                              {0}                        {1}                             {2}
                            strBQuery.AppendFormat(columnfilterStringTemplate, itemName, utcDateEquivalent_ofStartOfMWDate, utcDateEquivalent_ofEndOfMWDate);
                        }
                    }
                    else
                        strBQuery.AppendFormat(&quot;([{0}] LIKE &#39;%{1}%&#39;) AND &quot;, itemName, temp);
                }
            }
            strQuery = strBQuery.ToString();
            strQuery = (String.IsNullOrEmpty(strQuery) ||
                        (strQuery.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase) &lt; 0))
                ? &quot;&quot;
                : strQuery.Substring(0, strQuery.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase));
            return strQuery;
        }

        /// &lt;summary&gt;
        /// Create Filter String from Dynamic Grid
        /// Return Format &lt;DynamicGridTableName&gt; Cond &lt;/DynamicGridTableName&gt;&lt;DynamicGridTableName2&gt;Where Cond &lt;/DynamicGridTableName2&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;filterSearch&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static string FormatDynamicFilterText(string filterSearch)
        {
            //&lt;XMLRoot&gt;
            //    &lt;Work_Order_No type=&#39;txt&#39; DBColumn=&#39;Work Order No&#39; DynamicTableName=&#39;xyz&#39;&gt;valueid&lt;/Work_Order_No&gt;
            //    &lt;Name type=&#39;txt&#39; DynamicTableName=&#39;xyz&#39;&gt;valuename&lt;/Name&gt;
            //    &lt;Contact type=&#39;txt&#39; DynamicTableName=&#39;xyz&#39;&gt;valuecontact&lt;/Contact&gt;
            //&lt;/XMLRoot&gt;
            Dictionary&lt;string, string&gt; Dynm_Filter = new Dictionary&lt;string, string&gt;();
            string strQuery = string.Empty;
            string dynamicTableName = string.Empty;
            var sbFilterSearchQuery = new StringBuilder();
            var xDoc = new XmlDocument();
            xDoc.LoadXml(filterSearch);
            XmlNode node;
            if ((node = xDoc.SelectSingleNode(&quot;XMLRoot&quot;)) != null)
            {
                IEnumerator en = node.ChildNodes.GetEnumerator();
                while (en.MoveNext())
                {
                    node = en.Current as XmlNode;

                    string itemName = node.Name;
                    if (node.Attributes[&quot;DBColumn&quot;] != null &amp;&amp; !string.IsNullOrEmpty(node.Attributes[&quot;DBColumn&quot;].Value))
                        itemName = node.Attributes[&quot;DBColumn&quot;].Value;

                    if (node.Attributes[&quot;DynamicTableName&quot;] != null &amp;&amp; !string.IsNullOrEmpty(node.Attributes[&quot;DynamicTableName&quot;].Value))
                        dynamicTableName = node.Attributes[&quot;DynamicTableName&quot;].Value;

                    if (node.InnerText == string.Empty) //node.Attributes[&quot;type&quot;].Value == &quot;txt&quot; &amp;&amp; 
                        continue;

                    string temp = node.InnerText;
                    if (temp.Contains(&quot;%&quot;) || temp.Contains(&quot;_&quot;) || temp.Contains(&quot;[&quot;) || temp.Contains(&quot;&#39;&quot;))
                    {
                        // -- oracle
                        temp = temp.Replace(&quot;[&quot;, &quot;[[]&quot;);
                        temp = temp.Replace(&quot;%&quot;, &quot;[%]&quot;);
                        temp = temp.Replace(&quot;_&quot;, &quot;[_]&quot;);
                        temp = temp.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;);
                    }

                    string attributeType = node.Attributes[&quot;type&quot;].Value;
                    bool isTimeZoneApplicable = false;

                    if (node.Attributes[&quot;IsTimeZoneApplicable&quot;] != null &amp;&amp; node.Attributes[&quot;IsTimeZoneApplicable&quot;].Value.ToBoolean2() == true)
                        isTimeZoneApplicable = true;

                    if (attributeType == &quot;ddl&quot;)
                    {
                        if (Dynm_Filter.ContainsKey(dynamicTableName))
                            Dynm_Filter[dynamicTableName] = string.Format(&quot;([{0}] = &#39;{1}&#39;) AND &quot;, itemName, temp) + Dynm_Filter[dynamicTableName];
                        else
                            Dynm_Filter.Add(dynamicTableName, string.Format(&quot;([{0}] = &#39;{1}&#39;) AND &quot;, itemName, temp));
                    }
                    else if (attributeType == &quot;dc&quot; || isTimeZoneApplicable) //timezone can be applicable for text field. 
                    {
                        DateTime mwDateTime;
                        if (temp.TryParseObjectAsDateTime(out mwDateTime, DateFormatCulture.MWDateFormatCulture))
                        {
                            //means its datetime value (and it is in format of CurrentCulture and MWDateTime
                            //We need to translate to checking of UTC range
                            string utcDateEquivalent_ofStartOfMWDate = mwDateTime.ToUtc().ToDateTimeString_ForDatabaseOpenXml();
                            string utcDateEquivalent_ofEndOfMWDate = mwDateTime.AddDays(1).AddMilliseconds(-1).ToUtc().ToDateTimeString_ForDatabaseOpenXml();

                            //Timezone Bugfix: Timezone DesignFix: A day in MWTime is not equivalent to the same day in UTC (ie it can span accross multiple UTC days)
                            //also the format has to be in Database understood value.
                            string columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND CAST(&#39;{1}&#39; AS DATETIME) &lt;= [{0}] AND [{0}] &lt;= CAST(&#39;{2}&#39; AS DATETIME) )&quot; + &quot; AND &quot;;
                            // Parameter Sequence =                              {0}                        {1}                             {2}

                            if (Dynm_Filter.ContainsKey(dynamicTableName))
                                Dynm_Filter[dynamicTableName] = string.Format(columnfilterStringTemplate, itemName, utcDateEquivalent_ofStartOfMWDate, utcDateEquivalent_ofEndOfMWDate) + Dynm_Filter[dynamicTableName];
                            else
                                Dynm_Filter.Add(dynamicTableName, string.Format(columnfilterStringTemplate, itemName, utcDateEquivalent_ofStartOfMWDate, utcDateEquivalent_ofEndOfMWDate));
                        }
                    }
                    else
                    {
                        if (Dynm_Filter.ContainsKey(dynamicTableName))
                            Dynm_Filter[dynamicTableName] = string.Format(&quot;([{0}] LIKE &#39;%{1}%&#39;) AND &quot;, itemName, temp) + strQuery + Dynm_Filter[dynamicTableName];
                        else
                            Dynm_Filter.Add(dynamicTableName, string.Format(&quot;([{0}] LIKE &#39;%{1}%&#39;) AND &quot;, itemName, temp) + strQuery);
                    }
                }
            }

            sbFilterSearchQuery.Append(&quot;&lt;XMLRoot&gt;&quot;);
            foreach (KeyValuePair&lt;string, string&gt; entry in Dynm_Filter)
            {
                strQuery = entry.Value;
                strQuery = (String.IsNullOrEmpty(strQuery) ||
                       (strQuery.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase) &lt; 0))
               ? &quot;&quot;
               : strQuery.Substring(0, strQuery.LastIndexOf(&quot;AND &quot;, StringComparison.OrdinalIgnoreCase));

                strQuery = string.Format(&quot;&lt;{0}&gt;{1}&lt;/{0}&gt;&quot;, entry.Key, strQuery);
                sbFilterSearchQuery.Append(strQuery);
            }
            if (sbFilterSearchQuery.ToString() == &quot;&lt;XMLRoot&gt;&quot;)
                return null;
            sbFilterSearchQuery.Append(&quot;&lt;/XMLRoot&gt;&quot;);
            return sbFilterSearchQuery.ToString();
        }

        internal static string[] GetScriptDelimitors()
        {
            return new[] { &quot;\r\nGO&quot;, &quot;\nGO&quot;, &quot;\r\nGo&quot;, &quot;\nGo&quot; };
        }

        public static void AttachXmlFormsLinks(this XmlTextWriter xWr, string parentModuleId, string moduleId)
        {
            IQueryable&lt;BrixModule&gt; modules = from m in CoreDb.Db.Modules
                                             where m.InstanceUrl == &quot;xmlform&quot; &amp;&amp;
                                                   m.ParentModuleID == parentModuleId &amp;&amp;
                                                   m.ModuleID != moduleId
                                             select m;


            foreach (BrixModule module in modules)
            {
                xWr.WriteStartElement(&quot;Item&quot;);
                xWr.WriteAttributeString(&quot;TargetUrl&quot;,
                    &quot;~/Common/BrixListPage.aspx?xcontext=&quot; + module.ModuleID + &quot;&amp;module=&quot; +
                    module.ParentModuleID + &quot;&amp;parentId=0&quot;);
                xWr.WriteAttributeString(&quot;Name&quot;, module.ModuleDescription);
                xWr.WriteAttributeString(&quot;ImageUrl&quot;, IMGPATHCATALOG);
                xWr.WriteAttributeString(&quot;Description&quot;, module.ModuleDescription);

                xWr.WriteEndElement();
            }
        }

        public static string GetXmlData(string typeofdata)
        {
            if (typeofdata.Equals(&quot;Measurement Units&quot;))
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllMeasurementUnits&quot;);

                    using (DataSet ds = conn.DB.ExecuteDataSet(cmd))
                    {
                        ds.DataSetName = &quot;Records&quot;;
                        return ds.GetXml();
                    }
                }
            }
            return &quot;&lt;Records/&gt;&quot;;
        }

        public static DataTable GetMapSettings()
        {
            DataTable dt = null;
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_APPMGMTGetMapSettings, null, null);
            if (ds != null &amp;&amp; ds.Tables != null &amp;&amp; ds.Tables.Count &gt; 0)
                dt = ds.Tables[0];
            return dt;
        }

        public static void UpdateSytemDateAfterWorkflow(string table, string primaryKey, int instanceId, string userFullName)
        {

            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                StoredProcedure.usp_COREUpdateFormDataAfterWorkFlowAction, null, table, primaryKey, instanceId, userFullName);

        }

        #region Control Settings

        /// &lt;summary&gt;
        /// This Function should be used when across all the User&#39;s roles, the same data needs to be persisted
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UID&quot;&gt;Brix UserID&lt;/param&gt;
        /// &lt;param name=&quot;ControlName&quot;&gt;Control which is asking for persisted data&lt;/param&gt;
        /// &lt;returns&gt;Settings Value&lt;/returns&gt;
        public static string GetControlSettings(int UID, string ControlName)
        {
            return GetControlSettings(UID, null, ControlName);
        }

        /// &lt;summary&gt;
        /// This Function should be used when for each role of a single user, different settings should be persisted
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UID&quot;&gt;Brix UserID&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;RoleID of the user&lt;/param&gt;
        /// &lt;param name=&quot;ControlName&quot;&gt;Control which is asking for persisted settings&lt;/param&gt;
        /// &lt;returns&gt;Settings value&lt;/returns&gt;
        public static string GetControlSettings(int UID, int? roleId, string ControlName)
        {
            object obj = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_APPMGMTGetControlSettings, null, UID,
                roleId, ControlName);
            if (obj != null)
                return obj.ToString();
            else
                return &quot;&quot;;
        }

        /// &lt;summary&gt;
        /// This Function is to be used when irrespective of a user&#39;s role, single settings value needs to be persisted
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UID&quot;&gt;Brix UserID&lt;/param&gt;
        /// &lt;param name=&quot;ControlName&quot;&gt;Control which is requesting the settings to be persisted&lt;/param&gt;
        /// &lt;param name=&quot;CustomValues&quot;&gt;Setting value to be saved&lt;/param&gt;
        public static void SaveControlSettings(int UID, string ControlName, string CustomValues)
        {
            SaveControlSettings(UID, null, ControlName, CustomValues);
        }

        /// &lt;summary&gt;
        /// This Function should be used if a different setting value needs to be persisted for every
        /// different role of the user
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UID&quot;&gt;Brix UserID&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;User&#39;s Role ID&lt;/param&gt;
        /// &lt;param name=&quot;ControlName&quot;&gt;Control that is requesting the setting to be persisted&lt;/param&gt;
        /// &lt;param name=&quot;CustomValues&quot;&gt;Setting Value&lt;/param&gt;
        public static void SaveControlSettings(int UID, int? roleId, string ControlName, string CustomValues)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                StoredProcedure.usp_APPMGMTCUControlSettings, null, UID, roleId, ControlName, CustomValues);
        }

        #endregion
    }

    public enum DocumentOnlineViewer
    {
        OnlineViewer,
        LocalViewer
    }

    public enum DocumentViewer
    {
        NotViewOne,
        ViewOne
    }

    public class AMP3ApplicationSettings : SingletonManagerBase&lt;AMP3ApplicationSettings&gt;
    {
        //private static volatile Dictionary&lt;string, AMP3ApplicationSettings&gt; _Inst = null;
        //private static readonly object _oSync = new object();

        //public static AMP3ApplicationSettings Instance
        //{
        //    get
        //    {
        //        lock (_oSync)
        //        {
        //            if (_Inst == null) _Inst = new Dictionary&lt;string, AMP3ApplicationSettings&gt;();
        //            string currentCompany = ConnectionHelper.GetCurrentCompany();
        //            if (!_Inst.ContainsKey(currentCompany)) _Inst.Add(currentCompany, new AMP3ApplicationSettings());
        //            return _Inst[currentCompany];
        //        }
        //    }
        //}

        private string _BOQGroupType = &quot;Local Group&quot;;
        private string _BOQRateFactor;
        private string _Dim1Title;
        private string _Dim2Title;
        private string _Dim3Title;
        private string _appemailid;
        private bool _applevellog, _cacheData, _keepCachedTemplatesInCache;
        private string _applogo;
        private string _loglevel;
        private string _logmode;
        private string _sessionTimeoutNotification;
        private string _projectedCostFormula;
        private string _reportlogo1;
        private string _reportlogo2;
        private string _smtpserver;
        private string _title;
        private string _logo;
        private string _loginBox;
        private string _loginBoxADFS;
        private string _loginBox_Error;
        private string _loginBoxADFS_Error;
        private string _culture;
        private string _build;
        private string _formatAmount = &quot;###,###,##0.00&quot;;
        private string _formatPercentage = &quot;##0.00&quot;;
        private string _formatUnitPrice = &quot;###,###,##0.0000&quot;;
        private string _formatQuantity = &quot;###,###,##0.0000&quot;;
        private string _formatDate = &quot;MM/dd/yyyy&quot;; //Month(MM) to diffrentiate from minute(mm)
        private string _formatTime = &quot;h:mm tt&quot;;
        private string _formatDateTime = &quot;MM/dd/yyyy h:mm tt&quot;;
        private decimal _wfActionMaxAttachmentSizeInMB = 10; // Default maximum size for workflow action attachments is kept to 10 MB.
        private decimal _defaultMaxAttachmentSizeInMB = 10; // Default maximum size for attachments is kept to 10 MB.
        private string _useTerminology;
        private bool _CONTMGTLoadTreeOnDemand;
        private bool _ESTMATELoadTreeOnDemand;
        private bool _LANDMGTLoadTreeOnDemand;
        private bool _IsSingleProjectMode;
        private string _currentTimezone;
        private decimal _mobileSyncInterval;
        private int _mobileLastUserCount;
        private string _loginMode;
        private string _domainName;
        private string _dateSeparator;

        private string _MOBILEAutoSyncInterval;
        private string _MOBILEOfflineDuration;
        private string _MobileShowDocumentsLink;

        private string _BlockedFileTypes = string.Empty;
        private string _auditLogType = string.Empty;
        private bool _enableAuditLogGlobally;

        private DocumentViewer _documentViewer;
        private DocumentOnlineViewer _documentOnlineViewer;

        private AMP3ApplicationSettings()
        {
            Reload();
            new WebFarmData().Add(&quot;AppSettings&quot;);
        }

        public string AppName
        {
            get { return _title; }
        }

        public string AppLogo
        {
            get { return _applogo; }
        }

        public string AppEmailID
        {
            get { return _appemailid; }
        }

        public string SmtpServer
        {
            get { return _smtpserver; }
        }

        public bool AppLevelLog
        {
            get { return _applevellog; }
        }

        public string ProjectedCostFormula
        {
            get { return _projectedCostFormula; }
        }

        public string LogLevel
        {
            get { return _loglevel; }
        }

        public string LogMode
        {
            get { return _logmode; }
        }

        public string SessionTimeoutNotification
        {
            get { return _sessionTimeoutNotification; }
        }

        public string ReportLogo1
        {
            get { return _reportlogo1; }
        }

        public string ReportLogo2
        {
            get { return _reportlogo2; }
        }

        public string BOQGroupType
        {
            get { return _BOQGroupType; }
        }

        public string BOQRateFactor
        {
            get { return _BOQRateFactor; }
        }

        public string Dim1Title
        {
            get { return string.IsNullOrEmpty(_Dim1Title) ? &quot;Length&quot; : _Dim1Title; }
        }

        public string Dim2Title
        {
            get { return string.IsNullOrEmpty(_Dim2Title) ? &quot;Width&quot; : _Dim2Title; }
        }

        public string Dim3Title
        {
            get { return string.IsNullOrEmpty(_Dim3Title) ? &quot;Height&quot; : _Dim3Title; }
        }

        public string Logo
        {
            get { return _logo; }
        }

        public string LoginBox
        {
            get { return _loginBox; }
        }

        public string LoginBoxADFS
        {
            get { return _loginBoxADFS; }
        }

        public string LoginBox_Error
        {
            get { return _loginBox_Error; }
        }

        public string LoginBoxADFS_Error
        {
            get { return _loginBoxADFS_Error; }
        }

        public string Culture
        {
            get { return _culture; }
        }

        public string Build
        {
            get { return _build; }
        }

        public string FORMAT_AMOUNT
        {
            get { return _formatAmount; }
        }

        public string FORMAT_PERCENTAGE
        {
            get { return _formatPercentage; }
        }

        public string FORMAT_UNIT_PRICE
        {
            get { return _formatUnitPrice; }
        }

        public string FORMAT_QUANTITY
        {
            get { return _formatQuantity; }
        }

        public string FORMAT_DATE { get { return _formatDate; } private set { _formatDate = value; } }

        public string FORMAT_TIME
        {
            get { return _formatTime; }
        }

        public string FORMAT_DATETIME { get { return _formatDateTime; } private set { _formatDateTime = value; } }

        public decimal WFActionMaxAttachmentSizeInMB
        {
            get { return _wfActionMaxAttachmentSizeInMB; }
        }

        public decimal DefaultMaxAttachmentSizeInMB
        {
            get { return _defaultMaxAttachmentSizeInMB; }
        }

        public string DateSeparator
        {
            get
            {
                return _dateSeparator;
            }
        }

        public string UseTerminology
        {
            get { return _useTerminology; }
        }

        public string CurrentTimeZone
        {
            get { return _currentTimezone; }
        }

        public bool CONTMGTLoadTreeOnDemand
        {
            get { return _CONTMGTLoadTreeOnDemand; }
        }

        public bool ESTMATELoadTreeOnDemand
        {
            get { return _ESTMATELoadTreeOnDemand; }
        }

        public bool LANDMGTLoadTreeOnDemand
        {
            get { return _LANDMGTLoadTreeOnDemand; }
        }

        public bool IsSingleProjectMode
        {
            get { return _IsSingleProjectMode; }
        }

        public string BlockedFileTypes
        {
            get { return _BlockedFileTypes; }
        }

        public bool IsFileTypeBlocked(string fileType)
        {
            if (string.IsNullOrWhiteSpace(BlockedFileTypes)) return false;
            foreach (string t in BlockedFileTypes.Split(&#39;,&#39;))
            {
                if (t.Equals(fileType, StringComparison.CurrentCultureIgnoreCase))
                    return true;

            }

            return false;
        }

        public bool IsContractorBidderUser
        {
            get
            {
                UserDetail ud = UserDetail.GetCurrentUserDetail();
                if (ud != null &amp;&amp; HttpContext.Current != null)
                {
                    Dictionary&lt;int, string&gt; rolesOfUser = UserManager.Instance.GetRolesOfUserInCache(ud.UID);

                    return (appSettings.ContainsKey(&quot;ContractorBiddingRole&quot;) &amp;&amp;
                            !string.IsNullOrEmpty(appSettings[&quot;ContractorBiddingRole&quot;]) &amp;&amp;
                            ud.RoleName == appSettings[&quot;ContractorBiddingRole&quot;] &amp;&amp; rolesOfUser.Count == 1);
                }
                return false;
            }
        }

        public string ContractorBidderRole
        {
            get
            {
                return (appSettings.ContainsKey(&quot;ContractorBiddingRole&quot;) &amp;&amp;
                        !string.IsNullOrEmpty(appSettings[&quot;ContractorBiddingRole&quot;]))
                    ? appSettings[&quot;ContractorBiddingRole&quot;]
                    : string.Empty;
            }
        }

        public int MobileSyncLastUserCount
        {
            get { return _mobileLastUserCount; }
        }

        public string MOBILEAutoSyncInterval
        {
            get { return _MOBILEAutoSyncInterval; }
        }


        public string MOBILEAutoSaveInterval
        {
            get { return _MOBILEAutoSaveInterval; }
        }

        public string MobileShowDocumentsLink
        {
            get { return _MobileShowDocumentsLink; }
        }

        public string MOBILEOfflineDuration
        {
            get { return _MOBILEOfflineDuration; }
        }

        public decimal MobileSyncInterval
        {
            get { return _mobileSyncInterval; }
        }

        public bool CacheData
        {
            get { return _cacheData; }
        }

        /// &lt;summary&gt;
        /// Key to specify if the form and list temaplates which is required for mobile be stored in cache (In Memory or Redis) rather than fetching it from DB
        /// &lt;/summary&gt;
        public bool KeepCachedTemplatesInCache
        {
            get { return _keepCachedTemplatesInCache; }
        }

        public DocumentViewer DocumentViewer
        {
            get
            {
                return _documentViewer;
            }
        }

        public DocumentOnlineViewer DocumentOnlineViewer
        {
            get
            {
                return _documentOnlineViewer;
            }
        }

        public string LoginMode
        {
            get
            {
                if (string.IsNullOrEmpty(_loginMode))
                {
                    _loginMode = ConfigurationManager.AppSettings[&quot;LoginMode&quot;] ?? &quot;MW&quot;;
                }

                return _loginMode;
            }
        }

        public bool AdfsOnlyEnabled
        {
            get
            {
                return LoginMode.ToUpper2() == &quot;ADFS&quot;;
            }
        }

        public bool MwLoginOnlyEnabled
        {
            get
            {
                return LoginMode.ToUpper2() == &quot;MW&quot;;
            }
        }

        public string DomainName { get; set; }

        public Dictionary&lt;string, string&gt; appSettings;
        private string _MOBILEAutoSaveInterval;

        public int SessionTimeout
        {
            get
            {
                int timeout = 20;// Default: 20 Minutes.

                if (HttpContext.Current.Session.Timeout &gt; 0)
                    timeout = HttpContext.Current.Session.Timeout;

                return timeout;
            }
        }

        public string RedisRegionName
        {
            get
            {
                string regionName = ConfigurationManager.AppSettings[&quot;RedisRegionName&quot;];

                return string.IsNullOrEmpty(regionName) ? &quot;Masterworks&quot; : regionName;
            }
        }

        public bool MobileEnableOfflineDocuments { get; set; }

        public bool MobileIsEnterpriseEnabled { get; set; }

        string _serviceAuthorizationToken;
        public string ServiceAuthorizationToken
        {
            get
            {
                return _serviceAuthorizationToken;
            }
        }

        public string AuditLogType
        {
            get
            {
                return _auditLogType;
            }
        }

        public bool EnableAuditLogGlobally
        {
            get
            {
                return _enableAuditLogGlobally;
            }
        }

        public void Reload()
        {
            appSettings = CoreDatabaseHelper.GetApplicationSettings();
            string temp;

            if (appSettings.TryGetValue(&quot;AppName&quot;, out _title) == false)
                _title = &quot;Brix&quot;;

            if (appSettings.TryGetValue(&quot;AppLogo&quot;, out temp) &amp;&amp; HttpContext.Current != null
                &amp;&amp; (File.Exists(HttpContext.Current.Server.MapPath(&quot;~/Modules/MODMGMT/Images/&quot; + temp))))
                _applogo = &quot;~/Modules/MODMGMT/Images/&quot; + temp;
            else
                _applogo = WebConfigurationManager.AppSettings[&quot;ImageLogo&quot;];

            if (appSettings.TryGetValue(&quot;AppEmailId&quot;, out _appemailid) == false)
                _appemailid = &quot;brix@aurigo.com&quot;;

            if (appSettings.TryGetValue(&quot;AppServer&quot;, out _smtpserver) == false)
                _smtpserver = &quot;outlook.aurigo.com&quot;;

            if (appSettings.TryGetValue(&quot;AppLevelLog&quot;, out temp) == false)
                temp = &quot;Off&quot;;
            _applevellog = temp.Equals(&quot;On&quot;);

            if (appSettings.TryGetValue(&quot;ProjectedCostFormula&quot;, out _projectedCostFormula) == false)
                _projectedCostFormula = &quot;&quot;;

            if (appSettings.TryGetValue(&quot;LogMode&quot;, out _logmode) == false)
                _logmode = &quot;&quot;;

            if (appSettings.TryGetValue(&quot;SessionTimeoutNotification&quot;, out _sessionTimeoutNotification) == false)
                _sessionTimeoutNotification = &quot;30&quot;;

            if (appSettings.TryGetValue(&quot;LogLevel&quot;, out _loglevel) == false)
                _loglevel = &quot;&quot;;

            if (appSettings.TryGetValue(&quot;ReportLogo1&quot;, out temp) &amp;&amp; HttpContext.Current != null
                &amp;&amp; (File.Exists(HttpContext.Current.Server.MapPath(&quot;~/Modules/MODMGMT/Images/&quot; + temp))))
                _reportlogo1 = &quot;~/Modules/MODMGMT/Images/&quot; + temp;
            else
                _reportlogo1 = WebConfigurationManager.AppSettings[&quot;ImageLogo&quot;];

            if (appSettings.TryGetValue(&quot;ReportLogo2&quot;, out temp) &amp;&amp; HttpContext.Current != null
                &amp;&amp; (File.Exists(HttpContext.Current.Server.MapPath(&quot;~/Modules/MODMGMT/Images/&quot; + temp))))
                _reportlogo2 = &quot;~/Modules/MODMGMT/Images/&quot; + temp;
            else
                _reportlogo2 = WebConfigurationManager.AppSettings[&quot;ImageLogo&quot;];

            if (appSettings.ContainsKey(&quot;BOQGroupType&quot;))
                _BOQGroupType = appSettings[&quot;BOQGroupType&quot;];

            if (appSettings.ContainsKey(&quot;BOQRateFactor&quot;))
                _BOQRateFactor = appSettings[&quot;BOQRateFactor&quot;];

            if (appSettings.ContainsKey(&quot;Dim1Title&quot;))
                _Dim1Title = appSettings[&quot;Dim1Title&quot;];

            if (appSettings.ContainsKey(&quot;Dim2Title&quot;))
                _Dim2Title = appSettings[&quot;Dim2Title&quot;];

            if (appSettings.ContainsKey(&quot;Dim3Title&quot;))
                _Dim3Title = appSettings[&quot;Dim3Title&quot;];

            if (appSettings.ContainsKey(&quot;Logo&quot;))
                _logo = &quot;~/Images/&quot; + appSettings[&quot;Logo&quot;];

            if (appSettings.ContainsKey(&quot;LoginBox&quot;))
                _loginBox = &quot;/Images/&quot; + appSettings[&quot;LoginBox&quot;];

            if (appSettings.ContainsKey(&quot;LoginBoxADFS&quot;))
                _loginBoxADFS = &quot;/Images/&quot; + appSettings[&quot;LoginBoxADFS&quot;];

            if (appSettings.ContainsKey(&quot;LoginBox_Error&quot;))
                _loginBox_Error = &quot;/Images/&quot; + appSettings[&quot;LoginBox_Error&quot;];

            if (appSettings.ContainsKey(&quot;LoginBoxADFS_Error&quot;))
                _loginBoxADFS_Error = &quot;/Images/&quot; + appSettings[&quot;LoginBoxADFS_Error&quot;];

            if (appSettings.ContainsKey(&quot;Culture&quot;))
                _culture = appSettings[&quot;Culture&quot;];

            if (appSettings.ContainsKey(&quot;Build&quot;))
                _build = appSettings[&quot;Build&quot;];

            if (appSettings.ContainsKey(&quot;FORMAT_AMOUNT&quot;))
                _formatAmount = appSettings[&quot;FORMAT_AMOUNT&quot;];
            if (appSettings.ContainsKey(&quot;FORMAT_UNIT_PRICE&quot;))
                _formatUnitPrice = appSettings[&quot;FORMAT_UNIT_PRICE&quot;];
            if (appSettings.ContainsKey(&quot;FORMAT_QUANTITY&quot;))
                _formatQuantity = appSettings[&quot;FORMAT_QUANTITY&quot;];
            if (appSettings.ContainsKey(&quot;FORMAT_DATE&quot;))
                _formatDate = appSettings[&quot;FORMAT_DATE&quot;];
            if (appSettings.ContainsKey(&quot;FORMAT_DATETIME&quot;))
                _formatDateTime = appSettings[&quot;FORMAT_DATETIME&quot;];
            if (appSettings.ContainsKey(&quot;FORMAT_TIME&quot;))
                _formatTime = appSettings[&quot;FORMAT_TIME&quot;];

            if (appSettings.ContainsKey(&quot;WFActionMaxAttachmentSizeInMB&quot;))
                _wfActionMaxAttachmentSizeInMB = appSettings[&quot;WFActionMaxAttachmentSizeInMB&quot;].ToDecimal2();

            if (appSettings.ContainsKey(&quot;DefaultMaxAttachmentSizeInMB&quot;))
                _defaultMaxAttachmentSizeInMB = appSettings[&quot;DefaultMaxAttachmentSizeInMB&quot;].ToDecimal2();

            if (appSettings.ContainsKey(&quot;UseTerminology&quot;))
                _useTerminology = appSettings[&quot;UseTerminology&quot;];

            if (appSettings.ContainsKey(&quot;CurrentTimeZone&quot;))
                _currentTimezone = appSettings[&quot;CurrentTimeZone&quot;];

            if (appSettings.ContainsKey(&quot;BlockedFileTypes&quot;))
                _BlockedFileTypes = appSettings[&quot;BlockedFileTypes&quot;];

            if (appSettings.ContainsKey(&quot;CONTMGTLoadTreeOnDemand&quot;))
                _CONTMGTLoadTreeOnDemand = appSettings[&quot;CONTMGTLoadTreeOnDemand&quot;].ToBoolean2();

            if (appSettings.ContainsKey(&quot;ESTMATELoadTreeOnDemand&quot;))
                _ESTMATELoadTreeOnDemand = appSettings[&quot;ESTMATELoadTreeOnDemand&quot;].ToBoolean2();

            if (appSettings.ContainsKey(&quot;LANDMGTLoadTreeOnDemand&quot;))
                _LANDMGTLoadTreeOnDemand = appSettings[&quot;LANDMGTLoadTreeOnDemand&quot;].ToBoolean2();


            if (appSettings.ContainsKey(&quot;MOBILEAutoSyncInterval&quot;))
                _MOBILEAutoSyncInterval = appSettings[&quot;MOBILEAutoSyncInterval&quot;].ToString();

            if (appSettings.ContainsKey(&quot;MOBILEAutoSaveInterval&quot;))
                _MOBILEAutoSaveInterval = appSettings[&quot;MOBILEAutoSaveInterval&quot;].ToString();

            if (appSettings.ContainsKey(&quot;MobileShowDocumentsLink&quot;))
                _MobileShowDocumentsLink = appSettings[&quot;MobileShowDocumentsLink&quot;].ToString();


            if (appSettings.ContainsKey(&quot;MOBILEOfflineDuration&quot;))
                _MOBILEOfflineDuration = appSettings[&quot;MOBILEOfflineDuration&quot;].ToString();

            if (appSettings.ContainsKey(&quot;MobileEnableOfflineDocuments&quot;))
                MobileEnableOfflineDocuments = appSettings[&quot;MobileEnableOfflineDocuments&quot;].ToBoolean2();

            if (appSettings.ContainsKey(&quot;MobileIsEnterpriseEnabled&quot;))
                MobileIsEnterpriseEnabled = appSettings[&quot;MobileIsEnterpriseEnabled&quot;].ToBoolean2();
            
            string cData;
            if (appSettings.TryGetValue(&quot;CacheData&quot;, out cData) == false)
                cData = &quot;On&quot;;
            _cacheData = cData.Equals(&quot;On&quot;);

            string _sKeepCachedTemplatesInCache;
            if (!appSettings.TryGetValue(&quot;KeepCachedTemplatesInCache&quot;, out _sKeepCachedTemplatesInCache))
                _sKeepCachedTemplatesInCache = &quot;false&quot;;

            if (!bool.TryParse(_sKeepCachedTemplatesInCache, out _keepCachedTemplatesInCache))
                _keepCachedTemplatesInCache = false;

            bool hideProjectTree = (ConfigurationManager.AppSettings[&quot;HideProjectTree&quot;] ?? &quot;false&quot;).ToBoolean2();
            bool multiContracts = (ConfigurationManager.AppSettings[&quot;EPSModeMultiple&quot;] ?? &quot;OFF&quot;).ToUpper2() == &quot;ON&quot;;
            _IsSingleProjectMode = (hideProjectTree &amp;&amp; !multiContracts);

            if (appSettings.ContainsKey(&quot;MobileSyncInterval&quot;))
                _mobileSyncInterval = appSettings[&quot;MobileSyncInterval&quot;].ToDecimal2();

            if (appSettings.ContainsKey(&quot;MobileLastUserCount&quot;))
                _mobileLastUserCount = appSettings[&quot;MobileLastUserCount&quot;].ToInt32_2();

            DateFormatCulture.Instance.SetDateFormat(_culture, _formatDate);

            _dateSeparator = CoreDatabaseHelper.GetDateSeparator(FORMAT_DATE);

            DateFormatCulture.Instance.SetDateSeperatorFormat(_culture, DateSeparator);

            this.FORMAT_DATETIME = this.FORMAT_DATETIME.Replace(&quot;/&quot;, DateSeparator).Replace(&quot;-&quot;, DateSeparator);

            this.FORMAT_DATE = this.FORMAT_DATE.Replace(&quot;/&quot;, DateSeparator).Replace(&quot;-&quot;, DateSeparator);

            if (appSettings.ContainsKey(&quot;DocumentViewer&quot;))
            {
                DocumentViewer viewer = DocumentViewer.NotViewOne;
                Enum.TryParse&lt;DocumentViewer&gt;(appSettings[&quot;DocumentViewer&quot;], out viewer);
                _documentViewer = viewer;
            }

            if (appSettings.ContainsKey(&quot;DocmentOnlineViewer&quot;))
            {
                DocumentOnlineViewer onlineViewer = DocumentOnlineViewer.LocalViewer;
                Enum.TryParse&lt;DocumentOnlineViewer&gt;(appSettings[&quot;DocmentOnlineViewer&quot;], out onlineViewer);
                _documentOnlineViewer = onlineViewer;
            }

            if (appSettings.ContainsKey(&quot;LoginMode&quot;))
            {
                _loginMode = appSettings[&quot;LoginMode&quot;];
            }

            if (appSettings.ContainsKey(&quot;DomainName&quot;))
            {
                DomainName = appSettings[&quot;DomainName&quot;];
            }

            if (appSettings.ContainsKey(&quot;WFServiceAuthorizationToken&quot;))
            {
                _serviceAuthorizationToken = appSettings[&quot;WFServiceAuthorizationToken&quot;];
            }

            if (appSettings.ContainsKey(&quot;AuditLogType&quot;))
            {
                _auditLogType = appSettings[&quot;AuditLogType&quot;];
            }

            if (appSettings.ContainsKey(&quot;EnableAuditLogGlobally&quot;))
            {
                _enableAuditLogGlobally = appSettings[&quot;EnableAuditLogGlobally&quot;].ToBoolean2();
            }

            ResourceFactory.ClearResource();

            DateFormatCulture.SetDefaultThreadCultureToMWCulture_IfRequired();
            DateFormatCulture.SyncCurrentThreadCultureToMWCulture_IfRequired();

        }

        public void UpdateReportSettings()
        {
            #region Setting Culture Info

            CultureInfo ci = new CultureInfo(_culture);
            Thread.CurrentThread.CurrentCulture = ci;
            Thread.CurrentThread.CurrentUICulture = ci;

            #endregion

            string filePath = HttpContext.Current.Server.MapPath(_applogo);
            string currencySymbol = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);

            using (var image = new Bitmap(filePath))
            {
                var stream = new MemoryStream();
                image.Save(stream, ImageFormat.Bmp);
                try
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        string query = &quot;UPDATE SSRSAppSettings SET AppLogo = @appLogo, Currency = @currency&quot;;

                        using (DbCommand command = conn.DB.GetSqlStringCommand(query))
                        {
                            conn.DB.AddInParameter(command, &quot;appLogo&quot;, DbType.Binary, stream.ToArray());
                            conn.DB.AddInParameter(command, &quot;currency&quot;, DbType.String, currencySymbol);
                            int result2 = conn.DB.ExecuteNonQuery(command);
                        }
                    }
                }
                catch
                {
                }
            }
        }
    }

    [Serializable]
    public class BrixDataSet : DataSet, ISerializable
    {
        public BrixDataSet()
        {
            base.Locale = CultureInfo.InvariantCulture;
        }

        public BrixDataSet(string tableName)
            : base(tableName)
        {
            base.Locale = CultureInfo.InvariantCulture;
        }

        protected BrixDataSet(SerializationInfo info, StreamingContext context)
            : base(info, context)
        {
        }
    }

    [Serializable]
    public class BrixDataTable : DataTable, ISerializable
    {
        public BrixDataTable()
        {
            base.Locale = CultureInfo.InvariantCulture;
        }

        public BrixDataTable(string tableName)
            : base(tableName)
        {
            base.Locale = CultureInfo.InvariantCulture;
        }

        protected BrixDataTable(SerializationInfo info, StreamingContext context)
            : base(info, context)
        {
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[37,9,37,36,1],[37,37,37,38,1],[37,39,37,40,1],[45,59,45,60,0],[45,61,45,100,0],[45,101,45,102,0],[49,13,49,14,1],[50,17,50,51,1],[51,21,51,71,1],[52,17,52,29,1],[53,13,53,14,1],[57,9,57,10,1],[58,13,58,60,1],[59,17,59,67,1],[61,13,61,25,0],[62,9,62,10,1],[65,9,65,10,1],[66,13,66,71,1],[67,13,67,71,1],[68,9,68,10,1],[71,9,71,10,1],[72,13,72,71,1],[73,9,73,10,1],[80,9,80,10,1],[81,13,81,72,1],[83,13,83,40,1],[84,13,84,14,1],[85,17,87,22,1],[88,21,88,74,1],[90,17,92,21,1],[93,21,93,76,1],[94,13,94,14,1],[95,9,95,10,1],[98,9,98,10,1],[99,13,99,72,1],[100,13,100,40,1],[101,13,101,14,1],[103,17,105,22,1],[106,21,106,99,1],[108,17,110,21,1],[111,21,111,101,1],[112,13,112,14,1],[113,9,113,10,1],[120,9,120,63,1],[121,9,121,131,1],[128,9,128,10,1],[129,20,129,85,1],[130,13,130,14,1],[131,17,131,68,1],[132,17,132,96,1],[134,24,134,71,1],[135,17,135,18,1],[136,21,136,42,1],[137,21,137,22,1],[138,25,138,74,1],[139,25,139,26,0],[140,29,140,84,0],[141,25,141,26,0],[143,25,143,26,1],[144,29,144,87,1],[145,25,145,26,1],[146,21,146,22,1],[147,17,147,18,1],[148,17,148,36,1],[150,9,150,10,1],[160,9,160,10,1],[161,13,161,68,1],[162,13,162,46,1],[164,13,164,50,1],[166,13,166,84,1],[167,13,167,34,1],[168,13,168,14,1],[169,17,169,50,1],[170,17,170,71,1],[171,17,171,74,1],[172,17,172,39,1],[173,13,173,14,1],[175,13,175,35,1],[177,13,177,25,1],[178,13,178,44,1],[179,13,179,25,1],[181,17,182,119,1],[183,13,183,14,1],[184,17,184,96,1],[186,17,186,86,1],[187,17,187,115,1],[188,17,188,73,1],[189,17,189,46,1],[190,17,190,113,1],[194,17,194,28,1],[196,9,196,10,1],[199,9,199,10,0],[200,13,200,35,0],[201,9,201,10,0],[204,9,204,10,1],[205,13,205,81,1],[206,13,206,95,1],[207,13,207,14,1],[208,17,208,43,1],[209,17,209,109,1],[210,13,210,14,1],[211,9,211,10,1],[219,9,219,10,1],[220,13,220,109,1],[221,13,221,96,1],[222,13,222,14,1],[223,24,223,89,1],[224,17,224,18,1],[225,21,225,96,1],[226,21,226,86,1],[227,21,227,87,1],[228,21,228,56,1],[229,25,229,123,1],[231,25,231,37,1],[232,17,232,18,1],[233,13,233,14,1],[234,13,234,86,1],[235,9,235,10,1],[238,9,238,10,1],[240,13,240,14,1],[241,17,241,57,1],[243,17,243,32,1],[244,21,244,33,1],[246,17,246,35,1],[247,17,247,70,1],[248,17,248,78,1],[249,17,249,75,1],[250,21,250,110,1],[253,17,255,35,1],[257,17,257,55,1],[258,21,258,33,0],[259,17,259,55,1],[260,17,260,32,1],[261,17,261,18,1],[262,21,262,58,1],[263,25,263,100,1],[264,17,264,18,1],[265,17,265,28,1],[267,13,267,30,0],[268,13,268,14,0],[269,17,269,29,0],[271,9,271,10,1],[274,9,274,10,0],[276,13,276,14,0],[277,17,279,36,0],[280,17,280,35,0],[282,17,282,53,0],[283,17,283,32,0],[284,17,284,18,0],[285,21,285,58,0],[286,25,286,100,0],[287,17,287,18,0],[288,17,288,28,0],[290,13,290,42,0],[291,13,291,14,0],[292,17,292,29,0],[294,9,294,10,0],[298,9,298,10,1],[299,13,299,53,1],[301,13,301,28,1],[302,17,302,29,0],[304,13,304,37,1],[306,13,306,50,1],[306,52,306,94,1],[308,13,308,82,1],[309,17,309,88,1],[311,13,311,33,1],[312,13,312,14,1],[313,17,313,89,1],[314,17,315,136,1],[316,17,316,76,1],[317,21,317,59,0],[318,17,318,29,1],[320,13,320,25,1],[321,9,321,10,1],[324,9,324,10,1],[329,13,329,49,1],[331,13,331,56,1],[332,13,332,20,1],[332,22,332,33,1],[332,34,332,36,1],[332,37,332,119,1],[333,13,333,14,1],[334,17,334,55,1],[334,55,334,101,1],[334,101,334,103,1],[334,17,334,103,1],[335,17,335,38,1],[335,39,335,48,1],[337,17,337,18,1],[338,21,338,49,1],[339,21,339,83,1],[340,17,340,18,1],[341,17,341,22,0],[342,17,342,18,0],[343,21,343,56,0],[344,25,344,50,0],[345,17,345,18,0],[346,13,346,14,1],[347,13,347,20,1],[347,22,347,37,1],[347,38,347,40,1],[347,41,347,51,1],[348,13,348,14,1],[349,17,349,39,1],[349,40,349,49,0],[350,17,350,48,1],[351,13,351,14,1],[352,9,352,10,1],[355,9,355,10,1],[356,13,356,109,1],[357,9,357,10,1],[360,9,360,10,1],[361,13,361,94,1],[362,9,362,10,1],[365,9,365,10,1],[366,13,366,67,1],[367,9,367,10,1],[370,9,370,10,1],[371,13,371,48,1],[372,13,372,48,1],[373,13,373,35,1],[376,21,376,48,0],[377,21,377,27,0],[379,21,379,50,1],[380,21,380,27,1],[382,21,382,51,0],[383,21,383,27,0],[385,13,385,102,1],[386,9,386,10,1],[389,9,389,10,1],[390,13,392,33,1],[393,13,393,49,1],[394,13,394,34,1],[397,21,397,49,0],[398,21,398,27,0],[400,21,400,51,1],[401,21,401,27,1],[403,21,403,52,0],[404,21,404,27,0],[406,13,406,34,1],[407,9,407,10,1],[410,9,410,10,0],[412,13,412,14,0],[413,17,413,31,0],[414,17,414,18,0],[415,21,415,123,0],[416,21,416,47,0],[419,13,419,33,0],[420,13,420,14,0],[421,17,421,29,0],[423,13,423,18,0],[424,13,424,14,0],[425,17,425,23,0],[427,9,427,10,0],[430,9,430,10,0],[432,13,432,14,0],[433,24,433,89,0],[434,17,434,18,0],[435,21,435,94,0],[436,21,436,54,0],[437,21,437,91,0],[438,21,438,45,0],[439,25,439,97,0],[440,21,440,45,0],[441,25,441,97,0],[443,21,443,62,0],[446,13,446,33,0],[447,13,447,14,0],[448,17,448,27,0],[450,13,450,18,0],[451,13,451,14,0],[452,17,452,23,0],[454,9,454,10,0],[457,9,457,10,0],[459,13,459,14,0],[460,24,460,89,0],[461,17,461,18,0],[462,21,462,94,0],[463,21,463,91,0],[464,21,464,40,0],[465,25,465,87,0],[466,21,466,50,0],[467,21,467,30,0],[470,13,470,33,0],[471,13,471,14,0],[472,17,472,26,0],[474,13,474,18,0],[475,13,475,14,0],[476,17,476,23,0],[478,9,478,10,0],[481,9,481,10,0],[483,13,483,14,0],[484,24,484,89,0],[485,17,485,18,0],[486,21,487,106,0],[488,21,488,30,0],[491,13,491,33,0],[492,13,492,14,0],[493,17,493,26,0],[495,13,495,18,0],[496,13,496,14,0],[497,17,497,23,0],[499,9,499,10,0],[502,9,502,10,1],[504,13,504,14,1],[505,17,505,31,1],[506,17,506,18,1],[507,21,508,105,1],[509,21,509,30,1],[512,13,512,33,0],[513,13,513,14,0],[514,17,514,23,0],[516,13,516,18,0],[517,13,517,14,0],[518,17,518,23,0],[520,9,520,10,1],[523,9,523,10,1],[525,13,525,14,1],[526,17,526,31,1],[527,17,527,18,1],[528,21,530,84,1],[533,13,533,33,0],[534,13,534,14,0],[535,17,535,29,0],[537,13,537,18,0],[538,13,538,14,0],[539,17,539,23,0],[541,9,541,10,1],[544,9,544,10,1],[546,13,546,14,1],[547,17,547,31,1],[548,17,548,18,1],[549,21,551,56,1],[554,13,554,33,0],[555,13,555,14,0],[556,17,556,29,0],[558,13,558,18,0],[559,13,559,14,0],[560,17,560,23,0],[562,9,562,10,1],[565,9,565,10,0],[566,13,566,150,0],[567,13,567,53,0],[568,13,568,31,0],[570,9,570,10,0],[573,9,573,10,0],[574,13,574,134,0],[576,13,576,52,0],[577,17,577,40,0],[578,13,578,33,0],[579,9,579,10,0],[583,9,583,10,0],[584,13,584,72,0],[585,13,585,43,0],[586,13,586,14,0],[587,17,587,24,0],[587,26,587,36,0],[587,37,587,39,0],[587,40,587,57,0],[588,17,588,18,0],[589,21,592,65,0],[593,17,593,18,0],[594,13,594,14,0],[595,13,596,59,0],[597,9,597,10,0],[600,9,600,10,1],[601,13,601,45,1],[602,9,602,10,1],[607,9,607,10,1],[608,13,608,72,1],[609,13,609,43,1],[610,17,610,24,0],[610,26,610,36,0],[610,37,610,39,0],[610,40,610,57,0],[611,21,614,89,0],[615,13,615,52,1],[616,17,616,24,1],[616,26,616,41,1],[616,42,616,44,1],[616,45,616,71,1],[617,21,617,81,1],[618,13,619,56,1],[620,9,620,10,1],[629,9,629,10,1],[631,13,631,14,1],[632,17,632,94,1],[633,21,633,29,1],[636,17,636,60,1],[637,17,637,50,1],[638,17,638,64,1],[639,17,639,18,1],[640,21,640,67,1],[641,17,641,18,1],[642,17,642,47,1],[643,17,643,18,1],[644,21,644,56,1],[646,21,646,28,1],[646,30,646,40,1],[646,41,646,43,1],[646,44,646,66,1],[647,21,647,22,1],[648,25,649,87,1],[650,25,650,26,1],[651,29,656,100,1],[657,25,657,26,1],[658,21,658,22,1],[659,21,660,116,1],[661,21,661,91,1],[662,25,663,119,1],[664,17,664,18,1],[666,17,666,89,1],[668,17,668,67,1],[670,17,673,120,1],[676,17,676,72,1],[677,17,677,80,1],[678,17,678,27,1],[681,13,681,18,0],[682,13,682,14,0],[683,17,683,23,0],[685,9,685,10,1],[699,9,699,10,0],[701,13,701,14,0],[702,17,702,94,0],[703,21,703,29,0],[706,17,706,60,0],[707,17,707,50,0],[708,17,708,64,0],[709,17,709,18,0],[710,21,710,67,0],[711,17,711,18,0],[712,17,712,47,0],[713,17,713,18,0],[714,21,714,56,0],[716,21,716,28,0],[716,30,716,40,0],[716,41,716,43,0],[716,44,716,66,0],[717,21,717,22,0],[718,25,719,87,0],[720,25,720,26,0],[721,29,726,100,0],[727,25,727,26,0],[728,21,728,22,0],[729,21,730,116,0],[731,21,731,91,0],[732,25,733,119,0],[734,17,734,18,0],[736,17,736,89,0],[738,17,738,67,0],[740,17,743,150,0],[746,17,746,72,0],[747,17,747,80,0],[748,17,748,27,0],[751,13,751,18,0],[752,13,752,14,0],[753,17,753,23,0],[755,9,755,10,0],[761,9,761,10,0],[763,13,763,14,0],[764,17,764,94,0],[765,21,765,29,0],[767,17,767,76,0],[768,17,768,47,0],[769,21,769,28,0],[769,30,769,40,0],[769,41,769,43,0],[769,44,769,61,0],[770,25,773,93,0],[774,17,774,56,0],[775,21,775,28,0],[775,30,775,45,0],[775,46,775,48,0],[775,49,775,75,0],[776,25,776,85,0],[779,17,779,31,0],[780,17,780,18,0],[781,21,781,64,0],[782,21,782,54,0],[783,21,783,68,0],[784,21,784,22,0],[785,25,785,71,0],[786,21,786,22,0],[787,21,787,51,0],[788,21,788,22,0],[789,25,789,60,0],[791,25,791,32,0],[791,34,791,44,0],[791,45,791,47,0],[791,48,791,72,0],[792,25,792,26,0],[793,29,794,91,0],[795,29,795,30,0],[796,33,801,106,0],[802,29,802,30,0],[803,25,803,26,0],[804,25,805,120,0],[806,25,806,95,0],[807,29,808,123,0],[809,21,809,22,0],[811,21,811,93,0],[813,21,813,48,0],[816,21,818,60,0],[820,21,820,76,0],[821,21,821,84,0],[822,21,822,31,0],[825,13,825,18,0],[826,13,826,14,0],[827,17,827,23,0],[829,9,829,10,0],[834,9,834,10,0],[835,13,836,54,0],[837,9,837,10,0],[840,9,840,10,1],[848,13,848,49,1],[849,13,849,42,1],[850,13,850,40,1],[852,13,852,67,1],[853,13,853,14,1],[854,17,854,66,1],[855,17,855,38,1],[856,17,856,18,1],[857,21,857,50,1],[859,21,859,49,1],[860,21,860,121,1],[861,25,861,70,0],[863,21,863,56,1],[864,25,864,34,0],[866,21,866,50,1],[867,21,867,110,1],[868,21,868,22,0],[870,25,870,57,0],[871,25,871,57,0],[872,25,872,57,0],[873,25,873,56,0],[884,21,884,22,0],[886,21,886,74,1],[887,21,887,55,1],[889,21,889,143,1],[890,25,890,53,0],[892,21,892,48,1],[893,25,893,88,0],[894,26,894,76,1],[895,21,895,22,0],[897,25,897,114,0],[898,25,898,26,0],[901,29,901,129,0],[902,29,902,158,0],[906,29,906,173,0],[908,29,908,158,0],[909,25,909,26,0],[910,21,910,22,0],[912,25,912,93,1],[913,17,913,18,1],[914,13,914,14,1],[915,13,915,45,1],[916,13,919,107,1],[920,13,920,29,1],[921,9,921,10,1],[930,9,930,10,0],[936,13,936,87,0],[937,13,937,44,0],[938,13,938,52,0],[939,13,939,59,0],[940,13,940,42,0],[941,13,941,40,0],[943,13,943,67,0],[944,13,944,14,0],[945,17,945,66,0],[946,17,946,38,0],[947,17,947,18,0],[948,21,948,50,0],[950,21,950,49,0],[951,21,951,121,0],[952,25,952,70,0],[954,21,954,137,0],[955,25,955,86,0],[957,21,957,56,0],[958,25,958,34,0],[960,21,960,50,0],[961,21,961,110,0],[962,21,962,22,0],[964,25,964,57,0],[965,25,965,57,0],[966,25,966,57,0],[967,25,967,56,0],[968,21,968,22,0],[970,21,970,74,0],[971,21,971,55,0],[973,21,973,143,0],[974,25,974,53,0],[976,21,976,48,0],[977,21,977,22,0],[978,25,978,71,0],[979,29,979,147,0],[981,29,981,118,0],[982,21,982,22,0],[983,26,983,76,0],[984,21,984,22,0],[986,25,986,114,0],[987,25,987,26,0],[990,29,990,129,0],[991,29,991,158,0],[995,29,995,173,0],[998,29,998,75,0],[999,33,999,217,0],[1001,33,1001,188,0],[1002,25,1002,26,0],[1003,21,1003,22,0],[1005,21,1005,22,0],[1006,25,1006,71,0],[1007,29,1007,163,0],[1009,29,1009,134,0],[1010,21,1010,22,0],[1011,17,1011,18,0],[1012,13,1012,14,0],[1014,13,1014,53,0],[1015,13,1015,20,0],[1015,22,1015,56,0],[1015,57,1015,59,0],[1015,60,1015,71,0],[1016,13,1016,14,0],[1017,17,1017,40,0],[1018,17,1021,106,0],[1023,17,1023,81,0],[1024,17,1024,54,0],[1025,13,1025,14,0],[1026,13,1026,63,0],[1027,17,1027,29,0],[1028,13,1028,54,0],[1029,13,1029,51,0],[1030,9,1030,10,0],[1033,9,1033,10,0],[1034,13,1034,65,0],[1035,9,1035,10,0],[1038,9,1038,10,0],[1039,13,1043,55,0],[1046,13,1046,20,0],[1046,22,1046,39,0],[1046,40,1046,42,0],[1046,43,1046,50,0],[1047,13,1047,14,0],[1048,17,1048,47,0],[1049,17,1051,60,0],[1052,17,1052,76,0],[1053,17,1053,70,0],[1054,17,1054,83,0],[1056,17,1056,39,0],[1057,13,1057,14,0],[1058,9,1058,10,0],[1061,9,1061,10,0],[1062,13,1062,56,0],[1063,13,1063,14,0],[1064,24,1064,89,0],[1065,17,1065,18,0],[1066,21,1066,103,0],[1068,28,1068,68,0],[1069,21,1069,22,0],[1070,25,1070,52,0],[1071,25,1071,44,0],[1075,13,1075,33,0],[1076,9,1076,10,0],[1079,9,1079,10,1],[1080,13,1080,33,1],[1081,13,1081,121,1],[1082,13,1082,72,1],[1083,17,1083,35,1],[1084,13,1084,23,1],[1085,9,1085,10,1],[1088,9,1088,10,1],[1090,13,1091,127,1],[1093,9,1093,10,1],[1104,9,1104,10,1],[1105,13,1105,63,1],[1106,9,1106,10,1],[1116,9,1116,10,1],[1117,13,1118,38,1],[1119,13,1119,29,1],[1120,17,1120,39,1],[1122,17,1122,27,1],[1123,9,1123,10,1],[1132,9,1132,10,1],[1133,13,1133,71,1],[1134,9,1134,10,1],[1145,9,1145,10,1],[1146,13,1147,109,1],[1148,9,1148,10,1],[1184,9,1184,54,1],[1207,9,1207,57,1],[1208,9,1208,53,1],[1209,9,1209,62,1],[1210,9,1210,61,1],[1211,9,1211,51,1],[1212,9,1212,48,1],[1213,9,1213,63,1],[1214,9,1214,61,1],[1215,9,1215,60,1],[1232,9,1232,57,1],[1233,9,1233,53,1],[1239,9,1239,42,1],[1240,9,1240,10,1],[1241,13,1241,22,1],[1242,13,1242,50,1],[1243,9,1243,10,1],[1247,17,1247,18,1],[1247,19,1247,33,1],[1247,34,1247,35,1],[1252,17,1252,18,1],[1252,19,1252,35,1],[1252,36,1252,37,1],[1257,17,1257,18,1],[1257,19,1257,38,1],[1257,39,1257,40,1],[1262,17,1262,18,1],[1262,19,1262,38,1],[1262,39,1262,40,1],[1267,17,1267,18,1],[1267,19,1267,39,1],[1267,40,1267,41,1],[1272,17,1272,18,1],[1272,19,1272,48,1],[1272,49,1272,50,1],[1277,17,1277,18,1],[1277,19,1277,36,1],[1277,37,1277,38,1],[1282,17,1282,18,1],[1282,19,1282,35,1],[1282,36,1282,37,1],[1287,17,1287,18,1],[1287,19,1287,54,1],[1287,55,1287,56,1],[1292,17,1292,18,0],[1292,19,1292,39,0],[1292,40,1292,41,0],[1297,17,1297,18,0],[1297,19,1297,39,0],[1297,40,1297,41,0],[1302,17,1302,18,1],[1302,19,1302,40,1],[1302,41,1302,42,1],[1307,17,1307,18,1],[1307,19,1307,41,1],[1307,42,1307,43,1],[1312,17,1312,18,1],[1312,19,1312,83,1],[1312,84,1312,85,1],[1317,17,1317,18,1],[1317,19,1317,82,1],[1317,83,1317,84,1],[1322,17,1322,18,1],[1322,19,1322,83,1],[1322,84,1322,85,1],[1327,17,1327,18,1],[1327,19,1327,32,1],[1327,33,1327,34,1],[1332,17,1332,18,1],[1332,19,1332,36,1],[1332,37,1332,38,1],[1337,17,1337,18,0],[1337,19,1337,40,0],[1337,41,1337,42,0],[1342,17,1342,18,0],[1342,19,1342,42,0],[1342,43,1342,44,0],[1347,17,1347,18,0],[1347,19,1347,46,0],[1347,47,1347,48,0],[1352,17,1352,18,1],[1352,19,1352,35,1],[1352,36,1352,37,1],[1357,17,1357,18,0],[1357,19,1357,33,0],[1357,34,1357,35,0],[1362,17,1362,18,1],[1362,19,1362,40,1],[1362,41,1362,42,1],[1367,17,1367,18,1],[1367,19,1367,44,1],[1367,45,1367,46,1],[1372,17,1372,18,1],[1372,19,1372,43,1],[1372,44,1372,45,1],[1377,17,1377,18,1],[1377,19,1377,42,1],[1377,43,1377,44,1],[1380,41,1380,42,1],[1380,43,1380,62,1],[1380,63,1380,64,1],[1380,77,1380,78,1],[1380,79,1380,99,1],[1380,100,1380,101,1],[1384,17,1384,18,1],[1384,19,1384,38,1],[1384,39,1384,40,1],[1387,45,1387,46,1],[1387,47,1387,70,1],[1387,71,1387,72,1],[1387,85,1387,86,1],[1387,87,1387,111,1],[1387,112,1387,113,1],[1391,17,1391,18,0],[1391,19,1391,57,0],[1391,58,1391,59,0],[1396,17,1396,18,0],[1396,19,1396,56,0],[1396,57,1396,58,0],[1402,13,1402,14,1],[1403,17,1403,39,1],[1404,13,1404,14,1],[1409,17,1409,18,1],[1409,19,1409,42,1],[1409,43,1409,44,1],[1414,17,1414,18,1],[1414,19,1414,43,1],[1414,44,1414,45,1],[1419,17,1419,18,1],[1419,19,1419,51,1],[1419,52,1419,53,1],[1424,17,1424,18,1],[1424,19,1424,51,1],[1424,52,1424,53,1],[1429,17,1429,18,1],[1429,19,1429,51,1],[1429,52,1429,53,1],[1434,17,1434,18,1],[1434,19,1434,47,1],[1434,48,1434,49,1],[1439,17,1439,18,1],[1439,19,1439,44,1],[1439,45,1439,46,1],[1443,9,1443,10,1],[1444,13,1444,61,1],[1444,62,1444,75,1],[1445,13,1445,20,0],[1445,22,1445,30,0],[1445,31,1445,33,0],[1445,34,1445,61,0],[1446,13,1446,14,0],[1447,17,1447,83,0],[1448,21,1448,33,0],[1450,13,1450,14,0],[1452,13,1452,26,0],[1453,9,1453,10,1],[1458,13,1458,14,1],[1459,17,1459,67,1],[1460,17,1460,63,1],[1461,17,1461,18,1],[1462,21,1462,110,1],[1464,21,1466,108,1],[1468,17,1468,30,0],[1469,13,1469,14,1],[1475,13,1475,14,1],[1476,17,1479,36,1],[1480,13,1480,14,1],[1485,17,1485,18,1],[1485,19,1485,47,1],[1485,48,1485,49,1],[1490,17,1490,18,1],[1490,19,1490,50,1],[1490,51,1490,52,1],[1496,17,1496,18,1],[1496,19,1496,50,1],[1496,51,1496,52,1],[1501,17,1501,18,1],[1501,19,1501,51,1],[1501,52,1501,53,1],[1506,17,1506,18,1],[1506,19,1506,49,1],[1506,50,1506,51,1],[1511,17,1511,18,1],[1511,19,1511,46,1],[1511,47,1511,48,1],[1516,17,1516,18,1],[1516,19,1516,37,1],[1516,38,1516,39,1],[1524,17,1524,18,0],[1524,19,1524,54,0],[1524,55,1524,56,0],[1530,13,1530,14,1],[1531,17,1531,40,1],[1532,13,1532,14,1],[1538,13,1538,14,0],[1539,17,1539,46,0],[1540,13,1540,14,0],[1546,13,1546,14,1],[1547,17,1547,54,1],[1548,17,1548,18,0],[1549,21,1549,88,0],[1550,17,1550,18,0],[1552,17,1552,35,1],[1553,13,1553,14,1],[1559,13,1559,14,1],[1560,17,1560,55,1],[1561,13,1561,14,1],[1567,13,1567,14,1],[1568,17,1568,53,1],[1569,13,1569,14,1],[1572,36,1572,40,1],[1572,41,1572,45,1],[1580,13,1580,14,1],[1581,17,1581,34,1],[1583,17,1583,61,1],[1584,21,1584,67,1],[1586,17,1586,32,1],[1587,13,1587,14,1],[1593,13,1593,14,1],[1594,17,1594,89,1],[1596,17,1596,86,1],[1597,13,1597,14,1],[1600,52,1600,56,1],[1600,57,1600,61,1],[1602,49,1602,53,0],[1602,54,1602,58,0],[1608,13,1608,14,1],[1609,17,1609,51,1],[1610,13,1610,14,1],[1616,13,1616,14,1],[1617,17,1617,38,1],[1618,13,1618,14,1],[1624,13,1624,14,1],[1625,17,1625,48,1],[1626,13,1626,14,1],[1630,9,1630,10,1],[1631,13,1631,71,1],[1634,13,1634,73,1],[1635,17,1635,33,0],[1637,13,1638,106,1],[1639,17,1639,63,0],[1641,17,1641,77,1],[1643,13,1643,81,1],[1644,17,1644,49,0],[1646,13,1646,80,1],[1647,17,1647,52,0],[1649,13,1649,75,1],[1650,17,1650,30,0],[1651,13,1651,46,1],[1653,13,1653,101,1],[1654,17,1654,44,0],[1656,13,1656,75,1],[1657,17,1657,31,0],[1659,13,1659,113,1],[1660,17,1660,52,0],[1662,13,1662,77,1],[1663,17,1663,32,0],[1665,13,1666,106,1],[1667,17,1667,67,1],[1669,17,1669,81,1],[1671,13,1672,106,1],[1673,17,1673,67,1],[1675,17,1675,81,1],[1677,13,1677,57,1],[1678,17,1678,61,1],[1680,13,1680,58,1],[1681,17,1681,63,1],[1683,13,1683,54,1],[1684,17,1684,55,1],[1686,13,1686,54,1],[1687,17,1687,55,1],[1689,13,1689,54,1],[1690,17,1690,55,1],[1692,13,1692,49,1],[1693,17,1693,59,1],[1695,13,1695,53,1],[1696,17,1696,66,1],[1698,13,1698,57,1],[1699,17,1699,74,1],[1701,13,1701,59,1],[1702,17,1702,78,1],[1704,13,1704,63,1],[1705,17,1705,86,1],[1707,13,1707,52,1],[1708,17,1708,51,1],[1710,13,1710,50,1],[1711,17,1711,47,1],[1713,13,1713,58,1],[1714,17,1714,62,1],[1715,13,1715,62,1],[1716,17,1716,69,1],[1717,13,1717,60,1],[1718,17,1718,66,1],[1719,13,1719,56,1],[1720,17,1720,58,1],[1721,13,1721,60,1],[1722,17,1722,66,1],[1723,13,1723,56,1],[1724,17,1724,58,1],[1726,13,1726,74,1],[1727,17,1727,108,1],[1729,13,1729,73,1],[1730,17,1730,106,1],[1732,13,1732,59,1],[1733,17,1733,65,1],[1735,13,1735,60,1],[1736,17,1736,67,1],[1738,13,1738,61,1],[1739,17,1739,69,1],[1741,13,1741,68,1],[1742,17,1742,96,1],[1744,13,1744,68,1],[1745,17,1745,96,1],[1747,13,1747,68,1],[1748,17,1748,96,1],[1751,13,1751,67,1],[1752,17,1752,92,1],[1754,13,1754,67,1],[1755,17,1755,92,1],[1757,13,1757,68,1],[1758,17,1758,94,1],[1761,13,1761,66,1],[1762,17,1762,90,1],[1764,13,1764,73,1],[1765,17,1765,105,1],[1767,13,1767,70,1],[1768,17,1768,99,0],[1771,13,1771,74,1],[1772,17,1772,30,0],[1773,13,1773,45,1],[1776,13,1776,106,1],[1777,17,1777,56,0],[1779,13,1779,95,1],[1780,17,1780,53,0],[1782,13,1782,114,1],[1783,13,1783,117,1],[1784,13,1784,73,1],[1786,13,1786,63,1],[1787,17,1787,86,1],[1789,13,1789,64,1],[1790,17,1790,87,1],[1792,13,1792,77,1],[1794,13,1794,79,1],[1796,13,1796,88,1],[1798,13,1798,113,1],[1800,13,1800,105,1],[1802,13,1802,59,1],[1803,13,1803,14,1],[1804,17,1804,67,1],[1805,17,1805,90,1],[1806,17,1806,42,1],[1807,13,1807,14,1],[1809,13,1809,64,1],[1810,13,1810,14,1],[1811,17,1811,86,1],[1812,17,1812,107,1],[1813,17,1813,54,1],[1814,13,1814,14,1],[1816,13,1816,54,1],[1817,13,1817,14,1],[1818,17,1818,55,1],[1819,13,1819,14,1],[1821,13,1821,55,1],[1822,13,1822,14,1],[1823,17,1823,56,1],[1824,13,1824,14,1],[1826,13,1826,72,1],[1827,13,1827,14,1],[1828,17,1828,89,1],[1829,13,1829,14,1],[1831,13,1831,57,1],[1832,13,1832,14,1],[1833,17,1833,61,1],[1834,13,1834,14,1],[1836,13,1836,67,1],[1837,13,1837,14,1],[1838,17,1838,94,1],[1839,13,1839,14,1],[1841,13,1841,45,1],[1843,13,1843,79,1],[1844,13,1844,80,1],[1846,9,1846,10,1],[1849,9,1849,10,1],[1852,13,1852,56,1],[1853,13,1853,54,1],[1854,13,1854,56,1],[1858,13,1858,76,1],[1859,13,1859,101,1],[1861,20,1861,52,1],[1862,13,1862,14,1],[1863,17,1863,49,1],[1864,17,1864,53,1],[1866,17,1866,18,1],[1867,28,1867,93,1],[1868,21,1868,22,1],[1869,25,1869,110,1],[1871,32,1871,86,1],[1872,25,1872,26,1],[1873,29,1873,105,1],[1874,29,1874,104,1],[1875,29,1875,76,1],[1876,25,1876,26,1],[1877,21,1877,22,1],[1878,17,1878,18,1],[1879,17,1879,22,0],[1880,17,1880,18,0],[1881,17,1881,18,0],[1882,13,1882,14,1],[1883,9,1883,10,1],[1889,9,1889,29,1],[1890,9,1890,10,1],[1891,13,1891,56,1],[1892,9,1892,10,1],[1895,15,1895,30,1],[1896,9,1896,10,1],[1897,13,1897,56,1],[1898,9,1898,10,1],[1901,15,1901,34,1],[1902,9,1902,10,1],[1903,9,1903,10,1],[1909,9,1909,31,1],[1910,9,1910,10,1],[1911,13,1911,56,1],[1912,9,1912,10,1],[1915,15,1915,30,1],[1916,9,1916,10,1],[1917,13,1917,56,1],[1918,9,1918,10,1],[1921,15,1921,34,1],[1922,9,1922,10,1],[1923,9,1923,10,1]]);
    </script>
  </body>
</html>