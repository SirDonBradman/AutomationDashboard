<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\XmlForm Framework\FormComponents\Text.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Xml;
using System.Xml.Serialization;

namespace Aurigo.Brix.Platform.BusinessLayer.XMLForm
{
    public class Text : ControlContainer
    {
        [XmlAnyElement]
        public XmlElement[] AllElements;

        [FormDesignerInclude(Name = &quot;Markup&quot;)]
        public string Markup
        {
            set
            {
                if (AllElements != null &amp;&amp; AllElements.Length &gt; 0)
                {
                    XmlElement elem = AllElements[0].OwnerDocument.CreateElement(&quot;Markup&quot;);
                    elem.InnerXml = EscapeSpecialChar(value);
                    AllElements = new XmlElement[] { elem };
                }
                else
                {
                    if (!string.IsNullOrEmpty(value))
                    {
                        XmlDocument doc = new XmlDocument();
                        doc.LoadXml(&quot;&lt;Root&gt;&quot; + EscapeSpecialChar(value) + &quot;&lt;/Root&gt;&quot;);
                        AllElements = new XmlElement[] { doc.DocumentElement };
                    }
                }
            }
            get
            {
                string str = string.Empty;
                if (AllElements != null &amp;&amp; AllElements.Length &gt; 0)
                {
                    foreach (XmlElement elem in AllElements)
                    {
                        str += elem.InnerXml.Replace(&quot;&lt;Root&gt;&quot;, &quot;&quot;).Replace(&quot;&lt;/Root&gt;&quot;, &quot;&quot;);
                    }
                }
                return UnEscapeSpecialChar(str);
            }
        }

        public override void Render(object parent, RenderFormat format)
        {
            if (form.Renderer.ContainerRenderers[(int)ContainerTypes.Text] != null)
                form.Renderer.ContainerRenderers[(int)ContainerTypes.Text](this, parent);
        }

        public string EscapeSpecialChar(string str)
        {
            //Temporary fix. Need to look into this.
            return str.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).
                Replace(&quot;&amp;&amp;amp;&quot;, &quot;&amp;amp;&quot;).
                Replace(&quot;&amp;amp;nbsp;&quot;, &quot; &quot;);
        }

        public string UnEscapeSpecialChar(string str)
        {
            //Temporary fix. Need to look into this.
            return str.Replace(&quot;&amp;amp;&quot;, &quot;&amp;&quot;);
        }
    }

}
    </pre>
    <script type="text/javascript">
      highlightRanges([[19,13,19,14,0],[20,17,20,67,0],[21,17,21,18,0],[22,21,22,92,0],[23,21,23,62,0],[24,21,24,61,0],[25,17,25,18,0],[27,17,27,18,0],[28,21,28,54,0],[29,21,29,22,0],[30,25,30,61,0],[31,25,31,86,0],[32,25,32,80,0],[33,21,33,22,0],[34,17,34,18,0],[35,13,35,14,0],[37,13,37,14,0],[38,17,38,43,0],[39,17,39,67,0],[40,17,40,18,0],[41,21,41,28,0],[41,30,41,45,0],[41,46,41,48,0],[41,49,41,60,0],[42,21,42,22,0],[43,25,43,91,0],[44,21,44,22,0],[45,17,45,18,0],[46,17,46,49,0],[47,13,47,14,0],[51,9,51,10,0],[52,13,52,84,0],[53,17,53,90,0],[54,9,54,10,0],[57,9,57,10,0],[59,13,61,44,0],[62,9,62,10,0],[65,9,65,10,0],[67,13,67,46,0],[68,9,68,10,0]]);
    </script>
  </body>
</html>