<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\UserControls\HierarchicalGrid.ascx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using System.Text;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using System.Linq;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using Telerik.Web.UI;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.AMP3.Core.UserControls
{
    public delegate void SaveHandler(object sender, ItemsArgs e);

    public delegate void OnDemandFetchHandler(HierarchicalGrid sender, int itemID);

    public delegate void OnDemandFetchHandlerWIthAltID(HierarchicalGrid sender, int id, int altID);

    public partial class HierarchicalGrid : UserControl, ICallbackEventHandler
    {
        private DataTable activityTable;
        private HierarchicalGridColumn amountColumn;
        private string callbackResult;
        private HierarchicalGridColumns columns;
        private string containerIDColumn;
        private string containerNameColumn;
        private DataTable containerTable;
        private string hdnReferenceItemTypeCID;
        private bool isAmountColumnVisible;
        private bool isExpenseColumnVisible;
        private bool showContainerDetails;
        private int showContainerDetailsAtPosition;
        private bool isCalculateQtyOnChecked;
        private bool isCheckBoxVisible = true;
        private bool isItemSummaryVisible;
        private bool isReadOnly;
        private string itemContainerIDColumn;
        private string itemIDColumn;
        private string itemNameColumn;
        private HierarchicalGridColumns itemSummaryDetails;
        private DataTable itemSummaryTable;
        private DataTable expenseSummaryTable;
        private DataTable itemTable;
        private string lnkDeleteClientID;
        private string lnkEditClientID;
        private string lnkNewClientID;
        private string lnkRateAnalysisClientID;
        private string lnkSubItemsClientID;
        private string lnkViewClientID;
        private HierarchicalGridSource nodeTable;
        private string parentContainerIDColumn;
        private string quantityColumn;
        private DataTable subItemTable;
        private int topMostTableWidth;

        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        public string ColumnsToExcludeFromHTMLEncoding
        {
            get; set;
        }

        public DataTable ContainerTable
        {
            get { return containerTable; }
            set { containerTable = value; }
        }

        public DataTable ItemTable
        {
            get { return itemTable; }
            set { itemTable = value; }
        }

        public DataTable ItemSummaryTable
        {
            get { return itemSummaryTable; }
            set { itemSummaryTable = value; }
        }

        public DataTable ExpenseSummaryTable
        {
            get { return expenseSummaryTable; }
            set { expenseSummaryTable = value; }
        }

        public DataTable SubItemTable
        {
            get { return subItemTable; }
            set { subItemTable = value; }
        }

        public DataTable ActivityTable
        {
            get { return activityTable; }
            set { activityTable = value; }
        }

        public string ContainerIDColumn
        {
            get { return containerIDColumn; }
            set { containerIDColumn = value; }
        }

        public string ParentContainerIDColumn
        {
            get { return parentContainerIDColumn; }
            set { parentContainerIDColumn = value; }
        }

        public string ContainerNameColumn
        {
            get { return containerNameColumn; }
            set { containerNameColumn = value; }
        }

        public string ItemIDColumn
        {
            get { return itemIDColumn; }
            set { itemIDColumn = value; }
        }

        public string ItemNameColumn
        {
            get { return itemNameColumn; }
            set { itemNameColumn = value; }
        }

        public string ItemContainerIDColumn
        {
            get { return itemContainerIDColumn; }
            set { itemContainerIDColumn = value; }
        }

        public string CallbackResult
        {
            get { return callbackResult; }
            set { callbackResult = value; }
        }

        public string LnkNewClientID
        {
            get { return lnkNewClientID; }
            set { lnkNewClientID = value; }
        }

        public string LnkEditClientID
        {
            get { return lnkEditClientID; }
            set { lnkEditClientID = value; }
        }

        public string LnkViewClientID
        {
            get { return lnkViewClientID; }
            set { lnkViewClientID = value; }
        }

        public string LnkDeleteClientID
        {
            get { return lnkDeleteClientID; }
            set { lnkDeleteClientID = value; }
        }

        public string LnkSubItemsClientID
        {
            get { return lnkSubItemsClientID; }
            set { lnkSubItemsClientID = value; }
        }

        public string LnkRateAnalysisClientID
        {
            get { return lnkRateAnalysisClientID; }
            set { lnkRateAnalysisClientID = value; }
        }

        public string HdnReferenceItemTypeCID
        {
            get { return hdnReferenceItemTypeCID; }
            set { hdnReferenceItemTypeCID = value; }
        }

        public HiddenField HdnSelectedRowID
        {
            get { return hdnSelectedRowID; }
            set { hdnSelectedRowID = value; }
        }

        public string OnCellBlur
        {
            get { return hdnOnCellBlur.Value; }
            set { hdnOnCellBlur.Value = value; }
        }

        public HierarchicalGridColumns Columns
        {
            get { return columns; }
            set { columns = value; }
        }

        public HierarchicalGridColumns ItemSummaryDetails
        {
            get { return itemSummaryDetails; }
            set { itemSummaryDetails = value; }
        }

        public HierarchicalGridColumn AmountColumn
        {
            get { return amountColumn; }
            set { amountColumn = value; }
        }

        public bool IsReadOnly
        {
            get { return isReadOnly; }
            set { isReadOnly = value; }
        }

        public bool IsCompleteReadOnly { get; set; }

        public bool IsItemSummaryVisible
        {
            get { return isItemSummaryVisible; }
            set { isItemSummaryVisible = value; }
        }

        public bool IsAmountColumnVisible
        {
            get { return isAmountColumnVisible; }
            set { isAmountColumnVisible = value; }
        }

        public bool IsExpenseColumnVisible
        {
            get { return isExpenseColumnVisible; }
            set { isExpenseColumnVisible = value; }
        }

        public bool ShowContainerDetails
        {
            get { return showContainerDetails; }
            set { showContainerDetails = value; }
        }

        public int ShowContainerDetailsAtPosition
        {
            get { return showContainerDetailsAtPosition; }
            set { showContainerDetailsAtPosition = value; }
        }

        public bool IsCheckBoxVisible
        {
            get { return isCheckBoxVisible; }
            set { isCheckBoxVisible = value; }
        }

        public bool IsCalculateQtyOnChecked
        {
            get { return isCalculateQtyOnChecked; }
            set { isCalculateQtyOnChecked = value; }
        }

        public string QuantityColumn
        {
            get { return quantityColumn; }
            set { quantityColumn = value; }
        }

        public ItemListModel ParentItemListModel { get; set; }

        public string CheckedContainers
        {
            get { return hdnContainerID.Value; }
            set { hdnContainerID.Value = value; }
        }

        public string CheckedItems
        {
            get { return hdnItemID.Value; }
            set { hdnItemID.Value = value; }
        }

        public string CheckedSubItems
        {
            get { return hdnSubItemID.Value; }
            set { hdnSubItemID.Value = value; }
        }

        public string CheckedActivities
        {
            get { return hdnActivityID.Value; }
            set { hdnActivityID.Value = value; }
        }

        public string TreeColumnNavigateURL { get; set; }
        public string TreeColumnJavascript { get; set; }
        public string TreeColumnContainerNavigateUrl { get; set; }
        public bool TreeColumnShowChildCount { get; set; }
        public bool TreeColumnShowChildCountForRoot { get; set; }

        public string TreeColumnCaption = &quot;Name&quot;;

        public string ProgressBarColumnName { get; set; }

        public string SelectedRowID
        {
            get
            {
                if (!string.IsNullOrEmpty(hdnSelectedRowID.Value) &amp;&amp; hdnSelectedRowID.Value.Contains(&quot;_&quot;))
                    return hdnSelectedRowID.Value.Split(&#39;_&#39;)[1];
                else
                    return &quot;&quot;;
            }
        }

        public string SelectedRowType
        {
            get
            {
                if (!string.IsNullOrEmpty(hdnSelectedRowID.Value) &amp;&amp; hdnSelectedRowID.Value.Contains(&quot;_&quot;))
                    return hdnSelectedRowID.Value.Split(&#39;_&#39;)[0].Replace(&quot;item&quot;, &quot;Item&quot;).Replace(&quot;subItemTR&quot;, &quot;SubItem&quot;)
                        .Replace(&quot;containerTR&quot;, &quot;Container&quot;).Replace(&quot;activityTR&quot;, &quot;Activity&quot;);
                else
                    return &quot;&quot;;
            }
        }

        public string expandedContainers { get; set; }
        public string expandedItems { get; set; }
        public string expandedSubItems { get; set; }
        public bool disableGridSaveButton { get; set; }

        public SortOrder sortOrder
        {
            get { return GetSortOrderFromSession(); }
            set
            {
                SortOrder srtOrdr = new SortOrder(value.SortColumn);

                if (Session[&quot;SortKey_&quot; + Request[&quot;Context&quot;]] != null)
                {
                    srtOrdr = GetSortOrderFromSession();

                    if (srtOrdr.SortColumn.Equals(value.SortColumn))
                    {
                        srtOrdr.SortDirection = (srtOrdr.SortDirection.Equals(SortDirection.Descending)
                            ? SortDirection.Ascending
                            : SortDirection.Descending);
                    }
                    else
                        srtOrdr = new SortOrder(value.SortColumn);
                }

                Session[&quot;SortKey_&quot; + Request[&quot;Context&quot;]] = srtOrdr.SortColumn + &quot; &quot; +
                                                           (srtOrdr.SortDirection.Equals(SortDirection.Descending)
                                                               ? &quot;DESC&quot;
                                                               : &quot;ASC&quot;);
            }
        }

        public bool HasActivities = true;

        List&lt;string&gt; _ColsToExcludeFromHTMLEncoding = null;
        private List&lt;string&gt; ColsToExcludeFromHTMLEncoding
        {
            get
            {
                if (_ColsToExcludeFromHTMLEncoding == null)
                {
                    _ColsToExcludeFromHTMLEncoding = string.IsNullOrEmpty(ColumnsToExcludeFromHTMLEncoding) ? new List&lt;string&gt;()
                            : new List&lt;string&gt;(ColumnsToExcludeFromHTMLEncoding.Split(&#39;,&#39;));
                }
                return _ColsToExcludeFromHTMLEncoding;
            }
        }

        #region ICallbackEventHandler Members

        public void RaiseCallbackEvent(string arguments)
        {


            // process the arguments and do the required job then  - pass it to the _callbackResult.
            string[] args = arguments.Split(&quot;&amp;&quot;.ToCharArray());
            var dic = new Dictionary&lt;string, string&gt;();
            var dicTemp = new Dictionary&lt;string, string&gt;();
            foreach (string str in args)
            {
                string[] tmpArray = str.Split(&quot;=&quot;.ToCharArray());
                dic.Add(tmpArray[0], tmpArray[1]);
            }
            if (dic.ContainsKey(&quot;EC&quot;))
            {
                //Session[&quot;expandedContainers&quot;] = dic[&quot;EC&quot;];
                HierarchicalGridState HGridState;
                if (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] != null)
                    HGridState = (HierarchicalGridState)Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]];
                // GET THE SAME SESSION VARIABLE
                else
                    HGridState = new HierarchicalGridState();

                HGridState.ExpandedContianers = dic[&quot;EC&quot;];
                HGridState.ExpandedItems = dic[&quot;EI&quot;];
                HGridState.ExpandedSubItems = dic[&quot;ESI&quot;];

                if (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] == null)
                    // IF IT DOESN&#39;T EXIST IN THE SESSION ASSIGN IT.
                    Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] = HGridState;

                dic.Remove(&quot;EC&quot;);
                dic.Remove(&quot;EI&quot;);
                dic.Remove(&quot;ESI&quot;);
            }

            if (dic.ContainsKey(&quot;expandAll&quot;))
            {
                //Session[&quot;expandAll&quot;] = dic[&quot;expandAll&quot;];
                HierarchicalGridState HGridState;
                if (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] != null)
                    HGridState = (HierarchicalGridState)Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]];
                // GET THE SAME SESSION VARIABLE
                else
                    HGridState = new HierarchicalGridState();
                HGridState.ExpandedAll = (dic[&quot;expandAll&quot;] == &quot;1&quot;) ? true : false;
                HGridState.ExpandedContianers = string.Empty;

                if (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] == null)
                    // IF IT DOESN&#39;T EXIST IN THE SESSION ASSIGN IT.
                    Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] = HGridState;

                //Session[&quot;expandedContainers&quot;] = null;
                dic.Remove(&quot;expandAll&quot;);
            }

            foreach (var pair in dic)
            {
                string tempStr = pair.Value.Replace(&quot;^^&quot;, &quot;=&quot;);
                tempStr = tempStr.Replace(&quot;~~&quot;, &quot;&amp;&quot;);
                dicTemp.Add(pair.Key, tempStr);
            }

            dic = dicTemp;


            if (dic[&quot;action&quot;] == &quot;getChildren&quot;)
            {
                string id = dic[&quot;id&quot;];
                int level = dic[&quot;level&quot;].Parse2();
                var filterInfo = JsonConvert.DeserializeObject&lt;List&lt;FilterInfo&gt;&gt;(dic[&quot;AllFilter&quot;].ToString());
                PrepareFilter(filterInfo);
                if (dic.ContainsKey(&quot;EditedInfo&quot;))
                {
                    ParseModifiedInfo(dic[&quot;EditedInfo&quot;]);
                }

                nodeTable.Bind();

                Container toBeProcessed = nodeTable.GetContainerById(id);
                callbackResult = nodeTable.DrawContainer(toBeProcessed, level + 1, 0, ColsToExcludeFromHTMLEncoding);
            }
            else if (dic[&quot;action&quot;] == &quot;save&quot;)
            {
                dic.Remove(&quot;action&quot;);
                var itemsArgs = new ItemsArgs(dic, columns);

                saveEditedItems(this, itemsArgs);

                if (callbackResult == &quot;1&quot;)
                {
                    var sb = new StringBuilder();
                    RenderGridDataHTML(sb);
                    sb.Append(&quot;&lt;summary&gt;&quot;);
                    if (IsItemSummaryVisible)
                        RenderSummaryHTML(sb);
                    callbackResult = sb.ToString2(); // means saved successfully
                }
                else
                {
                    //  VERIFY IT STARTS WITH Error:
                    if (!callbackResult.StartsWith2(&quot;Error:&quot;)) callbackResult = &quot;Error:&quot; + callbackResult;
                }
            }
            else if (dic[&quot;action&quot;] == &quot;sortItems&quot;)
            {
                if (dic.ContainsKey(&quot;sortedColumn&quot;) &amp;&amp; !string.IsNullOrEmpty(dic[&quot;sortedColumn&quot;]))
                {
                    if (dic.ContainsKey(&quot;EditedInfo&quot;))
                    {
                        ParseModifiedInfo(dic[&quot;EditedInfo&quot;]);
                    }
                    var filterInfo = JsonConvert.DeserializeObject&lt;List&lt;FilterInfo&gt;&gt;(dic[&quot;AllFilter&quot;].ToString());
                    PrepareFilter(filterInfo);
                    sortOrder = new SortOrder(dic[&quot;sortedColumn&quot;]);
                    var sb = new StringBuilder();
                    RenderHeaderHTML(sb);
                    sb.Append(&quot;&lt;gridData&gt;&quot;);
                    RenderGridDataHTML(sb);
                    callbackResult = sb.ToString2();
                }
            }
            else if (dic[&quot;action&quot;] == &quot;toggleExpandAll&quot;)
            {
                var sb = new StringBuilder();
                RenderGridDataHTML(sb);
                callbackResult = sb.ToString2();
            }
            else if (dic[&quot;action&quot;] == &quot;fetchActivities&quot;)
            {
                int id = dic[&quot;id&quot;].Parse2();
                string path = dic[&quot;path&quot;].ToString();
                int level = dic[&quot;level&quot;].Parse2();
                int subItemID = dic[&quot;SubItemID&quot;].Split(&#39;_&#39;)[0].Parse2();
                if (FetchActivities != null)
                    FetchActivities(this, id);
                if (FetchActivitiesWithSubItem != null)
                    FetchActivitiesWithSubItem(this, id, subItemID);
                var sb = new StringBuilder();
                if (FetchActivities != null)
                    RenderActivitiesHTML(sb, level + 1, subItemID, path);
                callbackResult = sb.ToString2();
            }
            else if (dic[&quot;action&quot;] == &quot;fetchSubItems&quot;)
            {
                int id = dic[&quot;id&quot;].Split(&#39;_&#39;)[0].Parse2();
                string path = dic[&quot;path&quot;].ToString();
                int level = dic[&quot;level&quot;].Parse2();
                int subItemID = dic[&quot;SubItemID&quot;].Parse2();
                FetchSubItems(this, id);
                if (FetchSubItemsWithSubItem != null)
                    FetchSubItemsWithSubItem(this, id, subItemID);
                var sb = new StringBuilder();
                if (subItemTable.Rows.Count &gt; 0)
                    RenderSubItemsHTML(sb, level + 1, path);
                else
                {
                    if (FetchActivities != null)
                        FetchActivities(this, id);
                    if (FetchActivitiesWithSubItem != null)
                        FetchActivitiesWithSubItem(this, id, 0);
                    if (FetchActivities != null)
                        RenderActivitiesHTML(sb, level + 1, 0, path);
                }
                callbackResult = sb.ToString2();
            }
            else if (dic[&quot;action&quot;] == &quot;SaveSettings&quot;)
            {
                SaveControlSettings(this, new ControlSettingArgs(dic[&quot;CustomSettings&quot;]));
                callbackResult = &quot;1&quot;;
            }
            else if (dic[&quot;action&quot;] == &quot;overheadConfirm&quot;)
            {
                bool shouldAlertOverhead = false;
                string containerIDs = dic.ContainsKey(&quot;containerIDs&quot;) ? dic[&quot;containerIDs&quot;] : String.Empty;
                string itemIDs = dic.ContainsKey(&quot;itemIDs&quot;) ? dic[&quot;itemIDs&quot;] : String.Empty;

                string[] containerIDList = containerIDs.Split(new[] { &#39;,&#39; }, StringSplitOptions.RemoveEmptyEntries);
                foreach (string containerID in containerIDList)
                {
                    DataRow[] selContainer = containerTable.Select(&quot;ContainerID=&#39;&quot; + containerID + &quot;&#39;&quot;);
                    if (selContainer.Length &gt; 0)
                    {
                        double overheadCost = 0;
                        if (!selContainer[0].IsNull(&quot;OverheadCost&quot;) &amp;&amp;
                            !String.IsNullOrEmpty(selContainer[0][&quot;OverheadCost&quot;].ToString2()))
                            Double.TryParse(selContainer[0][&quot;OverheadCost&quot;].ToString2(), out overheadCost);
                        shouldAlertOverhead = (overheadCost != 0);
                        if (shouldAlertOverhead)
                            break;
                    }
                }

                string[] itemIDList = itemIDs.Split(new[] { &#39;,&#39; }, StringSplitOptions.RemoveEmptyEntries);
                foreach (string itemID in itemIDList)
                {
                    DataRow[] selItem = itemTable.Select(&quot;ItemID=&quot; + itemID);
                    if (selItem.Length &gt; 0)
                    {
                        double overheadCost = 0;
                        if (!selItem[0].IsNull(&quot;OverheadCost&quot;) &amp;&amp;
                            !String.IsNullOrEmpty(selItem[0][&quot;OverheadCost&quot;].ToString2()))
                            Double.TryParse(selItem[0][&quot;OverheadCost&quot;].ToString2(), out overheadCost);
                        shouldAlertOverhead = (overheadCost != 0);
                        if (shouldAlertOverhead)
                            break;
                    }
                }

                callbackResult = shouldAlertOverhead.ToString2();
            }
            else if (dic[&quot;action&quot;] == &quot;filter&quot;)
            {
                if (dic.ContainsKey(&quot;EditedInfo&quot;))
                {
                    ParseModifiedInfo(dic[&quot;EditedInfo&quot;]);
                }
                PrepareFilter(JsonConvert.DeserializeObject&lt;List&lt;FilterInfo&gt;&gt;(dic[&quot;AllFilter&quot;].ToString()));
                var sb = new StringBuilder();
                RenderHeaderHTML(sb);
                sb.Append(&quot;&lt;gridData&gt;&quot;);
                RenderGridDataHTML(sb);
                callbackResult = sb.ToString2();
            }
            else
            {
                callbackResult = &quot;&quot;; // DO NOTHING ON THE CLIENT SIDE
            }
        }

        private void ParseModifiedInfo(string editedInfo)
        {
            var jarray = JArray.Parse(editedInfo);
            nodeTable.ModifiedData = new List&lt;Dictionary&lt;string, string&gt;&gt;();
            foreach (var jobject in jarray.Children&lt;JObject&gt;())
            {
                var dt = new Dictionary&lt;string, string&gt;();
                foreach (JProperty prop in jobject.Properties())
                {
                    dt.Add(prop.Name, prop.Value.ToString().TrimEnd());
                }
                nodeTable.ModifiedData.Add(dt);
            }
        }

        private void PrepareFilter(List&lt;FilterInfo&gt; filterList)
        {
            var filterExpression = new List&lt;string&gt;();
            foreach (var filterInfo in filterList)
            {
                var filter = (GridKnownFunction)Enum.Parse(typeof(GridKnownFunction), filterInfo.filter);
                var dataType = nodeTable.ItemTable.Columns[filterInfo.columnName].DataType.FullName;
                string columnfilterString = string.Empty;

                switch (dataType)
                {
                    case &quot;System.DateTime&quot;:
                        columnfilterString = HandleDateTimeObject_CreatefilterString(filterInfo);
                        if (!String.IsNullOrEmpty(columnfilterString))
                            filterExpression.Add(columnfilterString);
                        break;
                    case &quot;System.Byte&quot;:
                    case &quot;System.SByte&quot;:
                    case &quot;System.UInt16&quot;:
                    case &quot;System.UInt32&quot;:
                    case &quot;System.UInt64&quot;:
                    case &quot;System.Int16&quot;:
                    case &quot;System.Int32&quot;:
                    case &quot;System.Int64&quot;:
                    case &quot;System.Decimal&quot;:
                    case &quot;System.Double&quot;:
                    case &quot;System.Single&quot;:
                        #region Numeric Handler
                        double doubleCurrentFilterValue;
                        if (double.TryParse(filterInfo.value, out doubleCurrentFilterValue))
                        {
                            var lhs = &quot;[&quot; + filterInfo.columnName + &quot;]&quot;;
                            var rhs = doubleCurrentFilterValue.ToString();

                            switch (filter)
                            {
                                case GridKnownFunction.EqualTo:
                                    columnfilterString = $&quot;({lhs} = {rhs})&quot;;
                                    break;
                                case GridKnownFunction.NotEqualTo:
                                    columnfilterString = $&quot;({lhs} &lt;&gt; {rhs})&quot;;
                                    break;
                                case GridKnownFunction.GreaterThan:
                                    columnfilterString = $&quot;({lhs} &gt; {rhs})&quot;;
                                    break;
                                case GridKnownFunction.LessThan:
                                    columnfilterString = $&quot;({lhs} &lt;{rhs})&quot;;
                                    break;
                                case GridKnownFunction.GreaterThanOrEqualTo:
                                    columnfilterString = $&quot;({lhs} &gt;= {rhs})&quot;;
                                    break;
                                case GridKnownFunction.LessThanOrEqualTo:
                                    columnfilterString = $&quot;({lhs} &lt;= {rhs})&quot;;
                                    break;
                                case GridKnownFunction.IsNull:
                                    columnfilterString = $&quot;({lhs} IS NULL)&quot;;
                                    break;
                                case GridKnownFunction.NotIsNull:
                                    columnfilterString = $&quot;({lhs} IS NOT NULL)&quot;;
                                    break;
                            }

                            if (!string.IsNullOrEmpty(columnfilterString))
                                filterExpression.Add(columnfilterString);
                        }
                        #endregion Numeric Handler
                        break;
                    case &quot;System.String&quot;:
                        #region String Handler
                        // Escape sql serve LIKE wildcard characters
                        string filterValue =
                            filterInfo.value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;)
                                .Replace(&quot;%&quot;, &quot;[%]&quot;)
                                .Replace(&quot;[&quot;, &quot;[[]&quot;)
                                .Replace(&quot;_&quot;, &quot;[_]&quot;);

                        switch (filter)
                        {
                            case GridKnownFunction.Contains:
                                columnfilterString = $&quot;([{filterInfo.columnName}] LIKE &#39;%{filterValue}%&#39;)&quot;;
                                break;
                            case GridKnownFunction.DoesNotContain:
                                columnfilterString = $&quot;([{filterInfo.columnName}] NOT LIKE &#39;%{filterValue}%&#39;)&quot;;
                                break;
                            case GridKnownFunction.StartsWith:
                                columnfilterString = $&quot;([{filterInfo.columnName}] LIKE &#39;{filterValue}%&#39;)&quot;;
                                break;
                            case GridKnownFunction.EndsWith:
                                columnfilterString = $&quot;([{filterInfo.columnName}] LIKE &#39;%{filterValue}&#39;)&quot;;
                                break;
                            case GridKnownFunction.EqualTo:
                                columnfilterString = $&quot;([{filterInfo.columnName}] = &#39;{filterValue}&#39;)&quot;;
                                break;
                            case GridKnownFunction.NotEqualTo:
                                columnfilterString = $&quot;([{filterInfo.columnName}] &lt;&gt; &#39;{filterValue}&#39;)&quot;;
                                break;
                            case GridKnownFunction.IsEmpty:
                                columnfilterString = $&quot;([{filterInfo.columnName}] = &#39;&#39; OR [{filterInfo.columnName}] IS NULL)&quot;;
                                break;
                            case GridKnownFunction.NotIsEmpty:
                                columnfilterString = $&quot;([{filterInfo.columnName}] &lt;&gt; &#39;&#39; AND [{filterInfo.columnName}] IS NOT NULL)&quot;;
                                break;
                        }

                        if (!string.IsNullOrEmpty(columnfilterString))
                            filterExpression.Add(columnfilterString);
                        #endregion String Handler
                        break;
                    case &quot;System.Boolean&quot;:
                        #region Bool Data Handler
                        bool boolCurrentFilterValue;
                        if (bool.TryParse(filterInfo.value, out boolCurrentFilterValue))
                        {
                            if ((filter == GridKnownFunction.EqualTo &amp;&amp; boolCurrentFilterValue) || (filter == GridKnownFunction.NotEqualTo &amp;&amp; !boolCurrentFilterValue))
                                filterExpression.Add($&quot;([{filterInfo.columnName}] = &#39;true&#39;)&quot;);
                            else if (filter.IsEqualToAny(GridKnownFunction.EqualTo, GridKnownFunction.NotEqualTo))
                                filterExpression.Add($&quot;([{filterInfo.columnName}] = &#39;false&#39; OR [{filterInfo.columnName}] IS NULL)&quot;);
                        }
                        #endregion Bool Data Handler
                        break;
                }
            }
            nodeTable.Filter = string.Join(&quot; AND &quot;, filterExpression.ToArray());
        }

        private string HandleDateTimeObject_CreatefilterString(FilterInfo filterInfo)
        {
            DateTime out_dateTimeCurrentFilterValue;

            string columnfilterStringTemplate = string.Empty;
            string columnfilterString = string.Empty;
            var filter = (GridKnownFunction)Enum.Parse(typeof(GridKnownFunction), filterInfo.filter);

            if (string.IsNullOrWhiteSpace(filterInfo.value))
            {
                #region If there is a NUll or Blank
                switch (filter)
                {
                    case GridKnownFunction.EqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NULL OR [{0}] = &#39;&#39; )&quot;; break;
                    case GridKnownFunction.NotEqualTo:
                    case GridKnownFunction.GreaterThan:
                    case GridKnownFunction.LessThan:
                    case GridKnownFunction.GreaterThanOrEqualTo:
                    case GridKnownFunction.LessThanOrEqualTo:
                        columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND [{0}] &lt;&gt; &#39;&#39; )&quot;; break;

                    case GridKnownFunction.IsNull: columnfilterStringTemplate = &quot;( [{0}] IS NULL )&quot;; break;
                    case GridKnownFunction.NotIsNull: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL )&quot;; break;
                    case GridKnownFunction.Between: break;
                    case GridKnownFunction.NotBetween: break;
                }

                columnfilterString = string.Format(columnfilterStringTemplate, filterInfo.columnName);

                #endregion If there is a NUll or Blank
            }
            else
            {
                #region For Values other than Null or empty
                bool isParseSuccess = DateTime.TryParse(filterInfo.value, out out_dateTimeCurrentFilterValue);

                if (!isParseSuccess)
                    return string.Empty;
                var dataFormatString = string.Empty;

                bool isTimeComponentRequired = Columns.FindByColumnName(filterInfo.columnName).Format.ToLower().Contains(&quot;h&quot;);

                DateTime filterValueAsMWDate = (isTimeComponentRequired) ? out_dateTimeCurrentFilterValue : out_dateTimeCurrentFilterValue.Date;

                if (!isTimeComponentRequired)
                {
                    #region Date Only Handler

                    string utcDateEquivalent_ofStartOfMWDate;
                    string utcDateEquivalent_ofEndOfMWDate;

                    utcDateEquivalent_ofStartOfMWDate = filterValueAsMWDate.ToUtc().ToDateTimeString_ForDatabaseOpenXml();
                    utcDateEquivalent_ofEndOfMWDate = filterValueAsMWDate.AddDays(1).AddMilliseconds(-1).ToUtc().ToDateTimeString_ForDatabaseOpenXml();

                    switch (filter)
                    {
                        case GridKnownFunction.EqualTo:
                            columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND CAST(&#39;{1}&#39; AS DATETIME) &lt;= [{0}] AND [{0}] &lt;= CAST(&#39;{2}&#39; AS DATETIME) )&quot;;
                            break;
                        case GridKnownFunction.NotEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NULL OR CAST(&#39;{1}&#39; AS DATETIME) &gt; [{0}] OR [{0}] &gt; CAST(&#39;{2}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.GreaterThan: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND [{0}] &gt; CAST(&#39;{2}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.LessThan: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND [{0}] &lt; CAST(&#39;{1}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.GreaterThanOrEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND [{0}] &gt;= CAST(&#39;{1}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.LessThanOrEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL AND [{0}] &lt;= CAST(&#39;{2}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.IsNull: columnfilterStringTemplate = &quot;( [{0}] IS NULL )&quot;; break;
                        case GridKnownFunction.NotIsNull: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL )&quot;; break;
                        case GridKnownFunction.Between: break;
                        case GridKnownFunction.NotBetween: break;
                    }
                    // Parameter Sequence =  {0}  {1} {2}
                    columnfilterString = string.Format(columnfilterStringTemplate, filterInfo.columnName, utcDateEquivalent_ofStartOfMWDate, utcDateEquivalent_ofEndOfMWDate);
                    #endregion Date Only Handler
                }
                else
                {
                    #region Date And Time Handler
                    string utcEquivalent_ofStartOfMWDateTime = filterValueAsMWDate.ToUtc().ToDateTimeString_ForDatabaseOpenXml();

                    switch (filter)
                    {
                        case GridKnownFunction.EqualTo: columnfilterStringTemplate = &quot;( DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) = CAST(&#39;{1}&#39; AS DATETIME)  )&quot;; break;
                        case GridKnownFunction.NotEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NULL  OR  DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) &lt;&gt; CAST(&#39;{1}&#39; AS DATETIME)  )&quot;; break;
                        case GridKnownFunction.GreaterThan: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL  AND  DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) &gt; CAST(&#39;{1}&#39; AS DATETIME)  )&quot;; break;
                        case GridKnownFunction.LessThan: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL  AND  DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) &lt; CAST(&#39;{1}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.GreaterThanOrEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL  AND  DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) &gt;= CAST(&#39;{1}&#39; AS DATETIME) )&quot;; break;
                        case GridKnownFunction.LessThanOrEqualTo: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL  AND  DATEADD(MINUTE, DATEDIFF(MINUTE, 0, [{0}]), 0) &lt;= CAST(&#39;{1}&#39; AS DATETIME)  )&quot;; break;
                        case GridKnownFunction.IsNull: columnfilterStringTemplate = &quot;( [{0}] IS NULL )&quot;; break;
                        case GridKnownFunction.NotIsNull: columnfilterStringTemplate = &quot;( [{0}] IS NOT NULL )&quot;; break;
                        case GridKnownFunction.Between:
                        case GridKnownFunction.NotBetween: break;
                    }
                    columnfilterString = string.Format(columnfilterStringTemplate, filterInfo.columnName, utcEquivalent_ofStartOfMWDateTime);
                    #endregion Date And Time Handler
                }

                #endregion For Values other than Null or empty
            }

            return columnfilterString;

        }

        public string GetCallbackResult()
        {
            return callbackResult;
        }

        #endregion

        public event SaveHandler saveEditedItems;
        public event OnDemandFetchHandler FetchSubItems;
        public event OnDemandFetchHandler FetchActivities;
        public event OnDemandFetchHandlerWIthAltID FetchSubItemsWithSubItem;
        public event OnDemandFetchHandlerWIthAltID FetchActivitiesWithSubItem;
        public event EventHandler SaveControlSettings;
        public event EventHandler MoveForward;
        public event EventHandler MoveBackward;
        public event EventHandler PersistPlanningDatatoDatabase;

        protected void Page_Load(object sender, EventArgs e)
        {
            RegisterCallBackScript();

            expandedContainers = hdnGridState.Value.Split(&#39;&amp;&#39;)[1].Split(&#39;=&#39;)[1];
            expandedItems = hdnGridState.Value.Split(&#39;&amp;&#39;)[2].Split(&#39;=&#39;)[1];
            expandedSubItems = hdnGridState.Value.Split(&#39;&amp;&#39;)[3].Split(&#39;=&#39;)[1];

            hdnIsOverheadPostback.Value = &quot;false&quot;;
        }

        protected override void OnInit(EventArgs e)
        {
            hdnDecimalDigits.Value =
                CoreDatabaseHelper.GetDigitsAfterDecimal(AMP3ApplicationSettings.Instance.FORMAT_QUANTITY).ToString2();
        }

        public void Bind()
        {
            HasActivities = (FetchActivities != null);
            nodeTable = new HierarchicalGridSource();
            nodeTable.Context = HttpContext.Current;

            nodeTable.ContainerTable = containerTable;
            nodeTable.ItemTable = itemTable;
            nodeTable.ParentGrid = this;

            nodeTable.ContainerIDColumn = containerIDColumn;
            nodeTable.ParentContainerIDColumn = parentContainerIDColumn;
            nodeTable.ContainerNameColumn = containerNameColumn;

            nodeTable.ItemIDColumn = itemIDColumn;
            nodeTable.ItemNameColumn = itemNameColumn;
            nodeTable.AmountColumn = AmountColumn;
            nodeTable.ItemContainerIDColumn = itemContainerIDColumn;
            nodeTable.IsItemSummaryVisible = isItemSummaryVisible;
            nodeTable.IsAmountColumnVisible = isAmountColumnVisible;
            nodeTable.IsExpenseColumnVisible = isExpenseColumnVisible;
            nodeTable.ShowContainerDetails = showContainerDetails;
            nodeTable.ShowContainerDetailsAtPosition = showContainerDetailsAtPosition;
            nodeTable.IsCheckBoxVisible = isCheckBoxVisible;
            nodeTable.disableGridSaveButton = disableGridSaveButton;
            nodeTable.ItemSummaryDetails = itemSummaryDetails;
            nodeTable.HdnFldCID = EC.ClientID;
            nodeTable.Columns = columns;
            nodeTable.IsReadOnly = isReadOnly;
            nodeTable.IsCompleteReadOnly = IsCompleteReadOnly;
            nodeTable.SubItemTable = subItemTable;
            nodeTable.ActivityTable = activityTable;
            nodeTable.IsCalculateQtyOnChecked = isCalculateQtyOnChecked;
            nodeTable.QuantityColumn = quantityColumn;
            nodeTable.TreeColumnNavigateURL = TreeColumnNavigateURL;
            nodeTable.TreeColumnJavascript = TreeColumnJavascript;
            nodeTable.TreeColumnContainerNavigateUrl = TreeColumnContainerNavigateUrl;
            nodeTable.TreeColumnShowChildCount = TreeColumnShowChildCount;
            nodeTable.TreeColumnShowChildCountForRoot = TreeColumnShowChildCountForRoot;
            nodeTable.ProgressBarColumnName = ProgressBarColumnName;
            //string visibleColumnsArrayStr = string.Empty;
            //string editableColumnsArrayStr = string.Empty;
            //string ColumnsSettingsStr = string.Empty;
            //string isGridReadOnly = string.Empty;

            //if (isReadOnly == true)
            //    isGridReadOnly = &quot;\&quot;true\&quot;&quot;;
            //else
            //    isGridReadOnly = &quot;\&quot;false\&quot;&quot;;

            //ColumnsSettingsStr += &quot;\&quot;TreeColumnWidth=&quot; + columns.TreeColumnWidth + &quot;;&quot;;

            //foreach (HierarchicalGridColumn columnIterator in columns)
            //{
            //    visibleColumnsArrayStr += &quot;\&quot;&quot; + columnIterator.ColumnName + &quot;\&quot;,&quot;;
            //    ColumnsSettingsStr += columnIterator.ColumnName + &quot;=&quot; + columnIterator.Width + &quot;;&quot;;
            //}
            //visibleColumnsArrayStr = visibleColumnsArrayStr.Substring(0, visibleColumnsArrayStr.Length - 1);
            //ColumnsSettingsStr = ColumnsSettingsStr.Substring(0, ColumnsSettingsStr.Length - 1);
            //ColumnsSettingsStr += &quot;\&quot;&quot;;

            //foreach (HierarchicalGridColumn columnIterator in columns)
            //    if (columnIterator.IsEditable) editableColumnsArrayStr += &quot;\&quot;&quot; + columnIterator.ColumnName + &quot;\&quot;,&quot;;
            //editableColumnsArrayStr = editableColumnsArrayStr.Substring(0, editableColumnsArrayStr.Length - 1);

            //if (visibleColumnsArrayStr != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;VisibleColumns&quot;, visibleColumnsArrayStr);
            //if (editableColumnsArrayStr != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;EditableColumns&quot;, editableColumnsArrayStr);
            //if (ColumnsSettingsStr != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;ColumnSettings&quot;, ColumnsSettingsStr);
            //if (lnkDeleteClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkDeleteClientID&quot;, &quot;\&quot;&quot; + lnkDeleteClientID + &quot;\&quot;&quot;);
            //if (lnkEditClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkEditClientID&quot;, &quot;\&quot;&quot; + lnkEditClientID + &quot;\&quot;&quot;);
            //if (lnkNewClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkNewClientID&quot;, &quot;\&quot;&quot; + lnkNewClientID + &quot;\&quot;&quot;);
            //if (lnkViewClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkViewClientID&quot;, &quot;\&quot;&quot; + lnkViewClientID + &quot;\&quot;&quot;);
            //if (lnkSubItemsClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkSubItemsClientID&quot;, &quot;\&quot;&quot; + lnkSubItemsClientID + &quot;\&quot;&quot;);
            //if (lnkRateAnalysisClientID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;lnkRateAnalysisClientID&quot;, &quot;\&quot;&quot; + lnkRateAnalysisClientID + &quot;\&quot;&quot;);
            //if (hdnReferenceItemTypeCID != null) this.Page.ClientScript.RegisterArrayDeclaration(&quot;HdnRefTypeCID&quot;, &quot;\&quot;&quot; + hdnReferenceItemTypeCID + &quot;\&quot;&quot;);
            ////this.Page.ClientScript.RegisterArrayDeclaration(&quot;IsGridReadonly&quot;, isGridReadOnly);
            ////this.Page.ClientScript.RegisterHiddenField(&quot;IsGridReadonly&quot;, isGridReadOnly);
            ////Generation of dynamic style for resizeable columns

            //RegisterStyleForResizableColumns();

            nodeTable.IsCalculateQtyOnChecked = isCalculateQtyOnChecked;
            nodeTable.QuantityColumn = quantityColumn;

            nodeTable.Bind();
            //ltrContent.Text = RenderControlHTML();
        }

        protected void btnFwd_Click(object sender, EventArgs e)
        {
            MoveForward(sender, e);
        }

        protected void btnBwd_Click(object sender, EventArgs e)
        {
            MoveBackward(sender, e);
        }

        protected void btnSavePlanningData_Click(object sender, EventArgs e)
        {
            PersistPlanningDatatoDatabase(sender, e);
        }

        private void RegisterStyleForResizableColumns()
        {
            var styleSB = new StringBuilder();
            styleSB.AppendFormat(
                &quot;&lt;style title=\&quot;resize_col_style\&quot;&gt;td.col_0{{width:{0}px;line-height:18px;word-break: break-all;}} &quot;,
                columns.TreeColumnWidth);
            int counter = 1;
            foreach (HierarchicalGridColumn columnIterator in columns)
                styleSB.AppendFormat(&quot;td.col_{0}{{width:{1}px;line-height:18px;}} &quot;, counter++,
                    (columnIterator.Caption.Contains(&quot;%&quot;)) ? 150 : columnIterator.Width);
            if (isAmountColumnVisible)
            {
                styleSB.AppendFormat(&quot;td.col_{0}{{width:{1}px;}}&quot;, columns.Count + 1, amountColumn.Width);
            }
            styleSB.Append(&quot;&lt;/style&gt;&quot;);
            Page.ClientScript.RegisterStartupScript(GetType(), &quot;DynamicStyle&quot;, styleSB.ToString2());
        }

        private void CalculateTableWidth()
        {
            // width + padding + border format to calculate the width
            //int padding = 1;
            foreach (HierarchicalGridColumn columnIterator in columns)
                topMostTableWidth += columnIterator.Width + 0 + 0;
            if (isCheckBoxVisible)
                topMostTableWidth += 25 + 0 + 0;
            if (isAmountColumnVisible)
                topMostTableWidth += amountColumn.Width + 0 + 0;
            // add  tree title column width
            topMostTableWidth += columns.TreeColumnWidth + 0 + 0;
            //topMostTableWidth += padding;
        }

        public string RenderControlHTML()
        {
            if (null == columns) return &quot;&quot;;
            string visibleColumnsArrayStr = string.Empty;
            string editableColumnsArrayStr = string.Empty;
            Dictionary&lt;string, string&gt; editableDropDownColumns = new Dictionary&lt;string, string&gt;();
            string ColumnsSettingsStr = string.Empty;
            string isGridReadOnly = string.Empty;

            if (isReadOnly)
                isGridReadOnly = &quot;\&quot;true\&quot;&quot;;
            else
                isGridReadOnly = &quot;\&quot;false\&quot;&quot;;
            ColumnsSettingsStr += &quot;\&quot;TreeColumnWidth=&quot; + columns.TreeColumnWidth + &quot;;&quot;;
            foreach (HierarchicalGridColumn columnIterator in columns)
            {
                visibleColumnsArrayStr += &quot;\&quot;&quot; + columnIterator.ColumnName + &quot;\&quot;,&quot;;
                ColumnsSettingsStr += columnIterator.ColumnName + &quot;=&quot; + columnIterator.Width + &quot;;&quot;;
            }
            visibleColumnsArrayStr = visibleColumnsArrayStr.TrimEnd(&#39;,&#39;);
            ColumnsSettingsStr = ColumnsSettingsStr.TrimEnd(&#39;;&#39;);
            ColumnsSettingsStr += &quot;\&quot;&quot;;

            foreach (HierarchicalGridColumn columnIterator in columns)
            {
                if (columnIterator.IsEditable &amp;&amp; columnIterator.ColumnType != &quot;DropDownList&quot;)
                    editableColumnsArrayStr += &quot;\&quot;&quot; + columnIterator.ColumnName + &quot;\&quot;,&quot;;
                else if (columnIterator.IsEditable &amp;&amp; columnIterator.ColumnType == &quot;DropDownList&quot;)
                {
                    editableColumnsArrayStr += &quot;\&quot;&quot; + columnIterator.ColumnName + &quot;\&quot;,&quot;;
                    editableDropDownColumns.Add(columnIterator.ColumnName, columnIterator.DataSource);
                }
            }

            if (editableColumnsArrayStr.Length &gt; 0)
                editableColumnsArrayStr = editableColumnsArrayStr.Substring(0, editableColumnsArrayStr.Length - 1);

            if (visibleColumnsArrayStr != null) hdnVisibleColumns.Value = visibleColumnsArrayStr.Replace(&quot;\&quot;&quot;, &quot;&quot;);
            if (editableColumnsArrayStr != null) hdnEditableColumns.Value = editableColumnsArrayStr.Replace(&quot;\&quot;&quot;, &quot;&quot;);
            if (editableDropDownColumns != null) hdnDropDownColumns.Value = JsonConvert.SerializeObject(editableDropDownColumns);
            if (ColumnsSettingsStr != null)
                Page.ClientScript.RegisterArrayDeclaration(&quot;ColumnSettings&quot;, ColumnsSettingsStr);
            if (lnkDeleteClientID != null)
                Page.ClientScript.RegisterArrayDeclaration(&quot;lnkDeleteClientID&quot;, lnkDeleteClientID);
            if (lnkEditClientID != null) Page.ClientScript.RegisterArrayDeclaration(&quot;lnkEditClientID&quot;, lnkEditClientID);
            if (lnkNewClientID != null) Page.ClientScript.RegisterArrayDeclaration(&quot;lnkNewClientID&quot;, lnkNewClientID);
            if (lnkViewClientID != null) Page.ClientScript.RegisterArrayDeclaration(&quot;lnkViewClientID&quot;, lnkViewClientID);
            if (lnkSubItemsClientID != null)
                Page.ClientScript.RegisterArrayDeclaration(&quot;lnkSubItemsClientID&quot;, lnkSubItemsClientID);
            if (lnkRateAnalysisClientID != null)
                Page.ClientScript.RegisterArrayDeclaration(&quot;lnkRateAnalysisClientID&quot;, lnkRateAnalysisClientID);
            if (hdnReferenceItemTypeCID != null)
                Page.ClientScript.RegisterArrayDeclaration(&quot;HdnRefTypeCID&quot;, &quot;\&quot;&quot; + hdnReferenceItemTypeCID + &quot;\&quot;&quot;);


            RegisterStyleForResizableColumns();


            return CreateCompleteHGridHTML();
        }

        private string CreateCompleteHGridHTML()
        {
            var sb = new StringBuilder();
            CalculateTableWidth();
            sb.AppendFormat(
                @&quot;&lt;table id=&#39;hTableTop&#39; border=0 cellspacing=0 cellpadding=0 height=100% isreadonly={1} class=&#39;outermosttable&#39; style=&#39;width:{0}px&#39;&gt;
                  &lt;tr&gt;&lt;td style=&#39;height:23px;&#39;&gt;&quot;, topMostTableWidth, IsCompleteReadOnly);
            RenderHeaderHTML(sb);
            sb.Append(&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr height=100%&gt;&lt;td id=&#39;dataTD&#39; style=&#39;vertical-align:top&#39;&gt;&quot;);
            if ((Request.QueryString[&quot;Context&quot;] == &quot;CHNGORD&quot; || Request.QueryString[&quot;Context&quot;] == &quot;BDGTREV&quot;) &amp;&amp;
                !isReadOnly)
                nodeTable.IsReadOnly = isReadOnly = true;
            RenderGridDataHTML(sb);
            sb.Append(&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&quot;);
            if (IsItemSummaryVisible)
                RenderSummaryHTML(sb);
            sb.Append(&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;);
            return sb.ToString2();
        }

        private void RenderHeaderHTML(StringBuilder sb)
        {
            sb.AppendFormat(
                @&quot;&lt;div id=&#39;headerTbl&#39; class=&#39;headerdiv&#39; oncontextmenu=&#39;return false;&#39;&gt;&lt;table id=&#39;HeaderTableID&#39; style=&#39;table-layout:fixed&#39; cellspacing=0 class=&#39;nodetable&#39; &gt;&lt;tr&gt;&quot;,
                topMostTableWidth);
            string saveAlt = disableGridSaveButton ? &quot;disabledSave&quot; : &quot;enabledSave&quot;;
            if (IsCheckBoxVisible)
                sb.Append(&quot;&lt;td style=&#39;width:24px;&#39; class=&#39;hgHeader&#39;&gt;&lt;/td&gt;&quot;);
            // add tree title column
            sb.AppendFormat($&quot;&lt;td class=\&quot;hgHeader col_0\&quot; onclick=\&quot;SortItems(&#39;[{itemNameColumn}]&#39;);\&quot;&gt;&lt;span&gt;&lt;nobr class=&#39;nbr&#39; &gt;{TreeColumnCaption}&lt;/nobr&gt; {getSortImageHtml(itemNameColumn)}&lt;/span&gt;&lt;/td&gt;&quot;);

            int counter = 1;

            // index for the resize handler is for previous column
            foreach (HierarchicalGridColumn columnIterator in columns)
            {
                string progressBarWidth = string.Empty;
                if (columnIterator.ColumnName == ProgressBarColumnName)
                    progressBarWidth = &quot;style=&#39;width:150px&#39;&quot;;

                if (columnIterator.ColumnName == &quot;Expense&quot;)
                    continue;

                string sApp = string.Format(
                    $&quot;&lt;td class=&#39;hgHeader col_{counter++}&#39; onclick=\&quot;SortItems(&#39;[{columnIterator.ColumnName}]&#39;);\&quot; {progressBarWidth} &gt;&lt;span class=&#39;resize_handle&#39; ord=&#39;{counter - 2}&#39;&gt;&lt;nobr class=&#39;nbr&#39;&gt;{columnIterator.Caption}&lt;/nobr&gt; {getSortImageHtml(columnIterator.ColumnName)}&lt;/span&gt;&lt;/td&gt;&quot;);
                sb.AppendFormat(sApp);
            }

            if (isAmountColumnVisible)
                sb.AppendFormat(
                    $&quot;&lt;td  class=\&quot;hgHeader col_{counter}\&quot; onclick=\&quot;SortItems(&#39;[{amountColumn.ColumnName}]&#39;);\&quot;&gt;&lt;span class=\&quot;resize_handle\&quot; ord=\&quot;{counter - 1}\&quot;&gt;&lt;nobr class=&#39;nbr&#39;&gt;{amountColumn.Caption}&lt;/nobr&gt;{getSortImageHtml(amountColumn.ColumnName)}&lt;/span&gt;&lt;/td&gt;&quot;);

            if (isExpenseColumnVisible)
                sb.AppendFormat(
                    $&quot;&lt;td  class=\&quot;hgHeader col_{counter}\&quot; onclick=\&quot;SortItems(&#39;[{amountColumn.ColumnName}]&#39;);\&quot;&gt;&lt;span class=\&quot;resize_handle\&quot; ord=\&quot;{counter - 1}\&quot;&gt;&lt;nobr class=&#39;nbr&#39;&gt;\&quot;Expenses Booked\&quot;&lt;/nobr&gt;{getSortImageHtml(&quot;Expense&quot;)}&lt;/span&gt;&lt;/td&gt;&quot;);

            sb.Append(&quot;&lt;/tr&gt;&quot;);

            //filter tr
            sb.Append(&quot;&lt;tr class=\&quot;FilterRow\&quot;&gt;&quot;);
            if (IsCheckBoxVisible)
                sb.Append(&quot;&lt;td style=&#39;width:35px;&#39;&gt;&lt;/td&gt;&quot;);

            sb.AppendFormat(getFilterTextBoxHtml(itemNameColumn));
            sb.AppendFormat(getFilterButtonHtml(itemNameColumn));

            foreach (HierarchicalGridColumn columnIterator in columns)
            {
                if (columnIterator.ColumnName == &quot;Expense&quot;)
                    continue;
                sb.AppendFormat(getFilterTextBoxHtml(columnIterator.ColumnName, counter++, columnIterator.IsNumeric));
                sb.AppendFormat(getFilterButtonHtml(columnIterator.ColumnName));
            }

            if (isAmountColumnVisible)
            {
                sb.AppendFormat(getFilterTextBoxHtml(amountColumn.ColumnName, counter));
                sb.AppendFormat(getFilterButtonHtml(amountColumn.ColumnName));
            }

            if (isExpenseColumnVisible)
            {
                sb.AppendFormat(getFilterTextBoxHtml(amountColumn.ColumnName, counter));
                sb.AppendFormat(getFilterButtonHtml(amountColumn.ColumnName));
            }
            sb.Append(&quot;&lt;/tr&gt;&lt;/table&gt;&lt;div&gt;&quot;);
        }

        private string getFilterTextBoxHtml(string columnName, int counter = 0, bool isNumeric = false)
        {
            if (nodeTable.ItemTable.Columns[columnName].DataType == typeof(bool))
                return filterTextBoxHtml(counter, columnName, &quot;bool&quot;);
            else if (nodeTable.ItemTable.Columns[columnName].DataType == typeof(DateTime))
                return filterTextBoxHtml(counter, columnName, &quot;dateTime&quot;);
            else if (nodeTable.ItemTable.Columns[columnName].DataType == typeof(DateTimeOffset))
                return filterTextBoxHtml(counter, columnName, &quot;dateTimeOffset&quot;);
            else if (nodeTable.ItemTable.Columns[columnName].DataType == typeof(string))
                return filterTextBoxHtml(counter, columnName, &quot;string&quot;);

            return filterTextBoxHtml(counter, columnName, &quot;number&quot;);
        }

        private string filterTextBoxHtml(int counter, string columnName, string datatType)
        {
            if (datatType == &quot;bool&quot;)
                return $&quot;&lt;td class=\&quot;col_{counter}\&quot; style=\&quot;white-space:nowrap;\&quot;&gt;&lt;input class=\&quot;FilterBox\&quot; name =\&quot;{columnName}_FilterTextBox_Name\&quot; datatype=\&quot;{datatType}\&quot; type=\&quot;checkbox\&quot; size=\&quot;10\&quot; id=\&quot;{columnName}_FilterTextBox_Name\&quot; class=\&quot;resize_handle\&quot; alt=\&quot;Filter Name column\&quot; onkeypress=\&quot;if ((event.keyCode == 13)) return false;\&quot;\&quot;&gt;&lt;/input&gt;&quot;;
            return $&quot;&lt;td class=\&quot;col_{counter}\&quot; style=\&quot;white-space:nowrap;\&quot;&gt;&lt;input class=\&quot;FilterBox\&quot; name =\&quot;{columnName}_FilterTextBox_Name\&quot; datatype=\&quot;{datatType}\&quot; type=\&quot;text\&quot; size=\&quot;10\&quot; id=\&quot;{columnName}_FilterTextBox_Name\&quot; class=\&quot;resize_handle\&quot; alt=\&quot;Filter Name column\&quot; onkeypress=\&quot;if ((event.keyCode == 13)) return false;\&quot;\&quot;&gt;&lt;/input&gt;&quot;;
        }
        private string getFilterButtonHtml(string columnName)
        {
            var sb = new StringBuilder();
            sb.AppendFormat($&quot;&lt;input type=\&quot;submit\&quot; name=\&quot;{columnName}_Filter_Name\&quot; value=\&quot; \&quot;  id=\&quot;{columnName}_Filter_Name\&quot; title=\&quot;Filter\&quot; onclick=\&quot;getFilterMenu(event); return false\&quot; class=\&quot;resize_handle headerFilterCol\&quot;&gt;&lt;/input&gt;&lt;/td&gt;&quot;);

            return sb.ToString();
        }

        private string getSortImageHtml(string columnName)
        {
            string sortIndicatorUrl =
                (&quot;~/images/action_&quot; + (sortOrder.SortDirection.Equals(SortDirection.Ascending) ? &quot;up&quot; : &quot;dn&quot;) + &quot;.gif&quot;)
                    .ToClientURL();
            return (sortOrder.SortColumn.Equals($&quot;[{columnName}]&quot;)
                        ? $&quot;&lt;img id=\&quot;ImgSort\&quot; alt=\&quot;{sortOrder.SortDirection.ToString2()}\&quot; src=\&quot;{sortIndicatorUrl}\&quot; title=\&quot;{sortOrder.SortDirection.ToString2()}\&quot;&gt;&lt;/img&gt;&quot;
                        : &quot;&quot;);
        }
        private void RenderGridDataHTML(StringBuilder sb)
        {
            sb.AppendFormat(
                &quot;&lt;div id=\&quot;topGridDiv\&quot;  class=&#39;datadiv&#39; onscroll=\&quot;document.getElementById(&#39;headerTbl&#39;).scrollLeft=this.scrollLeft;\&quot;&gt;&quot;);
            sb.AppendFormat(
                @&quot;&lt;table  id=&#39;dataTable&#39; style=&#39;table-layout:fixed&#39;  border=0 cellspacing=0px class=&#39;nodetable&#39;&gt;&quot;);

            sb.Append(nodeTable.DrawItems(nodeTable.GetRootItems(ItemTable), 0, 0, ColsToExcludeFromHTMLEncoding));
            foreach (Container nodeIterator in nodeTable.GetAllRoots())
            {
                sb.Append(nodeTable.DrawSingleContainer(nodeIterator, 0, 0, ColsToExcludeFromHTMLEncoding));
            }
            sb.Append(&quot;&lt;/table&gt;&quot;);
            sb.Append(&quot;&lt;/div&gt;&quot;);
        }

        private void RenderSummaryHTML(StringBuilder sb)
        {
            sb.Append(
                &quot;&lt;div id=\&quot;GridSummary\&quot;  oncontextmenu=&#39;return false;&#39;  style=\&quot;text-align:right;font-weight:bold;padding-right:20px;padding-top:5px;background-image:url(..\\images\\footer_bg.gif);background-repeat:repeat-x;height:27px;width:100%\&quot;&gt;&quot;);

            for (int count = 0; count &lt; itemSummaryDetails.Count; count++)
            {
                if (itemSummaryDetails[count].ColumnName != &quot;Expense&quot;)
                    sb.AppendFormat(CultureInfo.CurrentCulture,
                        &quot; &amp;nbsp; {0} : {1:&quot; + itemSummaryDetails[count].Format + &quot;}&quot;,
                        itemSummaryDetails[count].Caption,
                        itemSummaryTable.Rows[0][itemSummaryDetails[count].ColumnName]);
            }

            if (isExpenseColumnVisible &amp; expenseSummaryTable != null)
            {
                HierarchicalGridColumn expenseColumn = itemSummaryDetails.FindByColumnName(&quot;Expense&quot;);
                sb.AppendFormat(CultureInfo.CurrentCulture, &quot; &amp;nbsp; {0} : {1:&quot; + expenseColumn.Format + &quot;}&quot;,
                    expenseColumn.Caption, expenseSummaryTable.Rows[0][&quot;Total Expenses&quot;]);
            }

            sb.Append(&quot;&lt;/div&gt;&quot;);
        }

        private void RenderSubItemsHTML(StringBuilder sb, int level, string path)
        {
            sb.Append(nodeTable.DrawSubItems(subItemTable.Select(), level, 0, path));
        }

        private void RenderActivitiesHTML(StringBuilder sb, int level, int subItemID, string path)
        {
            sb.Append(nodeTable.DrawActivities(activityTable.Select(), level, 0, subItemID, path));
        }

        private void RegisterCallBackScript()
        {
            var sb = new StringBuilder();
            sb.Append(&quot;&lt;script language=\&quot;javascript\&quot; type=\&quot;text/javascript\&quot;&gt;&quot;);
            sb.Append(&quot;function SendServerRequest(arguments,context){  try { ShowLoadingOnRequest() } catch (ex) { }&quot;);
            sb.Append(&quot;try{ }catch(ex){ }&quot;);
            sb.Append(Page.ClientScript.GetCallbackEventReference(this, &quot;arguments&quot;, &quot;HandleServerResponse&quot;, &quot;context&quot;,
                false));
            sb.Append(&quot;}&quot;);
            sb.Append(&quot;&lt;/script&gt;&quot;);
            Page.ClientScript.RegisterStartupScript(GetType(), &quot;CallBackScript&quot;, sb.ToString2());
            Page.ClientScript.RegisterArrayDeclaration(&quot;HdnFldCID&quot;, &quot;\&quot;&quot; + EC.ClientID + &quot;\&quot;&quot;);
            Page.ClientScript.RegisterArrayDeclaration(&quot;HdnFldIID&quot;, &quot;\&quot;&quot; + EI.ClientID + &quot;\&quot;&quot;);
            Page.ClientScript.RegisterArrayDeclaration(&quot;HdnFldSIID&quot;, &quot;\&quot;&quot; + ESI.ClientID + &quot;\&quot;&quot;);
            Page.ClientScript.RegisterArrayDeclaration(&quot;ControlLblID&quot;, &quot;\&quot;&quot; + ltrContent.ClientID + &quot;\&quot;&quot;);
        }

        protected override void OnPreRender(EventArgs e)
        {
            if (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] != null)
                EC.Value = (Session[&quot;HGridState_&quot; + Request[&quot;Context&quot;]] as HierarchicalGridState).ExpandedContianers;
            if (ParentItemListModel != null)
            {
                hdnafterEditItemScript.Value = ParentItemListModel.AfterEditItemScript;
                hdnAllowNegativeUnit.Value = ParentItemListModel.allowNegativeUnit.ToString();
            }
            base.OnPreRender(e);
            ltrContent.Text = RenderControlHTML();
        }

        public void GetContextMenu(List&lt;BrixContextMenu&gt; Menu)
        {
            Menu.Add(new BrixContextMenu(&quot;Expand All&quot;, &quot;Expand All&quot;, string.Empty, ContextMenuActionType.ClientScript,
                &quot;return ShowCMenu(&#39;Expand All&#39;);&quot;));
            Menu.Add(new BrixContextMenu(&quot;Collapse All&quot;, &quot;Collapse All&quot;, string.Empty,
                ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Collapse All&#39;);&quot;));
            Menu.Add(new BrixContextMenu(&quot;Save Settings&quot;, &quot;Save Settings&quot;, string.Empty,
                ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Save Settings&#39;);&quot;));

            Menu.Add(new BrixContextMenu(&quot;Toggle Expand/Collapse&quot;, &quot;Toggle Expand/Collapse&quot;, string.Empty,
                ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Toggle&#39;);&quot;));
            Menu.Add(new BrixContextMenu(&quot;Expand&quot;, &quot;Expand&quot;, string.Empty, ContextMenuActionType.ClientScript,
                &quot;return ShowCMenu(&#39;Expand&#39;);&quot;));
            Menu.Add(new BrixContextMenu(&quot;Collapse&quot;, &quot;Collapse&quot;, string.Empty, ContextMenuActionType.ClientScript,
                &quot;return ShowCMenu(&#39;Collapse&#39;);&quot;));

            //Menu.Add(new BrixContextMenu(&quot;Save All&quot;, &quot;Save All&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Save All&#39;);&quot;));
            //Menu.Add(new BrixContextMenu(&quot;View&quot;, &quot;View&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;View&#39;);&quot;));
            //Menu.Add(new BrixContextMenu(&quot;Edit&quot;, &quot;Edit&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Edit&#39;);&quot;));
            //Menu.Add(new BrixContextMenu(&quot;Delete&quot;, &quot;Delete&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Delete&#39;);&quot;));
            //Menu.Add(new BrixContextMenu(&quot;Sub Items&quot;, &quot;Sub Items&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Sub Items&#39;);&quot;));
            //Menu.Add(new BrixContextMenu(&quot;Rate Analysis&quot;, &quot;Rate Analysis&quot;, string.Empty, ContextMenuActionType.ClientScript, &quot;return ShowCMenu(&#39;Rate Analysis&#39;);&quot;));
        }

        public SortOrder GetSortOrderFromSession()
        {
            if (Session[&quot;SortKey_&quot; + Request[&quot;Context&quot;]] != null)
            {
                string[] sortKeyVal = Session[&quot;SortKey_&quot; + Request[&quot;Context&quot;]].ToString2().Split(&#39; &#39;);
                if (sortKeyVal.Length &gt; 1)
                {
                    return new SortOrder(sortKeyVal[0],
                        (sortKeyVal[1] == &quot;DESC&quot; ? SortDirection.Descending : SortDirection.Ascending));
                }
            }
            return new SortOrder(string.Empty);
        }
    }

    [Serializable]
    internal class HierarchicalGridSource
    {
        private bool alternate;
        private HierarchicalGridColumn amountColumn;
        private HierarchicalGridColumns columns;
        private DataTable containerTable;
        private HttpContext context;
        private string hdnFldCID;
        private bool isAmountColumnVisible;
        private bool isExpenseColumnVisible;
        private bool isCheckBoxVisible;
        private bool showContainerDetails;
        private int showContainerDetailsAtPosition;
        private bool isReadOnly;
        private string itemIDColumn;
        private DataTable itemTable;
        private Containers treeContainers;

        internal HttpContext Context
        {
            get { return context; }
            set { context = value; }
        }

        internal DataTable ContainerTable
        {
            get { return containerTable; }
            set { containerTable = value; }
        }

        internal DataTable ItemTable
        {
            get { return itemTable; }
            set { itemTable = value; }
        }

        public DataTable SubItemTable { get; set; }

        public DataTable ActivityTable { get; set; }

        internal string ContainerIDColumn { get; set; }

        internal string ParentContainerIDColumn { get; set; }

        internal string ContainerNameColumn { get; set; }

        internal string ItemIDColumn
        {
            get { return itemIDColumn; }
            set { itemIDColumn = value; }
        }

        internal string ItemNameColumn { get; set; }

        internal string ItemContainerIDColumn { get; set; }

        internal string HdnFldCID
        {
            get { return hdnFldCID; }
            set { hdnFldCID = value; }
        }

        internal bool IsItemSummaryVisible { get; set; }

        internal bool IsAmountColumnVisible
        {
            get { return isAmountColumnVisible; }
            set { isAmountColumnVisible = value; }
        }

        internal bool IsExpenseColumnVisible
        {
            get { return isExpenseColumnVisible; }
            set { isExpenseColumnVisible = value; }
        }

        internal bool ShowContainerDetails
        {
            get { return showContainerDetails; }
            set { showContainerDetails = value; }
        }

        internal int ShowContainerDetailsAtPosition
        {
            get { return showContainerDetailsAtPosition; }
            set { showContainerDetailsAtPosition = value; }
        }

        internal bool IsCheckBoxVisible
        {
            get { return isCheckBoxVisible; }
            set { isCheckBoxVisible = value; }
        }

        public bool IsCalculateQtyOnChecked { get; set; }

        public string QuantityColumn { get; set; }

        internal bool IsReadOnly
        {
            get { return isReadOnly; }
            set { isReadOnly = value; }
        }

        internal bool IsCompleteReadOnly { get; set; }

        internal HierarchicalGridColumn AmountColumn
        {
            get { return amountColumn; }
            set { amountColumn = value; }
        }

        internal HierarchicalGridColumns ItemSummaryDetails { get; set; }

        internal HierarchicalGrid ParentGrid { get; set; }

        internal HierarchicalGridColumns Columns
        {
            set { columns = value; }
        }

        internal bool disableGridSaveButton { get; set; }
        public string TreeColumnNavigateURL { get; set; }
        public string TreeColumnJavascript { get; set; }
        public string TreeColumnContainerNavigateUrl { get; set; }
        public bool TreeColumnShowChildCount { get; set; }
        public bool TreeColumnShowChildCountForRoot { get; set; }
        public string ProgressBarColumnName { get; set; }

        internal List&lt;Dictionary&lt;string, string&gt;&gt; ModifiedData { get; set; }

        internal string Filter { get; set; }

        internal void Bind()
        {
            treeContainers = new Containers();
            int i = 0;
            int otherContainerColumnCount = 0;
            foreach (HierarchicalGridColumn column in columns)
            {
                if (column.ColumnBelongsTo == 1 || column.ColumnBelongsTo == 3)
                {
                    otherContainerColumnCount++;
                }
            }
            var otherContainerColumnNames = new string[otherContainerColumnCount];
            foreach (DataRow row in ContainerTable.Rows)
            {
                int index = 0;
                foreach (HierarchicalGridColumn column in columns)
                {
                    if (column.ColumnBelongsTo == 1 || column.ColumnBelongsTo == 3)
                    {
                        otherContainerColumnNames[index] = column.ColumnName;
                        index++;
                    }
                }
                var tempContainer = new Container(row, ContainerTable.Columns[ContainerIDColumn].Ordinal,
                    ContainerTable.Columns[ParentContainerIDColumn].Ordinal,
                    ContainerTable.Columns[ContainerNameColumn].Ordinal,
                    (isAmountColumnVisible
                        ? ContainerTable.Columns[amountColumn.ColumnName].Ordinal
                        : -1), otherContainerColumnNames);
                tempContainer.Index = i;
                treeContainers.Add(tempContainer);
                i++;
            }

            // after all the containers are initialized we need to set path in them
            setPath();

            if (context.Request.Url.PathAndQuery.Contains(&quot;&amp;itemId=&quot;))
            {
                string itemFamily = GetAncestorsIDs(context.Request.QueryString[&quot;itemId&quot;].ToString2().ToInt32_2());
                if (!string.IsNullOrEmpty(itemFamily))
                {
                    //context.Session[&quot;expandedContainers&quot;] = itemFamily;
                    (context.Session[&quot;HGridState_&quot; + context.Request[&quot;Context&quot;]] as HierarchicalGridState).AddContainer(
                        itemFamily.Trim(&quot;,&quot;.ToCharArray()));
                }
            }
        }

        private Container GetParent(Container container)
        {
            var tempContainer = new Container();
            foreach (Container IterateContainer in treeContainers)
            {
                if (IterateContainer.Id == container.ParentID)
                {
                    tempContainer = IterateContainer;
                    break;
                }
            }
            return tempContainer;
        }

        private string GetAncestorsIDs(int itemID)
        {
            string toReturn = string.Empty;
            string tempContainerID;
            DataRow[] tempRows = itemTable.Select(&quot;itemID=&quot; + itemID);
            if (tempRows != null &amp;&amp; tempRows.Length == 1)
            {
                tempContainerID = tempRows[0][&quot;ContainerID&quot;].ToString2();
                toReturn += &quot;,&quot; + tempContainerID + &quot;,&quot;;
                bool iterate = true;
                while (iterate)
                {
                    try
                    {
                        tempRows = containerTable.Select(&quot;ContainerID=&#39;&quot; + tempContainerID + &quot;&#39;&quot;);
                        if (tempRows != null &amp;&amp; tempRows.Length == 1)
                        {
                            tempContainerID = tempRows[0][&quot;ParentContainerID&quot;].ToString2();
                            toReturn += &quot;,&quot; + tempContainerID + &quot;,&quot;;
                        }
                        else
                            iterate = false;
                    }
                    catch (Exception)
                    {
                        iterate = false;
                    }
                }
            }

            return toReturn;
        }

        private Containers GetChildren(Container container)
        {
            var tempContainers = new Containers();
            foreach (Container tempContainer in treeContainers)
            {
                if (tempContainer.ParentID == container.Id)
                    tempContainers.Add(tempContainer);
            }
            return tempContainers;
        }

        internal Containers GetAllRoots()
        {
            var tempContainers = new Containers();
            foreach (Container tempContainer in treeContainers)
            {
                if (tempContainer.IsRoot)
                    tempContainers.Add(tempContainer);
            }
            return tempContainers;
        }

        internal void setPath(Container container = null)
        {
            Containers childContainers;
            if (container == null)
                childContainers = GetAllRoots();
            else
                childContainers = GetChildren(container);

            foreach (Container child in childContainers)
            {
                child.path = container == null ? child.Id.ToString() : container.path + &quot;_&quot; + child.Id;
                setPath(child);
            }
        }

        internal bool IsLeaf(Container container)
        {
            bool hasChildContainer = false;
            foreach (Container tempContainer in treeContainers)
            {
                if (tempContainer.ParentID == container.Id)
                {
                    hasChildContainer = true;
                    break;
                }
            }

            return !(hasChildContainer);
        }

        internal Container GetContainerById(string id)
        {
            var toReturn = new Container();
            foreach (Container tempContainer in treeContainers)
            {
                if (tempContainer.Id == id)
                {
                    toReturn = tempContainer;
                    break;
                }
            }
            return toReturn;
        }

        private double GetRolledUpAmount(Container container)
        {
            double rolledUpAmount = container.Amount;
            foreach (Container iterateNode in treeContainers)
            {
                if (iterateNode.ParentID == container.Id)
                    rolledUpAmount += GetRolledUpAmount(iterateNode);
            }
            return rolledUpAmount;
        }

        private double GetRolledUpExpenses(string containerID)
        {
            double rolledUpExpense = 0;
            DataRow[] items;
            //For each item in containers, look into all items under it.
            //Get items associated with this container.
            items = GetContainerItems(containerID, ItemTable);

            //Add all expense items under the container.
            foreach (DataRow item in items)
            {
                rolledUpExpense += Convert.ToDouble(item[&quot;Expense&quot;]);
            }

            //Look inside the container for more containers.
            foreach (Container iterateNode in treeContainers)
            {
                if (iterateNode.ParentID == containerID)
                {
                    rolledUpExpense += GetRolledUpExpenses(iterateNode.Id);
                }
            }
            return rolledUpExpense;
        }

        internal DataRow[] GetContainerItems(string containerID, DataTable itemTable)
        {
            return itemTable.Select(ContainerIDColumn + &quot;=&#39;&quot; + containerID + &quot;&#39;&quot;);
        }

        internal DataRow[] GetRootItems(DataTable itemTable)
        {
            return itemTable.Select(ContainerIDColumn + &quot;=&#39;0&#39;&quot;);
        }

        string HtmlEncode(string text, string columnName, List&lt;string&gt; colsToExcludeFromHTMLEncoding)
        {
            if (colsToExcludeFromHTMLEncoding != null &amp;&amp; colsToExcludeFromHTMLEncoding.Contains(columnName))
                return text;
            else
                return HttpUtility.HtmlEncode(text);
        }

        internal string DrawSingleContainer(Container containerObj, int level, int mode, List&lt;string&gt; colsToExcludeFromHTMLEncoding)
        {
            bool isExpanded = false;
            var gridState = HttpContext.Current.Session[&quot;HGridState_&quot; + HttpContext.Current.Request[&quot;Context&quot;]];
            if (gridState != null)
            {
                isExpanded = ((gridState as HierarchicalGridState).ExpandedContianers.Contains(&quot;,&quot; + containerObj.Id + &quot;,&quot;)
                                  || (gridState as HierarchicalGridState).ExpandedAll);

            }
            var sb = new StringBuilder();
            var expanded = isExpanded ? &quot;true&quot; : &quot;false&quot;;
            var backgroundColor = alternate ? &quot;#EDEDED&quot; : &quot;white&quot;;
            sb.AppendFormat($&quot;&lt;tr class=\&quot;hrRow\&quot; id=&#39;CTR_{containerObj.Id}&#39; isExpanded=&#39;{expanded}&#39; path=&#39;{containerObj.path}&#39; style=&#39;background-color:{backgroundColor}&#39;&gt;&quot;);
            alternate = !alternate;
            if (isCheckBoxVisible)
                sb.AppendFormat($&quot;&lt;td style=&#39;width:22px;&#39;&gt;&lt;input type=checkbox tabindex=32767 onclick=\&quot;addC(&#39;{containerObj.Id}&#39;)\&quot;&gt;&lt;/td&gt;&quot;);
            sb.Append(&quot;&lt;td class=&#39;col_0&#39;&gt;&lt;div style=\&quot;padding-left:4px;display: -webkit-flex;display: flex;word-break: break-all;\&quot;&gt;&quot;);

            bool isLeaf = (IsLeaf(containerObj) &amp;&amp; GetContainerItems(containerObj.Id, ItemTable).Length &lt; 1);

            if (!isLeaf)
            {
                sb.AppendFormat(
                    &quot;&lt;img style=&#39;padding-left:{4}px; padding-top:4px; height:10px;&#39; alt=&#39;{5}&#39; id=\&quot;image_{0}\&quot; src=&#39;{1}&#39; onclick=&#39;toggle(\&quot;{0}\&quot;,\&quot;{2}\&quot;,\&quot;{3}\&quot;, event)&#39; &gt;&quot;,
                    containerObj.Id,
                    ((isExpanded)
                        ? &quot;~/images/contract_icon.gif&quot;.ToClientURL()
                        : &quot;~/images/expand_icon.gif&quot;.ToClientURL()), level, hdnFldCID, 5 + level * 20,((isExpanded)?&#39;-&#39;:&#39;+&#39;));

                sb.Append(&quot;&amp;nbsp;&lt;img style=&#39;height:16px;&#39; src=\&quot;&quot; + &quot;~/images/folder_icon.gif&quot;.ToClientURL() + &quot;\&quot;&gt;&amp;nbsp;&lt;b&gt;&quot;);
                // to fix XSS attack
                string containerName = System.Web.HttpUtility.HtmlEncode(containerObj.Name);

                string containerUrl = &quot;&quot;;
                //  ModuleId is compulsory in the data for drill down capability. This has been done in order to stop 
                //  containers such as &quot;Projects&quot; under Program from becoming hyperlinks
                if (!string.IsNullOrEmpty(TreeColumnContainerNavigateUrl) &amp;&amp; !(string.IsNullOrEmpty(containerObj.ModuleId)))
                {
                    containerUrl = !(string.IsNullOrEmpty(containerObj.ModuleId)) ?
                        TreeColumnContainerNavigateUrl.Replace(&quot;{CONTEXT}&quot;, containerObj.ModuleId) : &quot;&quot;;
                    if (containerUrl.Contains(&quot;{INSTANCEID}&quot;))
                    {
                        string idForUrl = containerObj.Id.Substring(2);
                        containerUrl = containerUrl.Replace(&quot;{INSTANCEID}&quot;, idForUrl);
                    }
                    containerUrl = (HttpContext.Current.Handler as Page).ResolveClientUrl(containerUrl);
                }

                string containerDisplayString = GetContainerDisplayString(containerObj);
                sb.Append(&quot;&lt;a title=\&quot;&quot; + containerName + &quot;\&quot;&quot; + ((!(string.IsNullOrEmpty(containerUrl)))
                    ? (&quot;target=\&#39;_blank\&#39; href=\&quot;&quot; + containerUrl + &quot;\&quot;&quot;) : &quot;&quot;) + &quot;&gt;&quot; +
                          (containerDisplayString.Length &gt; 52
                              ? containerDisplayString.Substring(0, 50) + &quot;...&quot;
                              : containerDisplayString) + &quot;&lt;/a&gt;&quot;);


                sb.Append(&quot;&lt;/b&gt;&quot;);
            }
            else
            {
                // to fix XSS attack
                string containerName = System.Web.HttpUtility.HtmlEncode(containerObj.Name);
                sb.AppendFormat(
                    &quot;&lt;img style=&#39;padding-left:{4}px; padding-top:4px; height:10px;&#39; alt=&#39;+&#39; id=\&quot;image_{0}\&quot; src=&#39;{1}\&quot; /&gt;&amp;nbsp;&lt;b&gt;&lt;a title=\&quot;{2}\&quot;&gt;{3}&lt;/a&gt;&quot;,
                    containerObj.Id,
                    &quot;~/images/Expand_disabled.gif&quot;.ToClientURL() + &quot;&#39; &gt;&amp;nbsp;&lt;img style=&#39;height:16px;&#39; src=\&quot;&quot; +
                    &quot;~/images/folder_icon.gif&quot;.ToClientURL(),
                    containerName,
                    (containerName.Length &gt; 52 ? containerName.Substring(0, 50) + &quot;...&quot; : containerName),
                    5 + level * 20);
            }
            sb.Append(&quot;&lt;/div&gt;&lt;/td&gt;&quot;);


            int counter = 1;

            foreach (HierarchicalGridColumn columnIterator in columns) // render every column&#39;s cell
            {
                //if (col.ColumnName != ItemIDColumn &amp;&amp; col.ColumnName != ItemNameColumn &amp;&amp; col.ColumnName != ItemContainerIDColumn &amp;&amp; col.ColumnName != amountColumnName)
                if (columnIterator.ColumnName == &quot;Expense&quot;)
                    continue;

                string progressBarWidth = string.Empty;
                if (columnIterator.ColumnName == ProgressBarColumnName)
                    progressBarWidth = &quot;width:150px&quot;;

                string format = columnIterator.IsNumeric
                    ? &quot;&lt;td style=\&quot;text-align:right;{1}\&quot; class=\&quot;col_{0}\&quot;&gt;&quot;
                    : &quot;&lt;td style=\&quot;word-wrap:break-word;white-space:normal;\&quot; class=\&quot;col_{0}\&quot; {1}&gt;&quot;;
                sb.AppendFormat(format, counter, progressBarWidth);


                if (containerObj.OtherConainerColumns != null &amp;&amp; containerObj.OtherConainerColumns.Count &gt; 0)
                {
                    if (containerObj.OtherConainerColumns.ContainsKey(columnIterator.ColumnName))
                    {
                        if (ProgressBarColumnName == columnIterator.ColumnName)
                            sb.Append(
                                appendProgressBarCellHTML(
                                    containerObj.OtherConainerColumns[columnIterator.ColumnName].ToDecimal2()));
                        else if (containerObj.OtherConainerColumns[columnIterator.ColumnName].Equals(DBNull.Value))
                            sb.Append(string.Empty);
                        else if (string.IsNullOrEmpty(columnIterator.Format))
                            sb.Append(HtmlEncode(containerObj.OtherConainerColumns[columnIterator.ColumnName], columnIterator.ColumnName, colsToExcludeFromHTMLEncoding));
                        else if (columnIterator.ColumnName != &quot;Number&quot; &amp;&amp; columnIterator.ColumnName != &quot;Dimension1&quot; &amp;&amp;
                                 columnIterator.ColumnName != &quot;Dimension2&quot; &amp;&amp; columnIterator.ColumnName != &quot;Dimension3&quot;)
                        {
                            // if format is unit price or amount add the currency symbol before the formatted value
                            //if (!string.IsNullOrEmpty(columnIterator.Prefix))
                            //{
                            //    sb.Append(columnIterator.Prefix);
                            //    sb.Append(&quot; &quot;);
                            //}
                            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;{0:&quot; + columnIterator.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(
                                    containerObj.OtherConainerColumns[columnIterator.ColumnName])
                                    ? containerObj.OtherConainerColumns[columnIterator.ColumnName]
                                    : &quot;0&quot;).ToDouble2());
                        }
                    }
                }

                if ((showContainerDetails &amp;&amp; columnIterator.ColumnName.Equals(&quot;Description&quot;) &amp;&amp;
                     !string.IsNullOrEmpty(containerObj.Description))
                    || (showContainerDetailsAtPosition &gt; 0 &amp;&amp; counter == showContainerDetailsAtPosition))
                {
                    sb.AppendFormat(&quot;&lt;b&gt;&lt;a&gt;{0}&lt;/a&gt;&lt;/b&gt;&quot;, containerObj.Description);
                }

                if (showContainerDetails &amp;&amp; ParentGrid.ParentItemListModel != null &amp;&amp; ParentGrid.ParentItemListModel.ContainerCustomColumns.Contains(columnIterator.ColumnName)
                    &amp;&amp; containerObj.GetRow().Table.Columns.Contains(columnIterator.ColumnName) &amp;&amp; !string.IsNullOrEmpty(containerObj.GetRow()[columnIterator.ColumnName].ToString()))
                {
                    sb.AppendFormat(&quot;&lt;b&gt;&lt;a&gt;{0}&lt;/a&gt;&lt;/b&gt;&quot;, containerObj.GetRow()[columnIterator.ColumnName].ToString());
                }

                sb.Append(&quot; &amp;nbsp;&lt;/td&gt;&quot;);
                counter++;
            }


            if (isAmountColumnVisible)
            {
                sb.AppendFormat(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_{0}\&quot;&gt;&lt;b&gt;&quot;, columns.Count + 1);
                if (amountColumn.Format != null)
                {
                    //sb.Append(LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                    //sb.Append(&quot; &quot;);
                    sb.AppendFormat(CultureInfo.CurrentCulture,
                        &quot;{0:&quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) + &quot; &quot; +
                        amountColumn.Format + &quot;}&quot;,
                        GetRolledUpAmount(containerObj));
                }
                else
                    sb.Append(GetRolledUpAmount(containerObj).ToString2());
                sb.Append(&quot;&lt;/b&gt;&amp;nbsp;&lt;/td&gt;&quot;);
            }

            if (isExpenseColumnVisible)
            {
                sb.AppendFormat(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_{0}\&quot;&gt;&lt;b&gt;&quot;, columns.Count + 1);
                //sb.Append(LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                //sb.Append(&quot; &quot;);
                sb.AppendFormat(CultureInfo.CurrentCulture,
                    &quot;{0:&quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) + &quot; &quot; + amountColumn.Format +
                    &quot;}&quot;,
                    GetRolledUpExpenses(containerObj.Id));
                sb.Append(&quot;&lt;/b&gt;&amp;nbsp;&lt;/td&gt;&quot;);
            }


            sb.Append(&quot;&lt;/tr&gt;&quot;);

            if (!isLeaf)
            {
                if (isExpanded)
                {
                    sb.AppendFormat(&quot;{0}&quot;,
                        DrawContainer(containerObj, level + 1, 0, colsToExcludeFromHTMLEncoding));
                }
                else
                {
                    //sb.AppendFormat(&quot;&lt;div id=\&quot;table_{0}\&quot; style=&#39;display:none;width:100%&#39; &gt;&lt;/div&gt;&quot;, containerObj.Id);
                }
            }
            return sb.ToString2();
        }

        internal string DrawItems(DataRow[] itemRows, int level, int mode, List&lt;string&gt; colsToExcludeFromHTMLEncoding)
        {
            var sb = new StringBuilder();
            int previous = -1;
            int next = -1;
            string parentContainerPath = string.Empty;
            if (itemRows.Length &gt; 0)
            {
                int index = 0;
                Page currentPage = (Page)HttpContext.Current.Handler;
                string sortKey = currentPage.Session[&quot;SortKey_&quot; + currentPage.Request[&quot;Context&quot;]].ToString2();
                if (ModifiedData != null)
                {
                    foreach (var item in ModifiedData)
                    {
                        for (var i = 0; i &lt; itemRows.Length; i++)
                        {
                            if (itemRows[i][ItemIDColumn].ToString().Equals(item[ItemIDColumn]))
                            {
                                var itemRow = itemRows[i];
                                var keys = item.Keys.Where(x =&gt; !x.Equals(ItemIDColumn));
                                foreach (var key in keys)
                                {
                                    try
                                    {
                                        if (string.IsNullOrEmpty(item[key]) &amp;&amp; itemRow.Table.Columns[key].IsNumeric())
                                            itemRow[key] = 0;
                                        else
                                            itemRow[key] = Convert.ChangeType(item[key], itemRow.Table.Columns[key].DataType);
                                    }
                                    catch (Exception ex)
                                    {
                                    }
                                }
                            }
                        }
                    }
                }
                itemRows = itemRows.CopyToDataTable()
                    .Select(string.IsNullOrEmpty(Filter) ? string.Empty : Filter, string.IsNullOrEmpty(sortKey) ? string.Empty : sortKey);

                List&lt;int&gt; itemIdList = new List&lt;int&gt;();
                foreach (DataRow dr in itemRows)
                {
                    itemIdList.Add(dr[ItemIDColumn].ToInt32_2());
                }

                DataTable dt_Item = null;
                DataTable dt_Activity = null;
                if (ParentGrid.ParentItemListModel != null)
                {
                    dt_Item = ParentGrid.ParentItemListModel.FetchSubItemsByItemIdList(itemIdList);
                    dt_Activity = ParentGrid.ParentItemListModel.FetchActivitiesByItemIdList(itemIdList);
                }

                foreach (DataRow dr in itemRows)
                {
                    previous = index == 0 ? -1 : itemRows[index - 1][itemIDColumn].ToString2().Parse2();
                    next = index == (itemRows.Length - 1) ? -1 : itemRows[index + 1][itemIDColumn].ToString2().Parse2();
                    index++;
                    sb.AppendFormat($&quot;&lt;tr class=\&quot;hrRow itemRow\&quot; id=&#39;ITR_{dr[ItemIDColumn].ToString2()}&#39; ItemIDColumn=&#39;{ItemIDColumn}&#39;  prev=&#39;{previous}&#39; next=&#39;{next}&#39;  onclick=&#39;SetCurrentItem(\&quot;{dr[ItemIDColumn].ToString2()}\&quot;)&#39; style=&#39;background-color:&quot;);
                    if (dr.Table.Columns.Contains(&quot;ReferenceItemType&quot;) &amp;&amp; dr[&quot;ReferenceItemType&quot;] != null &amp;&amp;
                        dr[&quot;ReferenceItemType&quot;].ToString2().Equals(&quot;D&quot;))
                        sb.Append(&quot;#949494&#39;&quot;);
                    else if (dr[itemIDColumn].ToString2() == context.Request.QueryString[&quot;itemId&quot;])
                        sb.Append(&quot;#feeebc&#39;&quot;);
                    else if (alternate)
                        sb.Append(!(dr[&quot;IsNonContract&quot;].ToBoolean2()) ? &quot;white&#39;&quot; : &quot;#f7fafd&#39;&quot;); //f2f7fd
                    else
                        sb.Append(!(dr[&quot;IsNonContract&quot;].ToBoolean2()) ? &quot;#fbfbf7&#39;&quot; : &quot;#f7fafd&#39;&quot;);
                    alternate = !alternate;

                    // add the path attribute and isExpanded ; note: isexpanded will be always false in case of item and subitem
                    sb.Append(&quot; isExpanded=\&quot;false\&quot; &quot;);
                    // get the parent container object and get its path

                    int itemID = dr[ItemIDColumn].ToInt32_2();
                    string parentContainerID = dr[ContainerIDColumn].ToString();
                    string path;
                    if (parentContainerID == &quot;0&quot;)
                        path = itemID.ToString();
                    else
                    {
                        if (string.IsNullOrEmpty(parentContainerPath))
                        {
                            Container parentContainerObj = treeContainers.GetContainer(parentContainerID);
                            parentContainerPath = parentContainerObj.path;
                        }
                        path = parentContainerPath + &quot;_&quot; + itemID;
                    }
                    sb.Append(&quot; path=\&quot;&quot; + path + &quot;\&quot; &quot;);

                    bool isReferenceItemTypeC = false;
                    bool isReferenceItemTypeD = false;
                    if ((dr[&quot;ModuleID&quot;].ToString2().ToUpper2() == &quot;CHNGORD&quot; ||
                         dr[&quot;ModuleID&quot;].ToString2().ToUpper2() == &quot;BDGTREV&quot;)
                        &amp;&amp; dr.Table.Columns.Contains(&quot;ReferenceItemType&quot;) &amp;&amp; dr[&quot;ReferenceItemType&quot;] != null)
                    {
                        if (dr[&quot;ReferenceItemType&quot;].ToString2().Equals(&quot;M&quot;)) //Modify Existing Items 
                        {
                            sb.Append(&quot; RefType=\&quot;M\&quot; &quot;);
                            isReadOnly = true;
                        }
                        if (dr[&quot;ReferenceItemType&quot;].ToString2().Equals(&quot;D&quot;)) //Delete Existing Items 
                        {
                            sb.Append(&quot; RefType=\&quot;D\&quot; &quot;);
                            isReadOnly = true;
                        }
                        else if (dr[&quot;ReferenceItemType&quot;].ToString2().Equals(&quot;C&quot;)) //Convert non Contract to Contract 
                        {
                            sb.Append(&quot; RefType=\&quot;C\&quot; &quot;);
                            isReferenceItemTypeC = true;
                        }
                        else // Create New Contract Item Through CO 
                        {
                            sb.Append(&quot; RefType=\&quot;N\&quot; &quot;);
                            isReadOnly = true;
                        }
                    }
                    //do not allow grid edit  for deleted items via addendum
                    if (dr[&quot;ModuleID&quot;].ToString2().ToUpper2() == &quot;ESTMADD&quot; &amp;&amp;
                        dr.Table.Columns.Contains(&quot;ReferenceItemType&quot;) &amp;&amp; dr[&quot;ReferenceItemType&quot;] != null)
                    {
                        if (dr[&quot;ReferenceItemType&quot;].ToString2().Equals(&quot;Deleted&quot;)) //Deleted items through addendum
                        {
                            sb.Append(&quot; RefType=\&quot;D\&quot; &quot;);
                            isReferenceItemTypeD = true;
                        }
                    }
                    if (!IsCompleteReadOnly &amp;&amp; !isReferenceItemTypeD &amp;&amp;
                        (!isReadOnly || dr[&quot;IsNonContract&quot;].ToBoolean2() || isReferenceItemTypeC))
                    {
                        //ondblclick=&quot;(function(evt){var event_element=evt.target? evt.target : evt.srcElement; ShowError(event_element.id)})(arguments[0] || event)&quot; /&gt;
                        //sb.Append(&quot;ondblClick=&#39;editItem(\&quot;&quot;);
                        //sb.Append(dr[ItemIDColumn].ToString2());
                        //sb.Append(&quot;\&quot;)&#39;&quot;);

                        sb.Append(&quot;ondblClick=&#39;(function(evt){&quot;);
                        sb.Append(&quot;editItem(\&quot;&quot;);
                        sb.Append(dr[ItemIDColumn].ToString2());
                        sb.Append(&quot;\&quot;,evt);&quot;);
                        sb.Append(&quot;})(arguments[0] || event)&#39;&quot;);
                    }

                    sb.Append(&quot; &gt;&quot;); //oncontextmenu=\&quot;showmenuDiv(event);\&quot;
                    if (isCheckBoxVisible)
                    {
                        if (IsCalculateQtyOnChecked)
                        {
                            int position = 2;
                            foreach (HierarchicalGridColumn columnIterator in columns)
                            {
                                if (columnIterator.ColumnName == QuantityColumn)
                                {
                                    break;
                                }
                                position++;
                            }
                            sb.Append(
                                &quot;&lt;td style=&#39;width:22px;&#39;&gt;&lt;input type=checkbox tabindex=32767 onclick=\&quot;addItemWithQty(&#39;&quot; +
                                dr[ItemIDColumn].ToString2() + &quot;&#39;,&#39;&quot; + dr[ContainerIDColumn].ToString2() + &quot;&#39;,&#39;&quot; +
                                dr[QuantityColumn] + &quot;&#39;,&#39;&quot; + position + &quot;&#39;)\&quot;&gt;&lt;/td&gt;&quot;);
                        }
                        else
                        {
                            sb.Append(&quot;&lt;td style=&#39;width:22px;&#39;&gt;&lt;input type=checkbox tabindex=32767 onclick=\&quot;addI(&#39;&quot; +
                                      dr[ItemIDColumn].ToString2() + &quot;&#39;)\&quot;&gt;&lt;/td&gt;&quot;);
                        }
                    }

                    sb.Append(&quot;&lt;td class=&#39;col_0&#39;&gt; &lt;div style=\&quot;display: -webkit-flex;display: flex;word-break: break-all;\&quot;&gt;&quot;);

                    string imageStyle = string.Format(&quot; style=&#39;padding-left:{0}px;height: 10px; padding-top:4px;&#39; &quot;, 4 + level * 20);
                    sb.AppendFormat(&quot;&lt;img {0} id=\&quot;item_image_&quot;, imageStyle);
                    sb.Append(dr[ItemIDColumn].ToString2());
                    if (dr.Table.Columns.Contains(&quot;SubItemID&quot;))
                        sb.Append(&quot;_&quot; + dr[&quot;SubItemID&quot;].ToString2());

                    if (dt_Item != null)
                    {
                        DataRow[] rows = dt_Item.Select(string.Format(&quot;ItemID = {0}&quot;, dr[ItemIDColumn].ToInt32_2()));
                        if (rows.IsNotNullAndHasItems())
                            ParentGrid.SubItemTable = rows.CopyToDataTable();
                    }

                    if (dt_Activity != null)
                    {
                        DataRow[] rows = dt_Activity.Select(string.Format(&quot;ItemID = {0}&quot;, dr[ItemIDColumn].ToInt32_2()));
                        if (rows.IsNotNullAndHasItems())
                            ParentGrid.ActivityTable = rows.CopyToDataTable();
                    }

                    //if (ParentGrid.ParentItemListModel != null)
                    //{
                    //    ParentGrid.ParentItemListModel.FetchActivities(ParentGrid, dr[ItemIDColumn].ToInt32_2());
                    //    ParentGrid.ParentItemListModel.FetchSubItems(ParentGrid, dr[ItemIDColumn].ToInt32_2());
                    //}

                    if ((ParentGrid.SubItemTable == null || ParentGrid.SubItemTable.Rows.Count == 0)
                        &amp;&amp;
                        (ParentGrid.ActivityTable == null || ParentGrid.ActivityTable.Rows.Count == 0 ||
                         !ParentGrid.HasActivities))
                    {
                        sb.Append(&quot;\&quot;  alt=&#39;+&#39; src=&#39;&quot; + &quot;~/images/Expand_disabled.gif&quot;.ToClientURL() + &quot;&#39;  &gt;&quot;);

                    }
                    else
                    {
                        sb.Append(&quot;\&quot;  alt=&#39;+&#39; src=&#39;&quot; + &quot;~/images/expand_icon.gif&quot;.ToClientURL() + &quot;&#39; onclick=&#39;toggleItem(\&quot;&quot;);
                        sb.Append(dr[ItemIDColumn].ToString2());
                        if (dr.Table.Columns.Contains(&quot;SubItemID&quot;))
                            sb.Append(&quot;_&quot; + dr[&quot;SubItemID&quot;].ToString2());
                        sb.Append(&quot;\&quot;,\&quot;&quot;);
                        sb.Append(level);
                        sb.Append(&quot;\&quot;,\&quot;&quot;);
                        sb.Append((dr.Table.Columns.Contains(&quot;SubItemID&quot;)) ? dr[&quot;SubItemID&quot;].ToString2() : &quot;0&quot;);
                        sb.Append(&quot;\&quot;, event)&#39;  &gt;&quot;);
                    }
                    if (dr[&quot;IsNonContract&quot;].ToBoolean2())
                    {
                        sb.Append(&quot;&amp;nbsp;&lt;img style=&#39;height: 10px; padding-top: 4px; padding-right: 3px;&#39; src=\&quot;&quot; + &quot;~/images/ncItem1.gif&quot;.ToClientURL() +
                                  &quot;\&quot; title=\&quot;Non Contract Item\&quot;&gt;&quot;);
                    }
                    else
                    {
                        sb.Append(&quot;&amp;nbsp;&lt;img style=&#39;height: 10px; padding-top: 4px; padding-right: 3px;&#39; src=\&quot;&quot; + &quot;~/images/Toolbar/Icn_Item.gif&quot;.ToClientURL() + &quot;\&quot;&gt;&quot;);
                    }

                    if (!string.IsNullOrEmpty(TreeColumnNavigateURL))
                    {
                        string url = (HttpContext.Current.Handler as Page).ResolveClientUrl(TreeColumnNavigateURL);
                        if (dr.Table.Columns.Contains(ItemIDColumn))
                            url = url.Replace(&quot;{PARENTINSTANCEID}&quot;, dr[ItemIDColumn].ToString());
                        if (dr.Table.Columns.Contains(&quot;parentid&quot;))
                            url = url.Replace(&quot;{PARENTID}&quot;, dr[&quot;parentid&quot;].ToString());
                        if (dr.Table.Columns.Contains(&quot;projectid&quot;))
                            url = url.Replace(&quot;{PROJECTID}&quot;, dr[&quot;projectid&quot;].ToString());

                        sb.Append(&quot;&lt;a class=&#39;staticDarkLink&#39; target=&#39;_blank&#39; href=&#39;&quot; + url + &quot;&#39; &gt;&quot; + dr[ItemNameColumn].ToString2() +
                                  &quot;&lt;/a&gt;&quot;);
                    }
                    else if (!string.IsNullOrEmpty(TreeColumnJavascript))
                    {
                        string columnScript = TreeColumnJavascript;
                        if (dr.Table.Columns.Contains(ItemIDColumn))
                            columnScript = columnScript.Replace(&quot;{&quot; + ItemIDColumn + &quot;}&quot;, dr[ItemIDColumn].ToString());

                        sb.Append(&quot;&lt;a class=&#39;staticDarkLink&#39; href=&#39;#&#39; onclick=&#39;&quot; + columnScript + &quot;&#39; &gt;&quot; +
                                  dr[ItemNameColumn].ToString2() +
                                  &quot;&lt;/a&gt;&quot;);
                    }
                    else
                    {
                        // to fix XSS attach
                        sb.Append(HttpUtility.HtmlEncode(dr[ItemNameColumn].ToString2()));
                    }
                    sb.Append(&quot;&lt;/div&gt;&lt;/td&gt;&quot;);


                    int counter = 1;

                    foreach (HierarchicalGridColumn columnIterator in columns)
                    {
                        if (columnIterator.ColumnName == &quot;Expense&quot;)
                            continue;
                        sb.Append(&quot;&lt;td class=\&quot;col_&quot;);
                        sb.Append(counter);
                        if (columnIterator.ColumnName == &quot;Quantity&quot; &amp;&amp; dr[&quot;SubItemCount&quot;].ToInt32_2() &gt; 0)
                            sb.Append(&quot;\&quot; isNum=\&quot;-1\&quot; style=\&quot;text-align:right;\&quot; &gt;&quot;);
                        else if (columnIterator.IsNumeric)
                            sb.Append(&quot;\&quot; isNum=\&quot;1\&quot; style=\&quot;text-align:right;\&quot; &gt;&quot;);
                        else if (columnIterator.ColumnType == &quot;DropDownList&quot;)
                            sb.Append(&quot;\&quot; isNum=\&quot;3\&quot; &gt;&quot;);
                        else
                        {
                            if (columnIterator.ColumnName == &quot;Description&quot;)
                                sb.Append(&quot;\&quot; isNum=\&quot;2\&quot; style=\&quot;word-wrap:break-word;white-space:normal;\&quot; &gt;&quot;); //Required Field
                            else
                                sb.Append(&quot;\&quot; isNum=\&quot;0\&quot; style=\&quot;word-wrap:break-word;white-space:normal;\&quot;&gt;&quot;);
                        }


                        if ((columnIterator.ColumnBelongsTo == 2 || columnIterator.ColumnBelongsTo == 3) ||
                            (columnIterator.ColumnBelongsTo == 1 &amp;&amp; dr.Table.Columns.Contains(columnIterator.ColumnName)))
                        {
                            string colDisplayText = string.Empty;
                            if (ProgressBarColumnName == columnIterator.ColumnName)
                            {
                                sb.Append(appendProgressBarCellHTML(dr[columnIterator.ColumnName].ToString2().ToDecimal2()));
                            }
                            else if (dr[columnIterator.ColumnName].Equals(DBNull.Value))
                            {
                                colDisplayText = string.Empty;
                            }
                            else if (string.IsNullOrEmpty(columnIterator.Format))
                            {
                                colDisplayText = dr[columnIterator.ColumnName].ToString2();
                            }
                            else if (columnIterator.ColumnName == &quot;InflationEffectiveFrom&quot; ||
                                     columnIterator.ColumnName == &quot;CurrentEndDate&quot; ||
                                     columnIterator.ColumnName == &quot;CurrentStartDate&quot; ||
                                     (!string.IsNullOrEmpty(columnIterator.Format) &amp;&amp; columnIterator.Format.IsEqualToAny(
                                         AMP3ApplicationSettings.Instance.FORMAT_DATE
                                         , AMP3ApplicationSettings.Instance.FORMAT_DATETIME)))
                            {
                                colDisplayText = String.IsNullOrEmpty(dr[columnIterator.ColumnName]?.ToString2())
                                               ? String.Empty
                                               : String.Format(CultureInfo.CurrentCulture,
                                                               &quot;{0:&quot; + columnIterator.Format + &quot;}&quot;,
                                                               (DateTime)dr[columnIterator.ColumnName].ToMWDateTime());
                            }
                            else if (columnIterator.ColumnName != &quot;Number&quot; &amp;&amp; columnIterator.ColumnName != &quot;Dimension1&quot; &amp;&amp;
                                     columnIterator.ColumnName != &quot;Dimension2&quot; &amp;&amp;
                                     columnIterator.ColumnName != &quot;Dimension3&quot;)
                            {
                                //if (!string.IsNullOrEmpty(columnIterator.Prefix))
                                //{
                                //    sb.Append(columnIterator.Prefix);
                                //    sb.Append(&quot; &quot;);
                                //}
                                colDisplayText = string.Format(CultureInfo.CurrentCulture,
                                    &quot;{0:&quot; + columnIterator.Format + &quot;}&quot;,
                                    (!string.IsNullOrEmpty(
                                        dr[columnIterator.ColumnName].ToString2())
                                        ? dr[columnIterator.ColumnName]
                                        : string.Empty).ToDouble2());
                            }

                            if (!string.IsNullOrEmpty(columnIterator.NavigateURL))
                            {
                                string url =
                                    (HttpContext.Current.Handler as Page).ResolveClientUrl(columnIterator.NavigateURL);
                                //if (dr.Table.Columns.Contains(ItemIDColumn))
                                //    url = url.Replace(&quot;{PARENTINSTANCEID}&quot;, dr[ItemIDColumn].ToString());
                                if (!string.IsNullOrEmpty(HttpContext.Current.Request[&quot;ParentID&quot;]))
                                    url = url.Replace(&quot;{PARENTINSTANCEID}&quot;, HttpContext.Current.Request[&quot;ParentID&quot;]);
                                if (dr.Table.Columns.Contains(&quot;parentid&quot;))
                                    url = url.Replace(&quot;{PARENTID}&quot;, dr[&quot;parentid&quot;].ToString());
                                if (dr.Table.Columns.Contains(&quot;projectid&quot;))
                                    url = url.Replace(&quot;{PROJECTID}&quot;, dr[&quot;projectid&quot;].ToString());
                                if (dr.Table.Columns.Contains(&quot;pid&quot;))
                                    url = url.Replace(&quot;{PROJECTID}&quot;, dr[&quot;pid&quot;].ToString());
                                if (!string.IsNullOrEmpty(HttpContext.Current.Request[&quot;PID&quot;]))
                                    url = url.Replace(&quot;{PROJECTID}&quot;, HttpContext.Current.Request[&quot;PID&quot;]);

                                sb.AppendFormat(&quot;&lt;a class=&#39;staticDarkLink&#39; href=&#39;{1}&#39;&gt;{0}&lt;/a&gt;&quot;, colDisplayText, url);
                            }
                            else
                            {
                                // To fix XSS attack
                                sb.Append(HtmlEncode(colDisplayText, columnIterator.ColumnName, colsToExcludeFromHTMLEncoding));
                            }
                        }
                        sb.Append(&quot;&amp;nbsp;&lt;/td&gt;&quot;);
                        counter++;
                    }

                    if (isAmountColumnVisible)
                    {
                        sb.Append(&quot;&lt;td class=\&quot;col_&quot;);
                        sb.Append(columns.Count + 1);
                        sb.Append(&quot;\&quot; style=\&quot;text-align:right;\&quot; &gt;&quot;);
                        if (dr[amountColumn.ColumnName].Equals(DBNull.Value))
                            sb.Append(string.Empty);
                        else if (string.IsNullOrEmpty(amountColumn.Format))
                            sb.Append(dr[amountColumn.ColumnName].ToString2());
                        else
                        {
                            //sb.Append(LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                            //sb.Append(&quot; &quot;);
                            sb.AppendFormat(CultureInfo.CurrentCulture,
                                &quot;{0:&quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) + &quot; &quot; +
                                amountColumn.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(dr[amountColumn.ColumnName].ToString2())
                                    ? dr[amountColumn.ColumnName]
                                    : string.Empty).ToDouble2());
                        }
                        sb.Append(&quot;&amp;nbsp;&lt;/td&gt;&quot;);
                    }

                    if (isExpenseColumnVisible)
                    {
                        sb.Append(&quot;&lt;td class=\&quot;col_&quot;);
                        sb.Append(columns.Count + 1);
                        sb.Append(&quot;\&quot; style=\&quot;text-align:right;\&quot; &gt;&quot;);
                        if (dr[&quot;Expense&quot;] == null || dr[&quot;Expense&quot;].Equals(DBNull.Value))
                            sb.Append(string.Empty);
                        else if (string.IsNullOrEmpty(dr[&quot;Expense&quot;].ToString()))
                            sb.Append(dr[&quot;Expense&quot;].ToString2());
                        else
                        {
                            //sb.Append(LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                            //sb.Append(&quot; &quot;);
                            sb.AppendFormat(CultureInfo.CurrentCulture,
                                &quot;{0:&quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) + &quot; &quot; +
                                amountColumn.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(dr[&quot;Expense&quot;].ToString2())
                                    ? dr[&quot;Expense&quot;]
                                    : string.Empty).ToDouble2());
                        }
                        sb.Append(&quot;&amp;nbsp;&lt;/td&gt;&quot;);
                    }

                    sb.Append(&quot;&lt;/tr&gt;&quot;);
                    // container to show the SUBITEMS
                    //sb.Append(&quot;\r\n&lt;div id=\&quot;SubItemsDiv_&quot;);
                    //sb.Append(dr[ItemIDColumn].ToString2());
                    //if (dr.Table.Columns.Contains(&quot;SubItemID&quot;))
                    //    sb.Append(&quot;_&quot; + dr[&quot;SubItemID&quot;].ToString2());
                    //sb.Append(&quot;\&quot; style=&#39;display:none;width:100%&#39; &gt;\r\n&lt;/div&gt;&quot;);
                }
            }
            return sb.ToString2();
        }

        private static string appendProgressBarCellHTML(decimal percentage)
        {
            var sb = new StringBuilder();
            // sb.Append(&quot;&lt;td style=&#39;align:left;text-align:left;width:120px&#39;&gt;&quot;);
            sb.Append(&quot;&lt;table id=&#39;pBar&#39; cellpadding=0 cellspacing=0 style=&#39;border-collapse:collapse;&#39;&gt;&lt;tr&gt;&quot;);
            sb.AppendFormat(
                &quot;&lt;th&gt;&lt;hr style=&#39;height:5px;background-color:{1};width:{0}px; border:solid 1px green;&#39; /&gt;&lt;/th&gt;&quot;,
                Math.Round(percentage, 2) &gt; Math.Round(100.00m, 2) ? Math.Round(100.00m, 2) : Math.Round(percentage, 2),
                Math.Round(percentage, 2) &gt; Math.Round(100.00m, 2) ? &quot;red&quot; : &quot;green&quot;);
            sb.AppendFormat(
                &quot;&lt;th&gt;&lt;hr style=&#39;height:5px;background-color:#ffffff;width:{0}px;border:solid 1px green;&#39; /&gt;&lt;/th&gt;&quot;,
                Math.Round(percentage, 2) &gt; Math.Round(100.00m, 2)
                    ? 0
                    : (Math.Round(100.00m, 2) - Math.Round(percentage, 2)));
            sb.AppendFormat(&quot;&lt;th style=&#39;width:30px;text-align:right;font-size:9px;&#39;&gt;&amp;nbsp{0}%&lt;/th&gt;&quot;,
                percentage.ToString(AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE));
            sb.Append(&quot;&lt;/tr&gt;&lt;/table&gt;&quot;);
            //sb.Append(&quot;&lt;/td&gt;&quot;);
            return sb.ToString();
        }

        private string GetContainerDisplayString(Container containerObj)
        {
            string displayString = containerObj.Name;
            if (TreeColumnShowChildCount)
            {
                int childCount = 0;
                if (containerObj.IsRoot &amp;&amp; TreeColumnShowChildCountForRoot)
                {
                    childCount = GetChildren(containerObj).Count;
                    displayString += (&quot;    [&quot; + childCount.ToString() + &quot;]&quot;);
                }
                else if (IsLeaf(containerObj))
                {
                    childCount = GetContainerItems(containerObj.Id, ItemTable).Length;
                    displayString += (&quot;    [&quot; + childCount.ToString() + &quot;]&quot;);
                }
            }
            return displayString;
        }


        internal string DrawSubItems(DataRow[] subItemRows, int level, int mode, string path)
        {
            var sb = new StringBuilder();

            if (subItemRows.Length &gt; 0)
            {
                foreach (DataRow dr in subItemRows)
                {
                    sb.Append(&quot;\r\n&lt;tr id=\&quot;STR_&quot;);
                    sb.Append(dr[&quot;SubItemID&quot;].ToString2());
                    sb.Append(&quot;_&quot; + dr[&quot;ItemID&quot;].ToString2());
                    if (dr.Table.Columns.Contains(&quot;ContainerID&quot;))
                        sb.Append(&quot;_&quot; + dr[&quot;ContainerID&quot;].ToString2());
                    sb.Append(&quot;\&quot; style=&#39;background-color:&quot;);

                    if (alternate)
                    {
                        sb.Append(&quot;white&#39;&quot;);
                    }
                    else
                    {
                        sb.Append(&quot;#fbfbf7&#39;&quot;);
                    }
                    alternate = !alternate;

                    // Add proper path to the subitem
                    sb.Append(&quot; path=&#39;&quot; + path + &quot;_&quot; + dr[&quot;SubItemID&quot;].ToString2() + &quot;&#39; &quot;);
                    sb.Append(&quot; isExpanded=&#39;false&#39; &quot;);

                    sb.Append(&quot; name=&#39;&quot; + dr[&quot;ItemID&quot;].ToString2() + &quot;&#39; &gt;&quot;); //oncontextmenu=\&quot;showmenuDiv(event);\&quot;
                    if (isCheckBoxVisible)
                        sb.Append(&quot;&lt;td style=&#39;width:25px;&#39;&gt;&lt;input type=checkbox onclick=\&quot;addSSI(&#39;&quot; +
                                  dr[&quot;SubItemID&quot;].ToString2() + &quot;&#39;,&#39;&quot; + dr[&quot;ItemID&quot;].ToString2() + &quot;&#39;)\&quot;&gt;&lt;/td&gt;&quot;);
                    sb.Append(&quot;&lt;td class=&#39;col_0&#39;&gt;&lt;div style=\&quot;padding-left:4px;display: -webkit-flex;display: flex;word-break: break-all;\&quot;&gt;&quot;);
                    sb.Append(&quot;&quot;);

                    string imageStyle = string.Format(&quot; style=&#39;padding-left:{0}px; height: 10px;&#39; &quot;, 4 + level * 20);
                    sb.AppendFormat(&quot;&lt;img {0} id=\&quot;subItem_image_&quot;, imageStyle);
                    sb.Append(dr[&quot;SubItemID&quot;].ToString2());
                    sb.Append(&quot;_&quot; + dr[&quot;ItemID&quot;].ToString2());
                    if (dr.Table.Columns.Contains(&quot;ContainerID&quot;))
                        sb.Append(&quot;_&quot; + dr[&quot;ContainerID&quot;].ToString2());

                    if (!ParentGrid.HasActivities)
                        sb.Append(&quot;\&quot; alt=&#39;+&#39; src=&#39;&quot; + &quot;~/images/Expand_disabled.gif&quot;.ToClientURL() + &quot;&#39;  &gt;&quot;);
                    else
                    {
                        sb.Append(&quot;\&quot; alt=&#39;+&#39; src=\&quot;&quot; + &quot;~/images/expand_icon.gif&quot;.ToClientURL() +
                                  &quot; \&quot; onclick=&#39;toggleSubItem(\&quot;&quot;);
                        sb.Append(dr[&quot;SubItemID&quot;].ToString2());
                        sb.Append(&quot;_&quot; + dr[&quot;ItemID&quot;].ToString2());
                        if (dr.Table.Columns.Contains(&quot;ContainerID&quot;))
                            sb.Append(&quot;_&quot; + dr[&quot;ContainerID&quot;].ToString2());
                        sb.Append(&quot;\&quot;,\&quot;&quot;);
                        sb.Append(dr[&quot;ItemID&quot;].ToString2());
                        sb.Append(&quot;\&quot;,\&quot;&quot;);
                        sb.Append(level);
                        sb.Append(&quot;\&quot;, event)&#39;  &gt;&quot;);
                    }
                    sb.Append(&quot;&amp;nbsp;&lt;img style=&#39;height:14px;&#39; src=\&quot;&quot; + &quot;~/images/Toolbar/Icn_subitems2.gif&quot;.ToClientURL() + &quot;\&quot;&gt;&amp;nbsp;&quot;);
                    sb.Append(dr[&quot;Description&quot;].ToString2());
                    sb.Append(&quot;&lt;/div&gt;&lt;/td&gt;&quot;);
                    int counter = 1;
                    foreach (HierarchicalGridColumn columnIterator in columns)
                    {
                        if (columnIterator.IsNumeric)
                            sb.Append(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_&quot;);
                        else
                            sb.Append(&quot;&lt;td class=\&quot;col_&quot;);
                        sb.Append(counter);
                        sb.Append(&quot;\&quot; &gt;&quot;);
                        if (columnIterator.ColumnName == &quot;Number&quot; || columnIterator.ColumnName == &quot;Dimension1&quot;
                            || columnIterator.ColumnName == &quot;Dimension2&quot; || columnIterator.ColumnName == &quot;Dimension3&quot;)
                            sb.Append(dr[columnIterator.ColumnName].ToString2());
                        else if (dr.Table.Columns.Contains(columnIterator.ColumnName) &amp;&amp;
                                 !dr[columnIterator.ColumnName].Equals(DBNull.Value) &amp;&amp;
                                 columnIterator.ColumnName != &quot;Quantity&quot;)
                            sb.Append(dr[columnIterator.ColumnName].ToString2());
                        else if (columnIterator.ColumnName == &quot;Quantity&quot;)
                            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;{0:&quot; + columnIterator.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(dr[columnIterator.ColumnName].ToString2())
                                    ? dr[columnIterator.ColumnName]
                                    : string.Empty).ToDouble2());
                        else
                            sb.Append(&quot;&amp;nbsp;&quot;);
                        sb.Append(&quot;&lt;/td&gt;&quot;);
                        counter++;
                    }

                    if (isAmountColumnVisible)
                    {
                        sb.Append(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_&quot;);
                        sb.Append(columns.Count + 1);
                        sb.Append(&quot;\&quot;&gt;&quot;);
                        if (!dr.Table.Columns.Contains(amountColumn.ColumnName) ||
                            dr[amountColumn.ColumnName].Equals(DBNull.Value))
                            sb.Append(&quot;&amp;nbsp;&quot;);
                        else if (string.IsNullOrEmpty(amountColumn.Format))
                            sb.Append(dr[amountColumn.ColumnName].ToString2());
                        else
                        {
                            //sb.Append(LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL));
                            //sb.Append(&quot; &quot;);
                            sb.AppendFormat(CultureInfo.CurrentCulture,
                                &quot;{0:&quot; + LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) + &quot; &quot; +
                                amountColumn.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(dr[amountColumn.ColumnName].ToString2())
                                    ? dr[amountColumn.ColumnName]
                                    : string.Empty).ToDouble2());
                        }
                        sb.Append(&quot;&lt;/td&gt;&quot;);
                    }
                    sb.Append(&quot;&lt;/tr&gt;&quot;);
                }
            }

            return sb.ToString2();
        }

        internal string DrawActivities(DataRow[] activitiesRows, int level, int mode, int subItemID, string path)
        {
            var sb = new StringBuilder();

            if (activitiesRows.Length &gt; 0)
            {
                foreach (DataRow dr in activitiesRows)
                {
                    sb.Append(&quot;\r\n&lt;tr id=\&quot;ATR_&quot;);
                    sb.Append(dr[&quot;ActivityID&quot;].ToString2());
                    sb.Append(&quot;\&quot; style=&#39;background-color:&quot;);

                    if (alternate)
                    {
                        sb.Append(&quot;white&#39;&quot;);
                    }
                    else
                    {
                        sb.Append(&quot;#fbfbf7&#39;&quot;);
                    }
                    alternate = !alternate;

                    // Add proper path to the subitem
                    sb.Append(&quot; path=&#39;&quot; + path + &quot;_&quot; + dr[&quot;ActivityID&quot;].ToString2() + &quot;&#39; &quot;);

                    sb.Append(&quot; &gt;&quot;); //oncontextmenu=\&quot;showmenuDiv(event);\&quot;
                    if (isCheckBoxVisible)
                    {
                        sb.Append(&quot;&lt;td style=&#39;width:25px;&#39;&gt;&lt;input type=checkbox onclick=\&quot;addSA(&#39;&quot;);
                        sb.Append(dr[&quot;ActivityID&quot;].ToString2() + &quot;&#39;,&#39;&quot; + dr[ItemIDColumn].ToString2() + &quot;&#39;,&#39;&quot; +
                                  subItemID.ToString2());
                        sb.Append(&quot;&#39;)\&quot;&gt;&lt;/td&gt;&quot;);
                    }
                    sb.Append(&quot;&lt;td class=&#39;col_0&#39;&gt;&lt;div style=\&quot;padding-left:4px;display: -webkit-flex;display: flex;word-break: break-all;\&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;);

                    string imageStyle = string.Format(&quot; style=&#39;padding-left:{0}px;&#39; &quot;, 4 + level * 20);
                    sb.AppendFormat(
                        &quot;&lt;img {0} src=\&quot;&quot; + &quot;~/images/Toolbar/Icn_activity2.gif&quot;.ToClientURL() + &quot;\&quot;&gt;&amp;nbsp;&quot;, imageStyle);

                    sb.Append(dr[&quot;Name&quot;].ToString2());
                    sb.Append(&quot; (&quot;);
                    sb.Append(Math.Round(dr[&quot;Percentage&quot;].ToDouble2(), 2));
                    sb.Append(&quot; %)&quot;);
                    sb.Append(&quot;&lt;/div&gt;&lt;/td&gt;&quot;);
                    int counter = 1;
                    foreach (HierarchicalGridColumn columnIterator in columns)
                    {
                        if (columnIterator.IsNumeric)
                            sb.Append(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_&quot;);
                        else
                            sb.Append(&quot;&lt;td class=\&quot;col_&quot;);
                        sb.Append(counter);
                        sb.Append(&quot;\&quot; &gt;&quot;);
                        if (columnIterator.ColumnName == &quot;Description&quot; || columnIterator.ColumnName == &quot;Unit&quot;
                            || columnIterator.ColumnName == &quot;Dimension1&quot; || columnIterator.ColumnName == &quot;Dimension2&quot; ||
                            columnIterator.ColumnName == &quot;Dimension3&quot;)
                            sb.Append(dr[columnIterator.ColumnName].ToString2());
                        else if (columnIterator.ColumnName == &quot;Number&quot; || columnIterator.ColumnName == &quot;Quantity&quot;)
                            sb.AppendFormat(CultureInfo.CurrentCulture, &quot;{0:&quot; + columnIterator.Format + &quot;}&quot;,
                                (!string.IsNullOrEmpty(dr[columnIterator.ColumnName].ToString2())
                                    ? dr[columnIterator.ColumnName]
                                    : &quot;0&quot;).ToDouble2());
                        else
                            sb.Append(&quot;&amp;nbsp;&quot;);
                        sb.Append(&quot;&lt;/td&gt;&quot;);
                        counter++;
                    }

                    if (isAmountColumnVisible)
                    {
                        sb.Append(&quot;&lt;td style=\&quot;text-align:right;\&quot; class=\&quot;col_&quot;);
                        sb.Append(columns.Count + 1);
                        sb.Append(&quot;\&quot;&gt;&quot;);
                        sb.Append(&quot;&amp;nbsp;&quot;);
                        sb.Append(&quot;&lt;/td&gt;&quot;);
                    }
                    sb.Append(&quot;&lt;/tr&gt;\r\n&quot;);
                }
            }
            return sb.ToString2();
        }

        internal string DrawContainer(Container toBeProcessed, int level, int mode, List&lt;string&gt; colsToExcludeFromHTMLEncoding)
        {
            var sb = new StringBuilder();

            DataRow[] ItemRows = GetContainerItems(toBeProcessed.Id, itemTable);

            sb.Append(DrawItems(ItemRows, level, mode, colsToExcludeFromHTMLEncoding));
            foreach (Container nodeIterator in GetChildren(toBeProcessed))
                sb.Append(DrawSingleContainer(nodeIterator, (level), mode, colsToExcludeFromHTMLEncoding));

            return sb.ToString2();
        }
    }

    internal class Fields : ArrayList
    {
        internal new string this[int index]
        {
            get { return ((string)base[index]); }
        }

        internal int Add(string stringObj)
        {
            return base.Add(stringObj);
        }

        internal void Insert(int index, string stringObj)
        {
            base.Insert(index, stringObj);
        }

        internal void Remove(string stringObj)
        {
            base.Remove(stringObj);
        }

        internal bool Contains(string stringObj)
        {
            return base.Contains(stringObj);
        }
    }

    [Serializable]
    internal class Container
    {
        private Dictionary&lt;string, string&gt; otherConainerColumns;
        private string parentID;

        private DataRow _row;

        internal Container(DataRow row, int primaryIndex, int parentIdIndex, int displayIndex, int amountIndex,
            string[] otherColumns)
        {
            _row = row;
            Name = row.ItemArray[displayIndex].ToString2();
            if (row.Table.Columns.Contains(&quot;Description&quot;) &amp;&amp;
                row.ItemArray[row.Table.Columns[&quot;Description&quot;].Ordinal] != null)
                Description = row.ItemArray[row.Table.Columns[&quot;Description&quot;].Ordinal].ToString2();
            if (row.Table.Columns.Contains(&quot;ModuleId&quot;) &amp;&amp;
                row.ItemArray[row.Table.Columns[&quot;ModuleId&quot;].Ordinal] != null)
                ModuleId = row.ItemArray[row.Table.Columns[&quot;ModuleId&quot;].Ordinal].ToString2();
            Id = row.ItemArray[primaryIndex].ToString2();
            parentID = row.ItemArray[parentIdIndex].ToString2();
            if (amountIndex &gt; 0 &amp;&amp; !string.IsNullOrEmpty(row.ItemArray[amountIndex].ToString2()))
                Amount = row.ItemArray[amountIndex].ToString2().ToDouble2();
            else
                Amount = 0;

            if (parentID == &quot;0&quot;)
                IsRoot = true;
            else
                IsRoot = false;
            if (otherColumns.Length &gt; 0)
            {
                OtherConainerColumns = new Dictionary&lt;string, string&gt;();
                for (int i = 0; i &lt; otherColumns.Length; i++)
                {
                    otherConainerColumns.Add(otherColumns[i], row[otherColumns[i]].ToString2());
                }
            }
        }

        internal Container()
        {
        }

        internal DataRow GetRow()
        {
            return _row;
        }

        internal string Name { get; set; }

        internal string Description { get; set; }

        internal bool IsRoot { get; set; }

        internal int Index { get; set; }

        internal string Id { get; set; }

        internal string ParentID
        {
            get { return parentID; }
            set { parentID = value; }
        }

        internal string path { get; set; }

        internal double Amount { get; set; }

        internal string ModuleId { get; set; }

        internal Dictionary&lt;string, string&gt; OtherConainerColumns
        {
            get { return otherConainerColumns; }
            set { otherConainerColumns = value; }
        }

        // CONSTRUCTOR
    }

    internal class Containers : ArrayList
    {
        internal new Container this[int index]
        {
            get { return ((Container)base[index]); }
        }

        internal int Add(Container nodeObj)
        {
            return base.Add(nodeObj);
        }

        internal void Insert(int index, Container nodeObj)
        {
            base.Insert(index, nodeObj);
        }

        internal void Remove(Container nodeObj)
        {
            base.Remove(nodeObj);
        }

        internal bool Contains(Container nodeObj)
        {
            return base.Contains(nodeObj);
        }

        internal Container GetContainer(string id)
        {
            foreach (Container cont in this)
            {
                if (cont.Id == id) return cont;
            }
            return null;
        }
    }

    [Serializable]
    public class HierarchicalGridColumn
    {
        private int columnBelongsTo = 2; // 1 --&gt; Container Table

        public HierarchicalGridColumn(string ColumnName, int Width, string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            IsEditable = false;
            ColumnType = &quot;Text&quot;;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            ColumnType = &quot;Text&quot;;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, int ColBelongsTo,
            string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            ColumnType = &quot;Text&quot;;
            columnBelongsTo = ColBelongsTo;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, string Format, bool IsNumeric,
            string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            IsEditable = false;
            this.Format = Format;
            this.IsNumeric = IsNumeric;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string columnType, string dataSource,
            string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            this.ColumnType = columnType;
            this.IsEditable = IsEditable;
            this.DataSource = dataSource;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string Format, bool IsNumeric)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            this.Format = Format;
            this.IsNumeric = IsNumeric;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string Format, bool IsNumeric,
            string Caption, string navigateUrl = null)
        {
            this.ColumnName = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            this.Format = Format;
            this.IsNumeric = IsNumeric;
            this.Caption = Caption;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string Format, bool IsNumeric,
            int ColBelongsTo, string navigateUrl = null)
        {
            this.ColumnName = Caption = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            this.Format = Format;
            this.IsNumeric = IsNumeric;
            columnBelongsTo = ColBelongsTo;
            NavigateURL = navigateUrl;
        }

        public HierarchicalGridColumn(string ColumnName, int Width, bool IsEditable, string Format, bool IsNumeric,
            string Caption, int ColBelongsTo, string navigateUrl = null)
        {
            this.ColumnName = ColumnName;
            this.Width = Width;
            this.IsEditable = IsEditable;
            this.Format = Format;
            this.IsNumeric = IsNumeric;
            this.Caption = Caption;
            columnBelongsTo = ColBelongsTo;
            NavigateURL = navigateUrl;
        }

        public static HierarchicalGridColumn AddColumn(string ColumnName, int Width, bool IsEditable, string Format,
            bool IsNumeric,
            string Caption = &quot;&quot;, string navigateUrl = null)
        {
            HierarchicalGridColumn hc;
            if (!string.IsNullOrEmpty(Caption))
                hc = new HierarchicalGridColumn(ColumnName, Width, IsEditable, Format, IsNumeric,
                    Caption, navigateUrl);
            else
                hc = new HierarchicalGridColumn(ColumnName, Width, IsEditable, Format, IsNumeric);

            //hc.Prefix = prefix;
            return hc;
        }


        // 2 --&gt; Item Table
        // 3 --&gt; Both container and Item table

        public string ColumnName { get; set; }

        public string Caption { get; set; }

        public string ColumnType { get; set; }

        public int Width { get; set; }

        public bool IsEditable { get; set; }

        public string Format { get; set; }

        public bool IsNumeric { get; set; }

        public bool IsRequired { get; set; }

        public string DataSource { get; set; }

        public int ColumnBelongsTo
        {
            get { return columnBelongsTo; }
            set { columnBelongsTo = value; }
        }

        public string NavigateURL { get; set; }

        //public string Prefix { get; set; }
    }

    [Serializable]
    public class HierarchicalGridColumns : ArrayList
    {
        public int TreeColumnWidth { get; set; }

        public new HierarchicalGridColumn this[int index]
        {
            get { return ((HierarchicalGridColumn)base[index]); }
        }

        public int Add(HierarchicalGridColumn columnObj)
        {
            return base.Add(columnObj);
        }

        public void Insert(int index, HierarchicalGridColumn columnObj)
        {
            base.Insert(index, columnObj);
        }

        public void Remove(HierarchicalGridColumn columnObj)
        {
            base.Remove(columnObj);
        }

        public bool Contains(HierarchicalGridColumn columnObj)
        {
            return base.Contains(columnObj);
        }


        /// &lt;summary&gt;
        /// Returns the Hierarchical Grid Column from the collection whose Column Name matches the argument passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;columnName&quot;&gt;
        /// The name of the Column to be found.
        /// &lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public HierarchicalGridColumn FindByColumnName(string columnName)
        {
            IEnumerator gridColumn = GetEnumerator();
            while (gridColumn.MoveNext())
            {
                var currentColumn = gridColumn.Current as HierarchicalGridColumn;
                if (currentColumn.ColumnName.Equals(columnName))
                    return currentColumn;
            }
            return null;
        }

        /// &lt;summary&gt;
        /// Determines whether the collection contains a column with the specified column name.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;columnName&quot;&gt;
        /// The name of the Column to be located in the collection.
        /// &lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool Contains(string columnName)
        {
            IEnumerator gridColumn = GetEnumerator();

            while (gridColumn.MoveNext())
            {
                var currentColumn = gridColumn.Current as HierarchicalGridColumn;
                if (currentColumn.ColumnName.Equals(columnName))
                    return true;
            }
            return false;
        }
    }

    public class ItemsArgs : EventArgs
    {
        private readonly Dictionary&lt;string, string&gt; argumentsDic;
        private readonly List&lt;Dictionary&lt;string, string&gt;&gt; listToReturn;

        public ItemsArgs(Dictionary&lt;string, string&gt; argumentsDic, HierarchicalGridColumns columns)
        {
            this.argumentsDic = argumentsDic;

            listToReturn = new List&lt;Dictionary&lt;string, string&gt;&gt;();

            string[] ids = argumentsDic[&quot;idList&quot;].Split(&#39;,&#39;);

            argumentsDic.Remove(&quot;idList&quot;);
            int editableColumns = 0;

            foreach (HierarchicalGridColumn columnIterator in columns)
                if (columnIterator.IsEditable) editableColumns++;

            for (int i = 1; i &lt;= ((this.argumentsDic.Count - 1) / editableColumns); i++)
            {
                var tempDic = new Dictionary&lt;string, string&gt;();
                tempDic.Add(&quot;ItemID&quot;, ids[i]);
                foreach (HierarchicalGridColumn columnIterator in columns)
                {
                    if (columnIterator.IsEditable)
                        tempDic.Add(columnIterator.ColumnName, argumentsDic[columnIterator.ColumnName + &quot;_&quot; + ids[i]]);
                }
                listToReturn.Add(tempDic);
            }
        }

        public List&lt;Dictionary&lt;string, string&gt;&gt; Items
        {
            get { return listToReturn; }
        }
    }

    public class SortOrder
    {
        public string SortColumn { get; set; }
        public SortDirection SortDirection { get; set; }

        public SortOrder(string sortColumn, SortDirection sortDirection)
        {
            SortColumn = sortColumn;
            SortDirection = sortDirection;
        }

        public SortOrder(string sortColumn)
        {
            SortColumn = sortColumn;
            SortDirection = SortDirection.Ascending;
        }
    }

    public class FilterInfo
    {
        public string columnName { get; set; }
        public string value { get; set; }
        public string filter { get; set; }
    }

    public class ControlSettingArgs : EventArgs
    {
        public ControlSettingArgs(string Settings)
        {
            CustomSettings = Settings;
        }

        public string CustomSettings { get; set; }
    }

    [Serializable]
    public class HierarchicalGridState
    {
        public bool ExpandedAll { get; set; }

        public string ExpandedContianers { get; set; }
        public string ExpandedItems { get; set; }
        public string ExpandedSubItems { get; set; }

        public void AddContainer(int ContainerID)
        {
            ExpandedContianers += &quot;,&quot; + ContainerID.ToString2() + &quot;,&quot;;
        }

        public void AddContainer(string ContainerID)
        {
            ExpandedContianers += &quot;,&quot; + ContainerID + &quot;,&quot;;
        }

        public void AddItem(int ItemID)
        {
            ExpandedItems += &quot;,&quot; + ItemID.ToString2() + &quot;,&quot;;
        }

        public void AddItem(string ItemID)
        {
            ExpandedItems += &quot;,&quot; + ItemID + &quot;,&quot;;
        }

        public void AddSubItem(int SubItemID)
        {
            ExpandedSubItems += &quot;,&quot; + SubItemID.ToString2() + &quot;,&quot;;
        }

        public void AddSubItem(string SubItemID)
        {
            ExpandedSubItems += &quot;,&quot; + SubItemID + &quot;,&quot;;
        }


        public void RemoveContainer(int ContainerID)
        {
            ExpandedContianers = ExpandedContianers.Replace(&quot;,&quot; + ContainerID.ToString2() + &quot;,&quot;, &quot;,&quot;);
        }

        public void RemoveContainer(string ContainerID)
        {
            ExpandedContianers = ExpandedContianers.Replace(&quot;,&quot; + ContainerID + &quot;,&quot;, &quot;,&quot;);
        }

        public void RemoveItem(int ItemID)
        {
            ExpandedItems = ExpandedItems.Replace(&quot;,&quot; + ItemID.ToString2() + &quot;,&quot;, &quot;,&quot;);
        }

        public void RemoveItem(string ItemID)
        {
            ExpandedItems = ExpandedItems.Replace(&quot;,&quot; + ItemID + &quot;,&quot;, &quot;,&quot;);
        }

        public void RemoveSubItem(int SubItemID)
        {
            ExpandedSubItems = ExpandedSubItems.Replace(&quot;,&quot; + SubItemID.ToString2() + &quot;,&quot;, &quot;,&quot;);
        }

        public void RemoveSubItem(string SubItemID)
        {
            ExpandedSubItems = ExpandedSubItems.Replace(&quot;,&quot; + SubItemID + &quot;,&quot;, &quot;,&quot;);
        }
    }

    public static class ExtensionMethods
    {
        public static string ToClientURL(this string url)
        {
            return (HttpContext.Current.Handler as Page).ResolveClientUrl(url);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[43,9,43,47,1],[70,13,70,17,1],[70,18,70,22,1],[75,17,75,18,0],[75,19,75,41,0],[75,42,75,43,0],[76,17,76,18,1],[76,19,76,42,1],[76,43,76,44,1],[81,17,81,18,1],[81,19,81,36,1],[81,37,81,38,1],[82,17,82,18,1],[82,19,82,37,1],[82,38,82,39,1],[87,17,87,18,0],[87,19,87,43,0],[87,44,87,45,0],[88,17,88,18,1],[88,19,88,44,1],[88,45,88,46,1],[93,17,93,18,0],[93,19,93,46,0],[93,47,93,48,0],[94,17,94,18,0],[94,19,94,47,0],[94,48,94,49,0],[99,17,99,18,1],[99,19,99,39,1],[99,40,99,41,1],[100,17,100,18,1],[100,19,100,40,1],[100,41,100,42,1],[105,17,105,18,1],[105,19,105,40,1],[105,41,105,42,1],[106,17,106,18,1],[106,19,106,41,1],[106,42,106,43,1],[111,17,111,18,0],[111,19,111,44,0],[111,45,111,46,0],[112,17,112,18,1],[112,19,112,45,1],[112,46,112,47,1],[117,17,117,18,0],[117,19,117,50,0],[117,51,117,52,0],[118,17,118,18,1],[118,19,118,51,1],[118,52,118,53,1],[123,17,123,18,0],[123,19,123,46,0],[123,47,123,48,0],[124,17,124,18,1],[124,19,124,47,1],[124,48,124,49,1],[129,17,129,18,0],[129,19,129,39,0],[129,40,129,41,0],[130,17,130,18,1],[130,19,130,40,1],[130,41,130,42,1],[135,17,135,18,0],[135,19,135,41,0],[135,42,135,43,0],[136,17,136,18,1],[136,19,136,42,1],[136,43,136,44,1],[141,17,141,18,0],[141,19,141,48,0],[141,49,141,50,0],[142,17,142,18,1],[142,19,142,49,1],[142,50,142,51,1],[147,17,147,18,0],[147,19,147,41,0],[147,42,147,43,0],[148,17,148,18,1],[148,19,148,42,1],[148,43,148,44,1],[153,17,153,18,0],[153,19,153,41,0],[153,42,153,43,0],[154,17,154,18,1],[154,19,154,42,1],[154,43,154,44,1],[159,17,159,18,0],[159,19,159,42,0],[159,43,159,44,0],[160,17,160,18,1],[160,19,160,43,1],[160,44,160,45,1],[165,17,165,18,0],[165,19,165,42,0],[165,43,165,44,0],[166,17,166,18,1],[166,19,166,43,1],[166,44,166,45,1],[171,17,171,18,0],[171,19,171,44,0],[171,45,171,46,0],[172,17,172,18,1],[172,19,172,45,1],[172,46,172,47,1],[177,17,177,18,0],[177,19,177,46,0],[177,47,177,48,0],[178,17,178,18,1],[178,19,178,47,1],[178,48,178,49,1],[183,17,183,18,0],[183,19,183,50,0],[183,51,183,52,0],[184,17,184,18,0],[184,19,184,51,0],[184,52,184,53,0],[189,17,189,18,0],[189,19,189,50,0],[189,51,189,52,0],[190,17,190,18,1],[190,19,190,51,1],[190,52,190,53,1],[195,17,195,18,1],[195,19,195,43,1],[195,44,195,45,1],[196,17,196,18,0],[196,19,196,44,0],[196,45,196,46,0],[201,17,201,18,0],[201,19,201,46,0],[201,47,201,48,0],[202,17,202,18,0],[202,19,202,47,0],[202,48,202,49,0],[207,17,207,18,1],[207,19,207,34,1],[207,35,207,36,1],[208,17,208,18,1],[208,19,208,35,1],[208,36,208,37,1],[213,17,213,18,0],[213,19,213,45,0],[213,46,213,47,0],[214,17,214,18,1],[214,19,214,46,1],[214,47,214,48,1],[219,17,219,18,1],[219,19,219,39,1],[219,40,219,41,1],[220,17,220,18,1],[220,19,220,40,1],[220,41,220,42,1],[225,17,225,18,0],[225,19,225,37,0],[225,38,225,39,0],[226,17,226,18,1],[226,19,226,38,1],[226,39,226,40,1],[229,42,229,46,1],[229,47,229,51,1],[233,17,233,18,1],[233,19,233,47,1],[233,48,233,49,1],[234,17,234,18,1],[234,19,234,48,1],[234,49,234,50,1],[239,17,239,18,0],[239,19,239,48,0],[239,49,239,50,0],[240,17,240,18,1],[240,19,240,49,1],[240,50,240,51,1],[245,17,245,18,0],[245,19,245,49,0],[245,50,245,51,0],[246,17,246,18,1],[246,19,246,50,1],[246,51,246,52,1],[251,17,251,18,0],[251,19,251,47,0],[251,48,251,49,0],[252,17,252,18,1],[252,19,252,48,1],[252,49,252,50,1],[257,17,257,18,0],[257,19,257,57,0],[257,58,257,59,0],[258,17,258,18,1],[258,19,258,58,1],[258,59,258,60,1],[263,17,263,18,1],[263,19,263,44,1],[263,45,263,46,1],[264,17,264,18,0],[264,19,264,45,0],[264,46,264,47,0],[269,17,269,18,0],[269,19,269,50,0],[269,51,269,52,0],[270,17,270,18,0],[270,19,270,51,0],[270,52,270,53,0],[275,17,275,18,0],[275,19,275,41,0],[275,42,275,43,0],[276,17,276,18,0],[276,19,276,42,0],[276,43,276,44,0],[279,52,279,56,1],[279,57,279,61,1],[283,17,283,18,0],[283,19,283,47,0],[283,48,283,49,0],[284,17,284,18,0],[284,19,284,48,0],[284,49,284,50,0],[289,17,289,18,0],[289,19,289,42,0],[289,43,289,44,0],[290,17,290,18,0],[290,19,290,43,0],[290,44,290,45,0],[295,17,295,18,0],[295,19,295,45,0],[295,46,295,47,0],[296,17,296,18,0],[296,19,296,46,0],[296,47,296,48,0],[301,17,301,18,0],[301,19,301,46,0],[301,47,301,48,0],[302,17,302,18,0],[302,19,302,47,0],[302,48,302,49,0],[305,47,305,51,1],[305,52,305,56,1],[306,46,306,50,1],[306,51,306,55,0],[307,56,307,60,1],[307,61,307,65,1],[308,48,308,52,1],[308,53,308,57,1],[309,55,309,59,1],[309,60,309,64,1],[311,9,311,50,1],[313,47,313,51,1],[313,52,313,56,0],[318,13,318,14,0],[319,17,319,107,0],[320,21,320,65,0],[322,21,322,31,0],[323,13,323,14,0],[329,13,329,14,0],[330,17,330,107,0],[331,21,332,96,0],[334,21,334,31,0],[335,13,335,14,0],[338,44,338,48,0],[338,49,338,53,1],[339,39,339,43,0],[339,44,339,48,1],[340,42,340,46,0],[340,47,340,51,1],[341,45,341,49,1],[341,50,341,54,1],[345,17,345,18,1],[345,19,345,52,1],[345,53,345,54,1],[347,13,347,14,0],[348,17,348,69,0],[350,17,350,70,0],[351,17,351,18,0],[352,21,352,57,0],[354,21,354,69,0],[355,21,355,22,0],[356,25,358,57,0],[359,21,359,22,0],[361,25,361,67,0],[362,17,362,18,0],[364,17,367,73,0],[368,13,368,14,0],[371,9,371,42,1],[373,9,373,60,1],[377,13,377,14,1],[378,17,378,60,1],[379,17,379,18,1],[380,21,381,93,1],[382,17,382,18,1],[383,17,383,55,1],[384,13,384,14,1],[390,9,390,10,1],[394,13,394,64,1],[395,13,395,56,1],[396,13,396,60,1],[397,13,397,20,1],[397,22,397,32,1],[397,33,397,35,1],[397,36,397,40,1],[398,13,398,14,1],[399,17,399,66,1],[400,17,400,51,1],[401,13,401,14,1],[402,13,402,39,1],[403,13,403,14,1],[406,17,406,73,1],[407,21,407,101,0],[410,21,410,62,1],[412,17,412,59,1],[413,17,413,54,1],[414,17,414,58,1],[416,17,416,73,1],[418,21,418,78,1],[420,17,420,34,1],[421,17,421,34,1],[422,17,422,35,1],[423,13,423,14,1],[425,13,425,46,1],[426,13,426,14,1],[429,17,429,73,1],[430,21,430,101,1],[433,21,433,62,1],[434,17,434,83,1],[435,17,435,62,1],[437,17,437,73,1],[439,21,439,78,1],[442,17,442,41,1],[443,13,443,14,1],[445,13,445,20,1],[445,22,445,30,1],[445,31,445,33,1],[445,34,445,37,1],[446,13,446,14,1],[447,17,447,64,1],[448,17,448,54,1],[449,17,449,48,1],[450,13,450,14,1],[452,13,452,27,1],[455,13,455,48,1],[456,13,456,14,0],[457,17,457,39,0],[458,17,458,51,0],[459,17,459,111,0],[460,17,460,43,0],[461,17,461,51,0],[462,17,462,18,0],[463,21,463,58,0],[464,17,464,18,0],[466,17,466,34,0],[468,17,468,74,0],[469,17,469,118,0],[470,13,470,14,0],[471,18,471,46,1],[472,13,472,14,1],[473,17,473,38,1],[474,17,474,61,1],[476,17,476,50,1],[478,17,478,43,1],[479,17,479,18,1],[480,21,480,50,1],[481,21,481,44,1],[482,21,482,44,1],[483,21,483,46,1],[484,25,484,47,1],[485,21,485,53,1],[486,17,486,18,1],[488,17,488,18,0],[490,21,490,63,0],[490,64,490,107,0],[491,17,491,18,0],[492,13,492,14,1],[493,18,493,51,1],[494,13,494,14,0],[495,17,495,99,0],[496,17,496,18,0],[497,21,497,55,0],[498,21,498,22,0],[499,25,499,62,0],[500,21,500,22,0],[501,21,501,115,0],[502,21,502,47,0],[503,21,503,68,0],[504,21,504,50,0],[505,21,505,42,0],[506,21,506,45,0],[507,21,507,44,0],[508,21,508,53,0],[509,17,509,18,0],[510,13,510,14,0],[511,18,511,57,1],[512,13,512,14,1],[513,17,513,46,1],[514,17,514,40,1],[515,17,515,49,1],[516,13,516,14,1],[517,18,517,57,1],[518,13,518,14,0],[519,17,519,45,0],[520,17,520,54,0],[521,17,521,51,0],[522,17,522,73,0],[523,17,523,45,0],[524,21,524,47,0],[525,17,525,56,0],[526,21,526,69,0],[527,17,527,46,0],[528,17,528,45,0],[529,21,529,74,0],[530,17,530,49,0],[531,13,531,14,0],[532,18,532,55,1],[533,13,533,14,1],[534,17,534,59,1],[535,17,535,54,1],[536,17,536,51,1],[537,17,537,59,1],[538,17,538,41,1],[539,17,539,54,1],[540,21,540,67,1],[541,17,541,46,1],[542,17,542,49,1],[543,21,543,61,1],[545,17,545,18,0],[546,21,546,49,0],[547,25,547,51,0],[548,21,548,60,0],[549,25,549,65,0],[550,21,550,49,0],[551,25,551,70,0],[552,17,552,18,0],[553,17,553,49,1],[554,13,554,14,1],[555,18,555,54,1],[556,13,556,14,1],[557,17,557,90,1],[558,17,558,38,1],[559,13,559,14,1],[560,18,560,57,0],[561,13,561,14,0],[562,17,562,50,0],[563,17,563,108,0],[564,17,564,93,0],[566,17,566,117,0],[567,17,567,24,0],[567,26,567,44,0],[567,45,567,47,0],[567,48,567,63,0],[568,17,568,18,0],[569,21,569,105,0],[570,21,570,49,0],[571,21,571,22,0],[572,25,572,49,0],[573,25,574,96,0],[575,29,575,108,0],[576,25,576,67,0],[577,25,577,49,0],[578,29,578,35,0],[579,21,579,22,0],[580,17,580,18,0],[582,17,582,107,0],[583,17,583,24,0],[583,26,583,39,0],[583,40,583,42,0],[583,43,583,53,0],[584,17,584,18,0],[585,21,585,78,0],[586,21,586,44,0],[587,21,587,22,0],[588,25,588,49,0],[589,25,590,91,0],[591,29,591,103,0],[592,25,592,67,0],[593,25,593,49,0],[594,29,594,35,0],[595,21,595,22,0],[596,17,596,18,0],[598,17,598,66,0],[599,13,599,14,0],[600,18,600,48,0],[601,13,601,14,0],[602,17,602,51,0],[603,17,603,18,0],[604,21,604,58,0],[605,17,605,18,0],[606,17,606,109,0],[607,17,607,46,0],[608,17,608,38,0],[609,17,609,41,0],[610,17,610,40,0],[611,17,611,49,0],[612,13,612,14,0],[614,13,614,14,0],[615,17,615,37,0],[616,13,616,14,0],[617,9,617,10,1],[620,9,620,10,0],[621,13,621,51,0],[622,13,622,77,0],[623,13,623,20,0],[623,22,623,33,0],[623,34,623,36,0],[623,37,623,63,0],[624,13,624,14,0],[625,17,625,59,0],[626,17,626,24,0],[626,26,626,40,0],[626,41,626,43,0],[626,44,626,64,0],[627,17,627,18,0],[628,21,628,72,0],[629,17,629,18,0],[630,17,630,48,0],[631,13,631,14,0],[632,9,632,10,0],[635,9,635,10,0],[636,13,636,55,0],[637,13,637,20,0],[637,22,637,36,0],[637,37,637,39,0],[637,40,637,50,0],[638,13,638,14,0],[639,17,639,106,0],[640,17,640,101,0],[641,17,641,58,0],[643,17,643,34,0],[646,25,646,98,0],[647,25,647,71,0],[648,29,648,70,0],[649,25,649,31,0],[663,25,663,93,0],[664,25,664,26,0],[665,29,665,73,0],[666,29,666,75,0],[668,29,668,44,0],[671,37,671,77,0],[672,37,672,43,0],[674,37,674,78,0],[675,37,675,43,0],[677,37,677,77,0],[678,37,678,43,0],[680,37,680,76,0],[681,37,681,43,0],[683,37,683,78,0],[684,37,684,43,0],[686,37,686,78,0],[687,37,687,43,0],[689,37,689,77,0],[690,37,690,43,0],[692,37,692,81,0],[693,37,693,43,0],[696,29,696,75,0],[697,33,697,74,0],[698,25,698,26,0],[700,25,700,31,0],[704,25,708,54,0],[710,25,710,40,0],[713,33,713,108,0],[714,33,714,39,0],[716,33,716,112,0],[717,33,717,39,0],[719,33,719,107,0],[720,33,720,39,0],[722,33,722,107,0],[723,33,723,39,0],[725,33,725,103,0],[726,33,726,39,0],[728,33,728,104,0],[729,33,729,39,0],[731,33,731,127,0],[732,33,732,39,0],[734,33,734,133,0],[735,33,735,39,0],[738,25,738,71,0],[739,29,739,70,0],[741,25,741,31,0],[745,25,745,89,0],[746,25,746,26,0],[747,29,747,168,0],[748,33,748,95,0],[749,34,749,115,0],[750,33,750,133,0],[751,25,751,26,0],[753,25,753,31,0],[755,13,755,14,0],[756,13,756,81,0],[757,9,757,10,0],[760,9,760,10,0],[763,13,763,62,0],[764,13,764,54,0],[765,13,765,102,0],[767,13,767,61,0],[768,13,768,14,0],[770,17,770,32,0],[772,53,772,116,0],[772,117,772,123,0],[778,25,778,94,0],[778,95,778,101,0],[780,52,780,101,0],[780,102,780,108,0],[781,55,781,108,0],[781,109,781,115,0],[782,53,782,59,0],[783,56,783,62,0],[786,17,786,103,0],[789,13,789,14,0],[791,13,791,14,0],[793,17,793,111,0],[795,17,795,37,0],[796,21,796,41,0],[797,17,797,53,0],[799,17,799,127,0],[801,17,801,145,0],[803,17,803,46,0],[804,17,804,18,0],[810,21,810,123,0],[811,21,811,152,0],[813,21,813,36,0],[816,29,816,156,0],[817,29,817,35,0],[818,60,818,179,0],[818,180,818,186,0],[819,61,819,150,0],[819,151,819,157,0],[820,58,820,147,0],[820,148,820,154,0],[821,70,821,160,0],[821,161,821,167,0],[822,67,822,157,0],[822,158,822,164,0],[823,56,823,105,0],[823,106,823,112,0],[824,59,824,112,0],[824,113,824,119,0],[825,57,825,63,0],[826,60,826,66,0],[829,21,829,175,0],[831,17,831,18,0],[833,17,833,18,0],[835,21,835,130,0],[837,21,837,36,0],[839,57,839,166,0],[839,167,839,173,0],[840,60,840,189,0],[840,190,840,196,0],[841,61,841,194,0],[841,195,841,201,0],[842,58,842,190,0],[842,191,842,197,0],[843,70,843,203,0],[843,204,843,210,0],[844,67,844,201,0],[844,202,844,208,0],[845,56,845,105,0],[845,106,845,112,0],[846,59,846,112,0],[846,113,846,119,0],[848,60,848,66,0],[850,21,850,142,0],[852,17,852,18,0],[855,13,855,14,0],[857,13,857,39,0],[859,9,859,10,0],[862,9,862,10,1],[863,13,863,35,1],[864,9,864,10,1],[879,9,879,10,1],[880,13,880,38,1],[882,13,882,81,1],[883,13,883,76,1],[884,13,884,79,1],[886,13,886,51,1],[887,9,887,10,1],[890,9,890,10,1],[891,13,892,120,1],[893,9,893,10,1],[896,9,896,10,1],[897,13,897,55,1],[898,13,898,54,1],[899,13,899,53,1],[901,13,901,55,1],[902,13,902,45,1],[903,13,903,41,1],[905,13,905,61,1],[906,13,906,73,1],[907,13,907,65,1],[909,13,909,51,1],[910,13,910,55,1],[911,13,911,51,1],[912,13,912,69,1],[913,13,913,67,1],[914,13,914,69,1],[915,13,915,71,1],[916,13,916,67,1],[917,13,917,87,1],[918,13,918,61,1],[919,13,919,69,1],[920,13,920,63,1],[921,13,921,47,1],[922,13,922,41,1],[923,13,923,47,1],[924,13,924,63,1],[925,13,925,51,1],[926,13,926,53,1],[927,13,927,73,1],[928,13,928,55,1],[929,13,929,69,1],[930,13,930,67,1],[931,13,931,87,1],[932,13,932,75,1],[933,13,933,89,1],[934,13,934,69,1],[976,13,976,73,1],[977,13,977,55,1],[979,13,979,30,1],[981,9,981,10,1],[984,9,984,10,0],[985,13,985,36,0],[986,9,986,10,0],[989,9,989,10,0],[990,13,990,37,0],[991,9,991,10,0],[994,9,994,10,1],[995,13,995,54,1],[996,9,996,10,0],[999,9,999,10,1],[1000,13,1000,47,1],[1001,13,1003,42,1],[1004,13,1004,29,1],[1005,13,1005,20,1],[1005,22,1005,59,1],[1005,60,1005,62,1],[1005,63,1005,70,1],[1006,17,1007,90,1],[1008,13,1008,39,1],[1009,13,1009,14,1],[1010,17,1010,107,1],[1011,13,1011,14,1],[1012,13,1012,40,1],[1013,13,1013,101,1],[1014,9,1014,10,1],[1017,9,1017,10,1],[1020,13,1020,20,1],[1020,22,1020,59,1],[1020,60,1020,62,1],[1020,63,1020,70,1],[1021,17,1021,67,1],[1022,13,1022,35,1],[1023,17,1023,49,1],[1024,13,1024,39,1],[1025,17,1025,65,1],[1027,13,1027,66,1],[1029,9,1029,10,1],[1032,9,1032,10,1],[1033,13,1033,33,1],[1033,34,1033,44,0],[1034,13,1034,58,1],[1035,13,1035,59,1],[1036,13,1036,99,1],[1037,13,1037,54,1],[1038,13,1038,50,1],[1040,13,1040,28,1],[1041,17,1041,45,1],[1043,17,1043,46,1],[1044,13,1044,88,1],[1045,13,1045,20,1],[1045,22,1045,59,1],[1045,60,1045,62,1],[1045,63,1045,70,1],[1046,13,1046,14,1],[1047,17,1047,84,1],[1048,17,1048,100,1],[1049,13,1049,14,1],[1050,13,1050,74,1],[1051,13,1051,66,1],[1052,13,1052,40,1],[1054,13,1054,20,1],[1054,22,1054,59,1],[1054,60,1054,62,1],[1054,63,1054,70,1],[1055,13,1055,14,1],[1056,17,1056,94,1],[1057,21,1057,89,1],[1058,22,1058,99,1],[1059,17,1059,18,1],[1060,21,1060,89,1],[1061,21,1061,103,1],[1062,17,1062,18,1],[1063,13,1063,14,1],[1065,13,1065,52,1],[1066,17,1066,116,1],[1068,13,1068,48,1],[1068,49,1068,116,1],[1069,13,1069,49,1],[1069,50,1069,119,1],[1070,13,1070,49,1],[1070,50,1070,130,1],[1071,13,1071,44,1],[1072,17,1072,98,1],[1073,13,1073,43,1],[1074,17,1074,100,1],[1075,13,1075,41,1],[1075,42,1075,121,1],[1076,13,1076,40,1],[1076,41,1076,118,1],[1077,13,1077,41,1],[1077,42,1077,121,1],[1078,13,1078,45,1],[1079,17,1079,104,1],[1080,13,1080,49,1],[1081,17,1081,112,0],[1082,13,1082,49,1],[1083,17,1083,116,1],[1086,13,1086,48,1],[1089,13,1089,46,1],[1090,9,1090,10,1],[1093,9,1093,10,1],[1094,13,1094,42,1],[1095,13,1095,35,1],[1096,13,1098,90,1],[1099,13,1099,34,1],[1100,13,1100,96,1],[1101,13,1102,29,1],[1103,17,1103,58,1],[1104,13,1104,36,1],[1105,13,1105,45,1],[1106,13,1106,38,1],[1107,17,1107,39,1],[1108,13,1108,45,1],[1109,13,1109,35,1],[1110,9,1110,10,1],[1113,9,1113,10,1],[1114,13,1116,36,1],[1117,13,1117,85,1],[1118,13,1118,35,1],[1119,17,1119,77,1],[1121,13,1121,206,1],[1123,13,1123,29,1],[1126,13,1126,20,1],[1126,22,1126,59,1],[1126,60,1126,62,1],[1126,63,1126,70,1],[1127,13,1127,14,1],[1128,17,1128,56,1],[1129,17,1129,72,1],[1130,21,1130,62,0],[1132,17,1132,60,1],[1133,21,1133,30,0],[1135,17,1136,294,1],[1137,17,1137,39,1],[1138,13,1138,14,1],[1140,13,1140,39,1],[1141,17,1142,272,1],[1144,13,1144,40,1],[1145,17,1146,255,0],[1148,13,1148,32,1],[1151,13,1151,51,1],[1152,13,1152,35,1],[1153,17,1153,60,1],[1155,13,1155,67,1],[1156,13,1156,66,1],[1158,13,1158,20,1],[1158,22,1158,59,1],[1158,60,1158,62,1],[1158,63,1158,70,1],[1159,13,1159,14,1],[1160,17,1160,60,1],[1161,21,1161,30,0],[1162,17,1162,119,1],[1163,17,1163,81,1],[1164,13,1164,14,1],[1166,13,1166,39,1],[1167,13,1167,14,1],[1168,17,1168,89,1],[1169,17,1169,79,1],[1170,13,1170,14,1],[1172,13,1172,40,1],[1173,13,1173,14,0],[1174,17,1174,89,0],[1175,17,1175,79,0],[1176,13,1176,14,0],[1177,13,1177,45,1],[1178,9,1178,10,1],[1181,9,1181,10,1],[1182,13,1182,82,1],[1183,17,1183,71,0],[1184,18,1184,91,1],[1185,17,1185,75,1],[1186,18,1186,97,1],[1187,17,1187,81,0],[1188,18,1188,89,1],[1189,17,1189,73,1],[1191,13,1191,69,1],[1192,9,1192,10,1],[1195,9,1195,10,1],[1196,13,1196,37,1],[1197,17,1197,366,0],[1198,13,1198,358,1],[1199,9,1199,10,1],[1201,9,1201,10,1],[1202,13,1202,42,1],[1203,13,1203,253,1],[1205,13,1205,34,1],[1206,9,1206,10,1],[1209,9,1209,10,1],[1210,13,1212,36,1],[1213,13,1215,31,1],[1216,9,1216,10,1],[1218,9,1218,10,1],[1219,13,1220,139,1],[1221,13,1222,116,1],[1224,13,1224,116,1],[1225,13,1225,20,1],[1225,22,1225,44,1],[1225,45,1225,47,1],[1225,48,1225,71,1],[1226,13,1226,14,1],[1227,17,1227,109,1],[1228,13,1228,14,1],[1229,13,1229,35,1],[1230,13,1230,33,1],[1231,9,1231,10,1],[1234,9,1234,10,1],[1235,13,1236,254,1],[1238,18,1238,31,1],[1238,33,1238,65,1],[1238,67,1238,74,1],[1239,13,1239,14,1],[1240,17,1240,71,1],[1241,21,1244,89,1],[1245,13,1245,14,1],[1247,13,1247,70,1],[1248,13,1248,14,0],[1249,17,1249,103,0],[1250,17,1251,91,0],[1252,13,1252,14,0],[1254,13,1254,33,1],[1255,9,1255,10,1],[1258,9,1258,10,1],[1259,13,1259,86,1],[1260,9,1260,10,1],[1263,9,1263,10,0],[1264,13,1264,100,0],[1265,9,1265,10,0],[1268,9,1268,10,1],[1269,13,1269,42,1],[1270,13,1270,84,1],[1271,13,1271,120,1],[1272,13,1272,45,1],[1273,13,1274,25,1],[1275,13,1275,28,1],[1276,13,1276,36,1],[1277,13,1277,98,1],[1278,13,1278,96,1],[1279,13,1279,96,1],[1280,13,1280,98,1],[1281,13,1281,107,1],[1282,9,1282,10,1],[1285,9,1285,10,1],[1286,13,1286,69,1],[1287,17,1287,118,1],[1288,13,1288,45,1],[1289,13,1289,14,1],[1290,17,1290,88,1],[1291,17,1291,95,1],[1292,13,1292,14,1],[1293,13,1293,33,1],[1294,13,1294,51,1],[1295,9,1295,10,1],[1298,9,1298,10,1],[1299,13,1300,53,1],[1301,13,1302,91,1],[1303,13,1304,92,1],[1306,13,1307,85,1],[1308,13,1309,49,1],[1310,13,1311,51,1],[1319,9,1319,10,1],[1322,9,1322,10,1],[1323,13,1323,66,1],[1324,13,1324,14,0],[1325,17,1325,103,0],[1326,17,1326,43,0],[1327,17,1327,18,0],[1328,21,1329,105,0],[1331,13,1331,14,0],[1332,13,1332,48,1],[1333,9,1333,10,1],[1357,17,1357,18,0],[1357,19,1357,34,0],[1357,35,1357,36,0],[1358,17,1358,18,1],[1358,19,1358,35,1],[1358,36,1358,37,1],[1363,17,1363,18,1],[1363,19,1363,41,1],[1363,42,1363,43,1],[1364,17,1364,18,1],[1364,19,1364,42,1],[1364,43,1364,44,1],[1369,17,1369,18,1],[1369,19,1369,36,1],[1369,37,1369,38,1],[1370,17,1370,18,1],[1370,19,1370,37,1],[1370,38,1370,39,1],[1373,41,1373,45,0],[1373,46,1373,50,1],[1375,42,1375,46,0],[1375,47,1375,51,1],[1377,45,1377,49,1],[1377,50,1377,54,1],[1379,51,1379,55,1],[1379,56,1379,60,1],[1381,47,1381,51,1],[1381,52,1381,56,1],[1385,17,1385,18,1],[1385,19,1385,39,1],[1385,40,1385,41,1],[1386,17,1386,18,1],[1386,19,1386,40,1],[1386,41,1386,42,1],[1389,42,1389,46,1],[1389,47,1389,51,1],[1391,49,1391,53,0],[1391,54,1391,58,1],[1395,17,1395,18,0],[1395,19,1395,36,0],[1395,37,1395,38,0],[1396,17,1396,18,1],[1396,19,1396,37,1],[1396,38,1396,39,1],[1399,46,1399,50,0],[1399,51,1399,55,1],[1403,17,1403,18,0],[1403,19,1403,48,0],[1403,49,1403,50,0],[1404,17,1404,18,1],[1404,19,1404,49,1],[1404,50,1404,51,1],[1409,17,1409,18,0],[1409,19,1409,49,0],[1409,50,1409,51,0],[1410,17,1410,18,1],[1410,19,1410,50,1],[1410,51,1410,52,1],[1415,17,1415,18,0],[1415,19,1415,47,0],[1415,48,1415,49,0],[1416,17,1416,18,1],[1416,19,1416,48,1],[1416,49,1416,50,1],[1421,17,1421,18,0],[1421,19,1421,57,0],[1421,58,1421,59,0],[1422,17,1422,18,1],[1422,19,1422,58,1],[1422,59,1422,60,1],[1427,17,1427,18,0],[1427,19,1427,44,0],[1427,45,1427,46,0],[1428,17,1428,18,1],[1428,19,1428,45,1],[1428,46,1428,47,1],[1431,47,1431,51,1],[1431,52,1431,56,1],[1433,40,1433,44,0],[1433,45,1433,49,1],[1437,17,1437,18,0],[1437,19,1437,37,0],[1437,38,1437,39,0],[1438,17,1438,18,1],[1438,19,1438,38,1],[1438,39,1438,40,1],[1441,44,1441,48,1],[1441,49,1441,53,1],[1445,17,1445,18,0],[1445,19,1445,39,0],[1445,40,1445,41,0],[1446,17,1446,18,1],[1446,19,1446,40,1],[1446,41,1446,42,1],[1449,63,1449,67,0],[1449,68,1449,72,1],[1451,48,1451,52,1],[1451,53,1451,57,1],[1455,17,1455,18,1],[1455,19,1455,35,1],[1455,36,1455,37,1],[1458,47,1458,51,0],[1458,52,1458,56,1],[1459,47,1459,51,1],[1459,52,1459,56,1],[1460,46,1460,50,1],[1460,51,1460,55,1],[1461,56,1461,60,1],[1461,61,1461,65,1],[1462,48,1462,52,1],[1462,53,1462,57,1],[1463,55,1463,59,1],[1463,60,1463,64,1],[1464,47,1464,51,1],[1464,52,1464,56,1],[1466,66,1466,70,1],[1466,71,1466,75,0],[1468,34,1468,38,1],[1468,39,1468,43,0],[1471,9,1471,10,1],[1472,13,1472,47,1],[1473,13,1473,23,1],[1474,13,1474,47,1],[1475,13,1475,20,1],[1475,22,1475,51,1],[1475,52,1475,54,1],[1475,55,1475,62,1],[1476,13,1476,14,1],[1477,17,1477,80,1],[1478,17,1478,18,1],[1479,21,1479,49,1],[1480,17,1480,18,1],[1481,13,1481,14,1],[1482,13,1482,83,1],[1483,13,1483,20,1],[1483,22,1483,33,1],[1483,34,1483,36,1],[1483,37,1483,56,1],[1484,13,1484,14,1],[1485,17,1485,31,1],[1486,17,1486,24,1],[1486,26,1486,55,1],[1486,56,1486,58,1],[1486,59,1486,66,1],[1487,17,1487,18,1],[1488,21,1488,84,1],[1489,21,1489,22,1],[1490,25,1490,78,1],[1491,25,1491,33,1],[1492,21,1492,22,1],[1493,17,1493,18,1],[1494,17,1499,59,1],[1500,17,1500,41,1],[1501,17,1501,51,1],[1502,17,1502,21,1],[1503,13,1503,14,1],[1506,13,1506,23,1],[1508,13,1508,71,1],[1509,13,1509,14,0],[1510,17,1510,116,0],[1511,17,1511,55,0],[1512,17,1512,18,0],[1514,21,1515,61,0],[1516,17,1516,18,0],[1517,13,1517,14,0],[1518,9,1518,10,1],[1521,9,1521,10,0],[1522,13,1522,49,0],[1523,13,1523,20,0],[1523,22,1523,48,0],[1523,49,1523,51,0],[1523,52,1523,66,0],[1524,13,1524,14,0],[1525,17,1525,63,0],[1526,17,1526,18,0],[1527,21,1527,54,0],[1528,21,1528,27,0],[1530,13,1530,14,0],[1531,13,1531,34,0],[1532,9,1532,10,0],[1535,9,1535,10,0],[1536,13,1536,44,0],[1538,13,1538,71,0],[1539,13,1539,58,0],[1540,13,1540,14,0],[1541,17,1541,74,0],[1542,17,1542,57,0],[1543,17,1543,37,0],[1544,17,1544,32,0],[1545,17,1545,18,0],[1547,21,1547,22,0],[1548,25,1548,99,0],[1549,25,1549,70,0],[1550,25,1550,26,0],[1551,29,1551,92,0],[1552,29,1552,69,0],[1553,25,1553,26,0],[1555,29,1555,45,0],[1556,21,1556,22,0],[1557,21,1557,38,0],[1558,21,1558,22,0],[1559,25,1559,41,0],[1560,21,1560,22,0],[1561,17,1561,18,0],[1562,13,1562,14,0],[1564,13,1564,29,0],[1565,9,1565,10,0],[1568,9,1568,10,1],[1569,13,1569,51,1],[1570,13,1570,20,1],[1570,22,1570,45,1],[1570,46,1570,48,1],[1570,49,1570,63,1],[1571,13,1571,14,1],[1572,17,1572,60,1],[1573,21,1573,55,1],[1574,13,1574,14,1],[1575,13,1575,35,1],[1576,9,1576,10,1],[1579,9,1579,10,1],[1580,13,1580,51,1],[1581,13,1581,20,1],[1581,22,1581,45,1],[1581,46,1581,48,1],[1581,49,1581,63,1],[1582,13,1582,14,1],[1583,17,1583,42,1],[1584,21,1584,55,1],[1585,13,1585,14,1],[1586,13,1586,35,1],[1587,9,1587,10,1],[1590,9,1590,10,1],[1592,13,1592,35,1],[1593,17,1593,49,1],[1595,17,1595,58,1],[1597,13,1597,20,1],[1597,22,1597,37,1],[1597,38,1597,40,1],[1597,41,1597,56,1],[1598,13,1598,14,1],[1599,17,1599,104,1],[1600,17,1600,32,1],[1601,13,1601,14,1],[1602,9,1602,10,1],[1605,9,1605,10,1],[1606,13,1606,44,1],[1607,13,1607,20,1],[1607,22,1607,45,1],[1607,46,1607,48,1],[1607,49,1607,63,1],[1608,13,1608,14,1],[1609,17,1609,60,1],[1610,17,1610,18,1],[1611,21,1611,46,1],[1612,21,1612,27,1],[1614,13,1614,14,1],[1616,13,1616,41,1],[1617,9,1617,10,1],[1620,9,1620,10,0],[1621,13,1621,44,0],[1622,13,1622,20,0],[1622,22,1622,45,0],[1622,46,1622,48,0],[1622,49,1622,63,0],[1623,13,1623,14,0],[1624,17,1624,44,0],[1625,17,1625,18,0],[1626,21,1626,46,0],[1627,21,1627,27,0],[1629,13,1629,14,0],[1630,13,1630,29,0],[1631,9,1631,10,0],[1634,9,1634,10,1],[1635,13,1635,54,1],[1636,13,1636,20,1],[1636,22,1636,43,1],[1636,44,1636,46,1],[1636,47,1636,61,1],[1637,13,1637,14,1],[1638,17,1638,58,1],[1639,21,1639,70,0],[1640,13,1640,14,1],[1641,13,1641,35,1],[1642,9,1642,10,1],[1645,9,1645,10,0],[1646,13,1646,40,0],[1650,13,1650,63,0],[1653,13,1653,20,0],[1653,22,1653,34,0],[1653,35,1653,37,0],[1653,38,1653,43,0],[1654,13,1654,14,0],[1655,17,1655,70,0],[1656,13,1656,14,0],[1659,13,1659,20,0],[1659,22,1659,43,0],[1659,44,1659,46,0],[1659,47,1659,61,0],[1660,13,1660,14,0],[1661,17,1661,57,0],[1662,17,1662,18,0],[1663,21,1663,76,0],[1664,17,1664,18,0],[1665,13,1665,14,0],[1666,13,1666,36,0],[1667,9,1667,10,0],[1670,9,1670,10,1],[1671,13,1671,83,1],[1672,9,1672,10,1],[1675,9,1675,10,1],[1676,13,1676,65,1],[1677,9,1677,10,1],[1680,9,1680,10,1],[1681,13,1681,109,1],[1682,17,1682,29,1],[1684,17,1684,53,1],[1685,9,1685,10,1],[1688,9,1688,10,1],[1689,13,1689,37,1],[1690,13,1690,113,1],[1691,13,1691,35,1],[1692,13,1692,14,1],[1693,17,1694,88,1],[1696,13,1696,14,1],[1697,13,1697,42,1],[1698,13,1698,58,1],[1699,13,1699,67,1],[1700,13,1700,175,1],[1701,13,1701,36,1],[1702,13,1702,35,1],[1703,17,1703,141,1],[1704,13,1704,136,1],[1706,13,1706,110,1],[1708,13,1708,25,1],[1709,13,1709,14,1],[1710,17,1715,127,1],[1717,17,1717,129,1],[1719,17,1719,93,1],[1721,17,1721,42,1],[1724,17,1724,125,1],[1725,17,1725,18,1],[1726,21,1727,105,1],[1728,21,1728,63,1],[1729,21,1729,22,1],[1730,25,1730,72,1],[1731,25,1731,87,1],[1732,21,1732,22,1],[1733,21,1733,105,1],[1734,17,1734,18,1],[1736,17,1736,89,1],[1737,17,1741,67,1],[1744,17,1744,35,1],[1745,13,1745,14,1],[1747,13,1747,14,1],[1749,17,1749,93,1],[1750,17,1757,37,1],[1758,13,1758,14,1],[1759,13,1759,38,1],[1762,13,1762,29,1],[1764,13,1764,20,1],[1764,22,1764,59,1],[1764,60,1764,62,1],[1764,63,1764,70,1],[1765,13,1765,14,1],[1767,17,1767,60,1],[1768,21,1768,30,0],[1770,17,1770,56,1],[1771,17,1771,72,1],[1772,21,1772,54,0],[1774,17,1776,103,1],[1777,17,1777,68,1],[1780,17,1780,110,1],[1781,17,1781,18,1],[1782,21,1782,98,1],[1783,21,1783,22,1],[1784,25,1784,80,1],[1785,29,1787,113,0],[1788,30,1788,116,1],[1789,29,1789,53,0],[1790,30,1790,78,1],[1791,29,1791,171,1],[1792,30,1793,121,1],[1794,25,1794,26,1],[1801,29,1805,57,1],[1806,25,1806,26,1],[1807,21,1807,22,1],[1808,17,1808,18,1],[1810,17,1812,106,1],[1813,17,1813,18,0],[1814,21,1814,84,0],[1815,17,1815,18,0],[1817,17,1818,182,1],[1819,17,1819,18,0],[1820,21,1820,119,0],[1821,17,1821,18,0],[1823,17,1823,43,1],[1824,17,1824,27,1],[1825,13,1825,14,1],[1828,13,1828,39,1],[1829,13,1829,14,1],[1830,17,1830,109,1],[1831,17,1831,49,1],[1832,17,1832,18,1],[1835,21,1838,58,1],[1839,17,1839,18,1],[1841,21,1841,76,0],[1842,17,1842,46,1],[1843,13,1843,14,1],[1845,13,1845,40,1],[1846,13,1846,14,0],[1847,17,1847,109,0],[1850,17,1853,59,0],[1854,17,1854,46,0],[1855,13,1855,14,0],[1858,13,1858,32,1],[1860,13,1860,25,1],[1861,13,1861,14,1],[1862,17,1862,32,1],[1863,17,1863,18,1],[1864,21,1865,99,1],[1866,17,1866,18,1],[1868,17,1868,18,1],[1870,17,1870,18,1],[1871,13,1871,14,1],[1872,13,1872,35,1],[1873,9,1873,10,1],[1876,9,1876,10,1],[1877,13,1877,42,1],[1878,13,1878,31,1],[1879,13,1879,27,1],[1880,13,1880,55,1],[1881,13,1881,37,1],[1882,13,1882,14,1],[1883,17,1883,31,1],[1884,17,1884,70,1],[1885,17,1885,111,1],[1886,17,1886,42,1],[1887,17,1887,18,0],[1888,21,1888,28,0],[1888,30,1888,38,0],[1888,39,1888,41,0],[1888,42,1888,54,0],[1889,21,1889,22,0],[1890,30,1890,39,0],[1890,41,1890,60,0],[1890,62,1890,65,0],[1891,25,1891,26,0],[1892,29,1892,97,0],[1893,29,1893,30,0],[1894,33,1894,59,0],[1895,33,1895,65,0],[1895,65,1895,88,0],[1895,88,1895,90,0],[1895,33,1895,90,0],[1896,33,1896,40,0],[1896,42,1896,49,0],[1896,50,1896,52,0],[1896,53,1896,57,0],[1897,33,1897,34,0],[1899,37,1899,38,0],[1900,41,1900,119,0],[1901,45,1901,62,0],[1903,45,1903,127,0],[1904,37,1904,38,0],[1905,37,1905,57,0],[1906,37,1906,38,0],[1907,37,1907,38,0],[1908,33,1908,34,0],[1909,29,1909,30,0],[1910,25,1910,26,0],[1911,21,1911,22,0],[1912,17,1912,18,0],[1913,17,1914,139,1],[1916,17,1916,56,1],[1917,17,1917,24,1],[1917,26,1917,36,1],[1917,37,1917,39,1],[1917,40,1917,48,1],[1918,17,1918,18,1],[1919,21,1919,66,1],[1920,17,1920,18,1],[1922,17,1922,42,1],[1923,17,1923,46,1],[1924,17,1924,60,1],[1925,17,1925,18,1],[1926,21,1926,100,1],[1927,21,1927,106,1],[1928,17,1928,18,1],[1930,17,1930,24,1],[1930,26,1930,36,1],[1930,37,1930,39,1],[1930,40,1930,48,1],[1931,17,1931,18,1],[1932,21,1932,105,1],[1933,21,1933,121,1],[1934,21,1934,29,1],[1935,21,1935,259,1],[1936,21,1937,73,1],[1938,25,1938,47,1],[1939,26,1939,100,1],[1940,25,1940,47,0],[1941,26,1941,40,1],[1942,25,1942,96,1],[1944,25,1944,98,1],[1945,21,1945,44,1],[1948,21,1948,57,1],[1951,21,1951,63,1],[1952,21,1952,81,1],[1954,21,1954,50,1],[1955,25,1955,50,1],[1957,21,1957,22,1],[1958,25,1958,71,1],[1959,25,1959,26,1],[1960,29,1960,107,1],[1961,29,1961,75,1],[1962,25,1962,26,1],[1963,25,1963,67,1],[1964,21,1964,22,1],[1965,21,1965,58,1],[1967,21,1967,55,1],[1968,21,1968,55,1],[1969,21,1971,110,1],[1972,21,1972,22,1],[1973,25,1973,77,1],[1974,25,1974,26,1],[1975,29,1975,58,1],[1976,29,1976,47,1],[1977,25,1977,26,1],[1978,25,1978,77,1],[1979,25,1979,26,1],[1980,29,1980,58,1],[1981,29,1981,47,1],[1982,25,1982,26,1],[1983,30,1983,82,1],[1984,25,1984,26,1],[1985,29,1985,58,1],[1986,29,1986,57,1],[1987,25,1987,26,1],[1989,25,1989,26,1],[1990,29,1990,58,1],[1991,29,1991,47,1],[1992,25,1992,26,1],[1993,21,1993,22,1],[1995,21,1996,107,1],[1997,21,1997,22,0],[1998,25,1998,83,0],[1999,25,1999,26,0],[2000,29,2000,58,0],[2001,29,2001,57,0],[2002,25,2002,26,0],[2003,21,2003,22,0],[2004,21,2005,99,1],[2006,21,2006,22,1],[2012,25,2012,66,1],[2013,25,2013,50,1],[2014,25,2014,65,1],[2015,25,2015,47,1],[2016,25,2016,65,1],[2017,21,2017,22,1],[2019,21,2019,37,1],[2020,21,2020,43,1],[2021,21,2021,22,1],[2022,25,2022,53,1],[2023,25,2023,26,0],[2024,29,2024,46,0],[2025,29,2025,36,0],[2025,38,2025,75,0],[2025,76,2025,78,0],[2025,79,2025,86,0],[2026,29,2026,30,0],[2027,33,2027,81,0],[2028,33,2028,34,0],[2029,37,2029,43,0],[2031,33,2031,44,0],[2032,29,2032,30,0],[2033,29,2036,87,0],[2037,25,2037,26,0],[2039,25,2039,26,1],[2040,29,2041,84,1],[2042,25,2042,26,1],[2043,21,2043,22,1],[2045,21,2045,128,1],[2047,21,2047,134,1],[2048,21,2048,78,1],[2049,21,2049,61,1],[2050,21,2050,64,1],[2051,25,2051,70,0],[2053,21,2053,41,1],[2054,21,2054,22,1],[2055,25,2055,118,1],[2056,25,2056,57,1],[2057,29,2057,78,1],[2058,21,2058,22,1],[2060,21,2060,45,1],[2061,21,2061,22,1],[2062,25,2062,122,1],[2063,25,2063,57,1],[2064,29,2064,79,1],[2065,21,2065,22,1],[2073,21,2076,53,1],[2077,21,2077,22,1],[2078,25,2078,112,1],[2080,21,2080,22,1],[2082,21,2082,22,1],[2083,25,2083,128,1],[2084,25,2084,65,1],[2085,25,2085,68,1],[2086,29,2086,74,0],[2087,25,2087,44,1],[2088,25,2088,42,1],[2089,25,2089,44,1],[2090,25,2090,113,1],[2091,25,2091,53,1],[2092,21,2092,22,1],[2093,21,2093,58,1],[2094,21,2094,22,1],[2095,25,2096,70,1],[2097,21,2097,22,1],[2099,21,2099,22,1],[2100,25,2100,172,1],[2101,21,2101,22,1],[2103,21,2103,70,1],[2104,21,2104,22,1],[2105,25,2105,116,1],[2106,25,2106,69,1],[2107,29,2107,98,1],[2108,25,2108,67,1],[2109,29,2109,88,0],[2110,25,2110,68,1],[2111,29,2111,90,0],[2113,25,2114,43,1],[2115,21,2115,22,1],[2116,26,2116,74,1],[2117,21,2117,22,0],[2118,25,2118,68,0],[2119,25,2119,69,0],[2120,29,2120,120,0],[2122,25,2124,43,0],[2125,21,2125,22,0],[2127,21,2127,22,1],[2129,25,2129,91,1],[2130,21,2130,22,1],[2131,21,2131,46,1],[2134,21,2134,37,1],[2136,21,2136,28,1],[2136,30,2136,67,1],[2136,68,2136,70,1],[2136,71,2136,78,1],[2137,21,2137,22,1],[2138,25,2138,68,1],[2139,29,2139,38,0],[2140,25,2140,55,1],[2141,25,2141,44,1],[2142,25,2142,107,1],[2143,29,2143,88,1],[2144,30,2144,59,1],[2145,29,2145,87,1],[2146,30,2146,78,1],[2147,29,2147,59,1],[2149,25,2149,26,1],[2150,29,2150,76,1],[2151,33,2151,114,1],[2153,33,2153,113,1],[2154,25,2154,26,1],[2157,25,2158,123,1],[2159,25,2159,26,1],[2160,29,2160,66,1],[2161,29,2161,84,1],[2162,29,2162,30,0],[2163,33,2163,126,0],[2164,29,2164,30,0],[2165,34,2165,89,1],[2166,29,2166,30,1],[2167,33,2167,63,1],[2168,29,2168,30,1],[2169,34,2169,82,1],[2170,29,2170,30,1],[2171,33,2171,92,1],[2172,29,2172,30,1],[2173,34,2178,95,1],[2179,29,2179,30,1],[2180,33,2184,120,1],[2185,29,2185,30,1],[2186,34,2188,80,1],[2189,29,2189,30,1],[2195,33,2200,70,1],[2201,29,2201,30,1],[2203,29,2203,83,1],[2204,29,2204,30,0],[2205,33,2206,120,0],[2209,33,2209,100,0],[2210,37,2210,118,0],[2211,33,2211,75,0],[2212,37,2212,96,0],[2213,33,2213,76,0],[2214,37,2214,98,0],[2215,33,2215,70,0],[2216,37,2216,92,0],[2217,33,2217,95,0],[2218,37,2218,106,0],[2220,33,2220,118,0],[2221,29,2221,30,0],[2223,29,2223,30,1],[2225,33,2225,129,1],[2226,29,2226,30,1],[2227,25,2227,26,1],[2228,25,2228,50,1],[2229,25,2229,35,1],[2230,21,2230,22,1],[2232,21,2232,47,1],[2233,21,2233,22,1],[2234,25,2234,55,1],[2235,25,2235,54,1],[2236,25,2236,71,1],[2237,25,2237,78,1],[2238,29,2238,53,0],[2239,30,2239,76,1],[2240,29,2240,80,0],[2242,25,2242,26,1],[2245,29,2250,66,1],[2251,25,2251,26,1],[2252,25,2252,50,1],[2253,21,2253,22,1],[2255,21,2255,48,1],[2256,21,2256,22,0],[2257,25,2257,55,0],[2258,25,2258,54,0],[2259,25,2259,71,0],[2260,25,2260,89,0],[2261,29,2261,53,0],[2262,30,2262,81,0],[2263,29,2263,66,0],[2265,25,2265,26,0],[2268,29,2273,66,0],[2274,25,2274,26,0],[2275,25,2275,50,0],[2276,21,2276,22,0],[2278,21,2278,40,1],[2285,17,2285,18,1],[2286,13,2286,14,1],[2287,13,2287,35,1],[2288,9,2288,10,1],[2291,9,2291,10,0],[2292,13,2292,42,0],[2294,13,2294,110,0],[2295,13,2298,87,0],[2299,13,2303,77,0],[2304,13,2305,90,0],[2306,13,2306,40,0],[2308,13,2308,34,0],[2309,9,2309,10,0],[2312,9,2312,10,1],[2313,13,2313,54,1],[2314,13,2314,42,1],[2315,13,2315,14,1],[2316,17,2316,36,1],[2317,17,2317,76,1],[2318,17,2318,18,1],[2319,21,2319,66,1],[2320,21,2320,78,1],[2321,17,2321,18,1],[2322,22,2322,47,1],[2323,17,2323,18,1],[2324,21,2324,87,1],[2325,21,2325,78,1],[2326,17,2326,18,1],[2327,13,2327,14,1],[2328,13,2328,34,1],[2329,9,2329,10,1],[2333,9,2333,10,1],[2334,13,2334,42,1],[2336,13,2336,40,1],[2337,13,2337,14,1],[2338,17,2338,24,1],[2338,26,2338,36,1],[2338,37,2338,39,1],[2338,40,2338,51,1],[2339,17,2339,18,1],[2340,21,2340,52,1],[2341,21,2341,60,1],[2342,21,2342,63,1],[2343,21,2343,66,1],[2344,25,2344,72,0],[2345,21,2345,62,1],[2347,21,2347,35,1],[2348,21,2348,22,1],[2349,25,2349,45,1],[2350,21,2350,22,1],[2352,21,2352,22,1],[2353,25,2353,47,1],[2354,21,2354,22,1],[2355,21,2355,44,1],[2358,21,2358,92,1],[2359,21,2359,55,1],[2361,21,2361,77,1],[2362,21,2362,43,1],[2363,25,2364,114,1],[2365,21,2365,144,1],[2366,21,2366,35,1],[2368,21,2368,118,1],[2369,21,2369,81,1],[2370,21,2370,60,1],[2371,21,2371,63,1],[2372,21,2372,66,1],[2373,25,2373,72,0],[2375,21,2375,51,1],[2376,25,2376,111,1],[2378,21,2378,22,0],[2379,25,2380,68,0],[2381,25,2381,64,0],[2382,25,2382,67,0],[2383,25,2383,70,0],[2384,29,2384,76,0],[2385,25,2385,44,0],[2386,25,2386,61,0],[2387,25,2387,44,0],[2388,25,2388,42,0],[2389,25,2389,53,0],[2390,21,2390,22,0],[2391,21,2391,140,1],[2392,21,2392,62,1],[2393,21,2393,46,1],[2394,21,2394,37,1],[2395,21,2395,28,1],[2395,30,2395,67,1],[2395,68,2395,70,1],[2395,71,2395,78,1],[2396,21,2396,22,1],[2397,25,2397,54,1],[2398,29,2398,87,1],[2400,29,2400,59,1],[2401,25,2401,44,1],[2402,25,2402,43,1],[2403,25,2404,119,1],[2405,29,2405,82,0],[2406,30,2408,74,1],[2409,29,2409,82,1],[2410,30,2410,74,1],[2411,29,2414,66,1],[2416,29,2416,49,1],[2417,25,2417,44,1],[2418,25,2418,35,1],[2419,21,2419,22,1],[2421,21,2421,47,1],[2422,21,2422,22,1],[2423,25,2423,83,1],[2424,25,2424,54,1],[2425,25,2425,42,1],[2426,25,2427,78,1],[2428,29,2428,49,1],[2429,30,2429,76,0],[2430,29,2430,80,0],[2432,25,2432,26,0],[2435,29,2440,66,0],[2441,25,2441,26,0],[2442,25,2442,44,1],[2443,21,2443,22,1],[2444,21,2444,40,1],[2445,17,2445,18,1],[2446,13,2446,14,1],[2448,13,2448,35,1],[2449,9,2449,10,1],[2452,9,2452,10,0],[2453,13,2453,42,0],[2455,13,2455,43,0],[2456,13,2456,14,0],[2457,17,2457,24,0],[2457,26,2457,36,0],[2457,37,2457,39,0],[2457,40,2457,54,0],[2458,17,2458,18,0],[2459,21,2459,52,0],[2460,21,2460,61,0],[2461,21,2461,62,0],[2463,21,2463,35,0],[2464,21,2464,22,0],[2465,25,2465,45,0],[2466,21,2466,22,0],[2468,21,2468,22,0],[2469,25,2469,47,0],[2470,21,2470,22,0],[2471,21,2471,44,0],[2474,21,2474,93,0],[2476,21,2476,37,0],[2477,21,2477,43,0],[2478,21,2478,22,0],[2479,25,2479,101,0],[2480,25,2481,58,0],[2482,25,2482,49,0],[2483,21,2483,22,0],[2484,21,2484,162,0],[2486,21,2486,104,0],[2487,21,2488,123,0],[2490,21,2490,55,0],[2491,21,2491,37,0],[2492,21,2492,76,0],[2493,21,2493,38,0],[2494,21,2494,46,0],[2495,21,2495,37,0],[2496,21,2496,28,0],[2496,30,2496,67,0],[2496,68,2496,70,0],[2496,71,2496,78,0],[2497,21,2497,22,0],[2498,25,2498,54,0],[2499,29,2499,87,0],[2501,29,2501,59,0],[2502,25,2502,44,0],[2503,25,2503,43,0],[2504,25,2506,71,0],[2507,29,2507,82,0],[2508,30,2508,115,0],[2509,29,2512,57,0],[2514,29,2514,49,0],[2515,25,2515,44,0],[2516,25,2516,35,0],[2517,21,2517,22,0],[2519,21,2519,47,0],[2520,21,2520,22,0],[2521,25,2521,83,0],[2522,25,2522,54,0],[2523,25,2523,42,0],[2524,25,2524,45,0],[2525,25,2525,44,0],[2526,21,2526,22,0],[2527,21,2527,44,0],[2528,17,2528,18,0],[2529,13,2529,14,0],[2530,13,2530,35,0],[2531,9,2531,10,0],[2534,9,2534,10,1],[2535,13,2535,42,1],[2537,13,2537,81,1],[2539,13,2539,88,1],[2540,13,2540,20,1],[2540,22,2540,44,1],[2540,45,2540,47,1],[2540,48,2540,74,1],[2541,17,2541,108,1],[2543,13,2543,35,1],[2544,9,2544,10,1],[2551,17,2551,18,0],[2551,19,2551,48,0],[2551,49,2551,50,0],[2555,9,2555,10,0],[2556,13,2556,40,0],[2557,9,2557,10,0],[2560,9,2560,10,0],[2561,13,2561,43,0],[2562,9,2562,10,0],[2565,9,2565,10,0],[2566,13,2566,36,0],[2567,9,2567,10,0],[2570,9,2570,10,0],[2571,13,2571,45,0],[2572,9,2572,10,0],[2583,9,2584,35,1],[2585,9,2585,10,1],[2586,13,2586,24,1],[2587,13,2587,60,1],[2588,13,2589,81,1],[2590,17,2590,99,1],[2591,13,2592,78,1],[2593,17,2593,93,1],[2594,13,2594,58,1],[2595,13,2595,65,1],[2596,13,2596,98,1],[2597,17,2597,77,1],[2599,17,2599,28,1],[2601,13,2601,33,1],[2602,17,2602,31,1],[2604,17,2604,32,1],[2605,13,2605,41,1],[2606,13,2606,14,1],[2607,17,2607,73,1],[2608,22,2608,31,1],[2608,33,2608,56,1],[2608,58,2608,61,1],[2609,17,2609,18,1],[2610,21,2610,97,1],[2611,17,2611,18,1],[2612,13,2612,14,1],[2613,9,2613,10,1],[2615,9,2615,29,0],[2616,9,2616,10,0],[2617,9,2617,10,0],[2620,9,2620,10,0],[2621,13,2621,25,0],[2622,9,2622,10,0],[2624,32,2624,36,1],[2624,37,2624,41,1],[2626,39,2626,43,0],[2626,44,2626,48,1],[2628,32,2628,36,1],[2628,37,2628,41,1],[2630,30,2630,34,0],[2630,35,2630,39,1],[2632,30,2632,34,1],[2632,35,2632,39,1],[2636,17,2636,18,1],[2636,19,2636,35,1],[2636,36,2636,37,1],[2637,17,2637,18,0],[2637,19,2637,36,0],[2637,37,2637,38,0],[2640,32,2640,36,1],[2640,37,2640,41,1],[2642,34,2642,38,1],[2642,39,2642,43,1],[2644,36,2644,40,1],[2644,41,2644,45,1],[2648,17,2648,18,1],[2648,19,2648,47,1],[2648,48,2648,49,1],[2649,17,2649,18,1],[2649,19,2649,48,1],[2649,49,2649,50,1],[2659,17,2659,18,0],[2659,19,2659,51,0],[2659,52,2659,53,0],[2663,9,2663,10,1],[2664,13,2664,38,1],[2665,9,2665,10,1],[2668,9,2668,10,0],[2669,13,2669,41,0],[2670,9,2670,10,0],[2673,9,2673,10,0],[2674,13,2674,34,0],[2675,9,2675,10,0],[2678,9,2678,10,0],[2679,13,2679,43,0],[2680,9,2680,10,0],[2683,9,2683,10,1],[2684,13,2684,20,1],[2684,22,2684,36,1],[2684,37,2684,39,1],[2684,40,2684,44,1],[2685,13,2685,14,1],[2686,17,2686,35,1],[2686,36,2686,48,1],[2687,13,2687,14,1],[2688,13,2688,25,0],[2689,9,2689,10,1],[2695,9,2695,41,0],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2695,9,2695,41,1],[2697,9,2697,95,1],[2698,9,2698,10,1],[2699,13,2699,52,1],[2700,13,2700,32,1],[2701,13,2701,32,1],[2702,13,2702,33,1],[2703,13,2703,39,1],[2704,9,2704,10,1],[2706,9,2706,112,1],[2707,9,2707,10,1],[2708,13,2708,52,1],[2709,13,2709,32,1],[2710,13,2710,42,1],[2711,13,2711,33,1],[2712,13,2712,39,1],[2713,9,2713,10,1],[2715,9,2716,39,1],[2717,9,2717,10,1],[2718,13,2718,52,1],[2719,13,2719,32,1],[2720,13,2720,42,1],[2721,13,2721,33,1],[2722,13,2722,44,1],[2723,13,2723,39,1],[2724,9,2724,10,1],[2726,9,2727,39,1],[2728,9,2728,10,1],[2729,13,2729,52,1],[2730,13,2730,32,1],[2731,13,2731,32,1],[2732,13,2732,34,1],[2733,13,2733,40,1],[2734,13,2734,39,1],[2735,9,2735,10,1],[2737,9,2738,39,1],[2739,9,2739,10,1],[2740,13,2740,52,1],[2741,13,2741,32,1],[2742,13,2742,42,1],[2743,13,2743,42,1],[2744,13,2744,42,1],[2745,13,2745,39,1],[2746,9,2746,10,1],[2748,9,2748,116,1],[2749,9,2749,10,1],[2750,13,2750,52,1],[2751,13,2751,32,1],[2752,13,2752,42,1],[2753,13,2753,34,1],[2754,13,2754,40,1],[2755,9,2755,10,1],[2757,9,2758,55,1],[2759,9,2759,10,1],[2760,13,2760,42,1],[2761,13,2761,32,1],[2762,13,2762,42,1],[2763,13,2763,34,1],[2764,13,2764,40,1],[2765,13,2765,36,1],[2766,13,2766,39,1],[2767,9,2767,10,1],[2769,9,2770,57,0],[2771,9,2771,10,0],[2772,13,2772,52,0],[2773,13,2773,32,0],[2774,13,2774,42,0],[2775,13,2775,34,0],[2776,13,2776,40,0],[2777,13,2777,44,0],[2778,13,2778,39,0],[2779,9,2779,10,0],[2781,9,2782,73,1],[2783,9,2783,10,1],[2784,13,2784,42,1],[2785,13,2785,32,1],[2786,13,2786,42,1],[2787,13,2787,34,1],[2788,13,2788,40,1],[2789,13,2789,36,1],[2790,13,2790,44,1],[2791,13,2791,39,1],[2792,9,2792,10,1],[2797,9,2797,10,1],[2799,13,2799,48,1],[2800,17,2801,43,1],[2803,17,2803,99,0],[2806,13,2806,23,1],[2807,9,2807,10,1],[2813,36,2813,40,1],[2813,41,2813,45,1],[2815,33,2815,37,1],[2815,38,2815,42,1],[2817,36,2817,40,1],[2817,41,2817,45,1],[2819,28,2819,32,1],[2819,33,2819,37,1],[2821,34,2821,38,1],[2821,39,2821,43,1],[2823,32,2823,36,1],[2823,37,2823,41,1],[2825,33,2825,37,1],[2825,38,2825,42,1],[2827,34,2827,38,0],[2827,39,2827,43,0],[2829,36,2829,40,1],[2829,41,2829,45,1],[2833,17,2833,18,1],[2833,19,2833,42,1],[2833,43,2833,44,1],[2834,17,2834,18,0],[2834,19,2834,43,0],[2834,44,2834,45,0],[2837,37,2837,41,1],[2837,42,2837,46,1],[2845,38,2845,42,1],[2845,43,2845,47,1],[2849,17,2849,18,1],[2849,19,2849,64,1],[2849,65,2849,66,1],[2853,9,2853,10,1],[2854,13,2854,40,1],[2855,9,2855,10,1],[2858,9,2858,10,1],[2859,13,2859,43,1],[2860,9,2860,10,1],[2863,9,2863,10,1],[2864,13,2864,36,1],[2865,9,2865,10,1],[2868,9,2868,10,0],[2869,13,2869,45,0],[2870,9,2870,10,0],[2881,9,2881,10,1],[2882,13,2882,54,1],[2883,13,2883,42,1],[2884,13,2884,14,1],[2885,17,2885,82,1],[2886,17,2886,65,1],[2887,21,2887,42,1],[2888,13,2888,14,1],[2889,13,2889,25,0],[2890,9,2890,10,1],[2900,9,2900,10,1],[2901,13,2901,54,1],[2903,13,2903,42,1],[2904,13,2904,14,1],[2905,17,2905,82,1],[2906,17,2906,65,1],[2907,21,2907,33,1],[2908,13,2908,14,1],[2909,13,2909,26,1],[2910,9,2910,10,1],[2918,9,2918,99,1],[2919,9,2919,10,1],[2920,13,2920,46,1],[2922,13,2922,67,1],[2924,13,2924,62,1],[2926,13,2926,43,1],[2927,13,2927,37,1],[2929,13,2929,20,1],[2929,22,2929,59,1],[2929,60,2929,62,1],[2929,63,2929,70,1],[2930,17,2930,47,1],[2930,48,2930,66,1],[2932,18,2932,27,1],[2932,29,2932,83,1],[2932,85,2932,88,1],[2933,13,2933,14,1],[2934,17,2934,64,1],[2935,17,2935,47,1],[2936,17,2936,24,1],[2936,26,2936,63,1],[2936,64,2936,66,1],[2936,67,2936,74,1],[2937,17,2937,18,1],[2938,21,2938,51,1],[2939,25,2939,120,1],[2940,17,2940,18,1],[2941,17,2941,43,1],[2942,13,2942,14,1],[2943,9,2943,10,1],[2947,17,2947,18,1],[2947,19,2947,39,1],[2947,40,2947,41,1],[2953,36,2953,40,1],[2953,41,2953,45,1],[2954,46,2954,50,1],[2954,51,2954,55,1],[2956,9,2956,73,0],[2957,9,2957,10,0],[2958,13,2958,37,0],[2959,13,2959,43,0],[2960,9,2960,10,0],[2962,9,2962,44,1],[2963,9,2963,10,1],[2964,13,2964,37,1],[2965,13,2965,53,1],[2966,9,2966,10,1],[2971,36,2971,40,0],[2971,41,2971,45,0],[2972,31,2972,35,0],[2972,36,2972,40,0],[2973,32,2973,36,0],[2973,37,2973,41,0],[2978,9,2978,51,1],[2979,9,2979,10,1],[2980,13,2980,39,1],[2981,9,2981,10,1],[2983,40,2983,44,1],[2983,45,2983,49,1],[2989,35,2989,39,1],[2989,40,2989,44,1],[2991,44,2991,48,1],[2991,49,2991,53,1],[2992,39,2992,43,0],[2992,44,2992,48,1],[2993,42,2993,46,0],[2993,47,2993,51,1],[2996,9,2996,10,0],[2997,13,2997,71,0],[2998,9,2998,10,0],[3001,9,3001,10,0],[3002,13,3002,59,0],[3003,9,3003,10,0],[3006,9,3006,10,0],[3007,13,3007,61,0],[3008,9,3008,10,0],[3011,9,3011,10,0],[3012,13,3012,49,0],[3013,9,3013,10,0],[3016,9,3016,10,0],[3017,13,3017,67,0],[3018,9,3018,10,0],[3021,9,3021,10,0],[3022,13,3022,55,0],[3023,9,3023,10,0],[3027,9,3027,10,0],[3028,13,3028,103,0],[3029,9,3029,10,0],[3032,9,3032,10,0],[3033,13,3033,91,0],[3034,9,3034,10,0],[3037,9,3037,10,0],[3038,13,3038,88,0],[3039,9,3039,10,0],[3042,9,3042,10,0],[3043,13,3043,76,0],[3044,9,3044,10,0],[3047,9,3047,10,0],[3048,13,3048,97,0],[3049,9,3049,10,0],[3052,9,3052,10,0],[3053,13,3053,85,0],[3054,9,3054,10,0],[3060,9,3060,10,1],[3061,13,3061,80,1],[3062,9,3062,10,1]]);
    </script>
  </body>
</html>