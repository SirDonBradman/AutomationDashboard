<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\ReportServerHelper\ReportServices.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.IO;
using System.Reflection;
using System.Xml;
using System.Xml.Serialization;
using RS05 = Aurigo.Brix.ReportServerHelper2005;
using RS08 = Aurigo.Brix.ReportServerHelper2008;
using RS1 = Aurigo.Brix.ReportServerHelper.reportexecution2005;
using RS10 = Aurigo.Brix.ReportServerHelper2010;


namespace Aurigo.Brix.ReportServerHelper
{
    [Serializable]
    public class ReportingService
    {
        private readonly RS05.ReportingService2005 RptServer2005 = new RS05.ReportingService2005();
        private readonly RS08.ReportingService2008 RptServer2008 = new RS08.ReportingService2008();
        private readonly RS10.ReportingService2010 RptServer2010 = new RS10.ReportingService2010();
        private readonly Dictionary&lt;string, string&gt; WSDL = new Dictionary&lt;string, string&gt;();
        public Dictionary&lt;string, string&gt; ReportSetting;

        //public string connectionString = string.Empty;
        public ReportingService()
        {
            WSDL.Add(&quot;2005&quot;, &quot;/ReportService.asmx&quot;);
            WSDL.Add(&quot;2008&quot;, &quot;/ReportService2005.asmx&quot;);
            WSDL.Add(&quot;2010&quot;, &quot;/ReportService2010.asmx&quot;);
        }

        public void RenderReportToJpeg(Dictionary&lt;string, string&gt; keyValuePairs, string fileName)
        {
            RS1.ReportExecutionService rs = new RS1.ReportExecutionService();
            rs.Credentials = new ReportServerCredentials(ReportSetting);
            rs.Url = ReportSetting[ReportConstants.COL_BASEURL] + &quot;/reportexecution2005.asmx&quot;;

            // Render arguments
            byte[] result = null;
            string reportPath = &quot;/&quot; + ReportSetting[ReportConstants.COL_FOLDER] + &quot;/iPadProject&quot;;
            const string format = &quot;image&quot;;
            string historyID = null;
            const string devInfo = @&quot;&lt;DeviceInfo&gt;&lt;Toolbar&gt;False&lt;/Toolbar&gt;&lt;/DeviceInfo&gt;&quot;;

            string encoding;
            string mimeType;
            string extension;
            RS1.Warning[] warnings = null;
            string[] streamIDs = null;

            RS1.ExecutionInfo execInfo = new RS1.ExecutionInfo();
            RS1.ExecutionHeader execHeader = new RS1.ExecutionHeader();

            rs.ExecutionHeaderValue = execHeader;

            execInfo = rs.LoadReport(reportPath, historyID);

            RS1.ParameterValue[] parameters = new RS1.ParameterValue[execInfo.Parameters.Length];
            int nParam = 0;
            foreach (var rp in execInfo.Parameters)
            {
                parameters[nParam] = new RS1.ParameterValue();
                parameters[nParam].Name = rp.Name;
                if (keyValuePairs.ContainsKey(rp.Name))
                    parameters[nParam].Value = keyValuePairs[rp.Name];
                else if (rp.Nullable)
                    parameters[nParam].Value = null;
                else
                    parameters[nParam].Value = (-1).ToString();

                nParam++;
            }

            rs.SetExecutionParameters(parameters, &quot;en-us&quot;);

            try
            {
                result = rs.Render(format, devInfo, out extension, out mimeType, out encoding, out warnings,
                    out streamIDs);

                execInfo = rs.GetExecutionInfo();
            }
            catch
            {
            }

            // Write the contents of the report to an MHTML file.
            try
            {
                if (result != null)
                {
                    using (FileStream stream = new FileStream(fileName, FileMode.Create))
                    {
                        stream.Write(result, 0, result.Length);
                        stream.Close();
                    }
                }
            }
            catch
            {
            }
        }

        //format : &quot;image&quot;, &quot;pdf&quot;, &quot;doc&quot;
        public void RenderReportWithFormat(Dictionary&lt;string, string&gt; keyValuePairs, string report, string fileName,
            string format = &quot;pdf&quot;)
        {
            RS1.ReportExecutionService rs = new RS1.ReportExecutionService();
            rs.Credentials = new ReportServerCredentials(ReportSetting);
            rs.Url = ReportSetting[ReportConstants.COL_BASEURL] + &quot;/reportexecution2005.asmx&quot;;

            // Render arguments
            byte[] result = null;
            string reportPath = string.Format(&quot;/{0}/{1}&quot;, ReportSetting[ReportConstants.COL_FOLDER], report);
            string historyID = null;
            const string devInfo = @&quot;&lt;DeviceInfo&gt;&lt;Toolbar&gt;False&lt;/Toolbar&gt;&lt;/DeviceInfo&gt;&quot;;

            string encoding;
            string mimeType;
            string extension;
            RS1.Warning[] warnings = null;
            string[] streamIDs = null;

            RS1.ExecutionInfo execInfo = new RS1.ExecutionInfo();
            RS1.ExecutionHeader execHeader = new RS1.ExecutionHeader();

            rs.ExecutionHeaderValue = execHeader;

            execInfo = rs.LoadReport(reportPath, historyID);

            RS1.ParameterValue[] parameters = new RS1.ParameterValue[execInfo.Parameters.Length];
            int nParam = 0;
            foreach (var rp in execInfo.Parameters)
            {
                if (keyValuePairs.ContainsKey(rp.Name))
                {
                    parameters[nParam] = new RS1.ParameterValue();
                    parameters[nParam].Name = rp.Name;
                    parameters[nParam].Value = keyValuePairs[rp.Name];
                    nParam++;
                }
                //else if (rp.Nullable)
                //    parameters[nParam].Value = null;
                //else
                //    parameters[nParam].Value = (-1).ToString();
            }

            rs.SetExecutionParameters(parameters, &quot;en-us&quot;);

            try
            {
                result = rs.Render(format, devInfo, out extension, out mimeType, out encoding, out warnings,
                    out streamIDs);

                execInfo = rs.GetExecutionInfo();
            }
            catch
            {
            }

            // Write the contents of the report to an MHTML file.
            try
            {
                if (result != null)
                {
                    using (FileStream stream = new FileStream(fileName, FileMode.Create))
                    {
                        stream.Write(result, 0, result.Length);
                        stream.Close();
                    }
                }
            }
            catch
            {
            }
        }

        public void Connect()
        {
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    // Create an instance of the Web service proxy and set the Url property
                    RptServer2005.Credentials = new ReportServerCredentials(ReportSetting);
                    RptServer2005.Url = ReportSetting[ReportConstants.COL_BASEURL] + WSDL[ReportSetting[ReportConstants.COL_SSRSVERSION]];
                    RptServer2005.Timeout = 1200000; // 2 mins..
                    break;
                case &quot;2008&quot;:
                    // Create an instance of the Web service proxy and set the Url property
                    RptServer2008.Credentials = new ReportServerCredentials(ReportSetting);
                    RptServer2008.Url = ReportSetting[ReportConstants.COL_BASEURL] + WSDL[ReportSetting[ReportConstants.COL_SSRSVERSION]];
                    RptServer2008.Timeout = 1200000; // 2 mins..
                    break;
                case &quot;2010&quot;:
                    // Create an instance of the Web service proxy and set the Url property
                    RptServer2010.Credentials = new ReportServerCredentials(ReportSetting);
                    RptServer2010.Url = ReportSetting[ReportConstants.COL_BASEURL] + WSDL[ReportSetting[ReportConstants.COL_SSRSVERSION]];
                    RptServer2010.Timeout = 1200000; // 2 mins..
                    break;
                default:
                    break;
            }

        }

        public void CreateFolder(string Folder, string Parent)
        {
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    RptServer2005.CreateFolder(Folder, Parent, null);
                    break;
                case &quot;2008&quot;:
                    RptServer2008.CreateFolder(Folder, Parent, null);
                    break;
                case &quot;2010&quot;:
                    RptServer2010.CreateFolder(Folder, Parent, null);
                    break;
                default:
                    break;
            }
        }

        public void CreateDataSource(string connString)
        {
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];
            string path = &quot;/&quot;;
            if (ReportSetting.ContainsKey(ReportConstants.COL_FOLDER))
                path += ReportSetting[ReportConstants.COL_FOLDER];
            string dataSource = string.Empty;
            if (ReportSetting.ContainsKey(ReportConstants.COL_DATASOURCE))
                dataSource = ReportSetting[ReportConstants.COL_DATASOURCE];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    CreateDataSourceForRS2005(connString, dataSource, path);
                    break;
                case &quot;2008&quot;:
                    CreateDataSourceForRS2008(connString, dataSource, path);
                    break;
                case &quot;2010&quot;:
                    CreateDataSourceForRS2010(connString, dataSource, path);
                    break;
                default:
                    break;
            }
        }

        public string CopyReports(Dictionary&lt;string, string&gt; sourceRptSetting,
            Dictionary&lt;string, string&gt; targetRptSetting)
        {
            string errors = string.Empty;
            string sourcePath = &quot;/&quot;;
            string rsVersion = targetRptSetting[ReportConstants.COL_SSRSVERSION];

            if (sourceRptSetting.ContainsKey(ReportConstants.COL_FOLDER))
                sourcePath += sourceRptSetting[ReportConstants.COL_FOLDER];

            string targetPath = &quot;/&quot;;
            if (targetRptSetting.ContainsKey(ReportConstants.COL_FOLDER))
                targetPath += targetRptSetting[ReportConstants.COL_FOLDER];

            string dataSource = string.Empty;
            if (targetRptSetting.ContainsKey(ReportConstants.COL_DATASOURCE))
                dataSource = targetRptSetting[ReportConstants.COL_DATASOURCE];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    CopyReportsForRS2005(dataSource, sourcePath, targetPath);
                    break;
                case &quot;2008&quot;:
                    CopyReportsForRS2008(dataSource, sourcePath, targetPath);
                    break;
                case &quot;2010&quot;:
                    CopyReportsForRS2010(dataSource, sourcePath, targetPath);
                    break;
                default:
                    break;
            }

            return errors;
        }

        public string UploadReport(string file, string name, bool isOverwrite = true)
        {
            string errors = string.Empty;
            string path = &quot;/&quot;;
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            if (ReportSetting.ContainsKey(ReportConstants.COL_FOLDER))
                path += ReportSetting[ReportConstants.COL_FOLDER];

            string dataSource = string.Empty;
            if (ReportSetting.ContainsKey(ReportConstants.COL_DATASOURCE))
                dataSource = ReportSetting[ReportConstants.COL_DATASOURCE];

            FileStream stream = File.OpenRead(file);
            var definition = new Byte[stream.Length];
            stream.Read(definition, 0, (int)stream.Length);
            stream.Close();

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    UploadReportsForRS2005(name, isOverwrite, definition, dataSource, path, ref errors);
                    break;
                case &quot;2008&quot;:
                    UploadReportsForRS2008(name, isOverwrite, definition, dataSource, path, ref errors);
                    break;
                case &quot;2010&quot;:
                    UploadReportsForRS2010(name, isOverwrite, definition, dataSource, path, ref errors);
                    break;
                default:
                    break;
            }
            return errors;
        }

        public CatalogItem[] ListChildren(string Item, bool Recursive)
        {
            CatalogItem[] catalogItem = null;
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    ListChildrenForRS2005(Item, Recursive,out catalogItem);
                    break;
                case &quot;2008&quot;:
                    ListChildrenForRS2008(Item, Recursive,out catalogItem);
                    break;
                case &quot;2010&quot;:
                    ListChildrenForRS2010(Item, Recursive,out catalogItem);
                    break;
                default:
                    break;
            }

            return catalogItem;
        }

        public void CheckConnection()
        {
            string path = &quot;/&quot;;
            if (ReportSetting.ContainsKey(ReportConstants.COL_FOLDER))
                path += ReportSetting[ReportConstants.COL_FOLDER];

            if (ReportSetting[ReportConstants.COL_SSRSVERSION] == &quot;2005&quot;)
                RptServer2005.ListChildren(path, false);
            else if (ReportSetting[ReportConstants.COL_SSRSVERSION] == &quot;2008&quot;)
                RptServer2008.ListChildren(path, false);
            else if (ReportSetting[ReportConstants.COL_SSRSVERSION] == &quot;2010&quot;)
                RptServer2010.ListChildren(path, false);
        }

        public string CreateSubscription(string reportPath, DeliveryType type, object settings, string description,
            string eventType, SCHDefination defination, ParameterValue[] ReportParameters)
        {
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];
            int paramLength = ReportParameters.Length;

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    RS05.ParameterValue[] rs2005Parameter = new RS05.ParameterValue[paramLength];
                    ReportParameters.CopyTo(rs2005Parameter, 0);
                    return RptServer2005.CreateSubscription(reportPath, GetExtensionSettingsForRS2005(type, settings), description, eventType, GetMatchData(defination), rs2005Parameter);
                case &quot;2008&quot;:
                    RS08.ParameterValue[] rs2008Parameter = new RS08.ParameterValue[paramLength];
                    ReportParameters.CopyTo(rs2008Parameter, 0);
                    return RptServer2008.CreateSubscription(reportPath, GetExtensionSettingsForRS2008(type, settings), description, eventType, GetMatchData(defination), rs2008Parameter);
                case &quot;2010&quot;:
                    RS10.ParameterValue[] rs2010Parameter = new RS10.ParameterValue[paramLength];
                    ReportParameters.CopyTo(rs2010Parameter, 0);
                    return RptServer2010.CreateSubscription(reportPath, GetExtensionSettingsForRS2010(type, settings), description, eventType, GetMatchData(defination), rs2010Parameter);
                default:
                    return string.Empty;
            }
        }

        internal void DeleteSubscription(string SubscriptionID)
        {
            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    RptServer2005.DeleteSubscription(SubscriptionID);
                    break;
                case &quot;2008&quot;:
                    RptServer2008.DeleteSubscription(SubscriptionID);
                    break;
                case &quot;2010&quot;:
                    RptServer2010.DeleteSubscription(SubscriptionID);
                    break;
                default:
                    break;
            }

        }

        public List&lt;ReportParameterDetails&gt; GetReportParameters(string reportName)
        {
            List&lt;ReportParameterDetails&gt; parameters = new List&lt;ReportParameterDetails&gt;();

            string rsVersion = ReportSetting[ReportConstants.COL_SSRSVERSION];

            switch (rsVersion)
            {
                case &quot;2005&quot;:
                    GetReportParametersForRS2005(reportName, parameters);
                    break;
                case &quot;2008&quot;:
                    GetReportParametersForRS2008(reportName, parameters);
                    break;
                case &quot;2010&quot;:
                    GetReportParametersForRS2010(reportName, parameters);
                    break;
                default:
                    break;
            }

            return parameters;
        }

        #region Private Methods

        private void CreateDataSourceForRS2005(string connString, string dataSource, string path)
        {
            var brixRS2005DataSource = new RS05.DataSourceDefinition();
            brixRS2005DataSource.ConnectString = connString;
            brixRS2005DataSource.Extension = &quot;SQL&quot;;
            brixRS2005DataSource.CredentialRetrieval = RS05.CredentialRetrievalEnum.Store;
            brixRS2005DataSource.WindowsCredentials = true;
            brixRS2005DataSource.ImpersonateUser = false;
            if (ReportSetting.ContainsKey(ReportConstants.COL_USRNAME) &amp;&amp;
                ReportSetting.ContainsKey(ReportConstants.COL_DOMAIN))
                brixRS2005DataSource.UserName = ReportSetting[ReportConstants.COL_DOMAIN] + @&quot;\&quot; + ReportSetting[ReportConstants.COL_USRNAME];
            if (ReportSetting.ContainsKey(ReportConstants.COL_PASSWD))
                brixRS2005DataSource.Password = ReportSetting[ReportConstants.COL_PASSWD];

            try
            {
                RptServer2005.CreateDataSource(dataSource, path, true, brixRS2005DataSource, null);
            }
            catch (Exception ex)
            {
                if (!ex.Message.Contains(&quot;already exists&quot;))
                    throw ex;
            }
            try
            {
                var dsr = new RS05.DataSourceReference();
                dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;
                foreach (RS05.CatalogItem item in RptServer2005.ListChildren(path, false))
                {
                    if (item.Type == RS05.ItemTypeEnum.Report)
                    {
                        RS05.DataSource[] dsa =
                            RptServer2005.GetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name);
                        foreach (RS05.DataSource d in dsa)
                            d.Item = dsr;
                        RptServer2005.SetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
            catch (Exception)
            {
            }
        }

        private void CreateDataSourceForRS2008(string connString, string dataSource, string path)
        {
            var brixRS2008DataSource = new RS08.DataSourceDefinition();
            brixRS2008DataSource.ConnectString = connString;
            brixRS2008DataSource.Extension = &quot;SQL&quot;;
            brixRS2008DataSource.CredentialRetrieval = RS08.CredentialRetrievalEnum.Store;
            brixRS2008DataSource.WindowsCredentials = true;
            brixRS2008DataSource.ImpersonateUser = false;
            if (ReportSetting.ContainsKey(ReportConstants.COL_USRNAME) &amp;&amp;
                ReportSetting.ContainsKey(ReportConstants.COL_DOMAIN))
                brixRS2008DataSource.UserName = ReportSetting[ReportConstants.COL_DOMAIN] + @&quot;\&quot; + ReportSetting[ReportConstants.COL_USRNAME];
            if (ReportSetting.ContainsKey(ReportConstants.COL_PASSWD))
                brixRS2008DataSource.Password = ReportSetting[ReportConstants.COL_PASSWD];

            try
            {
                RptServer2008.CreateDataSource(dataSource, path, true, brixRS2008DataSource, null);
            }
            catch (Exception ex)
            {
                if (!ex.Message.Contains(&quot;already exists&quot;))
                    throw ex;
            }
            try
            {
                var dsr = new RS08.DataSourceReference();
                dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;
                foreach (RS08.CatalogItem item in RptServer2008.ListChildren(path, false))
                {
                    if (item.Type == RS08.ItemTypeEnum.Report)
                    {
                        RS08.DataSource[] dsa = RptServer2008.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name);
                        foreach (RS08.DataSource d in dsa)
                            d.Item = dsr;
                        RptServer2008.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
            catch (Exception)
            {
            }
        }

        private void CreateDataSourceForRS2010(string connString, string dataSource, string path)
        {
            var brixRS2010DataSource = new RS10.DataSourceDefinition();
            brixRS2010DataSource.ConnectString = connString;
            brixRS2010DataSource.Extension = &quot;SQL&quot;;
            brixRS2010DataSource.CredentialRetrieval = RS10.CredentialRetrievalEnum.Store;
            brixRS2010DataSource.WindowsCredentials = true;
            brixRS2010DataSource.ImpersonateUser = false;
            if (ReportSetting.ContainsKey(ReportConstants.COL_USRNAME) &amp;&amp;
                ReportSetting.ContainsKey(ReportConstants.COL_DOMAIN))
                brixRS2010DataSource.UserName = ReportSetting[ReportConstants.COL_DOMAIN] + @&quot;\&quot; + ReportSetting[ReportConstants.COL_USRNAME];
            if (ReportSetting.ContainsKey(ReportConstants.COL_PASSWD))
                brixRS2010DataSource.Password = ReportSetting[ReportConstants.COL_PASSWD];

            try
            {
                RptServer2010.CreateDataSource(dataSource, path, true, brixRS2010DataSource, null);
            }
            catch (Exception ex)
            {
                if (!ex.Message.Contains(&quot;already exists&quot;))
                    throw ex;
            }
            try
            {
                var dsr = new RS10.DataSourceReference();
                dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;
                foreach (RS10.CatalogItem item in RptServer2010.ListChildren(path, false))
                {
                    if (item.TypeName == RS10.TypeNameEnum.Report.ToString())
                    {
                        RS10.DataSource[] dsa =
                            RptServer2010.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name);
                        foreach (RS10.DataSource d in dsa)
                            d.Item = dsr;
                        RptServer2010.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
            catch (Exception)
            {
            }
        }

        private void CopyReportsForRS2005(string dataSource, string sourcePath, string targetPath)
        {
            foreach (RS05.CatalogItem item in RptServer2005.ListChildren(sourcePath, false))
            {
                if (item.Type == RS05.ItemTypeEnum.Report)
                {
                    string rpt = (sourcePath.EndsWith(&quot;/&quot;) ? sourcePath : sourcePath + &quot;/&quot;) + item.Name;
                    byte[] definition = RptServer2005.GetReportDefinition(rpt);

                    RptServer2005.CreateReport(item.Name, targetPath, true, definition, null);
                    if (!string.IsNullOrEmpty(dataSource))
                    {
                        RS05.DataSourceReference dsr = new RS05.DataSourceReference();
                        dsr.Reference = (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + dataSource;
                        RS05.DataSource[] dsa =
                            RptServer2005.GetReportDataSources((targetPath.EndsWith(&quot;/&quot;)
                                ? targetPath
                                : targetPath + &quot;/&quot;) + item.Name);
                        foreach (RS05.DataSource ds in dsa)
                            ds.Item = dsr;
                        RptServer2005.SetReportDataSources(
                            (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
        }

        private void CopyReportsForRS2008(string dataSource, string sourcePath, string targetPath)
        {
            foreach (RS08.CatalogItem item in RptServer2008.ListChildren(sourcePath, false))
            {
                if (item.Type == RS08.ItemTypeEnum.Report)
                {
                    string rpt = (sourcePath.EndsWith(&quot;/&quot;) ? sourcePath : sourcePath + &quot;/&quot;) + item.Name;
                    byte[] definition = RptServer2008.GetReportDefinition(rpt);

                    RptServer2008.CreateReport(item.Name, targetPath, true, definition, null);
                    if (!string.IsNullOrEmpty(dataSource))
                    {
                        RS08.DataSourceReference dsr =
                            new RS08.DataSourceReference();
                        dsr.Reference = (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + dataSource;
                        RS08.DataSource[] dsa =
                            RptServer2008.GetItemDataSources((targetPath.EndsWith(&quot;/&quot;)
                                ? targetPath
                                : targetPath + &quot;/&quot;) + item.Name);
                        foreach (RS08.DataSource ds in dsa)
                            ds.Item = dsr;
                        RptServer2008.SetItemDataSources(
                            (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
        }

        private void CopyReportsForRS2010(string dataSource, string sourcePath, string targetPath)
        {
            foreach (RS10.CatalogItem item in RptServer2010.ListChildren(sourcePath, false))
            {
                if (item.TypeName == RS10.TypeNameEnum.Report.ToString())
                {
                    string rpt = (sourcePath.EndsWith(&quot;/&quot;) ? sourcePath : sourcePath + &quot;/&quot;) + item.Name;
                    byte[] definition = RptServer2008.GetReportDefinition(rpt);

                    RptServer2008.CreateReport(item.Name, targetPath, true, definition, null);
                    if (!string.IsNullOrEmpty(dataSource))
                    {
                        RS08.DataSourceReference dsr =
                            new RS08.DataSourceReference();
                        dsr.Reference = (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + dataSource;
                        RS08.DataSource[] dsa =
                            RptServer2008.GetItemDataSources((targetPath.EndsWith(&quot;/&quot;)
                                ? targetPath
                                : targetPath + &quot;/&quot;) + item.Name);
                        foreach (RS08.DataSource ds in dsa)
                            ds.Item = dsr;
                        RptServer2008.SetItemDataSources(
                            (targetPath.EndsWith(&quot;/&quot;) ? targetPath : targetPath + &quot;/&quot;) + item.Name, dsa);
                    }
                }
            }
        }

        private void UploadReportsForRS2005(string name, bool isOverwrite, byte[] definition, string dataSource, string path, ref string errors)
        {
            RS05.Warning[] warnings = RptServer2005.CreateReport(name, path, isOverwrite, definition, null);

            try
            {
                if (!string.IsNullOrEmpty(dataSource))
                {
                    var dsr = new RS05.DataSourceReference();
                    dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                    RS05.DataSource[] dsa =
                        RptServer2005.GetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                    foreach (RS05.DataSource d in dsa)
                        d.Item = dsr;
                    RptServer2005.SetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                }
            }
            catch (Exception ex)
            {
                errors += ex.Message + &quot;\r\n&quot;;
            }


            if (warnings != null)
            {
                foreach (RS05.Warning warning in warnings)
                {
                    if (warning.Severity == &quot;Warning&quot; &amp;&amp; warning.Code == &quot;rsDataSourceReferenceNotPublished&quot;)
                    {
                        if (!string.IsNullOrEmpty(dataSource))
                        {
                            var dsr = new RS05.DataSourceReference();
                            dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                            RS05.DataSource[] dsa =
                                RptServer2005.GetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                            foreach (RS05.DataSource d in dsa)
                                d.Item = dsr;
                            RptServer2005.SetReportDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                            break;
                        }
                        else
                        {
                            errors = warning.Message + &quot;\r\n&quot;;
                        }
                    }
                    else
                    {
                        if (warning.Severity != &quot;Warning&quot;)
                            errors += warning.Message + &quot;\r\n&quot;;
                    }
                }
            }
        }

        private void UploadReportsForRS2008(string name, bool isOverwrite, byte[] definition, string dataSource, string path, ref string errors)
        {
            RS08.Warning[] warnings = RptServer2008.CreateReport(name, path, isOverwrite, definition, null);
            try
            {
                if (!string.IsNullOrEmpty(dataSource))
                {
                    var dsr = new RS08.DataSourceReference();
                    dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                    RS08.DataSource[] dsa =
                        RptServer2008.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                    foreach (RS08.DataSource d in dsa)
                        d.Item = dsr;
                    RptServer2008.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                }
            }
            catch (Exception ex)
            {
                errors += ex.Message + &quot;\r\n&quot;;
            }

            if (warnings != null)
            {
                foreach (RS08.Warning warning in warnings)
                {
                    if (warning.Severity == &quot;Warning&quot; &amp;&amp; warning.Code == &quot;rsDataSourceReferenceNotPublished&quot;)
                    {
                        if (!string.IsNullOrEmpty(dataSource))
                        {
                            var dsr = new RS08.DataSourceReference();
                            dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                            RS08.DataSource[] dsa =
                                RptServer2008.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                            foreach (RS08.DataSource d in dsa)
                                d.Item = dsr;
                            RptServer2008.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                            break;
                        }
                        else
                        {
                            errors += warning.Message + &quot;\r\n&quot;;
                        }
                    }
                    else
                    {
                        if (warning.Severity != &quot;Warning&quot;)
                            errors += warning.Message + &quot;\r\n&quot;;
                    }
                }
            }
        }

        private void UploadReportsForRS2010(string name, bool isOverwrite, byte[] definition, string dataSource, string path, ref string errors)
        {
            RS10.Warning[] warnings = null;
            RptServer2010.CreateCatalogItem(RS10.TypeNameEnum.Report.ToString(), name, path, isOverwrite, definition, null, out warnings);

            try
            {
                if (!string.IsNullOrEmpty(dataSource))
                {
                    var dsr = new RS10.DataSourceReference();
                    dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                    RS10.DataSource[] dsa =
                        RptServer2010.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                    foreach (RS10.DataSource d in dsa)
                        d.Item = dsr;
                    RptServer2010.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                }
            }
            catch (Exception ex)
            {
                errors += ex.Message + &quot;\r\n&quot;;
            }

            if (warnings != null)
            {
                foreach (RS10.Warning warning in warnings)
                {
                    if (warning.Severity == &quot;Warning&quot; &amp;&amp; warning.Code == &quot;rsDataSourceReferenceNotPublished&quot;)
                    {
                        if (!string.IsNullOrEmpty(dataSource))
                        {
                            var dsr = new RS10.DataSourceReference();
                            dsr.Reference = (path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + dataSource;

                            RS10.DataSource[] dsa =
                                RptServer2010.GetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name);
                            foreach (RS10.DataSource d in dsa)
                                d.Item = dsr;
                            RptServer2010.SetItemDataSources((path.EndsWith(&quot;/&quot;) ? path : path + &quot;/&quot;) + name, dsa);
                            break;
                        }
                        else
                        {
                            errors += warning.Message + &quot;\r\n&quot;;
                        }
                    }
                    else
                    {
                        if (warning.Severity != &quot;Warning&quot;)
                            errors += warning.Message + &quot;\r\n&quot;;
                    }
                }
            }
        }

        private void ListChildrenForRS2005(string Item, bool Recursive,out CatalogItem[] catalogItem)
        {
            RS05.CatalogItem[] items = RptServer2005.ListChildren(Item, Recursive);
            catalogItem = new CatalogItem[items.Length];
            for (int Idx = 0; Idx &lt; items.Length; Idx++)
                catalogItem[Idx] = new CatalogItem
                {
                    Name = items[Idx].Name,
                    Path = items[Idx].Path,
                    Type = items[Idx].Type.ToString()
                };
        }

        private void ListChildrenForRS2008(string Item, bool Recursive,out CatalogItem[] catalogItem)
        {
            RS08.CatalogItem[] items = RptServer2008.ListChildren(Item, Recursive);
            catalogItem = new CatalogItem[items.Length];
            for (int Idx = 0; Idx &lt; items.Length; Idx++)
                catalogItem[Idx] = new CatalogItem
                {
                    Name = items[Idx].Name,
                    Path = items[Idx].Path,
                    Type = items[Idx].Type.ToString()
                };
        }

        private void ListChildrenForRS2010(string Item, bool Recursive,out CatalogItem[] catalogItem)
        {
            RS10.CatalogItem[] items = RptServer2010.ListChildren(Item, Recursive);
            catalogItem = new CatalogItem[items.Length];
            for (int Idx = 0; Idx &lt; items.Length; Idx++)
                catalogItem[Idx] = new CatalogItem
                {
                    Name = items[Idx].Name,
                    Path = items[Idx].Path,
                    Type = items[Idx].TypeName
                };
        }

        private void GetReportParametersForRS2005(string reportName, List&lt;ReportParameterDetails&gt; parameters)
        {
            string historyId = null;
            RS05.ParameterValue[] values = null;
            RS05.DataSourceCredentials[] credentials = null;
            RS05.ReportParameter[] actualParameters = RptServer2005.GetReportParameters(reportName, historyId, false,
                values, credentials);
            for (int i = 0; i &lt; actualParameters.Length; i++)
            {
                ReportParameterDetails param = new ReportParameterDetails();
                param.Name = actualParameters[i].Name;
                param.Prompt = actualParameters[i].Prompt;
                param.Hidden = actualParameters[i].PromptUser;
                param.DefaultValues = actualParameters[i].DefaultValues;
                parameters.Add(param);
            }
        }

        private void GetReportParametersForRS2008(string reportName, List&lt;ReportParameterDetails&gt; parameters)
        {
            string historyId = null;
            RS08.ParameterValue[] values = null;
            RS08.DataSourceCredentials[] credentials = null;
            RS08.ReportParameter[] actualParameters = RptServer2008.GetReportParameters(reportName, historyId, false,
                values, credentials);
            for (int i = 0; i &lt; actualParameters.Length; i++)
            {
                ReportParameterDetails param = new ReportParameterDetails();
                param.Name = actualParameters[i].Name;
                param.Prompt = actualParameters[i].Prompt;
                param.Hidden = actualParameters[i].PromptUser;
                param.DefaultValues = actualParameters[i].DefaultValues;
                parameters.Add(param);
            }
        }

        private void GetReportParametersForRS2010(string reportName, List&lt;ReportParameterDetails&gt; parameters)
        {
            string historyId = null;
            RS10.ParameterValue[] values = null;
            RS10.DataSourceCredentials[] credentials = null;
            RS10.ItemParameter[] actualParameters = RptServer2010.GetItemParameters(reportName, historyId, false,
                values, credentials);
            for (int i = 0; i &lt; actualParameters.Length; i++)
            {
                ReportParameterDetails param = new ReportParameterDetails();
                param.Name = actualParameters[i].Name;
                param.Prompt = actualParameters[i].Prompt;
                param.Hidden = actualParameters[i].PromptUser;
                param.DefaultValues = actualParameters[i].DefaultValues;
                parameters.Add(param);
            }
        }

        private RS05.ExtensionSettings GetExtensionSettingsForRS2005(DeliveryType type, object settings)
        {
            RS05.ExtensionSettings extSettings = new RS05.ExtensionSettings();
            extSettings.Extension = type == DeliveryType.ReportServerEmail
                ? &quot;Report Server Email&quot;
                : &quot;Report Server FileShare&quot;;

            PropertyInfo[] pInfoSet = settings.GetType().GetProperties();
            extSettings.ParameterValues = new RS05.ParameterValueOrFieldReference[pInfoSet.Length];
            int i = 0;
            foreach (PropertyInfo pInfo in pInfoSet)
            {
                object val = pInfo.GetValue(settings, null);
                if (val != null &amp;&amp; !string.IsNullOrEmpty(val.ToString()))
                    extSettings.ParameterValues[i++] = new RS05.ParameterValue
                    {
                        Name = pInfo.Name,
                        Value = val.ToString()
                    };
            }
            return extSettings;
        }

        private RS08.ExtensionSettings GetExtensionSettingsForRS2008(DeliveryType type, object settings)
        {
            RS08.ExtensionSettings extSettings = new RS08.ExtensionSettings();
            extSettings.Extension = type == DeliveryType.ReportServerEmail
                ? &quot;Report Server Email&quot;
                : &quot;Report Server FileShare&quot;;

            PropertyInfo[] pInfoSet = settings.GetType().GetProperties();
            extSettings.ParameterValues = new RS08.ParameterValueOrFieldReference[pInfoSet.Length];
            int i = 0;
            foreach (PropertyInfo pInfo in pInfoSet)
            {
                object val = pInfo.GetValue(settings, null);
                if (val != null &amp;&amp; !string.IsNullOrEmpty(val.ToString()))
                    extSettings.ParameterValues[i++] = new RS08.ParameterValue
                    {
                        Name = pInfo.Name,
                        Value = val.ToString()
                    };
            }
            return extSettings;
        }

        private RS10.ExtensionSettings GetExtensionSettingsForRS2010(DeliveryType type, object settings)
        {
            RS10.ExtensionSettings extSettings = new RS10.ExtensionSettings();
            extSettings.Extension = type == DeliveryType.ReportServerEmail
                ? &quot;Report Server Email&quot;
                : &quot;Report Server FileShare&quot;;

            PropertyInfo[] pInfoSet = settings.GetType().GetProperties();
            extSettings.ParameterValues = new RS10.ParameterValueOrFieldReference[pInfoSet.Length];
            int i = 0;
            foreach (PropertyInfo pInfo in pInfoSet)
            {
                object val = pInfo.GetValue(settings, null);
                if (val != null &amp;&amp; !string.IsNullOrEmpty(val.ToString()))
                    extSettings.ParameterValues[i++] = new RS10.ParameterValue
                    {
                        Name = pInfo.Name,
                        Value = val.ToString()
                    };
            }
            return extSettings;
        }

        private string GetMatchData(SCHDefination defination)
        {
            RS08.ScheduleDefinition schedule = new RS08.ScheduleDefinition();
            schedule.StartDateTime = defination.StartDateTime();
            if (defination.EndDate == null || defination.EndDate == DateTime.MinValue)
                schedule.EndDateSpecified = false;
            else
            {
                schedule.EndDateSpecified = true;
                schedule.EndDate = defination.EndDate;
            }
            schedule.Item = GetPattern(defination); // based on radio button selectioinyou pass the value
            return GetmatchDataAsXml(schedule);
        }

        private RS08.RecurrencePattern GetPattern(SCHDefination defination)
        {
            RS08.RecurrencePattern item = null;
            switch (defination.scheduleType)
            {
                case ScheduleType.Hourly:
                    RS08.MinuteRecurrence mr = new RS08.MinuteRecurrence();
                    mr.MinutesInterval = defination.MinuteInterval();
                    // calculate form hour and minute input (HR*60 + MIN)
                    item = mr;
                    break;
                case ScheduleType.Daily:
                    RS08.DailyRecurrence dr = new RS08.DailyRecurrence();
                    dr.DaysInterval = defination.DaysInterval; // input from reccurence after days
                    item = dr;
                    break;
                case ScheduleType.DailyDOW:
                case ScheduleType.DailyWeekDays:
                case ScheduleType.WeeklyDOW:
                    RS08.WeeklyRecurrence wr = new RS08.WeeklyRecurrence();

                    if (defination.scheduleType == ScheduleType.WeeklyDOW)
                        wr.WeeksInterval = defination.WeekInterval; // get this from the user input 
                    else
                        wr.WeeksInterval = 1; // hardcode it to 1 to support daily option

                    wr.WeeksIntervalSpecified = true;

                    RS08.DaysOfWeekSelector daySelector = new RS08.DaysOfWeekSelector();
                    if (defination.scheduleType == ScheduleType.DailyWeekDays)
                    {
                        daySelector.Monday =
                            daySelector.Tuesday =
                                daySelector.Wednesday = daySelector.Thursday = daySelector.Friday = true;
                    }
                    else
                    {
                        daySelector.Monday = defination.DayOfWeeksSelector[WeekDays.Monday];
                        daySelector.Tuesday = defination.DayOfWeeksSelector[WeekDays.Tuesday];
                        daySelector.Wednesday = defination.DayOfWeeksSelector[WeekDays.Wednesday];
                        daySelector.Thursday = defination.DayOfWeeksSelector[WeekDays.Thursday];
                        daySelector.Friday = defination.DayOfWeeksSelector[WeekDays.Friday];
                        daySelector.Saturday = defination.DayOfWeeksSelector[WeekDays.Saturday];
                        daySelector.Sunday = defination.DayOfWeeksSelector[WeekDays.Sunday];
                    }
                    wr.DaysOfWeek = daySelector;
                    item = wr;
                    break;
                case ScheduleType.MonthlyDays:
                    RS08.MonthlyRecurrence monthPattern = new RS08.MonthlyRecurrence();
                    RS08.MonthsOfYearSelector monthsSelected = new RS08.MonthsOfYearSelector();
                    monthsSelected.January = defination.MonthSelector[Months.January];
                    monthsSelected.February = defination.MonthSelector[Months.February];
                    monthsSelected.March = defination.MonthSelector[Months.March];
                    monthsSelected.April = defination.MonthSelector[Months.April];
                    monthsSelected.May = defination.MonthSelector[Months.May];
                    monthsSelected.June = defination.MonthSelector[Months.June];
                    monthsSelected.July = defination.MonthSelector[Months.July];
                    monthsSelected.August = defination.MonthSelector[Months.August];
                    monthsSelected.September = defination.MonthSelector[Months.September];
                    monthsSelected.October = defination.MonthSelector[Months.October];
                    monthsSelected.November = defination.MonthSelector[Months.November];
                    monthsSelected.December = defination.MonthSelector[Months.December];
                    monthPattern.MonthsOfYear = monthsSelected;

                    monthPattern.Days = defination.MonthCalendarDays; // get from UI
                    item = monthPattern;
                    break;

                case ScheduleType.MonthlyDOW:
                    RS08.MonthlyDOWRecurrence pattern = new RS08.MonthlyDOWRecurrence();

                    RS08.MonthsOfYearSelector months = new RS08.MonthsOfYearSelector();
                    months.January = defination.MonthSelector[Months.January];
                    months.February = defination.MonthSelector[Months.February];
                    months.March = defination.MonthSelector[Months.March];
                    months.April = defination.MonthSelector[Months.April];
                    months.May = defination.MonthSelector[Months.May];
                    months.June = defination.MonthSelector[Months.June];
                    months.July = defination.MonthSelector[Months.July];
                    months.August = defination.MonthSelector[Months.August];
                    months.September = defination.MonthSelector[Months.September];
                    months.October = defination.MonthSelector[Months.October];
                    months.November = defination.MonthSelector[Months.November];
                    months.December = defination.MonthSelector[Months.December];
                    pattern.MonthsOfYear = months;


                    pattern.WhichWeekSpecified = true;
                    pattern.WhichWeek =
                        (RS08.WeekNumberEnum)Enum.Parse(typeof(RS08.WeekNumberEnum), defination.WeekOfMonth);

                    RS08.DaysOfWeekSelector days = new RS08.DaysOfWeekSelector();
                    days.Monday = defination.DayOfWeeksSelector[WeekDays.Monday];
                    days.Tuesday = defination.DayOfWeeksSelector[WeekDays.Tuesday];
                    days.Wednesday = defination.DayOfWeeksSelector[WeekDays.Wednesday];
                    days.Thursday = defination.DayOfWeeksSelector[WeekDays.Thursday];
                    days.Friday = defination.DayOfWeeksSelector[WeekDays.Friday];
                    days.Saturday = defination.DayOfWeeksSelector[WeekDays.Saturday];
                    days.Sunday = defination.DayOfWeeksSelector[WeekDays.Sunday];
                    pattern.DaysOfWeek = days;

                    item = pattern;
                    break;
                default: // this is one time schedule
                    break;
            }

            return item;
        }

        private string GetmatchDataAsXml(RS08.ScheduleDefinition schedule)
        {
            MemoryStream buffer = new MemoryStream();
            XmlSerializer xmlSerializer = new XmlSerializer(typeof(RS08.ScheduleDefinition));
            xmlSerializer.Serialize(buffer, schedule);
            buffer.Seek(0, SeekOrigin.Begin);

            XmlDocument doc = new XmlDocument();
            doc.Load(buffer);
            // patch up WhichWeek
            XmlNamespaceManager ns = new XmlNamespaceManager(doc.NameTable);
            ns.AddNamespace(&quot;rs&quot;,
                &quot;http://schemas.microsoft.com/sqlserver/2003/12/reporting/reportingservices&quot;);

            //XmlNode node =
            //    doc.SelectSingleNode(
            //         &quot;/ScheduleDefinition/rs:MonthlyDOWRecurrence/rs:WhichWeek&quot;, ns
            //    );
            //if (node != null)
            //{
            //    switch (node.InnerXml)
            //    {
            //        case &quot;FirstWeek&quot;:
            //            node.InnerXml = &quot;FIRST_WEEK&quot;; break;
            //        case &quot;SecondWeek&quot;:
            //            node.InnerXml = &quot;SECOND_WEEK&quot;; break;
            //        case &quot;ThirdWeek&quot;:
            //            node.InnerXml = &quot;THIRD_WEEK&quot;; break;
            //        case &quot;FourthWeek&quot;:
            //            node.InnerXml = &quot;FOURTH_WEEK&quot;; break;
            //        case &quot;LastWeek&quot;:
            //            node.InnerXml = &quot;LAST_WEEK&quot;; break;
            //    }
            //}

            return doc.OuterXml;
        }

        #endregion
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[18,9,18,100,1],[19,9,19,100,1],[20,9,20,100,1],[21,9,21,93,1],[25,9,25,34,1],[26,9,26,10,1],[27,13,27,53,1],[28,13,28,57,1],[29,13,29,57,1],[30,9,30,10,1],[33,9,33,10,0],[34,13,34,78,0],[35,13,35,73,0],[36,13,36,95,0],[39,13,39,34,0],[40,13,40,98,0],[42,13,42,37,0],[48,13,48,43,0],[49,13,49,39,0],[51,13,51,66,0],[52,13,52,72,0],[54,13,54,50,0],[56,13,56,61,0],[58,13,58,98,0],[59,13,59,28,0],[60,13,60,20,0],[60,22,60,28,0],[60,29,60,31,0],[60,32,60,51,0],[61,13,61,14,0],[62,17,62,63,0],[63,17,63,51,0],[64,17,64,56,0],[65,21,65,71,0],[66,22,66,38,0],[67,21,67,53,0],[69,21,69,64,0],[71,17,71,26,0],[72,13,72,14,0],[74,13,74,60,0],[77,13,77,14,0],[78,17,79,36,0],[81,17,81,50,0],[82,13,82,14,0],[83,13,83,18,0],[84,13,84,14,0],[85,13,85,14,0],[89,13,89,14,0],[90,17,90,36,0],[91,17,91,18,0],[92,28,92,89,0],[93,21,93,22,0],[94,25,94,64,0],[95,25,95,40,0],[96,21,96,22,0],[97,17,97,18,0],[98,13,98,14,0],[99,13,99,18,0],[100,13,100,14,0],[101,13,101,14,0],[102,9,102,10,0],[107,9,107,10,0],[108,13,108,78,0],[109,13,109,73,0],[110,13,110,95,0],[113,13,113,34,0],[114,13,114,110,0],[115,13,115,37,0],[121,13,121,43,0],[122,13,122,39,0],[124,13,124,66,0],[125,13,125,72,0],[127,13,127,50,0],[129,13,129,61,0],[131,13,131,98,0],[132,13,132,28,0],[133,13,133,20,0],[133,22,133,28,0],[133,29,133,31,0],[133,32,133,51,0],[134,13,134,14,0],[135,17,135,56,0],[136,17,136,18,0],[137,21,137,67,0],[138,21,138,55,0],[139,21,139,71,0],[140,21,140,30,0],[141,17,141,18,0],[146,13,146,14,0],[148,13,148,60,0],[151,13,151,14,0],[152,17,153,36,0],[155,17,155,50,0],[156,13,156,14,0],[157,13,157,18,0],[158,13,158,14,0],[159,13,159,14,0],[163,13,163,14,0],[164,17,164,36,0],[165,17,165,18,0],[166,28,166,89,0],[167,21,167,22,0],[168,25,168,64,0],[169,25,169,40,0],[170,21,170,22,0],[171,17,171,18,0],[172,13,172,14,0],[173,13,173,18,0],[174,13,174,14,0],[175,13,175,14,0],[176,9,176,10,0],[179,9,179,10,1],[180,13,180,79,1],[182,13,182,31,1],[186,21,186,92,0],[187,21,187,139,0],[188,21,188,53,0],[189,21,189,27,0],[192,21,192,92,1],[193,21,193,139,1],[194,21,194,53,1],[195,21,195,27,1],[198,21,198,92,0],[199,21,199,139,0],[200,21,200,53,0],[201,21,201,27,0],[203,21,203,27,0],[206,9,206,10,1],[209,9,209,10,0],[210,13,210,79,0],[212,13,212,31,0],[215,21,215,70,0],[216,21,216,27,0],[218,21,218,70,0],[219,21,219,27,0],[221,21,221,70,0],[222,21,222,27,0],[224,21,224,27,0],[226,9,226,10,0],[229,9,229,10,0],[230,13,230,79,0],[231,13,231,31,0],[232,13,232,71,0],[233,17,233,67,0],[234,13,234,46,0],[235,13,235,75,0],[236,17,236,76,0],[238,13,238,31,0],[241,21,241,77,0],[242,21,242,27,0],[244,21,244,77,0],[245,21,245,27,0],[247,21,247,77,0],[248,21,248,27,0],[250,21,250,27,0],[252,9,252,10,0],[256,9,256,10,0],[257,13,257,42,0],[258,13,258,37,0],[259,13,259,82,0],[261,13,261,74,0],[262,17,262,76,0],[264,13,264,37,0],[265,13,265,74,0],[266,17,266,76,0],[268,13,268,46,0],[269,13,269,78,0],[270,17,270,79,0],[272,13,272,31,0],[275,21,275,78,0],[276,21,276,27,0],[278,21,278,78,0],[279,21,279,27,0],[281,21,281,78,0],[282,21,282,27,0],[284,21,284,27,0],[287,13,287,27,0],[288,9,288,10,0],[291,9,291,10,1],[292,13,292,42,1],[293,13,293,31,1],[294,13,294,79,1],[296,13,296,71,1],[297,17,297,67,1],[299,13,299,46,1],[300,13,300,75,1],[301,17,301,76,1],[303,13,303,53,1],[304,13,304,54,1],[305,13,305,60,1],[306,13,306,28,1],[308,13,308,31,1],[311,21,311,105,0],[312,21,312,27,0],[314,21,314,105,1],[315,21,315,27,1],[317,21,317,105,0],[318,21,318,27,0],[320,21,320,27,0],[322,13,322,27,1],[323,9,323,10,1],[326,9,326,10,0],[327,13,327,46,0],[328,13,328,79,0],[330,13,330,31,0],[333,21,333,76,0],[334,21,334,27,0],[336,21,336,76,0],[337,21,337,27,0],[339,21,339,76,0],[340,21,340,27,0],[342,21,342,27,0],[345,13,345,32,0],[346,9,346,10,0],[349,9,349,10,1],[350,13,350,31,1],[351,13,351,71,1],[352,17,352,67,1],[354,13,354,74,1],[355,17,355,57,0],[356,18,356,79,1],[357,17,357,57,1],[358,18,358,79,0],[359,17,359,57,0],[360,9,360,10,1],[364,9,364,10,0],[365,13,365,79,0],[366,13,366,55,0],[368,13,368,31,0],[371,21,371,98,0],[372,21,372,65,0],[373,21,373,187,0],[375,21,375,98,0],[376,21,376,65,0],[377,21,377,187,0],[379,21,379,98,0],[380,21,380,65,0],[381,21,381,187,0],[383,21,383,41,0],[385,9,385,10,0],[388,9,388,10,0],[389,13,389,79,0],[391,13,391,31,0],[394,21,394,70,0],[395,21,395,27,0],[397,21,397,70,0],[398,21,398,27,0],[400,21,400,70,0],[401,21,401,27,0],[403,21,403,27,0],[406,9,406,10,0],[409,9,409,10,0],[410,13,410,90,0],[412,13,412,79,0],[414,13,414,31,0],[417,21,417,74,0],[418,21,418,27,0],[420,21,420,74,0],[421,21,421,27,0],[423,21,423,74,0],[424,21,424,27,0],[426,21,426,27,0],[429,13,429,31,0],[430,9,430,10,0],[435,9,435,10,0],[436,13,436,72,0],[437,13,437,61,0],[438,13,438,52,0],[439,13,439,91,0],[440,13,440,60,0],[441,13,441,58,0],[442,13,443,71,0],[444,17,444,143,0],[445,13,445,71,0],[446,17,446,91,0],[449,13,449,14,0],[450,17,450,100,0],[451,13,451,14,0],[452,13,452,33,0],[453,13,453,14,0],[454,17,454,60,0],[455,21,455,30,0],[456,13,456,14,0],[458,13,458,14,0],[459,17,459,58,0],[460,17,460,87,0],[461,17,461,24,0],[461,26,461,47,0],[461,48,461,50,0],[461,51,461,90,0],[462,17,462,18,0],[463,21,463,63,0],[464,21,464,22,0],[465,25,466,118,0],[467,25,467,32,0],[467,34,467,51,0],[467,52,467,54,0],[467,55,467,58,0],[468,29,468,42,0],[469,25,469,119,0],[470,21,470,22,0],[471,17,471,18,0],[472,13,472,14,0],[473,13,473,30,0],[474,13,474,14,0],[475,13,475,14,0],[476,9,476,10,0],[479,9,479,10,0],[480,13,480,72,0],[481,13,481,61,0],[482,13,482,52,0],[483,13,483,91,0],[484,13,484,60,0],[485,13,485,58,0],[486,13,487,71,0],[488,17,488,143,0],[489,13,489,71,0],[490,17,490,91,0],[493,13,493,14,0],[494,17,494,100,0],[495,13,495,14,0],[496,13,496,33,0],[497,13,497,14,0],[498,17,498,60,0],[499,21,499,30,0],[500,13,500,14,0],[502,13,502,14,0],[503,17,503,58,0],[504,17,504,87,0],[505,17,505,24,0],[505,26,505,47,0],[505,48,505,50,0],[505,51,505,90,0],[506,17,506,18,0],[507,21,507,63,0],[508,21,508,22,0],[509,25,509,136,0],[510,25,510,32,0],[510,34,510,51,0],[510,52,510,54,0],[510,55,510,58,0],[511,29,511,42,0],[512,25,512,117,0],[513,21,513,22,0],[514,17,514,18,0],[515,13,515,14,0],[516,13,516,30,0],[517,13,517,14,0],[518,13,518,14,0],[519,9,519,10,0],[522,9,522,10,0],[523,13,523,72,0],[524,13,524,61,0],[525,13,525,52,0],[526,13,526,91,0],[527,13,527,60,0],[528,13,528,58,0],[529,13,530,71,0],[531,17,531,143,0],[532,13,532,71,0],[533,17,533,91,0],[536,13,536,14,0],[537,17,537,100,0],[538,13,538,14,0],[539,13,539,33,0],[540,13,540,14,0],[541,17,541,60,0],[542,21,542,30,0],[543,13,543,14,0],[545,13,545,14,0],[546,17,546,58,0],[547,17,547,87,0],[548,17,548,24,0],[548,26,548,47,0],[548,48,548,50,0],[548,51,548,90,0],[549,17,549,18,0],[550,21,550,78,0],[551,21,551,22,0],[552,25,553,116,0],[554,25,554,32,0],[554,34,554,51,0],[554,52,554,54,0],[554,55,554,58,0],[555,29,555,42,0],[556,25,556,117,0],[557,21,557,22,0],[558,17,558,18,0],[559,13,559,14,0],[560,13,560,30,0],[561,13,561,14,0],[562,13,562,14,0],[563,9,563,10,0],[566,9,566,10,0],[567,13,567,20,0],[567,22,567,43,0],[567,44,567,46,0],[567,47,567,92,0],[568,13,568,14,0],[569,17,569,59,0],[570,17,570,18,0],[571,21,571,105,0],[572,21,572,80,0],[574,21,574,95,0],[575,21,575,59,0],[576,21,576,22,0],[577,25,577,87,0],[578,25,578,113,0],[579,25,582,66,0],[583,25,583,32,0],[583,34,583,52,0],[583,53,583,55,0],[583,56,583,59,0],[584,29,584,43,0],[585,25,586,106,0],[587,21,587,22,0],[588,17,588,18,0],[589,13,589,14,0],[590,9,590,10,0],[593,9,593,10,0],[594,13,594,20,0],[594,22,594,43,0],[594,44,594,46,0],[594,47,594,92,0],[595,13,595,14,0],[596,17,596,59,0],[597,17,597,18,0],[598,21,598,105,0],[599,21,599,80,0],[601,21,601,95,0],[602,21,602,59,0],[603,21,603,22,0],[604,25,605,60,0],[606,25,606,113,0],[607,25,610,66,0],[611,25,611,32,0],[611,34,611,52,0],[611,53,611,55,0],[611,56,611,59,0],[612,29,612,43,0],[613,25,614,106,0],[615,21,615,22,0],[616,17,616,18,0],[617,13,617,14,0],[618,9,618,10,0],[621,9,621,10,0],[622,13,622,20,0],[622,22,622,43,0],[622,44,622,46,0],[622,47,622,92,0],[623,13,623,14,0],[624,17,624,74,0],[625,17,625,18,0],[626,21,626,105,0],[627,21,627,80,0],[629,21,629,95,0],[630,21,630,59,0],[631,21,631,22,0],[632,25,633,60,0],[634,25,634,113,0],[635,25,638,66,0],[639,25,639,32,0],[639,34,639,52,0],[639,53,639,55,0],[639,56,639,59,0],[640,29,640,43,0],[641,25,642,106,0],[643,21,643,22,0],[644,17,644,18,0],[645,13,645,14,0],[646,9,646,10,0],[649,9,649,10,0],[650,13,650,109,0],[653,13,653,14,0],[654,17,654,55,0],[655,17,655,18,0],[656,21,656,62,0],[657,21,657,91,0],[659,21,660,109,0],[661,21,661,28,0],[661,30,661,47,0],[661,48,661,50,0],[661,51,661,54,0],[662,25,662,38,0],[663,21,663,110,0],[664,17,664,18,0],[665,13,665,14,0],[666,13,666,33,0],[667,13,667,14,0],[668,17,668,47,0],[669,13,669,14,0],[672,13,672,34,0],[673,13,673,14,0],[674,17,674,24,0],[674,26,674,46,0],[674,47,674,49,0],[674,50,674,58,0],[675,17,675,18,0],[676,21,676,110,0],[677,21,677,22,0],[678,25,678,63,0],[679,25,679,26,0],[680,29,680,70,0],[681,29,681,99,0],[683,29,684,117,0],[685,29,685,36,0],[685,38,685,55,0],[685,56,685,58,0],[685,59,685,62,0],[686,33,686,46,0],[687,29,687,118,0],[688,29,688,35,0],[691,25,691,26,0],[692,29,692,63,0],[693,25,693,26,0],[694,21,694,22,0],[696,21,696,22,0],[697,25,697,59,0],[698,29,698,64,0],[699,21,699,22,0],[700,17,700,18,0],[701,13,701,14,0],[702,9,702,10,0],[705,9,705,10,1],[706,13,706,109,1],[708,13,708,14,1],[709,17,709,55,1],[710,17,710,18,1],[711,21,711,62,1],[712,21,712,91,1],[714,21,715,107,1],[716,21,716,28,1],[716,30,716,47,1],[716,48,716,50,1],[716,51,716,54,1],[717,25,717,38,1],[718,21,718,108,1],[719,17,719,18,1],[720,13,720,14,1],[721,13,721,33,0],[722,13,722,14,0],[723,17,723,47,0],[724,13,724,14,0],[726,13,726,34,1],[727,13,727,14,1],[728,17,728,24,1],[728,26,728,46,1],[728,47,728,49,1],[728,50,728,58,1],[729,17,729,18,1],[730,21,730,110,1],[731,21,731,22,1],[732,25,732,63,1],[733,25,733,26,1],[734,29,734,70,1],[735,29,735,99,1],[737,29,738,115,1],[739,29,739,36,1],[739,38,739,55,1],[739,56,739,58,1],[739,59,739,62,1],[740,33,740,46,1],[741,29,741,116,1],[742,29,742,35,1],[745,25,745,26,0],[746,29,746,64,0],[747,25,747,26,0],[748,21,748,22,0],[750,21,750,22,0],[751,25,751,59,0],[752,29,752,64,0],[753,21,753,22,0],[754,17,754,18,0],[755,13,755,14,1],[756,9,756,10,1],[759,9,759,10,0],[760,13,760,44,0],[761,13,761,139,0],[764,13,764,14,0],[765,17,765,55,0],[766,17,766,18,0],[767,21,767,62,0],[768,21,768,91,0],[770,21,771,107,0],[772,21,772,28,0],[772,30,772,47,0],[772,48,772,50,0],[772,51,772,54,0],[773,25,773,38,0],[774,21,774,108,0],[775,17,775,18,0],[776,13,776,14,0],[777,13,777,33,0],[778,13,778,14,0],[779,17,779,47,0],[780,13,780,14,0],[782,13,782,34,0],[783,13,783,14,0],[784,17,784,24,0],[784,26,784,46,0],[784,47,784,49,0],[784,50,784,58,0],[785,17,785,18,0],[786,21,786,110,0],[787,21,787,22,0],[788,25,788,63,0],[789,25,789,26,0],[790,29,790,70,0],[791,29,791,99,0],[793,29,794,115,0],[795,29,795,36,0],[795,38,795,55,0],[795,56,795,58,0],[795,59,795,62,0],[796,33,796,46,0],[797,29,797,116,0],[798,29,798,35,0],[801,25,801,26,0],[802,29,802,64,0],[803,25,803,26,0],[804,21,804,22,0],[806,21,806,22,0],[807,25,807,59,0],[808,29,808,64,0],[809,21,809,22,0],[810,17,810,18,0],[811,13,811,14,0],[812,9,812,10,0],[815,9,815,10,0],[816,13,816,84,0],[817,13,817,57,0],[818,18,818,29,0],[818,31,818,49,0],[818,51,818,56,0],[819,17,824,19,0],[825,9,825,10,0],[828,9,828,10,0],[829,13,829,84,0],[830,13,830,57,0],[831,18,831,29,0],[831,31,831,49,0],[831,51,831,56,0],[832,17,837,19,0],[838,9,838,10,0],[841,9,841,10,0],[842,13,842,84,0],[843,13,843,57,0],[844,18,844,29,0],[844,31,844,49,0],[844,51,844,56,0],[845,17,850,19,0],[851,9,851,10,0],[854,9,854,10,0],[855,13,855,37,0],[856,13,856,49,0],[857,13,857,61,0],[858,13,859,38,0],[860,18,860,27,0],[860,29,860,56,0],[860,58,860,61,0],[861,13,861,14,0],[862,17,862,77,0],[863,17,863,55,0],[864,17,864,59,0],[865,17,865,63,0],[866,17,866,73,0],[867,17,867,39,0],[868,13,868,14,0],[869,9,869,10,0],[872,9,872,10,0],[873,13,873,37,0],[874,13,874,49,0],[875,13,875,61,0],[876,13,877,38,0],[878,18,878,27,0],[878,29,878,56,0],[878,58,878,61,0],[879,13,879,14,0],[880,17,880,77,0],[881,17,881,55,0],[882,17,882,59,0],[883,17,883,63,0],[884,17,884,73,0],[885,17,885,39,0],[886,13,886,14,0],[887,9,887,10,0],[890,9,890,10,0],[891,13,891,37,0],[892,13,892,49,0],[893,13,893,61,0],[894,13,895,38,0],[896,18,896,27,0],[896,29,896,56,0],[896,58,896,61,0],[897,13,897,14,0],[898,17,898,77,0],[899,17,899,55,0],[900,17,900,59,0],[901,17,901,63,0],[902,17,902,73,0],[903,17,903,39,0],[904,13,904,14,0],[905,9,905,10,0],[908,9,908,10,0],[909,13,909,79,0],[910,13,912,45,0],[914,13,914,74,0],[915,13,915,100,0],[916,13,916,23,0],[917,13,917,20,0],[917,22,917,40,0],[917,41,917,43,0],[917,44,917,52,0],[918,13,918,14,0],[919,17,919,61,0],[920,17,920,74,0],[921,21,925,23,0],[926,13,926,14,0],[927,13,927,32,0],[928,9,928,10,0],[931,9,931,10,0],[932,13,932,79,0],[933,13,935,45,0],[937,13,937,74,0],[938,13,938,100,0],[939,13,939,23,0],[940,13,940,20,0],[940,22,940,40,0],[940,41,940,43,0],[940,44,940,52,0],[941,13,941,14,0],[942,17,942,61,0],[943,17,943,74,0],[944,21,948,23,0],[949,13,949,14,0],[950,13,950,32,0],[951,9,951,10,0],[954,9,954,10,0],[955,13,955,79,0],[956,13,958,45,0],[960,13,960,74,0],[961,13,961,100,0],[962,13,962,23,0],[963,13,963,20,0],[963,22,963,40,0],[963,41,963,43,0],[963,44,963,52,0],[964,13,964,14,0],[965,17,965,61,0],[966,17,966,74,0],[967,21,971,23,0],[972,13,972,14,0],[973,13,973,32,0],[974,9,974,10,0],[977,9,977,10,0],[978,13,978,78,0],[979,13,979,65,0],[980,13,980,87,0],[981,17,981,51,0],[983,13,983,14,0],[984,17,984,50,0],[985,17,985,55,0],[986,13,986,14,0],[987,13,987,52,0],[988,13,988,48,0],[989,9,989,10,0],[992,9,992,10,0],[993,13,993,48,0],[994,13,994,45,0],[997,21,997,76,0],[998,21,998,70,0],[1000,21,1000,31,0],[1001,21,1001,27,0],[1003,21,1003,74,0],[1004,21,1004,63,0],[1005,21,1005,31,0],[1006,21,1006,27,0],[1010,21,1010,76,0],[1012,21,1012,75,0],[1013,25,1013,68,0],[1015,25,1015,46,0],[1017,21,1017,54,0],[1019,21,1019,89,0],[1020,21,1020,79,0],[1021,21,1021,22,0],[1022,25,1024,106,0],[1025,21,1025,22,0],[1027,21,1027,22,0],[1028,25,1028,93,0],[1029,25,1029,95,0],[1030,25,1030,99,0],[1031,25,1031,97,0],[1032,25,1032,93,0],[1033,25,1033,97,0],[1034,25,1034,93,0],[1035,21,1035,22,0],[1036,21,1036,49,0],[1037,21,1037,31,0],[1038,21,1038,27,0],[1040,21,1040,88,0],[1041,21,1041,96,0],[1042,21,1042,87,0],[1043,21,1043,89,0],[1044,21,1044,83,0],[1045,21,1045,83,0],[1046,21,1046,79,0],[1047,21,1047,81,0],[1048,21,1048,81,0],[1049,21,1049,85,0],[1050,21,1050,91,0],[1051,21,1051,87,0],[1052,21,1052,89,0],[1053,21,1053,89,0],[1054,21,1054,64,0],[1056,21,1056,70,0],[1057,21,1057,41,0],[1058,21,1058,27,0],[1061,21,1061,89,0],[1063,21,1063,88,0],[1064,21,1064,79,0],[1065,21,1065,81,0],[1066,21,1066,75,0],[1067,21,1067,75,0],[1068,21,1068,71,0],[1069,21,1069,73,0],[1070,21,1070,73,0],[1071,21,1071,77,0],[1072,21,1072,83,0],[1073,21,1073,79,0],[1074,21,1074,81,0],[1075,21,1075,81,0],[1076,21,1076,51,0],[1079,21,1079,55,0],[1080,21,1081,110,0],[1083,21,1083,82,0],[1084,21,1084,82,0],[1085,21,1085,84,0],[1086,21,1086,88,0],[1087,21,1087,86,0],[1088,21,1088,82,0],[1089,21,1089,86,0],[1090,21,1090,82,0],[1091,21,1091,47,0],[1093,21,1093,36,0],[1094,21,1094,27,0],[1096,21,1096,27,0],[1099,13,1099,25,0],[1100,9,1100,10,0],[1103,9,1103,10,0],[1104,13,1104,54,0],[1105,13,1105,94,0],[1106,13,1106,55,0],[1107,13,1107,46,0],[1109,13,1109,49,0],[1110,13,1110,30,0],[1112,13,1112,77,0],[1113,13,1114,95,0],[1137,13,1137,33,0],[1138,9,1138,10,0]]);
    </script>
  </body>
</html>