<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\UserControls\AutoComplete.ascx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration;
using System.Data;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;
using System.Text;
using System.Web.Script.Serialization;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Infragistics.Web.UI.GridControls;

namespace Aurigo.Brix.Platform.BusinessLayer.UserControls
{
    [DefaultProperty(&quot;Text&quot;)]
    [ToolboxData(&quot;&lt;{0}:AutoComplete runat=server&gt;&lt;/{0}:AutoComplete&gt;&quot;)]
    public partial class AutoComplete : System.Web.UI.UserControl, ICallbackEventHandler
    {
        protected global::Infragistics.Web.UI.GridControls.WebDataGrid grd;
        string _CallbackArguments;
        bool _DoPostBackAfterSelect;
        bool _RenderDropdown;
        bool _HideIdColumn;
        string _AjParamOrScript;
        string _DBQuery;
        string _IdColumn;
        string _DisplayColumn;
        string _OnSelectScript;
        string _ButtonCaptions;
        string _SelectStaticParams;
        string _PostSelectCallBack;
        int _DialogWidth;
        int _ListHeight;
        int _PageSize;
        InfraGrid _Grid;

        public delegate bool InitParams(object sender, out GridInfo optionalGridInfo, out DataTable optionalDataSource);

        public delegate TRow[] Search(
            string searchFilter, string additionalJSONData, string getPage, string pageSize, out string pages);

        public delegate DataTable SearchFromDB(
            object sender, string searchFilter, string additionalJSONData, string getPage, string pageSize,
            Dictionary&lt;string, object&gt; gridFilters, out string pages);

        public delegate void Select(
            string selectedDisplay, string selectedValue, string sAdditionalData,
            List&lt;Dictionary&lt;string, string&gt;&gt; selectedElems, out string postSelectData);

        public delegate void EnsureAjax(
            out bool IsDoPostBackAfterSelect, out string PostSelectCallBack, out string OnCancelScript,
            out bool IsMultiSelect, out int PageSize, out GridInfo gridInfo);

        public event InitParams InitPickerParams;
        public event InitParams InitPickerNewSchema;
        public event SearchFromDB DoDBAutoComplete;
        public event Select ItemSelected;
        public event EnsureAjax EnsureAjaxParams;

        protected string CurrentPage
        {
            get { return string.IsNullOrEmpty(hdnCurrentPage.Value) ? &quot;1&quot; : hdnCurrentPage.Value; }
        }

        protected string SelectedAction
        {
            get { return this.ClientID + &quot;AutoSelect&quot;; }
        }

        public string PickerParent { get; set; }

        public HtmlInputText AutoCompleteText
        {
            get { return autoText; }
        }

        public HtmlInputText AutoValue
        {
            get { return valHolder; }
        }

        public HtmlInputButton AutoButton
        {
            get { return btnAuto; }
        }

        public WebDataGrid Grid
        {
            get { return grd; }
        }

        public HtmlGenericControl AutoMandatory
        {
            get { return autoMandatory; }
        }

        #region Properties which can be set in markup

        public string Columns { get; set; }

        public string Text
        {
            get { return autoText.Value; }
            set { autoText.Value = value; }
        }

        public string SelectedValue
        {
            get { return valHolder.Value; }
            set { valHolder.Value = value; }
        }

        public string AjaxParamOrScript
        {
            set { _AjParamOrScript = value; }
            get { return string.IsNullOrEmpty(_AjParamOrScript) ? &quot;&#39;&#39;&quot; : _AjParamOrScript; }
        }

        public string AutoCompleteButtonText
        {
            set { btnAuto.Value = value; }
            get { return btnAuto.Value; }
        }

        public string AutoCompleteButtonClass
        {
            set
            {
                if (null == btnAuto.Attributes[&quot;class&quot;]) btnAuto.Attributes.Add(&quot;class&quot;, value);
                else btnAuto.Attributes[&quot;class&quot;] = value;
            }
            get { return (null == btnAuto.Attributes[&quot;class&quot;]) ? &quot;btnC&quot; : btnAuto.Attributes[&quot;class&quot;]; }
        }

        public string AutoTextClass
        {
            set
            {
                if (null == autoText.Attributes[&quot;class&quot;]) autoText.Attributes.Add(&quot;class&quot;, value);
                else autoText.Attributes[&quot;class&quot;] = value;
            }
            get
            {
                return (null == autoText || null == autoText.Attributes[&quot;class&quot;]) ? &quot;&quot; : autoText.Attributes[&quot;class&quot;];
            }
        }

        public string AutoCompleteButtonStyle
        {
            set
            {
                if (null == btnAuto.Attributes[&quot;style&quot;]) btnAuto.Attributes.Add(&quot;style&quot;, value);
                else btnAuto.Attributes[&quot;style&quot;] = value;
            }
            get { return (null == btnAuto || null == btnAuto.Attributes[&quot;style&quot;]) ? &quot;&quot; : btnAuto.Attributes[&quot;style&quot;]; }
        }

        public string AutoTextStyle
        {
            set
            {
                if (null == autoText.Attributes[&quot;style&quot;]) autoText.Attributes.Add(&quot;style&quot;, value);
                else autoText.Attributes[&quot;style&quot;] = value;
            }
            get
            {
                return (null == autoText || null == autoText.Attributes[&quot;style&quot;]) ? &quot;&quot; : autoText.Attributes[&quot;style&quot;];
            }
        }

        public bool TextRequired { get; set; }
        public bool ValueRequired { get; set; }
        public bool SelectRequired { get; set; }
        public bool SkipRequired { get; set; }
        public string TextValidationGroup { get; set; }

        public bool DoPostBackAfterSelect
        {
            set { _DoPostBackAfterSelect = value; }
            get { return _DoPostBackAfterSelect; }
        }

        public DataTable DataSource
        {
            get { return null == _Grid ? null : _Grid.CachedDataSource; }
        }

        public bool RenderDropdown
        {
            set { _RenderDropdown = value; }
            get { return _RenderDropdown; }
        }

        public string DBQuery
        {
            get { return _DBQuery; }
            set { _DBQuery = value; }
        }

        public int ListHeight
        {
            get { return _ListHeight; }
            set { _ListHeight = value; }
        }

        public int PageSize
        {
            get
            {
                return _PageSize &lt; 1
                    ? (ConfigurationManager.AppSettings[&quot;PickerPageSize&quot;] == null
                        ? 20
                        : ConfigurationManager.AppSettings[&quot;PickerPageSize&quot;].ToInt32_2())
                    : _PageSize;
            }
            set { _PageSize = value; }
        }

        public string IdColumn
        {
            get { return string.IsNullOrEmpty(_IdColumn) ? &quot;ID&quot; : _IdColumn; }
            set { _IdColumn = value; }
        }

        public string DisplayColumn
        {
            get { return string.IsNullOrEmpty(_DisplayColumn) ? &quot;Name&quot; : _DisplayColumn; }
            set { _DisplayColumn = value; }
        }

        public bool HideIdColumn
        {
            get { return _HideIdColumn; }
            set { _HideIdColumn = value; }
        }

        public string ButtonCaptions
        {
            get { return string.IsNullOrEmpty(_ButtonCaptions) ? &quot;Select|Cancel&quot; : _ButtonCaptions; }
            set { _ButtonCaptions = value; }
        }

        public bool Disabled
        {
            get { return autoText.Disabled; }
            set
            {
                autoText.Disabled = value;
                btnAuto.Disabled = value;
            }
        }

        public string Title { get; set; }
        public bool IsMultiSelect { get; set; }

        public string PostSelectCallBack
        {
            get { return string.IsNullOrEmpty(_PostSelectCallBack) ? &quot;&quot; : _PostSelectCallBack; }
            set { _PostSelectCallBack = value; }
        }

        public string OnCancelScript { get; set; }

        public string SelectStaticParams
        {
            get { return string.IsNullOrEmpty(_SelectStaticParams) ? &quot;&#39;staticValue&#39;&quot; : _SelectStaticParams; }
            set { _SelectStaticParams = value; }
        }

        public int DialogWidth
        {
            get { return _DialogWidth &lt; 200 ? 600 : _DialogWidth; }
            set { _DialogWidth = value; }
        }

        public bool HideAll { get; set; }
        public bool ReBindDataOnPB { get; set; }

        public string OnSelectScript
        {
            get { return string.IsNullOrEmpty(_OnSelectScript) &amp;&amp; !_DoPostBackAfterSelect ? &quot;&#39;&#39;&quot; : _OnSelectScript; }
            set { _OnSelectScript = value; }
        }

        public string ExcludeItemsCsv { get; set; }

        #endregion

        protected override void OnInit(EventArgs e)
        {
            AutoMandatory.InnerText = &quot;&quot;;
            base.OnInit(e);
            lnkStart = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lnkStart&quot;);
            lnkPrev = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lnkPrev&quot;);
            lblPageNo = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lblPageNo&quot;);
            lnkNext = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lnkNext&quot;);
            lnkLast = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lnkLast&quot;);
            lblTotalPages = (HtmlAnchor)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;lblTotalPages&quot;);
            hdnTotalPages =
                (HtmlInputHidden)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;hdnTotalPages&quot;);
            hdnCurrentPage =
                (HtmlInputHidden)grd.Behaviors.Paging.PagerTemplateContainerBottom.FindControl(&quot;hdnCurrentPage&quot;);
            _Grid = new InfraGrid(grd, Page, divErr, hdnCurrentPage, hdnTotalPages, autoText, valHolder, btnAuto,
                hdnSelectedRows, this, ViewState, Session, sortFilters, lblPageNo,
                lnkStart, lnkPrev, lnkNext, lnkLast, lblTotalPages);
            InitGridValues();
            _Grid.InitPickerParams += new InitParams(_Grid_InitPickerParams);
            _Grid.InitOnFilter += new InitParams(_Grid_InitOnFilter);
        }

        private void InitGridValues()
        {
            _Grid.AjaxGetListParamOrScript = AjaxParamOrScript;
            _Grid.Columns = Columns;
            _Grid.DisplayColumn = DisplayColumn;
            _Grid.ExcludeItemsCsv = ExcludeItemsCsv;
            _Grid.ParamHolder = paramHolder;
            _Grid.HideIdColumn = HideIdColumn;
            _Grid.IdColumn = IdColumn;
            _Grid.IsMultiSelect = IsMultiSelect;
            _Grid.ListHeight = ListHeight;
            _Grid.PageSize = PageSize;
            _Grid.ReBindDataOnPB = ReBindDataOnPB;
        }

        bool _Grid_InitPickerParams(object sender, out GridInfo optionalGridInfo, out DataTable optionalDataSource)
        {
            InitGridValues();
            bool res = false;
            optionalGridInfo = null;
            optionalDataSource = null;
            if (null != InitPickerNewSchema)
                res = InitPickerNewSchema(this, out optionalGridInfo, out optionalDataSource);
            else if (null != InitPickerParams)
                res = InitPickerParams(this, out optionalGridInfo, out optionalDataSource);
            InitGridValues();
            //after this call, BindGrid gets called. 
            //before that, if (Page.IsPostBack &amp;&amp; !Page.IsCallback and _GridInfo is not available in session) then
            //DoDataBind calls DoDBAutoComplete
            return res;
        }

        protected override void OnLoad(EventArgs e)
        {
            if (null != Request.Form[&quot;__EVENTARGUMENT&quot;] &amp;&amp; Request.Form[&quot;__EVENTARGUMENT&quot;] == SelectedAction)
            {
                string postSelectData;
                try
                {
                    DataContractJsonSerializer jsonRows =
                        new DataContractJsonSerializer(typeof (List&lt;Dictionary&lt;string, string&gt;&gt;));
                    MemoryStream stream1 = new MemoryStream();
                    byte[] arr = Encoding.Unicode.GetBytes(hdnSelectedRows.Value);
                    stream1.Write(arr, 0, arr.Length);
                    stream1.Position = 0;
                    List&lt;Dictionary&lt;string, string&gt;&gt; selectedRows =
                        (List&lt;Dictionary&lt;string, string&gt;&gt;)jsonRows.ReadObject(stream1);
                    hdnSelectedRows.Value = &quot;&quot;;
                    if (null != ItemSelected)
                        ItemSelected(Text.Trim(&#39;|&#39;), SelectedValue.Trim(&#39;|&#39;), &quot;&quot;, selectedRows, out postSelectData);
                    divErr.Style[&quot;display&quot;] = &quot;none&quot;;
                }
                catch (System.Exception ex)
                {
                    divErr.InnerText = ex.Message;
                    divErr.Style[&quot;display&quot;] = &quot;block&quot;;
                }
                if (IsMultiSelect &amp;&amp; null != autoText &amp;&amp; null != valHolder)
                {
                    autoText.Value = &quot;&quot;;
                    valHolder.Value = &quot;&quot;;
                }
            }
            if (this.Page.IsCallback) return;
            InitGridValues();
            if ((TextRequired || ValueRequired || SelectRequired) &amp;&amp; SkipRequired != true)
            {
                required.ControlToValidate = ValueRequired
                    ? valHolder.ID
                    : SelectRequired ? hdnSelectedRows.ID : autoText.ID;
                required.ValidationGroup = TextValidationGroup;
            }
            else required.Visible = false;
            _Grid.OnLoad(e);
            base.OnLoad(e);

            if (HideAll)
            {
                if (null == AutoCompleteText.Style[&quot;display&quot;]) AutoCompleteText.Style.Add(&quot;display&quot;, &quot;none&quot;);
                else AutoCompleteText.Style[&quot;display&quot;] = &quot;none&quot;;

                if (null == AutoButton.Style[&quot;display&quot;]) AutoButton.Style.Add(&quot;display&quot;, &quot;none&quot;);
                else AutoButton.Style[&quot;display&quot;] = &quot;none&quot;;
            }


            _Grid.RegisterScripts();
        }

        public void BindGrid(AutoComplete.GridInfo optionalGridInfo = null, DataTable optionalDataTable = null)
        {
            InitGridValues();
            if (null != _Grid) _Grid.BindGrid(optionalGridInfo, optionalDataTable);
        }

        bool _Grid_InitOnFilter(object senderInfo, out GridInfo optionalGridInfo, out DataTable optionalDataSource)
        {
            optionalGridInfo = null;
            optionalDataSource = null;
            Dictionary&lt;string, string&gt; customfilters = (Dictionary&lt;string, string&gt;)senderInfo;
            if (null == DoDBAutoComplete) return false;
            JavaScriptSerializer js = new JavaScriptSerializer();
            Dictionary&lt;string, object&gt; filters = js.Deserialize&lt;Dictionary&lt;string, object&gt;&gt;(customfilters[&quot;GridFilter&quot;]);
            ProcessSortFilters(filters);
            string sPages = &quot;&quot;;
            GetMaxData(out sPages, customfilters[&quot;CustomFilter&quot;], out optionalDataSource, filters,
                customfilters[&quot;AutoFilter&quot;]);
            return true;
        }

        private bool GetMaxData(out string sPages, string senderJsonData, out DataTable optionalDataSource,
            Dictionary&lt;string, object&gt; filters, string autoFilter = &quot;&quot;)
        {
            sPages = &quot;&quot;;
            optionalDataSource = null;
            if (null == DoDBAutoComplete) return false;

            int origPagesize = this.PageSize;
            this.PageSize = int.MaxValue;
            string getPage = &quot;1&quot;;
            optionalDataSource = DoDBAutoComplete(this, autoFilter, senderJsonData, getPage, int.MaxValue.ToString(),
                filters, out sPages);
            this.PageSize = origPagesize;
            return true;
        }

        public string ScriptForPopup
        {
            get { return &quot;$(&#39;#&quot; + AutoButton.ClientID + &quot;&#39;).click(); return false&quot;; }
        }

        #region ICallbackEventHandler Members

        public void RaiseCallbackEvent(string eventArgument)
        {
            _CallbackArguments = eventArgument;
        }

        public string GetCallbackResult()
        {
            string result = &quot;&quot;;
            DataContractJsonSerializer jsonSerialiser = new DataContractJsonSerializer(typeof (ajaxUIData));
            MemoryStream stream1 = new MemoryStream();
            stream1.Write(Encoding.Unicode.GetBytes(_CallbackArguments), 0,
                Encoding.Unicode.GetBytes(_CallbackArguments).Length);
            stream1.Position = 0;
            ajaxUIData values = (ajaxUIData)jsonSerialiser.ReadObject(stream1);
            values.srcdata = DBQuery;
            string sPages = &quot;1&quot;;
            if (values.action == &quot;DBAutoComplete&quot;)
            {
                TGrid grdDetails = new TGrid();
                try
                {
                    JavaScriptSerializer js = new JavaScriptSerializer();
                    Dictionary&lt;string, object&gt; parms = js.Deserialize&lt;Dictionary&lt;string, object&gt;&gt;(values.otherdata);

                    GridInfo gridInfo = null;
                    if (null != EnsureAjaxParams)
                    {
                        bool IsDoPostBackAfterSelect;
                        string postSelectCallBack;
                        string onCancelScript;
                        int ps;
                        bool isMS;
                        EnsureAjaxParams(out IsDoPostBackAfterSelect, out postSelectCallBack, out onCancelScript,
                            out isMS, out ps, out gridInfo);
                        DoPostBackAfterSelect = IsDoPostBackAfterSelect;
                        PostSelectCallBack = postSelectCallBack;
                        OnCancelScript = onCancelScript;
                        PageSize = ps;
                        IsMultiSelect = isMS;
                    }

                    string getPage = (string)parms[&quot;GetPage&quot;];
                    string autoTextVal = (string)parms[&quot;AutoTextVal&quot;];
                    string customScriptVal = (string)parms[&quot;CustomScriptVal&quot;];
                    string sortFilter = (string)parms[&quot;SortFilter&quot;];
                    Dictionary&lt;string, object&gt; filters = js.Deserialize&lt;Dictionary&lt;string, object&gt;&gt;(sortFilter);

                    getPage = string.IsNullOrEmpty(getPage) || getPage == &quot;null&quot; ? &quot;1&quot; : getPage;
                    ProcessSortFilters(filters);
                    if (null != filters) filters.Add(&quot;FilterExplicitly&quot;, true);

                    if (getPage == &quot;1&quot;) _Grid.ClearCachedDataSource();
                    string[] cols = null;
                    DataTable dt = _Grid.CachedDataSource;
                    string sTitle = &quot;&quot;;
                    if (null == dt)
                    {
                        try
                        {
                            _Grid.DoMaxDataBindAndCache(false, true, autoTextVal, sortFilter, customScriptVal);
                            dt = _Grid.CachedDataSource;
                        }
                        catch (System.Exception ex)
                        {
                            grdDetails.Errors = ex.Message + &quot;\n&quot; + ex.StackTrace;
                        }
                        if (null == dt) dt = _Grid.GetTableFromColumnsProperty(out cols);
                    }
                    string pages = &quot;&quot;;
                    string onSelectScript = &quot;&quot;;
                    InitGridValues();


                    grdDetails = _Grid.FillGridFromDataTable(dt, getPage, _DoPostBackAfterSelect, gridInfo, filters,
                        out pages, out onSelectScript);
                    FillDialogDetails(grdDetails, onSelectScript, string.IsNullOrEmpty(pages) ? sPages : pages, sTitle,
                        getPage);
                }
                catch (Exception ex)
                {
                    grdDetails.Errors = ex.Message + &quot;\n&quot; + ex.StackTrace;
                }

                DataContractJsonSerializer jsonSearch = new DataContractJsonSerializer(typeof (TGrid));
                result = WriteAjaxUIText(jsonSearch, grdDetails);
            }
            if (values.action == SelectedAction)
            {
                PostSelectData psd = new PostSelectData();
                try
                {
                    string postSelectData = &quot;&quot;;
                    DataContractJsonSerializer jsonRows =
                        new DataContractJsonSerializer(typeof (List&lt;Dictionary&lt;string, string&gt;&gt;));
                    byte[] arr = Encoding.Unicode.GetBytes(values.where);
                    stream1 = new MemoryStream();
                    stream1.Write(arr, 0, arr.Length);
                    stream1.Position = 0;
                    List&lt;Dictionary&lt;string, string&gt;&gt; selectedRows =
                        (List&lt;Dictionary&lt;string, string&gt;&gt;)jsonRows.ReadObject(stream1);
                    if (null != ItemSelected)
                        ItemSelected(values.what.Trim(&#39;|&#39;), values.otherdata.Trim(&#39;|&#39;), values.when, null,
                            out postSelectData);
                    psd = new PostSelectData();
                    psd.PostSelectFunction = PostSelectCallBack +
                                             (IsMultiSelect ? (&quot;$(&#39;#&quot; + autoText.ClientID + &quot;&#39;).val(&#39;&#39;);&quot;) : &quot;&quot;);
                    psd.Data = postSelectData;
                    psd.Pages = sPages;
                }
                catch (Exception ex)
                {
                    psd.Errors = ex.Message + &quot;\n&quot; + ex.StackTrace;
                }
                DataContractJsonSerializer jsonSearch = new DataContractJsonSerializer(typeof (PostSelectData));
                result = WriteAjaxUIText(jsonSearch, psd);
            }
            return result;
        }

        public static void ProcessSortFilters(Dictionary&lt;string, object&gt; filters, bool bUseBrackets = true)
        {
            if (null == filters) return;
            foreach (string o in filters.Keys)
            {
                if (&quot;Filters&quot; == o)
                {
                    ProcessFilters((ArrayList)filters[o], bUseBrackets);
                }
                if (&quot;SortOrder&quot; == o)
                {
                    ProcessSort((Dictionary&lt;string, object&gt;)filters[o], bUseBrackets);
                }
            }
        }

        public static void ProcessFilters(ArrayList val, bool bUseBrackets = true)
        {
            foreach (object o in val)
            {
                Dictionary&lt;string, object&gt; value = (Dictionary&lt;string, object&gt;)o;
                ProcessFilter(value, bUseBrackets);
            }
        }

        public static void ProcessFilter(Dictionary&lt;string, object&gt; value, bool bUseBrackets = true)
        {
            int rule = (int)value[&quot;rule&quot;];
            string colKey = (string)value[&quot;colKey&quot;];
            string coltype = (string)value[&quot;coltype&quot;];
            string val = !value.ContainsKey(&quot;value&quot;) || null == value[&quot;value&quot;] ? null : value[&quot;value&quot;].ToString();
            if (bUseBrackets) colKey = &quot;[&quot; + colKey + &quot;]&quot;;
            string filter = GetSqlFilter(rule, colKey, val, coltype);
            if (value.ContainsKey(&quot;SQLFilter&quot;)) value[&quot;SQLFilter&quot;] = filter;
            else value.Add(&quot;SQLFilter&quot;, filter);
        }

        public static string GetSqlFilter(int rule, string colKey, string val, string coltype)
        {
            string filter = &quot;&quot;;
            if (coltype == &quot;string&quot;)
            {
                switch (rule)
                {
                    case (int)TextFilterRules.Contains:
                        filter = string.Format(&quot; {0} like &#39;%{2}%&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.BeginsWith:
                        filter = string.Format(&quot; {0} like &#39;{2}%&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.EndsWith:
                        filter = string.Format(&quot; {0} like &#39;%{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.DoesNotContain:
                        filter = string.Format(&quot; {0} not like &#39;%{2}%&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.DoesNotEqual:
                        filter = string.Format(&quot; {0} &lt;&gt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.Equals:
                        filter = string.Format(&quot; {0} = &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.IsNull:
                        filter = string.Format(&quot; {0} is null &quot;, colKey, rule, val);
                        break;
                    case (int)TextFilterRules.IsNotNull:
                        filter = string.Format(&quot; {0} is not null &quot;, colKey, rule, val);
                        break;
                }
            }
            if (coltype == &quot;number&quot;)
            {
                switch (rule)
                {
                    case (int)NumericFilterRules.GreaterThan:
                        filter = string.Format(&quot; {0} &gt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.LessThan:
                        filter = string.Format(&quot; {0} &lt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.GreaterThanOrEqualTo:
                        filter = string.Format(&quot; {0} &gt;= &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.LessThanOrEqualTo:
                        filter = string.Format(&quot; {0} &lt;= &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.DoesNotEqual:
                        filter = string.Format(&quot; {0} &lt;&gt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.Equals:
                        filter = string.Format(&quot; {0} = &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.IsNull:
                        filter = string.Format(&quot; {0} is null &quot;, colKey, rule, val);
                        break;
                    case (int)NumericFilterRules.IsNotNull:
                        filter = string.Format(&quot; {0} is not null &quot;, colKey, rule, val);
                        break;
                }
            }
            if (coltype == &quot;datetime&quot;)
            {
                switch (rule)
                {
                    case (int)DateTimeFilterRules.After:
                        filter = string.Format(&quot; {0} &gt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.Before:
                        filter = string.Format(&quot; {0} &lt; &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.Equals:
                        filter = string.Format(&quot; {0} = &#39;{2}&#39; &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.IsNull:
                        filter = string.Format(&quot; {0} is null &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.IsNotNull:
                        filter = string.Format(&quot; {0} is not null &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.LastMonth:
                        filter = string.Format(&quot; {0} &gt;= DATEADD(day, -30, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.LastQuarter:
                        filter = string.Format(&quot; {0} &gt;= DATEADD(day, -90, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.LastWeek:
                        filter = string.Format(&quot; {0} &gt;= DATEADD(day, -7, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.LastYear:
                        filter = string.Format(&quot; {0} &gt;= DATEADD(day, -365, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.NextMonth:
                        filter = string.Format(&quot; {0} &lt;= DATEADD(day, 30, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.NextQuarter:
                        filter = string.Format(&quot; {0} &lt;= DATEADD(day, 90, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.NextWeek:
                        filter = string.Format(&quot; {0} &lt;= DATEADD(day, 7, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.NextYear:
                        filter = string.Format(&quot; {0} &lt;= DATEADD(day, 365, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.ThisMonth:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(month, DATEDIFF(month, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.ThisQuarter:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(quarter, DATEDIFF(quarter, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.ThisWeek:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(week, DATEDIFF(week, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.ThisYear:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(year, DATEDIFF(year, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.Today:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(day, DATEDIFF(day, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.Tomorrow:
                        filter = string.Format(&quot; {0} &gt; DATEADD(day, 1, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.YearToDate:
                        filter =
                            string.Format(
                                &quot; {0} &gt; DATEADD(year, DATEDIFF(year, &#39;1900-01-01&#39;, CURRENT_TIMESTAMP), &#39;1900-01-01&#39;) &quot;,
                                colKey, rule, val);
                        break;
                    case (int)DateTimeFilterRules.Yesterday:
                        filter = string.Format(&quot; {0} = DATEADD(day, -1, CURRENT_TIMESTAMP) &quot;, colKey, rule, val);
                        break;
                }
            }
            if (coltype == &quot;boolean&quot;)
            {
                switch (rule)
                {
                    case (int)BooleanFilterRules.False:
                        filter = string.Format(&quot; {0} = 0 &quot;, colKey, rule, val);
                        break;
                    case (int)BooleanFilterRules.True:
                        filter = string.Format(&quot; {0} = 1 &quot;, colKey, rule, val);
                        break;
                    case (int)BooleanFilterRules.IsNull:
                        filter = string.Format(&quot; {0} is null &quot;, colKey, rule, val);
                        break;
                    case (int)BooleanFilterRules.IsNotNull:
                        filter = string.Format(&quot; {0} is not null &quot;, colKey, rule, val);
                        break;
                }
            }
            return filter;
        }

        public static void ProcessSort(Dictionary&lt;string, object&gt; val, bool bUseBrackets = true)
        {
            int sortType = (int)val[&quot;SortType&quot;];
            string Column = val[&quot;Column&quot;].ToString();
            if (string.IsNullOrEmpty(Column)) return;
            if (bUseBrackets) Column = &quot;[&quot; + Column + &quot;]&quot;;
            string sort = Column + (sortType == 1 ? &quot; asc &quot; : &quot; desc &quot;);
            if (val.ContainsKey(&quot;SortSQL&quot;)) val[&quot;SortSQL&quot;] = sort;
            else val.Add(&quot;SortSQL&quot;, sort);
        }

        private void FillDialogDetails(TGrid tg, string selectedValScript, string sPages, string sTitle, string getPage)
        {
            string sCallBackScript = this.Page.ClientScript.GetCallbackEventReference(this,
                string.Format(
                    &quot;ConstructServerParams(&#39;{1}&#39;, selectedVal, selectedText,{0}, sSelectedRows, sortfilters)&quot;,
                    OnSelectScript, SelectedAction),
                &quot;CustomUpdateScript&quot;,
                SelectStaticParams);
            sCallBackScript = &quot;hdn2[0].value = &#39;&#39;;&quot; + sCallBackScript;
            string setPostBackScript = string.Format(&quot;{2}__doPostBack(&#39;{0}&#39;, &#39;{1}&#39;);&quot;, btnAuto.ClientID, SelectedAction,
                OnSelectScript);
            string sScript = _DoPostBackAfterSelect
                ? string.Format(&quot;{0}{1}\n}}&quot;, selectedValScript, setPostBackScript)
                : string.Format(&quot;{0}{1}\n}}&quot;, selectedValScript, sCallBackScript);
            tg.OnSelectScript = sScript;
            tg.ParentUpdatePanel = string.IsNullOrEmpty(PickerParent) ? &quot;centerContent&quot; : PickerParent;
            tg.DialogDiv = autoGrid.ClientID;
            tg.OnCancelScript = OnCancelScript + _Grid.ResetCurrentPageScript();
            tg.ButtonCaptions = ButtonCaptions.Split(&#39;|&#39;);
            tg.Title = string.IsNullOrEmpty(sTitle) ? Title : sTitle;
            tg.DialogWidth = DialogWidth;
            tg.DialogHeight = ListHeight &lt; 1 ? 400 : ((ListHeight*25) + 40);
            tg.PostAjaxScript = _Grid.GetAjaxFillGridScript(getPage, sPages, lblPageNo.ClientID);
            tg.PostDisplayScript = (Request.Browser.Browser == &quot;Chrome&quot; ? &quot;ResetColWidths(&#39;&quot; : &quot;ResetColIE(&#39;&quot;) +
                                   grd.ClientID + &quot;&#39;);&quot;;
        }

        #endregion

        [DataContract]
        public class PostSelectData
        {
            [DataMember] public string PostSelectFunction;
            [DataMember] public string Data;
            [DataMember] public string Pages;
            [DataMember] public string Errors;
        }

        public static string WriteAjaxUIText(DataContractJsonSerializer jsonSerialiser, object data,
            MemoryStream stream1 = null)
        {
            stream1 = new MemoryStream();
            jsonSerialiser.WriteObject(stream1, data);
            stream1.Seek(0, SeekOrigin.Begin);
            StreamReader reader = new StreamReader(stream1);
            return reader.ReadToEnd();
            ;
        }

        [DataContract]
        [KnownType(typeof (TGrid))]
        public class TGrid
        {
            [DataMember] public string[] Rows;
            [DataMember] public string[] Columns;
            [DataMember] public string IdColumn;
            [DataMember] public string[] ButtonCaptions;
            [DataMember] public string DialogDiv;
            [DataMember] public string ParentUpdatePanel;
            [DataMember] public string GridId;
            [DataMember] public string OnSelectScript;
            [DataMember] public string OnCancelScript;
            [DataMember] public string ListHeight;
            [DataMember] public int DialogWidth;
            [DataMember] public int DialogHeight;
            [DataMember] public string Title;
            [DataMember] public string PostAjaxScript;
            [DataMember] public string PostDisplayScript;
            [DataMember] public string ExcludeList;
            [DataMember] public string Errors;
        }

        [DataContract]
        [KnownType(typeof (GridInfo))]
        public class GridInfo
        {
            [DataMember] public TColumn[] Cols;
        }

        [DataContract]
        [KnownType(typeof (TColumn))]
        public class TColumn
        {
            [DataMember] public string ColId;
            [DataMember] public string Caption;
            [DataMember] public string Format;
            [DataMember] public bool Editable;
            [DataMember] public bool Hidden;
            public Type TP;
            public string Width;
        }

        [DataContract]
        public class TRow
        {
            [DataMember] public string[] Cels;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[67,17,67,18,0],[67,19,67,98,0],[67,99,67,100,0],[72,17,72,18,0],[72,19,72,55,0],[72,56,72,57,0],[75,38,75,42,0],[75,43,75,47,0],[79,17,79,18,0],[79,19,79,35,0],[79,36,79,37,0],[84,17,84,18,0],[84,19,84,36,0],[84,37,84,38,0],[89,17,89,18,0],[89,19,89,34,0],[89,35,89,36,0],[94,17,94,18,0],[94,19,94,30,0],[94,31,94,32,0],[99,17,99,18,0],[99,19,99,40,0],[99,41,99,42,0],[104,33,104,37,0],[104,38,104,42,0],[108,17,108,18,0],[108,19,108,41,0],[108,42,108,43,0],[109,17,109,18,0],[109,19,109,42,0],[109,43,109,44,0],[114,17,114,18,0],[114,19,114,42,0],[114,43,114,44,0],[115,17,115,18,0],[115,19,115,43,0],[115,44,115,45,0],[120,17,120,18,0],[120,19,120,44,0],[120,45,120,46,0],[121,17,121,18,0],[121,19,121,91,0],[121,92,121,93,0],[126,17,126,18,0],[126,19,126,41,0],[126,42,126,43,0],[127,17,127,18,0],[127,19,127,40,0],[127,41,127,42,0],[133,13,133,14,0],[134,17,134,57,0],[134,58,134,97,0],[135,22,135,58,0],[136,13,136,14,0],[137,17,137,18,0],[137,19,137,103,0],[137,104,137,105,0],[143,13,143,14,0],[144,17,144,58,0],[144,59,144,99,0],[145,22,145,59,0],[146,13,146,14,0],[148,13,148,14,0],[149,17,149,119,0],[150,13,150,14,0],[156,13,156,14,0],[157,17,157,57,0],[157,58,157,97,0],[158,22,158,58,0],[159,13,159,14,0],[160,17,160,18,0],[160,19,160,118,0],[160,119,160,120,0],[166,13,166,14,0],[167,17,167,58,0],[167,59,167,99,0],[168,22,168,59,0],[169,13,169,14,0],[171,13,171,14,0],[172,17,172,119,0],[173,13,173,14,0],[176,36,176,40,0],[176,41,176,45,0],[177,37,177,41,0],[177,42,177,46,0],[178,38,178,42,0],[178,43,178,47,0],[179,36,179,40,0],[179,41,179,45,0],[180,45,180,49,0],[180,50,180,54,0],[184,17,184,18,0],[184,19,184,50,0],[184,51,184,52,0],[185,17,185,18,0],[185,19,185,49,0],[185,50,185,51,0],[190,17,190,18,0],[190,19,190,72,0],[190,73,190,74,0],[195,17,195,18,0],[195,19,195,43,0],[195,44,195,45,0],[196,17,196,18,0],[196,19,196,42,0],[196,43,196,44,0],[201,17,201,18,0],[201,19,201,35,0],[201,36,201,37,0],[202,17,202,18,0],[202,19,202,36,0],[202,37,202,38,0],[207,17,207,18,0],[207,19,207,38,0],[207,39,207,40,0],[208,17,208,18,0],[208,19,208,39,0],[208,40,208,41,0],[214,13,214,14,0],[215,17,219,33,0],[220,13,220,14,0],[221,17,221,18,0],[221,19,221,37,0],[221,38,221,39,0],[226,17,226,18,0],[226,19,226,77,0],[226,78,226,79,0],[227,17,227,18,0],[227,19,227,37,0],[227,38,227,39,0],[232,17,232,18,0],[232,19,232,89,0],[232,90,232,91,0],[233,17,233,18,0],[233,19,233,42,0],[233,43,233,44,0],[238,17,238,18,0],[238,19,238,40,0],[238,41,238,42,0],[239,17,239,18,0],[239,19,239,41,0],[239,42,239,43,0],[244,17,244,18,0],[244,19,244,100,0],[244,101,244,102,0],[245,17,245,18,0],[245,19,245,43,0],[245,44,245,45,0],[250,17,250,18,0],[250,19,250,44,0],[250,45,250,46,0],[252,13,252,14,0],[253,17,253,43,0],[254,17,254,42,0],[255,13,255,14,0],[258,31,258,35,0],[258,36,258,40,0],[259,37,259,41,0],[259,42,259,46,0],[263,17,263,18,0],[263,19,263,95,0],[263,96,263,97,0],[264,17,264,18,0],[264,19,264,47,0],[264,48,264,49,0],[267,40,267,44,0],[267,45,267,49,0],[271,17,271,18,0],[271,19,271,108,0],[271,109,271,110,0],[272,17,272,18,0],[272,19,272,47,0],[272,48,272,49,0],[277,17,277,18,0],[277,19,277,66,0],[277,67,277,68,0],[278,17,278,18,0],[278,19,278,40,0],[278,41,278,42,0],[281,31,281,35,0],[281,36,281,40,0],[282,38,282,42,0],[282,43,282,47,0],[286,17,286,18,0],[286,19,286,116,0],[286,117,286,118,0],[287,17,287,18,0],[287,19,287,43,0],[287,44,287,45,0],[290,41,290,45,0],[290,46,290,50,0],[295,9,295,10,0],[296,13,296,42,0],[297,13,297,28,0],[298,13,298,110,0],[299,13,299,108,0],[300,13,300,112,0],[301,13,301,108,0],[302,13,302,108,0],[303,13,303,120,0],[304,13,305,113,0],[306,13,307,114,0],[308,13,310,69,0],[311,13,311,30,0],[312,13,312,78,0],[313,13,313,70,0],[314,9,314,10,0],[317,9,317,10,0],[318,13,318,64,0],[319,13,319,37,0],[320,13,320,49,0],[321,13,321,53,0],[322,13,322,45,0],[323,13,323,47,0],[324,13,324,39,0],[325,13,325,49,0],[326,13,326,43,0],[327,13,327,39,0],[328,13,328,51,0],[329,9,329,10,0],[332,9,332,10,0],[333,13,333,30,0],[334,13,334,30,0],[335,13,335,37,0],[336,13,336,39,0],[337,13,337,45,0],[338,17,338,95,0],[339,18,339,47,0],[340,17,340,92,0],[341,13,341,30,0],[345,13,345,24,0],[346,9,346,10,0],[349,9,349,10,0],[350,13,350,110,0],[351,13,351,14,0],[354,17,354,18,0],[355,21,356,99,0],[357,21,357,63,0],[358,21,358,83,0],[359,21,359,55,0],[360,21,360,42,0],[361,21,362,88,0],[363,21,363,48,0],[364,21,364,46,0],[365,25,365,117,0],[366,21,366,54,0],[367,17,367,18,0],[368,17,368,44,0],[369,17,369,18,0],[370,21,370,51,0],[371,21,371,55,0],[372,17,372,18,0],[373,17,373,76,0],[374,17,374,18,0],[375,21,375,41,0],[376,21,376,42,0],[377,17,377,18,0],[378,13,378,14,0],[379,13,379,38,0],[379,39,379,46,0],[380,13,380,30,0],[381,13,381,91,0],[382,13,382,14,0],[383,17,385,73,0],[386,17,386,64,0],[387,13,387,14,0],[388,18,388,43,0],[389,13,389,29,0],[390,13,390,28,0],[392,13,392,25,0],[393,13,393,14,0],[394,17,394,63,0],[394,64,394,110,0],[395,22,395,65,0],[397,17,397,57,0],[397,58,397,98,0],[398,22,398,59,0],[399,13,399,14,0],[402,13,402,37,0],[403,9,403,10,0],[406,9,406,10,0],[407,13,407,30,0],[408,13,408,31,0],[408,32,408,84,0],[409,9,409,10,0],[412,9,412,10,0],[413,13,413,37,0],[414,13,414,39,0],[415,13,415,95,0],[416,13,416,42,0],[416,43,416,56,0],[417,13,417,66,0],[418,13,418,122,0],[419,13,419,41,0],[420,13,420,32,0],[421,13,422,46,0],[423,13,423,25,0],[424,9,424,10,0],[428,9,428,10,0],[429,13,429,25,0],[430,13,430,39,0],[431,13,431,42,0],[431,43,431,56,0],[433,13,433,46,0],[434,13,434,42,0],[435,13,435,34,0],[436,13,437,38,0],[438,13,438,42,0],[439,13,439,25,0],[440,9,440,10,0],[444,17,444,18,0],[444,19,444,84,0],[444,85,444,86,0],[450,9,450,10,0],[451,13,451,48,0],[452,9,452,10,0],[455,9,455,10,0],[456,13,456,32,0],[457,13,457,109,0],[458,13,458,55,0],[459,13,460,71,0],[461,13,461,34,0],[462,13,462,80,0],[463,13,463,38,0],[464,13,464,33,0],[465,13,465,51,0],[466,13,466,14,0],[467,17,467,48,0],[469,17,469,18,0],[470,21,470,74,0],[471,21,471,117,0],[473,21,473,46,0],[474,21,474,50,0],[475,21,475,22,0],[481,25,482,61,0],[483,25,483,73,0],[484,25,484,65,0],[485,25,485,57,0],[486,25,486,39,0],[487,25,487,46,0],[488,21,488,22,0],[490,21,490,63,0],[491,21,491,71,0],[492,21,492,79,0],[493,21,493,69,0],[494,21,494,113,0],[496,21,496,98,0],[497,21,497,49,0],[498,21,498,41,0],[498,42,498,80,0],[500,21,500,40,0],[500,41,500,71,0],[501,21,501,42,0],[502,21,502,59,0],[503,21,503,40,0],[504,21,504,36,0],[505,21,505,22,0],[507,25,507,26,0],[508,29,508,112,0],[509,29,509,57,0],[510,25,510,26,0],[511,25,511,52,0],[512,25,512,26,0],[513,29,513,83,0],[514,25,514,26,0],[515,25,515,40,0],[515,41,515,90,0],[516,21,516,22,0],[517,21,517,39,0],[518,21,518,48,0],[519,21,519,38,0],[522,21,523,56,0],[524,21,525,34,0],[526,17,526,18,0],[527,17,527,37,0],[528,17,528,18,0],[529,21,529,75,0],[530,17,530,18,0],[532,17,532,104,0],[533,17,533,66,0],[534,13,534,14,0],[535,13,535,49,0],[536,13,536,14,0],[537,17,537,59,0],[539,17,539,18,0],[540,21,540,48,0],[541,21,542,99,0],[543,21,543,74,0],[544,21,544,50,0],[545,21,545,55,0],[546,21,546,42,0],[547,21,548,88,0],[549,21,549,46,0],[550,25,551,49,0],[552,21,552,48,0],[553,21,554,114,0],[555,21,555,47,0],[556,21,556,40,0],[557,17,557,18,0],[558,17,558,37,0],[559,17,559,18,0],[560,21,560,68,0],[561,17,561,18,0],[562,17,562,113,0],[563,17,563,59,0],[564,13,564,14,0],[565,13,565,27,0],[566,9,566,10,0],[569,9,569,10,0],[570,13,570,33,0],[570,34,570,41,0],[571,13,571,20,0],[571,22,571,30,0],[571,31,571,33,0],[571,34,571,46,0],[572,13,572,14,0],[573,17,573,36,0],[574,17,574,18,0],[575,21,575,73,0],[576,17,576,18,0],[577,17,577,38,0],[578,17,578,18,0],[579,21,579,87,0],[580,17,580,18,0],[581,13,581,14,0],[582,9,582,10,0],[585,9,585,10,0],[586,13,586,20,0],[586,22,586,30,0],[586,31,586,33,0],[586,34,586,37,0],[587,13,587,14,0],[588,17,588,82,0],[589,17,589,52,0],[590,13,590,14,0],[591,9,591,10,0],[594,9,594,10,0],[595,13,595,43,0],[596,13,596,53,0],[597,13,597,55,0],[598,13,598,115,0],[599,13,599,30,0],[599,31,599,59,0],[600,13,600,70,0],[601,13,601,48,0],[601,49,601,77,0],[602,18,602,49,0],[603,9,603,10,0],[606,9,606,10,0],[607,13,607,32,0],[608,13,608,37,0],[609,13,609,14,0],[610,17,610,30,0],[613,25,613,89,0],[614,25,614,31,0],[616,25,616,88,0],[617,25,617,31,0],[619,25,619,88,0],[620,25,620,31,0],[622,25,622,93,0],[623,25,623,31,0],[625,25,625,85,0],[626,25,626,31,0],[628,25,628,84,0],[629,25,629,31,0],[631,25,631,84,0],[632,25,632,31,0],[634,25,634,88,0],[635,25,635,31,0],[637,13,637,14,0],[638,13,638,37,0],[639,13,639,14,0],[640,17,640,30,0],[643,25,643,84,0],[644,25,644,31,0],[646,25,646,84,0],[647,25,647,31,0],[649,25,649,85,0],[650,25,650,31,0],[652,25,652,85,0],[653,25,653,31,0],[655,25,655,85,0],[656,25,656,31,0],[658,25,658,84,0],[659,25,659,31,0],[661,25,661,84,0],[662,25,662,31,0],[664,25,664,88,0],[665,25,665,31,0],[667,13,667,14,0],[668,13,668,39,0],[669,13,669,14,0],[670,17,670,30,0],[673,25,673,84,0],[674,25,674,31,0],[676,25,676,84,0],[677,25,677,31,0],[679,25,679,84,0],[680,25,680,31,0],[682,25,682,84,0],[683,25,683,31,0],[685,25,685,88,0],[686,25,686,31,0],[688,25,688,116,0],[689,25,689,31,0],[691,25,691,116,0],[692,25,692,31,0],[694,25,694,115,0],[695,25,695,31,0],[697,25,697,117,0],[698,25,698,31,0],[700,25,700,115,0],[701,25,701,31,0],[703,25,703,115,0],[704,25,704,31,0],[706,25,706,114,0],[707,25,707,31,0],[709,25,709,116,0],[710,25,710,31,0],[712,25,715,52,0],[716,25,716,31,0],[718,25,721,52,0],[722,25,722,31,0],[724,25,727,52,0],[728,25,728,31,0],[730,25,733,52,0],[734,25,734,31,0],[736,25,739,52,0],[740,25,740,31,0],[742,25,742,113,0],[743,25,743,31,0],[745,25,748,52,0],[749,25,749,31,0],[751,25,751,114,0],[752,25,752,31,0],[754,13,754,14,0],[755,13,755,38,0],[756,13,756,14,0],[757,17,757,30,0],[760,25,760,80,0],[761,25,761,31,0],[763,25,763,80,0],[764,25,764,31,0],[766,25,766,84,0],[767,25,767,31,0],[769,25,769,88,0],[770,25,770,31,0],[772,13,772,14,0],[773,13,773,27,0],[774,9,774,10,0],[777,9,777,10,0],[778,13,778,49,0],[779,13,779,54,0],[780,13,780,46,0],[780,47,780,54,0],[781,13,781,30,0],[781,31,781,59,0],[782,13,782,73,0],[783,13,783,44,0],[783,45,783,67,0],[784,18,784,43,0],[785,9,785,10,0],[788,9,788,10,0],[789,13,794,37,0],[795,13,795,71,0],[796,13,797,33,0],[798,13,800,83,0],[801,13,801,41,0],[802,13,802,104,0],[803,13,803,46,0],[804,13,804,81,0],[805,13,805,59,0],[806,13,806,70,0],[807,13,807,42,0],[808,13,808,77,0],[809,13,809,98,0],[810,13,811,57,0],[812,9,812,10,0],[827,9,827,10,0],[828,13,828,42,0],[829,13,829,55,0],[830,13,830,47,0],[831,13,831,61,0],[832,13,832,39,0],[834,9,834,10,0]]);
    </script>
  </body>
</html>