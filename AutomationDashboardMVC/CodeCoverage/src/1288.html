<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Platform UI\Modules\PROJECT\CreateProjects.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core;
using Aurigo.AMP3.Core.AbstractModels;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.DocumentManagementDTO;
using Aurigo.AMP3.LibraryDAC;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectBL;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.TabInjectionDAC;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.DataAccess.Core;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.UserControls;
using Aurigo.Brix.Platform.BusinessLayer.XMLForm;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Brix.Platform.UI.Common.Helpers;
using Aurigo.Common;
using Aurigo.Common.Utility;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.DataBinding;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebDataInput;
using Infragistics.WebUI.WebSchedule;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Xml;

namespace Aurigo.AMP3.ProjectUI
{
    public partial class CreateProjects : BrixPageBase, IWorkflowEnabled, IXMLControl
    {
        public const string CONST_Dropdown_MakeSelectText = &quot;Select One&quot;;

        private readonly ProjectManager blInstance = ProjectManager.Instance;
        private List&lt;Project.AttributeClass&gt; attributeList;
        private string callback;
        private List&lt;Platform&gt; moduleList;
        private BrixTabMasterPage objTabMaster;
        private int projectID;
        private int rid;
        private int uid;
        bool _isBusinessUnitEditAllowed = false;
        private bool _isAdminUser;
        private BrixFormModel model;
        private XMLFormManagerModel managerModel;
        private Dictionary&lt;string, string&gt; _uploadedModuleList;
        private List&lt;string&gt; _ProjectModuleComponents = null;
        private int _projectCalendarID;
        private Project _dtoProject;
        private CalendarCalculationsModel _projectCalendarModel = CalendarCalculationsModel.GetInstance(&quot;PROJECT&quot;);
        private enum EnumChangeType { BeginDate = 0, Days, EndDate }
        private CalendarDetails _calendar = null;

        private string Project_Text
        {
            get
            {
                return LocalizationManager.GetString(&quot;Project&quot;);
            }
        }

        private string ProjectCode_Text
        {
            get
            {
                return LocalizationManager.GetString(&quot;Project Code&quot;);
            }
        }

        private string BusinessUnit_Text
        {
            get
            {
                return LocalizationManager.GetString(&quot;BusinessUnit&quot;);
            }
        }

        private int ProjectID
        {
            get
            {
                if (!string.IsNullOrEmpty(Request.QueryString[&quot;pid&quot;]))
                    return Request.QueryString[&quot;pid&quot;].ToInt32_2();
                else
                    return 0;
            }
        }

        private bool IsNewMode
        {
            get
            {
                return ProjectID == 0;
            }
        }

        private ModeTypes Mode
        {
            get
            {
                ModeTypes mode = ModeTypes.New;
                string qsMode = Request.QueryString[&quot;Mode&quot;];

                Enum.TryParse&lt;ModeTypes&gt;(qsMode, out mode);

                return mode;
            }

        }

        private Project dtoProject
        {
            get
            {
                if (_dtoProject == null &amp;&amp; ProjectID &gt; 0)
                    _dtoProject = blInstance.GetProjectDetails(ProjectID);

                return _dtoProject;
            }
        }

        private Dictionary&lt;string, string&gt; UploadedModuleList
        {
            get
            {
                if (_uploadedModuleList == null)
                    _uploadedModuleList = ModuleManager.Instance.GetModuleList();
                return _uploadedModuleList;
            }
        }

        /// &lt;summary&gt;
        /// Populates the Modules
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateID&quot;&gt;&lt;/param&gt;
        private Dictionary&lt;string, string&gt; activePlatforms = null;

        public global::Infragistics.WebUI.WebSchedule.WebDateChooser wdcStartDate;
        public global::Infragistics.WebUI.WebSchedule.WebDateChooser wdcEndDate;
        public global::Infragistics.WebUI.UltraWebGrid.UltraWebGrid GrdA;
        public global::Infragistics.WebUI.UltraWebGrid.UltraWebGrid grdModulePlatforms;
        public global::Infragistics.WebUI.WebSchedule.WebDateChooser wdcDateCreated;
        //bool _IsSingleProjectMode;

        public BrixFormModel Model
        {
            get { return model; }
            set { model = value; }
        }

        //private bool landMasterExists;
        private string LoadPicker { get; set; }

        /// &lt;summary&gt;
        /// Gets the Integration Cutoff Date
        /// &lt;/summary&gt;
        private DateTime IntegrationCutoffDate
        {
            get { return (DateTime)Session[Constants.APP_IntegrationCutoffDate]; }
        }

        ///// &lt;summary&gt;
        ///// Gets the Single Project Mode
        ///// &lt;/summary&gt;
        //bool IsSingleProjectMode
        //{
        //    get { return _IsSingleProjectMode; }
        //}

        /// &lt;summary&gt;
        /// Gets the Default Record Date
        /// &lt;/summary&gt;
        private DateTime DefaultRecordDate
        {
            get { return (DateTime)Session[Constants.APP_DefaultRecordDate]; }
        }

        private List&lt;string&gt; ProjectModuleComponents
        {
            get
            {
                if (_ProjectModuleComponents == null)
                    _ProjectModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
                return _ProjectModuleComponents;
            }
        }

        #region IWorkflowEnabled Members

        public new string FormInstanceId
        {
            get
            {
                int pid = String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                    ? -1
                    : int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out pid) ? pid : -1;
                return pid.ToString();
            }
        }

        public string FormName
        {
            get { return &quot;XPROJCT&quot;; }
        }

        public string ClientValidationFunction
        {
            get { return &quot;saveAtts()&quot;; }
        }

        protected string _formkey = string.Empty;

        public string FormKey
        {
            get { return _formkey; }
        }

        public bool IsOldWorkflow
        {
            get { return true; }
        }

        public int PID
        {
            get { return Request.QueryString[&quot;PID&quot;].ToInt32_2(); }
        }

        public int ParentModuleId
        {
            get { return 0; }
        }

        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        public string PostCancelRedirectUrl
        {
            get
            {
                if (HttpContext.Current.Request.QueryString[&quot;ReturnUrl&quot;] != null)
                {
                    string returnUrl = Request.QueryString[&quot;ReturnUrl&quot;];
                    return SecurityHelpers.Decrypt_Simple(returnUrl);
                }
                else
                    return
                    BuildURL(
                        (IsProposedProject)
                            ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                            : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, new List&lt;string&gt;());
            }
        }

        public string PostSaveRedirectUrl(string sSavedToken = &quot;&quot;)
        {
            if (HttpContext.Current.Request.QueryString[&quot;ReturnUrl&quot;] != null)
            {
                string returnUrl = Request.QueryString[&quot;ReturnUrl&quot;];
                return SecurityHelpers.Decrypt_Simple(returnUrl);
            }
            else
                return (projectID &gt; 0)
                ? BuildURL(
                    (IsProposedProject)
                        ? &quot;ProjectDetails.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID + &quot;&amp;nt=1&amp;PP=1&amp;Mode=View&quot;
                        : &quot;ProjectDetails.aspx?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + projectID + &quot;&amp;Mode=View&amp;nt=1&quot;,
                    new List&lt;string&gt; { &quot;mode&quot; })
                : BuildURL(
                    (IsProposedProject)
                        ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&amp;PP=1&quot;
                        : &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;nt=1&quot;, new List&lt;string&gt;());
        }

        private string ValidateProjectBeforeSave(DateTime projStartDate, DateTime projEndDate)
        {
            string errorMsg = null;

            // Check whether logged in user is there in selected business unit.
            bool isValidProjectBU = CheckIfUserCreatingOrUpdatingProject_HasAccessToBusinessUnitSelected();

            if (!isValidProjectBU)
                errorMsg = &quot;You do not have permission for creating this {0} under the selected {1}.&quot;.Format2(Project_Text, BusinessUnit_Text);
            else if (CoreModuleComponents.Contains(&quot;EnableProjectPhase&quot;) &amp;&amp; projectID &gt; 0)
            {
                // Validate project dates with project phase, before save.
                DataSet ds = ProjectPhaseManager.Instance.GetMinAndMaxDatesFromProjectPhase(projectID);
                if (ds?.Tables?.Count &gt; 0 &amp;&amp; ds.Tables[0].Rows?.Count &gt; 0)
                {
                    DataRow row = ds.Tables[0].Rows[0];
                    DateTime minStartDate = row[&quot;MinStartDate&quot;].ToMWDateTime();
                    DateTime maxEndDate = row[&quot;MaxEndDate&quot;].ToMWDateTime();

                    if (projStartDate.ToMWDateTime().Date &gt; minStartDate.Date)
                        errorMsg = &quot;Start Date of the Project cannot be after the earliest start date of its phases.&quot;;
                    else if (projEndDate.ToMWDateTime().Date &lt; maxEndDate.Date)
                        errorMsg = &quot;End Date of the Project cannot be before the latest end date of its phases.&quot;;
                }
            }

            return errorMsg;
        }

        public bool SaveHandler(object sender, out string sSavedInstanceToken, out string sErrors, out string sRedirectTo)
        {

            sSavedInstanceToken = &quot;&quot;;
            sErrors = &quot;&quot;;
            sRedirectTo = &quot;&quot;;

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.BeforeSave(model, args);
            if (managerModel == null || args.IsValid)
            {
                try
                {
                    DateTime projStartDateTime = Convert.ToDateTime(wdcStartDate.Value, DateFormatCulture.GetDateFormatCulture()).ToMWUtcDateTime();
                    DateTime projEndDateTime = Convert.ToDateTime(wdcEndDate.Value, DateFormatCulture.GetDateFormatCulture()).ToMWUtcDateTime();

                    sErrors = this.ValidateProjectBeforeSave(projStartDateTime, projEndDateTime);
                    if (!string.IsNullOrEmpty(sErrors))
                        return false;

                    var projDTO = new Project();
                    string[] docMetadataSelectedValue = ddlDocMetadata.SelectedValue.Split(&quot;&amp;&amp;&quot;.ToCharArray());
                    projDTO.ProjectName = txtProjectName.Text;
                    projDTO.ProjectCode = txtProjectCode.Text;
                    projDTO.ProjectDescription = txtDescription.Text.ToString2();

                    if (projectID == 0 || _isBusinessUnitEditAllowed)
                    {
                        if (string.IsNullOrEmpty(radddlBusinessUnitTree.SelectedValue))
                            projDTO.BusinessUnitID = null;
                        else
                            projDTO.BusinessUnitID = radddlBusinessUnitTree.SelectedValue.ToInt32_2();
                    }
                    else
                    {
                        projDTO.BusinessUnitID = (ViewState[&quot;VS_BusinessUnitID&quot;] != null) ? ViewState[&quot;VS_BusinessUnitID&quot;].ToInt32_2() : (int?)null;
                    }

                    if (ddlDocumentTemplate.SelectedIndex &gt;= 0)
                        projDTO.DocumentTemplateID = ddlDocumentTemplate.SelectedValue.ToInt32_2();
                    if (ddlDocMetadata.SelectedIndex &gt;= 0 &amp;&amp; docMetadataSelectedValue.Length &gt;= 2)
                        projDTO.DocumentMetadataID = docMetadataSelectedValue[2].ToInt32_2();
                    else
                        projDTO.DocumentMetadataID = null;

                    projDTO.ProjectID = projectID;
                    projDTO.ProjectTemplateID = (hdnTemplateID.Value != &quot;&quot; &amp;&amp; hdnTemplateID.Value != null)
                        ? Convert.ToInt32(hdnTemplateID.Value, CultureInfo.CurrentCulture)
                        : 0;
                    projDTO.ProjectOwner = ddlOwner.Visible ? ddlOwner.SelectedValue : txtProjectOwner.Text.ToString2();
                    projDTO.ProjectClass = ddlProjectClass.Visible ? ddlProjectClass.SelectedValue : &quot;&quot;;
                    projDTO.ProgramYear = ddlProgramYear.Visible ? ddlProgramYear.SelectedValue : &quot;&quot;;
                    projDTO.ExpenditureCurveID = ddlExpenditureCurve.Visible
                        ? (!string.IsNullOrEmpty(ddlExpenditureCurve.SelectedValue)
                            ? ddlExpenditureCurve.SelectedValue.ToInt32_2()
                            : 0)
                        : 0;
                    projDTO.CalendarType = projDTO.ExpenditureCurveID == 0 ? 0 : 1;
                    projDTO.CalendarDays = (wneContractDays == null)
                        ? 0
                        : (wneContractDays.Value.ToString() == &quot;&quot;) ? 0 : wneContractDays.Value.ToInt32_2();
                    projDTO.ProjectStartDate = projStartDateTime;
                    projDTO.ProjectEndDate = projEndDateTime;
                    projDTO.ProjectCreatedDate = Convert.ToDateTime(wdcDateCreated.Value, DateFormatCulture.GetDateFormatCulture()).ToMWUtcDateTime();
                    //DateTime.ParseExact(lblCreatedDate.Text, Constants.FORMAT_DATE, CultureInfo.InvariantCulture);
                    projDTO.ProjectIsActive = chkIsActive.Checked;
                    if (ddlStatus.SelectedIndex &gt; 0)
                        projDTO.ProjectStatus = Convert.ToInt32(ddlStatus.SelectedItem.Value, CultureInfo.CurrentCulture);
                    projDTO.LandMasterID = (ViewState[&quot;landMasterExists&quot;] != null &amp;&amp;
                                            Convert.ToBoolean(ViewState[&quot;landMasterExists&quot;], CultureInfo.CurrentCulture))
                        ? Convert.ToInt32(ddlLandName.SelectedValue, CultureInfo.CurrentCulture)
                        : 0;
                    projDTO.ProjectMode = (rbIntegration.Checked) ? &#39;I&#39; : &#39;L&#39;;
                    projDTO.ModifiedBy = UserDetail.GetCurrentUserDetail().UserName;
                    projDTO.ModifiedOn = DateTime.UtcNow;
                    decimal Pvalue = 0; //Set Project value
                    if (Decimal.TryParse(TxtProjectValue.Text, out Pvalue))
                        projDTO.ProjectValue = (Convert.ToDecimal(TxtProjectValue.Text));

                    //get modules and platforms from grid
                    var projModules = new List&lt;Platform&gt;();
                    Dictionary&lt;string, string&gt; platformList = blInstance.GetPlatformList();
                    foreach (UltraGridRow grdRow in grdModulePlatforms.Rows)
                    {
                        CellsCollection cells;
                        // 0 - Row Select, 1 - ModuleID, 2 - Module Name
                        if ((cells = grdRow.Cells)[0].Value.ToString2().ToUpper2() != &quot;TRUE&quot;)
                            continue;

                        string moduleID = cells.FromKey(&quot;ModuleID&quot;).Value.ToString2();

                        for (int i = 3; i &lt; cells.Count; i++)
                        {
                            if (cells[i].Value.ToString2().ToUpper2() != &quot;TRUE&quot;)
                                continue;

                            string platformName = cells[i].Column.BaseColumnName;
                            foreach (var iaKey in platformList)
                            {
                                if (iaKey.Value == platformName)
                                {
                                    projModules.Add(new Platform(moduleID, iaKey.Key));
                                    break;
                                }
                            }
                        }
                    }

                    projDTO.ProjectModules = projModules;
                    projDTO.AXCompanyName = Convert.ToString(Session[Constants.EIS_ADDITIONAL_INFO],
                        CultureInfo.CurrentCulture);
                    string[] atts = hdnAttributes.Value.Split(&#39;|&#39;);
                    var listAttributes = new Dictionary&lt;string, string&gt;();

                    foreach (UltraGridRow grdRow in GrdA.Rows)
                    {
                        if (grdRow.Cells[3].Value != null)
                        {
                            var attribute = new Project.AttributeClass
                            {
                                AttributeId =
                                    int.Parse(Convert.ToString(grdRow.Cells[3].Value, CultureInfo.CurrentCulture),
                                        CultureInfo.CurrentCulture),
                                AttributeNotes = Convert.ToString(grdRow.Cells[2].Value, CultureInfo.CurrentCulture),
                                AttributeValue = Convert.ToString(grdRow.Cells[1].Value, CultureInfo.CurrentCulture)
                            };
                            projDTO.ProjectAttributesList.Add(attribute);
                        }
                    }
                    //Set the Company currency as Default project Currency
                    projDTO.ERPCurrency = LocalizationManager.GetModuleCurrency(&quot;LIBRARY&quot;, null,
                        Session[Constants.EIS_ADDITIONAL_INFO].ToString2());
                    objTabMaster.PreSaveCheck();

                    int rtnValue = 0;
                    bool NewProject = (projectID == 0);
                    if(!NewProject)
                    {
                        if (!blInstance.CheckConcurrency(projectID, Timestamp))
                        {
                            ShowConcurrencyMessage();
                            return false;
                        }
                    }
                    if (NewProject &amp;&amp; Regex.IsMatch(txtProjectCode.Text.Trim(), @&quot;[\^|]&quot;))
                    {
                        ShowError(Project_Text + &quot; Code cannot contain the following characters: ^ |&quot;);
                        return false;
                    }
                    //if (NewProject)
                    projDTO.DocumentListID =
                        DocumentManager.Instance.CreateDocumentList(
                            &quot;{0}-{1}&quot;.Format2(projDTO.ProjectName, projDTO.ProjectCode), Project_Text + &quot; Documents&quot;);
                    rtnValue = !NewProject
                        ? blInstance.UpdateProject(projDTO, uid, rid)
                        : blInstance.CreateProject(projDTO, uid, rid);

                    if (rtnValue &lt; 1)
                    {
                        switch (rtnValue)
                        {
                            case -1:
                                ShowError(MessageResourceManager.GetString(&quot;W_PROJECT_NAME_ALREADY_EXISTS&quot;,
                                            Enumerations.MessageType.WarningMessage));
                                break;
                            case -2:
                                ShowError(MessageResourceManager.GetString(&quot;W_PROJECT_CODE_NAME_ALREADY_EXISTS&quot;,
                                            Enumerations.MessageType.WarningMessage));
                                break;
                            case -3:
                                ShowError(MessageResourceManager.GetString(&quot;E_PROJECT_COPYING_PROJECT&quot;,
                                            Enumerations.MessageType.ErrorMessage));
                                break;
                        }
                        return false;
                    }
                    else
                    {
                        _formkey = string.Format(&quot;{0} Name : {1}&quot;, Project_Text, projDTO.ProjectName);
                        sSavedInstanceToken = rtnValue.ToString();
                        projDTO.ProjectID = projectID = sSavedInstanceToken.ToInt32_2();

                        Dictionary&lt;string, Type&gt; dicObj = AfterSaveRecordModel.GetModelObjects();

                        Logger.Log(AMP3.Resources.MessageResources.Enumerations.LogType.Information,
                            dicObj.Count.ToString(), &quot;PROJECT&quot;);

                        foreach (KeyValuePair&lt;string, Type&gt; kvp in dicObj)
                        {
                            Logger.Log(AMP3.Resources.MessageResources.Enumerations.LogType.Information,
                                &quot;KVP Key -&quot; + kvp.Key, &quot;PROJECT&quot;);
                            var Savemodel = AfterSaveRecordModel.GetInstance(kvp.Key);
                            if (Savemodel != null)
                                Savemodel.SaveDetails(projDTO, this.Page, NewProject ? &quot;New&quot; : &quot;Edit&quot;, &quot;SAVE_PROJECT&quot;);
                        }

                        //if (NewProject)
                        //{
                        DocumentManager.Instance.AddFolder(new Folder()
                        {
                            ParentId = 0,
                            FolderName = &quot;Documents&quot;,
                            FolderDesc = Project_Text + &quot; Documents&quot;,
                            ModuleId = &quot;PROJECT&quot;,
                            InstanceId = projectID.ToString(),
                            ListID = projDTO.DocumentListID,
                            ListPath = &quot;&quot;,
                            CreateSharePointFolder = false
                        });
                        //}
                        Folder ProjFolder = DocumentManager.Instance.GetInstanceRootFolder(projectID, &quot;PROJECT&quot;);
                        if (!NewProject)
                            DocumentManager.Instance.RenameDocumentList(ProjFolder.ListID,
                                &quot;{0}-{1}&quot;.Format2(projDTO.ProjectName, projDTO.ProjectCode), Project_Text + &quot; Documents&quot;);
                        List&lt;string&gt; lst = new List&lt;string&gt;() { &quot;CONTMGT&quot;, &quot;ESTMATE&quot;, &quot;LANDMGT&quot;, &quot;BDGMGMT&quot; };
                        foreach (Platform p in projModules)
                            if (!lst.Contains(p.ModuleId))
                                DocumentManager.Instance.CreateFolderForModule(p.ModuleId, &quot;PROJECT&quot;, projectID);

                        (projAttachments).SaveAttachments(sSavedInstanceToken, &quot;PROJECT&quot;, uid,
                            UserDetail.GetCurrentUserDetail().UserName, Project_Text + &quot; Documents&quot;);
                        if (rtnValue &gt; 0)
                        {
                            objTabMaster.AMP3ObjectId = rtnValue;
                            objTabMaster.MasterSave(GetPageData());
                            if (objTabMaster.ERPTabPageData != null &amp;&amp; objTabMaster.ERPTabPageData.Count &gt; 0 &amp;&amp;
                                IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
                            {
                                projDTO.ERPCurrency = objTabMaster.ERPTabPageData[0].Value.ToString2();
                                projDTO.ProjectID = rtnValue;
                                blInstance.UpdateProject(projDTO, uid, rid);
                            }

                            // if the project was created successfully then instantiate the document tree for the project based
                            // on the selected document template
                            if (ddlDocumentTemplate.SelectedIndex &gt; 0)
                            {
                                int DocTemplateID;
                                if (int.TryParse(ddlDocumentTemplate.Items[ddlDocumentTemplate.SelectedIndex].Value,
                                    out DocTemplateID))
                                    if (DocTemplateID &gt; 0)
                                        DocumentManager.Instance.InstantiateDocumentTemplate(ProjFolder, DocTemplateID);
                            }

                            //if the project is created, copy the calendar
                            if (projDTO.ExpenditureCurveID &gt; 0)
                            {
                                ProjectManager.Instance.CopyCalendarFromLibrary(projDTO.ProjectID, projDTO.ExpenditureCurveID, projDTO.ModifiedBy);
                            }

                            //If the project is created and if a document metadata is selected, then copy the xml from the Form builder folder to the 
                            // project folder under Modules/PROJECT/XMLControls/

                            if (ddlDocMetadata.Enabled)
                            {
                                if (ddlDocMetadata.SelectedIndex &gt; 0)
                                {
                                    string selectedMetadata = docMetadataSelectedValue[0];
                                    string filePath = HttpRuntime.BinDirectory + &quot;../Modules/FRMBLDR/XMLForms/&quot; +
                                                      ConnectionHelper.GetCurrentCompany() + &quot;XF&quot; + selectedMetadata +
                                                      &quot;.xml&quot;;
                                    XMLFileIO.Instance.ConvertStreamToFile(
                                        XMLFileIO.Instance.GetXML(selectedMetadata, selectedMetadata + &quot;.xml&quot;, XMLType.Control, true),
                                        filePath);

                                    bool fileExists = File.Exists(filePath);
                                    if (fileExists)
                                    {
                                        string projId = projectID.ToString(&quot;D4&quot;);
                                        XMLFileIO.Instance.StoreXML(&quot;PROJECT&quot;, filePath, &quot;PRJ&quot; + projId + &quot;.xml&quot;, XMLType.Control, false);
                                        File.Delete(filePath);
                                        //string destPath = DeleteXMLControl(projId);

                                        //File.Copy(filePath, destPath);
                                    }
                                    //check any folderMapping exists for selected metadata, if so copy those also for the project

                                    DataTable dtFolderMapping = DocumentManager.Instance.GetFolderMappingForMD(selectedMetadata);

                                    //check any folderRules exists for selected metadata, if so copy those also for the project

                                    DataTable dtFolderRules = DocumentManager.Instance.GetFolderRulesForMD(selectedMetadata);
                                }
                                else
                                {
                                    string projId = projectID.ToString(&quot;D4&quot;);
                                    XMLFileIO.Instance.DeleteXML(&quot;PROJECT&quot;, &quot;PRJ&quot; + projId + &quot;.xml&quot;, XMLType.Control, false);
                                    //DeleteXMLControl(projId);
                                }
                            }
                        }
                    }
                    if (model != null &amp;&amp; model.form != null)
                        model.form.instanceID = projectID.ToString();

                    if (managerModel != null)
                        managerModel.AfterSave(model, args);

                    try
                    {
                        //Bugfix: clear the cache of the project name so that bread crumb is updated appropriately from last modified name
                        string cacheKey = RedisKeyConstants.ProjectName + PID; // string.Format(&quot;PROJECT_NAME_{0}&quot;, PID);
                        CacheProvider.CacheBroker.Remove(cacheKey, regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
                        //cache was getting set from 
                    }
                    catch
                    {
                        //no need to do anything if cache clearing failed
                    }
                    
                }

                catch (Exception ex)
                {
                    sErrors = ex.Message;

                    Logger.Log(&quot;CreateProject&quot;, ex);

                    throw new Exception(ex.Message);
                }
                return true;
            }
            else
            {
                sSavedInstanceToken = &quot;-1&quot;;
                sErrors = args.ErrorMessage;
                var ex = new Exception(sErrors);

                Logger.Log(&quot;CreateProject&quot;, ex);
                throw ex;
            }
        }

        public void CancelHandler(object sender, bool bAfterSave, out string sRedirectTo)
        {
            sRedirectTo = &quot;&quot;;
            //if 
            //if hdnMode.Value.Equals(ModeTypes.New.ToString2()))
            return;
        }

        #endregion

        private bool CheckIfUserCreatingOrUpdatingProject_HasAccessToBusinessUnitSelected()
        {
            if (string.IsNullOrEmpty(radddlBusinessUnitTree.SelectedValue))
                return true;

            int selectedBusinessUnitId = radddlBusinessUnitTree.SelectedValue.ToInt32_2();
            int userId = UserDetail.GetCurrentUserDetail().UID.ToInt32_2();

            bool hasPermission = ProjectManager.Instance.CheckIfUserCreatingOrUpdatingProject_HasAccessToBusinessUnitSelected(selectedBusinessUnitId, userId);

            return hasPermission;
        }

        #region Calendar
        private void SetContractTimeLabels()
        {
            if (ddlExpenditureCurve.SelectedIndex &gt; 0)
                txtDays.Text = &quot;Working Days :&quot;;
            else
                txtDays.Text = &quot;Calendar Days :&quot;;
        }

        protected void rblContractTime_SelectedIndexChanged(object sender, EventArgs e)
        {
            SetContractTimeLabels();
            ChangeEndDate(EnumChangeType.BeginDate);
        }

        protected void ddlExpenditureCurve_SelectedIndexChanged(object sender, EventArgs e)
        {
            _calendar = null;

            SetContractTimeLabels();

            ChangeEndDate(EnumChangeType.BeginDate);
        }

        protected void wneContractDays_ValueChange(object sender, ValueChangeEventArgs e)
        {
            if (Request.Form[&quot;__EVENTTARGET&quot;].EndsWith(&quot;wneContractDays&quot;))
                ChangeEndDate(EnumChangeType.Days);
        }

        private void ChangeEndDate(EnumChangeType changeType)
        {
            if (changeType == EnumChangeType.Days)
                return;//To avoid endless recursion;

            DateTime wdcStartDate_Value;
            bool is_wdcStartDateValid = TryGetValidDateTime(wdcStartDate.Value, out wdcStartDate_Value);

            DateTime wdcEndDate_Value;
            bool is_wdcEndDateValid = TryGetValidDateTime(wdcEndDate.Value, out wdcEndDate_Value);

            #region Set Other Validations

            if (is_wdcStartDateValid)
                wdcEndDate.MinDate = wdcStartDate_Value;

            #endregion Set Other Validations

            #region Prepare calendar
            CalendarDetails calendar = null;

            if ((IsEdit || IsView))
                calendar = GetCalendar(ProjectID);
            else
                calendar = GetCalendar(0);

            #endregion Prepare calendar

            wneContractDays.Value = _projectCalendarModel.GetWorkingDaysCount(wdcStartDate_Value, wdcEndDate_Value, calendar);
        }

        private CalendarDetails GetCalendar(int projectID)
        {
            bool? _IsLibraryCalendar = null;
            bool hasCalendarChanged = true;

            if (ddlExpenditureCurve.Items.Count &gt; 0 &amp;&amp; ddlExpenditureCurve.SelectedIndex &gt;= 0 &amp;&amp; !string.IsNullOrEmpty(ddlExpenditureCurve.SelectedValue))
                hasCalendarChanged = ddlExpenditureCurve.SelectedValue.ToInt32_2() != _projectCalendarID;

            if (_calendar == null || hasCalendarChanged)
            {
                if (IsEdit || IsView)
                {
                    _calendar = ProjectManager.Instance.GetCalendarDetailsFromProject(projectID);

                    _calendar.ProjectStartDate = Convert.ToDateTime(wdcStartDate.Value);
                    _calendar.ProjectEndDate = Convert.ToDateTime(wdcEndDate.Value);
                    _calendar.Days = wneContractDays.Value.ToInt32_2();

                    _IsLibraryCalendar = (_calendar.ID == 0);
                }

                if ((IsNew || (_calendar != null &amp;&amp; _calendar.ID == 0) || hasCalendarChanged) &amp;&amp; ddlExpenditureCurve.SelectedIndex &gt;= 0)
                {
                    _calendar = _projectCalendarModel.GetLibraryCalendarDetails(ddlExpenditureCurve.SelectedValue == &quot;&quot; ? 0 : ddlExpenditureCurve.SelectedValue.ToInt32_2());
                    _IsLibraryCalendar = true;
                }
            }

            return _calendar;
        }

        private bool TryGetValidDateTime(object dtValue, out DateTime validDateTime)
        {
            validDateTime = DateTime.MinValue;
            try
            {
                if (dtValue is DateTime)
                {
                    validDateTime = (DateTime)dtValue;
                    return true;
                }
                else
                {
                    validDateTime = dtValue.ToString().ToDateTime_MWCulture();
                    return true;
                }
            }
            catch
            {
                return false;
            }
        }

        protected void dtBeginDate_ValueChanged(object sender, WebDateChooser.WebDateChooserEventArgs e)
        {
            CalendarDetails calendar;
            if ((IsEdit || IsView))
                calendar = GetCalendar(ProjectID);
            else
                calendar = GetCalendar(0);

            DateTime selectedDate = wdcStartDate.Value.ToDateTime_MWCulture();

            ChangeEndDate(EnumChangeType.BeginDate);
        }

        protected void dtEndDate_ValueChanged(object sender, WebDateChooser.WebDateChooserEventArgs e)
        {
            CalendarDetails calendar;
            if ((IsEdit || IsView))
                calendar = GetCalendar(ProjectID);
            else
                calendar = GetCalendar(0);

            DateTime selectedDate = wdcEndDate.Value.ToDateTime_MWCulture();

            ChangeEndDate(EnumChangeType.EndDate);
        }
        #endregion

        private static string DeleteXMLControl(string projId)
        {
            if (!Directory.Exists(HttpRuntime.BinDirectory + &quot;../Modules/PROJECT/XMLControls&quot;))
                Directory.CreateDirectory(HttpRuntime.BinDirectory + &quot;../Modules/PROJECT/XMLControls&quot;);

            string destPath = HttpRuntime.BinDirectory + &quot;../Modules/PROJECT/XMLControls/PRJ&quot; + projId + &quot;.xml&quot;;

            if (File.Exists(destPath))
                File.Delete(destPath);

            return destPath;
        }

        #region IXMLControl Members

        public object[] ParentFormInstanceID
        {
            get
            {
                return new object[] { Request.QueryString[&quot;PID&quot;] == null ? 0 : Request.QueryString[&quot;PID&quot;].ToInt32_2() };
            }
        }

        public HtmlGenericControl XMLContainterDiv
        {
            get { return additionaldiv; }
            set { }
        }

        public void HandleInjectionSaveException(object model, Exception ex, string parentFormInstanceId)
        {
            try
            {
                if (managerModel != null)
                    managerModel.HandleInjectionSaveException((model as BrixFormModel), ex, parentFormInstanceId);
            }
            catch (Exception ex1)
            {
                throw ex1;
            }
        }


        public void HandleInjectionAfterSave(object model, string parentFormInstanceId)
        {
            try
            {
                if (managerModel != null)
                    managerModel.HandleInjectionAfterSave((model as BrixFormModel), parentFormInstanceId);
            }
            catch (Exception ex1)
            {
                throw ex1;
            }
        }

        #endregion

        public override void InclueScriptAndStyleFiles()
        {
            base.InclueScriptAndStyleFiles();
            RegisterClientScriptInclude(&quot;~/Scripts/projectCreate.js&quot;);

        }
        protected override void OnPreInit(EventArgs e)
        {
            try
            {
                objTabMaster = (base.Master as BrixTabMasterPage);
                objTabMaster.AMP3PageName = TabEnabledPages.CreateProject;
                objTabMaster.Mode = PageMode.Edit;
                objTabMaster.AMP3ParentObjectId = null;
                objTabMaster.AMP3ParentObjectType = AMP3Object.UNKNOWN;
                objTabMaster.AMP3ObjectType = AMP3Object.PROJECT;
                objTabMaster.AMP3ObjectId = Convert.ToInt32(Request[Constants.QRY_PROJECTID], CultureInfo.CurrentCulture);
                objTabMaster.ERPPageData = GetPageData();
                base.OnPreInit(e);

                SetManagerModel();
                if (managerModel != null)
                    managerModel.OnPreInit(model, new XmlFormArgs());

            }
            catch (Exception ex)
            {
                lblException.Text = ex.StackTrace;
            }
        }

        protected override void OnInit(EventArgs e)
        {
            // set the list of permissions to be checked.
            if (IsNewMode)
                PermissionsToCheck.Add(Constants.MODFEAT_CREATE);
            else
                PermissionsToCheck.Add(Constants.MODFEAT_EDIT);
            PermissionsToCheck.Add(Constants.MODFEAT_VISIBILITY);

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnInit(model, args);
            ShowRedirectConfirm = true;
            base.OnInit(e);

            TxtProjectValue.HorizontalAlign = HorizontalAlign.Right;

            if (!UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                trProgramYear.Visible = false;

            UserDetail dtUser = UserDetail.GetCurrentUserDetail();
            if (dtUser != null)
            {
                if (int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out projectID))
                    ProjectManager.Instance.AddRecentProject(projectID, dtUser.UID);
            }

            // Though these settings are not required, after replacing ToString() with ToString_MWCulture()
            // but to be on safer side keeping this fix as well
            wdcEndDate.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
            wdcStartDate.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
            wdcDateCreated.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();

        }

        private void SetManagerModel()
        {
            model = BrixFormModel.GetInstance(&quot;XPROJCT&quot;, &quot;XPROJCT&quot;, Request, Response);
            if (null != model &amp;&amp; null != model.form)
            {
                model.form.GetHostValue += new Brix.Platform.BusinessLayer.XMLForm.GetVal(form_GetHostValue);
                model.form.GetHostGridValue +=
                    new Brix.Platform.BusinessLayer.XMLForm.GetValFromGrid(form_GetHostGridValue);
                model.form.SetHostValue += new Brix.Platform.BusinessLayer.XMLForm.SetVal(form_SetHostValue);
                model.form.SetHostGridValue +=
                    new Brix.Platform.BusinessLayer.XMLForm.SetValInGrid(form_SetHostGridValue);
                if (!string.IsNullOrEmpty(model.form.ManagerDLL) &amp;&amp; !string.IsNullOrEmpty(model.form.FormManagerClass))
                {
                    managerModel = AMP3InterfaceFactory.GetInstance&lt;XMLFormManagerModel&gt;(model.form.ManagerDLL,
                        model.form.FormManagerClass);
                    // managerModel.PageViewState = ViewState;
                }
            }
        }

        object form_GetHostValue(string ctrlName, string fieldName, out string datatype, out string errors)
        {
            datatype = null;
            errors = null;
            string strKey = ctrlName.ToLower();
            switch (strKey)
            {
                //case names should correspond to names used in project template/details form on which workflow is defined
                case &quot;projectname&quot;:
                    return txtProjectName.Text;
                case &quot;projectid&quot;:
                    return hdnProjectID.Value;
                case &quot;projectcode&quot;:
                    return txtProjectCode.Text;
                case &quot;description&quot;:
                    return txtDescription.Text;
                case &quot;templateid&quot;:
                    return hdnTemplateID.Value;
                case &quot;owner&quot;:
                    return txtProjectOwner.Text;
                case &quot;startdate&quot;:
                    return wdcStartDate.Text;
                case &quot;enddate&quot;:
                    return wdcEndDate.Text;
                case &quot;createdate&quot;:
                    return wdcDateCreated.Text;
                case &quot;assetcategorydg&quot;:
                    ControlContainer cc = xmlInjection.form.GetContainer(&quot;AssetCategoryDG&quot;);
                    return null == cc || cc.ControlReference.Count &lt; 1 ? null : cc.ControlReference[0];
                default:
                    return null;
            }
        }

        object form_GetHostGridValue(string gridName, string fieldName, string instance, string pid, string parentid,
            string parentmodule, out string datatype, out string errors)
        {
            datatype = null;
            errors = null;
            object val = null;
            if (string.IsNullOrEmpty(gridName)) return null;
            if (gridName.ToLower() == &quot;dymgrdprojectextention&quot;)
            {
                val = xmlInjection.form.GetControl(fieldName).GetServerValue();
            }
            return val;
        }

        bool form_SetHostValue(string gridName, string fieldName, string datatype, object val, out string errors)
        {
            errors = null;
            string strKey = gridName.ToLower();
            switch (strKey)
            {
                //case names should correspond to names used in project template/details form on which workflow is defined
                case &quot;projectname&quot;:
                    txtProjectName.Text = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;projectid&quot;:
                    hdnProjectID.Value = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;projectcode&quot;:
                    txtProjectCode.Text = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;description&quot;:
                    txtDescription.Text = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;templateid&quot;:
                    hdnTemplateID.Value = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;owner&quot;:
                    txtProjectOwner.Text = null == val ? &quot;&quot; : val.ToString();
                    break;
                case &quot;startdate&quot;:
                    wdcStartDate.Value = null == val ? &quot;&quot; : val.ToString_MWCulture();
                    break;
                case &quot;enddate&quot;:
                    wdcEndDate.Value = null == val ? &quot;&quot; : val.ToString_MWCulture();
                    break;
                case &quot;createdate&quot;:
                    wdcDateCreated.Value = null == val ? &quot;&quot; : val.ToString_MWCulture();
                    break;
                case &quot;documentmetadata&quot;:
                    if (!string.IsNullOrEmpty(val.ToString()))
                    {
                        ddlDocMetadata.Text = val.ToString();
                        ddlDocMetadata.SelectedValue = val.ToString();
                    }
                    break;
                case &quot;documenttemplate&quot;:
                    if (!string.IsNullOrEmpty(val.ToString()))
                    {
                        ddlDocumentTemplate.Text = val.ToString();
                        ddlDocumentTemplate.SelectedValue = val.ToString();
                    }
                    break;
                case &quot;isactive&quot;:
                    chkIsActive.Checked = null == val ? false : val.ToString().ToLower() == &quot;true&quot;;
                    break;
                default:
                    return false;
            }
            return true;
        }

        bool form_SetHostGridValue(string gridName, string fieldName, string instance, string pid, string parentid,
            string parentmodule, string datatype, object val, out string errors)
        {
            errors = null;
            bool bIsSet = false;
            if (gridName.ToLower() == &quot;injection&quot; || gridName.ToLower() == &quot;dymgrdprojectextention&quot;)
            {
                xmlInjection.form.GetControl(fieldName).SetServerValue(val);
                bIsSet = true;
            }
            return bIsSet;
        }

        private void ApplyFormattoWne(WebNumericEdit wne, String format)
        {
            int DecimalLength = format.Length -
                                (format.LastIndexOf(&#39;.&#39;) == -1 ? format.Length - 1 : format.LastIndexOf(&#39;.&#39;)) - 1;

            wne.MinDecimalPlaces = (MinDecimalPlaces)(Enum.ToObject(typeof(MinDecimalPlaces), DecimalLength));
        }

        /// &lt;summary&gt;
        /// Page load
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack &amp;&amp; dtoProject != null)
            {
                Timestamp = dtoProject.Timestamp;
            }

            bool isProjectModeCheckConditionCodeExecuted = false;
            try
            {
                UserDetail userDetail = UserDetail.GetCurrentUserDetail();
                wneContractDays.ReadOnly = true;
                UIHelper.DisableRoleSelection(Page);

                //wdcEndDate.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
                //wdcStartDate.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();
                //wdcDateCreated.CalendarLayout.Culture = DateFormatCulture.GetDateFormatCulture();

                txtProjectName.Focus();
                if (!String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                    &amp;&amp; !int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out projectID)
                    )
                {
                    UIHelper.RedirectURL(&quot;Error loading the requested page.&quot;,
                        (IsProposedProject)
                            ? ResolveUrl(Constants.URL_PROJECTS) + &quot;&amp;PP=1&quot;
                            : ResolveUrl(Constants.URL_PROJECTS), null, Context);
                }

                //setting default button for the page
                var myForm = (HtmlForm)Page.Master.Master.FindControl(&quot;form1&quot;);
                myForm.DefaultButton = btnSave.UniqueID;
                rid = userDetail.RID;
                uid = userDetail.UID;

                _isAdminUser = UserManager.Instance.IsUserAdministrator(uid);

                //For project works, Integration Date &amp; Project mode are made hidden
                List&lt;string&gt; components =
                    ModuleManagementBL.ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
                if (!components.Contains(&quot;ShowProjectAttributes&quot;))
                {
                    trAttributes.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                    divAttributesGrid.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                }

                if (!components.Contains(&quot;IntegrationDateMode&quot;))
                    trIntegDateMode.Style.Add(&quot;display&quot;, &quot;none&quot;);

                _isBusinessUnitEditAllowed = this.IsBusinessUnitEditable();

                if (ProjectID &gt; 0)
                {
                    _projectCalendarID = dtoProject.ExpenditureCurveID;
                }

                if (!IsPostBack)
                {
                    CheckAndLoadLANDMGTDetails();

                    //Checking - Land Management Exists or Not
                    var IsLandManagementEnabled =
                        ComponentHelper.Instance.ExecuteScalar(
                            &quot;select CASE WHEN IsActive=1 THEN &#39;1&#39; ELSE &#39;0&#39; END IsLandEnabled from MODMGMTModules where ModuleID=&#39;LANDMGT&#39;&quot;);
                    var isPlanningModuleEnabled =
                        ComponentHelper.Instance.ExecuteScalar(
                            &quot;select CASE WHEN IsActive=1 THEN &#39;1&#39; ELSE &#39;0&#39; END IsPlanningEnabled from MODMGMTModules where ModuleID=&#39;PLANING&#39;&quot;);
                    if (IsLandManagementEnabled != null &amp;&amp; IsLandManagementEnabled.ToString() == &quot;1&quot; &amp;&amp; isPlanningModuleEnabled != null &amp;&amp; isPlanningModuleEnabled.ToString() == &quot;0&quot;)
                        //This is Product feature so checking for planning module exists or not - Not Required
                        LoadLandGrid();
                    else
                    {
                        trLandGrid.Style.Add(&quot;display&quot;, &quot;none&quot;);
                        trLandExpand.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    }

                    // fill up the document template list
                    FillDocTemplateList();

                    FillDocMetadataList();

                    //FillBusinessUnitData();

                    hdnTempAttStatus.Value = &quot;0&quot;;
                    LoadDefaults();
                    hdnStartDateConstraint.Value =
                        MessageResourceManager.GetString(&quot;W_PROJECT_START_DATE_CANNOT_PRECEDE_CREATE_DATE&quot;,
                            Enumerations.MessageType.WarningMessage);
                    hdnEndDateConstraint.Value =
                        MessageResourceManager.GetString(&quot;W_PROJECT_END_DATE_CANNOT_PRECEDE_START_DATE&quot;,
                            Enumerations.MessageType.WarningMessage);

                    var featurelist = (List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS];

                    if (projectID &gt; 0)
                    {
                        if (!featurelist.Contains(ProjectConstants.MODFEAT_EDIT))
                        {
                            UIHelper.RedirectURL(
                                &quot;The current role does not have the required permissions to view this page.&quot;,
                                ResolveUrl(Constants.URL_ENTERPRISE), null, Context);
                        }
                        Page.Title = ProjectConstants.CONST_TITLE;
                        EditProject(projectID);

                        //load the business unit details for this Existing project
                        SetBusinessUnitControlAndFillData(_isBusinessUnitEditAllowed, dtoProject);
                        // ViewState[&quot;VS_BusinessUnitID&quot;] = projectDto.BusinessUnitID;

                        //Now set the default 
                        if (_isBusinessUnitEditAllowed)
                        {
                            if (dtoProject.BusinessUnitID == null)
                                radddlBusinessUnitTree.SelectedValue = string.Empty;
                            else
                                radddlBusinessUnitTree.SelectedValue = dtoProject.BusinessUnitID.ToString2();
                        }

                        PageTitle = ProjectConstants.CONST_EDITPROJ;
                        ViewState[&quot;PageTitleValue&quot;] = PageTitle;

                        //TODO: Remove dependency of project on budget estimate
                        if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                        {
                            //Set Project Value
                            Hashtable GetPValue = new Hashtable();
                            GetPValue = blInstance.GetProjectValue(projectID);
                            ApplyFormattoWne(TxtProjectValue, AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE);
                            foreach (DictionaryEntry entry in GetPValue)
                            {
                                TxtProjectValue.Text =
                                    entry.Value.ToDecimal2()
                                        .ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                                            CultureInfo.CurrentCulture);
                                if (entry.Key.ToString2() == &quot;1&quot;) //Budget has been approved
                                    TxtProjectValue.ReadOnly = true;
                            }
                        }

                        string errDocuSign = string.Empty;
                        if (Session[&quot;DocuSignErr&quot;] != null)
                            errDocuSign = Session[&quot;DocuSignErr&quot;].ToString();

                        if (!string.IsNullOrEmpty(errDocuSign))
                        {
                            ShowError(errDocuSign);
                            Session.Remove(&quot;DocuSignErr&quot;);
                        }
                    }


                    else // Create Project 
                    {
                        if (!featurelist.Contains(ProjectConstants.MODFEAT_CREATE))
                        {
                            UIHelper.RedirectURL(
                                &quot;The current role does not have the required permissions to view this page.&quot;,
                                ResolveUrl(Constants.URL_ENTERPRISE), null, Context);
                        }

                        //New project so load all business unit
                        SetBusinessUnitControlAndFillData(_isBusinessUnitEditAllowed, projectDto: null);

                        Page.Title = ProjectConstants.CONST_CREATETITLE;
                        PageTitle = ProjectConstants.CONST_NEWPROJ;
                        ViewState[&quot;PageTitleValue&quot;] = PageTitle;
                      
                        chkIsActive.Checked = true;
                        if (components.Contains(&quot;ShowOwnerDropdown&quot;))
                        {
                            FillOwnerList(string.Empty);
                        }

                        //KK: Fix for crash for FillExpenditureCurve.  
                        // ToDo: This needs to move out of here
                        if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                        {
                            FillProgramYear(string.Empty);
                            FillProjectClass(string.Empty, 0);
                        }

                        FillCalendarList(0);
                    }


                    chkIsActive.Enabled = featurelist.Contains(ProjectConstants.MODFEAT_ACTIVATE);
                    LoadAttachments();
                    //LinksUserControl.SetInstanceAndType(projectID.ToString2(), ProjectConstants.MODID_PROJECT);
                    //((HiddenField)projAttachments.FindControl(&quot;hdnFileFilter&quot;)).Value = &quot;image&quot;;

                    if (hdnTemplateChecked.Value.ToLower2().Equals(&quot;no&quot;))
                    {
                        PopulateAttributesGrid(null);
                        PopulateModulesGrid(null);
                    }
                    if (projectID &lt;= 0)
                        foreach (UltraGridRow row in grdModulePlatforms.Rows)
                            row.Cells.FromKey(&quot;To&quot;).Value = true;

                    lblIntegrationCutoffDate.Text = (IntegrationCutoffDate.AddDays(-1) == DateTime.MinValue)
                        ? &quot;&quot;
                        : Session[Constants.APP_IntegrationCutoffDate].ToDateTime_MWCulture().ToMWDateTime().
                            ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                    if (!featurelist.Contains(&quot;PROJPROJECTMODE&quot;) || DefaultRecordDate == DateTime.MinValue)
                    {
                        rbIntegration.Enabled = rbLive.Enabled = false;
                        trIntegDateMode.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    }
                    if (rbIntegration.Checked)
                    {
                        wdcDateCreated.MaxDate = wdcStartDate.MaxDate = IntegrationCutoffDate.AddDays(-1).ToMWDateTime();
                    }

                    isProjectModeCheckConditionCodeExecuted = true;

                    // Fixed Bug - 123910 - Multi contract Mode:Forecast calendar is not showing up for the project(Showing irrespective of condition)
                    ////bool hideProjectTree = (ConfigurationManager.AppSettings[&quot;HideProjectTree&quot;] ?? &quot;false&quot;).ToBoolean2();
                    ////bool multiContracts = (ConfigurationManager.AppSettings[&quot;EPSModeMultiple&quot;] ?? &quot;OFF&quot;).ToUpper2() == &quot;ON&quot;;
                    ////_IsSingleProjectMode = (hideProjectTree &amp;&amp; !multiContracts);
                    //if (!AMP3ApplicationSettings.Instance.IsSingleProjectMode)
                    //{
                    //tdCalendar.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //tdCalendarLbl.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //tdTimeType.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //tdTimeTypeLbl.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //tdDays.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //tdDaysLbl.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    //}

                }
                if (radddlBusinessUnitTree!=null &amp;&amp; radddlBusinessUnitTree.EmbeddedTree.SelectedNode!=null ) // on postback business unit value is being duplicated by telerik
                {
                    radddlBusinessUnitTree.SelectedValue = radddlBusinessUnitTree.EmbeddedTree.SelectedNode.Value;

                }

                if (!UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                {
                    trProgramYear.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    trProjectValue.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    rfvProjectClass.Enabled = false;
                }

                //This is done for Page title is changing
                if (!string.IsNullOrEmpty(ViewState[&quot;PageTitleValue&quot;].ToString2()))
                {
                    PageTitle = ViewState[&quot;PageTitleValue&quot;].ToString2();
                }

                SetContractTimeLabels();
            }
            catch (Exception ex)
            {
                lblException.Text = ex.StackTrace;
            }
            finally
            {
                if (!isProjectModeCheckConditionCodeExecuted)
                {
                    lblIntegrationCutoffDate.Text = (IntegrationCutoffDate.AddDays(-1) == DateTime.MinValue)
                          ? &quot;&quot;
                          : Session[Constants.APP_IntegrationCutoffDate].ToDateTime_MWCulture().ToMWDateTime().
                              ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);

                    if (!((List&lt;string&gt;)Context.Items[Constants.MODULE_PERMISSIONS]).Contains(&quot;PROJPROJECTMODE&quot;) || DefaultRecordDate == DateTime.MinValue)
                    {
                        rbIntegration.Enabled = rbLive.Enabled = false;
                        trIntegDateMode.Style.Add(&quot;display&quot;, &quot;none&quot;);
                    }
                    if (rbIntegration.Checked)
                    {
                        wdcDateCreated.MaxDate = wdcStartDate.MaxDate = IntegrationCutoffDate.AddDays(-1).ToMWDateTime();
                    }
                }
            }

            RegisterCallBackScript();

            lblProjectName.Text = Project_Text + &quot; Name :&quot;;
            lblProjectCode.Text = ProjectCode_Text + &quot; :&quot;;
            lblbusinessUnit.Text = BusinessUnit_Text + &quot; :&quot;;
            rfvBusinessUnits.ErrorMessage = BusinessUnit_Text + &quot; is required.&quot;;
            rfvProjectName.ErrorMessage = Project_Text + &quot; Name is required.&quot;;
            rfvProjectCode.ErrorMessage = ProjectCode_Text + &quot; is required.&quot;;
            revProjectName.ErrorMessage = Project_Text + &quot; name may not contain the following characters: | ^&quot;;
            revProjectCode.ErrorMessage = &quot;Space is not allowed in &quot; + ProjectCode_Text;

            if (!UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
            {
                trProjectScore.Visible = false;
            }
            else
                trProjectScore.Visible = true;

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.OnPageLoad(model, args);
        }

        private bool IsBusinessUnitEditable()
        {
            List&lt;int&gt; userIdList = ProjectManager.Instance.GetProjectUserIDs(projectID);

            // Allow business unit edit, based on below condtion
            // There is only one user and logged in user is the only invited user for the project.            
            return userIdList.Count == 1 &amp;&amp; userIdList.Contains(uid);
        }

        /// &lt;summary&gt;
        /// Comments : Get Business Units and Bind for CreateProject
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;businessUnitIdForExistingProject&quot;&gt;this is only if it is existing project so that we need not fetch the full list&lt;/param&gt;
        private void SetBusinessUnitControlAndFillData(bool isBusinessUnitEditAllowed, Project projectDto)
        {
            if (isBusinessUnitEditAllowed || projectDto == null)
            {
                radddlBusinessUnitTree.Visible =
                radddlBusinessUnitTree.Enabled =
                rfvBusinessUnits.Enabled = true;

                radddlBusinessUnitTree.DataTextField = &quot;Name&quot;;
                radddlBusinessUnitTree.DataValueField = &quot;ID&quot;;
                radddlBusinessUnitTree.DataFieldID = &quot;ID&quot;;
                radddlBusinessUnitTree.DataFieldParentID = &quot;ParentID&quot;;
                DataTable dt = UserManager.Instance.GetBusinessUnits_ActiveOnly();
                // to Fix XSS attack
                foreach (DataRow row in dt.Rows)
                {
                    row[&quot;Name&quot;] = HttpUtility.HtmlEncode(row[&quot;Name&quot;].ToString());
                }

                radddlBusinessUnitTree.DataSource = dt;
                radddlBusinessUnitTree.DataBind();
                radddlBusinessUnitTree.ExpandAllDropDownNodes();
                if (dt.Rows.Count == 1) radddlBusinessUnitTree.SelectedText = dt.Rows[0][&quot;Name&quot;].ToString();
                txtBusinessUnitReadOnly.Enabled =
                txtBusinessUnitReadOnly.Visible = false;
            }
            else if (!isBusinessUnitEditAllowed &amp;&amp; projectDto != null)
            {
                radddlBusinessUnitTree.Visible =
                radddlBusinessUnitTree.Enabled =
                rfvBusinessUnits.Enabled = false;

                txtBusinessUnitReadOnly.Enabled =
                txtBusinessUnitReadOnly.Visible = true;

                string buName = string.Empty;
                if (projectDto.BusinessUnitID.HasValue)
                    buName = projectDto.BusinessUnitPath;

                ViewState[&quot;VS_BusinessUnitID&quot;] = projectDto.BusinessUnitID;

                txtBusinessUnitReadOnly.Text = buName;
            }
        }

        private void LoadAttachments()
        {
            ((AttachmentsControl)projAttachments).InstanceID = projectID.ToString2();
            ((AttachmentsControl)projAttachments).SrcType = ProjectConstants.MODID_PROJECT;
            ((AttachmentsControl)projAttachments).LoadAttachments();
        }

        private void FillDocMetadataList()
        {
            DataTable dt = DocumentManager.Instance.GetDocumentMetadata();

            ddlDocMetadata.DataSource = dt;
            ddlDocMetadata.DataTextField = &quot;FormHeader&quot;;
            ddlDocMetadata.DataValueField = &quot;ValueField&quot;;
            ddlDocMetadata.DataBind();

            ddlDocMetadata.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;0&quot;));

            if (IsNewMode)
                ddlDocMetadata.SelectedValue = GetDefaultDocumentMetaData();
        }

        private string GetDefaultDocumentMetaData()
        {
            return DocumentManager.Instance.GetDefaultDocumentMetaData();
        }

        private void FillOwnerList(string owner)
        {
            txtProjectOwner.Style.Add(&quot;display&quot;, &quot;none&quot;);
            rfvOwner.Enabled = false;
            revOwner.Enabled = false;

            ddlOwner.Visible = true;
            //rfvDdlOwner.Enabled = true;
            if (ddlOwner.Items.Count &lt;= 0)
            {
                DataTable dt =
                    ComponentHelper.Instance.ExecuteDataSet(&quot;SELECT [Owner] FROM vw_PROJECTOwners order by [Owner]&quot;)
                        .Tables[0];
                if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                {
                    ddlOwner.DataSource = dt;
                    ddlOwner.DataTextField = ddlOwner.DataValueField = &quot;Owner&quot;;
                    ddlOwner.DataBind();
                }

                ddlOwner.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;&quot;));
            }
            if (!string.IsNullOrEmpty(owner))
            {
                if (ddlOwner.Items.FindByValue(owner) != null)
                    ddlOwner.Items.FindByValue(owner).Selected = true;
            }
        }

        private void FillProgramYear(string ProgramYear)
        {
            ddlProgramYear.Visible = true;
            if (ddlProgramYear.Items.Count &lt;= 0)
            {
                DataTable dt =
                    ComponentHelper.Instance.ExecuteDataSet(&quot;select ProgramYear from vw_GetProgramYearList&quot;).Tables[0];
                if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                {
                    ddlProgramYear.DataSource = dt;
                    ddlProgramYear.DataTextField = ddlProgramYear.DataValueField = &quot;ProgramYear&quot;;
                    ddlProgramYear.DataBind();
                }
                ddlProgramYear.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;&quot;));
            }
            if (!string.IsNullOrEmpty(ProgramYear))
            {
                if (ddlProgramYear.Items.FindByValue(ProgramYear) != null)
                    ddlProgramYear.Items.FindByValue(ProgramYear).Selected = true;
            }
        }

        private void FillProjectClass(string ProgramYear, int projectID, bool isReadOnly = false)
        {
            ddlProjectClass.Visible = true;
            if (ddlProjectClass.Items.Count &lt;= 0)
            {
                DataTable dt =
                    ComponentHelper.Instance.ExecuteDataSet(&quot;Select ID,ProgramCategory from LibraryProgramCategory order by ProgramCategory&quot;)
                        .Tables[0];
                if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                {
                    if (isReadOnly)
                    {
                        DataRow[] rows = dt.Select(&quot;ID=&#39;&quot; + ProgramYear + &quot;&#39;&quot;);
                        if (rows.Length &gt; 0)
                            dt = rows.CopyToDataTable();
                    }

                    ddlProjectClass.DataSource = dt;
                    ddlProjectClass.DataTextField = &quot;ProgramCategory&quot;;
                    ddlProjectClass.DataValueField = &quot;ID&quot;;
                    ddlProjectClass.DataBind();

                }
                ddlProjectClass.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, null));
            }
            if (!string.IsNullOrEmpty(ProgramYear))
            {
                if (ddlProjectClass.Items.FindByValue(ProgramYear) != null)
                    ddlProjectClass.Items.FindByValue(ProgramYear).Selected = true;
            }

            if (projectID != 0 &amp;&amp; ProjectManager.Instance.IsProjectAddedToProgram(projectID))
                ddlProjectClass.Enabled = false;
        }

        private void FillCalendarList(int ExpenditureCurveID)
        {
            ddlExpenditureCurve.Visible = true;
            if (ddlExpenditureCurve.Items.Count &lt;= 0)
            {
                DataSet ds = _projectCalendarModel.GetLibraryCalendarList();
                if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                {
                    DataTable dt = ds.Tables[0];
                    if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                    {
                        ddlExpenditureCurve.DataSource = dt;
                        ddlExpenditureCurve.DataTextField = &quot;Name&quot;;
                        ddlExpenditureCurve.DataValueField = &quot;ID&quot;;
                        ddlExpenditureCurve.DataBind();
                    }
                    ddlExpenditureCurve.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;&quot;));
                }
            }
            if (ExpenditureCurveID &gt; 0)
            {
                if (ddlExpenditureCurve.Items.FindByValue(ExpenditureCurveID.ToString()) != null)
                    ddlExpenditureCurve.Items.FindByValue(ExpenditureCurveID.ToString()).Selected = true;
            }
        }

        protected override void CreateChildControls()
        {
            var menus = new MenuArray();
            AddSaveButton(menus);
            menus.Add(new BrixMenu(&quot;lnkCancel&quot;, &quot;Cancel&quot;, &quot;Icn_Cancel.png&quot;, 55));

            CreateToolBarMenu(menus, null);
            base.CreateChildControls();
        }

        protected override void CustomizeToolBar()
        {
            if (HasSaveButton)
            {
                Aurigo.AMP3.Core.UserControls.Menu lnkSave = GetSaveButton();
                if (null != lnkSave)
                {
                    // Commented this part as it is giving false when the required filed validation is thrown and cancel is clicked.
                    // MainToolBar.GetMenuReference(&quot;lnkSave&quot;).Attributes.Add(&quot;onclick&quot;, &quot;if (!saveAtts()) return false;&quot;);
                    lnkSave.ValidationGroup = &quot;CreateProject&quot;;
                    lnkSave.CausesValidation = true;
                    if(_WorkflowsInitiated!=null &amp;&amp; _WorkflowsInitiated.Count &gt; 0)
                    lnkSave.OnClientClick = &quot; if(typeof Page_ClientValidate == \&quot;function\&quot;) { try {DisableControlsOnSaveAndWFAction(&#39;&quot; + _WorkflowsInitiated[0].ToString() + &quot;&#39;); var ret=Page_ClientValidate(); if(!ret) { Page_BlockSubmit = false; EnableControlsOnSaveAndWFAction(&#39;&quot; + _WorkflowsInitiated[0].ToString() + &quot;&#39;); return ret; }  } catch(ex){} }  return true;&quot;;
                    else
                        lnkSave.OnClientClick =
                        &quot;if(typeof Page_ClientValidate == \&quot;function\&quot;) { try { var ret=Page_ClientValidate(); if(!ret) { Page_BlockSubmit = false; return ret; } } catch(ex){} } return true;&quot;;

                    lnkSave.Click += btnSave_Click;
                }
            }
            if (MainToolBar.GetMenuReference(&quot;lnkCancel&quot;) != null)
            {
                //MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).ValidationGroup = &quot;CreateProject&quot;;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).CausesValidation = false;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).OnClientClick =
                        &quot;Page_BlockSubmit = false;return true;&quot;;
                MainToolBar.GetMenuReference(&quot;lnkCancel&quot;).Click += btnCancel_Click;
            }

            XmlFormArgs args = new XmlFormArgs();
            if (managerModel != null)
                managerModel.AfterCustomizeToolbar(model, MainToolBar, args);
        }

        /// &lt;summary&gt;
        /// Loads the projects details on page load.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        private Project EditProject(int projectId)
        {

            try
            {

                List&lt;string&gt; components =
                    ModuleManagementBL.ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
                if (dtoProject != null)
                {
                    if (!dtoProject.ProjectIsActive)
                    {
                        UIHelper.RedirectURL(
                            &quot;Inactive &quot; + Project_Text + &quot; cannot be edited.&quot;,
                            (IsProposedProject)
                                ? ResolveUrl(Constants.URL_PROJECTS) + &quot;&amp;PP=1&quot;
                                : ResolveUrl(Constants.URL_PROJECTS), null, Context);
                    }
                    txtProjectName.Text = dtoProject.ProjectName;
                    txtProjectCode.Text = dtoProject.ProjectCode;
                    txtProjectCode.Enabled = false;
                    txtDescription.Text = dtoProject.ProjectDescription;

                    hdnProjectID.Value = dtoProject.ProjectID.ToString2();
                    hdnTemplateID.Value = dtoProject.ProjectTemplateID.ToString2();

                    if (hdnTemplateID.Value != &quot;&quot; &amp;&amp; hdnTemplateID.Value != &quot;0&quot;)
                    {
                        Template dtoTemplate = blInstance.GetTemplateDetails(dtoProject.ProjectTemplateID, &quot;PROJECT&quot;);
                        if (dtoTemplate.TempId &gt; 0)
                        {
                            ddlTemplates.Items.FindByValue(dtoTemplate.TempId.ToString2()).Selected = true;
                        }
                    }
                    if (components.Contains(&quot;ShowOwnerDropdown&quot;))
                    {
                        FillOwnerList(dtoProject.ProjectOwner);
                    }
                    else
                    {
                        txtProjectOwner.Text = dtoProject.ProjectOwner;
                    }

                    // KK: clean up code path without planning
                    // todo: this needs to move out of here.
                    if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING))
                    {
                        FillProgramYear(dtoProject.ProgramYear);
                        FillProjectClass(dtoProject.ProjectClass, dtoProject.ProjectID, dtoProject.IsPublished);
                    }

                    FillCalendarList(dtoProject.ExpenditureCurveID);

                    wdcStartDate.Value = dtoProject.ProjectStartDate.ToMWDateTime();
                    wdcEndDate.Value = dtoProject.ProjectEndDate.ToMWDateTime();
                    wdcDateCreated.Value = dtoProject.ProjectCreatedDate.ToMWDateTime();

                    chkIsActive.Checked = dtoProject.ProjectIsActive;

                    if (dtoProject.ProjectStatus.ToString2() != &quot;0&quot; &amp;&amp; ddlStatus.Items.FindByValue(dtoProject.ProjectStatus.ToString2()) == null)
                        ddlStatus.Items.Add(new ListItem(dtoProject.ProjectStatusName,
                            dtoProject.ProjectStatus.ToString2()));
                    if (dtoProject.ProjectStatus.ToString2() != &quot;0&quot;)
                        ddlStatus.Items.FindByValue(dtoProject.ProjectStatus.ToString2()).Selected = true;

                    if (dtoProject.LandMasterID &gt; 0)
                        ddlLandName.Items.Insert(0,
                            new ListItem(dtoProject.LandMasterName,
                                dtoProject.LandMasterID.ToString2()));
                    else
                        ddlLandName.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;0&quot;));

                    ddlDocumentTemplate.SelectedIndex = -1;

                    if (dtoProject.DocumentTemplateID != null)
                    {
                        ListItem documentTemplateItem = ddlDocumentTemplate.Items.FindByValue(dtoProject.DocumentTemplateID.ToString2());

                        if (documentTemplateItem != null)
                            documentTemplateItem.Selected = true;
                    }

                    if (dtoProject.DocumentMetadataID != null)
                    {
                        ddlDocMetadata.SelectedIndex = -1;
                        foreach (ListItem li in ddlDocMetadata.Items)
                        {
                            if (li.Value.EndsWith(&quot;&amp;&amp;&quot; + dtoProject.DocumentMetadataID))
                            {
                                ddlDocMetadata.Items.FindByValue(li.Value).Selected = true;

                                break;
                            }
                        }
                    }

                    attributeList = dtoProject.ProjectAttributesList;
                    moduleList = dtoProject.ProjectModules;

                    if (dtoProject.ProjectMode == &#39;I&#39;)
                    {
                        rbLive.Checked = false;
                        rbIntegration.Checked = true;
                    }
                    else
                    {
                        rbIntegration.Checked = false;
                        rbLive.Checked = true;
                    }

                    //populate the modules grid
                    PopulateModulesGrid(null);

                    //populate attributes grid
                    PopulateAttributesGrid(null);

                    //ProjectValue
                    TxtProjectValue.Text = dtoProject.ProjectValue.ToString2();

                    //Project Score
                    txtProjectScore.Text = String.Format(&quot;{0:0.##}&quot;, dtoProject.ProjectScore);

                    rblContractTime.SelectedValue = (dtoProject.CalendarType == 1) ? &quot;W&quot; : &quot;C&quot;;
                    wneContractDays.Value = dtoProject.CalendarDays;
                }

                ddlDocMetadata.Enabled = !blInstance.CheckIdDocsExists(projectId);
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }

            return dtoProject;
        }

        /// &lt;summary&gt;
        /// Loads the defaults
        /// &lt;/summary&gt;
        private void LoadDefaults()
        {
            try
            {
                ////To populate status dropdown
                DataTable projectDT = blInstance.GetStatus(false);
                if (projectDT.Rows.Count &lt; 1)
                {
                    lblException.Text = Project_Text + &quot; cannot be created without status. Please create status messages using Settings Page.&quot;;
                    return;
                }

                ddlStatus.Enabled = true;
                createLink.Visible = false;
                ddlStatus.DataSource = projectDT;
                ddlStatus.DataTextField = &quot;StatusName&quot;;
                ddlStatus.DataValueField = &quot;StatusId&quot;;
                ddlStatus.DataBind();

                ddlStatus.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;&quot;));

                if (!CoreModuleComponents.Contains(&quot;EnableProjectTemplate&quot;))
                {
                    trProjectTemplate.Style.Add(&quot;display&quot;, &quot;none&quot;);
                }
                else
                {
                    trProjectTemplate.Style.Add(&quot;display&quot;, &quot;table-row&quot;);

                    //To populate templates dropdown
                    DataTable templateDT = blInstance.GetTemplates();
                    ddlTemplates.Items.Add(new ListItem(&quot;Select Template&quot;, &quot;0&quot;));

                    foreach (DataRow dr in templateDT.Rows)
                        ddlTemplates.Items.Add(new ListItem(dr[&quot;TemplateName&quot;].ToString2(), dr[&quot;TemplateId&quot;].ToString2()));

                }

                if (projectID &gt; 0)
                {
                    ddlTemplates.Enabled = false;
                }
                else
                {
                    ddlTemplates.Enabled = true;
                    ddlTemplates.SelectedIndex = 0;
                }


                //edit
                if (Request.QueryString[&quot;ProjectId&quot;] != null &amp;&amp; Request.QueryString[&quot;ProjectId&quot;] != &quot;&quot;)
                {
                    //ddlTemplates.Enabled = false;
                }
                else //create
                {
                    //Todays Date
                    // string strToday =MWDateTimeHelper.MWToday.ToString_MWCulture();
                    wdcDateCreated.Value = MWDateTimeHelper.MWToday;

                    if (MWDateTimeHelper.MWToday &lt; IntegrationCutoffDate.ToMWDateTime())
                    {
                        rbIntegration.Checked = wdcDateCreated.Enabled = true;
                        wdcDateCreated.Value = wdcStartDate.Value = DefaultRecordDate.ToMWDateTime();
                    }
                    else
                    {
                        rbLive.Checked = true;
                        wdcDateCreated.Enabled = false;
                        wdcDateCreated.Value = wdcStartDate.Value = MWDateTimeHelper.MWToday; // DateTime.Today;
                    }

                    wdcEndDate.Value = wdcStartDate.Value;

                    if (!(projectID &gt; 0))
                        //populate the modules grid
                        PopulateModulesGrid(null);

                    //populate attributes grid
                    PopulateAttributesGrid(null);
                }
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        /// &lt;summary&gt;
        /// Populates the Attributes
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateID&quot;&gt;&lt;/param&gt;
        private void PopulateAttributesGrid(int? templateID)
        {
            try
            {
                //Load Mandatory Fields....
                if (projectID == 0)
                {
                    GrdA.DataSource = blInstance.GetAttributes(&quot;PROJECT&quot;, false, true);
                    GrdA.DataBind();
                }

                IQueryable&lt;AttributesMaster&gt; projAttribs = blInstance.GetAttributes(&quot;PROJECT&quot;, false, null);
                btnEdit.Disabled = btnDelete.Disabled = !(GrdA.Rows.Count &gt; 0);

                if (templateID == null)
                {
                    if (projAttribs.Count() &gt; 0)
                    {
                        btnAddAttributes.Disabled = false;
                        ddlAttributes.Items.Clear();
                        foreach (AttributesMaster attribute in projAttribs)
                        {
                            ddlAttributes.Items.Add(new ListItem(attribute.AttributeName,
                                attribute.AttributeId + &quot;,&quot; + attribute.AttributeType +
                                &quot;,&quot; + attribute.IsMandatory));
                        }
                    }
                    else
                    {
                        btnAddAttributes.Disabled = true;
                    }
                }
                else
                {
                    Template dtTemplate = blInstance.GetTemplateDetails(templateID.Value, &quot;PROJECT&quot;);

                    if (dtTemplate != null)
                    {
                        ddlAttributes.Items.Clear();
                        Dictionary&lt;string, string&gt; iAttributeList = dtTemplate.TemplateAttributes;

                        if (iAttributeList.Count &gt; 0)
                        {
                            foreach (var item in iAttributeList)
                            {
                                ddlAttributes.Items.Add(new ListItem(item.Value.ToString2(), item.Key.ToString2()));
                            }

                            btnAddAttributes.Disabled = false;
                        }
                        else
                        {
                            btnAddAttributes.Disabled = true;
                        }
                    }
                }

                //edit

                if (projectID &gt; 0 &amp;&amp; attributeList != null &amp;&amp; attributeList.Count &gt; 0)
                {
                    DataTable dtAttr = new BrixDataTable();

                    dtAttr.Columns.Add(&quot;AttributeName&quot;);
                    dtAttr.Columns.Add(&quot;AttributeValue&quot;);
                    dtAttr.Columns.Add(&quot;AttributeNotes&quot;);
                    dtAttr.Columns.Add(&quot;AttributeType&quot;);
                    dtAttr.Columns.Add(&quot;AttributeID&quot;);
                    dtAttr.Columns.Add(&quot;IsMandatory&quot;);

                    projAttribs = blInstance.GetAttributes(&quot;PROJECT&quot;, null, null);
                    foreach (Project.AttributeClass attribute in attributeList)
                    {
                        AttributesMaster MasterAttrib =
                            projAttribs.FirstOrDefault(p =&gt; p.AttributeId == attribute.AttributeId);

                        if (MasterAttrib != null)
                        {
                            DataRow drA = dtAttr.NewRow();
                            drA[&quot;AttributeID&quot;] = MasterAttrib.AttributeId;
                            drA[&quot;AttributeName&quot;] = MasterAttrib.AttributeName;
                            drA[&quot;AttributeNotes&quot;] = attribute.AttributeNotes;
                            drA[&quot;AttributeType&quot;] = MasterAttrib.AttributeType;
                            drA[&quot;IsMandatory&quot;] = MasterAttrib.IsMandatory;
                            drA[&quot;AttributeValue&quot;] = attribute.AttributeValue;
                            dtAttr.Rows.Add(drA);
                        }
                    }
                    GrdA.DataSource = dtAttr;
                    GrdA.DataBind();
                }
                HTMLEncodeGridColumns(GrdA);
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        private void PopulateModulesGrid(int? templateID)
        {
            try
            {
                DataTable dt = new BrixDataTable();
                dt.Columns.Add(&quot;ModuleID&quot;);
                dt.Columns.Add(&quot;Module Name&quot;);
                grdModulePlatforms.DisplayLayout.AllowColumnMovingDefault = AllowColumnMoving.None;
                grdModulePlatforms.DisplayLayout.AllowSortingDefault = AllowSorting.No;

                activePlatforms = new Dictionary&lt;string, string&gt;();

                var xDoc = new XmlDocument();
                xDoc.LoadXml(ModuleManager.Instance.GetModulePlatforms(&quot;PROJECT&quot;));

                if (templateID != null)
                {
                    Template dtoTemplate = ProjectManager.Instance.GetTemplateDetails(templateID.Value, &quot;PROJECT&quot;);
                    moduleList = dtoTemplate.TemplateModules;
                }

                foreach (XmlNode xModule in xDoc.SelectNodes(&quot;modules/module&quot;))
                {
                    foreach (XmlNode xPlatform in xModule.ChildNodes)
                    {
                        var colAvlbl = new DataColumn(xPlatform.InnerText);
                        if (dt.Columns.IndexOf(xPlatform.InnerText) == -1)
                        {
                            colAvlbl.DataType = typeof(bool);
                            colAvlbl.DefaultValue = false;
                            dt.Columns.Add(colAvlbl);
                        }
                        activePlatforms.Add(xModule.Attributes[&quot;key&quot;].Value + &quot;_&quot; + colAvlbl.ColumnName,
                               xModule.Attributes[&quot;key&quot;].Value);
                    }
                }

                foreach (XmlNode xModule in xDoc.SelectNodes(&quot;modules/module&quot;))
                {
                    var values = new object[dt.Columns.Count];
                    values[0] = xModule.Attributes[&quot;key&quot;].Value;
                    values[1] = xModule.Attributes[&quot;name&quot;].Value;
                    foreach (XmlNode xPlatform in xModule.ChildNodes)
                    {
                        string platform = xPlatform.InnerText;
                        int index = dt.Columns.IndexOf(platform);

                        values[index] = (platform == &quot;Web&quot;);

                        if ((platform != &quot;Web&quot;) &amp;&amp; (moduleList != null))
                        {
                            foreach (Platform iPlt in moduleList)
                            {
                                if (xModule.Attributes[&quot;key&quot;].Value == iPlt.ModuleId &amp;&amp;
                                    xPlatform.Attributes[&quot;key&quot;].Value == iPlt.PlatformKey)
                                {
                                    values[index] = true;
                                    break;
                                }
                            }
                        }
                    }
                    dt.Rows.Add(values);
                }

                if (dt.Rows.Count &gt; 0)
                {
                    grdModulePlatforms.DataSource = dt;
                    grdModulePlatforms.DataBind();
                    grdModulePlatforms.Bands[0].Columns.FromKey(&quot;ModuleID&quot;).Hidden = true;
                    grdModulePlatforms.Columns.FromKey(&quot;Web&quot;).AllowUpdate = AllowUpdate.No;
                }
                else
                {
                    grdModulePlatforms.Columns.Clear();
                    grdModulePlatforms.DisplayLayout.NoDataMessage =
                        MessageResourceManager.GetString(&quot;W_PROJECT_NO_MODULE_AVAILABLE&quot;,
                            Enumerations.MessageType.WarningMessage);
                }

                HTMLEncodeGridColumns(grdModulePlatforms);
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        /// &lt;summary&gt;
        /// Initialise row event
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void grdModulePlatforms_InitializeRow(object sender, RowEventArgs e)
        {
            try
            {
                // 0 - Row Select, 1 - ModuleID, 2 - Module Name
                for (int i = 3; i &lt; grdModulePlatforms.Columns.Count; i++)
                {
                    string moduleid = e.Row.Cells.FromKey(&quot;ModuleID&quot;).Value.ToString2();
                    if (moduleList != null)
                    {
                        foreach (Platform obj in moduleList)
                        {
                            if (obj.ModuleId == moduleid)
                            {
                                e.Row.Cells[0].Value = true;
                                break;
                            }
                        }
                    }

                    AllowEditing ae = AllowEditing.No;
                    if (e.Row.Cells[i].Column.Header.Caption != &quot;Web&quot;)
                    {
                        bool found = false;
                        foreach (KeyValuePair&lt;string, string&gt; kvp in activePlatforms)
                        {
                            if (kvp.Value == moduleid &amp;&amp;
                                kvp.Key == moduleid + &quot;_&quot; + e.Row.Cells[i].Column.Header.Caption)
                            {
                                found = true;
                                break;
                            }
                        }
                        if (found)
                            ae = AllowEditing.Yes;
                    }
                    e.Row.Cells[i].AllowEditing = ae;
                }
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        /// &lt;summary&gt;
        /// Cancels Create/edit project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void btnCancel_Click(object sender, EventArgs e)
        {
            if (HttpContext.Current.Request.QueryString[&quot;ReturnUrl&quot;] != null)
            {
                string returnUrl = Request.QueryString[&quot;ReturnUrl&quot;];

                string decryptedBackURL = SecurityHelpers.Decrypt_Simple(returnUrl);
                Response.Redirect(decryptedBackURL);
            }
            else
            {
                Response.Redirect(
                    BuildURL(
                        (IsProposedProject)
                            ? &quot;~/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                            : &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;, new List&lt;string&gt;()), false);
            }

        }

        /// &lt;summary&gt;
        /// Fired when user select a item from the drop down
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        protected void ddlTemplates_SelectedIndexChanged(object sender, EventArgs e)
        {
            try
            {
                if (ddlTemplates.SelectedItem.Text.ToString2() != &quot;Select Template&quot;)
                {
                    int templateId = Convert.ToInt32(ddlTemplates.Items[ddlTemplates.SelectedIndex].Value.ToString2(),
                        CultureInfo.CurrentCulture);
                    hdnTemplateID.Value = templateId.ToString2();
                    //PopulateAttributesGrid(templateId);
                    PopulateModulesGrid(templateId);
                }
                else
                {
                    hdnTemplateID.Value = &quot;&quot;;
                    //PopulateAttributesGrid(null);
                    PopulateModulesGrid(null);
                }
                ddlTemplates.Enabled = true;
            }
            catch (Exception ex)
            {
                lblException.Text = ex.Message;
            }
        }

        ///// &lt;summary&gt;
        ///// Fires when the user selects/unselects Use templates check box
        ///// &lt;/summary&gt;
        ///// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        ///// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;
        //protected void chkUseTemplates_CheckedChanged(object sender, EventArgs e)
        //{
        //    try
        //    {
        //        if (chkUseTemplates.Checked)
        //        {
        //            ddlTemplates.Enabled = true;
        //            ddlTemplates.SelectedIndex = -1;
        //        }
        //        else
        //        {
        //            // Reload the Attributes grid
        //            PopulateAttributesGrid(null);
        //            PopulateModulesGrid(null);

        //            ddlTemplates.SelectedIndex = -1;
        //            ddlTemplates.Enabled = false;
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        lblException.Text = ex.Message;
        //    }
        //}

        private List&lt;TabData&gt; GetPageData()
        {
            var lst = new List&lt;TabData&gt;();

            //This is required when we have AX
            //Currently commenting the code as AX is not supported
            //Need to look at it when we have AX

            /*
            string projCode = &quot;&quot;, projName = &quot;&quot;;

            if (txtProjectCode != null)
                projCode = txtProjectCode.Text;
            if (txtProjectName != null)
                projName = txtProjectName.Text;

            lst.Add(new TabData(Core.IntegrationConnector.DTO.Project.MandatoryFields.Code, projCode));
            lst.Add(new TabData(Core.IntegrationConnector.DTO.Project.MandatoryFields.Name, projName));
            string isNewProject = string.IsNullOrEmpty(Request[Constants.QRY_PROJECTID])
                                      ? &quot;&quot;
                                      : Request[Constants.QRY_PROJECTID];
            string contractInfo = &quot;&quot;;
            if (!string.IsNullOrEmpty(isNewProject))
            {
                // To fetch Contract information
                string SQL =
                    &quot;Select A.ID,Code,ProjectID,Locked from CONTMGTMaster AS A join ERPMGMTObjectMap AS B On A.ID = B.AMP3Id where B.AMP3Type = &#39;Contmgt&#39; and B.ERPType =&#39;Subproject&#39; And A.ProjectID = &quot; +
                    isNewProject;

                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetSqlStringCommand(SQL);
                    DataSet dsData = conn.DB.ExecuteDataSet(cmd);
                    DataTable dtData = dsData.Tables[0];
                    if (dtData.Rows.Count &gt; 0)
                        contractInfo = &quot;Y&quot;;
                    else
                        contractInfo = &quot;N&quot;;
                }
            }
            else
                contractInfo = &quot;N&quot;;

            lst.Add(new TabData(&quot;ContractInfo&quot;, contractInfo));
            lst.Add(new TabData(&quot;IsNewProject&quot;, isNewProject));

            */
            return lst;
        }

        private void FillDocTemplateList()
        {
            DataTable dt = DocumentManager.Instance.GetDocumentTemplates();

            ddlDocumentTemplate.DataSource = dt;
            ddlDocumentTemplate.DataTextField = &quot;DocTemplateName&quot;;
            ddlDocumentTemplate.DataValueField = &quot;DocTemplateID&quot;;
            ddlDocumentTemplate.DataBind();

            ddlDocumentTemplate.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;0&quot;));
            ddlDocumentTemplate.SelectedValue = GetDefaultDocTemplateId();
        }

        private string GetDefaultDocTemplateId()
        {
            return DocumentManager.Instance.GetDefaultDocumentTemplate();
        }

        protected void rbProjectMode_OnCheckedChanged(object sender, EventArgs e)
        {
            if (rbIntegration.Checked)
            {
                wdcDateCreated.Enabled = true;
                wdcDateCreated.MaxDate = wdcStartDate.MaxDate = IntegrationCutoffDate.AddDays(-1);
            }
            else
            {
                wdcDateCreated.Enabled = false;
                wdcDateCreated.MaxDate = wdcStartDate.MaxDate = DateTime.MaxValue;
                if (projectID == 0)
                    wdcDateCreated.Value = MWDateTimeHelper.MWToday; // DateTime.Today;
            }
        }

        public override string GetCallbackResult()
        {
            return callback;
        }

        public override void RaiseCallbackEvent(string eventArgument)
        {
            var dt = new DateTime();
            try
            {
                dt = DateTime.Parse(eventArgument, DateFormatCulture.GetDateFormatCulture());
                callback = &quot;1&quot;;
            }
            catch (Exception)
            {
                callback = &quot;0&quot;;
            }
        }

        private void RegisterCallBackScript()
        {
            var sb = new StringBuilder();
            sb.Append(&quot;function SendServerRequestP(arguments,context){&quot;);
            sb.Append(&quot;try{ ShowLoadingOnRequest(); }catch(ex){ }&quot;);
            sb.Append(Page.ClientScript.GetCallbackEventReference(this, &quot;arguments&quot;, &quot;HandleServerResponseP&quot;, &quot;context&quot;,
                false));
            sb.Append(&quot;}&quot;);
            RegisterStartupScript(sb.ToString2());
        }

        protected void btnSave_Click(object sender, EventArgs e)
        {
            Page.Validate(&quot;CreateProject&quot;);
            if (Page.IsValid)
            {
                if (!string.IsNullOrEmpty(ConnectionHelper.GetCurrentCompany()))
                {
                    if (true == (bool)_IsNew)
                    {
                        if (ProjectManager.Instance.GetAllProjectCount() &gt;=
                            CompanyManager.Instance.GetCurrentCompanyDetails().ProjectLimit)
                        {
                            ShowError(&quot;Please upgrade to create more projects&quot;);
                            return;
                        }
                    }
                    WorkflowEnabledSaveHandler();
                }
                else
                    //For central login
                    WorkflowEnabledSaveHandler();
            }
        }

        protected override void SetModes()
        {
            int pid = String.IsNullOrEmpty(Request.QueryString[Constants.QRY_PROJECTID])
                ? -1
                : int.TryParse(Request.QueryString[Constants.QRY_PROJECTID], out pid) ? pid : -1;

            _IsEdit = pid &gt; 0;
            _IsNew = pid &lt; 0;
            _IsView = false;
        }

        private string BuildURL(string url, List&lt;string&gt; escapeKeys)
        {
            escapeKeys.AddRange(new string[] { &quot;pid&quot;, &quot;nt&quot; });
            return UIHelper.BuildURL(url, escapeKeys, HttpContext.Current);
        }

        #region &quot;Land Management&quot;

        private void LoadLandGrid()
        {
            if (Request.QueryString[&quot;pid&quot;] == null)
            {
                trLandExpand.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                trLandGrid.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);
                uwgLandDetails.DataSource = null;
                uwgLandDetails.DataBind();
            }
            else
            {
                DataSet dsLand = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_GetPLANINGLand, null,
                    Request.QueryString[&quot;pid&quot;]);
                if (dsLand.Tables[0] != null &amp;&amp; dsLand.Tables[0].Rows.Count &gt; 0)
                {
                    uwgLandDetails.DataSource = dsLand.Tables[0];
                    uwgLandDetails.DataBind();
                    HTMLEncodeGridColumns(uwgLandDetails);
                }
                else
                {
                    uwgLandDetails.DataSource = null;
                    uwgLandDetails.DataBind();
                }
            }
        }

        private void HTMLEncodeGridColumns(UltraWebGrid grid)
        {
            if (grid == null)
                return;

            foreach (UltraGridColumn col in grid.Columns)
            {
                col.HTMLEncodeContent = true;
            }
        }

        private void CheckAndLoadLANDMGTDetails()
        {
            object data = CoreDatabaseHelper.GetDataFromAssembly(Constants.MODID_LANDMGT, &quot;GetLandMasterDetails&quot;,
                new object[] { -1, -1, &quot;ENTPRSE&quot;, 0, 0, null, null });

            if (data != null)
            {
                ddlLandName.DataSource = data;
                ddlLandName.DataTextField = &quot;LandName&quot;;
                ddlLandName.DataValueField = &quot;MasterID&quot;;
                ddlLandName.DataBind();

                if (projectID == 0)
                    ddlLandName.Items.Insert(0, new ListItem(CONST_Dropdown_MakeSelectText, &quot;0&quot;));


                List&lt;string&gt; ModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);

                if (ModuleComponents.Contains(&quot;LandManagementSingleMode&quot;))
                    trLand.Style.Add(HtmlTextWriterStyle.Display, &quot;table-row&quot;);
                else
                    trLand.Style.Add(HtmlTextWriterStyle.Display, &quot;none&quot;);

                ViewState[&quot;landMasterExists&quot;] = true;
            }
        }

        #endregion

        private void objGrid_OnGridLoad(PickerGrid grid)
        {
            StringBuilder parameters = new StringBuilder();
            string Pid = HttpContext.Current.Request.QueryString[&quot;PID&quot;];
            parameters.Append(&quot;{&quot;);
            parameters.Append(&quot;\&quot;DataSource\&quot; : \&quot;_table:vw_PROJECTProjectMainMunis\&quot;&quot;);
            // parameters.Append(&quot;,\&quot;WhereCond\&quot; : \&quot;ProjectCode NOT IN (SELECT ProjectCode FROM PROJECTProjectMain WHERE isActive @^ 1) \&quot;&quot;);
            parameters.Append(&quot;}&quot;);

            grid.OptionalParamaters = grid.BuildOptionalParameters(parameters.ToString());
        }

        private List&lt;PickerColumnDetails&gt; GetGridColumns()
        {
            List&lt;PickerColumnDetails&gt; gridColumns = new List&lt;PickerColumnDetails&gt;();

            //gridColumns.Add(new PickerColumnDetails { ColumnName = &quot;ItemID&quot;, Caption = &quot;ItemID&quot;, Hidden = true, Type = &quot;number&quot; });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;ProjectCode&quot;,
                Caption = ProjectCode_Text,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;ProjectName&quot;,
                Caption = Project_Text + &quot; Name&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            gridColumns.Add(new PickerColumnDetails
            {
                ColumnName = &quot;Status&quot;,
                Caption = &quot;Status&quot;,
                Hidden = false,
                Type = &quot;string&quot;
            });
            return gridColumns;
        }

        void objGrid_OnItemSelected(PickerGrid grid, List&lt;Dictionary&lt;string, object&gt;&gt; selectedRows)
        {
            string instanceIds = string.Empty;


            try
            {
                foreach (Dictionary&lt;string, object&gt; entry in selectedRows)
                {
                    string itemID = entry[&quot;ProjectCode&quot;].ToString2();
                    //string itemName = entry[&quot;ProjectName&quot;].ToString2();

                    txtProjectCode.Text = itemID;
                    //txtProjectName.Text = itemName;
                }
            }
            catch (System.Exception)
            {
            }
        }

        public bool SkipDefaultXMLInjectionSave { get; set; }


        public string GetInitilize_ClientId_ForUseInJavascript()
        {
            JavascriptRenderFramework jrf = new JavascriptRenderFramework(&quot;CONST_CreateProject&quot;);

            jrf.Add_ClientId(
                 grdModulePlatforms
                 , divModulesGrid
                 , divAttributesGrid
                 , hdnEndDateConstraint

                 , hdnCellUpdated
                 , txtAttrValue
                 , txtAttrNotes
                 , GrdA
                 , hdnRowID

                 , trAttrInputs
                 , ddlAttributes
            );

            jrf.Add_ClientId(btnEdit, btnDelete);

            string scriptString = jrf.Generate();

            return scriptString;
            //ClientScript.RegisterClientScriptBlock(GetType(), &quot;ProjectInitilizeScript&quot;, scriptString, true);
            //ClientScript.RegisterClientScriptInclude(&quot;projects&quot;, ResolveClientUrl(&quot;~/Scripts/login.js&quot;));
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[56,9,56,78,1],[64,9,64,49,1],[69,9,69,62,1],[72,9,72,116,1],[74,9,74,50,1],[79,13,79,14,1],[80,17,80,65,1],[81,13,81,14,1],[87,13,87,14,1],[88,17,88,70,1],[89,13,89,14,1],[95,13,95,14,1],[96,17,96,70,1],[97,13,97,14,1],[103,13,103,14,1],[104,17,104,71,1],[105,21,105,67,1],[107,21,107,30,1],[108,13,108,14,1],[114,13,114,14,1],[115,17,115,39,1],[116,13,116,14,1],[122,13,122,14,0],[123,17,123,48,0],[124,17,124,61,0],[126,17,126,60,0],[128,17,128,29,0],[129,13,129,14,0],[136,13,136,14,1],[137,17,137,58,1],[138,21,138,75,1],[140,17,140,36,1],[141,13,141,14,1],[147,13,147,14,1],[148,17,148,49,1],[149,21,149,82,1],[150,17,150,44,1],[151,13,151,14,1],[158,9,158,67,1],[169,17,169,18,0],[169,19,169,32,0],[169,33,169,34,0],[170,17,170,18,0],[170,19,170,33,0],[170,34,170,35,0],[174,37,174,41,0],[174,42,174,46,0],[181,17,181,18,1],[181,19,181,81,1],[181,82,181,83,1],[197,17,197,18,1],[197,19,197,77,1],[197,78,197,79,1],[203,13,203,14,0],[204,17,204,54,0],[205,21,205,117,0],[206,17,206,49,0],[207,13,207,14,0],[215,13,215,14,1],[216,17,218,102,1],[219,17,219,39,1],[220,13,220,14,1],[225,17,225,18,1],[225,19,225,36,1],[225,37,225,38,1],[230,17,230,18,1],[230,19,230,39,1],[230,40,230,41,1],[233,9,233,50,1],[237,17,237,18,1],[237,19,237,35,1],[237,36,237,37,1],[242,17,242,18,0],[242,19,242,31,0],[242,32,242,33,0],[247,17,247,18,1],[247,19,247,65,1],[247,66,247,67,1],[252,17,252,18,1],[252,19,252,28,1],[252,29,252,30,1],[258,13,258,14,1],[259,17,262,94,1],[263,13,263,14,1],[269,13,269,14,0],[270,17,270,82,0],[271,17,271,18,0],[272,21,272,73,0],[273,21,273,70,0],[276,21,280,97,0],[281,13,281,14,0],[285,9,285,10,0],[286,13,286,78,0],[287,13,287,14,0],[288,17,288,69,0],[289,17,289,66,0],[292,17,301,98,0],[302,9,302,10,0],[305,9,305,10,1],[306,13,306,36,1],[309,13,309,108,1],[311,13,311,35,1],[312,17,312,144,0],[313,18,313,91,1],[314,13,314,14,0],[316,17,316,104,0],[317,17,317,75,0],[318,17,318,18,0],[319,21,319,56,0],[320,21,320,80,0],[321,21,321,76,0],[323,21,323,79,0],[324,25,324,119,0],[325,26,325,80,0],[326,25,326,114,0],[327,17,327,18,0],[328,13,328,14,0],[330,13,330,29,1],[331,9,331,10,1],[334,9,334,10,0],[336,13,336,38,0],[337,13,337,26,0],[338,13,338,30,0],[340,13,340,50,0],[341,13,341,38,0],[342,17,342,54,0],[343,13,343,54,0],[344,13,344,14,0],[346,17,346,18,0],[347,21,347,149,0],[348,21,348,145,0],[350,21,350,98,0],[351,21,351,56,0],[352,25,352,38,0],[354,21,354,49,0],[355,21,355,112,0],[356,21,356,63,0],[357,21,357,63,0],[358,21,358,82,0],[360,21,360,70,0],[361,21,361,22,0],[362,25,362,88,0],[363,29,363,59,0],[365,29,365,103,0],[366,21,366,22,0],[368,21,368,22,0],[369,25,369,149,0],[370,21,370,22,0],[372,21,372,64,0],[373,25,373,100,0],[374,21,374,99,0],[375,25,375,94,0],[377,25,377,59,0],[379,21,379,51,0],[380,21,382,29,0],[383,21,383,121,0],[384,21,384,105,0],[385,21,385,102,0],[386,21,390,29,0],[391,21,391,84,0],[392,21,394,108,0],[395,21,395,66,0],[396,21,396,62,0],[397,21,397,151,0],[399,21,399,67,0],[400,21,400,53,0],[401,25,401,123,0],[402,21,405,29,0],[406,21,406,79,0],[407,21,407,85,0],[408,21,408,58,0],[409,21,409,40,0],[410,21,410,76,0],[411,25,411,90,0],[414,21,414,60,0],[415,21,415,92,0],[416,21,416,28,0],[416,30,416,49,0],[416,50,416,52,0],[416,53,416,76,0],[417,21,417,22,0],[420,25,420,94,0],[421,29,421,38,0],[423,25,423,87,0],[425,30,425,39,0],[425,41,425,56,0],[425,58,425,61,0],[426,25,426,26,0],[427,29,427,81,0],[428,33,428,42,0],[430,29,430,82,0],[431,29,431,36,0],[431,38,431,47,0],[431,48,431,50,0],[431,51,431,63,0],[432,29,432,30,0],[433,33,433,65,0],[434,33,434,34,0],[435,37,435,88,0],[436,37,436,43,0],[438,29,438,30,0],[439,25,439,26,0],[440,21,440,22,0],[442,21,442,58,0],[443,21,444,53,0],[445,21,445,68,0],[446,21,446,75,0],[448,21,448,28,0],[448,30,448,49,0],[448,50,448,52,0],[448,53,448,62,0],[449,21,449,22,0],[450,25,450,59,0],[451,25,451,26,0],[452,29,459,31,0],[460,29,460,74,0],[461,25,461,26,0],[462,21,462,22,0],[464,21,465,77,0],[466,21,466,49,0],[468,21,468,38,0],[469,21,469,56,0],[470,21,470,36,0],[471,21,471,22,0],[472,25,472,80,0],[473,25,473,26,0],[474,29,474,54,0],[475,29,475,42,0],[477,21,477,22,0],[478,21,478,91,0],[479,21,479,22,0],[480,25,480,104,0],[481,25,481,38,0],[484,21,486,119,0],[487,21,489,71,0],[491,21,491,38,0],[492,21,492,22,0],[493,25,493,42,0],[496,33,497,87,0],[498,33,498,39,0],[500,33,501,87,0],[502,33,502,39,0],[504,33,505,85,0],[506,33,506,39,0],[508,25,508,38,0],[511,21,511,22,0],[512,25,512,103,0],[513,25,513,67,0],[514,25,514,89,0],[516,25,516,98,0],[518,25,519,65,0],[521,25,521,32,0],[521,34,521,64,0],[521,65,521,67,0],[521,68,521,74,0],[522,25,522,26,0],[523,29,524,67,0],[525,29,525,87,0],[526,29,526,51,0],[527,33,527,120,0],[528,25,528,26,0],[532,25,542,28,0],[544,25,544,114,0],[545,25,545,41,0],[546,29,547,123,0],[548,25,548,110,0],[549,25,549,32,0],[549,34,549,44,0],[549,45,549,47,0],[549,48,549,59,0],[550,29,550,59,0],[551,33,551,114,0],[553,25,554,102,0],[555,25,555,42,0],[556,25,556,26,0],[557,29,557,66,0],[558,29,558,68,0],[559,29,560,119,0],[561,29,561,30,0],[562,33,562,104,0],[563,33,563,62,0],[564,33,564,77,0],[565,29,565,30,0],[569,29,569,71,0],[570,29,570,30,0],[572,33,573,56,0],[574,37,574,59,0],[575,41,575,121,0],[576,29,576,30,0],[579,29,579,64,0],[580,29,580,30,0],[581,33,581,148,0],[582,29,582,30,0],[587,29,587,56,0],[588,29,588,30,0],[589,33,589,70,0],[590,33,590,34,0],[591,37,591,91,0],[592,37,594,62,0],[595,37,597,51,0],[599,37,599,77,0],[600,37,600,52,0],[601,37,601,38,0],[602,41,602,82,0],[603,41,603,139,0],[604,41,604,63,0],[608,37,608,38,0],[611,37,611,130,0],[615,37,615,126,0],[616,33,616,34,0],[618,33,618,34,0],[619,37,619,78,0],[620,37,620,126,0],[622,33,622,34,0],[623,29,623,30,0],[624,25,624,26,0],[625,21,625,22,0],[626,21,626,61,0],[627,25,627,70,0],[629,21,629,46,0],[630,25,630,61,0],[633,21,633,22,0],[635,25,635,79,0],[636,25,636,130,0],[638,21,638,22,0],[639,21,639,26,0],[640,21,640,22,0],[642,21,642,22,0],[644,17,644,18,0],[646,17,646,37,0],[647,17,647,18,0],[648,21,648,42,0],[650,21,650,53,0],[652,21,652,53,0],[654,17,654,29,0],[657,13,657,14,0],[658,17,658,44,0],[659,17,659,45,0],[660,17,660,49,0],[662,17,662,49,0],[663,17,663,26,0],[665,9,665,10,0],[668,9,668,10,0],[669,13,669,30,0],[672,13,672,20,0],[673,9,673,10,0],[678,9,678,10,1],[679,13,679,76,1],[680,17,680,29,0],[682,13,682,91,1],[683,13,683,76,1],[685,13,685,159,1],[687,13,687,34,1],[688,9,688,10,1],[692,9,692,10,1],[693,13,693,55,1],[694,17,694,49,1],[696,17,696,50,1],[697,9,697,10,1],[700,9,700,10,0],[701,13,701,37,0],[702,13,702,53,0],[703,9,703,10,0],[706,9,706,10,1],[707,13,707,30,1],[709,13,709,37,1],[711,13,711,53,1],[712,9,712,10,1],[715,9,715,10,1],[716,13,716,75,1],[717,17,717,52,0],[718,9,718,10,1],[721,9,721,10,1],[722,13,722,51,1],[723,17,723,24,0],[726,13,726,105,1],[729,13,729,99,1],[733,13,733,38,1],[734,17,734,57,1],[739,13,739,45,1],[741,13,741,36,1],[742,17,742,51,0],[744,17,744,43,1],[748,13,748,127,1],[749,9,749,10,1],[752,9,752,10,1],[753,13,753,45,1],[754,13,754,44,1],[756,13,756,155,1],[757,17,757,106,1],[759,13,759,57,1],[760,13,760,14,1],[761,17,761,38,1],[762,17,762,18,0],[763,21,763,98,0],[765,21,765,89,0],[766,21,766,85,0],[767,21,767,72,0],[769,21,769,62,0],[770,17,770,18,0],[772,17,772,137,1],[773,17,773,18,1],[774,21,774,174,1],[775,21,775,47,1],[776,17,776,18,1],[777,13,777,14,1],[779,13,779,30,1],[780,9,780,10,1],[783,9,783,10,1],[784,13,784,47,1],[786,13,786,14,1],[787,17,787,41,1],[788,17,788,18,1],[789,21,789,55,1],[790,21,790,33,1],[793,17,793,18,0],[794,21,794,79,0],[795,21,795,33,0],[798,13,798,18,0],[799,13,799,14,0],[800,17,800,30,0],[802,9,802,10,1],[805,9,805,10,1],[807,13,807,36,1],[808,17,808,51,0],[810,17,810,43,1],[812,13,812,79,1],[814,13,814,53,1],[815,9,815,10,1],[818,9,818,10,1],[820,13,820,36,1],[821,17,821,51,0],[823,17,823,43,1],[825,13,825,77,1],[827,13,827,51,1],[828,9,828,10,1],[832,9,832,10,0],[833,13,833,96,0],[834,17,834,104,0],[836,13,836,113,0],[838,13,838,39,0],[839,17,839,39,0],[841,13,841,29,0],[842,9,842,10,0],[849,13,849,14,1],[850,17,850,121,1],[851,13,851,14,1],[856,17,856,18,0],[856,19,856,40,0],[856,41,856,42,0],[857,17,857,18,0],[857,19,857,20,0],[861,9,861,10,0],[863,13,863,14,0],[864,17,864,42,0],[865,21,865,115,0],[866,13,866,14,0],[867,13,867,34,0],[868,13,868,14,0],[869,17,869,27,0],[871,9,871,10,0],[875,9,875,10,0],[877,13,877,14,0],[878,17,878,42,0],[879,21,879,107,0],[880,13,880,14,0],[881,13,881,34,0],[882,13,882,14,0],[883,17,883,27,0],[885,9,885,10,0],[890,9,890,10,1],[891,13,891,46,1],[892,13,892,71,1],[894,9,894,10,1],[896,9,896,10,1],[898,13,898,14,1],[899,17,899,67,1],[900,17,900,75,1],[901,17,901,51,1],[902,17,902,56,1],[903,17,903,72,1],[904,17,904,66,1],[905,17,905,123,1],[906,17,906,58,1],[907,17,907,35,1],[909,17,909,35,1],[910,17,910,42,1],[911,21,911,70,0],[913,13,913,14,1],[914,13,914,33,0],[915,13,915,14,0],[916,17,916,51,0],[917,13,917,14,0],[918,9,918,10,1],[921,9,921,10,1],[923,13,923,27,1],[924,17,924,66,1],[926,17,926,64,1],[927,13,927,66,1],[929,13,929,50,1],[930,13,930,38,1],[931,17,931,50,0],[932,13,932,40,1],[933,13,933,28,1],[935,13,935,69,1],[937,13,937,74,1],[938,17,938,47,0],[940,13,940,67,1],[941,13,941,32,1],[942,13,942,14,1],[943,17,943,95,1],[944,21,944,85,1],[945,13,945,14,1],[949,13,949,90,1],[950,13,950,92,1],[951,13,951,94,1],[953,9,953,10,1],[956,9,956,10,1],[957,13,957,88,1],[958,13,958,53,1],[959,13,959,14,1],[960,17,960,110,1],[961,17,962,99,1],[963,17,963,110,1],[964,17,965,97,1],[966,17,966,120,1],[967,17,967,18,0],[968,21,969,54,0],[971,17,971,18,0],[972,13,972,14,1],[973,9,973,10,1],[976,9,976,10,0],[977,13,977,29,0],[978,13,978,27,0],[979,13,979,48,0],[980,13,980,28,0],[984,21,984,48,0],[986,21,986,47,0],[988,21,988,48,0],[990,21,990,48,0],[992,21,992,48,0],[994,21,994,49,0],[996,21,996,46,0],[998,21,998,44,0],[1000,21,1000,48,0],[1002,21,1002,93,0],[1003,21,1003,104,0],[1005,21,1005,33,0],[1007,9,1007,10,0],[1011,9,1011,10,0],[1012,13,1012,29,0],[1013,13,1013,27,0],[1014,13,1014,31,0],[1015,13,1015,48,0],[1015,49,1015,61,0],[1016,13,1016,64,0],[1017,13,1017,14,0],[1018,17,1018,80,0],[1019,13,1019,14,0],[1020,13,1020,24,0],[1021,9,1021,10,0],[1024,9,1024,10,0],[1025,13,1025,27,0],[1026,13,1026,48,0],[1027,13,1027,28,0],[1031,21,1031,77,0],[1032,21,1032,27,0],[1034,21,1034,76,0],[1035,21,1035,27,0],[1037,21,1037,77,0],[1038,21,1038,27,0],[1040,21,1040,77,0],[1041,21,1041,27,0],[1043,21,1043,77,0],[1044,21,1044,27,0],[1046,21,1046,78,0],[1047,21,1047,27,0],[1049,21,1049,86,0],[1050,21,1050,27,0],[1052,21,1052,84,0],[1053,21,1053,27,0],[1055,21,1055,88,0],[1056,21,1056,27,0],[1058,21,1058,63,0],[1059,21,1059,22,0],[1060,25,1060,62,0],[1061,25,1061,71,0],[1062,21,1062,22,0],[1063,21,1063,27,0],[1065,21,1065,63,0],[1066,21,1066,22,0],[1067,25,1067,67,0],[1068,25,1068,76,0],[1069,21,1069,22,0],[1070,21,1070,27,0],[1072,21,1072,100,0],[1073,21,1073,27,0],[1075,21,1075,34,0],[1077,13,1077,25,0],[1078,9,1078,10,0],[1082,9,1082,10,0],[1083,13,1083,27,0],[1084,13,1084,33,0],[1085,13,1085,101,0],[1086,13,1086,14,0],[1087,17,1087,77,0],[1088,17,1088,31,0],[1089,13,1089,14,0],[1090,13,1090,27,0],[1091,9,1091,10,0],[1094,9,1094,10,1],[1095,13,1096,115,1],[1098,13,1098,111,1],[1099,9,1099,10,1],[1107,9,1107,10,1],[1108,13,1108,51,1],[1109,13,1109,14,1],[1110,17,1110,50,1],[1111,13,1111,14,1],[1113,13,1113,66,1],[1115,13,1115,14,1],[1116,17,1116,75,1],[1117,17,1117,49,1],[1118,17,1118,53,1],[1124,17,1124,40,1],[1125,17,1127,22,1],[1128,17,1128,18,0],[1129,21,1132,82,0],[1133,17,1133,18,0],[1136,17,1136,80,1],[1137,17,1137,57,1],[1138,17,1138,38,1],[1139,17,1139,38,1],[1141,17,1141,78,1],[1144,17,1145,109,1],[1146,17,1146,67,1],[1147,17,1147,18,0],[1148,21,1148,81,0],[1149,21,1149,86,0],[1150,17,1150,18,0],[1152,17,1152,65,1],[1153,21,1153,66,0],[1155,17,1155,76,1],[1157,17,1157,35,1],[1158,17,1158,18,1],[1159,21,1159,72,1],[1160,17,1160,18,1],[1162,17,1162,33,1],[1163,17,1163,18,1],[1164,21,1164,50,1],[1167,21,1169,141,1],[1170,21,1172,145,1],[1173,21,1173,182,1],[1175,25,1175,40,0],[1177,21,1177,22,1],[1178,25,1178,65,1],[1179,25,1179,67,1],[1180,21,1180,22,1],[1183,21,1183,43,1],[1185,21,1185,43,1],[1189,21,1189,50,1],[1190,21,1190,36,1],[1191,21,1193,70,1],[1194,21,1196,70,1],[1198,21,1198,97,1],[1200,21,1200,39,1],[1201,21,1201,22,1],[1202,25,1202,82,1],[1203,25,1203,26,0],[1204,29,1206,86,0],[1207,25,1207,26,0],[1208,25,1208,67,1],[1209,25,1209,48,1],[1212,25,1212,99,1],[1216,25,1216,56,1],[1217,25,1217,26,1],[1218,29,1218,67,1],[1219,33,1219,85,0],[1221,33,1221,110,1],[1222,25,1222,26,1],[1224,25,1224,69,1],[1225,25,1225,65,1],[1228,25,1228,85,1],[1229,25,1229,26,1],[1231,29,1231,67,1],[1232,29,1232,79,1],[1233,29,1233,115,1],[1234,29,1234,36,1],[1234,38,1234,59,1],[1234,60,1234,62,1],[1234,63,1234,72,1],[1235,29,1235,30,1],[1236,33,1239,73,1],[1240,33,1240,66,1],[1241,37,1241,69,0],[1242,29,1242,30,1],[1243,25,1243,26,1],[1245,25,1245,59,1],[1246,25,1246,60,1],[1247,29,1247,77,0],[1249,25,1249,64,1],[1250,25,1250,26,0],[1251,29,1251,52,0],[1252,29,1252,59,0],[1253,25,1253,26,0],[1254,21,1254,22,1],[1258,21,1258,22,1],[1259,25,1259,84,1],[1260,25,1260,26,0],[1261,29,1263,86,0],[1264,25,1264,26,0],[1267,25,1267,105,1],[1269,25,1269,73,1],[1270,25,1270,68,1],[1271,25,1271,65,1],[1273,25,1273,52,1],[1274,25,1274,70,1],[1275,25,1275,26,0],[1276,29,1276,57,0],[1277,25,1277,26,0],[1281,25,1281,85,1],[1282,25,1282,26,1],[1283,29,1283,59,1],[1284,29,1284,63,1],[1285,25,1285,26,1],[1287,25,1287,45,1],[1288,21,1288,22,1],[1291,21,1291,99,1],[1292,21,1292,39,1],[1296,21,1296,74,1],[1297,21,1297,22,0],[1298,25,1298,54,0],[1299,25,1299,51,0],[1300,21,1300,22,0],[1301,21,1301,40,1],[1302,25,1302,32,1],[1302,34,1302,50,1],[1302,51,1302,53,1],[1302,54,1302,77,1],[1303,29,1303,66,1],[1305,21,1308,112,1],[1309,21,1309,108,1],[1310,21,1310,22,1],[1311,25,1311,72,1],[1312,25,1312,70,1],[1313,21,1313,22,1],[1314,21,1314,47,1],[1315,21,1315,22,0],[1316,25,1316,122,0],[1317,21,1317,22,0],[1319,21,1319,68,1],[1335,17,1335,18,1],[1336,17,1336,109,1],[1337,17,1337,18,1],[1338,21,1338,115,1],[1340,17,1340,18,1],[1342,17,1342,78,1],[1343,17,1343,18,0],[1344,21,1344,64,0],[1345,21,1345,65,0],[1346,21,1346,53,0],[1347,17,1347,18,0],[1350,17,1350,84,1],[1351,17,1351,18,1],[1352,21,1352,73,1],[1353,17,1353,18,1],[1355,17,1355,41,1],[1356,13,1356,14,1],[1357,13,1357,33,0],[1358,13,1358,14,0],[1359,17,1359,51,0],[1360,13,1360,14,0],[1362,13,1362,14,1],[1363,17,1363,62,1],[1364,17,1364,18,1],[1365,21,1368,114,1],[1370,21,1370,156,1],[1371,21,1371,22,1],[1372,25,1372,72,1],[1373,25,1373,70,1],[1374,21,1374,22,1],[1375,21,1375,47,1],[1376,21,1376,22,0],[1377,25,1377,122,0],[1378,21,1378,22,0],[1379,17,1379,18,1],[1380,13,1380,14,1],[1382,13,1382,38,1],[1384,13,1384,60,1],[1385,13,1385,59,1],[1386,13,1386,61,1],[1387,13,1387,81,1],[1388,13,1388,79,1],[1389,13,1389,78,1],[1390,13,1390,112,1],[1391,13,1391,89,1],[1393,13,1393,74,1],[1394,13,1394,14,0],[1395,17,1395,48,0],[1396,13,1396,14,0],[1398,17,1398,47,1],[1400,13,1400,50,1],[1401,13,1401,38,1],[1402,17,1402,54,0],[1403,9,1403,10,1],[1406,9,1406,10,1],[1407,13,1407,89,1],[1411,13,1411,70,1],[1412,9,1412,10,1],[1419,9,1419,10,1],[1420,13,1420,65,1],[1421,13,1421,14,1],[1422,17,1424,49,1],[1426,17,1426,63,1],[1427,17,1427,62,1],[1428,17,1428,59,1],[1429,17,1429,71,1],[1430,17,1430,83,1],[1432,17,1432,24,1],[1432,26,1432,37,1],[1432,38,1432,40,1],[1432,41,1432,48,1],[1433,17,1433,18,1],[1434,21,1434,82,1],[1435,17,1435,18,1],[1437,17,1437,56,1],[1438,17,1438,51,1],[1439,17,1439,65,1],[1440,17,1440,40,1],[1440,41,1440,109,0],[1441,17,1442,57,1],[1443,13,1443,14,1],[1444,18,1444,71,0],[1445,13,1445,14,0],[1446,17,1448,50,0],[1450,17,1451,56,0],[1453,17,1453,46,0],[1454,17,1454,56,0],[1455,21,1455,58,0],[1457,17,1457,76,0],[1459,17,1459,55,0],[1460,13,1460,14,0],[1461,9,1461,10,1],[1464,9,1464,10,1],[1465,13,1465,86,1],[1466,13,1466,92,1],[1467,13,1467,69,1],[1468,9,1468,10,1],[1471,9,1471,10,1],[1472,13,1472,75,1],[1474,13,1474,44,1],[1475,13,1475,57,1],[1476,13,1476,58,1],[1477,13,1477,39,1],[1479,13,1479,94,1],[1481,13,1481,27,1],[1482,17,1482,77,1],[1483,9,1483,10,1],[1486,9,1486,10,1],[1487,13,1487,74,1],[1488,9,1488,10,1],[1491,9,1491,10,0],[1492,13,1492,58,0],[1493,13,1493,38,0],[1494,13,1494,38,0],[1496,13,1496,37,0],[1498,13,1498,43,0],[1499,13,1499,14,0],[1500,17,1502,36,0],[1503,17,1503,53,0],[1504,17,1504,18,0],[1505,21,1505,46,0],[1506,21,1506,80,0],[1507,21,1507,41,0],[1508,17,1508,18,0],[1510,17,1510,91,0],[1511,13,1511,14,0],[1512,13,1512,46,0],[1513,13,1513,14,0],[1514,17,1514,63,0],[1515,21,1515,71,0],[1516,13,1516,14,0],[1517,9,1517,10,0],[1520,9,1520,10,1],[1521,13,1521,43,1],[1522,13,1522,49,1],[1523,13,1523,14,1],[1524,17,1525,120,1],[1526,17,1526,53,1],[1527,17,1527,18,1],[1528,21,1528,52,1],[1529,21,1529,98,1],[1530,21,1530,47,1],[1531,17,1531,18,1],[1532,17,1532,97,1],[1533,13,1533,14,1],[1534,13,1534,52,1],[1535,13,1535,14,0],[1536,17,1536,75,0],[1537,21,1537,83,0],[1538,13,1538,14,0],[1539,9,1539,10,1],[1542,9,1542,10,1],[1543,13,1543,44,1],[1544,13,1544,50,1],[1545,13,1545,14,1],[1546,17,1548,36,1],[1549,17,1549,53,1],[1550,17,1550,18,1],[1551,21,1551,36,1],[1552,21,1552,22,0],[1553,25,1553,80,0],[1554,25,1554,45,0],[1555,29,1555,57,0],[1556,21,1556,22,0],[1558,21,1558,53,1],[1559,21,1559,71,1],[1560,21,1560,59,1],[1561,21,1561,48,1],[1563,17,1563,18,1],[1564,17,1564,100,1],[1565,13,1565,14,1],[1566,13,1566,52,1],[1567,13,1567,14,1],[1568,17,1568,76,1],[1569,21,1569,84,1],[1570,13,1570,14,1],[1572,13,1572,94,1],[1573,17,1573,49,0],[1574,9,1574,10,1],[1577,9,1577,10,1],[1578,13,1578,48,1],[1579,13,1579,54,1],[1580,13,1580,14,1],[1581,17,1581,77,1],[1582,17,1582,55,1],[1583,17,1583,18,1],[1584,21,1584,49,1],[1585,21,1585,57,1],[1586,21,1586,22,1],[1587,25,1587,61,1],[1588,25,1588,68,1],[1589,25,1589,67,1],[1590,25,1590,56,1],[1591,21,1591,22,1],[1592,21,1592,106,1],[1593,17,1593,18,1],[1594,13,1594,14,1],[1595,13,1595,40,1],[1596,13,1596,14,0],[1597,17,1597,98,0],[1598,21,1598,106,0],[1599,13,1599,14,0],[1600,9,1600,10,1],[1603,9,1603,10,1],[1604,13,1604,41,1],[1605,13,1605,34,1],[1606,13,1606,82,1],[1608,13,1608,44,1],[1609,13,1609,40,1],[1610,9,1610,10,1],[1613,9,1613,10,1],[1614,13,1614,31,1],[1615,13,1615,14,1],[1616,17,1616,78,1],[1617,17,1617,37,1],[1618,17,1618,18,1],[1621,21,1621,63,1],[1622,21,1622,53,1],[1623,21,1623,83,1],[1624,21,1624,372,1],[1626,25,1627,193,0],[1629,21,1629,52,1],[1630,17,1630,18,1],[1631,13,1631,14,1],[1632,13,1632,67,1],[1633,13,1633,14,1],[1635,17,1635,84,1],[1636,17,1637,65,1],[1638,17,1638,84,1],[1639,13,1639,14,1],[1641,13,1641,50,1],[1642,13,1642,38,1],[1643,17,1643,78,0],[1644,9,1644,10,1],[1651,9,1651,10,1],[1654,13,1654,14,1],[1656,17,1657,109,1],[1658,17,1658,40,1],[1659,17,1659,18,1],[1660,21,1660,53,1],[1661,21,1661,22,0],[1662,25,1666,86,0],[1667,21,1667,22,0],[1668,21,1668,66,1],[1669,21,1669,66,1],[1670,21,1670,52,1],[1671,21,1671,73,1],[1673,21,1673,75,1],[1674,21,1674,84,1],[1676,21,1676,81,1],[1677,21,1677,22,0],[1678,25,1678,119,0],[1679,25,1679,52,0],[1680,25,1680,26,0],[1681,29,1681,108,0],[1682,25,1682,26,0],[1683,21,1683,22,0],[1684,21,1684,66,1],[1685,21,1685,22,0],[1686,25,1686,64,0],[1687,21,1687,22,0],[1689,21,1689,22,1],[1690,25,1690,72,1],[1691,21,1691,22,1],[1695,21,1695,81,1],[1696,21,1696,22,1],[1697,25,1697,65,1],[1698,25,1698,113,1],[1699,21,1699,22,1],[1701,21,1701,69,1],[1703,21,1703,85,1],[1704,21,1704,81,1],[1705,21,1705,89,1],[1707,21,1707,70,1],[1709,21,1709,146,1],[1710,25,1711,68,0],[1712,21,1712,69,1],[1713,25,1713,107,1],[1715,21,1715,53,1],[1716,25,1718,71,0],[1720,25,1720,103,1],[1722,21,1722,60,1],[1724,21,1724,63,1],[1725,21,1725,22,1],[1726,25,1726,138,1],[1728,25,1728,58,1],[1729,29,1729,66,1],[1730,21,1730,22,1],[1732,21,1732,63,1],[1733,21,1733,22,0],[1734,25,1734,59,0],[1735,25,1735,32,0],[1735,34,1735,45,0],[1735,46,1735,48,0],[1735,49,1735,69,0],[1736,25,1736,26,0],[1737,29,1737,89,0],[1738,29,1738,30,0],[1739,33,1739,92,0],[1741,33,1741,39,0],[1743,25,1743,26,0],[1744,21,1744,22,0],[1746,21,1746,70,1],[1747,21,1747,60,1],[1749,21,1749,55,1],[1750,21,1750,22,0],[1751,25,1751,48,0],[1752,25,1752,54,0],[1753,21,1753,22,0],[1755,21,1755,22,1],[1756,25,1756,55,1],[1757,25,1757,47,1],[1758,21,1758,22,1],[1761,21,1761,47,1],[1764,21,1764,50,1],[1767,21,1767,80,1],[1770,21,1770,95,1],[1772,21,1772,96,1],[1773,21,1773,69,1],[1774,17,1774,18,1],[1776,17,1776,83,1],[1777,13,1777,14,1],[1778,13,1778,33,0],[1779,13,1779,14,0],[1780,17,1780,48,0],[1781,13,1781,14,0],[1783,13,1783,31,1],[1784,9,1784,10,1],[1790,9,1790,10,1],[1792,13,1792,14,1],[1794,17,1794,67,1],[1795,17,1795,46,1],[1796,17,1796,18,0],[1797,21,1797,144,0],[1798,21,1798,28,0],[1801,17,1801,42,1],[1802,17,1802,44,1],[1803,17,1803,50,1],[1804,17,1804,56,1],[1805,17,1805,55,1],[1806,17,1806,38,1],[1808,17,1808,92,1],[1810,17,1810,77,1],[1811,17,1811,18,1],[1812,21,1812,68,1],[1813,17,1813,18,1],[1815,17,1815,18,0],[1816,21,1816,73,0],[1819,21,1819,70,0],[1820,21,1820,82,0],[1822,21,1822,28,0],[1822,30,1822,40,0],[1822,41,1822,43,0],[1822,44,1822,59,0],[1823,25,1823,124,0],[1825,17,1825,18,0],[1827,17,1827,35,1],[1828,17,1828,18,1],[1829,21,1829,50,1],[1830,17,1830,18,1],[1832,17,1832,18,1],[1833,21,1833,49,1],[1834,21,1834,52,1],[1835,17,1835,18,1],[1839,17,1839,104,1],[1840,17,1840,18,0],[1842,17,1842,18,0],[1844,17,1844,18,1],[1847,21,1847,69,1],[1849,21,1849,89,1],[1850,21,1850,22,0],[1851,25,1851,79,0],[1852,25,1852,102,0],[1853,21,1853,22,0],[1855,21,1855,22,1],[1856,25,1856,47,1],[1857,25,1857,56,1],[1858,25,1858,94,1],[1859,21,1859,22,1],[1861,21,1861,59,1],[1863,21,1863,42,1],[1865,25,1865,51,1],[1868,21,1868,50,1],[1869,17,1869,18,1],[1870,13,1870,14,1],[1871,13,1871,33,0],[1872,13,1872,14,0],[1873,17,1873,48,0],[1874,13,1874,14,0],[1875,9,1875,10,1],[1882,9,1882,10,1],[1884,13,1884,14,1],[1886,17,1886,36,1],[1887,17,1887,18,1],[1888,21,1888,88,1],[1889,21,1889,37,1],[1890,17,1890,18,1],[1892,17,1892,109,1],[1893,17,1893,80,1],[1895,17,1895,40,1],[1896,17,1896,18,1],[1897,21,1897,49,1],[1898,21,1898,22,1],[1899,25,1899,59,1],[1900,25,1900,53,1],[1901,25,1901,32,1],[1901,34,1901,60,1],[1901,61,1901,63,1],[1901,64,1901,75,1],[1902,25,1902,26,1],[1903,29,1905,63,1],[1906,25,1906,26,1],[1907,21,1907,22,1],[1909,21,1909,22,0],[1910,25,1910,58,0],[1911,21,1911,22,0],[1912,17,1912,18,1],[1914,17,1914,18,0],[1915,21,1915,102,0],[1917,21,1917,44,0],[1918,21,1918,22,0],[1919,25,1919,53,0],[1920,25,1920,99,0],[1922,25,1922,54,0],[1923,25,1923,26,0],[1924,29,1924,36,0],[1924,38,1924,46,0],[1924,47,1924,49,0],[1924,50,1924,64,0],[1925,29,1925,30,0],[1926,33,1926,117,0],[1927,29,1927,30,0],[1929,29,1929,63,0],[1930,25,1930,26,0],[1932,25,1932,26,0],[1933,29,1933,62,0],[1934,25,1934,26,0],[1935,21,1935,22,0],[1936,17,1936,18,0],[1940,17,1940,87,1],[1941,17,1941,18,1],[1942,21,1942,60,1],[1944,21,1944,57,1],[1945,21,1945,58,1],[1946,21,1946,58,1],[1947,21,1947,57,1],[1948,21,1948,55,1],[1949,21,1949,55,1],[1951,21,1951,83,1],[1952,21,1952,28,1],[1952,30,1952,62,1],[1952,63,1952,65,1],[1952,66,1952,79,1],[1953,21,1953,22,1],[1954,25,1955,101,1],[1957,25,1957,50,1],[1958,25,1958,26,1],[1959,29,1959,59,1],[1960,29,1960,75,1],[1961,29,1961,79,1],[1962,29,1962,78,1],[1963,29,1963,79,1],[1964,29,1964,75,1],[1965,29,1965,78,1],[1966,29,1966,50,1],[1967,25,1967,26,1],[1968,21,1968,22,1],[1969,21,1969,46,1],[1970,21,1970,37,1],[1971,17,1971,18,1],[1972,17,1972,45,1],[1973,13,1973,14,1],[1974,13,1974,33,0],[1975,13,1975,14,0],[1976,17,1976,48,0],[1977,13,1977,14,0],[1978,9,1978,10,1],[1981,9,1981,10,1],[1983,13,1983,14,1],[1984,17,1984,52,1],[1985,17,1985,44,1],[1986,17,1986,47,1],[1987,17,1987,100,1],[1988,17,1988,88,1],[1990,17,1990,68,1],[1992,17,1992,46,1],[1993,17,1993,84,1],[1995,17,1995,40,1],[1996,17,1996,18,0],[1997,21,1997,116,0],[1998,21,1998,62,0],[1999,17,1999,18,0],[2001,17,2001,24,1],[2001,26,2001,41,1],[2001,42,2001,44,1],[2001,45,2001,79,1],[2002,17,2002,18,1],[2003,21,2003,28,1],[2003,30,2003,47,1],[2003,48,2003,50,1],[2003,51,2003,69,1],[2004,21,2004,22,1],[2005,25,2005,76,1],[2006,25,2006,75,1],[2007,25,2007,26,1],[2008,29,2008,62,1],[2009,29,2009,59,1],[2010,29,2010,54,1],[2011,25,2011,26,1],[2012,25,2013,65,1],[2014,21,2014,22,1],[2015,17,2015,18,1],[2017,17,2017,24,1],[2017,26,2017,41,1],[2017,42,2017,44,1],[2017,45,2017,79,1],[2018,17,2018,18,1],[2019,21,2019,63,1],[2020,21,2020,65,1],[2021,21,2021,66,1],[2022,21,2022,28,1],[2022,30,2022,47,1],[2022,48,2022,50,1],[2022,51,2022,69,1],[2023,21,2023,22,1],[2024,25,2024,63,1],[2025,25,2025,66,1],[2027,25,2027,61,1],[2029,25,2029,73,1],[2030,25,2030,26,1],[2031,29,2031,36,1],[2031,38,2031,51,1],[2031,52,2031,54,1],[2031,55,2031,65,1],[2032,29,2032,30,1],[2033,33,2034,91,1],[2035,33,2035,34,0],[2036,37,2036,58,0],[2037,37,2037,43,0],[2039,29,2039,30,1],[2040,25,2040,26,1],[2041,21,2041,22,1],[2042,21,2042,41,1],[2043,17,2043,18,1],[2045,17,2045,39,1],[2046,17,2046,18,1],[2047,21,2047,56,1],[2048,21,2048,51,1],[2049,21,2049,91,1],[2050,21,2050,92,1],[2051,17,2051,18,1],[2053,17,2053,18,0],[2054,21,2054,56,0],[2055,21,2057,70,0],[2058,17,2058,18,0],[2060,17,2060,59,1],[2061,13,2061,14,1],[2062,13,2062,33,0],[2063,13,2063,14,0],[2064,17,2064,48,0],[2065,13,2065,14,0],[2066,9,2066,10,1],[2074,9,2074,10,1],[2076,13,2076,14,1],[2078,22,2078,31,1],[2078,33,2078,69,1],[2078,71,2078,74,1],[2079,17,2079,18,1],[2080,21,2080,89,1],[2081,21,2081,44,1],[2082,21,2082,22,1],[2083,25,2083,32,1],[2083,34,2083,46,1],[2083,47,2083,49,1],[2083,50,2083,60,1],[2084,25,2084,26,1],[2085,29,2085,58,1],[2086,29,2086,30,1],[2087,33,2087,61,1],[2088,33,2088,39,1],[2090,25,2090,26,1],[2091,21,2091,22,1],[2093,21,2093,55,1],[2094,21,2094,71,1],[2095,21,2095,22,1],[2096,25,2096,44,1],[2097,25,2097,32,1],[2097,34,2097,66,1],[2097,67,2097,69,1],[2097,70,2097,85,1],[2098,25,2098,26,1],[2099,29,2100,98,1],[2101,29,2101,30,1],[2102,33,2102,46,1],[2103,33,2103,39,1],[2105,25,2105,26,1],[2106,25,2106,35,1],[2107,29,2107,51,1],[2108,21,2108,22,1],[2109,21,2109,54,1],[2110,17,2110,18,1],[2111,13,2111,14,1],[2112,13,2112,33,0],[2113,13,2113,14,0],[2114,17,2114,48,0],[2115,13,2115,14,0],[2116,9,2116,10,1],[2124,9,2124,10,1],[2125,13,2125,78,1],[2126,13,2126,14,0],[2127,17,2127,69,0],[2129,17,2129,85,0],[2130,17,2130,53,0],[2131,13,2131,14,0],[2133,13,2133,14,1],[2134,17,2138,105,1],[2139,13,2139,14,1],[2141,9,2141,10,1],[2149,9,2149,10,0],[2151,13,2151,14,0],[2152,17,2152,85,0],[2153,17,2153,18,0],[2154,21,2155,53,0],[2156,21,2156,66,0],[2158,21,2158,53,0],[2159,17,2159,18,0],[2161,17,2161,18,0],[2162,21,2162,46,0],[2164,21,2164,47,0],[2165,17,2165,18,0],[2166,17,2166,45,0],[2167,13,2167,14,0],[2168,13,2168,33,0],[2169,13,2169,14,0],[2170,17,2170,48,0],[2171,13,2171,14,0],[2172,9,2172,10,0],[2205,9,2205,10,1],[2206,13,2206,43,1],[2251,13,2251,24,1],[2252,9,2252,10,1],[2255,9,2255,10,1],[2256,13,2256,76,1],[2258,13,2258,49,1],[2259,13,2259,67,1],[2260,13,2260,66,1],[2261,13,2261,44,1],[2263,13,2263,99,1],[2264,13,2264,75,1],[2265,9,2265,10,1],[2268,9,2268,10,1],[2269,13,2269,74,1],[2270,9,2270,10,1],[2273,9,2273,10,0],[2274,13,2274,39,0],[2275,13,2275,14,0],[2276,17,2276,47,0],[2277,17,2277,99,0],[2278,13,2278,14,0],[2280,13,2280,14,0],[2281,17,2281,48,0],[2282,17,2282,83,0],[2283,17,2283,36,0],[2284,21,2284,69,0],[2285,13,2285,14,0],[2286,9,2286,10,0],[2289,9,2289,10,0],[2290,13,2290,29,0],[2291,9,2291,10,0],[2294,9,2294,10,0],[2295,13,2295,37,0],[2297,13,2297,14,0],[2298,17,2298,94,0],[2299,17,2299,32,0],[2300,13,2300,14,0],[2301,13,2301,30,0],[2302,13,2302,14,0],[2303,17,2303,32,0],[2304,13,2304,14,0],[2305,9,2305,10,0],[2308,9,2308,10,1],[2309,13,2309,42,1],[2310,13,2310,74,1],[2311,13,2311,69,1],[2312,13,2313,25,1],[2314,13,2314,28,1],[2315,13,2315,51,1],[2316,9,2316,10,1],[2319,9,2319,10,1],[2320,13,2320,44,1],[2321,13,2321,30,1],[2322,13,2322,14,1],[2323,17,2323,81,1],[2324,17,2324,18,0],[2325,21,2325,46,0],[2326,21,2326,22,0],[2327,25,2328,93,0],[2329,25,2329,26,0],[2330,29,2330,81,0],[2331,29,2331,36,0],[2333,21,2333,22,0],[2334,21,2334,50,0],[2335,17,2335,18,0],[2338,21,2338,50,1],[2339,13,2339,14,0],[2340,9,2340,10,0],[2343,9,2343,10,1],[2344,13,2346,98,1],[2348,13,2348,31,1],[2349,13,2349,30,1],[2350,13,2350,29,1],[2351,9,2351,10,1],[2354,9,2354,10,1],[2355,13,2355,63,1],[2356,13,2356,76,1],[2357,9,2357,10,1],[2362,9,2362,10,0],[2363,13,2363,52,0],[2364,13,2364,14,0],[2365,17,2365,77,0],[2366,17,2366,75,0],[2367,17,2367,50,0],[2368,17,2368,43,0],[2369,13,2369,14,0],[2371,13,2371,14,0],[2372,17,2373,49,0],[2374,17,2374,81,0],[2375,17,2375,18,0],[2376,21,2376,66,0],[2377,21,2377,47,0],[2378,21,2378,59,0],[2379,17,2379,18,0],[2381,17,2381,18,0],[2382,21,2382,54,0],[2383,21,2383,47,0],[2384,17,2384,18,0],[2385,13,2385,14,0],[2386,9,2386,10,0],[2389,9,2389,10,1],[2390,13,2390,30,1],[2391,17,2391,24,0],[2393,13,2393,20,1],[2393,22,2393,41,1],[2393,42,2393,44,1],[2393,45,2393,57,1],[2394,13,2394,14,1],[2395,17,2395,46,1],[2396,13,2396,14,1],[2397,9,2397,10,1],[2400,9,2400,10,1],[2401,13,2402,71,1],[2404,13,2404,30,1],[2405,13,2405,14,1],[2406,17,2406,47,1],[2407,17,2407,56,1],[2408,17,2408,57,1],[2409,17,2409,40,1],[2411,17,2411,36,1],[2412,21,2412,99,1],[2415,17,2415,118,1],[2417,17,2417,75,1],[2418,21,2418,80,0],[2420,21,2420,75,1],[2422,17,2422,54,1],[2423,13,2423,14,1],[2424,9,2424,10,1],[2429,9,2429,10,0],[2430,13,2430,60,0],[2431,13,2431,73,0],[2432,13,2432,36,0],[2433,13,2433,89,0],[2435,13,2435,36,0],[2437,13,2437,91,0],[2438,9,2438,10,0],[2441,9,2441,10,0],[2442,13,2442,85,0],[2445,13,2451,16,0],[2452,13,2458,16,0],[2459,13,2465,16,0],[2466,13,2466,32,0],[2467,9,2467,10,0],[2470,9,2470,10,0],[2471,13,2471,47,0],[2475,13,2475,14,0],[2476,17,2476,24,0],[2476,26,2476,58,0],[2476,59,2476,61,0],[2476,62,2476,74,0],[2477,17,2477,18,0],[2478,21,2478,70,0],[2481,21,2481,50,0],[2483,17,2483,18,0],[2484,13,2484,14,0],[2485,13,2485,37,0],[2486,13,2486,14,0],[2487,13,2487,14,0],[2488,9,2488,10,0],[2490,51,2490,55,0],[2490,56,2490,60,0],[2494,9,2494,10,1],[2495,13,2495,98,1],[2497,13,2511,15,1],[2513,13,2513,50,1],[2515,13,2515,50,1],[2517,13,2517,33,1],[2520,9,2520,10,1]]);
    </script>
  </body>
</html>