<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\ModuleManagementComponent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Common;
using System.IO;
using System.Text;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ModuleManagementDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common.Utility;

namespace Aurigo.AMP3.ModuleManagementDAC
{
    internal class ModuleManagementComponent : SingletonManagerBase&lt;ModuleManagementComponent&gt;
    {
        private ModuleManagementComponent()
        {
        }

        /// &lt;summary&gt;
        /// Get the Deployed Modules filterd by &quot;Enterprise&quot; from the Enterprise Database
        /// send as DataTable to BL.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        internal DataTable GetModules(bool onlyActiveModules, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleList&quot;);
                    conn.DB.AddInParameter(cmd, &quot;OnlyActive&quot;, DbType.Int32, onlyActiveModules ? 1 : 0);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get the Module Details from the Database send as DataTable to BL.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;Module ID&lt;/param&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        internal DataTable GetModule(string moduleID, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    return
                        conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleDetail&quot;,
                            new object[] { moduleID })).
                            Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal String GetXMLControlName(int contractID, string formName, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DataSet ds =
                        conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetXMLControlName&quot;,
                            new object[] { contractID, formName }));
                    if (ds.Tables.Count &gt; 0 &amp;&amp; ds.Tables[0].Rows.Count &gt; 0)
                    {
                        return Convert.ToString(ds.Tables[0].Rows[0][&quot;InstanceUrl&quot;]);
                    }
                    else
                        return string.Empty;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Dictionary&lt;int, string&gt; GetModuleFeatures(string moduleID, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var features = new Dictionary&lt;int, string&gt;();
                    using (
                        IDataReader dr =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleFeatures&quot;,
                                new object[] { moduleID }))
                        )
                    {
                        while (dr.Read())
                            features.Add(dr.GetInt32(dr.GetOrdinal(&quot;FeaturesID&quot;)),
                                dr.GetString(dr.GetOrdinal(&quot;FeaturesDescription&quot;)));
                    }
                    return features;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Dictionary&lt;int, string[]&gt; GetModuleFeaturesWithDetails(string moduleID, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    Dictionary&lt;int, string[]&gt; features = new Dictionary&lt;int, string[]&gt;();
                    using (
                        IDataReader dr =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleFeatures&quot;,
                                new object[] { moduleID })))
                    {
                        while (dr.Read())
                            features.Add(dr.GetInt32(dr.GetOrdinal(&quot;FeaturesID&quot;)),
                                new string[]
                                {
                                    dr.GetString(dr.GetOrdinal(&quot;FeatureCode&quot;)),
                                    dr.GetString(dr.GetOrdinal(&quot;FeaturesDescription&quot;))
                                });
                    }
                    return features;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the permission Matrix for a given module
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;ModuleID&lt;/param&gt;
        /// &lt;returns&gt;Dictionary of permissions&lt;/returns&gt;
        internal Dictionary&lt;int, List&lt;int&gt;&gt; GetPermissionMatrix(string moduleID, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                var matrix = new Dictionary&lt;int, List&lt;int&gt;&gt;();
                using (
                    IDataReader dr =
                        conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetPermissionMatrix&quot;,
                            new object[] { moduleID }))
                    )
                {
                    while (dr.Read())
                    {
                        int featureID = dr[&quot;FeaturesID&quot;].ToInt32_2();
                        if (!matrix.ContainsKey(featureID))
                            matrix.Add(featureID, new List&lt;int&gt;());
                        matrix[featureID].Add(dr[&quot;RoleID&quot;].ToInt32_2());
                    }
                }
                return matrix;
            }
        }

        /// &lt;summary&gt;
        /// Add a Module, called when a module is uploaded
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;module&quot;&gt;ModuleDetails object contains all the details about a module, its ID, name, StartUp, ParentModule etc&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        internal int AddModule(ModuleDetails module, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                int rtnValue;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddModule&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, module.ModuleID);
                conn.DB.AddInParameter(cmd, &quot;ModuleName&quot;, DbType.String, module.Name);
                conn.DB.AddInParameter(cmd, &quot;ModuleDescription&quot;, DbType.String, module.Description);

                conn.DB.AddInParameter(cmd, &quot;Version&quot;, DbType.String, module.Version);
                conn.DB.AddInParameter(cmd, &quot;NavigateUrl&quot;, DbType.String, module.NavigateUrl);
                conn.DB.AddInParameter(cmd, &quot;IsActive&quot;, DbType.Boolean, module.IsActive);

                conn.DB.AddInParameter(cmd, &quot;UploadedDate&quot;, DbType.DateTime, module.UploadedDate);
                conn.DB.AddInParameter(cmd, &quot;UploadedBy&quot;, DbType.String, module.UploadedBy);
                conn.DB.AddInParameter(cmd, &quot;IsCoreModule&quot;, DbType.Boolean, module.IsCoreModule);

                conn.DB.AddInParameter(cmd, &quot;ModuleType&quot;, DbType.String, module.ModuleType);
                conn.DB.AddInParameter(cmd, &quot;ModuleGroup&quot;, DbType.String, module.ModuleGroup);
                conn.DB.AddInParameter(cmd, &quot;ParentModule&quot;, DbType.String, module.ParentModule);
                conn.DB.AddInParameter(cmd, &quot;SiteMapXml&quot;, DbType.String, module.SiteMapXml);

                conn.DB.AddInParameter(cmd, &quot;InstanceUrl&quot;, DbType.String, module.InstanceUrl);
                conn.DB.AddInParameter(cmd, &quot;IsSearchable&quot;, DbType.Boolean, module.IsSearchable);
                conn.DB.AddInParameter(cmd, &quot;MainDll&quot;, DbType.String, module.MainDll);

                conn.DB.AddInParameter(cmd, &quot;Folder&quot;, DbType.String, module.Folder);
                conn.DB.AddInParameter(cmd, &quot;HasSubTree&quot;, DbType.Boolean, module.HasSubTree);
                conn.DB.AddInParameter(cmd, &quot;ConfigUrl&quot;, DbType.String, module.ConfigUrl);
                conn.DB.AddInParameter(cmd, &quot;ReportLogo&quot;, DbType.String, module.ReportLogo);
                conn.DB.AddInParameter(cmd, &quot;BLClassName&quot;, DbType.String, module.BLClassName);
                conn.DB.AddInParameter(cmd, &quot;AssociatedModuleID&quot;, DbType.String, module.AssociatedModuleID);
                conn.DB.AddInParameter(cmd, &quot;AssociatedContext&quot;, DbType.String, module.AssociatedContext);
                conn.DB.AddInParameter(cmd, &quot;IsSingleInstance&quot;, DbType.Boolean, module.IsSingleInstance);
                conn.DB.AddInParameter(cmd, &quot;IsMapEnabled&quot;, DbType.Boolean, module.IsMapEnabled);

                conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                rtnValue = (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);

                foreach (var feature in module.Features)
                    AddModuleFeature(module.ModuleID, feature.Key, feature.Value, company);

                // Clear cached object when updating module table
                CoreDatabaseHelper.ClearModuleDetails(module.ModuleID);

                return rtnValue;
            }
        }

        internal void AddModuleFeature(string moduleID, string featureCode, string featureDescription,
            string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddFeature&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;FeatureCode&quot;, DbType.String, featureCode);
                conn.DB.AddInParameter(cmd, &quot;FeaturesDescription&quot;, DbType.String, featureDescription);
                conn.DB.ExecuteNonQuery(cmd);
            }
        }

        /// &lt;summary&gt;
        /// Delete feature from the database, also all permission records are purged
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;The ModuleID&lt;/param&gt;
        /// &lt;param name=&quot;featureCode&quot;&gt;The Feature Code&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        public int DeleteModuleFeature(string moduleID, string featureCode, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                return
                    conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTDeleteFeature&quot;,
                        new object[] { moduleID, featureCode }));
            }
        }

        /// &lt;summary&gt;
        /// Delete Module removes a Module from the Database. also all dependencies, Platforms records are purged
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;The ModuleID&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        internal int DeleteModule(string moduleID, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                return
                    conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTDeleteModule&quot;,
                        new object[] { moduleID }));
            }
        }

        internal bool ModuleExists(string moduleID)
        {
            object result =
               ComponentHelper.Instance.ExecuteScalar(&quot;select * from MODMGMTModules where ModuleID in (select ID from dbo.fnSplitToVarchar({0}))&quot;, moduleID);
            if (result == null)
                return false;
            else
                return true;
        }

        /// &lt;summary&gt;
        /// Updates a Module Permission Matrix, given the moduleID
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;ModuleID&lt;/param&gt;
        /// &lt;param name=&quot;matrix&quot;&gt;hashtable of matrix&lt;/param&gt;
        /// &lt;param name=&quot;adminRoleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;loggingflag&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;param name=&quot;loggingflag&quot;&gt;&lt;/param&gt;
        internal bool UpdatePermissionMatrix(string moduleID, Dictionary&lt;int, List&lt;int&gt;&gt; matrix, int adminRoleID,
            bool loggingflag, bool? isSearchable = null, string company = null, bool enableEditByNonStakeHolder = false, bool allowActionByAllStakeHolders = false)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                //delete all permissions and adding permissions for admin role
                conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTDelAllPermissions&quot;,
                    new object[] { moduleID, adminRoleID }));

                if (matrix != null &amp;&amp; matrix.Count &gt; 0)
                {
                    foreach (var feature in matrix)
                    {
                        foreach (int role in feature.Value)
                        {
                            conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddPermissionMatrix&quot;,
                                new object[] { moduleID, feature.Key, role }));
                        }
                    }
                }

                //to update module loggingvalue
                conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTUpdateModuleDetails&quot;,
                    new object[] { moduleID, loggingflag ? 1 : 0, isSearchable.HasValue &amp;&amp; isSearchable.Value ? 1 : 0, enableEditByNonStakeHolder ? 1 : 0, allowActionByAllStakeHolders ? 1 : 0 }));

                // Clear the cache
                CoreDatabaseHelper.ClearModuleDetails(moduleID);
                return true;
            }
        }

        /// &lt;summary&gt;
        /// Updates a Rrport Permission Matrix, given the moduleID
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;ModuleID&lt;/param&gt;
        /// &lt;param name=&quot;matrix&quot;&gt;hashtable of matrix&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;param name=&quot;loggingflag&quot;&gt;&lt;/param&gt;
        internal bool UpdateRptPermissionMatrix(string moduleID, Dictionary&lt;int, List&lt;int&gt;&gt; matrix,
            string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                //delete all rpt permissions and adding permissions
                conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTDelAllRptPermissions&quot;,
                    new object[] { moduleID }));
                foreach (var feature in matrix)
                    foreach (int role in feature.Value)
                        conn.DB.ExecuteNonQuery(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddPermissionMatrix&quot;,
                            new object[] { moduleID, feature.Key, role }));
                return true;
            }
        }

        internal DataTable GetModuleSummary(string company)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                return conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModulesSummary&quot;)).Tables[0];
            }
        }

        internal List&lt;string&gt; GetPermissionByRole(string moduleID, int roleID, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                var features = new List&lt;string&gt;();
                using (
                    IDataReader dr =
                        conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetPermissionByRole&quot;,
                            new object[] { moduleID, roleID })))
                {
                    while (dr.Read())
                        features.Add(dr.GetString(dr.GetOrdinal(&quot;FeatureCode&quot;)));
                }
                return features;
            }
        }

        internal List&lt;string&gt; GetPermissionByUserOrRole(string moduleID, int userId, int roleId, int projectId = 0,
            string company = null, bool convertResultToLowercase = false)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                var features = new List&lt;string&gt;();
                using (
                    IDataReader dr =
                        conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetPermissionByUserOrRole&quot;,
                            new object[] { moduleID, userId, roleId, projectId })))
                {
                    while (dr.Read())
                        features.Add(convertResultToLowercase ? dr.GetString(dr.GetOrdinal(&quot;FeatureCode&quot;)).ToLower() : dr.GetString(dr.GetOrdinal(&quot;FeatureCode&quot;)));
                }
                return features;
            }
        }

        /// &lt;summary&gt;
        /// Execute a SQL Script
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;SQLScript&quot;&gt;a valid SQL script&lt;/param&gt;
        /// &lt;returns&gt;An int representing the number of rows affected by the command&lt;/returns&gt;
        internal int RunSQLScript(string SQLScript, bool updateAllDbs, List&lt;ModuleUploadResult&gt; status,
            string moduleName)
        {
            return 0;
        }

        internal DataTable GetModulesByParent(string parentID, string company = null,
            bool fetchOnlyActiveModules = false)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                return
                    conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleByParent&quot;,
                        new object[] { parentID, fetchOnlyActiveModules })).
                        Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Add a New Deployment platform &quot;Web&quot; or &quot;PocketPC&quot; for a module
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;newPlatform&quot;&gt;ModulePlatform object containing all info for Platform of the Module&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        internal int AddPlatform(ModulePlatform newPlatform, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                int rtnValue;

                // Create a command and prepare it for execution

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddPlatform&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, newPlatform.ModuleID);
                conn.DB.AddInParameter(cmd, &quot;PlatformKey&quot;, DbType.String, newPlatform.PlatformKey);
                conn.DB.AddInParameter(cmd, &quot;PlatformName&quot;, DbType.String, newPlatform.PlatformName);
                conn.DB.AddInParameter(cmd, &quot;Version&quot;, DbType.String, newPlatform.Version);
                conn.DB.AddOutParameter(cmd, &quot;PlatformID&quot;, DbType.Int32, 4);
                conn.DB.ExecuteScalar(cmd);
                rtnValue = (int)conn.DB.GetParameterValue(cmd, &quot;PlatformID&quot;);
                newPlatform.PlatformID = rtnValue;
                return rtnValue;
            }
        }

        /// &lt;summary&gt;
        /// Add a New Module File, given the ModuleID and the PlatformID
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;newFile&quot;&gt;ModuleFile object contains the moduleid, platform id, file info and the full file path&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        internal int AddModuleFile(ModuleFile newFile, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                // Create a command and prepare it for execution

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddFile&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, newFile.ModuleID);
                conn.DB.AddInParameter(cmd, &quot;PlatformKey&quot;, DbType.String, newFile.PlatformKey);
                conn.DB.AddInParameter(cmd, &quot;FilePath&quot;, DbType.String, newFile.FilePath);
                conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);

                return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
            }
        }

        /// &lt;summary&gt;
        /// Update the Module Dependency Matrix for the given module
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;The moduleID&lt;/param&gt;
        /// &lt;param name=&quot;moduleDependencies&quot;&gt;A string aray of module dependencies&lt;/param&gt;
        /// &lt;returns&gt;success/failure&lt;/returns&gt;
        internal int UpdateModuleDependencies(string moduleID, Dictionary&lt;string, string&gt; moduleDependencies,
            string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                string dependency = &quot;&quot;;
                foreach (var moduleDependency in moduleDependencies)
                    dependency += moduleDependency.Key + &quot;,&quot;;
                dependency = dependency.Substring(0, dependency.Length - 1);

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTUpdateModDepn&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;ModuleDependencies&quot;, DbType.String, dependency);
                conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);

                conn.DB.ExecuteNonQuery(cmd);

                return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
            }
        }

        /// &lt;summary&gt;
        /// Adds an application to database
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int AddApplication(ApplicationDetails app, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var sb = new StringBuilder();
                    sb.Append(&quot;&lt;Links&gt;&quot;);
                    List&lt;KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;&gt;.Enumerator en = app.Links.GetEnumerator();
                    while (en.MoveNext())
                    {
                        sb.Append(&quot;&lt;Link&gt;&quot;);
                        sb.Append(&quot;&lt;type&gt;&quot; + en.Current.Key + &quot;&lt;/type&gt;&quot;);
                        sb.Append(&quot;&lt;name&gt;&quot; + en.Current.Value.Key + &quot;&lt;/name&gt;&quot;);
                        sb.Append(&quot;&lt;detail&gt;&quot; + en.Current.Value.Value + &quot;&lt;/detail&gt;&quot;);
                        sb.Append(&quot;&lt;/Link&gt;&quot;);
                    }
                    sb.Append(&quot;&lt;/Links&gt;&quot;);

                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTAddApplication&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_XML&quot;, DbType.String, sb.ToString2());
                    conn.DB.AddInParameter(cmd, &quot;in_Name&quot;, DbType.String, app.ApplicationName);
                    conn.DB.AddInParameter(cmd, &quot;in_FullName&quot;, DbType.String, app.FullName);
                    conn.DB.AddInParameter(cmd, &quot;in_Version&quot;, DbType.String, app.Version);
                    conn.DB.AddInParameter(cmd, &quot;in_Type&quot;, DbType.String, app.ApplicationType);
                    conn.DB.AddInParameter(cmd, &quot;in_Folder&quot;, DbType.String, app.Folder);
                    conn.DB.AddInParameter(cmd, &quot;in_Path&quot;, DbType.String, app.Path);
                    conn.DB.AddInParameter(cmd, &quot;in_Desc&quot;, DbType.String, app.Description);
                    conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Adds application types supported to database
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;appTypes&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int AddApplicationTypes(Dictionary&lt;string, string&gt; appTypes, string company = null)
        {
            try
            {
                var sbAppTypes = new StringBuilder();
                sbAppTypes.Append(&quot;&lt;AppTypes&gt;&quot;);
                foreach (var type in appTypes)
                {
                    sbAppTypes.Append(&quot;&lt;Type&gt;&quot;);
                    sbAppTypes.Append(&quot;&lt;ID&gt;&quot;);
                    sbAppTypes.Append(type.Key);
                    sbAppTypes.Append(&quot;&lt;/ID&gt;&quot;);
                    sbAppTypes.Append(&quot;&lt;Name&gt;&quot;);
                    sbAppTypes.Append(type.Value);
                    sbAppTypes.Append(&quot;&lt;/Name&gt;&quot;);
                    sbAppTypes.Append(&quot;&lt;/Type&gt;&quot;);
                }
                sbAppTypes.Append(&quot;&lt;/AppTypes&gt;&quot;);
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTAddAppTypes&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_XML&quot;, DbType.String, sbAppTypes.ToString2());
                    conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                return 0;
            }
        }

        /// &lt;summary&gt;
        /// Gets a collection of the modules that have the parent ID as the parameter passed here and supported platforms for those module
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parentModuleID&quot;&gt;The parent moduleid&lt;/param&gt;
        /// &lt;returns&gt;A Dataet containing all values&lt;/returns&gt;
        internal DataSet GetModulePlatforms(string parentModuleID, bool excludeTempleteModules, string company = null)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
            {
                return
                    conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModulePlatforms&quot;,
                        new object[] { parentModuleID, excludeTempleteModules }));
            }
        }

        /// &lt;summary&gt;
        /// Get a list of strings containing filepaths for a given platform and module
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;The module we are querying&lt;/param&gt;
        /// &lt;param name=&quot;platformKey&quot;&gt;The platform we want the files of&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;param name=&quot;platformKey&quot;&gt;&lt;/param&gt;
        internal List&lt;string&gt; GetModuleFiles(string moduleID, string platformKey, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var files = new List&lt;string&gt;();
                    using (
                        IDataReader reader =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModuleFiles&quot;,
                                new object[] { moduleID, platformKey })))
                    {
                        while (reader.Read())
                            files.Add(reader.GetString(0));
                    }
                    return files;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get all the available platforms
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        internal Dictionary&lt;string, string&gt; GetPlatformList(string company)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var platformList = new Dictionary&lt;string, string&gt;();
                    using (
                        IDataReader reader =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetPlatformList&quot;)))
                    {
                        while (reader.Read())
                        {
                            platformList.Add(reader.GetString(reader.GetOrdinal(&quot;PlatformKey&quot;)),
                                reader.GetString(reader.GetOrdinal(&quot;PlatformName&quot;)));
                        }
                    }
                    return platformList;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal List&lt;string&gt; GetModulesForaRole(int RoleID, string FeaturesCode, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var ModuleList = new List&lt;string&gt;();
                    using (
                        IDataReader reader =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModulesForaRole&quot;,
                                new object[] { RoleID, FeaturesCode })))
                    {
                        while (reader.Read())
                        {
                            ModuleList.Add(reader.GetString(reader.GetOrdinal(&quot;ModuleID&quot;)));
                        }
                    }
                    return ModuleList;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal int GetVisibilityFeatureID(string ModuleID, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    using (
                        IDataReader reader =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetVisFeatureID&quot;,
                                new object[] { ModuleID }))
                        )
                        if (reader.Read())
                            return reader.GetInt32(reader.GetOrdinal(&quot;FeatureID&quot;));
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
            return 0;
        }

        /// &lt;summary&gt;
        /// Fetches all the links to downloadable applications
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetAllApplications(string company)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    return conn.DB.ExecuteDataSet(&quot;dbo.usp_APPMGMTGetAllApplications&quot;, null).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches all the downladable applications
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Dictionary&lt;string, string&gt; GetApplicationTypes(string company)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DataSet ds = conn.DB.ExecuteDataSet(&quot;dbo.usp_APPMGMTGetAppTypes&quot;, null);
                    if (ds.Tables.Count &gt; 0)
                    {
                        var list = new Dictionary&lt;string, string&gt;();
                        foreach (DataRow dr in ds.Tables[0].Rows)
                        {
                            list.Add(dr[&quot;TypeID&quot;].ToString2(), dr[&quot;TypeName&quot;].ToString2());
                        }
                        return list;
                    }

                    return null;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches details of an application
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;appID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal ApplicationDetails GetApplicationDetails(int appID, string company = null)
        {
            ApplicationDetails appln;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    appln = new ApplicationDetails();

                    appln.ApplicationID = appID;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTGetApplicationDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_AppID&quot;, DbType.Int32, appID);
                    DataSet ds = conn.DB.ExecuteDataSet(cmd);

                    if (ds.Tables[0].Rows.Count &gt; 0)
                    {
                        DataRow dr = ds.Tables[0].Rows[0];
                        appln.ApplicationName = dr[&quot;AppName&quot;].ToString2();
                        appln.ApplicationType = dr[&quot;AppType&quot;].ToString2();
                        appln.Description = dr[&quot;Description&quot;].ToString2();
                        appln.FullName = dr[&quot;FullName&quot;].ToString2();
                        appln.Folder = dr[&quot;AppFolder&quot;].ToString2();
                        appln.Path = dr[&quot;AppPath&quot;].ToString2();
                        appln.Version = dr[&quot;Version&quot;].ToString2();

                        var links = new List&lt;KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;&gt;();
                        if (ds.Tables[1].Rows.Count &gt; 0)
                        {
                            foreach (DataRow linkRow in ds.Tables[1].Rows)
                            {
                                string key = linkRow[&quot;LinkType&quot;].ToString2();
                                var kvp = new KeyValuePair&lt;string, string&gt;(linkRow[&quot;DisplayName&quot;].ToString2(),
                                    linkRow[&quot;LinkDetails&quot;].ToString2());
                                links.Add(new KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;(key, kvp));
                            }
                        }
                        appln.Links = links;
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
            return appln;
        }

        /// &lt;summary&gt;
        /// Deletes applications from database
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;IDList&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteApplications(List&lt;int&gt; IDList, string company = null)
        {
            try
            {
                if (IDList.Count &gt; 0)
                {
                    var sbIDList = new StringBuilder();
                    sbIDList.Append(&quot;&lt;root&gt;&quot;);
                    List&lt;int&gt;.Enumerator en = IDList.GetEnumerator();
                    while (en.MoveNext())
                    {
                        sbIDList.Append(&quot;&lt;Delete&gt;&quot;);
                        sbIDList.Append(&quot;&lt;ID&gt;&quot; + en.Current + &quot;&lt;/ID&gt;&quot;);
                        sbIDList.Append(&quot;&lt;/Delete&gt;&quot;);
                    }
                    sbIDList.Append(&quot;&lt;/root&gt;&quot;);
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_APPMGMTDeleteApplications&quot;);
                        conn.DB.AddInParameter(cmd, &quot;in_XML&quot;, DbType.String, sbIDList.ToString2());

                        conn.DB.AddParameter(cmd, &quot;Result&quot;, DbType.Int32, ParameterDirection.ReturnValue, &quot;Result&quot;,
                            DataRowVersion.Default, new Int32());
                        conn.DB.ExecuteNonQuery(cmd);

                        return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
                    }
                }
                else
                    return 0;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches path to application file on server
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;Platform&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;appType&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;application&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;version&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal string GetApplicationFilePath(string Platform, string appType, string application, string version,
            string company = null)
        {
            string retVal = &quot;&quot;;
            try
            {
                if (Platform.ToUpper2().Equals(&quot;APPLICTION&quot;))
                {
                    DataRow[] rows =
                        GetAllApplications(company).Select(&quot;TypeID = &#39;&quot; + appType + &quot;&#39; AND AppName = &#39;&quot; + application +
                                                           &quot;&#39; AND Version = &#39;&quot; + version + &quot;&#39;&quot;);
                    if (rows.Length &gt; 0)
                    {
                        return &quot;{0}\\{1}&quot;.Format2(rows[0][&quot;AppPath&quot;], rows[0][&quot;FullName&quot;]);
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
            return retVal;
        }

        /// &lt;summary&gt;
        /// Gets latest version and its content length as an xml string,
        /// returns empty string if higher version is not available
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;Platform&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;appType&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;application&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;version&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal string HasLatestApplication(string Platform, string appType, string application, string version,
            string company = null)
        {
            string RtnXml = &quot;&quot;;
            try
            {
                if (Platform.ToUpper2().Equals(&quot;APPLICTION&quot;))
                {
                    bool found = false;
                    DataRow newVersionRow = null;
                    DataRow[] rows =
                        GetAllApplications(company)
                            .Select(&quot;TypeID = &#39;&quot; + appType + &quot;&#39; AND AppName = &#39;&quot; + application + &quot;&#39;&quot;);
                    if (rows.Length &gt; 0)
                    {
                        string[] inVer = version.Split(&#39;.&#39;);
                        foreach (DataRow dr in rows)
                        {
                            string[] newVer = dr[&quot;Version&quot;].ToString2().Split(&#39;.&#39;);
                            int len = (inVer.Length &lt; newVer.Length) ? inVer.Length : newVer.Length;
                            for (int i = 0; i &lt; len; i++)
                            {
                                if (newVer[i].ToString2().ToInt32_2() &gt; inVer[i].ToString2().ToInt32_2())
                                {
                                    found = true;
                                    newVersionRow = dr;
                                    break;
                                }
                            }
                        }
                    }
                    if (found) // has latest application ....
                    {
                        string filePath = &quot;{0}\\{1}&quot;.Format2(newVersionRow[&quot;AppPath&quot;], newVersionRow[&quot;FullName&quot;]);
                        RtnXml =
                            &quot;&lt;Application&gt;&lt;Version&gt;{0}&lt;/Version&gt;&lt;ContentLength&gt;{1}&lt;/ContentLength&gt;&lt;/Application&gt;&quot;.
                                Format2(newVersionRow[&quot;Version&quot;], new FileInfo(filePath).Length);
                        return RtnXml;
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
            return RtnXml;
        }

        internal int AddPermissions(int roleID, string ModuleId, string Feature, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTAddPermissions&quot;);
                    conn.DB.AddInParameter(cmd, &quot;RoleId&quot;, DbType.Int32, roleID);
                    conn.DB.AddInParameter(cmd, &quot;FeatureCode&quot;, DbType.String, Feature);
                    conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, ModuleId);

                    conn.DB.AddParameter(cmd, &quot;Result&quot;, DbType.Int32, ParameterDirection.Output, &quot;Result&quot;,
                        DataRowVersion.Default,
                        new Int32());
                    conn.DB.ExecuteNonQuery(cmd);

                    return (int)conn.DB.GetParameterValue(cmd, &quot;Result&quot;);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal DataTable GetRolesForaFeature(string ModuleId, string FeatureCode, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetRolesForFeature&quot;);

                    conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, ModuleId);
                    conn.DB.AddInParameter(cmd, &quot;FeatureCode&quot;, DbType.String, FeatureCode);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal string GetReportLogoPath(string moduleId, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3GetReportImagePath&quot;);
                    conn.DB.AddInParameter(cmd, &quot;moduleId&quot;, DbType.String, moduleId);
                    conn.DB.AddOutParameter(cmd, &quot;imageName&quot;, DbType.String, 50);
                    conn.DB.ExecuteScalar(cmd);

                    return (conn.DB.GetParameterValue(cmd, &quot;imageName&quot;).ToString2() == &quot;&quot;)
                        ? AMP3ApplicationSettings.Instance.AppLogo
                        : &quot;~/Modules/MODMGMT/Images/&quot; + conn.DB.GetParameterValue(cmd, &quot;imageName&quot;).ToString2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal int AddImageDetails(string name, string desc, string imagePath, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3AddImageDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;logoName&quot;, DbType.String, name);
                    conn.DB.AddInParameter(cmd, &quot;description&quot;, DbType.String, desc);
                    conn.DB.AddInParameter(cmd, &quot;imageName&quot;, DbType.String, imagePath);
                    conn.DB.AddOutParameter(cmd, &quot;result&quot;, DbType.Int32, 2);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;result&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal List&lt;LogoDetails&gt; GetImagedetails(string company)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var logoList = new List&lt;LogoDetails&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3GetImageDetails&quot;);
                    using (IDataReader reader = conn.DB.ExecuteReader(cmd))
                    {
                        while (reader.Read())
                        {
                            var dto = new LogoDetails();
                            dto.ImageID = reader.GetInt32(reader.GetOrdinal(&quot;ImageId&quot;));
                            dto.Name = reader.GetString(reader.GetOrdinal(&quot;Name&quot;));
                            dto.Description = reader.GetString(reader.GetOrdinal(&quot;Description&quot;));
                            dto.Image = reader.GetString(reader.GetOrdinal(&quot;Image&quot;));
                            logoList.Add(dto);
                        }
                    }
                    return logoList;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.LINKS);
                throw;
            }
        }

        internal int DeleteImageDetails(string imageId, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3DeleteImageDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;imageId&quot;, DbType.String, imageId);
                    return conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal int UpdateImageDetails(string name, string imagePath, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AMP3UpdateImageDetails&quot;);
                    conn.DB.AddInParameter(cmd, &quot;logoName&quot;, DbType.String, name);
                    conn.DB.AddInParameter(cmd, &quot;imageName&quot;, DbType.String, imagePath);
                    conn.DB.AddOutParameter(cmd, &quot;result&quot;, DbType.Int32, 2);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;result&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal int UpdateReportLogos(string name, string selectedModules, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTUpdateModRptLogos&quot;);
                    conn.DB.AddInParameter(cmd, &quot;logoName&quot;, DbType.String, name);
                    conn.DB.AddInParameter(cmd, &quot;modules&quot;, DbType.String, selectedModules);
                    return conn.DB.ExecuteNonQuery(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        internal int AddModuleAttributes(string moduleId, string attrName, string attrValue)
        {
            throw new Exception(&quot;The method or operation is not implemented.&quot;);
        }

        internal DataTable GetViewVisibilityFeatureIDS(string moduleID, string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    return
                        conn.DB.ExecuteDataSet(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetVisFeatureID&quot;,
                            new object[] { moduleID })).
                            Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public DataTable GetAllModulePermissions(string roleID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure
                        .usp_MODMGMTGetAllModulePermissions, null, roleID).Tables[0];
        }

        internal DataTable GetAllModulePermissionsWithLibrary(string roleID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure
                        .usp_MODMGMTGetAllModulePermissionsWithLibrary, null, roleID).Tables[0];
        }

        public DataTable GetModuleComponenets(string moduleId)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(
                    Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTGetModuleComponents,
                    null, moduleId);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        public DataTable GetMapEnabledFormsForProject(string ProjectID)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(
                    Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure
                        .usp_CONTMGTGetMapEnabledFormsForProject, null, ProjectID);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        #region Module Upload

        public void LogModuleUploadMaster(ModuleUploadMaster dto)
        {
            ComponentHelper.Instance.ExecuteNonQueryOn(ConnectionHelper.DefaultConnectionString(),
                Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTLogModuleUploadMaster,
                null, dto);
        }

        public void LogModuleUploadDetails(ModuleUploadDetails dto)
        {
            ComponentHelper.Instance.ExecuteNonQueryOn(ConnectionHelper.DefaultConnectionString(),
                Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTLogModuleUploadDetails,
                null, dto);
        }

        public void ClearModuleUploadLogs()
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParametersOn(
                ConnectionHelper.DefaultConnectionString(),
                Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTClearModuleUploadLogs,
                null, null);
        }

        public List&lt;ModuleUploadDetails&gt; GetModuleUploadLogs(int? LogID)
        {
            List&lt;ModuleUploadDetails&gt; listDto = new List&lt;ModuleUploadDetails&gt;();
            DataSet ds = ComponentHelper.Instance.ExecuteDataSetOn(ConnectionHelper.DefaultConnectionString(),
                Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTGetModuleUploadLogs, null,
                new object[] { LogID });
            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
            {
                foreach (DataRow dr in ds.Tables[0].Rows)
                {
                    ModuleUploadDetails dto = new ModuleUploadDetails();
                    dr.FillDTO(dto);
                    listDto.Add(dto);
                }
            }
            return listDto;
        }

        public List&lt;ModuleUploadDetails&gt; GetModuleUploadLogsForMessageLevel(int MessageLevel, int? LogID = null)
        {
            List&lt;ModuleUploadDetails&gt; listDto = new List&lt;ModuleUploadDetails&gt;();
            DataSet ds = ComponentHelper.Instance.ExecuteDataSetOn(ConnectionHelper.DefaultConnectionString(),
                Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure.usp_MODMGMTGetModuleUploadLogsForMessageLevel, null,
                new object[] { MessageLevel, LogID });
            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
            {
                foreach (DataRow dr in ds.Tables[0].Rows)
                {
                    ModuleUploadDetails dto = new ModuleUploadDetails();
                    dr.FillDTO(dto);
                    listDto.Add(dto);
                }
            }
            return listDto;
        }

        #endregion Module Upload

        public DataTable GetAllMapEnabledFormsForProject(string ProjectID)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(
                    Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.StoredProcedure
                        .usp_CONTMGTGetAllMapEnabledFormsForProject, null, ProjectID);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        internal List&lt;string&gt; GetModulesForaUserOrRole(int UserID, int RoleID, int ProjectID, string FeaturesCode,
            string company = null)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString(company)))
                {
                    var ModuleList = new List&lt;string&gt;();
                    using (
                        IDataReader reader =
                            conn.DB.ExecuteReader(conn.DB.GetStoredProcCommand(&quot;usp_MODMGMTGetModulesForaUserOrRole&quot;,
                                new object[] { UserID, RoleID, ProjectID, FeaturesCode })))
                    {
                        while (reader.Read())
                        {
                            ModuleList.Add(reader.GetString(reader.GetOrdinal(&quot;ModuleID&quot;)));
                        }
                    }
                    return ModuleList;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public string GetContextHierarchy(string moduleID)
        {
            var returnContext =
                ComponentHelper.Instance.ExecuteScalar(Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper.
                        StoredProcedure.usp_MODMGMTGetContextHierarchy, null, moduleID);

            if (returnContext != null)
            {
                return returnContext.ToString2();
            }
            else
                return string.Empty;
        }

        internal DataSet GetReportDetailsWithLibraryFormDetails()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_MODMGMTReportDetailsWithLibraryFormDetails, null);
        }

        internal DataSet GetReportDetailsWithModuleDetails()
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_MODMGMTReportDetailsWithModuleDetails, null);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,22,44,1],[23,9,23,10,1],[24,9,24,10,1],[32,9,32,10,1],[34,13,34,14,1],[35,24,35,96,1],[36,17,36,18,1],[37,21,37,94,1],[38,21,38,104,1],[39,21,39,66,1],[42,13,42,33,0],[43,13,43,14,0],[44,17,44,93,0],[45,17,45,23,0],[47,9,47,10,1],[55,9,55,10,1],[57,13,57,14,1],[58,24,58,96,1],[59,17,59,18,1],[60,21,63,39,1],[66,13,66,33,0],[67,13,67,14,0],[68,17,68,93,0],[69,17,69,23,0],[71,9,71,10,1],[74,9,74,10,0],[76,13,76,14,0],[77,24,77,96,0],[78,17,78,18,0],[79,21,81,69,0],[82,21,82,76,0],[83,21,83,22,0],[84,25,84,86,0],[87,25,87,45,0],[90,13,90,33,0],[91,13,91,14,0],[92,17,92,93,0],[93,17,93,23,0],[95,9,95,10,0],[103,9,103,10,0],[105,13,105,14,0],[106,24,106,96,0],[107,17,107,18,0],[108,21,108,66,0],[110,25,112,60,0],[114,21,114,22,0],[115,25,115,42,0],[116,29,117,85,0],[118,21,118,22,0],[119,21,119,37,0],[122,13,122,33,0],[123,13,123,14,0],[124,17,124,93,0],[125,17,125,23,0],[127,9,127,10,0],[135,9,135,10,0],[137,13,137,14,0],[138,24,138,96,0],[139,17,139,18,0],[140,21,140,90,0],[142,25,144,60,0],[145,21,145,22,0],[146,25,146,42,0],[147,29,152,36,0],[153,21,153,22,0],[154,21,154,37,0],[157,13,157,33,0],[158,13,158,14,0],[159,17,159,93,0],[160,17,160,23,0],[162,9,162,10,0],[170,9,170,10,0],[171,20,171,92,0],[172,13,172,14,0],[173,17,173,63,0],[175,21,177,56,0],[179,17,179,18,0],[180,21,180,38,0],[181,21,181,22,0],[182,25,182,70,0],[183,25,183,60,0],[184,29,184,68,0],[185,25,185,73,0],[186,21,186,22,0],[187,17,187,18,0],[188,17,188,31,0],[190,9,190,10,0],[198,9,198,10,1],[199,20,199,92,1],[200,13,200,14,1],[203,17,203,86,1],[204,17,204,89,1],[205,17,205,87,1],[206,17,206,101,1],[208,17,208,87,1],[209,17,209,95,1],[210,17,210,90,1],[212,17,212,99,1],[213,17,213,93,1],[214,17,214,98,1],[216,17,216,93,1],[217,17,217,95,1],[218,17,218,97,1],[219,17,219,93,1],[221,17,221,95,1],[222,17,222,98,1],[223,17,223,87,1],[225,17,225,85,1],[226,17,226,94,1],[227,17,227,91,1],[228,17,228,93,1],[229,17,229,95,1],[230,17,230,109,1],[231,17,231,107,1],[232,17,232,106,1],[233,17,233,98,1],[235,17,235,73,1],[236,17,236,46,1],[238,17,238,74,1],[240,17,240,24,1],[240,26,240,37,1],[240,38,240,40,1],[240,41,240,56,1],[241,21,241,92,1],[244,17,244,72,1],[246,17,246,33,1],[248,9,248,10,1],[252,9,252,10,1],[253,20,253,92,1],[254,13,254,14,1],[255,17,255,87,1],[256,17,256,82,1],[257,17,257,88,1],[258,17,258,103,1],[259,17,259,46,1],[260,13,260,14,1],[261,9,261,10,1],[270,9,270,10,1],[271,20,271,92,1],[272,13,272,14,1],[273,17,275,66,1],[277,9,277,10,1],[285,9,285,10,0],[286,20,286,92,0],[287,13,287,14,0],[288,17,290,53,0],[292,9,292,10,0],[295,9,295,10,1],[296,13,297,158,1],[298,13,298,32,1],[299,17,299,30,0],[301,17,301,29,1],[302,9,302,10,1],[315,9,315,10,0],[316,20,316,92,0],[317,13,317,14,0],[319,17,320,62,0],[322,17,322,56,0],[323,17,323,18,0],[324,21,324,28,0],[324,30,324,41,0],[324,42,324,44,0],[324,45,324,51,0],[325,21,325,22,0],[326,25,326,32,0],[326,34,326,42,0],[326,43,326,45,0],[326,46,326,59,0],[327,25,327,26,0],[328,29,329,80,0],[330,25,330,26,0],[331,21,331,22,0],[332,17,332,18,0],[335,17,336,197,0],[339,17,339,65,0],[340,17,340,29,0],[342,9,342,10,0],[353,9,353,10,0],[354,20,354,92,0],[355,13,355,14,0],[357,17,358,49,0],[359,17,359,24,0],[359,26,359,37,0],[359,38,359,40,0],[359,41,359,47,0],[360,21,360,28,0],[360,30,360,38,0],[360,39,360,41,0],[360,42,360,55,0],[361,25,362,76,0],[363,17,363,29,0],[365,9,365,10,0],[368,9,368,10,0],[369,20,369,92,0],[370,13,370,14,0],[371,17,371,119,0],[373,9,373,10,0],[376,9,376,10,0],[377,20,377,92,0],[378,13,378,14,0],[379,17,379,51,0],[381,21,383,64,0],[384,17,384,18,0],[385,21,385,38,0],[386,25,386,82,0],[387,17,387,18,0],[388,17,388,33,0],[390,9,390,10,0],[394,9,394,10,1],[395,20,395,92,1],[396,13,396,14,1],[397,17,397,51,1],[399,21,401,83,1],[402,17,402,18,1],[403,21,403,38,1],[404,25,404,164,1],[405,17,405,18,1],[406,17,406,33,1],[408,9,408,10,1],[417,9,417,10,0],[418,13,418,22,0],[419,9,419,10,0],[423,9,423,10,1],[424,20,424,92,1],[425,13,425,14,1],[426,17,429,35,1],[431,9,431,10,1],[439,9,439,10,1],[440,20,440,92,1],[441,13,441,14,1],[446,17,446,88,1],[447,17,447,94,1],[448,17,448,100,1],[449,17,449,102,1],[450,17,450,92,1],[451,17,451,77,1],[452,17,452,44,1],[453,17,453,78,1],[454,17,454,51,1],[455,17,455,33,1],[457,9,457,10,1],[465,9,465,10,0],[466,20,466,92,0],[467,13,467,14,0],[470,17,470,84,0],[471,17,471,90,0],[472,17,472,96,0],[473,17,473,90,0],[474,17,474,73,0],[475,17,475,46,0],[477,17,477,70,0],[479,9,479,10,0],[489,9,489,10,1],[490,20,490,92,1],[491,13,491,14,1],[492,17,492,40,1],[493,17,493,24,1],[493,26,493,46,1],[493,47,493,49,1],[493,50,493,68,1],[494,21,494,62,1],[495,17,495,77,1],[497,17,497,90,1],[498,17,498,82,1],[499,17,499,94,1],[500,17,500,73,1],[502,17,502,46,1],[504,17,504,70,1],[506,9,506,10,1],[514,9,514,10,0],[516,13,516,14,0],[517,24,517,96,0],[518,17,518,18,0],[519,21,519,50,0],[520,21,520,42,0],[521,21,521,120,0],[522,21,522,42,0],[523,21,523,22,0],[524,25,524,45,0],[525,25,525,74,0],[526,25,526,80,0],[527,25,527,86,0],[528,25,528,46,0],[529,21,529,22,0],[530,21,530,43,0],[532,21,532,95,0],[533,21,533,90,0],[534,21,534,96,0],[535,21,535,93,0],[536,21,536,91,0],[537,21,537,96,0],[538,21,538,89,0],[539,21,539,85,0],[540,21,540,92,0],[541,21,541,77,0],[542,21,542,50,0],[543,21,543,74,0],[546,13,546,33,0],[547,13,547,14,0],[548,17,548,93,0],[549,17,549,23,0],[551,9,551,10,0],[559,9,559,10,0],[561,13,561,14,0],[562,17,562,54,0],[563,17,563,49,0],[564,17,564,24,0],[564,26,564,34,0],[564,35,564,37,0],[564,38,564,46,0],[565,17,565,18,0],[566,21,566,49,0],[567,21,567,47,0],[568,21,568,49,0],[569,21,569,48,0],[570,21,570,49,0],[571,21,571,51,0],[572,21,572,50,0],[573,21,573,50,0],[574,17,574,18,0],[575,17,575,50,0],[576,24,576,96,0],[577,17,577,18,0],[578,21,578,92,0],[579,21,579,98,0],[580,21,580,77,0],[581,21,581,50,0],[583,21,583,74,0],[586,13,586,33,0],[587,13,587,14,0],[588,17,588,93,0],[589,17,589,26,0],[591,9,591,10,0],[599,9,599,10,1],[600,20,600,92,1],[601,13,601,14,1],[602,17,604,83,1],[606,9,606,10,1],[616,9,616,10,0],[618,13,618,14,0],[619,24,619,96,0],[620,17,620,18,0],[621,21,621,52,0],[623,25,625,73,0],[626,21,626,22,0],[627,25,627,46,0],[628,29,628,60,0],[629,21,629,22,0],[630,21,630,34,0],[633,13,633,33,0],[634,13,634,14,0],[635,17,635,93,0],[636,17,636,23,0],[638,9,638,10,0],[645,9,645,10,1],[647,13,647,14,1],[648,24,648,96,1],[649,17,649,18,1],[650,21,650,73,1],[652,25,653,110,1],[654,21,654,22,1],[655,25,655,46,1],[656,25,656,26,1],[657,29,658,86,1],[659,25,659,26,1],[660,21,660,22,1],[661,21,661,41,1],[664,13,664,33,0],[665,13,665,14,0],[666,17,666,93,0],[667,17,667,23,0],[669,9,669,10,1],[672,9,672,10,0],[674,13,674,14,0],[675,24,675,96,0],[676,17,676,18,0],[677,21,677,57,0],[679,25,681,72,0],[682,21,682,22,0],[683,25,683,46,0],[684,25,684,26,0],[685,29,685,93,0],[686,25,686,26,0],[687,21,687,22,0],[688,21,688,39,0],[691,13,691,33,0],[692,13,692,14,0],[693,17,693,93,0],[694,17,694,23,0],[696,9,696,10,0],[699,9,699,10,0],[701,13,701,14,0],[702,24,702,96,0],[703,17,703,18,0],[705,25,707,60,0],[709,25,709,43,0],[710,29,710,84,0],[711,17,711,18,0],[712,13,712,14,0],[713,13,713,33,0],[714,13,714,14,0],[715,17,715,93,0],[716,17,716,23,0],[718,13,718,22,0],[719,9,719,10,0],[726,9,726,10,0],[728,13,728,14,0],[729,24,729,96,0],[730,17,730,18,0],[731,21,731,104,0],[734,13,734,33,0],[735,13,735,14,0],[736,17,736,93,0],[737,17,737,23,0],[739,9,739,10,0],[746,9,746,10,0],[748,13,748,14,0],[749,24,749,96,0],[750,17,750,18,0],[751,21,751,93,0],[752,21,752,45,0],[753,21,753,22,0],[754,25,754,69,0],[755,25,755,32,0],[755,34,755,44,0],[755,45,755,47,0],[755,48,755,65,0],[756,25,756,26,0],[757,29,757,92,0],[758,25,758,26,0],[759,25,759,37,0],[762,21,762,33,0],[765,13,765,33,0],[766,13,766,14,0],[767,17,767,93,0],[768,17,768,23,0],[770,9,770,10,0],[778,9,778,10,0],[781,13,781,14,0],[782,24,782,96,0],[783,17,783,18,0],[784,21,784,54,0],[786,21,786,49,0],[787,21,787,102,0],[788,21,788,82,0],[789,21,789,62,0],[791,21,791,53,0],[792,21,792,22,0],[793,25,793,59,0],[794,25,794,75,0],[795,25,795,75,0],[796,25,796,75,0],[797,25,797,69,0],[798,25,798,68,0],[799,25,799,64,0],[800,25,800,67,0],[802,25,802,100,0],[803,25,803,57,0],[804,25,804,26,0],[805,29,805,36,0],[805,38,805,53,0],[805,54,805,56,0],[805,57,805,74,0],[806,29,806,30,0],[807,33,807,78,0],[808,33,809,73,0],[810,33,810,109,0],[811,29,811,30,0],[812,25,812,26,0],[813,25,813,45,0],[814,21,814,22,0],[815,17,815,18,0],[816,13,816,14,0],[817,13,817,33,0],[818,13,818,14,0],[819,17,819,93,0],[820,17,820,23,0],[822,13,822,26,0],[823,9,823,10,0],[831,9,831,10,0],[833,13,833,14,0],[834,17,834,38,0],[835,17,835,18,0],[836,21,836,56,0],[837,21,837,47,0],[838,21,838,70,0],[839,21,839,42,0],[840,21,840,22,0],[841,25,841,53,0],[842,25,842,72,0],[843,25,843,54,0],[844,21,844,22,0],[845,21,845,48,0],[846,28,846,100,0],[847,21,847,22,0],[848,25,848,103,0],[849,25,849,100,0],[851,25,852,66,0],[853,25,853,54,0],[855,25,855,78,0],[859,21,859,30,0],[861,13,861,33,0],[862,13,862,14,0],[863,17,863,93,0],[864,17,864,23,0],[866,9,866,10,0],[878,9,878,10,0],[879,13,879,32,0],[881,13,881,14,0],[882,17,882,62,0],[883,17,883,18,0],[884,21,886,97,0],[887,21,887,41,0],[888,21,888,22,0],[889,25,889,92,0],[891,17,891,18,0],[892,13,892,14,0],[893,13,893,33,0],[894,13,894,14,0],[895,17,895,93,0],[896,17,896,23,0],[898,13,898,27,0],[899,9,899,10,0],[912,9,912,10,0],[913,13,913,32,0],[915,13,915,14,0],[916,17,916,62,0],[917,17,917,18,0],[918,21,918,40,0],[919,21,919,50,0],[920,21,922,103,0],[923,21,923,41,0],[924,21,924,22,0],[925,25,925,61,0],[926,25,926,32,0],[926,34,926,44,0],[926,45,926,47,0],[926,48,926,52,0],[927,25,927,26,0],[928,29,928,84,0],[929,29,929,101,0],[930,34,930,43,0],[930,45,930,52,0],[930,54,930,57,0],[931,29,931,30,0],[932,33,932,106,0],[933,33,933,34,0],[934,37,934,50,0],[935,37,935,56,0],[936,37,936,43,0],[938,29,938,30,0],[939,25,939,26,0],[940,21,940,22,0],[941,21,941,31,0],[942,21,942,22,0],[943,25,943,115,0],[944,25,946,98,0],[947,25,947,39,0],[949,17,949,18,0],[950,13,950,14,0],[951,13,951,33,0],[952,13,952,14,0],[953,17,953,93,0],[954,17,954,23,0],[956,13,956,27,0],[957,9,957,10,0],[960,9,960,10,1],[962,13,962,14,1],[963,24,963,96,1],[964,17,964,18,1],[965,21,965,95,1],[966,21,966,81,1],[967,21,967,88,1],[968,21,968,89,1],[970,21,972,38,1],[973,21,973,50,1],[975,21,975,74,1],[978,13,978,33,0],[979,13,979,14,0],[980,17,980,93,0],[981,17,981,23,0],[983,9,983,10,1],[986,9,986,10,0],[988,13,988,14,0],[989,24,989,96,0],[990,17,990,18,0],[991,21,991,99,0],[993,21,993,86,0],[994,21,994,92,0],[995,21,995,66,0],[998,13,998,33,0],[999,13,999,14,0],[1000,17,1000,93,0],[1001,17,1001,23,0],[1003,9,1003,10,0],[1006,9,1006,10,0],[1008,13,1008,14,0],[1009,24,1009,96,0],[1010,17,1010,18,0],[1011,21,1011,96,0],[1012,21,1012,86,0],[1013,21,1013,82,0],[1014,21,1014,48,0],[1016,21,1018,113,0],[1021,13,1021,33,0],[1022,13,1022,14,0],[1023,17,1023,93,0],[1024,17,1024,23,0],[1026,9,1026,10,0],[1029,9,1029,10,0],[1031,13,1031,14,0],[1032,24,1032,96,0],[1033,17,1033,18,0],[1034,21,1034,93,0],[1035,21,1035,82,0],[1036,21,1036,85,0],[1037,21,1037,88,0],[1038,21,1038,77,0],[1039,21,1039,48,0],[1041,21,1041,93,0],[1044,13,1044,33,0],[1045,13,1045,14,0],[1046,17,1046,93,0],[1047,17,1047,23,0],[1049,9,1049,10,0],[1052,9,1052,10,1],[1054,13,1054,14,1],[1055,24,1055,96,1],[1056,17,1056,18,1],[1057,21,1057,60,1],[1058,21,1058,93,1],[1059,28,1059,75,1],[1060,21,1060,22,1],[1061,25,1061,46,1],[1062,25,1062,26,0],[1063,29,1063,57,0],[1064,29,1064,89,0],[1065,29,1065,84,0],[1066,29,1066,98,0],[1067,29,1067,86,0],[1068,29,1068,47,0],[1069,25,1069,26,0],[1070,21,1070,22,1],[1071,21,1071,37,1],[1074,13,1074,33,0],[1075,13,1075,14,0],[1076,17,1076,85,0],[1077,17,1077,23,0],[1079,9,1079,10,1],[1082,9,1082,10,0],[1084,13,1084,14,0],[1085,24,1085,96,0],[1086,17,1086,18,0],[1087,21,1087,96,0],[1088,21,1088,84,0],[1089,21,1089,57,0],[1092,13,1092,33,0],[1093,13,1093,14,0],[1094,17,1094,93,0],[1095,17,1095,23,0],[1097,9,1097,10,0],[1100,9,1100,10,0],[1102,13,1102,14,0],[1103,24,1103,96,0],[1104,17,1104,18,0],[1105,21,1105,96,0],[1106,21,1106,82,0],[1107,21,1107,88,0],[1108,21,1108,77,0],[1109,21,1109,48,0],[1111,21,1111,93,0],[1114,13,1114,33,0],[1115,13,1115,14,0],[1116,17,1116,93,0],[1117,17,1117,23,0],[1119,9,1119,10,0],[1122,9,1122,10,0],[1124,13,1124,14,0],[1125,24,1125,96,0],[1126,17,1126,18,0],[1127,21,1127,98,0],[1128,21,1128,82,0],[1129,21,1129,92,0],[1130,21,1130,57,0],[1133,13,1133,33,0],[1134,13,1134,14,0],[1135,17,1135,93,0],[1136,17,1136,23,0],[1138,9,1138,10,0],[1141,9,1141,10,0],[1142,13,1142,80,0],[1146,9,1146,10,0],[1148,13,1148,14,0],[1149,24,1149,96,0],[1150,17,1150,18,0],[1151,21,1154,39,0],[1157,13,1157,33,0],[1158,13,1158,14,0],[1159,17,1159,93,0],[1160,17,1160,23,0],[1162,9,1162,10,0],[1165,9,1165,10,1],[1166,13,1169,86,1],[1170,9,1170,10,1],[1173,9,1173,10,0],[1174,13,1177,97,0],[1178,9,1178,10,0],[1181,9,1181,10,1],[1182,13,1185,37,1],[1186,13,1186,37,1],[1187,17,1187,37,1],[1189,17,1189,29,0],[1190,9,1190,10,1],[1193,9,1193,10,0],[1194,13,1197,84,0],[1198,13,1198,37,0],[1199,17,1199,37,0],[1201,17,1201,29,0],[1202,9,1202,10,0],[1207,9,1207,10,1],[1208,13,1210,28,1],[1211,9,1211,10,1],[1214,9,1214,10,1],[1215,13,1217,28,1],[1218,9,1218,10,1],[1221,9,1221,10,1],[1222,13,1225,29,1],[1226,9,1226,10,1],[1229,9,1229,10,1],[1230,13,1230,81,1],[1231,13,1233,41,1],[1234,13,1234,51,1],[1235,13,1235,14,1],[1236,17,1236,24,1],[1236,26,1236,36,1],[1236,37,1236,39,1],[1236,40,1236,57,1],[1237,17,1237,18,1],[1238,21,1238,73,1],[1239,21,1239,37,1],[1240,21,1240,38,1],[1241,17,1241,18,1],[1242,13,1242,14,1],[1243,13,1243,28,1],[1244,9,1244,10,1],[1247,9,1247,10,0],[1248,13,1248,81,0],[1249,13,1251,55,0],[1252,13,1252,51,0],[1253,13,1253,14,0],[1254,17,1254,24,0],[1254,26,1254,36,0],[1254,37,1254,39,0],[1254,40,1254,57,0],[1255,17,1255,18,0],[1256,21,1256,73,0],[1257,21,1257,37,0],[1258,21,1258,38,0],[1259,17,1259,18,0],[1260,13,1260,14,0],[1261,13,1261,28,0],[1262,9,1262,10,0],[1267,9,1267,10,0],[1268,13,1271,87,0],[1272,13,1272,37,0],[1273,17,1273,37,0],[1275,17,1275,29,0],[1276,9,1276,10,0],[1280,9,1280,10,1],[1282,13,1282,14,1],[1283,24,1283,96,1],[1284,17,1284,18,1],[1285,21,1285,57,1],[1287,25,1289,91,1],[1290,21,1290,22,1],[1291,25,1291,46,1],[1292,25,1292,26,1],[1293,29,1293,93,1],[1294,25,1294,26,1],[1295,21,1295,22,1],[1296,21,1296,39,1],[1299,13,1299,33,0],[1300,13,1300,14,0],[1301,17,1301,93,0],[1302,17,1302,23,0],[1304,9,1304,10,1],[1307,9,1307,10,1],[1308,13,1310,89,1],[1312,13,1312,39,1],[1313,13,1313,14,1],[1314,17,1314,50,1],[1317,17,1317,37,0],[1318,9,1318,10,1],[1321,9,1321,10,0],[1322,13,1322,130,0],[1323,9,1323,10,0],[1326,9,1326,10,0],[1327,13,1327,125,0],[1328,9,1328,10,0]]);
    </script>
  </body>
</html>