<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Item Postings\BL\ITMPOSTBL.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Globalization;
using System.Text;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.ContmgtDTO;
using Aurigo.AMP3.CONTMGTITMPOSTDAC;
using Aurigo.AMP3.CONTMGTITMPOSTDTO;
using Aurigo.AMP3.Core.BusinessLayer.DTO;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.AMP3.UserManagementDTO;
using Aurigo.Brix.Construction.ContractManager.BusinessLayer;
using Aurigo.Brix.Construction.ContractManager.BusinessLayer.BL;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Brix.Platform.BusinessLayer.BL;
using Aurigo.AMP3.Core.BusinessLayer.BL;
using Aurigo.AMP3.ContractManager.BusinessLayer;
using Aurigo.Common.Utility;

namespace Aurigo.AMP3.ContractManager
{
    [ContextAttribute(Name = &quot;ITMPOST&quot;)]
    public class ITMPOSTBL : SingletonManagerBase&lt;ITMPOSTBL&gt;, ISubmit, ILibrary, IItemVerifiable, ISubItemVerifiable, IActivityVerifiable,
                             IResourceVerifiable, IModuleVerifiable
    {
        #region IActivityVerifiable Members

        public string ValidateActivityBeforeSave(Activity activityDTO)
        {
            string retValidate = String.Empty;

            //Dictionary&lt;string, object&gt; retDict = new Dictionary&lt;string, object&gt;();
            //retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            //retDict[&quot;ErrorMessage&quot;] = String.Empty;
            //retDict[&quot;Mode&quot;] = 1; //Update

            //int numRows = ComponentHelper.Instance.ExecuteNonQuery&lt;Activity&gt;(ItemPostingStoredProcedure.usp_CONTMGTValidateActivityAgainstPostings, retDict, activityDTO);
            //int isValid = 0;
            //if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
            //    Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            //if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
            //    retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        public string ValidateActivityBeforeDelete(Activity activityDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 2; //Delete

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateActivityAgainstPostings, retDict, activityDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        #endregion

        #region IItemVerifiable Members

        public string ValidateItemBeforeSave(Item itemDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 1; //Update

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateItemAgainstPostings, retDict, itemDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        public string ValidateItemBeforeDelete(Item itemDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 2; //Delete

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateItemAgainstPostings, retDict, itemDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        #endregion

        #region ILibrary Members

        public string FetchLibraryData(string typeOfData, int[] dependencyValues)
        {
            try
            {
                if (typeOfData.ToUpper2().Equals(&quot;POSTINGS&quot;))
                {
                    string contractList = string.Empty;
                    for (int idx = 0; idx &lt; dependencyValues.Length; idx += 2)
                        contractList += dependencyValues[idx] + &quot;, &quot;;
                    if (contractList.Length &gt; 0)
                    {
                        contractList = contractList.Remove(contractList.Length - 2);
                        DataSet DSPostings = GetPostingsForContractList(contractList);
                        DSPostings.DataSetName = &quot;Records&quot;;
                        return DSPostings.GetXml();
                    }
                    else
                        return &quot;&quot;;
                }
                else if (typeOfData.ToUpper2().Equals(&quot;WORKORDERS&quot;))
                {
                    string contractList = string.Empty;
                    for (int idx = 0; idx &lt; dependencyValues.Length; idx += 2)
                        contractList += dependencyValues[idx] + &quot;,&quot;;
                    if (contractList.Length &gt; 0)
                    {
                        DataSet dsWO = GetWorkOrdersForContractList(contractList.TrimEnd(&#39;,&#39;));
                        dsWO.DataSetName = &quot;Records&quot;;
                        return dsWO.GetXml();
                    }
                    else
                        return &quot;&quot;;
                }
            }
            catch (Exception)
            {
                return string.Empty;
            }
            return string.Empty;
        }

        #endregion

        #region IModuleVerifiable Members

        public bool ShouldModuleBeValidatedForFinalRAB(bool isSubContractorRAB)
        {
            return false;
        }

        #endregion

        #region IResourceVerifiable Members

        public string ValidateResourceBeforeSave(Item itemDTO, Resource resDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 1; //Update
            retDict[&quot;ItemQty&quot;] = itemDTO.Quantity;

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateResourceAgainstPostings, retDict, resDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        public string ValidateResourceBeforeDelete(Item itemDTO, Resource resDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 2; //Delete
            retDict[&quot;ItemQty&quot;] = itemDTO.Quantity;

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateResourceAgainstPostings, retDict, resDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        #endregion

        #region ISubItemVerifiable Members

        public string ValidateSubItemBeforeSave(SubItem subItemDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 1; //Update

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateSubItemAgainstPostings, retDict, subItemDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        public string ValidateSubItemBeforeDelete(SubItem subItemDTO)
        {
            string retValidate = String.Empty;

            var retDict = new Dictionary&lt;string, object&gt;();
            retDict[&quot;IsValidForChange&quot;] = Int32.Parse(&quot;0&quot;);
            retDict[&quot;ErrorMessage&quot;] = String.Empty;
            retDict[&quot;Mode&quot;] = 2; //Delete

            int numRows =
                ComponentHelper.Instance.ExecuteNonQuery(
                    ItemPostingStoredProcedure.usp_CONTMGTValidateSubItemAgainstPostings, retDict, subItemDTO);
            int isValid = 0;
            if (retDict.ContainsKey(&quot;IsValidForChange&quot;) &amp;&amp; retDict[&quot;IsValidForChange&quot;] != null)
                Int32.TryParse(retDict[&quot;IsValidForChange&quot;].ToString2(), out isValid);
            if (retDict.ContainsKey(&quot;ErrorMessage&quot;) &amp;&amp; retDict[&quot;ErrorMessage&quot;] != null)
                retValidate = retDict[&quot;ErrorMessage&quot;].ToString2();

            return retValidate;
        }

        #endregion

        #region ISubmit Members

        SyncStatus ISubmit.SubmitXmlData(string xmlData)
        {
            var syncStatus = new SyncStatus();
            try
            {
                string uName = string.Empty; string fName = string.Empty;

                var xDoc = new XmlDocument();
                xDoc.LoadXml(xmlData);

                int CID = 0, ItemID = 0;
                XmlNode node;

                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/ContractID&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    CID = node.InnerText.ToInt32_2();
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/ITEMID&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    ItemID = node.InnerText.ToInt32_2();

                DTOItemPosting dto = Instance.GetItemPosting(CID, ItemID, null, null, null);
                dto.ContractID = CID;
                dto.Postings.PostingID = 0;
                dto.Postings.Status = &quot;D&quot;; //for draft..const not used as it is a part of UI..
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/WONO&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.WorkOrderNo = node.InnerText;
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/QTYPLACEDTODATE&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.QtyPlacedToDate = node.InnerText.ToDecimal2();
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/QTYREMAINING&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.QtyRemaining = node.InnerText.ToDecimal2();
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/REMARKS&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.Remarks = node.InnerText;
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/TOSTN&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.ToStn = node.InnerText;
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/FROMSTN&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.FromStn = node.InnerText;
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/CONTRACTORID&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                {
                    dto.Postings.ContractorID = node.InnerText.ToInt32_2();
                    if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/CONTRACTORTYPE&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                        dto.Postings.ContractorType = node.InnerText;
                }
                else
                {
                    dto.Postings.ContractorID = null;
                    dto.Postings.ContractorType = null;
                }
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/PERCENTCOMPLETE&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.PercentComplete = node.InnerText.ToDecimal2();
                int UID = 0;
                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/UID&quot;)) != null)
                    dto.Postings.PostedBy = UID = node.InnerText.ToInt32_2();

                if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/CUTOFFDATE&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                    dto.Postings.PostedDate = dto.Postings.CutoffDate = Convert.ToDateTime(node.InnerText, CultureInfo.InvariantCulture);
                //if ((node = xDoc.SelectSingleNode(&quot;/formData/Report/POSTEDDATE&quot;)) != null &amp;&amp; !string.IsNullOrEmpty(node.InnerText))
                //    dto.Postings.PostedDate = Convert.ToDateTime(node.InnerText, CultureInfo.InvariantCulture);

                dto.Postings.Attention = ((node = xDoc.SelectSingleNode(&quot;/formData/Report/ATTENTION&quot;)) != null &amp;&amp;
                    !string.IsNullOrEmpty(node.InnerText) &amp;&amp; node.InnerText.ToLower2().Equals(&quot;true&quot;)) ? &quot;Y&quot; : &quot;N&quot;;
                dto.Postings.BidItemComplete = ((node = xDoc.SelectSingleNode(&quot;/formData/Report/BIDITEMCOMPLETE&quot;)) != null &amp;&amp;
                    !string.IsNullOrEmpty(node.InnerText) &amp;&amp; node.InnerText.ToLower2().Equals(&quot;true&quot;)) ? &quot;Y&quot; : &quot;N&quot;;
                int newPostingID;
                User user = UserManager.Instance.GetAUser(UID);
                foreach (XmlNode xnGrp in xDoc.SelectNodes(&quot;/formData/Report/SubItems/SubItem&quot;))
                {
                    dto.Postings.SubItemID = xnGrp.Attributes[&quot;SUBITEMID&quot;].Value.ToInt32_2();
                    dto.Postings.PostedQty = xnGrp.Attributes[&quot;QTY&quot;].Value.ToDecimal2();
                    string strErr = string.Empty;
                    try
                    {
                        newPostingID = CreatePosting(dto, null, user.UserName, user.UserName);
                        if (newPostingID == -1)
                            strErr = &quot;Cannot update the Item Posting. The Item Posting has been deleted.&quot;;
                        else if (newPostingID == -2)
                            strErr = &quot;Cannot update the Item Posting. The Item Posting has already been Approved.&quot;;
                        else if (newPostingID == -10)
                            strErr = &quot;Cannot update the Item Posting. &quot; + LocalizationManager.GetString(KeyConstants.LOC_ITEM_ABBR) + &quot; is already marked complete.&quot;;
                        else
                        {
                            DataTable dtAct = ItemManager.Instance.GetItemActivities(&quot;CONTMGT&quot;, CID, ItemID, &quot;N&quot;).Tables[0];
                            DataRow dr = dtAct.Rows[0];
                            Activity dtoAct = new Activity();
                            //dtoAct.ActivityID = Convert.ToInt32(dr[&quot;ActivityID&quot;].ToString());
                            dtoAct.Description = dr[&quot;Description&quot;].ToString();
                            dtoAct.Name = dr[&quot;Name&quot;].ToString();
                            dtoAct.ModuleID = &quot;ITMPOST&quot;;
                            dtoAct.ParentInstanceID = newPostingID;
                            dtoAct.ItemID = ItemID;
                            dtoAct.IsComplete = dto.Postings.BidItemComplete == &quot;Y&quot;;
                            dtoAct.Percentage = 100;
                            dtoAct.Quantity = dtoAct.Number = dto.Postings.PostedQty;
                            dtoAct.ReferenceActivityID = Convert.ToInt32(dr[&quot;ActivityID&quot;].ToString());
                            dtoAct.UnitID = Convert.ToInt32(dr[&quot;UnitID&quot;].ToString());
                            dtoAct.Unit = dr[&quot;Unit&quot;].ToString();
                            dtoAct.IsAfterLock = false;

                            ItemManager.Instance.SaveActivity(dtoAct);

                            try
                            {
                                object pid = ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTGetProjectIDFromContract, null, dto.ContractID);
                                BrixWorkflowManager.Instance.CreateWorkflowForClient(&quot;XITMPOS&quot;, pid.ToString(), dto.ContractID.ToString(), newPostingID.ToString());
                            }
                            catch { }
                        }
                    }
                    catch (Exception ex)
                    {
                        strErr = ex.Message;
                    }
                    syncStatus.StatusMessage = string.Format(&quot;{0}{1}{2}&quot;, syncStatus.StatusMessage,
                                !string.IsNullOrEmpty(syncStatus.StatusMessage) ? Environment.NewLine : string.Empty, strErr);
                }
                syncStatus.Status = string.IsNullOrEmpty(syncStatus.StatusMessage);
            }
            catch (SqlException sqlex)
            {
                syncStatus.Status = false;
                syncStatus.StatusMessage = sqlex.Message;
            }
            catch (Exception ex)
            {
                syncStatus.Status = false;
                syncStatus.StatusMessage = ex.Message;
            }
            return syncStatus;
        }

        #endregion

        public int CreatePosting(DTOItemPosting dto, string mode, string fullName, string userName)
        {
            var xml = new StringBuilder();
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;XMLROOT&gt;\n&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;ITEMPOSTINGS&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;OPN&gt;&quot; + mode + &quot;&lt;/OPN&gt;&quot;);

            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;ContractID&gt;&quot; + dto.ContractID + &quot;&lt;/ContractID&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;ItemID&gt;&quot; + dto.ID + &quot;&lt;/ItemID&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;PostingID&gt;&quot; + dto.Postings.PostingID + &quot;&lt;/PostingID&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;WorkOrderNo&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.WorkOrderNo) +
                             &quot;&lt;/WorkOrderNo&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;WOID&gt;&quot; + dto.Postings.WOID + &quot;&lt;/WOID&gt;&quot;);

            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;Status&gt;&quot; + dto.Postings.Status + &quot;&lt;/Status&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;PostedDate&gt;{0}&lt;/PostedDate&gt;\n&quot;, dto.Postings.PostedDate.ToString2());
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;PostedBy&gt;&quot; + dto.Postings.PostedBy + &quot;&lt;/PostedBy&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;ItemComplete&gt;&quot; + dto.Postings.BidItemComplete + &quot;&lt;/ItemComplete&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             String.IsNullOrEmpty(dto.Postings.Remarks)
                                 ? String.Empty
                                 : &quot;&lt;Remarks&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.Remarks) + &quot;&lt;/Remarks&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;ApprovedDate&gt;&quot; + dto.Postings.ApprovedDate + &quot;&lt;/ApprovedDate&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;UserId&gt;&quot; + dto.Postings.PostedBy + &quot;&lt;/UserId&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;Attention&gt;&quot; + dto.Postings.Attention + &quot;&lt;/Attention&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             String.IsNullOrEmpty(dto.Postings.FromStn)
                                 ? String.Empty
                                 : &quot;&lt;DistanceFrom&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.FromStn) +
                                   &quot;&lt;/DistanceFrom&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             String.IsNullOrEmpty(dto.Postings.FromStn)
                                 ? String.Empty
                                 : &quot;&lt;FromStn&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.FromStn) + &quot;&lt;/FromStn&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             String.IsNullOrEmpty(dto.Postings.ToStn)
                                 ? String.Empty
                                 : &quot;&lt;DistanceTo&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.ToStn) +
                                   &quot;&lt;/DistanceTo&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             String.IsNullOrEmpty(dto.Postings.ToStn)
                                 ? String.Empty
                                 : &quot;&lt;ToStn&gt;&quot; + UIHelper.ReplaceXMLCharEntities(dto.Postings.ToStn) + &quot;&lt;/ToStn&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;QtyRemaining&gt;&quot; + dto.Postings.QtyRemaining + &quot;&lt;/QtyRemaining&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;QtyPlacedtoDate&gt;&quot; + dto.Postings.QtyPlacedToDate + &quot;&lt;/QtyPlacedtoDate&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;BeginDate&gt;&quot; + dto.Postings.BeginDate + &quot;&lt;/BeginDate&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;EndDate&gt;&quot; + dto.Postings.EndDate + &quot;&lt;/EndDate&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;PercentComplete&gt;&quot; + dto.Postings.PercentComplete + &quot;&lt;/PercentComplete&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;CutoffDate&gt;&quot; + dto.Postings.CutoffDate + &quot;&lt;/CutoffDate&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;PostedQty&gt;&quot; + dto.Postings.PostedQty + &quot;&lt;/PostedQty&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;ContractorID&gt;&quot; + dto.Postings.ContractorID + &quot;&lt;/ContractorID&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;ContractorType&gt;&quot; + dto.Postings.ContractorType + &quot;&lt;/ContractorType&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;WorkByContractorID&gt;&quot; + dto.Postings.WorkByContractorID + &quot;&lt;/WorkByContractorID&gt;&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                             &quot;&lt;WorkByContractorType&gt;&quot; + dto.Postings.WorkByContractorType + &quot;&lt;/WorkByContractorType&gt;&quot;);
            if (dto.Postings.DWRID.HasValue)
                xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;DWRID&gt;&quot; + dto.Postings.DWRID + &quot;&lt;/DWRID&gt;&quot;);
            if (dto.Postings.SubItemID.HasValue)
                xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;,
                                 &quot;&lt;SubItemID&gt;&quot; + dto.Postings.SubItemID + &quot;&lt;/SubItemID&gt;&quot;);
            if (dto.Postings.RFIID.HasValue)
                xml.AppendFormat(CultureInfo.CurrentCulture, &quot;{0}\n&quot;, &quot;&lt;RFIID&gt;&quot; + dto.Postings.RFIID + &quot;&lt;/RFIID&gt;&quot;);

            //xml.Append(&quot;&lt;Groups&gt;\n&quot;);

            //for (int i = 0; i &lt; dto.Groups.Count; i++)
            //{
            //    xml.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;Group&gt;\n&lt;GroupID&gt;{0}&lt;/GroupID&gt;\n&lt;Qty&gt;{1}&lt;/Qty&gt;\n&lt;ItemId&gt;{2}&lt;/ItemId&gt;\n&lt;/Group&gt;&quot;,
            //                     dto.Groups[i].ID, dto.Groups[i].Qty, dto.Groups[i].ItemID);
            //}

            //xml.Append(&quot;&lt;/Groups&gt;\n&quot;);

            xml.Append(&quot;&lt;/ITEMPOSTINGS&gt;\n&quot;);
            xml.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;/XMLROOT&gt;\n&quot;);

            return ITMPOSTDAC.Instance.CreatePosting(xml, mode, userName, fullName);
        }

        public DTOItemPosting GetItemPosting(int contractID, int itemID, int? postingID, string mode, int? woid)
        {
            return ITMPOSTDAC.Instance.GetItemPosting(contractID, itemID, postingID, mode, woid);
        }

        public void UpdateAttachmentStatus(int postingID, bool hasAttachments)
        {
            ITMPOSTDAC.Instance.UpdateAttachmentStatus(postingID, hasAttachments);
        }

        public string UpdatePostingStatus(string multipostingID, string destStatus, bool isDWR, int userID)
        {
            var retDict = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                ItemPostingStoredProcedure.usp_CONTMGTUpdatePostStatus, retDict, multipostingID,
                destStatus.Equals(Constants.MODFEAT_DELETE) ? &quot;R&quot; : destStatus, isDWR, userID);
            var ErrorMsgAndIDs = new StringBuilder();

            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;ErrMessage&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;ErrMessage&quot;].ToString2()))
                ErrorMsgAndIDs.Append(retDict[&quot;ErrMessage&quot;].ToString2());
            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;DeletedIds&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;DeletedIds&quot;].ToString2()))
                ErrorMsgAndIDs.Append(ErrorMsgAndIDs + retDict[&quot;DeletedIds&quot;].ToString2());
            return ErrorMsgAndIDs.ToString2();
        }

        public string ValidateUpdatePostingStatus(string multipostingID, string destStatus, bool isDWR, int userID)
        {
            var retDict = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                ItemPostingStoredProcedure.usp_CONTMGTValidateUpdatePostStatus, retDict, multipostingID,
                destStatus.Equals(Constants.MODFEAT_DELETE) ? &quot;R&quot; : destStatus, isDWR, userID);
            var ErrorMsgAndIDs = new StringBuilder();

            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;ErrMessage&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;ErrMessage&quot;].ToString2()))
                ErrorMsgAndIDs.Append(retDict[&quot;ErrMessage&quot;].ToString2());
            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;DeletedIds&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;DeletedIds&quot;].ToString2()))
                ErrorMsgAndIDs.Append(ErrorMsgAndIDs + retDict[&quot;DeletedIds&quot;].ToString2());
            return ErrorMsgAndIDs.ToString2();
        }

        public string UpdateActivityPostingStatus(string multipostingID, int destStatus, bool isDWR, int userID)
        {
            var retDict = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                ItemPostingStoredProcedure.usp_ACTIWOUpdatePostStatus, retDict, multipostingID, destStatus, isDWR,
                userID);

            var ErrorMsgAndIDs = new StringBuilder();
            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;ErrMessage&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;ErrMessage&quot;].ToString2()))
                ErrorMsgAndIDs.Append(retDict[&quot;ErrMessage&quot;].ToString2());
            ErrorMsgAndIDs.Append(&quot;@&quot;);
            if (retDict.ContainsKey(&quot;DeletedIds&quot;) &amp;&amp; !String.IsNullOrEmpty(retDict[&quot;DeletedIds&quot;].ToString2()))
                ErrorMsgAndIDs.Append(ErrorMsgAndIDs + retDict[&quot;DeletedIds&quot;].ToString2());

            return ErrorMsgAndIDs.ToString2();
        }

        public int GetContractItemsCount(int contractID, string filterSearch)
        {
            return ITMPOSTDAC.Instance.GetContractItemsCount(contractID, filterSearch);
        }

        public DataSet GetWorkOrders(int ItemID)
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.WORKORDGETWONOS, null,
                                                               new object[] { ItemID });
            }
            catch
            {
                return null;
            }
        }

        private DataTable ResourcesXmlToTable(XmlNode xnRes)
        {
            DataTable dtSelItems = new BrixDataTable();

            DataColumnCollection columns = dtSelItems.Columns;
            columns.Add(&quot;ID&quot;, Type.GetType(&quot;System.Int32&quot;));
            columns.Add(&quot;ResMainID&quot;, Type.GetType(&quot;System.Int32&quot;));
            columns.Add(&quot;ResType&quot;, Type.GetType(&quot;System.String&quot;));
            columns.Add(&quot;Description&quot;, Type.GetType(&quot;System.String&quot;));
            columns.Add(&quot;Unit&quot;, Type.GetType(&quot;System.String&quot;));
            columns.Add(&quot;Rate&quot;, Type.GetType(&quot;System.Decimal&quot;));
            columns.Add(&quot;Quantity&quot;, Type.GetType(&quot;System.Decimal&quot;));
            columns.Add(&quot;Cost&quot;, Type.GetType(&quot;System.Decimal&quot;));
            columns.Add(&quot;Notes&quot;, Type.GetType(&quot;System.String&quot;));

            foreach (XmlNode xn in xnRes.SelectNodes(&quot;Resource&quot;))
            {
                DataRow dr = dtSelItems.NewRow();

                try
                {
                    dr[&quot;ID&quot;] = xn.SelectSingleNode(&quot;ID&quot;).InnerText.ToInt32_2();
                    dr[&quot;ResMainID&quot;] = xn.SelectSingleNode(&quot;ResMainID&quot;).InnerText.ToInt32_2();
                    dr[&quot;ResType&quot;] = xn.SelectSingleNode(&quot;ResType&quot;).InnerText;
                    dr[&quot;Description&quot;] = xn.SelectSingleNode(&quot;Description&quot;).InnerText;
                    dr[&quot;Unit&quot;] = xn.SelectSingleNode(&quot;Unit&quot;).InnerText;
                    dr[&quot;Rate&quot;] = xn.SelectSingleNode(&quot;Rate&quot;).InnerText.ToDecimal2();
                    dr[&quot;Quantity&quot;] = xn.SelectSingleNode(&quot;Quantity&quot;).InnerText.ToDecimal2();
                    dr[&quot;Cost&quot;] = xn.SelectSingleNode(&quot;Cost&quot;).InnerText.ToDecimal2();
                    dr[&quot;Notes&quot;] = xn.SelectSingleNode(&quot;Notes&quot;).InnerText;

                    dtSelItems.Rows.Add(dr);
                }
                catch
                {
                }
            }

            return dtSelItems;
        }

        public DataSet GetWorkOrdersforContractor(int contractID, int contractorID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_WORKORDGetWOforContractor, null,
                                                           contractID, contractorID);
        }

        public DataTable GetPostings(int contractID, int WOID, int DWRID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(ItemPostingStoredProcedure.usp_ACTIWOGetPostingsForDWR, null,
                                                        contractID, WOID, DWRID).Tables[0];
        }

        public DataTable GetPostings(int DWRID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(ItemPostingStoredProcedure.usp_ACTIWOGetPostingsForDWR, null,
                                                        DWRID).Tables[0];
        }

        public DataSet GetActivitiesForPostings(string moduleId, int parentInstanceId, int itemId, int? subItemId,
                                                  int? activityId, int workorderId, int postingId)
        {
            return ITMPOSTDAC.Instance.GetActivitiesForItemPostings(moduleId, parentInstanceId, itemId, subItemId,
                                                                    activityId, workorderId, postingId);
        }

        public DateTime? GetDWRDate(int DWRID)
        {
            return ITMPOSTDAC.Instance.GetDWRDate(DWRID);
        }

        public DataTable GetWorkOrderDetails(int WorkOrderID)
        {
            return ITMPOSTDAC.Instance.GetWorkOrderDetails(WorkOrderID);
        }

        private DataSet GetPostingsForContractList(string contractIDList)
        {
            return ITMPOSTDAC.Instance.GetPostingsForContractList(contractIDList);
        }

        public DataSet GetWorkOrdersForContractList(string contractIDList)
        {
            return ITMPOSTDAC.Instance.GetWorkOrdersForContractList(contractIDList);
        }

        [Obsolete]
        public DataSet GetApprovedItemPostingByDWRAndItem(string itemId, string contractID)
        {
            return ITMPOSTDAC.Instance.GetApprovedItemPostingByDWRAndItem(itemId, contractID);
        }

        public Dictionary&lt;int, PostedItemDto&gt; GetApprovedPostedQtyForItemsInDWR(List&lt;int&gt; itemIdList, int contractID)
        {
            string csvItemsId = string.Join(&quot;,&quot;, itemIdList);

            DataSet ds = ITMPOSTDAC.Instance.GetApprovedPostedQtyForItemsInDWR(csvItemsId, contractID);

            Dictionary&lt;int, PostedItemDto&gt; returnDictionary = new Dictionary&lt;int, PostedItemDto&gt;();

            if (ds.Tables.Count &gt; 0)
            {
                foreach (DataRow row in ds.Tables[0].Rows)
                {
                    PostedItemDto dto = new PostedItemDto()
                    {
                        ContractId = contractID,
                        ItemId = row[&quot;ItemId&quot;].ToInt32_2(),
                        PositivePostedQty = (row[&quot;PositivePostedQty&quot;] == System.DBNull.Value) ? 0 : row[&quot;PositivePostedQty&quot;].ToDecimal2(),
                        NegativePostedQty = (row[&quot;NegativePostedQty&quot;] == System.DBNull.Value) ? 0 : row[&quot;NegativePostedQty&quot;].ToDecimal2()
                    };

                    returnDictionary.Add(dto.ItemId, dto);
                }
            }

            return returnDictionary;
        }

        public DataSet GetWorkOrdersForContract(int contractId)
        {
            return ITMPOSTDAC.Instance.GetWorkOrdersForContract(contractId);
        }

        public void CreateWorkPosting(int postingId)
        {
            ITMPOSTDAC.Instance.CreateWorkPosting(postingId);
        }

        internal DataSet CUDMBookForIP(int postingId, string mBookItems, string mBookItemsDetail, string mode)
        {
            return ITMPOSTDAC.Instance.CUDMBookForIP(postingId, mBookItems,
                                  mBookItemsDetail, mode);
        }

        public DataSet GetIPsByDWRID(int contractID, int? DWRID)
        {
            return ITMPOSTDAC.Instance.GetIPsByDWRID(contractID, DWRID);
        }

        [Context(Name = &quot;ITMPOST&quot;)]
        public class COBreadCrumb : ContractBreadCrumb
        {
        }


        public class PostedItemDto
        {
            public int ItemId { get; set; }
            public int ContractId { get; set; }

            public decimal PositivePostedQty { get; set; }
            public decimal NegativePostedQty { get; set; }

            public decimal TotalPostedQty { get { return PositivePostedQty + NegativePostedQty; } }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[35,9,35,10,0],[36,13,36,47,0],[50,13,50,32,0],[51,9,51,10,0],[54,9,54,10,0],[55,13,55,47,0],[57,13,57,60,0],[58,13,58,60,0],[59,13,59,52,0],[60,13,60,33,0],[62,13,64,114,0],[65,13,65,29,0],[66,13,66,96,0],[67,17,67,86,0],[68,13,68,88,0],[69,17,69,67,0],[71,13,71,32,0],[72,9,72,10,0],[79,9,79,10,0],[80,13,80,47,0],[82,13,82,60,0],[83,13,83,60,0],[84,13,84,52,0],[85,13,85,33,0],[87,13,89,106,0],[90,13,90,29,0],[91,13,91,96,0],[92,17,92,86,0],[93,13,93,88,0],[94,17,94,67,0],[96,13,96,32,0],[97,9,97,10,0],[100,9,100,10,0],[101,13,101,47,0],[103,13,103,60,0],[104,13,104,60,0],[105,13,105,52,0],[106,13,106,33,0],[108,13,110,106,0],[111,13,111,29,0],[112,13,112,96,0],[113,17,113,86,0],[114,13,114,88,0],[115,17,115,67,0],[117,13,117,32,0],[118,9,118,10,0],[125,9,125,10,0],[127,13,127,14,0],[128,17,128,62,0],[129,17,129,18,0],[130,21,130,56,0],[131,26,131,37,0],[131,39,131,68,0],[131,70,131,78,0],[132,25,132,70,0],[133,21,133,49,0],[134,21,134,22,0],[135,25,135,85,0],[136,25,136,87,0],[137,25,137,60,0],[138,25,138,52,0],[141,25,141,35,0],[143,22,143,69,0],[144,17,144,18,0],[145,21,145,56,0],[146,26,146,37,0],[146,39,146,68,0],[146,70,146,78,0],[147,25,147,69,0],[148,21,148,49,0],[149,21,149,22,0],[150,25,150,96,0],[151,25,151,54,0],[152,25,152,46,0],[155,25,155,35,0],[157,13,157,14,0],[158,13,158,30,0],[159,13,159,14,0],[160,17,160,37,0],[162,13,162,33,0],[163,9,163,10,0],[170,9,170,10,0],[171,13,171,26,0],[172,9,172,10,0],[179,9,179,10,0],[180,13,180,47,0],[182,13,182,60,0],[183,13,183,60,0],[184,13,184,52,0],[185,13,185,33,0],[186,13,186,51,0],[188,13,190,109,0],[191,13,191,29,0],[192,13,192,96,0],[193,17,193,86,0],[194,13,194,88,0],[195,17,195,67,0],[197,13,197,32,0],[198,9,198,10,0],[201,9,201,10,0],[202,13,202,47,0],[204,13,204,60,0],[205,13,205,60,0],[206,13,206,52,0],[207,13,207,33,0],[208,13,208,51,0],[210,13,212,109,0],[213,13,213,29,0],[214,13,214,96,0],[215,17,215,86,0],[216,13,216,88,0],[217,17,217,67,0],[219,13,219,32,0],[220,9,220,10,0],[227,9,227,10,0],[228,13,228,47,0],[230,13,230,60,0],[231,13,231,60,0],[232,13,232,52,0],[233,13,233,33,0],[235,13,237,112,0],[238,13,238,29,0],[239,13,239,96,0],[240,17,240,86,0],[241,13,241,88,0],[242,17,242,67,0],[244,13,244,32,0],[245,9,245,10,0],[248,9,248,10,0],[249,13,249,47,0],[251,13,251,60,0],[252,13,252,60,0],[253,13,253,52,0],[254,13,254,33,0],[256,13,258,112,0],[259,13,259,29,0],[260,13,260,96,0],[261,17,261,86,0],[262,13,262,88,0],[263,17,263,67,0],[265,13,265,32,0],[266,9,266,10,0],[273,9,273,10,0],[274,13,274,47,0],[276,13,276,14,0],[277,17,277,45,0],[277,46,277,74,0],[279,17,279,46,0],[280,17,280,39,0],[282,17,282,28,0],[282,30,282,40,0],[285,17,285,132,0],[286,21,286,54,0],[287,17,287,128,0],[288,21,288,57,0],[290,17,290,93,0],[291,17,291,38,0],[292,17,292,44,0],[293,17,293,43,0],[294,17,294,126,0],[295,21,295,63,0],[296,17,296,137,0],[297,21,297,80,0],[298,17,298,134,0],[299,21,299,77,0],[300,17,300,129,0],[301,21,301,59,0],[302,17,302,127,0],[303,21,303,57,0],[304,17,304,129,0],[305,21,305,59,0],[306,17,306,134,0],[307,17,307,18,0],[308,21,308,76,0],[309,21,309,140,0],[310,25,310,70,0],[311,17,311,18,0],[313,17,313,18,0],[314,21,314,54,0],[315,21,315,56,0],[316,17,316,18,0],[317,17,317,137,0],[318,21,318,80,0],[319,17,319,29,0],[320,17,320,84,0],[321,21,321,78,0],[323,17,323,132,0],[324,21,324,138,0],[328,17,329,116,0],[330,17,331,116,0],[333,17,333,64,0],[334,17,334,24,0],[334,26,334,39,0],[334,40,334,42,0],[334,43,334,96,0],[335,17,335,18,0],[336,21,336,94,0],[337,21,337,89,0],[338,21,338,50,0],[340,21,340,22,0],[341,25,341,95,0],[342,25,342,48,0],[343,29,343,107,0],[344,30,344,53,0],[345,29,345,116,0],[346,30,346,54,0],[347,29,347,166,0],[349,25,349,26,0],[350,29,350,125,0],[351,29,351,56,0],[352,29,352,62,0],[354,29,354,79,0],[355,29,355,65,0],[356,29,356,57,0],[357,29,357,68,0],[358,29,358,52,0],[359,29,359,85,0],[360,29,360,53,0],[361,29,361,86,0],[362,29,362,103,0],[363,29,363,86,0],[364,29,364,65,0],[365,29,365,56,0],[367,29,367,71,0],[370,29,370,30,0],[371,33,371,175,0],[372,33,372,165,0],[373,29,373,30,0],[374,29,374,34,0],[374,35,374,36,0],[374,37,374,38,0],[375,25,375,26,0],[376,21,376,22,0],[377,21,377,41,0],[378,21,378,22,0],[379,25,379,45,0],[380,21,380,22,0],[381,21,382,127,0],[383,17,383,18,0],[384,17,384,84,0],[385,13,385,14,0],[386,13,386,39,0],[387,13,387,14,0],[388,17,388,43,0],[389,17,389,58,0],[390,13,390,14,0],[391,13,391,33,0],[392,13,392,14,0],[393,17,393,43,0],[394,17,394,55,0],[395,13,395,14,0],[396,13,396,31,0],[397,9,397,10,0],[402,9,402,10,1],[403,13,403,43,1],[404,13,404,73,1],[405,13,405,76,1],[406,13,406,94,1],[408,13,408,118,1],[409,13,409,102,1],[410,13,411,87,1],[412,13,414,48,1],[415,13,415,109,1],[417,13,417,115,1],[418,13,418,129,1],[419,13,419,121,1],[420,13,421,99,1],[422,13,425,120,1],[426,13,427,96,1],[428,13,428,117,1],[429,13,430,87,1],[431,13,435,55,1],[436,13,439,120,1],[440,13,444,53,1],[445,13,448,114,1],[449,13,450,96,1],[451,13,452,105,1],[453,13,454,87,1],[455,13,455,118,1],[456,13,457,105,1],[458,13,459,90,1],[460,13,461,87,1],[462,13,463,96,1],[464,13,465,102,1],[466,13,467,114,1],[468,13,469,120,1],[470,13,470,45,1],[471,17,471,116,1],[472,13,472,49,1],[473,17,474,91,0],[475,13,475,45,1],[476,17,476,116,0],[488,13,488,45,1],[489,13,489,74,1],[491,13,491,85,1],[492,9,492,10,1],[495,9,495,10,1],[496,13,496,98,1],[497,9,497,10,1],[500,9,500,10,0],[501,13,501,83,0],[502,9,502,10,0],[505,9,505,10,1],[506,13,506,60,1],[507,13,509,96,1],[510,13,510,54,1],[512,13,512,40,1],[513,13,513,111,1],[514,17,514,74,0],[515,13,515,40,1],[516,13,516,111,1],[517,17,517,91,1],[518,13,518,47,1],[519,9,519,10,1],[522,9,522,10,0],[523,13,523,60,0],[524,13,526,96,0],[527,13,527,54,0],[529,13,529,40,0],[530,13,530,111,0],[531,17,531,74,0],[532,13,532,40,0],[533,13,533,111,0],[534,17,534,91,0],[535,13,535,47,0],[536,9,536,10,0],[539,9,539,10,0],[540,13,540,60,0],[541,13,543,25,0],[545,13,545,54,0],[546,13,546,40,0],[547,13,547,111,0],[548,17,548,74,0],[549,13,549,40,0],[550,13,550,111,0],[551,17,551,91,0],[553,13,553,47,0],[554,9,554,10,0],[557,9,557,10,0],[558,13,558,88,0],[559,9,559,10,0],[562,9,562,10,0],[564,13,564,14,0],[565,17,566,89,0],[568,13,568,18,0],[569,13,569,14,0],[570,17,570,29,0],[572,9,572,10,0],[575,9,575,10,0],[576,13,576,56,0],[578,13,578,63,0],[579,13,579,61,0],[580,13,580,68,0],[581,13,581,67,0],[582,13,582,71,0],[583,13,583,64,0],[584,13,584,65,0],[585,13,585,69,0],[586,13,586,65,0],[587,13,587,65,0],[589,13,589,20,0],[589,22,589,32,0],[589,33,589,35,0],[589,36,589,65,0],[590,13,590,14,0],[591,17,591,50,0],[594,17,594,18,0],[595,21,595,80,0],[596,21,596,94,0],[597,21,597,78,0],[598,21,598,86,0],[599,21,599,72,0],[600,21,600,85,0],[601,21,601,93,0],[602,21,602,85,0],[603,21,603,74,0],[605,21,605,45,0],[606,17,606,18,0],[607,17,607,22,0],[608,17,608,18,0],[609,17,609,18,0],[610,13,610,14,0],[612,13,612,31,0],[613,9,613,10,0],[616,9,616,10,0],[617,13,618,86,0],[619,9,619,10,0],[622,9,622,10,0],[623,13,625,92,0],[626,9,626,10,0],[629,9,629,10,0],[630,13,632,74,0],[633,9,633,10,0],[637,9,637,10,1],[638,13,639,105,1],[640,9,640,10,1],[643,9,643,10,0],[644,13,644,58,0],[645,9,645,10,0],[648,9,648,10,0],[649,13,649,73,0],[650,9,650,10,0],[653,9,653,10,0],[654,13,654,83,0],[655,9,655,10,0],[658,9,658,10,0],[659,13,659,85,0],[660,9,660,10,0],[664,9,664,10,0],[665,13,665,95,0],[666,9,666,10,0],[669,9,669,10,1],[670,13,670,62,1],[672,13,672,104,1],[674,13,674,100,1],[676,13,676,37,1],[677,13,677,14,1],[678,17,678,24,1],[678,26,678,37,1],[678,38,678,40,1],[678,41,678,58,1],[679,17,679,18,1],[680,21,686,23,1],[688,21,688,59,1],[689,17,689,18,1],[690,13,690,14,1],[692,13,692,37,1],[693,9,693,10,1],[696,9,696,10,0],[697,13,697,77,0],[698,9,698,10,0],[701,9,701,10,1],[702,13,702,62,1],[703,9,703,10,1],[706,9,706,10,0],[707,13,708,59,0],[709,9,709,10,0],[712,9,712,10,1],[713,13,713,73,1],[714,9,714,10,1],[724,33,724,37,1],[724,38,724,42,1],[725,37,725,41,0],[725,42,725,46,1],[727,48,727,52,0],[727,53,727,57,1],[728,48,728,52,0],[728,53,728,57,1],[730,49,730,50,0],[730,51,730,96,0],[730,97,730,98,0]]);
    </script>
  </body>
</html>