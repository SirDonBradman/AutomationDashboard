<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\ModuleManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Web.Configuration;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementDAC;
using Aurigo.AMP3.ModuleManagementDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Aurigo.Common.Utility;
using CacheProvider;

namespace Aurigo.AMP3.ModuleManagementBL
{
    public partial class ModuleManager : SingletonManagerBase&lt;ModuleManager&gt;
    {
        private List&lt;string&gt; _coreModuleComponents = null;

        private List&lt;string&gt; CoreModuleComponents
        {
            get
            {
                if (_coreModuleComponents == null)
                    _coreModuleComponents = GetModuleComponenets(Constants.MODID_CORE);

                return _coreModuleComponents;
            }
        }

        public static ModuleManager Inst(string company = null)
        {
            if (_Inst == null)
            {
                lock (_oSync)
                {
                    if (_Inst == null) _Inst = new Dictionary&lt;string, ModuleManager&gt;();
                }
            }

            string currentCompany = null == company ? ConnectionHelper.GetCurrentCompany() : company;

            if (!_Inst.ContainsKey(currentCompany))
            {
                lock (_oSync)
                { if (!_Inst.ContainsKey(currentCompany)) _Inst.Add(currentCompany, new ModuleManager(currentCompany)); }
            }
            return _Inst[currentCompany];
        }

        public string company;
        public string CORE_VERSION;

        private ModuleManager() : this(null)
        {
        } //must have a default constructor if generic singleton is used

        private ModuleManager(string currentcompany)
        {
            CORE_VERSION = GetModuleVersion(Constants.MODID_CORE, currentcompany);
            if (string.IsNullOrEmpty(CORE_VERSION))
            {
                CORE_VERSION = ConfigurationManager.AppSettings[&quot;ProductVersion&quot;];
                if (string.IsNullOrEmpty(CORE_VERSION)) CORE_VERSION = &quot;7.1.20130906.05&quot;;
            }
            company = currentcompany;
        }

        /// &lt;summary&gt;
        /// Get the Deployed Modules filterd by &quot;Enterprise&quot; from the Enterprise Database
        /// send as DataTable to BL.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        ///
        public DataRow GetModuleDetails(string moduleID, string company = null)
        {
            try
            {
                string currentCompany = null == company ? ConnectionHelper.GetCurrentCompany() : company;
                return CoreDatabaseHelper.GetModuleDetails(moduleID, currentCompany);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public string GetModuleVersion(string moduleID, string company = null)
        {
            try
            {
                DataRow dr = CoreDatabaseHelper.GetModuleDetails(moduleID, company);
                return (dr != null) ? (dr[&quot;Version&quot;].ToString2()) : &quot;&quot;;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get the instanceurl for the searchable modules
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&lt;/returns&gt;
        ///
        public string GetInstanceURL(string ModuleID)
        {
            try
            {
                DataRow dr = CoreDatabaseHelper.GetModuleDetails(ModuleID);
                return (dr != null) ? dr[&quot;InstanceURL&quot;].ToString2() : &quot;&quot;;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get the instanceDLL for the modules
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&lt;/returns&gt;
        ///
        public List&lt;string&gt; GetInstanceDLL(string ModuleID)
        {
            try
            {
                DataRow dr = CoreDatabaseHelper.GetModuleDetails(ModuleID);
                var MainDll = new List&lt;string&gt;();
                if (dr != null)
                    MainDll.AddRange(new[] { dr[&quot;MainDLL&quot;].ToString2(), dr[&quot;BLClassName&quot;].ToString2() });
                return MainDll;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get the Deployed Modules filterd by &quot;Enterprise&quot; from the Enterprise Database
        /// send as DataTable to BL.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;DataTable&lt;/returns&gt;
        public DataTable GetModules(string currentCompany = null)
        {
            try
            {
                string cCompany = null == currentCompany ? company : currentCompany;
                return ModuleManagementComponent.Instance.GetModules(true, cCompany);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get all the deployed modules
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetModuleList(string currentCompany = null)
        {
            try
            {
                var listModules = new Dictionary&lt;string, string&gt;();
                string cCompany = null == currentCompany ? company : currentCompany;
                DataTable dtModules = GetModules(cCompany);
                if (dtModules != null)
                {
                    foreach (DataRow drModule in dtModules.Rows)
                    {
                        listModules.Add(drModule[&quot;ModuleID&quot;].ToString2(), drModule[&quot;ModuleName&quot;].ToString2());
                    }
                }
                return listModules;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public Dictionary&lt;string, string&gt; GetLogModuleList()
        {
            try
            {
                var listModules = new Dictionary&lt;string, string&gt;();
                DataTable dtModules = GetModules();
                if (dtModules != null)
                {
                    foreach (DataRow drModule in dtModules.Rows)
                    {
                        if (drModule[&quot;ModuleType&quot;].ToString2().ToUpper2().Equals(&quot;FORM&quot;))
                            listModules.Add(drModule[&quot;ModuleID&quot;].ToString2(), drModule[&quot;ModuleName&quot;].ToString2());
                    }
                }
                return listModules;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get all the deployed modules, where parent = parentid
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;parentID&quot;&gt;parentmoduleid&lt;/param&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetModuleListByParent(string parentID, bool fetchOnlyActiveModules = false)
        {
            try
            {
                var listModules = new Dictionary&lt;string, string&gt;();
                DataTable dtModuleList = ModuleManagementComponent.Instance.GetModulesByParent(parentID, company,
                    fetchOnlyActiveModules);

                if (dtModuleList != null)
                {
                    foreach (DataRow drModule in dtModuleList.Rows)
                    {
                        listModules.Add(drModule[&quot;ModuleID&quot;].ToString2(), drModule[&quot;ModuleName&quot;].ToString2());
                    }
                }
                return listModules;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;sucess/failure&lt;/returns&gt;
        public int DeleteModule(string moduleID)
        {
            try
            {
                int rtnValue;
                lock (ModuleManagementComponent.Instance)
                {
                    rtnValue = ModuleManagementComponent.Instance.DeleteModule(moduleID, company);
                }
                return rtnValue;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;permissionMatrix&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool UpdateModulePermissions(string moduleID, Hashtable permissionMatrix)
        {
            return true;
        }

        public Dictionary&lt;int, List&lt;int&gt;&gt; GetPermissionMatrix(string moduleID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetPermissionMatrix(moduleID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;permissionTable&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roles&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;features&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;matrix&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isEdit&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;moduleId&quot;&gt;&lt;/param&gt;
        public int CreatePermissionTable(
            HtmlTable permissionTable,
            Dictionary&lt;int, string&gt; roles,
            Dictionary&lt;int, string&gt; features,
            Dictionary&lt;int, List&lt;int&gt;&gt; matrix,
            bool isEdit,
            string moduleId)
        {
            try
            {
                int rtnAdminRoleID = 0;
                //Row 1 // Header Row
                var row = new HtmlTableRow();

                row.EnableViewState = false;
                permissionTable.Rows.Add(row);

                // Role Header Label spanning one column and two rows
                var cell = new HtmlTableCell();
                cell.EnableViewState = true;
                var lblHeader = new Label();
                lblHeader.EnableViewState = false;
                //lblHeader.SkinID = &quot;LabelSubHeader1&quot;;
                lblHeader.CssClass = &quot;lblC&quot;;
                lblHeader.Text = &quot;Roles&quot;;
                cell.Controls.Add(lblHeader);
                cell.Style.Add(HtmlTextWriterStyle.FontWeight, &quot;Bold&quot;);
                cell.Style.Add(HtmlTextWriterStyle.FontSize, &quot;11px&quot;);
                cell.RowSpan = 2;
                cell.Attributes.Add(&quot;class&quot;, &quot;lblC&quot;);
                row.Cells.Add(cell);

                // Feature (Reports) Header Label spanning (All-1) column and one row
                cell = new HtmlTableCell();
                cell.EnableViewState = false;
                lblHeader = new Label();
                lblHeader.EnableViewState = false;
                //lblHeader.SkinID = &quot;LabelSubHeader1&quot;;
                lblHeader.CssClass = &quot;lblC&quot;;
                lblHeader.Text = &quot;Features&quot;;
                cell.Controls.Add(lblHeader);
                cell.ColSpan = features.Count;
                cell.Align = &quot;center&quot;;
                cell.Style.Add(HtmlTextWriterStyle.FontWeight, &quot;Bold&quot;);
                cell.Style.Add(HtmlTextWriterStyle.FontSize, &quot;11px&quot;);
                row.Cells.Add(cell);

                //Row 2 - show all the reports (features) in the header second line
                row = new HtmlTableRow();
                row.EnableViewState = false;
                permissionTable.Rows.Add(row);

                foreach (var feature in features)
                {
                    cell = new HtmlTableCell();
                    cell.EnableViewState = false;
                    //cell.InnerText = role.Value;
                    var lblRole = new Label();
                    lblRole.EnableViewState = false;
                    lblRole.Text = feature.Value;
                    lblRole.CssClass = &quot;verticaltext&quot;;
                    //lblRole.ToolTip = role.Value.Split(&#39;,&#39;)[1];
                    cell.Controls.Add(lblRole);
                    cell.Align = &quot;center&quot;;
                    cell.VAlign = &quot;bottom&quot;;
                    cell.Width = Unit.Pixel(50).ToString2();
                    cell.Attributes.Add(&quot;class&quot;, &quot;lblC&quot;);
                    cell.Style.Add(HtmlTextWriterStyle.FontWeight, &quot;Bold&quot;);
                    cell.Style.Add(HtmlTextWriterStyle.FontSize, &quot;11px&quot;);
                    row.Cells.Add(cell);
                }

                // All Roles rows to capture permissions
                // get roles having view permission
                DataTable dtAllowedRoles = new DataTable();
                if (moduleId.ToUpper() == &quot;ENTPRSE&quot; || moduleId.ToUpper2() == &quot;DOCMGMT&quot;)
                    dtAllowedRoles = GetRolesForaFeature(moduleId, &quot;Visibility&quot;);
                else
                    dtAllowedRoles = GetRolesForaFeature(moduleId, &quot;view&quot;);

                foreach (var role in roles)
                {
                    row = new HtmlTableRow();
                    row.EnableViewState = false;
                    permissionTable.Rows.Add(row);

                    bool hasViewVisibility = (dtAllowedRoles.Rows.Count &gt; 0 &amp;&amp;
                                              (dtAllowedRoles.Select(&quot;RoleName=&#39;&quot; + role.Value.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) + &quot;&#39;&quot;).Length == 1));
                    if (!hasViewVisibility)
                        row.Attributes.Add(&quot;Title&quot;, &quot;This role does not have view permission for this module&quot;);

                    // Role Header Label spanning one column and two rows
                    //feature Name
                    cell = new HtmlTableCell();
                    cell.EnableViewState = false;
                    cell.InnerText = role.Value;
                    row.Cells.Add(cell);

                    foreach (var feature in features)
                    {
                        cell = new HtmlTableCell();
                        cell.EnableViewState = false;
                        var chk = new CheckBox();
                        chk.EnableViewState = false;
                        chk.ID = &quot;cM_&quot; + feature.Key + &quot;_&quot; + role.Key;
                        if (role.Key == Constants.USRMGMT_ADMIN_RID)
                        {
                            rtnAdminRoleID = role.Key;
                            chk.Enabled = false;
                            chk.Checked = true;
                        }
                        else
                        {
                            chk.Enabled = isEdit &amp;&amp; hasViewVisibility;
                            chk.Checked = false;

                            // library modifications **************
                            switch (feature.Value)
                            {
                                case &quot;ModifySchema&quot;:
                                case &quot;ModifyRecords&quot;:
                                case &quot;PendingApproval&quot;:
                                case &quot;CreateUser&quot;:
                                case &quot;ModifyUser&quot;:
                                case &quot;ManageRoles&quot;:
                                case &quot;AddScript&quot;:
                                case &quot;DeleteScript&quot;:
                                case &quot;DownloadScript&quot;:
                                case &quot;ViewDetails&quot;:
                                case &quot;SetDefault&quot;:
                                case &quot;Deploy&quot;:
                                case &quot;Permission&quot;:
                                    chk.Enabled = false;
                                    chk.Checked = false;
                                    break;

                                case &quot;ModifyLinks&quot;:
                                case &quot;Settings&quot;:
                                case Constants.MODFEAT_VISIBILITY:
                                case &quot;View&quot;:
                                case &quot;Delete&quot;:
                                    switch (moduleId)
                                    {
                                        case &quot;WORKFLW&quot;:
                                        case &quot;USRMGMT&quot;:
                                        case &quot;MODMGMT&quot;:
                                            chk.Enabled = false;
                                            chk.Checked = false;
                                            break;
                                    }
                                    break;
                            }

                            if (matrix.ContainsKey(feature.Key))
                            {
                                List&lt;int&gt; tempstr = matrix[feature.Key];
                                if (tempstr.Contains(role.Key))
                                {
                                    chk.Checked = true;
                                }
                            }
                        }
                        cell.Align = &quot;center&quot;;
                        cell.Width = Unit.Pixel(50).ToString2();
                        cell.Controls.Add(chk);
                        row.Cells.Add(cell);
                    }
                }
                return rtnAdminRoleID;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public Dictionary&lt;int, string&gt; GetModuleFeatures(string moduleID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetModuleFeatures(moduleID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public Dictionary&lt;int, string[]&gt; GetModuleFeaturesWithDetails(string moduleID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetModuleFeaturesWithDetails(moduleID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public Dictionary&lt;int, string&gt; GetAllRoles()
        {
            try
            {
                return UserManager.Instance.GetRoles();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public bool UpdatePermissionMatrix(string moduleID, Dictionary&lt;int, List&lt;int&gt;&gt; matrix, int adminRoleID,
            bool Loggingflag, bool IsSearchable, bool enableEditByNonStakeHolder, bool allowActionByAllStakeHolders)
        {
            try
            {
                lock (ModuleManagementComponent.Instance)
                {
                    ModuleManagementComponent.Instance.UpdatePermissionMatrix(moduleID, matrix, adminRoleID, Loggingflag,
                        IsSearchable, enableEditByNonStakeHolder: enableEditByNonStakeHolder, allowActionByAllStakeHolders: allowActionByAllStakeHolders);
                }
                return true;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public bool UpdateRptPermissionMatrix(string moduleID, Dictionary&lt;int, List&lt;int&gt;&gt; matrix)
        {
            try
            {
                lock (ModuleManagementComponent.Instance)
                {
                    ModuleManagementComponent.Instance.UpdateRptPermissionMatrix(moduleID, matrix, company);
                }
                return true;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public List&lt;string&gt; GetPermissionByRole(string moduleID, int roleID)
        {
            throw new Exception(&quot;Deprecated : Please use GetPermissionByUserOrRole method&quot;);
            //try
            //{
            //    return ModuleManagementComponent.Instance.GetPermissionByRole(moduleID, roleID, company);
            //}
            //catch (Exception ex)
            //{
            //    Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
            //    throw;
            //}
        }

        public bool HasAdminRole(UserDetail ud)
        {
            if (ud == null) return false;

            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                return UserManager.Instance.IsUserAdministrator(ud.UID);
            else
                return ud.RID == Constants.USRMGMT_ADMIN_RID ? true : false;
        }

        public List&lt;string&gt; GetPermissionByUserOrRole(string moduleID, int userId, int roleId, int projectId, bool convertResultToLowercase = false)
        {
            try
            {
                if (IsEffectivePermissionOfRoles())
                    roleId = 0;
                return ModuleManagementComponent.Instance.GetPermissionByUserOrRole(moduleID, userId, roleId, projectId,
                    company, convertResultToLowercase);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public List&lt;Dictionary&lt;string, object&gt;&gt; GetAllMapEnabledFormsForProject(string projectID)
        {
            try
            {
                var MapEnabledForms = new
                    List&lt;Dictionary&lt;string, object&gt;&gt;();
                DataTable dtModules = ModuleManagementComponent.Instance.GetAllMapEnabledFormsForProject(projectID);

                foreach (DataRow drModule in dtModules.Rows)
                {
                    Dictionary&lt;string, object&gt; rows = new Dictionary&lt;string, object&gt;();
                    foreach (DataColumn col in dtModules.Columns)
                    {
                        rows.Add(col.ColumnName, drModule[col.ColumnName]);
                    }

                    MapEnabledForms.Add(rows);
                }

                return MapEnabledForms;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get all searchable modules
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetSearchableModules()
        {
            try
            {
                var SearchableModules = new Dictionary&lt;string, string&gt;();
                DataTable dtModules = GetModules();

                DataRow[] drModules = dtModules.Select(&quot;IsSearchable = true&quot;);
                if (drModules.Length &gt; 0)
                {
                    foreach (DataRow drModule in drModules)
                    {
                        SearchableModules.Add(drModule[&quot;ModuleID&quot;].ToString2(), drModule[&quot;ModuleName&quot;].ToString2());
                    }
                }
                return SearchableModules;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get all the available platforms
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetPlatformList()
        {
            try
            {
                return ModuleManagementComponent.Instance.GetPlatformList(company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public List&lt;string&gt; GetModulesForaRole(int RoleID, string FeaturesCode)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetModulesForaRole(RoleID, FeaturesCode, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public int GetVisibilityFeatureID(string ModuleID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetVisibilityFeatureID(ModuleID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        ///
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool ModuleExists(string moduleID)
        {
            return ModuleManagementComponent.Instance.ModuleExists(moduleID);
        }

        /// &lt;summary&gt;
        /// Fetches all the applications available for Download
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetAllApplications()
        {
            try
            {
                return ModuleManagementComponent.Instance.GetAllApplications(company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches all the supported application types
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetApplicationTypes()
        {
            try
            {
                return ModuleManagementComponent.Instance.GetApplicationTypes(company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes specified Downlodable applications from server
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;IDList&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int DeleteApplications(List&lt;int&gt; IDList)
        {
            try
            {
                return ModuleManagementComponent.Instance.DeleteApplications(IDList, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches details of an application
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;appID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public ApplicationDetails GetApplicationDetails(int appID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetApplicationDetails(appID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Adds Downlodable application to database
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;app&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int AddApplication(ApplicationDetails app, string company)
        {
            try
            {
                return ModuleManagementComponent.Instance.AddApplication(app, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Fetches application&#39;s setup file path on server
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;Platform&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;appType&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;application&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;version&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetApplicationFilePath(string Platform, string appType, string application, string version)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetApplicationFilePath(Platform, appType, application, version);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets latest version and its content length as an xml string,
        /// returns empty string if higher version is not available
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;Platform&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;appType&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;application&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;version&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string HasLatestApplication(string Platform, string appType, string application, string version)
        {
            try
            {
                return ModuleManagementComponent.Instance.HasLatestApplication(Platform, appType, application, version);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public DataTable GetModuleSummary()
        {
            try
            {
                return ModuleManagementComponent.Instance.GetModuleSummary(company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public int AddPermissions(int roleID, string ModuleId, string Feature)
        {
            try
            {
                return ModuleManagementComponent.Instance.AddPermissions(roleID, ModuleId, Feature, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public DataTable GetRolesForaFeature(string ModuleId, string FeatureCode)
        {
            return ModuleManagementComponent.Instance.GetRolesForaFeature(ModuleId, FeatureCode, company);
        }

        public int AddImageDetails(string name, string desc, string imagePath)
        {
            return ModuleManagementComponent.Instance.AddImageDetails(name, desc, imagePath, company);
        }

        public List&lt;LogoDetails&gt; GetImagedetails()
        {
            return ModuleManagementComponent.Instance.GetImagedetails(company);
        }

        public int DeleteImageDetails(string imageId)
        {
            return ModuleManagementComponent.Instance.DeleteImageDetails(imageId, company);
        }

        public int UpdateImageDetails(string name, string imagePath)
        {
            return ModuleManagementComponent.Instance.UpdateImageDetails(name, imagePath, company);
        }

        public int UpdateReportLogos(string name, string selectedModules)
        {
            return ModuleManagementComponent.Instance.UpdateReportLogos(name, selectedModules, company);
        }

        public DataTable GetAllModuleDetails(string currentCompany = null)
        {
            try
            {
                DataTable Modules = new BrixDataTable();
                Modules.Columns.AddRange(new[]
                {
                    new DataColumn(&quot;ModuleID&quot;), new DataColumn(&quot;ModuleName&quot;),
                    new DataColumn(&quot;ReportLogo&quot;)
                });

                string company = null == currentCompany ? ConnectionHelper.GetCurrentCompany() : currentCompany;
                DataTable dtModules = GetModules(company);
                if (dtModules != null)
                {
                    foreach (DataRow drModule in dtModules.Rows)
                    {
                        if (drModule[&quot;ModuleType&quot;].ToString2().ToUpper2().Equals(&quot;FORM&quot;) ||
                            drModule[&quot;ModuleType&quot;].ToString2().ToUpper2().Equals(&quot;APPLICATION&quot;))
                            Modules.Rows.Add(drModule[&quot;ModuleID&quot;], drModule[&quot;ModuleName&quot;], drModule[&quot;ReportLogo&quot;]);
                    }
                }
                return Modules;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_ENTPRSE);
                throw ex;
            }
        }

        public String GetXMLControlName(int contractID, string formName)
        {
            return ModuleManagementComponent.Instance.GetXMLControlName(contractID, formName, company);
        }

        public int AddModuleAttributes(string moduleId, string attrName, string attrValue)
        {
            return ModuleManagementComponent.Instance.AddModuleAttributes(moduleId, attrName, attrValue);
        }

        public DataTable GetViewVisibilityFeatureIDS(string moduleID)
        {
            try
            {
                return ModuleManagementComponent.Instance.GetViewVisibilityFeatureIDS(moduleID, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public DataTable GetAllModulePermissions(string roleID)
        {
            if (CoreModuleComponents.Contains(&quot;ShowUnifiedLibraryPermissions&quot;))
                return ModuleManagementComponent.Instance.GetAllModulePermissions(roleID);
            else
                return ModuleManagementComponent.Instance.GetAllModulePermissionsWithLibrary(roleID);
        }

        public List&lt;string&gt; GetModuleComponenets(string moduleId)
        {
            moduleId = moduleId.ToUpper();

            string cacheKey = RedisKeyConstants.ModComp + moduleId;
            List&lt;string&gt; components = CacheBroker.Get&lt;List&lt;string&gt;&gt;(cacheKey, regionName: AMP3ApplicationSettings.Instance.RedisRegionName); ;

            if (components == null)
            {
                components = new List&lt;string&gt;();
                DataTable dt = ModuleManagementComponent.Instance.GetModuleComponenets(moduleId);
                if (dt != null &amp;&amp; dt.Columns.Contains(&quot;ComponentName&quot;))
                {
                    foreach (DataRow row in dt.Rows)
                    {
                        if (!components.Contains(row[&quot;ComponentName&quot;].ToString()))
                            components.Add(row[&quot;ComponentName&quot;].ToString());
                    }
                }

                Double timeout = 5;
                if (WebConfigurationManager.AppSettings[&quot;ModuleComponentsCacheTimeout&quot;] != null)
                    timeout = WebConfigurationManager.AppSettings[&quot;ModuleComponentsCacheTimeout&quot;].ToDouble2();

                CacheBroker.Put(cacheKey, components, timeout: TimeSpan.FromMinutes(timeout), regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
            }

            return components;
        }

        public void ClearCachedModuleComponents(string moduleId)
        {
            string cacheKey = RedisKeyConstants.ModComp + moduleId.ToUpper();
            CacheBroker.Remove(cacheKey, regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
        }

        public List&lt;Dictionary&lt;string, object&gt;&gt; GetMapEnabledFormsForProject(string projectID)
        {
            try
            {
                var MapEnabledForms = new
                    List&lt;Dictionary&lt;string, object&gt;&gt;();
                DataTable dtModules = ModuleManagementComponent.Instance.GetMapEnabledFormsForProject(projectID);

                foreach (DataRow drModule in dtModules.Rows)
                {
                    Dictionary&lt;string, object&gt; rows = new Dictionary&lt;string, object&gt;();
                    foreach (DataColumn col in dtModules.Columns)
                    {
                        rows.Add(col.ColumnName, drModule[col.ColumnName]);
                    }

                    MapEnabledForms.Add(rows);
                }

                return MapEnabledForms;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public bool IsEffectivePermissionOfRoles()
        {
            List&lt;string&gt; components = ModuleManager.Instance.GetModuleComponenets(&quot;COREMOD&quot;);
            return (components.Contains(&quot;EffectivePermissionOfRoles&quot;));
        }

        public List&lt;string&gt; GetModulesForaUserOrRole(int UserID, int RoleID, int ProjectID, string FeaturesCode)
        {
            try
            {
                if (IsEffectivePermissionOfRoles())
                    RoleID = 0;
                return ModuleManagementComponent.Instance.GetModulesForaUserOrRole(UserID, RoleID, ProjectID,
                    FeaturesCode, company);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_MODMGMT);
                throw;
            }
        }

        public bool checkPermissions(string AssociatedModuleID, string moduleId, UserDetail ud, string sPid,
            List&lt;string&gt; features)
        {
            if (!string.IsNullOrEmpty(AssociatedModuleID))
            {
                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_MODMGMTGetInstanceURL, null, AssociatedModuleID);
                if (ds.Tables[0].Rows.Count == 0)
                    return true;
            }
            List&lt;string&gt; permissions =
              ModuleManager.Instance.GetPermissionByUserOrRole(
                  string.IsNullOrEmpty(AssociatedModuleID) ? moduleId : AssociatedModuleID,
                  ud.UID, ud.RID, sPid.ToInt32_2());

            if (permissions == null) throw new Exception(&quot;The user does not have permissions.&quot;);
            foreach (string feature in features)
            {
                if (!permissions.Contains(feature))
                    throw new Exception(&quot;The user does not have &quot; + feature + &quot; permissions.&quot;);
            }

            return true;
        }

        public bool IsXMLForm(string moduleId)
        {
            try
            {
                DataRow dr = CoreDatabaseHelper.GetModuleDetails(moduleId);
                return (dr != null) ? (string.IsNullOrWhiteSpace(dr[&quot;NavigateUrl&quot;].ToString2()) ? false :
                    (dr[&quot;NavigateUrl&quot;].ToString2().ToLower2().Equals(&quot;xmlform&quot;) ? true : false)) : false;
            }
            catch
            {
                throw;
            }
        }

        public bool IsAllowEditingForNonStakeHolder(string moduleId)
        {
            DataRow detailRow = ModuleManager.Instance.GetModuleDetails(moduleId);
            if (detailRow != null &amp;&amp; detailRow[&quot;EnableEditByNonStakeHolder&quot;] != null)
                return detailRow[&quot;EnableEditByNonStakeHolder&quot;].ToBoolean2();
            else
                return false;
        }

        public bool IsAllowActionByAllStakeHolders(string moduleId)
        {
            DataRow detailRow = ModuleManager.Instance.GetModuleDetails(moduleId);
            string associatedModuleID = moduleId;
            if (detailRow != null)
                associatedModuleID = string.IsNullOrEmpty(detailRow[&quot;AssociatedModuleID&quot;].ToString2()) ? moduleId : detailRow[&quot;AssociatedModuleID&quot;].ToString2();
            if (!associatedModuleID.Equals(moduleId))
                detailRow = ModuleManager.Instance.GetModuleDetails(associatedModuleID);
            if (detailRow != null &amp;&amp; detailRow[&quot;AllowActionByAllStakeHolders&quot;] != null)
                return detailRow[&quot;AllowActionByAllStakeHolders&quot;].ToBoolean2();
            else
                return false;
        }

        [Context(Name = Constants.MODID_MODMGMT)]
        public class UserBreadCrumb : BreadCrumbBase
        {
            public override string Title
            {
                get { return &quot;Administration&quot;; }
            }

            public override string URL
            {
                get { return &quot;#&quot;; }
            }

            public override BreadCrumbBase parent
            {
                get { return new RootBreadCrumb(); }
            }
        }

        public string GetContextHierarchy(string moduleID)
        {
            return ModuleManagementComponent.Instance.GetContextHierarchy(moduleID);
        }

        public DataTable GetReportDetailsWithLibraryFormDetails()
        {
            DataSet ds = ModuleManagementComponent.Instance.GetReportDetailsWithLibraryFormDetails();

            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                return ds.Tables[0];

            return ds.Tables[0];
        }

        public DataTable GetReportDetailsWithModuleDetails()
        {
            DataSet ds = ModuleManagementComponent.Instance.GetReportDetailsWithModuleDetails();

            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                return ds.Tables[0];

            return ds.Tables[0];
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[28,9,28,59,1],[33,13,33,14,0],[34,17,34,51,0],[35,21,35,88,0],[37,17,37,46,0],[38,13,38,14,0],[42,9,42,10,0],[43,13,43,31,0],[44,13,44,14,0],[45,17,45,30,0],[46,17,46,18,0],[47,21,47,39,0],[47,40,47,88,0],[48,17,48,18,0],[49,13,49,14,0],[51,13,51,102,0],[53,13,53,52,0],[54,13,54,14,0],[55,17,55,30,0],[56,17,56,18,0],[56,19,56,58,0],[56,59,56,120,0],[56,121,56,122,0],[57,13,57,14,0],[58,13,58,42,0],[59,9,59,10,0],[64,35,64,45,1],[65,9,65,10,1],[66,9,66,10,1],[68,9,68,53,1],[69,9,69,10,1],[70,13,70,83,1],[71,13,71,52,1],[72,13,72,14,0],[73,17,73,83,0],[74,17,74,56,0],[74,57,74,90,0],[75,13,75,14,0],[76,13,76,38,1],[77,9,77,10,1],[86,9,86,10,1],[88,13,88,14,1],[89,17,89,106,1],[90,17,90,86,1],[92,13,92,33,0],[93,13,93,14,0],[94,17,94,93,0],[95,17,95,23,0],[97,9,97,10,1],[100,9,100,10,1],[102,13,102,14,1],[103,17,103,85,1],[104,17,104,72,1],[106,13,106,33,0],[107,13,107,14,0],[108,17,108,93,0],[109,17,109,23,0],[111,9,111,10,1],[119,9,119,10,0],[121,13,121,14,0],[122,17,122,76,0],[123,17,123,74,0],[125,13,125,33,0],[126,13,126,14,0],[127,17,127,93,0],[128,17,128,23,0],[130,9,130,10,0],[138,9,138,10,0],[140,13,140,14,0],[141,17,141,76,0],[142,17,142,50,0],[143,17,143,32,0],[144,21,144,106,0],[145,17,145,32,0],[147,13,147,33,0],[148,13,148,14,0],[149,17,149,93,0],[150,17,150,23,0],[152,9,152,10,0],[160,9,160,10,1],[162,13,162,14,1],[163,17,163,85,1],[164,17,164,86,1],[166,13,166,33,0],[167,13,167,14,0],[168,17,168,93,0],[169,17,169,23,0],[171,9,171,10,1],[178,9,178,10,1],[180,13,180,14,1],[181,17,181,68,1],[182,17,182,85,1],[183,17,183,60,1],[184,17,184,39,1],[185,17,185,18,1],[186,21,186,28,1],[186,30,186,46,1],[186,47,186,49,1],[186,50,186,64,1],[187,21,187,22,1],[188,25,188,111,1],[189,21,189,22,1],[190,17,190,18,1],[191,17,191,36,1],[193,13,193,33,0],[194,13,194,14,0],[195,17,195,93,0],[196,17,196,23,0],[198,9,198,10,1],[201,9,201,10,0],[203,13,203,14,0],[204,17,204,68,0],[205,17,205,52,0],[206,17,206,39,0],[207,17,207,18,0],[208,21,208,28,0],[208,30,208,46,0],[208,47,208,49,0],[208,50,208,64,0],[209,21,209,22,0],[210,25,210,90,0],[211,29,211,115,0],[212,21,212,22,0],[213,17,213,18,0],[214,17,214,36,0],[216,13,216,33,0],[217,13,217,14,0],[218,17,218,93,0],[219,17,219,23,0],[221,9,221,10,0],[229,9,229,10,1],[231,13,231,14,1],[232,17,232,68,1],[233,17,234,45,1],[236,17,236,42,1],[237,17,237,18,1],[238,21,238,28,1],[238,30,238,46,1],[238,47,238,49,1],[238,50,238,67,1],[239,21,239,22,1],[240,25,240,111,1],[241,21,241,22,1],[242,17,242,18,1],[243,17,243,36,1],[245,13,245,33,0],[246,13,246,14,0],[247,17,247,93,0],[248,17,248,23,0],[250,9,250,10,1],[258,9,258,10,0],[260,13,260,14,0],[262,17,262,58,0],[263,17,263,18,0],[264,21,264,99,0],[265,17,265,18,0],[266,17,266,33,0],[268,13,268,33,0],[269,13,269,14,0],[270,17,270,93,0],[271,17,271,23,0],[273,9,273,10,0],[282,9,282,10,0],[283,13,283,25,0],[284,9,284,10,0],[287,9,287,10,0],[289,13,289,14,0],[290,17,290,98,0],[292,13,292,33,0],[293,13,293,14,0],[294,17,294,93,0],[295,17,295,23,0],[297,9,297,10,0],[315,9,315,10,0],[317,13,317,14,0],[318,17,318,40,0],[320,17,320,46,0],[322,17,322,45,0],[323,17,323,47,0],[326,17,326,48,0],[327,17,327,45,0],[328,17,328,45,0],[329,17,329,51,0],[331,17,331,45,0],[332,17,332,42,0],[333,17,333,46,0],[334,17,334,72,0],[335,17,335,70,0],[336,17,336,34,0],[337,17,337,54,0],[338,17,338,37,0],[341,17,341,44,0],[342,17,342,46,0],[343,17,343,41,0],[344,17,344,51,0],[346,17,346,45,0],[347,17,347,45,0],[348,17,348,46,0],[349,17,349,47,0],[350,17,350,39,0],[351,17,351,72,0],[352,17,352,70,0],[353,17,353,37,0],[356,17,356,42,0],[357,17,357,45,0],[358,17,358,47,0],[360,17,360,24,0],[360,26,360,37,0],[360,38,360,40,0],[360,41,360,49,0],[361,17,361,18,0],[362,21,362,48,0],[363,21,363,50,0],[365,21,365,47,0],[366,21,366,53,0],[367,21,367,50,0],[368,21,368,55,0],[370,21,370,48,0],[371,21,371,43,0],[372,21,372,44,0],[373,21,373,61,0],[374,21,374,58,0],[375,21,375,76,0],[376,21,376,74,0],[377,21,377,41,0],[378,17,378,18,0],[382,17,382,60,0],[383,17,383,89,0],[384,21,384,82,0],[386,21,386,76,0],[388,17,388,24,0],[388,26,388,34,0],[388,35,388,37,0],[388,38,388,43,0],[389,17,389,18,0],[390,21,390,46,0],[391,21,391,49,0],[392,21,392,51,0],[394,21,395,136,0],[396,21,396,44,0],[397,25,397,112,0],[401,21,401,48,0],[402,21,402,50,0],[403,21,403,49,0],[404,21,404,41,0],[406,21,406,28,0],[406,30,406,41,0],[406,42,406,44,0],[406,45,406,53,0],[407,21,407,22,0],[408,25,408,52,0],[409,25,409,54,0],[410,25,410,50,0],[411,25,411,53,0],[412,25,412,71,0],[413,25,413,69,0],[414,25,414,26,0],[415,29,415,55,0],[416,29,416,49,0],[417,29,417,48,0],[418,25,418,26,0],[420,25,420,26,0],[421,29,421,71,0],[422,29,422,49,0],[425,29,425,51,0],[440,37,440,57,0],[441,37,441,57,0],[442,37,442,43,0],[449,37,449,54,0],[454,45,454,65,0],[455,45,455,65,0],[456,45,456,51,0],[458,37,458,43,0],[461,29,461,65,0],[462,29,462,30,0],[463,33,463,73,0],[464,33,464,64,0],[465,33,465,34,0],[466,37,466,56,0],[467,33,467,34,0],[468,29,468,30,0],[469,25,469,26,0],[470,25,470,47,0],[471,25,471,65,0],[472,25,472,48,0],[473,25,473,45,0],[474,21,474,22,0],[475,17,475,18,0],[476,17,476,39,0],[478,13,478,33,0],[479,13,479,14,0],[480,17,480,93,0],[481,17,481,23,0],[483,9,483,10,0],[486,9,486,10,0],[488,13,488,14,0],[489,17,489,96,0],[491,13,491,33,0],[492,13,492,14,0],[493,17,493,93,0],[494,17,494,23,0],[496,9,496,10,0],[499,9,499,10,0],[501,13,501,14,0],[502,17,502,107,0],[504,13,504,33,0],[505,13,505,14,0],[506,17,506,93,0],[507,17,507,23,0],[509,9,509,10,0],[512,9,512,10,0],[514,13,514,14,0],[515,17,515,56,0],[517,13,517,33,0],[518,13,518,14,0],[519,17,519,93,0],[520,17,520,23,0],[522,9,522,10,0],[526,9,526,10,0],[528,13,528,14,0],[529,17,529,58,0],[530,17,530,18,0],[531,21,532,155,0],[533,17,533,18,0],[534,17,534,29,0],[536,13,536,33,0],[537,13,537,14,0],[538,17,538,93,0],[539,17,539,23,0],[541,9,541,10,0],[544,9,544,10,0],[546,13,546,14,0],[547,17,547,58,0],[548,17,548,18,0],[549,21,549,109,0],[550,17,550,18,0],[551,17,551,29,0],[553,13,553,33,0],[554,13,554,14,0],[555,17,555,93,0],[556,17,556,23,0],[558,9,558,10,0],[561,9,561,10,0],[562,13,562,93,0],[575,9,575,10,1],[576,13,576,28,1],[576,29,576,42,0],[578,13,578,71,1],[579,17,579,73,1],[581,17,581,77,0],[582,9,582,10,1],[585,9,585,10,1],[587,13,587,14,1],[588,17,588,52,1],[589,21,589,32,1],[590,17,591,56,1],[593,13,593,33,0],[594,13,594,14,0],[595,17,595,93,0],[596,17,596,23,0],[598,9,598,10,1],[601,9,601,10,0],[603,13,603,14,0],[604,17,605,56,0],[606,17,606,117,0],[608,17,608,24,0],[608,26,608,42,0],[608,43,608,45,0],[608,46,608,60,0],[609,17,609,18,0],[610,21,610,88,0],[611,21,611,28,0],[611,30,611,44,0],[611,45,611,47,0],[611,48,611,65,0],[612,21,612,22,0],[613,25,613,76,0],[614,21,614,22,0],[616,21,616,47,0],[617,17,617,18,0],[619,17,619,40,0],[621,13,621,33,0],[622,13,622,14,0],[623,17,623,93,0],[624,17,624,23,0],[626,9,626,10,0],[633,9,633,10,0],[635,13,635,14,0],[636,17,636,74,0],[637,17,637,52,0],[639,17,639,79,0],[640,17,640,42,0],[641,17,641,18,0],[642,21,642,28,0],[642,30,642,46,0],[642,47,642,49,0],[642,50,642,59,0],[643,21,643,22,0],[644,25,644,117,0],[645,21,645,22,0],[646,17,646,18,0],[647,17,647,42,0],[649,13,649,33,0],[650,13,650,14,0],[651,17,651,93,0],[652,17,652,23,0],[654,9,654,10,0],[661,9,661,10,1],[663,13,663,14,1],[664,17,664,84,1],[666,13,666,33,0],[667,13,667,14,0],[668,17,668,93,0],[669,17,669,23,0],[671,9,671,10,1],[674,9,674,10,0],[676,13,676,14,0],[677,17,677,109,0],[679,13,679,33,0],[680,13,680,14,0],[681,17,681,93,0],[682,17,682,23,0],[684,9,684,10,0],[687,9,687,10,0],[689,13,689,14,0],[690,17,690,101,0],[692,13,692,33,0],[693,13,693,14,0],[694,17,694,93,0],[695,17,695,23,0],[697,9,697,10,0],[705,9,705,10,1],[706,13,706,78,1],[707,9,707,10,1],[714,9,714,10,0],[716,13,716,14,0],[717,17,717,87,0],[719,13,719,33,0],[720,13,720,14,0],[721,17,721,93,0],[722,17,722,23,0],[724,9,724,10,0],[731,9,731,10,0],[733,13,733,14,0],[734,17,734,88,0],[736,13,736,33,0],[737,13,737,14,0],[738,17,738,93,0],[739,17,739,23,0],[741,9,741,10,0],[749,9,749,10,0],[751,13,751,14,0],[752,17,752,95,0],[754,13,754,33,0],[755,13,755,14,0],[756,17,756,93,0],[757,17,757,23,0],[759,9,759,10,0],[767,9,767,10,0],[769,13,769,14,0],[770,17,770,97,0],[772,13,772,33,0],[773,13,773,14,0],[774,17,774,93,0],[775,17,775,23,0],[777,9,777,10,0],[785,9,785,10,0],[787,13,787,14,0],[788,17,788,88,0],[790,13,790,33,0],[791,13,791,14,0],[792,17,792,93,0],[793,17,793,23,0],[795,9,795,10,0],[806,9,806,10,0],[808,13,808,14,0],[809,17,809,123,0],[811,13,811,33,0],[812,13,812,14,0],[813,17,813,93,0],[814,17,814,23,0],[816,9,816,10,0],[828,9,828,10,0],[830,13,830,14,0],[831,17,831,121,0],[833,13,833,33,0],[834,13,834,14,0],[835,17,835,93,0],[836,17,836,23,0],[838,9,838,10,0],[841,9,841,10,0],[843,13,843,14,0],[844,17,844,85,0],[846,13,846,33,0],[847,13,847,14,0],[848,17,848,93,0],[849,17,849,23,0],[851,9,851,10,0],[854,9,854,10,1],[856,13,856,14,1],[857,17,857,110,1],[859,13,859,33,0],[860,13,860,14,0],[861,17,861,93,0],[862,17,862,23,0],[864,9,864,10,1],[867,9,867,10,0],[868,13,868,107,0],[869,9,869,10,0],[872,9,872,10,0],[873,13,873,103,0],[874,9,874,10,0],[877,9,877,10,1],[878,13,878,80,1],[879,9,879,10,1],[882,9,882,10,0],[883,13,883,92,0],[884,9,884,10,0],[887,9,887,10,0],[888,13,888,100,0],[889,9,889,10,0],[892,9,892,10,0],[893,13,893,105,0],[894,9,894,10,0],[897,9,897,10,0],[899,13,899,14,0],[900,17,900,57,0],[901,17,905,20,0],[907,17,907,113,0],[908,17,908,59,0],[909,17,909,39,0],[910,17,910,18,0],[911,21,911,28,0],[911,30,911,46,0],[911,47,911,49,0],[911,50,911,64,0],[912,21,912,22,0],[913,25,914,97,0],[915,29,915,116,0],[916,21,916,22,0],[917,17,917,18,0],[918,17,918,32,0],[920,13,920,33,0],[921,13,921,14,0],[922,17,922,93,0],[923,17,923,26,0],[925,9,925,10,0],[928,9,928,10,0],[929,13,929,104,0],[930,9,930,10,0],[933,9,933,10,0],[934,13,934,106,0],[935,9,935,10,0],[938,9,938,10,0],[940,13,940,14,0],[941,17,941,106,0],[943,13,943,33,0],[944,13,944,14,0],[945,17,945,93,0],[946,17,946,23,0],[948,9,948,10,0],[951,9,951,10,0],[952,13,952,80,0],[953,17,953,91,0],[955,17,955,102,0],[956,9,956,10,0],[959,9,959,10,1],[960,13,960,43,1],[962,13,962,68,1],[963,13,963,141,1],[963,142,963,143,1],[965,13,965,36,1],[966,13,966,14,1],[967,17,967,49,1],[968,17,968,98,1],[969,17,969,72,1],[970,17,970,18,1],[971,21,971,28,1],[971,30,971,41,1],[971,42,971,44,1],[971,45,971,52,1],[972,21,972,22,1],[973,25,973,83,1],[974,29,974,77,1],[975,21,975,22,1],[976,17,976,18,1],[978,17,978,36,1],[979,17,979,97,1],[980,21,980,111,1],[982,17,982,157,1],[983,13,983,14,1],[985,13,985,31,1],[986,9,986,10,1],[989,9,989,10,1],[990,13,990,78,1],[991,13,991,104,1],[992,9,992,10,1],[995,9,995,10,0],[997,13,997,14,0],[998,17,999,56,0],[1000,17,1000,114,0],[1002,17,1002,24,0],[1002,26,1002,42,0],[1002,43,1002,45,0],[1002,46,1002,60,0],[1003,17,1003,18,0],[1004,21,1004,88,0],[1005,21,1005,28,0],[1005,30,1005,44,0],[1005,45,1005,47,0],[1005,48,1005,65,0],[1006,21,1006,22,0],[1007,25,1007,76,0],[1008,21,1008,22,0],[1010,21,1010,47,0],[1011,17,1011,18,0],[1013,17,1013,40,0],[1015,13,1015,33,0],[1016,13,1016,14,0],[1017,17,1017,93,0],[1018,17,1018,23,0],[1020,9,1020,10,0],[1023,9,1023,10,1],[1024,13,1024,94,1],[1025,13,1025,72,1],[1026,9,1026,10,1],[1029,9,1029,10,1],[1031,13,1031,14,1],[1032,17,1032,52,1],[1033,21,1033,32,1],[1034,17,1035,44,1],[1037,13,1037,33,0],[1038,13,1038,14,0],[1039,17,1039,93,0],[1040,17,1040,23,0],[1042,9,1042,10,1],[1046,9,1046,10,1],[1047,13,1047,59,1],[1048,13,1048,14,0],[1049,17,1049,139,0],[1050,17,1050,50,0],[1051,21,1051,33,0],[1052,13,1052,14,0],[1053,13,1056,53,1],[1058,13,1058,37,1],[1058,38,1058,97,0],[1059,13,1059,20,1],[1059,22,1059,36,1],[1059,37,1059,39,1],[1059,40,1059,48,1],[1060,13,1060,14,1],[1061,17,1061,52,1],[1062,21,1062,96,0],[1063,13,1063,14,1],[1065,13,1065,25,1],[1066,9,1066,10,1],[1069,9,1069,10,0],[1071,13,1071,14,0],[1072,17,1072,76,0],[1073,17,1074,106,0],[1076,13,1076,18,0],[1077,13,1077,14,0],[1078,17,1078,23,0],[1080,9,1080,10,0],[1083,9,1083,10,1],[1084,13,1084,83,1],[1085,13,1085,86,1],[1086,17,1086,77,1],[1088,17,1088,30,0],[1089,9,1089,10,1],[1092,9,1092,10,1],[1093,13,1093,83,1],[1094,13,1094,50,1],[1095,13,1095,35,1],[1096,17,1096,161,1],[1097,13,1097,54,1],[1098,17,1098,89,1],[1099,13,1099,88,1],[1100,17,1100,79,1],[1102,17,1102,30,0],[1103,9,1103,10,1],[1110,21,1110,22,1],[1110,23,1110,47,1],[1110,48,1110,49,1],[1115,21,1115,22,1],[1115,23,1115,34,1],[1115,35,1115,36,1],[1120,21,1120,22,1],[1120,23,1120,51,1],[1120,52,1120,53,1],[1125,9,1125,10,1],[1126,13,1126,85,1],[1127,9,1127,10,1],[1130,9,1130,10,0],[1131,13,1131,102,0],[1133,13,1133,51,0],[1134,17,1134,37,0],[1136,13,1136,33,0],[1137,9,1137,10,0],[1140,9,1140,10,0],[1141,13,1141,97,0],[1143,13,1143,51,0],[1144,17,1144,37,0],[1146,13,1146,33,0],[1147,9,1147,10,0]]);
    </script>
  </body>
</html>