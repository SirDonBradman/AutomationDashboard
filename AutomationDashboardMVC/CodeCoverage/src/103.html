<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Main Modules\Contract Manager\Business Layer\BL\CONTMGTDAC.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Data.Common;
using System.Reflection;
using System.Text;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.ContmgtDTO;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Construction.ContractManager.BusinessLayer.BL;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Microsoft.Practices.EnterpriseLibrary.Data;
using Attribute = Aurigo.AMP3.ContmgtDTO.Attribute;
using Module = Aurigo.AMP3.ContmgtDTO.Module;
using Aurigo.Brix.Construction.ContractManager.BusinessLayer;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Common.Utility;

namespace Aurigo.AMP3.ContractManager.BusinessLayer.DAC
{
    public partial class ContMgtComponent : SingletonManagerBase&lt;ContMgtComponent&gt;
    {
        internal const string CUDCONTRACT = &quot;usp_CONTMGTCUDContract&quot;;
        internal const string CUDCONTRACTITEMS = &quot;usp_CONTMGTCUDContractItems&quot;;
        internal const string CUDCONTRACT_TIME = &quot;usp_CONTMGTCUDContractTime&quot;;
        internal const string CUDCONTRACT_CONTRACTORS = &quot;usp_CONTMGTCUDContractor&quot;;

        internal const string ESTMATEContractExport = &quot;usp_ESTMATEContractExport&quot;;
        internal const string ESTMATEVersion = &quot;USP_ESTMATEVERSION&quot;;
        internal const string ESTMATECopyEstimateItemsToContract = &quot;usp_CORITEMCopyItems&quot;;

        private readonly object lockObj = new object();

        private void SetTimeOut(DbCommand cmd)
        {
            int timeOut = cmd.CommandTimeout;
            if (!String.IsNullOrEmpty(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;]) &amp;&amp;
                Int32.TryParse(ConfigurationManager.AppSettings[&quot;SQLCommandTimeOut&quot;], out timeOut))
                cmd.CommandTimeout = timeOut;
        }

        internal bool IsModuleExistsForContract(int ContractId, string ModuleId)
        {
            lock (lockObj)
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTIsModuleExistsForContract&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ContractId&quot;, DbType.Int32, ContractId);
                    conn.DB.AddInParameter(cmd, &quot;ModuleId&quot;, DbType.String, ModuleId);
                    conn.DB.AddOutParameter(cmd, &quot;IsExists&quot;, DbType.Boolean, 3);
                    conn.DB.ExecuteScalar(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;IsExists&quot;).ToString().ToBoolean2();
                }
            }
        }

        internal DataTable GetPendingApprovals(int days, string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_CONTMGTPENDINGAPPROVAL&quot;);
                conn.DB.AddInParameter(cmd, &quot;@DAYS&quot;, DbType.Int32, days);
                conn.DB.AddInParameter(cmd, &quot;@COMPANY&quot;, DbType.String, string.IsNullOrEmpty(axCompany) ? null : axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetPendingApprovalsForPW(int days, string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_CONTMGTPENDINGAPPROVALFORPW&quot;);
                conn.DB.AddInParameter(cmd, &quot;@DAYS&quot;, DbType.Int32, days);
                conn.DB.AddInParameter(cmd, &quot;@COMPANY&quot;, DbType.String, string.IsNullOrEmpty(axCompany) ? null : axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetContByCompletionPercent(string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;Usp_CONTMGTGetContByCompltn&quot;);
                conn.DB.AddInParameter(cmd, &quot;@COMPANY&quot;, DbType.String, string.IsNullOrEmpty(axCompany) ? null : axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetDWRListByDate(DateTime fromDate, DateTime toDate, int contractID, int userID,
                                            object startRowIdx, object maxRows, string sortOrder)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetDWRList&quot;);

                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                {
                    conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                }
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                {
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                }
                else
                {
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, DBNull.Value);
                }

                conn.DB.AddInParameter(cmd, &quot;dtFrom&quot;, DbType.String, fromDate.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;dtTo&quot;, DbType.String, toDate.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;userID&quot;, DbType.Int32, userID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetContractorsForContractList(string contractList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractorsForContractList&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractList&quot;, DbType.String, contractList);
                return conn.DB.ExecuteDataSet(cmd);

            }
        }

        internal DataSet GetSubItemsForContractList(string contractList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetSubItemsForContractList&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractIDList&quot;, DbType.String, contractList);
                return conn.DB.ExecuteDataSet(cmd);

            }
        }

        internal void DeletePrimeContractor(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_CONTMGTDELPRIMECNTRCTOR&quot;);
                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);
                DataSet ds = conn.DB.ExecuteDataSet(cmd);
                if (ds.Tables[0].Rows.Count &gt; 0)
                {
                    throw new Exception(ds.Tables[0].Rows[0][0].ToString());
                }
            }
        }

        internal string GetSigFromDB(int? dprId)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTDWRGetDWRSignature&quot;);
                conn.DB.AddInParameter(cmd, &quot;dwrid&quot;, DbType.Int32, dprId);
                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString();
            }
        }

        internal DataTable GetActiveProjects(string erpCompany)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveProjects&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int CopyContract(int srcContractId, string newContractCode, string newContractName, int projectID,
                                  string copyOption, out int newContractID, string CopyFund = &quot;&quot;, int projectTemplateID = 0)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTCopyContract&quot;);
                SetTimeOut(cmd);
                conn.DB.AddInParameter(cmd, &quot;ID&quot;, DbType.Int32, srcContractId);
                conn.DB.AddInParameter(cmd, &quot;CODE&quot;, DbType.String, newContractCode.Trim());
                conn.DB.AddInParameter(cmd, &quot;NAME&quot;, DbType.String, newContractName.Trim());
                conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.String, projectID);
                conn.DB.AddInParameter(cmd, &quot;COPYOPTION&quot;, DbType.String, copyOption);
                conn.DB.AddInParameter(cmd, &quot;CopyFund&quot;, DbType.String, CopyFund);
                conn.DB.AddInParameter(cmd, &quot;ProjectTemplateID&quot;, DbType.Int32, projectTemplateID);
                conn.DB.AddOutParameter(cmd, &quot;STATUS&quot;, DbType.Int32, 4);
                conn.DB.AddOutParameter(cmd, &quot;NEWCONTRACTID&quot;, DbType.Int32, 4);
                conn.DB.ExecuteNonQuery(cmd);
                newContractID = conn.DB.GetParameterValue(cmd, &quot;NEWCONTRACTID&quot;).ToString().ToInt32_2();
                return conn.DB.GetParameterValue(cmd, &quot;STATUS&quot;).ToString().ToInt32_2();
            }
        }

        internal int GetDWRListByDateCount(DateTime fromDate, DateTime toDate, string contractID, int userID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetDWRList&quot;);

                conn.DB.AddInParameter(cmd, &quot;dtFrom&quot;, DbType.String, fromDate.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;dtTo&quot;, DbType.String, toDate.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID.ToInt32_2());
                conn.DB.AddInParameter(cmd, &quot;userid&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;Y&quot;);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString().ToInt32_2();
            }
        }

        internal DataTable GetDWRByDateRange(DateTime dwrFrom, DateTime dwrTo, int contractID, int userID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTREPDWRBYDATE&quot;);
                conn.DB.AddInParameter(cmd, &quot;@DATEFROM&quot;, DbType.String, dwrFrom.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;@DATETO&quot;, DbType.String, dwrTo.ToUtc());
                conn.DB.AddInParameter(cmd, &quot;@CONTRACTID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;@UID&quot;, DbType.Int32, userID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetMLSSummary(int contractID, DateTime? minDeliveryDate, DateTime? maxDeliveryDate, int? insId,
                                       string type)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var o = new object[5];
                o[0] = contractID;
                if (minDeliveryDate != null)
                    o[1] = minDeliveryDate.ToDateTime_MWCulture().ToUtc();
                if (maxDeliveryDate != null)
                    o[2] = maxDeliveryDate.ToDateTime_MWCulture().ToUtc();

                o[3] = (insId != null) ? insId : -1;

                if (!string.IsNullOrEmpty(type))
                    o[4] = type;

                return conn.DB.ExecuteDataSet(&quot;CONTMDLGetMLSSummary&quot;, o);
            }
        }

        internal int GetContractByCode(int projectID, string code)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_CONTMGTGETCONTRACTBYCODE&quot;);
                conn.DB.AddInParameter(cmd, &quot;ProjectID&quot;, DbType.Int32, projectID);
                conn.DB.AddInParameter(cmd, &quot;Code&quot;, DbType.String, code);
                conn.DB.AddOutParameter(cmd, &quot;ID&quot;, DbType.Int32, 4);

                conn.DB.ExecuteNonQuery(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;ID&quot;).ToInt32_2();
            }
        }

        //internal DataTable GetContractICADetails(int contractID)
        //{
        //    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetICADelails&quot;, new object[] { contractID, null }, 1);

        //    return conn.DB.ExecuteDataSet(cmd).Tables[0];
        //}

        internal DataSet GetContractForMobile(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractForMobile&quot;, new object[] { contractID });

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal int GetProjectIdOfContract(int contractID)
        {
            int pId = -1;

            object objId = Aurigo.AMP3.DataAccess.Core.ComponentHelper.Instance.ExecuteScalar(&quot;select ProjectID from ContmgtMaster where id = {0}&quot;, contractID);
            if (objId != null) int.TryParse(objId.ToString(), out pId);
            return pId;
        }

        internal DataSet GetItemDimensionForMobile(string ContractIDList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemDimensionsForMobile&quot;,
                                                        new object[] { ContractIDList, null }, 1);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataSet GetItemsResourceMainForMobile(string ContractIDList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemsResourceMainForMobile&quot;,
                                                        new object[] { ContractIDList, null }, 1);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataSet GetItemsResourceDetailsForMobile(string ContractIDList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemsResourceDetailsForMobile&quot;,
                                                        new object[] { ContractIDList, null }, 1);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataSet GetContainersForMobile(string ContractIDList)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContainersForMobile&quot;, new object[] { ContractIDList });
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataTable GetPSContractors(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetPSCONTRACTORS&quot;);
                conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        //TODO: Section + Group MSP Integration
        internal DataSet GetGroupsSections(int contractID, int moduleID, bool? isSectionOrGroup, bool? isDeleted)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetGroupsSections&quot;);

                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;moduleId&quot;, DbType.Int32, moduleID);

                if (isSectionOrGroup.HasValue)
                    conn.DB.AddInParameter(cmd, &quot;flag&quot;, DbType.Boolean, isSectionOrGroup);

                if (isDeleted.HasValue)
                {
                    if (isDeleted.GetValueOrDefault())
                        conn.DB.AddInParameter(cmd, &quot;isDeleted&quot;, DbType.String, &quot;Y&quot;);
                    else
                        conn.DB.AddInParameter(cmd, &quot;isDeleted&quot;, DbType.String, &quot;N&quot;);
                }
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        // change the case of the variable declared
        internal int SaveContractTermsAndConditions(ContTermCondDTO contTermDTO)
        {
            bool isLatest = true;
            int retVal = 0;
            var dictionary = new Dictionary&lt;string, object&gt;();
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    ContractManagerStoredProcedure.usp_CONTMGTCUDTermsAndConditions, dictionary,
                    contTermDTO.ContractualTermID, contTermDTO.Name, contTermDTO.TermsNo, contTermDTO.ContractDate,
                    contTermDTO.ContractID, contTermDTO.Description, contTermDTO.Notes, contTermDTO.Status,
                    contTermDTO.xmlPrepaymentItemList, contTermDTO.xmlGeneralDetails, contTermDTO.xmlRetentionItemList,
                    contTermDTO.Mode, contTermDTO.IsVersion, isLatest, contTermDTO.CreatedBy, contTermDTO.CreatedOn);

                retVal = dictionary[&quot;OUTPUT&quot;].ToString().ToInt32_2();
            }
            return retVal;
        }

        internal DataSet GetRecoveryRetentionDetails(string moduleID, int instanceID)
        {
            lock (lockObj)
            {
                return
                    ComponentHelper.Instance.ExecuteDataSet(
                        ContractManagerStoredProcedure.usp_CONTMGTGetRecoveryRetentionDetails, null, moduleID,
                        instanceID);
            }
        }

        internal ContTermCondDTO GetContractTermDetails(int contTermID)
        {
            DataSet result;
            lock (lockObj)
            {
                result =
                    ComponentHelper.Instance.ExecuteDataSet(
                        ContractManagerStoredProcedure.usp_CONTMGTGetContTermDetails, null, contTermID);

                if (result.Tables[0].Rows.Count &lt; 1)
                    return null;

                DataRow dr = result.Tables[0].Rows[0];
                var ContTermDTO = new ContTermCondDTO();
                ContTermDTO.ContractualTermID = contTermID;
                ContTermDTO.Description = dr[&quot;Description&quot;].ToString();
                ContTermDTO.Name = dr[&quot;Name&quot;].ToString();
                ContTermDTO.Notes = dr[&quot;Notes&quot;].ToString();
                ContTermDTO.Status = dr[&quot;Status&quot;].ToString().ToInt32_2();
                ContTermDTO.VersionNo = dr[&quot;VersionNo&quot;].ToString().ToInt32_2();
                ContTermDTO.ContractID = dr[&quot;ContractID&quot;].ToString().ToInt32_2();
                ContTermDTO.ContractAmt = dr[&quot;CurContAmt&quot;].ToString().ToDecimal2();
                ContTermDTO.CreatedOn = dr[&quot;CreatedOn&quot;].ToString().ToDateTime_MWCulture();
                ContTermDTO.CreatedBy = dr[&quot;CreatedBy&quot;].ToString().ToInt32_2();
                ContTermDTO.CreatedByName = dr[&quot;CreatedByName&quot;].ToString();
                ContTermDTO.ContractDate = dr[&quot;ContractDate&quot;].ToString().ToDateTime_MWCulture();
                ContTermDTO.TermsNo = dr[&quot;TermsNo&quot;].ToString().ToInt32_2();
                if (ContTermDTO.Status &gt; 2)
                {
                    ContTermDTO.ApprovedOn = dr[&quot;ApprovedOn&quot;].ToString().ToDateTime_MWCulture();
                    ContTermDTO.ApprovedBy =
                        (string.IsNullOrEmpty(dr[&quot;ApprovedBy&quot;].ToString()) ? &quot;0&quot; : dr[&quot;ApprovedBy&quot;].ToString()).
                            ToInt32_2();
                    ContTermDTO.ApprovedByName = dr[&quot;ApprovedByName&quot;].ToString();
                }
                return ContTermDTO;
            }
        }

        internal DataSet GetPrepaymentRecoveryRules(string moduleID, int instanceID)
        {
            lock (lockObj)
            {
                return
                    ComponentHelper.Instance.ExecuteDataSet(
                        ContractManagerStoredProcedure.usp_CONTMGTGetPrepayRetentionRules, null, &quot;PREPAY&quot;, moduleID,
                        instanceID, &quot;P&quot;);
            }
        }

        internal DataSet GetRetentionRules(string moduleID, int instanceID)
        {
            lock (lockObj)
            {
                return
                    ComponentHelper.Instance.ExecuteDataSet(
                        ContractManagerStoredProcedure.usp_CONTMGTGetPrepayRetentionRules, null, &quot;RETENTION&quot;, moduleID,
                        instanceID, &quot;P&quot;);
            }
        }

        internal int UpdateTermsAndConditions(int contTermID, string operation, int? approvedBy, DateTime? approvedOn)
        {
            lock (lockObj)
            {
                var dictionary = new Dictionary&lt;string, object&gt;();
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTUpdateTermsAndConditions, dictionary, contTermID,
                    operation, approvedBy, approvedOn);
                return dictionary[&quot;Result&quot;].ToString().ToInt32_2();
            }
        }

        internal int ValidateUpdateTermsAndConditions(int contTermID, string operation, int? approvedBy, DateTime? approvedOn)
        {
            lock (lockObj)
            {
                var dictionary = new Dictionary&lt;string, object&gt;();
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTValidateUpdateTermsAndConditions, dictionary, contTermID,
                    operation, approvedBy, approvedOn);
                return dictionary[&quot;Result&quot;].ToString().ToInt32_2();
            }
        }

        #region &quot;Item Posting Reports&quot;

        internal DataTable GetItmPostingsByGroup(int grpID, int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetPostingsByContractors &quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;grpID&quot;, DbType.Int32, grpID);
                conn.DB.AddInParameter(cmd, &quot;rptType&quot;, DbType.String, &quot;G&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        #endregion

        #region &quot;Importing Awarded Bid Items From Estimate&quot;

        internal DataTable GetEstimates(int? ProjectID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(ESTMATEContractExport);

                conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, ProjectID);
                conn.DB.AddInParameter(cmd, &quot;GETESTIMATES&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, 0);
                conn.DB.AddInParameter(cmd, &quot;GETBIDDERS&quot;, DbType.String, &quot;N&quot;);
                conn.DB.AddInParameter(cmd, &quot;GETBIDITEMS&quot;, DbType.String, &quot;N&quot;);
                conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, 0);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetEstimateBidders(int? ProjectID, int? ProjectEstimateID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(ESTMATEContractExport);

                conn.DB.AddInParameter(cmd, &quot;PROJECTID&quot;, DbType.Int32, ProjectID);
                conn.DB.AddInParameter(cmd, &quot;GETESTIMATES&quot;, DbType.String, &quot;N&quot;);
                conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, ProjectEstimateID);
                conn.DB.AddInParameter(cmd, &quot;GETBIDDERS&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddInParameter(cmd, &quot;GETBIDITEMS&quot;, DbType.String, &quot;N&quot;);
                conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, 0);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetVersions(int projectEstimateID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(ESTMATEVersion);
                conn.DB.AddInParameter(cmd, &quot;PROJECTESTIMATEID&quot;, DbType.Int32, projectEstimateID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal int CopyEstimateItemstoContract(int projectEstimateID, int bidID, int contractID, string sourceModuleID,
                                                 string destinationModuleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(ESTMATECopyEstimateItemsToContract);
                SetTimeOut(cmd);
                conn.DB.AddInParameter(cmd, &quot;SRCMODULEID&quot;, DbType.String, sourceModuleID);
                conn.DB.AddInParameter(cmd, &quot;DESMODULEID&quot;, DbType.String, destinationModuleID);
                conn.DB.AddInParameter(cmd, &quot;SRCPARENTINSTANCEID&quot;, DbType.Int32, projectEstimateID);
                conn.DB.AddInParameter(cmd, &quot;DESPARENTINSTANCEID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;FROMAWARDEDITEMS&quot;, DbType.String, &quot;Y&quot;);
                conn.DB.AddInParameter(cmd, &quot;BIDID&quot;, DbType.Int32, bidID);
                conn.DB.AddOutParameter(cmd, &quot;ERROR&quot;, DbType.Int32, 4);

                conn.DB.ExecuteNonQuery(cmd);
                return conn.DB.GetParameterValue(cmd, &quot;ERROR&quot;).ToString().ToInt32_2();
            }
        }

        #endregion

        #region &quot;Contract Settings&quot;

        internal int CUDAttributes(int? attribID, int? projectID, string name, string type, int? catalogID,
                                   Operations op)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTCUDAttributes&quot;);

                switch (op)
                {
                    case Operations.Create:
                        conn.DB.AddInParameter(cmd, &quot;ProjectID&quot;, DbType.Int32, projectID);
                        conn.DB.AddInParameter(cmd, &quot;Name&quot;, DbType.String, name);
                        conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.String, type);
                        if (catalogID.HasValue)
                            conn.DB.AddInParameter(cmd, &quot;CatalogID&quot;, DbType.Int32, catalogID);
                        conn.DB.AddInParameter(cmd, &quot;Opn&quot;, DbType.String, &quot;C&quot;);
                        break;
                    case Operations.Destroy:
                        conn.DB.AddInParameter(cmd, &quot;ID&quot;, DbType.Int32, attribID);
                        conn.DB.AddInParameter(cmd, &quot;Opn&quot;, DbType.String, &quot;HD&quot;);
                        break;
                }

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToInt32_2();
            }
        }

        internal int CUDStatus(object param1, Operations op)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTCUDStatus&quot;);

                switch (op)
                {
                    case Operations.Create:
                        conn.DB.AddInParameter(cmd, &quot;Name&quot;, DbType.String, param1.ToString());
                        conn.DB.AddInParameter(cmd, &quot;Opn&quot;, DbType.String, &quot;C&quot;);
                        break;
                    case Operations.Destroy:
                        conn.DB.AddInParameter(cmd, &quot;ID&quot;, DbType.Int32, param1.ToInt32_2());
                        conn.DB.AddInParameter(cmd, &quot;Opn&quot;, DbType.String, &quot;HD&quot;);
                        break;
                }

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToInt32_2();
            }
        }

        internal DataTable GetStatus(int? contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetStatus&quot;);

                if (contractID.HasValue)
                    conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, contractID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetAttributes()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetAttributes&quot;);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetMeasSys(string strAdditionalInfo, int? measSysID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX,
                                       new EISAdditionalInfo(RegisteredEIS.AX).AddInfo(Constants.EIS_ADDITIONAL_INFO,
                                                                                       strAdditionalInfo));
                var connectorParameter = new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(),
                                                                 AMP3ObjectType.Unknown, null, null);
                int count = 0;
                DataSet ds = new BrixDataSet();
                if (IntegrationConnectorManager.HandleIntegration(connectorParameter, ref count, ref ds, true))
                {
                    if (measSysID == null)
                    {
                        return ds.Tables[0];
                    }
                    else
                        return ds.Tables[1];
                }
                else
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetMeasureSys&quot;);

                    if (measSysID.HasValue)
                        conn.DB.AddInParameter(cmd, &quot;MeasSysID&quot;, DbType.Int32, measSysID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
        }

        internal DataTable GetContractSettings(int projID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractSettings&quot;);

                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetRFISettings(int contractId)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTRFIGetRFISettings&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractId&quot;, DbType.Int32, contractId);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        // Modified for RAB Setting load
        internal DataSet GetPESettings(int contractId, string ModuleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTPEGetPEBasicSettings&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractId&quot;, DbType.Int32, contractId);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, ModuleID);
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal bool ValidateContermOnPE(int contractId, decimal ceilingValue)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ValidateCotermOnPE&quot;);

                conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, contractId);
                conn.DB.AddInParameter(cmd, &quot;CeilingPercentage&quot;, DbType.Decimal, ceilingValue);

                conn.DB.AddOutParameter(cmd, &quot;IsValid&quot;, DbType.Boolean, 1);

                conn.DB.ExecuteScalar(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;IsValid&quot;).ToBoolean2();
            }
        }

        internal void SaveLineNoSettings(int contID, string prefix, int? start, int? incr, string sep)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTSaveLineNoSettings&quot;);

                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contID);
                if (!string.IsNullOrEmpty(prefix))
                    conn.DB.AddInParameter(cmd, &quot;prefix&quot;, DbType.String, prefix);
                if (!string.IsNullOrEmpty(sep))
                    conn.DB.AddInParameter(cmd, &quot;seperator&quot;, DbType.String, sep);
                if (start.HasValue)
                    conn.DB.AddInParameter(cmd, &quot;LineStart&quot;, DbType.Int32, start);
                if (incr.HasValue)
                    conn.DB.AddInParameter(cmd, &quot;incrmnt&quot;, DbType.Int32, incr);

                conn.DB.ExecuteNonQuery(cmd);
            }
        }

        internal void DeleteLineNoSetting(int settingID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_CONTMGTDELLINENOSETTING&quot;);

                conn.DB.AddInParameter(cmd, &quot;settingID&quot;, DbType.Int32, settingID);

                conn.DB.ExecuteNonQuery(cmd);
            }
        }

        internal void SaveSettings(int contID, string xmlSrc)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTSaveOwnerDetails&quot;, new object[] { contID, xmlSrc });

                ///conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contID);
                //conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.String, xmlSrc);

                conn.DB.ExecuteScalar(cmd);
            }
        }

        internal void SaveModuleSettingsData(int contID, string xmlSrc)
        {
            lock (lockObj)
            {
                ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTSaveModuleSettings,
                                                       null, contID, xmlSrc);
            }
        }

        internal string SaveRFISettings(int contId, int itemSource, int rfiItems, bool isReqForPosting)
        {
            lock (lockObj)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTRFICURFISettings, dic,
                                                       contId, itemSource, rfiItems, isReqForPosting);
                return dic[&quot;Result&quot;].ToString();
            }
        }

        internal string SavePEBasicSettings(string xmlPrepayrules, string xmlPrepayruleItems, string xmlRetRulesint,
                                            int contId, int primeContrSource, int subContrSource, int primeContItems,
                                            int subContrItems, bool validateRABContractQty, bool validateRABWOQty, decimal excessPayAmtPercentage,
                                            string moduleID, out bool IsSuccess)
        {
            lock (lockObj)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTPECUPEBasicSettings,
                                                       dic, xmlPrepayrules, xmlPrepayruleItems, xmlRetRulesint, contId,
                                                       primeContrSource, subContrSource, primeContItems, subContrItems,
                                                       validateRABContractQty, validateRABWOQty, excessPayAmtPercentage, moduleID);
                IsSuccess = (bool)dic[&quot;IsSuccess&quot;];
                return dic[&quot;Result&quot;].ToString();

            }
        }




        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;pid&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;contractId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;isAlloPostBeyondContractQuantity&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;hintId_optional&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;id of the settings record (new id if new record created. else old id)&lt;/returns&gt;
        internal int SaveDWRSettings(int pid, int contractId, bool isAllowPostBeyondContractQuantity, out int errorCode, out string errorData, int? hintId_optional = null)
        {
            errorCode = 0;
            errorData = string.Empty;

            var dic = new Dictionary&lt;string, object&gt;();
            dic.Add(&quot;HINT_ID&quot;, hintId_optional);
            dic.Add(&quot;ErrorCode&quot;, 0);
            dic.Add(&quot;RecordsHavingError&quot;, string.Empty);

            ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTCRUDDWRSettings, dic,
                                                  &#39;S&#39;, //Action = Save
                                                  pid, contractId, isAllowPostBeyondContractQuantity, hintId_optional);

            //if (dic.ContainsKey(&quot;ErrorCode&quot;))
            errorCode = dic[&quot;ErrorCode&quot;].ToInt32_2();

            //if (dic.ContainsKey(&quot;RecordsHavingError&quot;))
            errorData = dic[&quot;RecordsHavingError&quot;].ToString();

            return dic[&quot;HINT_ID&quot;].ToInt32_2();
        }

        internal DataTable GetDWRSettings(int pid, int contractId)
        {
            var dic = new Dictionary&lt;string, object&gt;();

            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTCRUDDWRSettings, dic,
                                                  &#39;G&#39;, //Action = Select settings
                                                  pid, contractId, null, null);

            return ds.Tables[0];
        }

        internal void DeleteDWRSettings(int pid, int contractId)
        {
            var dic = new Dictionary&lt;string, object&gt;();

            ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTCRUDDWRSettings, dic,
                                                  &#39;D&#39;, //Action = Select settings
                                                  pid, contractId, null, null);
        }

        internal bool TryValidateDWRWorkflowAction(List&lt;string&gt; dwrIdList, string workflowActionName, out int errorCode, out DataTable errorDataTable)
        {
            errorCode = 0;
            errorDataTable = null;

            var dic = new Dictionary&lt;string, object&gt;();
            dic.Add(&quot;ErrorCode&quot;, 0);

            string dwrIdList_CSV = string.Join(&quot;,&quot;, dwrIdList);
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTDWRValidateDWR, dic, dwrIdList_CSV, workflowActionName);

            errorCode = dic[&quot;ErrorCode&quot;].ToInt32_2();

            if (errorCode != 0 &amp;&amp; ds.Tables.Count &gt; 0)
                errorDataTable = ds.Tables[0];

            return errorCode == 0; //if errorCode is zero then no error
        }


        internal DataTable GetOwnerDetails(int contID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetOwnerDetails&quot;);

                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal void SaveOwnerSettings(int contID, string xmlSrc)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTSaveOwnerDetails&quot;, new object[] { contID, xmlSrc });

                ///conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contID);
                //conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.String, xmlSrc);

                conn.DB.ExecuteScalar(cmd);
            }
        }

        #endregion

        #region &quot;CUD Contract&quot;

        private readonly object lockCon = new object();
        private readonly object lockStdItem = new object();
        private object lockConCont = new object();
        private object lockConTime = new object();

        internal int CUDContract(StringBuilder srcXML)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(CUDCONTRACT);
                SetTimeOut(cmd);
                conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.Xml, srcXML.ToString());
                conn.DB.AddOutParameter(cmd, &quot;newId&quot;, DbType.Int32, 4);

                DataSet ds = conn.DB.ExecuteDataSet(cmd);

                if (ds == null || ds.Tables.Count == 0)
                    throw new Exception(&quot;dataset null&quot;);
                if (ds.Tables[ds.Tables.Count - 1].Rows.Count &gt; 0)
                {
                    string exception = ds.Tables[ds.Tables.Count - 1].Rows[0][0].ToString();
                    exception = exception.Replace(exception,
                                                      LocalizationManager.GetString(exception));//If we put exception message in localization resource file then it will replace full message
                    if (exception.Contains(&quot;LOC_Contract&quot;))
                    {
                        exception = exception.Replace(&quot;LOC_Contract&quot;,
                                                      LocalizationManager.GetString(&quot;Contract&quot;));
                        if (exception.Contains(&quot;Quantity Plannings&quot;))
                        {
                            exception = exception.Replace(&quot;Quantity Plannings&quot;,
                                                    LocalizationManager.GetString(&quot;LOC_QuantityPlanning&quot;));
                        }
                    }
                    if (exception.Contains(&quot;LOC_contract&quot;))
                    {
                        exception = exception.Replace(&quot;LOC_contract&quot;,
                                                      LocalizationManager.GetString(&quot;Contract&quot;).ToLower2());
                    }
                    if (exception.Contains(&quot;LOC_Contracts&quot;))
                    {
                        exception = exception.Replace(&quot;LOC_Contracts&quot;,
                                                      LocalizationManager.GetString(&quot;Contract&quot;) + &quot;s&quot;);
                    }
                    if (exception.Contains(&quot;Items&quot;))
                    {
                        exception = exception.Replace(&quot;Items&quot;,
                                                      LocalizationManager.GetString(KeyConstants.LOC_ITEM_ABBR) + &quot;s&quot;);
                    }
                    if (exception.Contains(&quot;Pay Estimates&quot;))
                    {
                        exception = exception.Replace(&quot;Pay Estimates&quot;,
                                                      LocalizationManager.GetString(KeyConstants.LOC_PAY_ESTIMATES));
                    }
                    throw new Exception(exception);
                }
                return conn.DB.GetParameterValue(cmd, &quot;newId&quot;).ToInt32_2();
            }
        }

        internal int ValidateContractStartDateWithNoticeToProceedDateContract(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTValidateContractDates&quot;);
                SetTimeOut(cmd);
                conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);
                conn.DB.AddOutParameter(cmd, &quot;OutputStatus&quot;, DbType.Int32, 4);

                conn.DB.ExecuteDataSet(cmd);

                return conn.DB.GetParameterValue(cmd, &quot;OutputStatus&quot;).ToInt32_2();
            }
        }

        internal void CUDContractTime(StringBuilder srcXML)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(CUDCONTRACT_TIME);

                conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.Xml, srcXML.ToString());

                DataSet ds = new BrixDataSet();

                ds = conn.DB.ExecuteDataSet(cmd);

                if (ds == null || ds.Tables.Count == 0)
                    throw new Exception(&quot;dataset null&quot;);
                if (ds.Tables[0].Rows.Count &gt; 0)
                {
                    throw new Exception(ds.Tables[0].Rows[0][0].ToString());
                }
            }
        }

        internal void CUDContractContractors(StringBuilder srcXML)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(CUDCONTRACT_CONTRACTORS);

                conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.Xml, srcXML.ToString());

                DataSet ds = new BrixDataSet();

                ds = conn.DB.ExecuteDataSet(cmd);

                if (ds == null || ds.Tables.Count == 0)
                    throw new Exception(&quot;dataset null&quot;);
                if (ds.Tables[0].Rows.Count &gt; 0)
                {
                    throw new Exception(ds.Tables[0].Rows[0][0].ToString());
                }
            }
        }

        #endregion

        #region &quot;Get Contract(s)&quot;

        internal int GetContractsCount(int userID, int roleID, string featuresCode, string moduleID, int projectId, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContracts&quot;);

                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.String, featuresCode);
                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projectId);
                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;Y&quot;);
                if (!string.IsNullOrEmpty(filterSearch))
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);

                DataSet DS = conn.DB.ExecuteDataSet(cmd);
                if (DS != null &amp;&amp; DS.Tables.Count &gt; 0 &amp;&amp; DS.Tables[0].Rows.Count &gt; 0)
                    return DS.Tables[0].Rows[0][0].ToString().ToInt32_2();
                else
                    return 0;
            }
        }

        internal int GetContractsCountWithContractPermissions(int userID, int roleID, string featuresCode, string moduleID, int projectId, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractsWithContractPermissions&quot;);

                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.String, featuresCode);
                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projectId);
                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;Y&quot;);
                if (!string.IsNullOrEmpty(filterSearch))
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);

                DataSet DS = conn.DB.ExecuteDataSet(cmd);
                if (DS != null &amp;&amp; DS.Tables.Count &gt; 0 &amp;&amp; DS.Tables[0].Rows.Count &gt; 0)
                    return DS.Tables[0].Rows[0][0].ToString().ToInt32_2();
                else
                    return 0;
            }
        }

        internal DataTable GetContracts(int userID, int roleID, string featuresCode, string moduleID, int projectId,
                                        object startRowIdx, object maxRows, string sortOrder, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContracts&quot;);

                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.String, featuresCode);
                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projectId);

                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
                if (!string.IsNullOrEmpty(filterSearch))
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);
                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;N&quot;);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataTable GetContractsWithContractPermissions(int userID, int roleID, string featuresCode, string moduleID, int projectId,
                                        object startRowIdx, object maxRows, string sortOrder, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractsWithContractPermissions&quot;);

                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.String, featuresCode);
                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projectId);

                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                if (sortOrder != null)
                    conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
                if (!string.IsNullOrEmpty(filterSearch))
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);
                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;N&quot;);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal ContmgtDTO.DTO GetContract(int contractID, FetchSet fs)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var dto = new ContmgtDTO.DTO();

                var doc = new XmlDocument();
                var str = new StringBuilder();
                DataTable dt;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContracts&quot;);

                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);

                dt = conn.DB.ExecuteDataSet(cmd).Tables[0];

                str.Append(&quot;&lt;XMLROOT&gt;&quot;);

                foreach (DataRow dr in dt.Rows)
                {
                    str.Append(dr[0]);
                }
                str.Append(&quot;&lt;/XMLROOT&gt;&quot;);

                doc.LoadXml(str.ToString());

                XmlNodeList list = doc.SelectSingleNode(&quot;//XMLROOT/Contracts/IDs&quot;).ChildNodes;
                for (int i = 0; i &lt; list.Count; i++)
                {
                    dto.IDs.Add(list[i].Attributes[&quot;value&quot;].Value.ToInt32_2());
                }

                dto.Locked = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/Locked&quot;));
                dto.IsDeleted = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/IsDeleted&quot;));

                if ((fs &amp; FetchSet.All) == FetchSet.All ||
                    (fs &amp; FetchSet.Details) == FetchSet.Details)
                {
                    dto.Name = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/Name&quot;));

                    dto.Code = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/Code&quot;));

                    dto.ClosureDt = GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/ClosureDt&quot;));

                    dto.StartDt = GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/StartDt&quot;));

                    dto.Desc = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/Desc&quot;));

                    dto.MeasSysID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/MeasSysID&quot;));

                    dto.StatusID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/StatusID&quot;));

                    dto.CreatedOn = GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CreatedOn&quot;));

                    dto.DocTemplateID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/TemplateID&quot;));

                    //dto.Active = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/IsActive&quot;));

                    if (!GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/GroupType&quot;)))
                        dto.GroupType = GenericFunctions.ToChar(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/GroupType&quot;));
                    dto.EarlyCompletionBonus =
                        GenericFunctions.ToDecimal(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/EarlyCompletionBonus&quot;));
                    dto.AreaOffice = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/AreaOffice&quot;));
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All ||
                    (fs &amp; FetchSet.KeyContacts) == FetchSet.KeyContacts)
                {
                    dto.KeyContacts.ResidentEngineer =
                        GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/ResidentEngg&quot;));
                    dto.KeyContacts.ProjectEngineer =
                        GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/ProjectEngg&quot;));
                    dto.KeyContacts.ContractAdministrator =
                        GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/ContAdmin&quot;));
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All ||
                    (fs &amp; FetchSet.KeyDates) == FetchSet.KeyDates)
                {
                    dto.KeyDates.ConstructionStartedDate =
                        GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CSD&quot;));
                    dto.KeyDates.ContractClosedDate =
                        GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CCD&quot;));
                    dto.KeyDates.ContractWorkCompleteDate =
                        GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CWD&quot;));
                    dto.KeyDates.NoticeToProceedDate =
                        GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/NPD&quot;));
                    dto.KeyDates.OpenToTrafficDate =
                        GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/OTD&quot;));
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All
                    || (fs &amp; FetchSet.Modules) == FetchSet.Modules)
                {
                    list = doc.SelectNodes(&quot;//XMLROOT/Contracts/Modules/Module&quot;);

                    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                    {
                        var mod = new Module();

                        mod.Key = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Key&quot;));

                        mod.ModID = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;ID&quot;));

                        dto.Modules.Add(mod);
                    }
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All
                    || (fs &amp; FetchSet.Attributes) == FetchSet.Attributes)
                {
                    list = doc.SelectNodes(&quot;//XMLROOT/Contracts/Attributes/Attribute&quot;);

                    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                    {
                        var att = new Attribute();

                        att.ID = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;ID&quot;));

                        att.Name = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Name&quot;));

                        att.Type = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Type&quot;));

                        att.Values = new List&lt;string&gt;();

                        XmlNodeList valuesList =
                            doc.SelectNodes(&quot;//XMLROOT/Contracts/AttribValues/AttribValue[@ID=&#39;&quot; + att.ID + &quot;&#39;]&quot;);

                        for (int n = 0; n &lt; valuesList.Count; n++)
                        {
                            att.Values.Add(valuesList[n].SelectSingleNode(&quot;Text&quot;).InnerText);
                        }

                        dto.Attributes.Add(att);
                    }
                }

                //if ((fs &amp; FetchSet.All) == FetchSet.All
                //    || (fs &amp; FetchSet.Sections) == FetchSet.Sections)
                //{
                //    list = doc.SelectNodes(&quot;//XMLROOT/Contracts/Sections/Section&quot;);

                //    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                //    {
                //        Section sec = new Section();

                //        sec.ID = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;ID&quot;));

                //        sec.Name = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Name&quot;));

                //        sec.Desc = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Desc&quot;));

                //        sec.OrderID = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;OrderID&quot;));

                //        dto.Sections.Add(sec);
                //    }
                //}

                if ((fs &amp; FetchSet.All) == FetchSet.All
                    || (fs &amp; FetchSet.Groups) == FetchSet.Groups)
                {
                    list = doc.SelectNodes(&quot;//XMLROOT/Contracts/Groups/Group&quot;);

                    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                    {
                        var gp = new Group();

                        gp.ID = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;ID&quot;));

                        gp.Name = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Name&quot;));

                        gp.Desc = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Desc&quot;));

                        gp.OTPPercentage = GenericFunctions.ToDecimal(list[i].SelectSingleNode(&quot;OTPPercentage&quot;));

                        gp.Discount = GenericFunctions.ToDecimal(list[i].SelectSingleNode(&quot;Discount&quot;));

                        dto.Groups.Add(gp);
                    }
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All
                    || (fs &amp; FetchSet.Time) == FetchSet.Time)
                {
                    dto.TimeType = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/TimeType&quot;));

                    dto.BeginDt = GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/BeginDt&quot;));

                    dto.CompletionDt = GenericFunctions.ToDateTime(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CompletionDt&quot;));

                    dto.Days = GenericFunctions.ToDecimal(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/Days&quot;));

                    dto.CalendarID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/CalendarID&quot;));
                }

                if ((fs &amp; FetchSet.All) == FetchSet.All
                    || (fs &amp; FetchSet.Contractors) == FetchSet.Contractors)
                {
                    dto.PC.recordID = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/ID&quot;));

                    dto.PC.ID = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Code&quot;)); // filter key for sub contractors Picker, prime contractor can&#39;t be selecte as sub 

                    dto.PC.CID = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/ID&quot;));

                    dto.PC.Address = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Address&quot;));

                    dto.PC.Company = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Company&quot;));

                    dto.PC.Contact = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Contact&quot;));

                    dto.PC.Email = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Email&quot;));

                    dto.PC.Fax = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Fax&quot;));

                    dto.PC.Phone = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Phone&quot;));

                    dto.PC.Address2 = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Address2&quot;));

                    dto.PC.Address3 = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/Address3&quot;));

                    dto.PC.City = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/City&quot;));

                    dto.PC.ZipCode = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/ZipCode&quot;));

                    dto.PC.State = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Contracts/PC/State&quot;));

                    list = doc.SelectNodes(&quot;//XMLROOT/Contracts/PC/SC&quot;);

                    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                    {
                        var sc = new Contractors();

                        //sc.recordID = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;ID&quot;));

                        sc.ID = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;SID&quot;));

                        sc.CID = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;ID&quot;));

                        sc.Address = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Address&quot;));

                        sc.Company = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Company&quot;));

                        sc.Contact = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Contact&quot;));

                        sc.Email = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Email&quot;));

                        sc.Fax = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Fax&quot;));

                        sc.Phone = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Phone&quot;));

                        sc.Address2 = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Address2&quot;));

                        sc.Address3 = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Address3&quot;));

                        sc.City = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;City&quot;));

                        sc.State = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;State&quot;));

                        sc.ZipCode = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;ZipCode&quot;));

                        dto.SC.Add(sc);
                    }
                }

                return dto;
            }
        }

        internal object GetPIDFromContractId(int id)
        {
            return ComponentHelper.Instance.ExecuteScalar(
                       ContractManagerStoredProcedure.usp_CONTMGTGetPIDFromContractId, null, id);
        }

        internal int GetContractIDByPID(int PID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractIDByPID&quot;);
                conn.DB.AddInParameter(cmd, &quot;PID&quot;, DbType.Int32, PID);
                return Convert.ToInt32(conn.DB.ExecuteScalar(cmd));
            }
        }

        internal DataTable GetContractNames(int projID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractNames&quot;);

                conn.DB.AddInParameter(cmd, &quot;projID&quot;, DbType.Int32, projID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetPrepaymentRuleNames(string type, string moduleID, int instanceID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetPrepayRetentionRules&quot;);

                conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.String, type);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);
                conn.DB.AddInParameter(cmd, &quot;InstanceID&quot;, DbType.Int32, instanceID);
                conn.DB.AddInParameter(cmd, &quot;ControctorType&quot;, DbType.String, &quot;P&quot;);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        //Jagan-
        internal bool GetLockStatus(int contractID)
        {
            return GetLockAndSubmitStatus(contractID).Item1;

        }

        internal bool GetSubmitStatus(int contractID)
        {
            return GetLockAndSubmitStatus(contractID).Item2;
        }

        internal Tuple&lt;bool, bool&gt; GetLockAndSubmitStatus(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetLockStatus&quot;);

                conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, contractID);

                conn.DB.AddOutParameter(cmd, &quot;LockStatus&quot;, DbType.Boolean, 1);
                conn.DB.AddOutParameter(cmd, &quot;SubmitStatus&quot;, DbType.Boolean, 1);

                conn.DB.ExecuteScalar(cmd);

                return new Tuple&lt;bool, bool&gt;(conn.DB.GetParameterValue(cmd, &quot;LockStatus&quot;).ToBoolean2(), conn.DB.GetParameterValue(cmd, &quot;SubmitStatus&quot;).ToBoolean2());
            }
        }

        internal List&lt;string&gt; GetContractModulesForaRole(int contractId, int roleId, string featureCode)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var ModuleList = new List&lt;string&gt;();

                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetContractModulesForaRole, null, contractId, roleId, featureCode);
                if (ds.Tables.Count &gt; 0 &amp;&amp; ds.Tables[0].Rows.Count &gt; 0)
                    foreach (DataRow row in ds.Tables[0].Rows)
                        ModuleList.Add(row[&quot;ModuleID&quot;].ToString());

                return ModuleList;
            }


        }
        #endregion

        #region &quot;Templates&quot;

        //internal int CreateTemplate(Template templateDTO)
        //{

        //    lock (lockObj)
        //    {
        //        DataTable templateAttributes = templateDTO.TemplateAttributes;
        //        List&lt;Platform&gt; templateModules = templateDTO.TemplateModules;

        //        int TemplateId;

        //        DbConnection conn = conn.DB.CreateConnection();
        //        conn.Open();
        //        DbTransaction tran = conn.BeginTransaction();

        //        try
        //        {
        //            DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTCreateTemplate&quot;);

        //            conn.DB.AddInParameter(cmd, &quot;TemplateName&quot;, DbType.String, templateDTO.Name);
        //            conn.DB.AddInParameter(cmd, &quot;CreatedBy&quot;, DbType.String, templateDTO.CreatedBy);
        //            conn.DB.AddOutParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, 4);

        //            conn.DB.ExecuteNonQuery(cmd, tran);

        //            TemplateId = BrixDatatypeHelper.ToInt32_2(conn.DB.GetParameterValue(cmd, &quot;TemplateId&quot;));

        //            if (TemplateId &gt; 0)
        //            {
        //                foreach (DataRow objAttributes in templateAttributes.Rows)
        //                {
        //                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTAddTemplAttrib&quot;);
        //                    conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, TemplateId);
        //                    conn.DB.AddInParameter(cmd, &quot;AttributeId&quot;, DbType.String, objAttributes[&quot;ID&quot;]);
        //                    if (conn.DB.ExecuteNonQuery(cmd, tran) &lt; 0)
        //                        tran.Rollback();
        //                }
        //                for (int j = 0; j &lt; templateModules.Count; j++)
        //                {
        //                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTAddTemplateModules&quot;);
        //                    conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, TemplateId);
        //                    conn.DB.AddInParameter(cmd, &quot;ModuleId&quot;, DbType.String, templateModules[j].ModuleId);
        //                    conn.DB.AddInParameter(cmd, &quot;PlatformKey&quot;, DbType.String, templateModules[j].PlatformKey);
        //                    conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
        //                    conn.DB.ExecuteNonQuery(cmd, tran);

        //                    if (BrixDatatypeHelper.ToInt32_2(conn.DB.GetParameterValue(cmd, &quot;Result&quot;)) &lt; 0)
        //                        tran.Rollback();
        //                }
        //                tran.Commit();
        //            }
        //            else
        //            {
        //                tran.Rollback();
        //            }
        //        }
        //        catch
        //        {
        //            tran.Rollback();
        //            throw;
        //        }
        //        finally
        //        {
        //            conn.Close();
        //            conn.Dispose();
        //        }
        //        return TemplateId;
        //    }
        //}

        //internal int DeleteTemplate(int templateId)
        //{

        //    lock (lockObj)
        //    {
        //        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTDeleteTemplate&quot;);
        //        conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, templateId);
        //        conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
        //        conn.DB.ExecuteNonQuery(cmd);

        //        return BrixDatatypeHelper.ToInt32_2(conn.DB.GetParameterValue(cmd, &quot;Result&quot;).ToString());
        //    }
        //}

        //internal Template GetTemplateDetails(int templateId)
        //{
        //    Template templateDTO = new Template();
        //    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetTemplateDetails&quot;, new object[] { templateId, null, null, null });

        //    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;
        //    List&lt;Platform&gt; templateModules = new List&lt;Platform&gt;();

        //    if (dtColl[0].Rows.Count &gt; 0)
        //    {
        //        if (dtColl[0].Rows != null)
        //        {
        //            DataRow dtRow = dtColl[0].Rows[0];
        //            templateDTO.TempId = BrixDatatypeHelper.ToInt32_2(dtRow[&quot;ContractTemplateId&quot;]);
        //            templateDTO.Name = dtRow[&quot;TemplateName&quot;].ToString();
        //            templateDTO.CreatedBy = dtRow[&quot;CreatedBy&quot;].ToString();
        //        }
        //    }

        //    templateDTO.TemplateAttributes = dtColl[1];

        //    if (dtColl[2].Rows.Count &gt; 0)
        //    {
        //        if (dtColl[2].Rows != null)
        //        {
        //            foreach (DataRow dtSubRow in dtColl[2].Rows)
        //            {
        //                Platform plt = new Platform();
        //                plt.ModuleId = dtSubRow[&quot;ModuleId&quot;].ToString();
        //                plt.PlatformKey = dtSubRow[&quot;PlatformKey&quot;].ToString();
        //                templateModules.Add(plt);
        //            }
        //        }
        //    }
        //    templateDTO.TemplateModules = templateModules;
        //    return templateDTO;
        //}

        //internal DataTable GetTemplates()
        //{
        //    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetTemplates&quot;);

        //    return conn.DB.ExecuteDataSet(cmd).Tables[0];
        //}

        //internal int UpdateTemplate(Template templateDTO)
        //{

        //    lock (lockObj)
        //    {
        //        List&lt;Platform&gt; templateModules = templateDTO.TemplateModules;
        //        DataTable templateAttributes = templateDTO.TemplateAttributes;

        //        int rtnValue = 0;
        //        DbConnection conn = conn.DB.CreateConnection();
        //        conn.Open();
        //        DbTransaction tran = conn.BeginTransaction();

        //        try
        //        {
        //            DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTUpdateTemplate&quot;);

        //            conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.String, templateDTO.TempId);
        //            conn.DB.AddInParameter(cmd, &quot;TemplateName&quot;, DbType.String, templateDTO.Name);
        //            conn.DB.AddInParameter(cmd, &quot;CreatedBy&quot;, DbType.String, templateDTO.CreatedBy);
        //            conn.DB.AddOutParameter(cmd, &quot;retValue&quot;, DbType.Int32, 4);

        //            conn.DB.ExecuteNonQuery(cmd, tran);

        //            rtnValue = BrixDatatypeHelper.ToInt32_2(conn.DB.GetParameterValue(cmd, &quot;retValue&quot;));

        //            if (rtnValue &gt; 0)
        //            {
        //                cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTDelTemplateAttrib&quot;);
        //                conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.String, templateDTO.TempId);
        //                conn.DB.ExecuteNonQuery(cmd, tran);

        //                foreach (DataRow objAttributes in templateAttributes.Rows)
        //                {
        //                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTAddTemplAttrib&quot;);
        //                    conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.String, templateDTO.TempId);
        //                    conn.DB.AddInParameter(cmd, &quot;AttributeId&quot;, DbType.String, objAttributes[&quot;ID&quot;]);
        //                    conn.DB.ExecuteNonQuery(cmd, tran);
        //                }

        //                cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTDelTemplateMod&quot;);
        //                conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.String, templateDTO.TempId);
        //                conn.DB.ExecuteNonQuery(cmd, tran);

        //                for (int j = 0; j &lt; templateModules.Count; j++)
        //                {
        //                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTAddTemplateModules&quot;);
        //                    conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.String, templateDTO.TempId);
        //                    conn.DB.AddInParameter(cmd, &quot;ModuleId&quot;, DbType.String, templateModules[j].ModuleId);
        //                    conn.DB.AddInParameter(cmd, &quot;PlatformKey&quot;, DbType.String, templateModules[j].PlatformKey);
        //                    conn.DB.AddOutParameter(cmd, &quot;Result&quot;, DbType.Int32, 4);
        //                    conn.DB.ExecuteNonQuery(cmd, tran);

        //                    rtnValue = BrixDatatypeHelper.ToInt32_2(conn.DB.GetParameterValue(cmd, &quot;Result&quot;));
        //                }
        //                tran.Commit();
        //            }
        //            else
        //            {
        //                tran.Rollback();
        //                rtnValue = -100; //Error while creating Project
        //            }
        //        }
        //        catch
        //        {
        //            tran.Rollback();
        //        }
        //        finally
        //        {
        //            conn.Close();
        //            conn.Dispose();
        //        }
        //        return rtnValue;
        //    }
        //}

        internal Dictionary&lt;int, string&gt; GetActiveAttributes(int templateId)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var activeattr = new Dictionary&lt;int, string&gt;();
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetActiveAttributes&quot;);

                conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, templateId);

                using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                {
                    while (dr.Read()) //populate dictionary
                        activeattr.Add(dr.GetInt32(0), dr.GetString(1));
                }
                return activeattr;
            }
        }

        internal Dictionary&lt;int, string&gt; GetSavedAttributes(int templateId)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var savedattr = new Dictionary&lt;int, string&gt;();
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetSavedAttributes&quot;);

                conn.DB.AddInParameter(cmd, &quot;TemplateId&quot;, DbType.Int32, templateId);

                using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                {
                    while (dr.Read()) //populate columns of dictionary from dataset
                        savedattr.Add(dr.GetInt32(0), dr.GetString(1));
                }
                return savedattr;
            }
        }

        #endregion

        #region &quot;Contract Items&quot;

        private readonly object lockConItem = new object();

        internal int CUDContractItems(StringBuilder srcXML)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                try
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(CUDCONTRACTITEMS);
                    SetTimeOut(cmd);
                    conn.DB.AddInParameter(cmd, &quot;srcXML&quot;, DbType.Xml, srcXML.ToString());

                    conn.DB.AddOutParameter(cmd, &quot;RETURNPARAMETER&quot;, DbType.Int32, 4);

                    DataSet ds = conn.DB.ExecuteDataSet(cmd);

                    if (ds == null || ds.Tables.Count == 0)
                        throw new Exception(&quot;dataset null&quot;);
                    if (ds.Tables[0].Rows.Count &gt; 0)
                    {
                        throw new Exception(ds.Tables[0].Rows[0][0].ToString());
                    }

                    return conn.DB.GetParameterValue(cmd, &quot;RETURNPARAMETER&quot;).ToInt32_2();

                    #region

                    //using (OracleConnection connection = new OracleConnection())
                    //{
                    //    connection.ConnectionString = WebConfigurationManager.ConnectionStrings[Constants.AMP3_CONNECTIONSTRING].ConnectionString;
                    //    connection.Open();
                    //    using (OracleCommand cmd = connection.CreateCommand())
                    //    {
                    //        cmd.CommandType = CommandType.StoredProcedure;
                    //        cmd.CommandText = CUDCONTRACTITEMS;
                    //        cmd.Parameters.Add(&quot;RETURNPARAMETER&quot;, OracleDbType.Int32, ParameterDirection.InputOutput);
                    //        cmd.Parameters.Add(&quot;srcXML&quot;, OracleDbType.XmlType, srcXML.ToString(), ParameterDirection.Input);
                    //        cmd.Parameters.Add(&quot;cur_OUT&quot;, OracleDbType.RefCursor, ParameterDirection.Output);
                    //        DataSet ds = new BrixDataSet();
                    //        using (OracleDataAdapter oraDataAdapter = new OracleDataAdapter(cmd))
                    //        {
                    //            oraDataAdapter.Fill(ds);
                    //        }
                    //        if (ds.Tables[0].Rows.Count &gt; 0)
                    //        {
                    //            throw new Exception(ds.Tables[0].Rows[0][0].ToString());
                    //        }
                    //    }
                    //}

                    #endregion
                }
                catch (Exception ex)
                {
                    throw ex;
                }
            }
        }

        internal DataTable GetItemsForMobile(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemsForMobile&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, contractID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        //internal DataSet GetContractItems4Export(int contractID)
        //{
        //    lock (lockConItem)
        //    {
        //        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItems4Export&quot;);

        //        conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);
        //        //conn.DB.AddOutParameter(cmd, &quot;cur_OUT&quot;, DbType.RefCur, null);
        //        return conn.DB.ExecuteDataSet(cmd);
        //    }
        //}

        //internal DataSet GetContractItemGroups(int contractID)
        //{
        //    lock (lockConItem)
        //    {
        //        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractItemGrps&quot;);
        //        conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);
        //        return conn.DB.ExecuteDataSet(cmd);
        //    }
        //}

        internal DTOItems GetContractItem(int contractID, int itemID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var dto = new DTOItems();
                var doc = new XmlDocument();
                var str = new StringBuilder();
                DataTable dt;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractItems&quot;);

                conn.DB.AddInParameter(cmd, &quot;itemID&quot;, DbType.Int32, itemID);
                conn.DB.AddInParameter(cmd, &quot;contID&quot;, DbType.Int32, contractID);

                dt = conn.DB.ExecuteDataSet(cmd).Tables[0];

                str.Append(&quot;&lt;XMLROOT&gt;&quot;);

                foreach (DataRow dr in dt.Rows)
                {
                    str.Append(dr[0]);
                }

                str.Append(&quot;&lt;/XMLROOT&gt;&quot;);

                doc.LoadXml(str.ToString());

                if (str.ToString().Equals(&quot;&lt;XMLROOT&gt;&lt;/XMLROOT&gt;&quot;))
                    throw new Exception(&quot;Item does not exist.&quot;);

                dto.ID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/ID&quot;));

                dto.LineNo = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/LineNo&quot;));

                dto.StdItemID = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/StdItemID&quot;));

                dto.AccountingCode = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/AccCode&quot;));

                dto.Complete = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsComplete&quot;));

                dto.Desc = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Desc&quot;));

                dto.NonCon = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsNC&quot;));

                dto.Notes = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Notes&quot;));

                dto.IsDeleted = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Deleted&quot;));

                dto.Islocked = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsLocked&quot;));

                dto.Prorated = GenericFunctions.ToString(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Prorated&quot;));

                dto.Qty = GenericFunctions.ToDecimal(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Qty&quot;));

                dto.UnitPrice = GenericFunctions.ToDecimal(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitPrice&quot;));

                dto.UnitCost = GenericFunctions.ToDecimal(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitCost&quot;));

                dto.UnitID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitID&quot;));

                //dto.SectionID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/SectionID&quot;));

                //XmlNode node = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/ByDimension&quot;);
                //if (node != null
                //    &amp;&amp; node.InnerText.Equals(&quot;1&quot;))
                //{
                //    dto.ByDimension = true;
                //    dto.DimensionID = GenericFunctions.ToInt(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/DimensionID&quot;));
                //}

                XmlNodeList list = doc.SelectNodes(&quot;//XMLROOT/Items/Item/Groups/Group&quot;);

                for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                {
                    var gp = new Group();

                    gp.ID = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;ID&quot;));

                    gp.Name = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Name&quot;));

                    gp.Desc = GenericFunctions.ToString(list[i].SelectSingleNode(&quot;Desc&quot;));

                    gp.OTPPercentage = GenericFunctions.ToDecimal(list[i].SelectSingleNode(&quot;OTPPercentage&quot;));

                    gp.Qty = GenericFunctions.ToDecimal(list[i].SelectSingleNode(&quot;Qty&quot;));

                    if (list[i].SelectSingleNode(&quot;OrigQty&quot;) != null)
                    {
                        gp.OrigQty = GenericFunctions.ToDecimal(list[i].SelectSingleNode(&quot;OrigQty&quot;));
                    }

                    gp.Discount = GenericFunctions.ToInt(list[i].SelectSingleNode(&quot;Discount&quot;));

                    dto.Groups.Add(gp);
                }

                return dto;
            }
        }

        //internal void AddItemAfterOrBefore(int itemID, string flag)
        //{
        //    lock (lockConItem)
        //    {
        //        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTAddItemsAfterBefore&quot;);

        //        conn.DB.AddInParameter(cmd, &quot;itemID&quot;, DbType.Int32, itemID);
        //        conn.DB.AddInParameter(cmd, &quot;flag&quot;, DbType.String, flag);
        //        DataSet ds = conn.DB.ExecuteDataSet(cmd);
        //        if (ds.Tables[0].Rows.Count &gt; 0)
        //        {
        //            throw new Exception(ds.Tables[0].Rows[0][0].ToString());
        //        }
        //    }
        //}

        //internal void MoveItemsUpDown(int itemID, string flag)
        //{
        //    lock (lockConItem)
        //    {
        //        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTMoveItemsUpDown&quot;);

        //        conn.DB.AddInParameter(cmd, &quot;itemID&quot;, DbType.Int32, itemID);
        //        conn.DB.AddInParameter(cmd, &quot;flag&quot;, DbType.String, flag);
        //        DataSet ds = conn.DB.ExecuteDataSet(cmd);
        //        if (ds.Tables[0].Rows.Count &gt; 0)
        //        {
        //            throw new Exception(ds.Tables[0].Rows[0][0].ToString());
        //        }
        //    }
        //}

        #endregion

        #region &quot;Item Postings&quot;

        internal int CreatePosting(StringBuilder srcXML, string mode)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd =
                    conn.DB.GetStoredProcCommand((mode == &quot;Edit&quot;) ? &quot;usp_CONTMGTUpdatePosting&quot; : &quot;usp_CONTMGTAddPosting&quot;);
                conn.DB.AddInParameter(cmd, &quot;XMLSTRING&quot;, DbType.String, srcXML.ToString());
                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToInt32_2();
            }
        }

        internal DTOItems GetItemPosting(int contractID, int itemID, int? postingID, string mode)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var dto = new DTOItems();
                Group gp;
                var doc = new XmlDocument();
                var str = new StringBuilder();

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemPosting&quot;);
                conn.DB.AddInParameter(cmd, &quot;itemID&quot;, DbType.Int32, itemID);
                conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;postingID&quot;, DbType.Int32, postingID);
                conn.DB.AddInParameter(cmd, &quot;opn&quot;, DbType.String, mode);
                conn.DB.AddInParameter(cmd, &quot;woid&quot;, DbType.Int32, null);

                if (postingID != null)
                {
                    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;
                    DataRow dtRow = dtColl[0].Rows[0];

                    dto.ID = dtRow[&quot;ItemID&quot;].ToInt32_2();
                    dto.LineNo = dtRow[&quot;Lineno&quot;].ToString();
                    dto.StdItemID = dtRow[&quot;StdItemID&quot;].ToString();
                    dto.Complete = dtRow[&quot;ISComplete&quot;].ToString();
                    dto.Desc = dtRow[&quot;ItemDesc&quot;].ToString();
                    dto.Postings.Attention = dtRow[&quot;Attention&quot;].ToString();
                    dto.Postings.FromStn = dtRow[&quot;FromStn&quot;].ToString();
                    dto.Postings.ToStn = dtRow[&quot;ToStn&quot;].ToString();
                    dto.Postings.BeginDate = dtRow[&quot;BeginDate&quot;].ToMWDateTime();
                    dto.Postings.EndDate = dtRow[&quot;EndDate&quot;].ToMWDateTime();
                    //dto.Postings.PostedBy = BrixDatatypeHelper.ToInt32_2(dtRow[&quot;PostedBy&quot;].ToString());
                    dto.Prorated = dtRow[&quot;Prorated&quot;].ToString();
                    dto.Postings.PostedDate = dtRow[&quot;PostedDate&quot;].ToMWDateTime();
                    dto.Postings.PostedQty = dtRow[&quot;PostedQty&quot;].ToString().ToDecimal2();
                    dto.Postings.Remarks = dtRow[&quot;Remarks&quot;].ToString();
                    dto.Postings.PercentComplete = dtRow[&quot;PercentComplete&quot;].ToString().ToDecimal2();
                    dto.Postings.QtyPlacedToDate = dtRow[&quot;QtyPlacedtoDate&quot;].ToString().ToDecimal2();
                    dto.Postings.QtyRemaining = dtRow[&quot;QtyRemaining&quot;].ToString().ToDecimal2();
                    dto.Postings.Unit = dtRow[&quot;Unit&quot;].ToString();
                    dto.Postings.CutoffDate = dtRow[&quot;CutOffDate&quot;].ToMWDateTime();
                    dto.UnitPrice = dtRow[&quot;UnitPrice&quot;].ToString().ToDecimal2();
                    dto.Qty = dtRow[&quot;Qty&quot;].ToString().ToDecimal2();
                    dto.Complete = dtRow[&quot;IsComplete&quot;].ToString();
                    dto.Postings.ContractorID = dtRow[&quot;ContractorID&quot;].ToString().ToInt32_2();
                    dto.Postings.ContractorType = dtRow[&quot;ContractorType&quot;].ToString();
                    dto.Postings.Contractor = dtRow[&quot;Contractor&quot;].ToString();
                    dto.Postings.WorkByContractor = dtRow[&quot;WorkByContractor&quot;].ToString();
                    dto.Postings.BidItemComplete = dtRow[&quot;ISComplete&quot;].ToString();
                    dto.Postings.Status = dtRow[&quot;Status&quot;].ToString();

                    foreach (DataRow dtSubRow in dtColl[1].Rows)
                    {
                        gp = new Group();
                        gp.ID = dtSubRow[&quot;GroupID&quot;].ToInt32_2();
                        gp.Name = dtSubRow[&quot;GroupName&quot;].ToString();
                        gp.OTPPercentage = dtSubRow[&quot;OTPPercentage&quot;].ToDecimal2();
                        gp.Discount = dtSubRow[&quot;Discount&quot;].ToDecimal2();
                        gp.Qty = dtSubRow[&quot;GroupQty&quot;].ToDecimal2();
                        gp.GroupPostedQty = dtSubRow[&quot;PostedQty&quot;].ToDecimal2();
                        gp.ItemID = dtSubRow[&quot;ItemID&quot;].ToInt32_2();
                        dto.Groups.Add(gp);
                    }
                }
                else
                {
                    //conn.DB.AddInParameter(cmd, &quot;postingID&quot;, DbType.Int32, null);
                    //conn.DB.AddInParameter(cmd, &quot;opn&quot;, DbType.String, null);
                    DataTable dt = conn.DB.ExecuteDataSet(cmd).Tables[0];
                    str.Append(&quot;&lt;XMLROOT&gt;&quot;);

                    foreach (DataRow dr in dt.Rows)
                    {
                        str.Append(dr[0]);
                    }

                    str.Append(&quot;&lt;/XMLROOT&gt;&quot;);

                    doc.LoadXml(str.ToString());

                    //Items 
                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/ID&quot;)))
                        dto.ID = null;
                    else
                        dto.ID = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/ID&quot;).InnerText.ToInt32_2();

                    dto.LineNo = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/LineNo&quot;))
                                     ? null
                                     : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/LineNo&quot;).InnerText;

                    dto.StdItemID = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/StdItemID&quot;))
                                        ? null
                                        : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/StdItemID&quot;).InnerText;

                    dto.AccountingCode = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/AccCode&quot;))
                                             ? null
                                             : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/AccCode&quot;).InnerText;

                    dto.Complete =
                        dto.Postings.BidItemComplete =
                        GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsComplete&quot;))
                            ? null
                            : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsComplete&quot;).InnerText;

                    dto.Desc = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Desc&quot;))
                                   ? null
                                   : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Desc&quot;).InnerText;

                    dto.NonCon = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsNC&quot;))
                                     ? null
                                     : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/IsNC&quot;).InnerText;

                    dto.Notes = GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Notes&quot;))
                                    ? null
                                    : doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Notes&quot;).InnerText;

                    dto.IsDeleted = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Deleted&quot;).InnerText;

                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Qty&quot;)))
                        dto.Qty = null;
                    else
                        dto.Qty = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/Qty&quot;).InnerText.ToDecimal2();

                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitPrice&quot;)))
                        dto.UnitPrice = null;
                    else
                        dto.UnitPrice = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitPrice&quot;).InnerText.ToDecimal2();

                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitID&quot;)))
                        dto.UnitID = null;
                    else
                        dto.UnitID = doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/UnitID&quot;).InnerText.ToInt32_2();

                    //if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/SectionID&quot;)))
                    //    dto.SectionID = null;
                    //else
                    //    dto.SectionID = BrixDatatypeHelper.ToInt32_2(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/SectionID&quot;).InnerText);

                    //Item Postings
                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/QtyPlacedToDate&quot;)))
                        dto.Postings.QtyPlacedToDate = null;
                    else
                        dto.Postings.QtyPlacedToDate =
                            doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/QtyPlacedToDate&quot;).InnerText.ToDecimal2();

                    if (GenericFunctions.isNull(doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/RemainingQty&quot;)))
                        dto.Postings.QtyRemaining = null;
                    else
                        dto.Postings.QtyRemaining =
                            doc.SelectSingleNode(&quot;//XMLROOT/Items/Item/RemainingQty&quot;).InnerText.ToDecimal2();


                    XmlNodeList list = doc.SelectNodes(&quot;//XMLROOT/Items/Item/Groups/Group&quot;);

                    for (int i = 0; list != null &amp;&amp; i &lt; list.Count; i++)
                    {
                        gp = new Group();

                        if (GenericFunctions.isNull(list[i].SelectSingleNode(&quot;ID&quot;)))
                            gp.ID = null;
                        else
                            gp.ID = list[i].SelectSingleNode(&quot;ID&quot;).InnerText.ToInt32_2();

                        gp.Name = GenericFunctions.isNull(list[i].SelectSingleNode(&quot;Name&quot;))
                                      ? null
                                      : list[i].SelectSingleNode(&quot;Name&quot;).InnerText;

                        gp.Desc = GenericFunctions.isNull(list[i].SelectSingleNode(&quot;Desc&quot;))
                                      ? null
                                      : list[i].SelectSingleNode(&quot;Desc&quot;).InnerText;

                        if (GenericFunctions.isNull(list[i].SelectSingleNode(&quot;OTPPercentage&quot;)))
                            gp.OTPPercentage = null;
                        else
                            gp.OTPPercentage = list[i].SelectSingleNode(&quot;OTPPercentage&quot;).InnerText.ToDecimal2();

                        if (GenericFunctions.isNull(list[i].SelectSingleNode(&quot;Qty&quot;)))
                            gp.Qty = null;
                        else
                            gp.Qty = list[i].SelectSingleNode(&quot;Qty&quot;).InnerText.ToDecimal2();

                        if (GenericFunctions.isNull(list[i].SelectSingleNode(&quot;Discount&quot;)))
                            gp.Discount = null;
                        else
                            gp.Discount = list[i].SelectSingleNode(&quot;Discount&quot;).InnerText.ToInt32_2();

                        if (GenericFunctions.isNull(list[i].SelectSingleNode(&quot;RemainingQty&quot;)))
                            gp.GroupPostedQty = null;
                        else
                            gp.GroupPostedQty = list[i].SelectSingleNode(&quot;RemainingQty&quot;).InnerText.ToDecimal2();

                        gp.ItemID = itemID;

                        dto.Groups.Add(gp);
                    }
                }
                return dto;
            }
        }

        //internal int GetPostingsCount(int contractID, string filterSearch)
        //{
        //    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemPostings&quot;);
        //    conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);

        //    if (filterSearch != null)
        //    {
        //        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);
        //    }
        //    conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;Y&quot;);

        //    return BrixDatatypeHelper.ToInt32_2(conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString());
        //}

        //internal DataTable GetItemPostings(int contractID, object startRowIdx, object maxRows, string sortOrder,
        //                                 string filterSearch)
        //{
        //    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetItemPostings&quot;);
        //    conn.DB.AddInParameter(cmd, &quot;contractID&quot;, DbType.Int32, contractID);

        //    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
        //        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
        //    if ((maxRows != null &amp;&amp; startRowIdx != Type.Missing) || (maxRows == null &amp;&amp; startRowIdx == Type.Missing))
        //        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
        //    if (sortOrder != null)
        //        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
        //    if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
        //        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);

        //    conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;N&quot;);

        //    return conn.DB.ExecuteDataSet(cmd).Tables[0];
        //}

        #endregion

        #region &quot;WOReports&quot;

        public DataTable GetPBSSReport(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;WORKORDReports&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.String, &quot;PBSS&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        public DataTable GetPBSSSubReport1(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;WORKORDReports&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.String, &quot;PBSSSR1&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        public DataTable GetPBSSSubReport2(int contractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;WORKORDReports&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContID&quot;, DbType.Int32, contractID);
                conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.String, &quot;PBSSSR2&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        #endregion

        #region Standard Items

        //Jagan-
        internal DataTable GetStdItems(int contractID, int stdTblID, object startRowIdx,
                                       object maxRows, string sortOrder, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DataTable table;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetStdItems4StdTbl&quot;);
                if (contractID != -1)
                {
                    conn.DB.AddInParameter(cmd, &quot;Contract_ID&quot;, DbType.Int32, contractID);
                }
                if (stdTblID != -1)
                {
                    conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, stdTblID);
                }
                if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                {
                    conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                }
                if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                {
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                }
                if (sortOrder != null)
                {
                    conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
                }
                if (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                {
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);
                }
                table = conn.DB.ExecuteDataSet(cmd).Tables[0];
                return table;
            }
        }

        //Jagan-To get all the standardItemTables to fill the dropdown.
        public DataTable GetStandardItemTables()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DataTable table;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllStdTables&quot;);

                table = conn.DB.ExecuteDataSet(cmd).Tables[0];

                return table;
            }
        }


        internal DataSet GetStdItemsTable(int stdTblID, object startRowIdx,
                                          object maxRows, string sortOrder, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                string strFilter = (filterSearch == null) ? &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot; : filterSearch;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl&quot;);
                if (stdTblID != -1)
                {
                    conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, stdTblID);
                }
                if (startRowIdx != null)
                {
                    conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                }
                if (maxRows != null)
                {
                    conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                }
                if (sortOrder != null)
                {
                    conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.String, sortOrder);
                }
                if (filterSearch != null)
                {
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.String, filterSearch);
                }

                conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.String, &quot;N&quot;);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal int GetStdItemsCount(int stdTblID, string filterSearch)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                int? nStdTblId = stdTblID;
                if (nStdTblId == -1) nStdTblId = null;

                string strFilter = (filterSearch == null) ? &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot; : filterSearch;

                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl&quot;,
                                                        nStdTblId, strFilter, 1, 10, null, &quot;Y&quot;);

                return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString().ToInt32_2();
            }
        }

        #endregion

        internal DataSet GetForecastCalendarDetails(int contractID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetForecastCalendarDetails, null, contractID);
        }

        internal DataSet GetCalendarDetails(int contractID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetCalendarDetails, null, contractID);
        }

        internal int CopyCalendarFromLibrary(int contractID, int calendarID, string userName)
        {
            int returnValue = 0;
            Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
            
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTUpdateCalendarWithHolidayList, dic, contractID, calendarID, userName);

            if (dic.ContainsKey(&quot;ContractCalendarID&quot;))
                returnValue = dic[&quot;ContractCalendarID&quot;].ToInt32_2();

            return returnValue;
        }

        internal int CopyForecastCalendarFromLibrary(int contractID, int calendarID)
        {
            int returnValue = 0;
            Dictionary&lt;string, object&gt; dic = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTUpdateCalendar, dic, contractID, calendarID);

            if (dic.ContainsKey(&quot;ContractCalendarID&quot;))
                returnValue = dic[&quot;ContractCalendarID&quot;].ToInt32_2();

            return returnValue;
        }

        internal void UpdateContractWorkingDays(int contractID, int workingDays)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTUpdateContractWorkingDays, null, contractID, workingDays);
        }
    }

    public partial class ContMgtComponent
    {
        public DataSet GetContractXmlTree(int projId, int uid, int rid, string platform)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractsTree&quot;, projId, uid, rid, platform);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }
        public DataSet GetContractXmlTreeWithContractPermissions(int projId, int uid, int rid, string platform)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractsTreeWithContractPermissions&quot;, projId, uid, rid, platform);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        public DataSet GetContractXmlTreeForMobile(int projId, int uid, int rid)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContractsTreeForMobile&quot;, projId, uid, rid);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataTable GetProjectAssociation(int projectID, string moduleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectModules&quot;);
                conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectID);
                conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);

                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        internal DataSet GetContractSubmittals(int moduleLinkID, int projectID, string moduleCategory)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_SUBMTALGetRegister&quot;);
                conn.DB.AddInParameter(cmd, &quot;ProjectID&quot;, DbType.Int32, projectID);
                conn.DB.AddInParameter(cmd, &quot;ModuleCategory&quot;, DbType.String, moduleCategory);
                conn.DB.AddInParameter(cmd, &quot;ModuleLinkID&quot;, DbType.Int32, moduleLinkID);
                conn.DB.AddInParameter(cmd, &quot;FilterText&quot;, DbType.String, &quot;&lt;XMLRoot&gt;&lt;Status&gt;P&lt;/Status&gt;&lt;/XMLRoot&gt;&quot;);
                conn.DB.AddInParameter(cmd, &quot;GetCount&quot;, DbType.String, &quot;N&quot;);

                return conn.DB.ExecuteDataSet(cmd);

            }
        }

        internal DataSet GetRAItems(int ContractID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ERPMGMTICAGetItems&quot;);
                conn.DB.AddInParameter(cmd, &quot;ContractID&quot;, DbType.Int32, ContractID);
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        public DataSet GetIssuedWorkorders(int contractID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_WORKORDGetWOOrContractor,
                                                           null, contractID, null, null, true);
        }

        public DataSet GetWOSummaryStatusReport(int contractID, int workOrderID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_WORKORDWOSummaryStatusReport, null, contractID, workOrderID);
        }

        internal void InsertDrawingQuantityDetails(int contractId, int itemId, decimal drawingQuantity)
        {
            int result;
            result =
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    ContractManagerStoredProcedure.usp_CONTMGTCUDrawingQuantityLog, null, contractId, itemId,
                    drawingQuantity, &#39;I&#39;);
        }

        public DataSet GetDrawingQuantityDetails(int contractId)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTCUDrawingQuantityLog,
                                                        null, contractId, 0, 0, &#39;G&#39;);
        }

        internal bool ShouldModulebeEnabled(int contractId, string moduleId)
        {
            return
                ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTShouldModulebeEnabled,
                                                       null, contractId, moduleId).ToBoolean2();
        }

        internal bool VerifyModuleSettings(int ContractID, string moduleID)
        {
            return
                ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTVerifyModuleSettings,
                                                       null, ContractID, moduleID).ToBoolean2();
        }

        internal DataSet GetRecordsCount(string moduleId, int contractId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetRecordsCount,
                                                           null, moduleId, contractId);
        }

        internal bool HasFinalPE(int contractId, int workOrderId, string peStatus)
        {
            var dict = new Dictionary&lt;string, object&gt;();
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                ContractManagerStoredProcedure.usp_CONTMGTHasFinalPE, dict, contractId, workOrderId, peStatus);
            return (dict.ContainsKey(&quot;Result&quot;) &amp;&amp; (dict[&quot;Result&quot;] != null) &amp;&amp; dict[&quot;Result&quot;].ToString2().Equals(&quot;1&quot;));
        }

        /// &lt;summary&gt;
        /// Validating addition of prepayment rule while creating versions for a work order.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;workOrderId&quot;&gt;Work order ID&lt;/param&gt;
        /// &lt;param name=&quot;recoveryId&quot;&gt;The prepayment rule id which is selected&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int ValidatePrepaymentRule(int contractID, int recoveryID)
        {
            int retVal = 0;
            lock (lockObj)
            {
                var dictionary = new Dictionary&lt;string, object&gt;();
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_WORKORDValidatePrepaymentRule, dictionary, contractID, 0,
                    recoveryID);
                retVal = dictionary[&quot;isValid&quot;].ToString().ToInt32_2();
            }
            return retVal;
        }

        public decimal GetTotalContractAmountForContractView(int contractID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTGetTotalContractAmountForContractView, null, contractID).
                    Tables[0].Rows[0][&quot;ContractAmount&quot;].ToDecimal2();
        }

        public DataSet GetCostManagerDetails(int? contractId, int UID, int RID, bool IncludeOnlyActive)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTGetCostManagerDetails, null, contractId, UID, RID, IncludeOnlyActive);
        }

        public int GetAllSubProjectCount(int projectID)
        {
            //return ComponentHelper.Instance.ExecuteScalar(&quot;select count(*) from CONTMGTMaster where ProjectId = &quot; + projectID).ToInt32_2();
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTGetAllSubProjectCount, null, projectID).ToInt32_2();
        }

        public void MoveContracts(int oldProjectID, int newProjectID, string contractIds)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTMoveContracts, null, newProjectID, oldProjectID, contractIds);
        }

        internal bool AllowPCUpdate(int ContractId, int PCId)
        {
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTCheckPCUpdate, null, ContractId, PCId).Equals(1);
        }

        #region

        public void CreateCommitments(int ContractID)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTCreateCommitments, null, ContractID);
        }

        #endregion

        public void CUWorksiteMapLocations(WorksiteMapDTO dto)
        {
            ComponentHelper.Instance.ExecuteNonQuery(ContractManagerStoredProcedure.usp_CONTMGTCUWorksiteMapLocations, null, dto);
        }

        public WorksiteMapDTO GetWorksiteMapLocations(int projectId, int contractId)
        {
            WorksiteMapDTO dto = new WorksiteMapDTO();

            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetWorksiteMapLocations, null, projectId, contractId);
            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0 &amp;&amp; ds.Tables[0].Rows.Count == 1)
            {
                ds.Tables[0].Rows[0].FillDTO(dto);
            }

            return dto;
        }

        public DataSet GetMapEnabledForms(int contractId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetMapEnabledForms, null, contractId);
        }

        public DataSet GetMapEnabledForms_AllProjects(int userId, int roleId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetMapEnabledForms_AllProjects, null, userId, roleId);
        }

        public bool ValidateBeforeApproval(int contractId)
        {
            bool isValid = false;

            object objValue = ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTValidateAgainstCurrentBudget, null, contractId);
            if (objValue != null &amp;&amp; objValue.ToString() == &quot;1&quot;)
                isValid = true;

            return isValid;
        }

        public string GetNamefromcontmgtmaster(int contractID)
        {

            object res = ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTGetContractName, null, contractID);

            if (res != null)
                return res.ToString();

            return &quot;&quot;;
        }

        internal object GetTotalContractAmount(int parentId)
        {
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTGetContractAmount, null, parentId);

        }

        public object GetExpenditureCurvefromProject(int PID)
        {
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTExpenditureCurveFromProject, null, PID);

        }

        internal object GetIDfromCalendar(int ContractID)
        {
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTGetIDfromCalendar, null, ContractID);

        }

        public DataSet GetDetailsFromContmgtMaster(int PID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTGetDateDetailsFromContract, null, PID);
        }

        public int DeleteDrawingQuantityLog(int projectID)
        {
            return ComponentHelper.Instance.ExecuteScalar(ContractManagerStoredProcedure.usp_CONTMGTDeleteDrawingQuantityLog, null, projectID).ToInt32_2();
        }

        public DataSet SetPrimaryContractor(int ContractId, string ContractNumber)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(
                    ContractManagerStoredProcedure.usp_CONTMGTSetPrimaryContractor, null, ContractId, ContractNumber);
        }

        public DataSet GetContractCost(int contractID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetContractCost, null, contractID);
        }

        public DataSet GetMapLayerColors(string context)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetMapLayerColors, null, context);
        }

        public DataSet GetEnterpriseMapInfoWindow(int statusId, int userId, bool isUserAdmin)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetEnterpriseMapInfoWindow, null, statusId, userId, isUserAdmin);
        }

        public int InsertContainerAfterProjectPhaseSave(int projectID, int createdBy)
        {
            return ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(ContractManagerStoredProcedure.usp_CONTMGTAfterProjectPhaseSave, null, projectID, createdBy);
        }

        public void InviteProjectUsersToContract(int projectId, int contractId)
        {
            ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTInviteContractUser, null, projectId, contractId);
        }

        public DataSet GetSubContainers(string containerid)
        {
            return ComponentHelper.Instance.ExecuteDataSet(ContractManagerStoredProcedure.usp_CONTMGTGetSubContainers, null, containerid);
        }

    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[36,9,36,56,1],[39,9,39,10,1],[40,13,40,46,1],[41,13,42,100,1],[43,17,43,46,1],[44,9,44,10,1],[47,9,47,10,0],[48,13,48,27,0],[49,13,49,14,0],[50,24,50,89,0],[51,17,51,18,0],[52,21,52,106,0],[53,21,53,89,0],[54,21,54,86,0],[55,21,55,81,0],[56,21,56,48,0],[57,21,57,95,0],[60,9,60,10,0],[63,9,63,10,0],[64,20,64,85,0],[65,13,65,14,0],[66,17,66,92,0],[67,17,67,74,0],[68,17,68,124,0],[69,17,69,77,0],[70,17,70,77,0],[71,17,71,62,0],[73,9,73,10,0],[76,9,76,10,0],[77,20,77,85,0],[78,13,78,14,0],[79,17,79,97,0],[80,17,80,74,0],[81,17,81,124,0],[82,17,82,77,0],[83,17,83,77,0],[84,17,84,62,0],[86,9,86,10,0],[89,9,89,10,0],[90,20,90,85,0],[91,13,91,14,0],[92,17,92,93,0],[93,17,93,124,0],[94,17,94,77,0],[95,17,95,77,0],[96,17,96,62,0],[98,9,98,10,0],[102,9,102,10,0],[103,20,103,85,0],[104,13,104,14,0],[105,17,105,87,0],[107,17,107,72,0],[108,17,108,18,0],[109,21,109,91,0],[110,17,110,18,0],[111,17,111,68,0],[112,17,112,18,0],[113,21,113,89,0],[114,17,114,18,0],[116,17,116,18,0],[117,21,117,94,0],[118,17,118,18,0],[120,17,120,88,0],[121,17,121,84,0],[122,17,122,85,0],[123,17,123,77,0],[125,17,125,62,0],[127,9,127,10,0],[130,9,130,10,0],[131,20,131,85,0],[132,13,132,14,0],[133,17,133,106,0],[134,17,134,90,0],[135,17,135,52,0],[138,9,138,10,0],[141,9,141,10,0],[142,20,142,85,0],[143,13,143,14,0],[144,17,144,103,0],[145,17,145,92,0],[146,17,146,52,0],[149,9,149,10,0],[152,9,152,10,1],[153,20,153,85,1],[154,13,154,14,1],[155,17,155,93,1],[156,17,156,81,1],[157,17,157,58,1],[158,17,158,49,1],[159,17,159,18,0],[160,21,160,77,0],[162,13,162,14,1],[163,9,163,10,1],[166,9,166,10,0],[167,20,167,85,0],[168,13,168,14,0],[169,17,169,95,0],[170,17,170,75,0],[171,17,171,84,0],[173,9,173,10,0],[176,9,176,10,0],[177,20,177,85,0],[178,13,178,14,0],[179,17,179,94,0],[180,17,180,86,0],[181,17,181,62,0],[183,9,183,10,0],[187,9,187,10,1],[188,20,188,85,1],[189,13,189,14,1],[190,17,190,89,1],[191,17,191,33,1],[192,17,192,80,1],[193,17,193,92,1],[194,17,194,92,1],[195,17,195,84,1],[196,17,196,86,1],[197,17,197,82,1],[198,17,198,99,1],[199,17,199,73,1],[200,17,200,80,1],[201,17,201,46,1],[202,17,202,104,1],[203,17,203,88,1],[205,9,205,10,1],[208,9,208,10,0],[209,20,209,85,0],[210,13,210,14,0],[211,17,211,87,0],[213,17,213,88,0],[214,17,214,84,0],[215,17,215,97,0],[216,17,216,77,0],[217,17,217,77,0],[219,17,219,96,0],[221,9,221,10,0],[224,9,224,10,0],[225,20,225,85,0],[226,13,226,14,0],[227,17,227,89,0],[228,17,228,90,0],[229,17,229,86,0],[230,17,230,86,0],[231,17,231,75,0],[232,17,232,62,0],[234,9,234,10,0],[238,9,238,10,0],[239,20,239,85,0],[240,13,240,14,0],[241,17,241,39,0],[242,17,242,35,0],[243,17,243,45,0],[244,21,244,75,0],[245,17,245,45,0],[246,21,246,75,0],[248,17,248,53,0],[250,17,250,49,0],[251,21,251,33,0],[253,17,253,74,0],[255,9,255,10,0],[258,9,258,10,1],[259,20,259,85,1],[260,13,260,14,1],[261,17,261,94,1],[262,17,262,83,1],[263,17,263,74,1],[264,17,264,69,1],[266,17,266,46,1],[268,17,268,73,1],[270,9,270,10,1],[280,9,280,10,0],[281,20,281,85,0],[282,13,282,14,0],[283,17,283,126,0],[285,17,285,52,0],[287,9,287,10,0],[290,9,290,10,1],[291,13,291,26,1],[293,13,293,161,1],[294,13,294,31,1],[294,32,294,72,1],[295,13,295,24,1],[296,9,296,10,1],[299,9,299,10,0],[300,20,300,85,0],[301,13,301,14,0],[302,17,303,99,0],[305,17,305,52,0],[307,9,307,10,0],[310,9,310,10,0],[311,20,311,85,0],[312,13,312,14,0],[313,17,314,99,0],[316,17,316,52,0],[318,9,318,10,0],[321,9,321,10,0],[322,20,322,85,0],[323,13,323,14,0],[324,17,325,99,0],[327,17,327,52,0],[329,9,329,10,0],[332,9,332,10,0],[333,20,333,85,0],[334,13,334,14,0],[335,17,335,132,0],[336,17,336,52,0],[338,9,338,10,0],[341,9,341,10,0],[342,20,342,85,0],[343,13,343,14,0],[344,17,344,93,0],[345,17,345,85,0],[347,17,347,62,0],[349,9,349,10,0],[353,9,353,10,0],[354,20,354,85,0],[355,13,355,14,0],[356,17,356,94,0],[358,17,358,81,0],[359,17,359,81,0],[361,17,361,47,0],[362,21,362,91,0],[364,17,364,40,0],[365,17,365,18,0],[366,21,366,55,0],[367,25,367,86,0],[369,25,369,86,0],[370,17,370,18,0],[371,17,371,52,0],[373,9,373,10,0],[377,9,377,10,1],[378,13,378,34,1],[379,13,379,28,1],[380,13,380,63,1],[381,20,381,85,1],[382,13,382,14,1],[383,17,388,118,1],[390,17,390,70,1],[391,13,391,14,1],[392,13,392,27,1],[393,9,393,10,1],[396,9,396,10,1],[397,13,397,27,1],[398,13,398,14,1],[399,17,402,37,1],[404,9,404,10,1],[407,9,407,10,1],[409,13,409,27,1],[410,13,410,14,1],[411,17,413,105,1],[415,17,415,53,1],[416,21,416,33,0],[418,17,418,55,1],[419,17,419,57,1],[420,17,420,60,1],[421,17,421,72,1],[422,17,422,58,1],[423,17,423,60,1],[424,17,424,74,1],[425,17,425,80,1],[426,17,426,82,1],[427,17,427,84,1],[428,17,428,91,1],[429,17,429,80,1],[430,17,430,76,1],[431,17,431,97,1],[432,17,432,76,1],[433,17,433,44,1],[434,17,434,18,1],[435,21,435,97,1],[436,21,438,41,1],[439,21,439,82,1],[440,17,440,18,1],[441,17,441,36,1],[443,9,443,10,1],[446,9,446,10,1],[447,13,447,27,1],[448,13,448,14,1],[449,17,452,42,1],[454,9,454,10,1],[457,9,457,10,1],[458,13,458,27,1],[459,13,459,14,1],[460,17,463,42,1],[465,9,465,10,1],[468,9,468,10,1],[469,13,469,27,1],[470,13,470,14,1],[471,17,471,67,1],[472,17,474,56,1],[475,17,475,68,1],[477,9,477,10,1],[480,9,480,10,0],[481,13,481,27,0],[482,13,482,14,0],[483,17,483,67,0],[484,17,486,56,0],[487,17,487,68,0],[489,9,489,10,0],[494,9,494,10,0],[495,20,495,85,0],[496,13,496,14,0],[497,17,497,102,0],[498,17,498,85,0],[499,17,499,75,0],[500,17,500,76,0],[501,17,501,62,0],[503,9,503,10,0],[510,9,510,10,1],[511,20,511,85,1],[512,13,512,14,1],[513,17,513,85,1],[515,17,515,83,1],[516,17,516,81,1],[517,17,517,83,1],[518,17,518,79,1],[519,17,519,80,1],[520,17,520,71,1],[522,17,522,62,1],[524,9,524,10,1],[527,9,527,10,1],[528,20,528,85,1],[529,13,529,14,1],[530,17,530,85,1],[532,17,532,83,1],[533,17,533,81,1],[534,17,534,99,1],[535,17,535,79,1],[536,17,536,80,1],[537,17,537,71,1],[539,17,539,62,1],[541,9,541,10,1],[544,9,544,10,0],[545,20,545,85,0],[546,13,546,14,0],[547,17,547,78,0],[548,17,548,99,0],[550,17,550,62,0],[552,9,552,10,0],[556,9,556,10,1],[557,20,557,85,1],[558,13,558,14,1],[559,17,559,98,1],[560,17,560,33,1],[561,17,561,91,1],[562,17,562,96,1],[563,17,563,101,1],[564,17,564,94,1],[565,17,565,85,1],[566,17,566,75,1],[567,17,567,72,1],[569,17,569,46,1],[570,17,570,87,1],[572,9,572,10,1],[580,9,580,10,0],[581,20,581,85,0],[582,13,582,14,0],[583,17,583,90,0],[585,17,585,28,0],[588,25,588,91,0],[589,25,589,82,0],[590,25,590,82,0],[591,25,591,48,0],[592,29,592,95,0],[593,25,593,80,0],[594,25,594,31,0],[596,25,596,83,0],[597,25,597,81,0],[598,25,598,31,0],[601,17,601,85,0],[603,9,603,10,0],[606,9,606,10,0],[607,20,607,85,0],[608,13,608,14,0],[609,17,609,86,0],[611,17,611,28,0],[614,25,614,95,0],[615,25,615,80,0],[616,25,616,31,0],[618,25,618,93,0],[619,25,619,81,0],[620,25,620,31,0],[623,17,623,85,0],[625,9,625,10,0],[628,9,628,10,1],[629,20,629,85,1],[630,13,630,14,1],[631,17,631,86,1],[633,17,633,41,1],[634,21,634,89,0],[636,17,636,62,1],[638,9,638,10,1],[641,9,641,10,1],[642,20,642,85,1],[643,13,643,14,1],[644,17,644,90,1],[646,17,646,62,1],[648,9,648,10,1],[651,9,651,10,1],[652,20,652,85,1],[653,13,653,14,1],[654,17,654,93,1],[655,17,657,108,1],[658,17,659,102,1],[660,17,660,31,1],[661,17,661,48,1],[662,17,662,112,1],[663,17,663,18,0],[664,21,664,43,0],[665,21,665,22,0],[666,25,666,45,0],[669,25,669,45,0],[672,17,672,18,1],[673,21,673,94,1],[675,21,675,44,1],[676,25,676,91,0],[678,21,678,66,1],[681,9,681,10,1],[684,9,684,10,0],[685,20,685,85,0],[686,13,686,14,0],[687,17,687,96,0],[689,17,689,77,0],[691,17,691,62,0],[693,9,693,10,0],[696,9,696,10,0],[697,20,697,85,0],[698,13,698,14,0],[699,17,699,91,0],[700,17,700,85,0],[701,17,701,62,0],[703,9,703,10,0],[707,9,707,10,0],[708,20,708,85,0],[709,13,709,14,0],[710,17,710,97,0],[711,17,711,85,0],[712,17,712,82,0],[713,17,713,52,0],[715,9,715,10,0],[718,9,718,10,1],[719,20,719,85,1],[720,13,720,14,1],[721,17,721,88,1],[723,17,723,85,1],[724,17,724,96,1],[726,17,726,76,1],[728,17,728,44,1],[730,17,730,79,1],[732,9,732,10,1],[735,9,735,10,0],[736,20,736,85,0],[737,13,737,14,0],[738,17,738,95,0],[740,17,740,77,0],[741,17,741,51,0],[742,21,742,82,0],[743,17,743,48,0],[744,21,744,82,0],[745,17,745,36,0],[746,21,746,83,0],[747,17,747,35,0],[748,21,748,80,0],[750,17,750,46,0],[751,13,751,14,0],[752,9,752,10,0],[755,9,755,10,0],[756,20,756,85,0],[757,13,757,14,0],[758,17,758,93,0],[760,17,760,83,0],[762,17,762,46,0],[763,13,763,14,0],[764,9,764,10,0],[767,9,767,10,0],[768,20,768,85,0],[769,13,769,14,0],[770,17,770,126,0],[775,17,775,44,0],[776,13,776,14,0],[777,9,777,10,0],[780,9,780,10,0],[781,13,781,27,0],[782,13,782,14,0],[783,17,784,78,0],[785,13,785,14,0],[786,9,786,10,0],[789,9,789,10,0],[790,13,790,27,0],[791,13,791,14,0],[792,17,792,60,0],[793,17,794,103,0],[795,17,795,49,0],[797,9,797,10,0],[803,9,803,10,0],[804,13,804,27,0],[805,13,805,14,0],[806,17,806,60,0],[807,17,810,132,0],[811,17,811,52,0],[812,17,812,49,0],[815,9,815,10,0],[829,9,829,10,1],[830,13,830,27,1],[831,13,831,38,1],[833,13,833,56,1],[834,13,834,49,1],[835,13,835,37,1],[836,13,836,57,1],[838,13,840,120,1],[843,13,843,54,1],[846,13,846,62,1],[848,13,848,47,1],[849,9,849,10,1],[852,9,852,10,1],[853,13,853,56,1],[855,13,857,80,1],[859,13,859,33,1],[860,9,860,10,1],[863,9,863,10,0],[864,13,864,56,0],[866,13,868,80,0],[869,9,869,10,0],[872,9,872,10,1],[873,13,873,27,1],[874,13,874,35,1],[876,13,876,56,1],[877,13,877,37,1],[879,13,879,64,1],[880,13,880,161,1],[882,13,882,54,1],[884,13,884,55,1],[885,17,885,47,1],[887,13,887,35,1],[888,9,888,10,1],[892,9,892,10,0],[893,20,893,85,0],[894,13,894,14,0],[895,17,895,92,0],[897,17,897,77,0],[898,17,898,62,0],[900,9,900,10,0],[903,9,903,10,0],[904,20,904,85,0],[905,13,905,14,0],[906,17,906,126,0],[911,17,911,44,0],[912,13,912,14,0],[913,9,913,10,0],[919,9,919,56,1],[920,9,920,60,1],[921,9,921,51,1],[922,9,922,51,1],[925,9,925,10,1],[926,20,926,85,1],[927,13,927,14,1],[928,17,928,75,1],[929,17,929,33,1],[930,17,930,86,1],[931,17,931,72,1],[933,17,933,58,1],[935,17,935,56,1],[936,21,936,57,0],[937,17,937,67,1],[938,17,938,18,1],[939,21,939,93,1],[940,21,941,97,1],[942,21,942,60,1],[943,21,943,22,1],[944,25,945,98,1],[946,25,946,70,1],[947,25,947,26,0],[948,29,949,108,0],[950,25,950,26,0],[951,21,951,22,1],[952,21,952,60,1],[953,21,953,22,0],[954,25,955,109,0],[956,21,956,22,0],[957,21,957,61,1],[958,21,958,22,0],[959,25,960,104,0],[961,21,961,22,0],[962,21,962,53,1],[963,21,963,22,0],[964,25,965,120,0],[966,21,966,22,0],[967,21,967,61,1],[968,21,968,22,0],[969,25,970,118,0],[971,21,971,22,0],[972,21,972,52,1],[974,17,974,76,1],[976,9,976,10,1],[979,9,979,10,0],[980,20,980,85,0],[981,13,981,14,0],[982,17,982,98,0],[983,17,983,33,0],[984,17,984,85,0],[985,17,985,79,0],[987,17,987,45,0],[989,17,989,83,0],[991,9,991,10,0],[994,9,994,10,1],[995,20,995,85,1],[996,13,996,14,1],[997,17,997,80,1],[999,17,999,86,1],[1001,17,1001,48,1],[1003,17,1003,50,1],[1005,17,1005,56,1],[1006,21,1006,57,0],[1007,17,1007,49,1],[1008,17,1008,18,0],[1009,21,1009,77,0],[1011,13,1011,14,1],[1012,9,1012,10,1],[1015,9,1015,10,1],[1016,20,1016,85,1],[1017,13,1017,14,1],[1018,17,1018,87,1],[1020,17,1020,86,1],[1022,17,1022,48,1],[1024,17,1024,50,1],[1026,17,1026,56,1],[1027,21,1027,57,0],[1028,17,1028,49,1],[1029,17,1029,18,0],[1030,21,1030,77,0],[1032,13,1032,14,1],[1033,9,1033,10,1],[1040,9,1040,10,0],[1041,20,1041,85,0],[1042,13,1042,14,0],[1043,17,1043,89,0],[1045,17,1045,77,0],[1046,17,1046,80,0],[1047,17,1047,93,0],[1048,17,1048,85,0],[1049,17,1049,80,0],[1050,17,1050,77,0],[1051,17,1051,57,0],[1052,21,1052,92,0],[1054,17,1054,58,0],[1055,17,1055,86,0],[1056,21,1056,75,0],[1058,21,1058,30,0],[1060,9,1060,10,0],[1063,9,1063,10,0],[1064,20,1064,85,0],[1065,13,1065,14,0],[1066,17,1066,112,0],[1068,17,1068,77,0],[1069,17,1069,80,0],[1070,17,1070,93,0],[1071,17,1071,85,0],[1072,17,1072,80,0],[1073,17,1073,77,0],[1074,17,1074,57,0],[1075,21,1075,92,0],[1077,17,1077,58,0],[1078,17,1078,86,0],[1079,21,1079,75,0],[1081,21,1081,30,0],[1083,9,1083,10,0],[1087,9,1087,10,0],[1088,20,1088,85,0],[1089,13,1089,14,0],[1090,17,1090,89,0],[1092,17,1092,77,0],[1093,17,1093,80,0],[1094,17,1094,93,0],[1095,17,1095,85,0],[1096,17,1096,80,0],[1098,17,1098,72,0],[1099,21,1099,91,0],[1100,17,1100,68,0],[1101,21,1101,89,0],[1102,17,1102,39,0],[1103,21,1103,88,0],[1104,17,1104,57,0],[1105,21,1105,92,0],[1106,17,1106,77,0],[1108,17,1108,62,0],[1110,9,1110,10,0],[1114,9,1114,10,0],[1115,20,1115,85,0],[1116,13,1116,14,0],[1117,17,1117,112,0],[1119,17,1119,77,0],[1120,17,1120,80,0],[1121,17,1121,93,0],[1122,17,1122,85,0],[1123,17,1123,80,0],[1125,17,1125,72,0],[1126,21,1126,91,0],[1127,17,1127,68,0],[1128,21,1128,89,0],[1129,17,1129,39,0],[1130,21,1130,88,0],[1131,17,1131,57,0],[1132,21,1132,92,0],[1133,17,1133,77,0],[1135,17,1135,62,0],[1137,9,1137,10,0],[1140,9,1140,10,1],[1141,20,1141,85,1],[1142,13,1142,14,1],[1143,17,1143,48,1],[1145,17,1145,45,1],[1146,17,1146,47,1],[1149,17,1149,89,1],[1151,17,1151,81,1],[1153,17,1153,60,1],[1155,17,1155,41,1],[1157,17,1157,24,1],[1157,26,1157,36,1],[1157,37,1157,39,1],[1157,40,1157,47,1],[1158,17,1158,18,1],[1159,21,1159,39,1],[1160,17,1160,18,1],[1161,17,1161,42,1],[1163,17,1163,45,1],[1165,17,1165,95,1],[1166,22,1166,31,1],[1166,33,1166,47,1],[1166,49,1166,52,1],[1167,17,1167,18,1],[1168,21,1168,80,1],[1169,17,1169,18,1],[1171,17,1171,108,1],[1172,17,1172,114,1],[1174,17,1175,65,1],[1176,17,1176,18,1],[1177,21,1177,108,1],[1179,21,1179,108,1],[1181,21,1181,120,1],[1183,21,1183,116,1],[1185,21,1185,108,1],[1187,21,1187,115,1],[1189,21,1189,113,1],[1191,21,1191,120,1],[1193,21,1193,120,1],[1197,21,1197,105,1],[1198,25,1198,120,1],[1199,21,1200,118,1],[1201,21,1201,120,1],[1202,17,1202,18,1],[1204,17,1205,73,1],[1206,17,1206,18,1],[1207,21,1208,109,1],[1209,21,1210,108,1],[1211,21,1212,106,1],[1213,17,1213,18,1],[1215,17,1216,67,1],[1217,17,1217,18,1],[1218,21,1219,102,1],[1220,21,1221,102,1],[1222,21,1223,102,1],[1224,21,1225,102,1],[1226,21,1227,102,1],[1228,17,1228,18,1],[1230,17,1231,68,1],[1232,17,1232,18,1],[1233,21,1233,82,1],[1235,26,1235,35,1],[1235,37,1235,67,1],[1235,69,1235,72,1],[1236,21,1236,22,1],[1237,25,1237,48,1],[1239,25,1239,94,1],[1241,25,1241,95,1],[1243,25,1243,46,1],[1244,21,1244,22,1],[1245,17,1245,18,1],[1247,17,1248,74,1],[1249,17,1249,18,1],[1250,21,1250,88,1],[1252,26,1252,35,1],[1252,37,1252,67,1],[1252,69,1252,72,0],[1253,21,1253,22,0],[1254,25,1254,51,0],[1256,25,1256,92,0],[1258,25,1258,96,0],[1260,25,1260,96,0],[1262,25,1262,57,0],[1264,25,1265,115,0],[1267,30,1267,39,0],[1267,41,1267,61,0],[1267,63,1267,66,0],[1268,25,1268,26,0],[1269,29,1269,94,0],[1270,25,1270,26,0],[1272,25,1272,49,0],[1273,21,1273,22,0],[1274,17,1274,18,1],[1297,17,1298,66,1],[1299,17,1299,18,1],[1300,21,1300,80,1],[1302,26,1302,35,1],[1302,37,1302,67,1],[1302,69,1302,72,1],[1303,21,1303,22,1],[1304,25,1304,46,1],[1306,25,1306,88,1],[1308,25,1308,95,1],[1310,25,1310,95,1],[1312,25,1312,114,1],[1314,25,1314,104,1],[1316,25,1316,44,1],[1317,21,1317,22,1],[1318,17,1318,18,1],[1320,17,1321,62,1],[1322,17,1322,18,1],[1323,21,1323,116,1],[1325,21,1325,116,1],[1327,21,1327,126,1],[1329,21,1329,109,1],[1331,21,1331,117,1],[1332,17,1332,18,1],[1334,17,1335,76,1],[1336,17,1336,18,1],[1337,21,1337,116,1],[1339,21,1339,112,1],[1341,21,1341,111,1],[1343,21,1343,120,1],[1345,21,1345,120,1],[1347,21,1347,120,1],[1349,21,1349,116,1],[1351,21,1351,112,1],[1353,21,1353,116,1],[1355,21,1355,122,1],[1357,21,1357,122,1],[1359,21,1359,114,1],[1361,21,1361,120,1],[1363,21,1363,116,1],[1365,21,1365,73,1],[1367,26,1367,35,1],[1367,37,1367,67,1],[1367,69,1367,72,1],[1368,21,1368,22,1],[1369,25,1369,52,1],[1373,25,1373,92,1],[1375,25,1375,92,1],[1377,25,1377,101,1],[1379,25,1379,101,1],[1381,25,1381,101,1],[1383,25,1383,97,1],[1385,25,1385,93,1],[1387,25,1387,97,1],[1389,25,1389,103,1],[1391,25,1391,103,1],[1393,25,1393,95,1],[1395,25,1395,97,1],[1397,25,1397,101,1],[1399,25,1399,40,1],[1400,21,1400,22,1],[1401,17,1401,18,1],[1403,17,1403,28,1],[1405,9,1405,10,1],[1408,9,1408,10,1],[1409,13,1410,98,1],[1411,9,1411,10,1],[1414,9,1414,10,0],[1415,20,1415,85,0],[1416,13,1416,14,0],[1417,17,1417,95,0],[1418,17,1418,71,0],[1419,17,1419,68,0],[1421,9,1421,10,0],[1424,9,1424,10,0],[1425,20,1425,85,0],[1426,13,1426,14,0],[1427,17,1427,93,0],[1429,17,1429,77,0],[1431,17,1431,62,0],[1433,9,1433,10,0],[1436,9,1436,10,0],[1437,20,1437,85,0],[1438,13,1438,14,0],[1439,17,1439,100,0],[1441,17,1441,74,0],[1442,17,1442,82,0],[1443,17,1443,85,0],[1444,17,1444,83,0],[1446,17,1446,52,0],[1448,9,1448,10,0],[1452,9,1452,10,1],[1453,13,1453,61,1],[1455,9,1455,10,1],[1458,9,1458,10,0],[1459,13,1459,61,0],[1460,9,1460,10,0],[1463,9,1463,10,1],[1464,20,1464,85,1],[1465,13,1465,14,1],[1466,17,1466,90,1],[1468,17,1468,85,1],[1470,17,1470,79,1],[1471,17,1471,81,1],[1473,17,1473,44,1],[1475,17,1475,166,1],[1477,9,1477,10,1],[1480,9,1480,10,0],[1481,20,1481,85,0],[1482,13,1482,14,0],[1483,17,1483,53,0],[1485,17,1485,179,0],[1486,17,1486,72,0],[1487,21,1487,28,0],[1487,30,1487,41,0],[1487,42,1487,44,0],[1487,45,1487,62,0],[1488,25,1488,68,0],[1490,17,1490,35,0],[1494,9,1494,10,0],[1704,9,1704,10,0],[1705,20,1705,85,0],[1706,13,1706,14,0],[1707,17,1707,64,0],[1708,17,1708,96,0],[1710,17,1710,85,0],[1712,24,1712,67,0],[1713,17,1713,18,0],[1714,21,1714,38,0],[1715,25,1715,73,0],[1716,17,1716,18,0],[1717,17,1717,35,0],[1719,9,1719,10,0],[1722,9,1722,10,0],[1723,20,1723,85,0],[1724,13,1724,14,0],[1725,17,1725,63,0],[1726,17,1726,95,0],[1728,17,1728,85,0],[1730,24,1730,67,0],[1731,17,1731,18,0],[1732,21,1732,38,0],[1733,25,1733,72,0],[1734,17,1734,18,0],[1735,17,1735,34,0],[1737,9,1737,10,0],[1743,9,1743,60,1],[1746,9,1746,10,0],[1747,20,1747,85,0],[1748,13,1748,14,0],[1750,17,1750,18,0],[1751,21,1751,84,0],[1752,21,1752,37,0],[1753,21,1753,90,0],[1755,21,1755,86,0],[1757,21,1757,62,0],[1759,21,1759,60,0],[1760,25,1760,61,0],[1761,21,1761,53,0],[1762,21,1762,22,0],[1763,25,1763,81,0],[1766,21,1766,90,0],[1795,17,1795,37,0],[1796,17,1796,18,0],[1797,21,1797,30,0],[1800,9,1800,10,0],[1803,9,1803,10,0],[1804,20,1804,85,0],[1805,13,1805,14,0],[1806,17,1806,94,0],[1807,17,1807,85,0],[1808,17,1808,62,0],[1810,9,1810,10,0],[1835,9,1835,10,0],[1836,20,1836,85,0],[1837,13,1837,14,0],[1838,17,1838,42,0],[1839,17,1839,45,0],[1840,17,1840,47,0],[1843,17,1843,93,0],[1845,17,1845,77,0],[1846,17,1846,81,0],[1848,17,1848,60,0],[1850,17,1850,41,0],[1852,17,1852,24,0],[1852,26,1852,36,0],[1852,37,1852,39,0],[1852,40,1852,47,0],[1853,17,1853,18,0],[1854,21,1854,39,0],[1855,17,1855,18,0],[1857,17,1857,42,0],[1859,17,1859,45,0],[1861,17,1861,66,0],[1862,21,1862,65,0],[1864,17,1864,98,0],[1866,17,1866,109,0],[1868,17,1868,115,0],[1870,17,1870,118,0],[1872,17,1872,115,0],[1874,17,1874,105,0],[1876,17,1876,107,0],[1878,17,1878,107,0],[1880,17,1880,113,0],[1882,17,1882,113,0],[1884,17,1884,113,0],[1886,17,1886,104,0],[1888,17,1888,116,0],[1890,17,1890,114,0],[1892,17,1892,106,0],[1904,17,1904,89,0],[1906,22,1906,31,0],[1906,33,1906,63,0],[1906,65,1906,68,0],[1907,17,1907,18,0],[1908,21,1908,42,0],[1910,21,1910,84,0],[1912,21,1912,91,0],[1914,21,1914,91,0],[1916,21,1916,110,0],[1918,21,1918,90,0],[1920,21,1920,69,0],[1921,21,1921,22,0],[1922,25,1922,102,0],[1923,21,1923,22,0],[1925,21,1925,96,0],[1927,21,1927,40,0],[1928,17,1928,18,0],[1930,17,1930,28,0],[1932,9,1932,10,0],[1971,9,1971,10,0],[1972,20,1972,85,0],[1973,13,1973,14,0],[1974,17,1975,123,0],[1976,17,1976,92,0],[1977,17,1977,85,0],[1979,9,1979,10,0],[1982,9,1982,10,0],[1983,20,1983,85,0],[1984,13,1984,14,0],[1985,17,1985,42,0],[1987,17,1987,45,0],[1988,17,1988,47,0],[1990,17,1990,91,0],[1991,17,1991,77,0],[1992,17,1992,85,0],[1993,17,1993,83,0],[1994,17,1994,73,0],[1995,17,1995,73,0],[1997,17,1997,39,0],[1998,17,1998,18,0],[1999,21,1999,85,0],[2000,21,2000,55,0],[2002,21,2002,58,0],[2003,21,2003,61,0],[2004,21,2004,67,0],[2005,21,2005,67,0],[2006,21,2006,61,0],[2007,21,2007,76,0],[2008,21,2008,72,0],[2009,21,2009,68,0],[2010,21,2010,80,0],[2011,21,2011,76,0],[2013,21,2013,65,0],[2014,21,2014,82,0],[2015,21,2015,89,0],[2016,21,2016,72,0],[2017,21,2017,101,0],[2018,21,2018,101,0],[2019,21,2019,95,0],[2020,21,2020,66,0],[2021,21,2021,82,0],[2022,21,2022,80,0],[2023,21,2023,68,0],[2024,21,2024,67,0],[2025,21,2025,94,0],[2026,21,2026,86,0],[2027,21,2027,78,0],[2028,21,2028,90,0],[2029,21,2029,83,0],[2030,21,2030,70,0],[2032,21,2032,28,0],[2032,30,2032,46,0],[2032,47,2032,49,0],[2032,50,2032,64,0],[2033,21,2033,22,0],[2034,25,2034,42,0],[2035,25,2035,65,0],[2036,25,2036,68,0],[2037,25,2037,83,0],[2038,25,2038,73,0],[2039,25,2039,68,0],[2040,25,2040,80,0],[2041,25,2041,68,0],[2042,25,2042,44,0],[2043,21,2043,22,0],[2044,17,2044,18,0],[2046,17,2046,18,0],[2049,21,2049,74,0],[2050,21,2050,45,0],[2052,21,2052,28,0],[2052,30,2052,40,0],[2052,41,2052,43,0],[2052,44,2052,51,0],[2053,21,2053,22,0],[2054,25,2054,43,0],[2055,21,2055,22,0],[2057,21,2057,46,0],[2059,21,2059,49,0],[2062,21,2062,98,0],[2063,25,2063,39,0],[2065,25,2065,104,0],[2067,21,2069,102,0],[2071,21,2073,108,0],[2075,21,2077,111,0],[2079,21,2083,97,0],[2085,21,2087,98,0],[2089,21,2091,100,0],[2093,21,2095,100,0],[2097,21,2097,100,0],[2099,21,2099,99,0],[2100,25,2100,40,0],[2102,25,2102,107,0],[2104,21,2104,105,0],[2105,25,2105,46,0],[2107,25,2107,119,0],[2109,21,2109,102,0],[2110,25,2110,43,0],[2112,25,2112,112,0],[2120,21,2120,111,0],[2121,25,2121,61,0],[2123,25,2124,113,0],[2126,21,2126,108,0],[2127,25,2127,58,0],[2129,25,2130,110,0],[2133,21,2133,93,0],[2135,26,2135,35,0],[2135,37,2135,67,0],[2135,69,2135,72,0],[2136,21,2136,22,0],[2137,25,2137,42,0],[2139,25,2139,85,0],[2140,29,2140,42,0],[2142,29,2142,90,0],[2144,25,2146,84,0],[2148,25,2150,84,0],[2152,25,2152,96,0],[2153,29,2153,53,0],[2155,29,2155,113,0],[2157,25,2157,86,0],[2158,29,2158,43,0],[2160,29,2160,93,0],[2162,25,2162,91,0],[2163,29,2163,48,0],[2165,29,2165,102,0],[2167,25,2167,95,0],[2168,29,2168,54,0],[2170,29,2170,113,0],[2172,25,2172,44,0],[2174,25,2174,44,0],[2175,21,2175,22,0],[2176,17,2176,18,0],[2177,17,2177,28,0],[2179,9,2179,10,0],[2220,9,2220,10,0],[2221,20,2221,85,0],[2222,13,2222,14,0],[2223,17,2223,80,0],[2224,17,2224,81,0],[2225,17,2225,76,0],[2226,17,2226,62,0],[2228,9,2228,10,0],[2231,9,2231,10,0],[2232,20,2232,85,0],[2233,13,2233,14,0],[2234,17,2234,80,0],[2235,17,2235,81,0],[2236,17,2236,79,0],[2237,17,2237,62,0],[2239,9,2239,10,0],[2242,9,2242,10,0],[2243,20,2243,85,0],[2244,13,2244,14,0],[2245,17,2245,80,0],[2246,17,2246,81,0],[2247,17,2247,79,0],[2248,17,2248,62,0],[2250,9,2250,10,0],[2259,9,2259,10,0],[2260,20,2260,85,0],[2261,13,2261,14,0],[2264,17,2264,95,0],[2265,17,2265,38,0],[2266,17,2266,18,0],[2267,21,2267,90,0],[2268,17,2268,18,0],[2269,17,2269,36,0],[2270,17,2270,18,0],[2271,21,2271,95,0],[2272,17,2272,18,0],[2273,17,2273,72,0],[2274,17,2274,18,0],[2275,21,2275,91,0],[2276,17,2276,18,0],[2277,17,2277,68,0],[2278,17,2278,18,0],[2279,21,2279,89,0],[2280,17,2280,18,0],[2281,17,2281,39,0],[2282,17,2282,18,0],[2283,21,2283,88,0],[2284,17,2284,18,0],[2285,17,2285,73,0],[2286,17,2286,18,0],[2287,21,2287,92,0],[2288,17,2288,18,0],[2289,17,2289,63,0],[2290,17,2290,30,0],[2292,9,2292,10,0],[2296,9,2296,10,0],[2297,20,2297,85,0],[2298,13,2298,14,0],[2301,17,2301,92,0],[2303,17,2303,63,0],[2305,17,2305,30,0],[2307,9,2307,10,0],[2312,9,2312,10,0],[2313,20,2313,85,0],[2314,13,2314,14,0],[2315,17,2315,98,0],[2317,17,2317,95,0],[2318,17,2318,36,0],[2319,17,2319,18,0],[2320,21,2320,95,0],[2321,17,2321,18,0],[2322,17,2322,41,0],[2323,17,2323,18,0],[2324,21,2324,91,0],[2325,17,2325,18,0],[2326,17,2326,37,0],[2327,17,2327,18,0],[2328,21,2328,89,0],[2329,17,2329,18,0],[2330,17,2330,39,0],[2331,17,2331,18,0],[2332,21,2332,88,0],[2333,17,2333,18,0],[2334,17,2334,42,0],[2335,17,2335,18,0],[2336,21,2336,92,0],[2337,17,2337,18,0],[2339,17,2339,77,0],[2341,17,2341,52,0],[2343,9,2343,10,0],[2346,9,2346,10,0],[2347,20,2347,85,0],[2348,13,2348,14,0],[2349,17,2349,43,0],[2350,17,2350,37,0],[2350,38,2350,55,0],[2352,17,2352,98,0],[2354,17,2355,97,0],[2357,17,2357,96,0],[2359,9,2359,10,0],[2364,9,2364,10,0],[2365,13,2365,148,0],[2366,9,2366,10,0],[2369,9,2369,10,1],[2370,13,2370,140,1],[2371,9,2371,10,1],[2374,9,2374,10,0],[2375,13,2375,33,0],[2376,13,2376,79,0],[2378,13,2378,188,0],[2380,13,2380,55,0],[2381,17,2381,69,0],[2383,13,2383,32,0],[2384,9,2384,10,0],[2387,9,2387,10,0],[2388,13,2388,33,0],[2389,13,2389,79,0],[2390,13,2390,163,0],[2392,13,2392,55,0],[2393,17,2393,69,0],[2395,13,2395,32,0],[2396,9,2396,10,0],[2399,9,2399,10,0],[2400,13,2400,176,0],[2401,9,2401,10,0],[2407,9,2407,10,1],[2408,20,2408,85,1],[2409,13,2409,14,1],[2410,17,2410,121,1],[2412,17,2412,52,1],[2414,9,2414,10,1],[2416,9,2416,10,0],[2417,20,2417,85,0],[2418,13,2418,14,0],[2419,17,2419,144,0],[2421,17,2421,52,0],[2423,9,2423,10,0],[2426,9,2426,10,1],[2427,20,2427,85,1],[2428,13,2428,14,1],[2429,17,2429,120,1],[2431,17,2431,52,1],[2433,9,2433,10,1],[2436,9,2436,10,0],[2437,20,2437,85,0],[2438,13,2438,14,0],[2439,17,2439,94,0],[2440,17,2440,86,0],[2441,17,2441,82,0],[2443,17,2443,62,0],[2445,9,2445,10,0],[2448,9,2448,10,0],[2449,20,2449,85,0],[2450,13,2450,14,0],[2451,17,2451,88,0],[2452,17,2452,83,0],[2453,17,2453,94,0],[2454,17,2454,89,0],[2455,17,2455,115,0],[2456,17,2456,77,0],[2458,17,2458,52,0],[2461,9,2461,10,0],[2464,9,2464,10,0],[2465,20,2465,85,0],[2466,13,2466,14,0],[2467,17,2467,88,0],[2468,17,2468,85,0],[2469,17,2469,52,0],[2471,9,2471,10,0],[2474,9,2474,10,0],[2475,13,2476,96,0],[2477,9,2477,10,0],[2480,9,2480,10,0],[2481,13,2483,117,0],[2484,9,2484,10,0],[2487,9,2487,10,0],[2489,13,2492,43,0],[2493,9,2493,10,0],[2496,9,2496,10,0],[2497,13,2499,86,0],[2500,9,2500,10,0],[2503,9,2503,10,1],[2504,13,2506,97,1],[2507,9,2507,10,1],[2510,9,2510,10,1],[2511,13,2513,97,1],[2514,9,2514,10,1],[2517,9,2517,10,0],[2518,13,2519,88,0],[2520,9,2520,10,0],[2523,9,2523,10,0],[2524,13,2524,57,0],[2525,13,2526,112,0],[2527,13,2527,119,0],[2528,9,2528,10,0],[2537,9,2537,10,0],[2538,13,2538,28,0],[2539,13,2539,27,0],[2540,13,2540,14,0],[2541,17,2541,67,0],[2542,17,2544,33,0],[2545,17,2545,71,0],[2546,13,2546,14,0],[2547,13,2547,27,0],[2548,9,2548,10,0],[2551,9,2551,10,1],[2552,13,2555,70,1],[2556,9,2556,10,1],[2559,9,2559,10,0],[2560,13,2562,133,0],[2563,9,2563,10,0],[2566,9,2566,10,0],[2568,13,2568,153,0],[2569,9,2569,10,0],[2572,9,2572,10,0],[2573,13,2573,180,0],[2574,9,2574,10,0],[2577,9,2577,10,1],[2578,13,2578,150,1],[2579,9,2579,10,1],[2584,9,2584,10,1],[2585,13,2585,155,1],[2586,9,2586,10,1],[2591,9,2591,10,0],[2592,13,2592,131,0],[2593,9,2593,10,0],[2596,9,2596,10,0],[2597,13,2597,55,0],[2599,13,2599,162,0],[2600,13,2600,83,0],[2601,13,2601,14,0],[2602,17,2602,51,0],[2603,13,2603,14,0],[2605,13,2605,24,0],[2606,9,2606,10,0],[2609,9,2609,10,0],[2610,13,2610,140,0],[2611,9,2611,10,0],[2614,9,2614,10,0],[2615,13,2615,156,0],[2616,9,2616,10,0],[2619,9,2619,10,1],[2620,13,2620,34,1],[2622,13,2622,160,1],[2623,13,2623,64,1],[2624,17,2624,32,1],[2626,13,2626,28,1],[2627,9,2627,10,1],[2630,9,2630,10,0],[2632,13,2632,142,0],[2634,13,2634,29,0],[2635,17,2635,39,0],[2637,13,2637,23,0],[2638,9,2638,10,0],[2641,9,2641,10,0],[2642,13,2642,136,0],[2644,9,2644,10,0],[2647,9,2647,10,0],[2648,13,2648,141,0],[2650,9,2650,10,0],[2653,9,2653,10,0],[2654,13,2654,138,0],[2656,9,2656,10,0],[2659,9,2659,10,0],[2660,13,2662,102,0],[2663,9,2663,10,0],[2666,9,2666,10,0],[2667,13,2667,156,0],[2668,9,2668,10,0],[2671,9,2671,10,0],[2672,13,2674,119,0],[2675,9,2675,10,0],[2678,9,2678,10,1],[2679,13,2679,137,1],[2680,9,2680,10,1],[2683,9,2683,10,0],[2684,13,2684,136,0],[2685,9,2685,10,0],[2688,9,2688,10,0],[2689,13,2689,167,0],[2690,9,2690,10,0],[2693,9,2693,10,0],[2694,13,2694,176,0],[2695,9,2695,10,0],[2698,9,2698,10,0],[2699,13,2699,144,0],[2700,9,2700,10,0],[2703,9,2703,10,0],[2704,13,2704,139,0],[2705,9,2705,10,0]]);
    </script>
  </body>
</html>