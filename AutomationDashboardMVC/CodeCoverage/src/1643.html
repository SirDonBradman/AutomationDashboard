<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Aurigo.Brix.JavaScriptRuntime\Hosting\Native.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
namespace ChakraHost.Hosting
{
    using System;
    using System.Diagnostics.CodeAnalysis;
    using System.Runtime.InteropServices;

    /// &lt;summary&gt;
    ///     Native interfaces.
    /// &lt;/summary&gt;
    public static class Native
    {
        /// &lt;summary&gt;
        ///     Event mask for profiling.
        /// &lt;/summary&gt;
        public enum ProfilerEventMask
        {
            /// &lt;summary&gt;
            ///     Trace calls to script functions.
            /// &lt;/summary&gt;
            TraceScriptFunctionCall = 0x1,

            /// &lt;summary&gt;
            ///     Trace calls to built-in functions.
            /// &lt;/summary&gt;
            TraceNativeFunctionCall = 0x2,

            /// &lt;summary&gt;
            ///     Trace calls to DOM methods.
            /// &lt;/summary&gt;
            TraceDomFunctionCall = 0x4,

            /// &lt;summary&gt;
            ///     Trace all calls except DOM methods.
            /// &lt;/summary&gt;
            TraceAll = (TraceScriptFunctionCall | TraceNativeFunctionCall),

            /// &lt;summary&gt;
            ///     Trace all calls.
            /// &lt;/summary&gt;
            TraceAllWithDom = (TraceAll | TraceDomFunctionCall)
        }

        /// &lt;summary&gt;
        ///     Profiled script type.
        /// &lt;/summary&gt;
        public enum ProfilerScriptType
        {
            /// &lt;summary&gt;
            ///     A user script.
            /// &lt;/summary&gt;
            User,

            /// &lt;summary&gt;
            ///     A dynamic script.
            /// &lt;/summary&gt;
            Dynamic,

            /// &lt;summary&gt;
            ///     A native script.
            /// &lt;/summary&gt;
            Native,

            /// &lt;summary&gt;
            ///     A DOM-related script.
            /// &lt;/summary&gt;
            Dom
        }

        /// &lt;summary&gt;
        ///     IProcessDebugManager32 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;51973C2f-CB0C-11d0-B5C9-00A0244A0E7A&quot;)]
        [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IProcessDebugManager32
        {
            /// &lt;summary&gt;
            ///     Creates a new debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The new debug application.&lt;/param&gt;
            void CreateApplication(out IDebugApplication32 debugApplication);

            /// &lt;summary&gt;
            ///     Gets the default debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The default debug application.&lt;/param&gt;
            void GetDefaultApplication(out IDebugApplication32 debugApplication);

            /// &lt;summary&gt;
            ///     Adds a new debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The new debug application.&lt;/param&gt;
            /// &lt;param name=&quot;cookie&quot;&gt;An engine-defined cookie.&lt;/param&gt;
            void AddApplication(IDebugApplication32 debugApplication, out uint cookie);

            /// &lt;summary&gt;
            ///     Removes a debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;cookie&quot;&gt;The cookie of the debug application to remove.&lt;/param&gt;
            void RemoveApplication(uint cookie);

            /// &lt;summary&gt;
            ///     Creates a debug document helper.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;outerUnknown&quot;&gt;The outer unknown.&lt;/param&gt;
            /// &lt;param name=&quot;helper&quot;&gt;The new debug document helper.&lt;/param&gt;
            void CreateDebugDocumentHelper(object outerUnknown, out IDebugDocumentHelper32 helper);
        }

        /// &lt;summary&gt;
        ///     IProcessDebugManager64 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;56b9fC1C-63A9-4CC1-AC21-087D69A17FAB&quot;)]
        [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IProcessDebugManager64
        {
            /// &lt;summary&gt;
            ///     Creates a new debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The new debug application.&lt;/param&gt;
            void CreateApplication(out IDebugApplication64 debugApplication);

            /// &lt;summary&gt;
            ///     Gets the default debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The default debug application.&lt;/param&gt;
            void GetDefaultApplication(out IDebugApplication64 debugApplication);

            /// &lt;summary&gt;
            ///     Adds a new debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;debugApplication&quot;&gt;The new debug application.&lt;/param&gt;
            /// &lt;param name=&quot;cookie&quot;&gt;An engine-defined cookie.&lt;/param&gt;
            void AddApplication(IDebugApplication64 debugApplication, out uint cookie);

            /// &lt;summary&gt;
            ///     Removes a debug application.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;cookie&quot;&gt;The cookie of the debug application to remove.&lt;/param&gt;
            void RemoveApplication(uint cookie);

            /// &lt;summary&gt;
            ///     Creates a debug document helper.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;outerUnknown&quot;&gt;The outer unknown.&lt;/param&gt;
            /// &lt;param name=&quot;helper&quot;&gt;The new debug document helper.&lt;/param&gt;
            void CreateDebugDocumentHelper(object outerUnknown, out IDebugDocumentHelper64 helper);
        }

        /// &lt;summary&gt;
        ///     IDebugApplication32 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;51973C32-CB0C-11d0-B5C9-00A0244A0E7A&quot;)]
        public interface IDebugApplication32
        {
        }

        /// &lt;summary&gt;
        ///     IDebugApplication64 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;4dedc754-04c7-4f10-9e60-16a390fe6e62&quot;)]
        public interface IDebugApplication64
        {
        }

        /// &lt;summary&gt;
        ///     IDebugDocumentHelper32 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;51973C26-CB0C-11d0-B5C9-00A0244A0E7A&quot;)]
        public interface IDebugDocumentHelper32
        {
        }

        /// &lt;summary&gt;
        ///     IDebugDocumentHelper64 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;c4c7363c-20fd-47f9-bd82-4855e0150871&quot;)]
        public interface IDebugDocumentHelper64
        {
        }

        /// &lt;summary&gt;
        ///     IActiveScriptProfilerCallback COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;740eca23-7d9d-42e5-ba9d-f8b24b1c7a9b&quot;)]
        [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
        public interface IActiveScriptProfilerCallback
        {
            /// &lt;summary&gt;
            ///     Called when the profile is started.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;context&quot;&gt;The context provided when profiling was started.&lt;/param&gt;
            void Initialize(uint context);

            /// &lt;summary&gt;
            ///     Called when profiling is stopped.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;reason&quot;&gt;The reason code provided when profiling was stopped.&lt;/param&gt;
            void Shutdown(uint reason);

            /// &lt;summary&gt;
            ///     Called when a script is compiled.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;scriptId&quot;&gt;The ID of the script.&lt;/param&gt;
            /// &lt;param name=&quot;type&quot;&gt;The type of the script.&lt;/param&gt;
            /// &lt;param name=&quot;debugDocumentContext&quot;&gt;The debug document context, if any.&lt;/param&gt;
            void ScriptCompiled(int scriptId, ProfilerScriptType type, IntPtr debugDocumentContext);

            /// &lt;summary&gt;
            ///     Called when a function is compiled.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;functionId&quot;&gt;The ID of the function.&lt;/param&gt;
            /// &lt;param name=&quot;scriptId&quot;&gt;The ID of the script.&lt;/param&gt;
            /// &lt;param name=&quot;functionName&quot;&gt;The name of the function.&lt;/param&gt;
            /// &lt;param name=&quot;functionNameHint&quot;&gt;The function name hint.&lt;/param&gt;
            /// &lt;param name=&quot;debugDocumentContext&quot;&gt;The debug document context, if any.&lt;/param&gt;
            void FunctionCompiled(int functionId, int scriptId, [MarshalAs(UnmanagedType.LPWStr)] string functionName, [MarshalAs(UnmanagedType.LPWStr)] string functionNameHint, IntPtr debugDocumentContext);

            /// &lt;summary&gt;
            ///     Called when a function is entered.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;scriptId&quot;&gt;The ID of the script.&lt;/param&gt;
            /// &lt;param name=&quot;functionId&quot;&gt;The ID of the function.&lt;/param&gt;
            void OnFunctionEnter(int scriptId, int functionId);

            /// &lt;summary&gt;
            ///     Called when a function is exited.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;scriptId&quot;&gt;The ID of the script.&lt;/param&gt;
            /// &lt;param name=&quot;functionId&quot;&gt;The ID of the function.&lt;/param&gt;
            void OnFunctionExit(int scriptId, int functionId);
        }

        /// &lt;summary&gt;
        ///     IActiveScriptProfilerCallback2 COM interface.
        /// &lt;/summary&gt;
        [Guid(&quot;31B7F8AD-A637-409C-B22F-040995B6103D&quot;)]
        public interface IActiveScriptProfilerCallback2 : IActiveScriptProfilerCallback
        {
            /// &lt;summary&gt;
            ///     Called when a function is entered by name.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;functionName&quot;&gt;The name of the function.&lt;/param&gt;
            /// &lt;param name=&quot;type&quot;&gt;The type of the function.&lt;/param&gt;
            void OnFunctionEnterByName(string functionName, ProfilerScriptType type);

            /// &lt;summary&gt;
            ///     Called when a function is exited by name.
            /// &lt;/summary&gt;
            /// &lt;param name=&quot;functionName&quot;&gt;The name of the function.&lt;/param&gt;
            /// &lt;param name=&quot;type&quot;&gt;The type of the function.&lt;/param&gt;
            void OnFunctionExitByName(string functionName, ProfilerScriptType type);
        }

        /// &lt;summary&gt;
        ///     IActiveScriptProfilerHeapEnum COM interface.
        /// &lt;/summary&gt;
        [SuppressMessage(&quot;StyleCop.CSharp.DocumentationRules&quot;, &quot;SA1650:ElementDocumentationMustBeSpelledCorrectly&quot;, Justification = &quot;Name defined in COM.&quot;)]
        [Guid(&quot;32E4694E-0D37-419B-B93D-FA20DED6E8EA&quot;)]
        public interface IActiveScriptProfilerHeapEnum
        {
        }

        /// &lt;summary&gt;
        /// Throws if a native method returns an error code.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;error&quot;&gt;The error.&lt;/param&gt;
        internal static void ThrowIfError(JavaScriptErrorCode error)
        {
            if (error != JavaScriptErrorCode.NoError)
            {
                switch (error)
                {
                    case JavaScriptErrorCode.InvalidArgument:
                        throw new JavaScriptUsageException(error, &quot;Invalid argument.&quot;);

                    case JavaScriptErrorCode.NullArgument:
                        throw new JavaScriptUsageException(error, &quot;Null argument.&quot;);

                    case JavaScriptErrorCode.NoCurrentContext:
                        throw new JavaScriptUsageException(error, &quot;No current context.&quot;);

                    case JavaScriptErrorCode.InExceptionState:
                        throw new JavaScriptUsageException(error, &quot;Runtime is in exception state.&quot;);

                    case JavaScriptErrorCode.NotImplemented:
                        throw new JavaScriptUsageException(error, &quot;Method is not implemented.&quot;);

                    case JavaScriptErrorCode.WrongThread:
                        throw new JavaScriptUsageException(error, &quot;Runtime is active on another thread.&quot;);

                    case JavaScriptErrorCode.RuntimeInUse:
                        throw new JavaScriptUsageException(error, &quot;Runtime is in use.&quot;);

                    case JavaScriptErrorCode.BadSerializedScript:
                        throw new JavaScriptUsageException(error, &quot;Bad serialized script.&quot;);

                    case JavaScriptErrorCode.InDisabledState:
                        throw new JavaScriptUsageException(error, &quot;Runtime is disabled.&quot;);

                    case JavaScriptErrorCode.CannotDisableExecution:
                        throw new JavaScriptUsageException(error, &quot;Cannot disable execution.&quot;);

                    case JavaScriptErrorCode.AlreadyDebuggingContext:
                        throw new JavaScriptUsageException(error, &quot;Context is already in debug mode.&quot;);

                    case JavaScriptErrorCode.HeapEnumInProgress:
                        throw new JavaScriptUsageException(error, &quot;Heap enumeration is in progress.&quot;);

                    case JavaScriptErrorCode.ArgumentNotObject:
                        throw new JavaScriptUsageException(error, &quot;Argument is not an object.&quot;);

                    case JavaScriptErrorCode.InProfileCallback:
                        throw new JavaScriptUsageException(error, &quot;In a profile callback.&quot;);

                    case JavaScriptErrorCode.InThreadServiceCallback:
                        throw new JavaScriptUsageException(error, &quot;In a thread service callback.&quot;);

                    case JavaScriptErrorCode.CannotSerializeDebugScript:
                        throw new JavaScriptUsageException(error, &quot;Cannot serialize a debug script.&quot;);

                    case JavaScriptErrorCode.AlreadyProfilingContext:
                        throw new JavaScriptUsageException(error, &quot;Already profiling this context.&quot;);

                    case JavaScriptErrorCode.IdleNotEnabled:
                        throw new JavaScriptUsageException(error, &quot;Idle is not enabled.&quot;);

                    case JavaScriptErrorCode.OutOfMemory:
                        throw new JavaScriptEngineException(error, &quot;Out of memory.&quot;);

                    case JavaScriptErrorCode.ScriptException:
                        {
                            JavaScriptValue errorObject;
                            JavaScriptErrorCode innerError = JsGetAndClearException(out errorObject);

                            if (innerError != JavaScriptErrorCode.NoError)
                            {
                                throw new JavaScriptFatalException(innerError);
                            }

                            throw new JavaScriptScriptException(error, errorObject, &quot;Script threw an exception.&quot;);
                        }

                    case JavaScriptErrorCode.ScriptCompile:
                        {
                            JavaScriptValue errorObject;
                            JavaScriptErrorCode innerError = JsGetAndClearException(out errorObject);

                            if (innerError != JavaScriptErrorCode.NoError)
                            {
                                throw new JavaScriptFatalException(innerError);
                            }

                            throw new JavaScriptScriptException(error, errorObject, &quot;Compile error.&quot;);
                        }

                    case JavaScriptErrorCode.ScriptTerminated:
                        throw new JavaScriptScriptException(error, JavaScriptValue.Invalid, &quot;Script was terminated.&quot;);

                    case JavaScriptErrorCode.ScriptEvalDisabled:
                        throw new JavaScriptScriptException(error, JavaScriptValue.Invalid, &quot;Eval of strings is disabled in this runtime.&quot;);

                    case JavaScriptErrorCode.Fatal:
                        throw new JavaScriptFatalException(error);

                    default:
                        throw new JavaScriptFatalException(error);
                }
            }
        }

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateRuntime(JavaScriptRuntimeAttributes attributes, JavaScriptRuntimeVersion runtimeVersion, JavaScriptThreadServiceCallback threadService, out JavaScriptRuntime runtime);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCollectGarbage(JavaScriptRuntime handle);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDisposeRuntime(JavaScriptRuntime handle);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetRuntimeMemoryUsage(JavaScriptRuntime runtime, out UIntPtr memoryUsage);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetRuntimeMemoryLimit(JavaScriptRuntime runtime, out UIntPtr memoryLimit);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetRuntimeMemoryLimit(JavaScriptRuntime runtime, UIntPtr memoryLimit);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetRuntimeMemoryAllocationCallback(JavaScriptRuntime runtime, IntPtr callbackState, JavaScriptMemoryAllocationCallback allocationCallback);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetRuntimeBeforeCollectCallback(JavaScriptRuntime runtime, IntPtr callbackState, JavaScriptBeforeCollectCallback beforeCollectCallback);

        [DllImport(&quot;jscript9.dll&quot;, EntryPoint = &quot;JsAddRef&quot;)]
        internal static extern JavaScriptErrorCode JsContextAddRef(JavaScriptContext reference, out uint count);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsAddRef(JavaScriptValue reference, out uint count);

        [DllImport(&quot;jscript9.dll&quot;, EntryPoint = &quot;JsRelease&quot;)]
        internal static extern JavaScriptErrorCode JsContextRelease(JavaScriptContext reference, out uint count);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsRelease(JavaScriptValue reference, out uint count);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateContext(JavaScriptRuntime runtime, IDebugApplication64 debugSite, out JavaScriptContext newContext);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateContext(JavaScriptRuntime runtime, IDebugApplication32 debugSite, out JavaScriptContext newContext);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetCurrentContext(out JavaScriptContext currentContext);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetCurrentContext(JavaScriptContext context);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetRuntime(JavaScriptContext context, out JavaScriptRuntime runtime);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStartDebugging(IDebugApplication64 debugApplication);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStartDebugging(IDebugApplication32 debugApplication);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsIdle(out uint nextIdleTick);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsParseScript(string script, JavaScriptSourceContext sourceContext, string sourceUrl, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsRunScript(string script, JavaScriptSourceContext sourceContext, string sourceUrl, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSerializeScript(string script, byte[] buffer, ref ulong bufferSize);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsParseSerializedScript(string script, byte[] buffer, JavaScriptSourceContext sourceContext, string sourceUrl, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsRunSerializedScript(string script, byte[] buffer, JavaScriptSourceContext sourceContext, string sourceUrl, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetPropertyIdFromName(string name, out JavaScriptPropertyId propertyId);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetPropertyNameFromId(JavaScriptPropertyId propertyId, out string name);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetUndefinedValue(out JavaScriptValue undefinedValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetNullValue(out JavaScriptValue nullValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetTrueValue(out JavaScriptValue trueValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetFalseValue(out JavaScriptValue falseValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsBoolToBoolean(bool value, out JavaScriptValue booleanValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsBooleanToBool(JavaScriptValue booleanValue, out bool boolValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsConvertValueToBoolean(JavaScriptValue value, out JavaScriptValue booleanValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetValueType(JavaScriptValue value, out JavaScriptValueType type);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDoubleToNumber(double doubleValue, out JavaScriptValue value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsIntToNumber(int intValue, out JavaScriptValue value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsNumberToDouble(JavaScriptValue value, out double doubleValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsConvertValueToNumber(JavaScriptValue value, out JavaScriptValue numberValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetStringLength(JavaScriptValue sringValue, out int length);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsPointerToString(string value, UIntPtr stringLength, out JavaScriptValue stringValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStringToPointer(JavaScriptValue value, out IntPtr stringValue, out UIntPtr stringLength);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsConvertValueToString(JavaScriptValue value, out JavaScriptValue stringValue);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsVariantToValue([MarshalAs(UnmanagedType.Struct)] ref object var, out JavaScriptValue value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsValueToVariant(JavaScriptValue obj, [MarshalAs(UnmanagedType.Struct)] out object var);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetGlobalObject(out JavaScriptValue globalObject);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateObject(out JavaScriptValue obj);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateExternalObject(IntPtr data, JavaScriptObjectFinalizeCallback finalizeCallback, out JavaScriptValue obj);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsConvertValueToObject(JavaScriptValue value, out JavaScriptValue obj);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetPrototype(JavaScriptValue obj, out JavaScriptValue prototypeObject);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetPrototype(JavaScriptValue obj, JavaScriptValue prototypeObject);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetExtensionAllowed(JavaScriptValue obj, out bool value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsPreventExtension(JavaScriptValue obj);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetProperty(JavaScriptValue obj, JavaScriptPropertyId propertyId, out JavaScriptValue value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetOwnPropertyDescriptor(JavaScriptValue obj, JavaScriptPropertyId propertyId, out JavaScriptValue propertyDescriptor);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetOwnPropertyNames(JavaScriptValue obj, out JavaScriptValue propertyNames);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetProperty(JavaScriptValue obj, JavaScriptPropertyId propertyId, JavaScriptValue value, bool useStrictRules);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsHasProperty(JavaScriptValue obj, JavaScriptPropertyId propertyId, out bool hasProperty);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDeleteProperty(JavaScriptValue obj, JavaScriptPropertyId propertyId, bool useStrictRules, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDefineProperty(JavaScriptValue obj, JavaScriptPropertyId propertyId, JavaScriptValue propertyDescriptor, out bool result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsHasIndexedProperty(JavaScriptValue obj, JavaScriptValue index, out bool result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetIndexedProperty(JavaScriptValue obj, JavaScriptValue index, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetIndexedProperty(JavaScriptValue obj, JavaScriptValue index, JavaScriptValue value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDeleteIndexedProperty(JavaScriptValue obj, JavaScriptValue index);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsEquals(JavaScriptValue obj1, JavaScriptValue obj2, out bool result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStrictEquals(JavaScriptValue obj1, JavaScriptValue obj2, out bool result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsHasExternalData(JavaScriptValue obj, out bool value);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetExternalData(JavaScriptValue obj, out IntPtr externalData);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetExternalData(JavaScriptValue obj, IntPtr externalData);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateArray(uint length, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCallFunction(JavaScriptValue function, JavaScriptValue[] arguments, ushort argumentCount, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsConstructObject(JavaScriptValue function, JavaScriptValue[] arguments, ushort argumentCount, out JavaScriptValue result);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateFunction(JavaScriptNativeFunction nativeFunction, IntPtr externalData, out JavaScriptValue function);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateRangeError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateReferenceError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateSyntaxError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateTypeError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsCreateURIError(JavaScriptValue message, out JavaScriptValue error);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsHasException(out bool hasException);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsGetAndClearException(out JavaScriptValue exception);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsSetException(JavaScriptValue exception);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsDisableRuntimeExecution(JavaScriptRuntime runtime);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsEnableRuntimeExecution(JavaScriptRuntime runtime);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsIsRuntimeExecutionDisabled(JavaScriptRuntime runtime, out bool isDisabled);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStartProfiling(IActiveScriptProfilerCallback callback, ProfilerEventMask eventMask, int context);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsStopProfiling(int reason);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsEnumerateHeap(out IActiveScriptProfilerHeapEnum enumerator);

        [DllImport(&quot;jscript9.dll&quot;, CharSet = CharSet.Unicode)]
        internal static extern JavaScriptErrorCode JsIsEnumeratingHeap(out bool isEnumeratingHeap);

        /// &lt;summary&gt;
        ///     ProcessDebugManager COM interface.
        /// &lt;/summary&gt;
        [ComImport]
        [Guid(&quot;78A51822-51F4-11D0-8F20-00805F2CD064&quot;)]
        public class ProcessDebugManager
        {
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[268,9,268,10,0],[269,13,269,54,0],[270,13,270,14,0],[271,17,271,31,0],[274,25,274,88,0],[277,25,277,85,0],[280,25,280,90,0],[283,25,283,101,0],[286,25,286,97,0],[289,25,289,107,0],[292,25,292,89,0],[295,25,295,93,0],[298,25,298,91,0],[301,25,301,96,0],[304,25,304,104,0],[307,25,307,103,0],[310,25,310,97,0],[313,25,313,93,0],[316,25,316,100,0],[319,25,319,103,0],[322,25,322,102,0],[325,25,325,91,0],[328,25,328,86,0],[331,25,331,26,0],[333,29,333,102,0],[335,29,335,75,0],[336,29,336,30,0],[337,33,337,80,0],[340,29,340,115,0],[344,25,344,26,0],[346,29,346,102,0],[348,29,348,75,0],[349,29,349,30,0],[350,33,350,80,0],[353,29,353,103,0],[357,25,357,119,0],[360,25,360,141,0],[363,25,363,67,0],[366,25,366,67,0],[369,9,369,10,0]]);
    </script>
  </body>
</html>