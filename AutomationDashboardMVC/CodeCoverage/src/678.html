<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\ProjectManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.BusinessLayer.BL;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.DocumentManagementBL;
using Aurigo.AMP3.DocumentManagementDTO;
using Aurigo.AMP3.LibraryBL;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectDAC;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.UserManagementBL;
using Aurigo.Brix.DataAccess.Core;
using Aurigo.Brix.Platform.BusinessLayer.AbstractModels;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Interfaces;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common;
using Aurigo.Common.Utility;
using CacheProvider;
using DataDynamics.ActiveReports;
using DataDynamics.ActiveReports.Export.Pdf;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;
using System.Xml;
using Aurigo.DataBinding;
using Aurigo.Brix.Platform.BusinessLayer.XmlForm_Framework;
using Aurigo.Brix.Platform.BusinessLayer.DataResouces;
using Aurigo.AMP3.LibraryDAC;

namespace Aurigo.AMP3.ProjectBL
{
    [Context(Name = Constants.MODID_PROJECT)]
    public class ProjectManager : SingletonManagerBase&lt;ProjectManager&gt;, IReports, IXmlTree, RecentItems, IFormSearch
    {

        public string BusinessUnit_Text { get { return LocalizationManager.GetString(&quot;BusinessUnit&quot;); } }
        public string Project_Text { get { return LocalizationManager.GetString(&quot;Project&quot;); } }

        private List&lt;string&gt; _docmgmtModuleComponents = null;
        private List&lt;string&gt; _projectModuleComponents = null;
        private Dictionary&lt;string, string&gt; _uploadedModuleList;
        private List&lt;string&gt; _coreModuleComponents = null;

        private List&lt;string&gt; DOCMGMTModuleComponents
        {
            get
            {
                _docmgmtModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_DOCMGMT);
                return _docmgmtModuleComponents;
            }
        }

        private List&lt;string&gt; ProjectModuleComponents
        {
            get
            {
                _projectModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_PROJECT);
                return _projectModuleComponents;
            }
        }

        public List&lt;string&gt; CoreModuleComponents
        {
            get
            {
                _coreModuleComponents = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                return _coreModuleComponents;
            }
        }

        private Dictionary&lt;string, string&gt; UploadedModuleList
        {
            get
            {
                if (_uploadedModuleList == null)
                    _uploadedModuleList = ModuleManager.Instance.GetModuleList();
                return _uploadedModuleList;
            }
        }

        public ProjectManager()
        {
        }

        private readonly string IMG_LEAF = &quot;~/Images/IcnPage.gif&quot;;
        private readonly string PLATFORM_KEY = &quot;W_W_WEB&quot;;

        #region IFormSearch Members

        public string GetCustomSearchCriteria()
        {
            throw new NotImplementedException();
        }

        public DataSet GetCustomSearchResults(string strQuery)
        {
            throw new NotImplementedException();
        }

        public void GetParentModuleDetails(DataTable dtResults, string parentIDKey)
        {
            if (dtResults.Columns.Contains(parentIDKey))
            {
                DataTable dt =
                    ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetDetailsByInvitedUsers, null,
                        UserDetail.GetCurrentUserDetail().UID,
                        UserDetail.GetCurrentUserDetail().RID).Tables[0];
                DataColumn dc = dtResults.Columns.Add(&quot;Project Name&quot;);
                dc.SetOrdinal(0);
                if (!dtResults.Columns.Contains(&quot;PID&quot;))
                {
                    dc = dtResults.Columns.Add(&quot;PID&quot;);
                    dc.SetOrdinal(1);
                }
                foreach (DataRow dr in dtResults.Rows)
                {
                    DataRow[] rows = dt.Select(string.Format(&quot;PID={0}&quot;, dr[parentIDKey]));
                    if (rows.Length &gt; 0)
                    {
                        DataRow drContract = rows[0];
                        dr[&quot;Project Name&quot;] = drContract[&quot;Project Name&quot;];
                        dr[&quot;PID&quot;] = drContract[&quot;PID&quot;];
                    }
                    else
                        dr.Delete();
                }

                dtResults.AcceptChanges();
            }
        }

        #endregion

        #region IXmlTree Members

        public TNode GetXmlForTree(int projectId, int userId, int roleId, string platform)
        {
            return GetProjectForTree(projectId, userId, roleId);
        }

        string IXmlTree.ActiveTab
        {
            get
            {
                string projectTab = LocalizationManager.GetString(&quot;ProjectTab&quot;);
                bool isPlaning = HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;;
                return isPlaning
                    ? LocalizationManager.GetString(&quot;Planning&quot;)
                    : (projectTab.Equals(&quot;ProjectTab&quot;, StringComparison.CurrentCultureIgnoreCase) ?
                                        LocalizationManager.GetString(&quot;Project&quot;) + &quot;s&quot; :
                                        projectTab);
            }
            set { }
        }

        string IXmlTree.ModuleID
        {
            get { return &quot;PROJECT&quot;; }
            set { }
        }

        public Dictionary&lt;string, string&gt; GetTreeForMobile(int projectID, int instanceId, int userId, int roleId)
        {
            Dictionary&lt;string, string&gt; modules = new Dictionary&lt;string, string&gt;();

            DataSet dtModules = ProjectComponent.Instance.GetProjectTreeForMobile(projectID, userId, roleId);
            if (dtModules != null &amp;&amp; dtModules.Tables.Count &gt; 0)
                foreach (DataRow row in dtModules.Tables[0].Rows)
                {
                    modules.Add(row[&quot;ModuleID&quot;].ToString(), row[&quot;ModuleName&quot;].ToString());
                }
            return modules;
        }

        #endregion

        #region RecentItems Members

        public string GetRecentItem(int p, int p_2, int p_3, bool p_4, string p_5)
        {
            return GetRecentProjects(p, p_2, p_3, p_4, p_5);
        }

        public DataTable GetItemSummary()
        {
            return GetProjectSummary();
        }

        #endregion

        /// &lt;summary&gt;
        /// This displays the modules for a project in the details view.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectId&quot;&gt;&lt;/param&gt;
        public List&lt;Platform&gt; GetProjectModules(int ProjectId)
        {
            return ProjectComponent.Instance.GetProjectDetails(ProjectId).ProjectModules;
        }

        /// &lt;summary&gt;
        /// Returns the ProjectList as a Datatable.Used in the ProjectsList.aspx
        /// &lt;/summary&gt;
        public DataTable GetProjects()
        {
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            return GetProjects(null, ud.UID, ud.RID);
        }

        /// &lt;summary&gt;
        /// Returns the ProectList based on the provided filter
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;erpCompany&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;rid&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;uid&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetProjects(string erpCompany, int rid, int uid)
        {
            return ProjectComponent.Instance.GetProjects(erpCompany, rid, uid);
        }

        /// &lt;summary&gt;
        /// Returns the ProectList along with ContractID based on the provided filter
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;erpCompany&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;rid&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;uid&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetProjectsWithContract(string erpCompany, int rid, int uid)
        {
            return ProjectComponent.Instance.GetProjectsWithContract(erpCompany, rid, uid);
        }

        /// &lt;summary&gt;
        /// Gets active projects.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetActiveProjects(string erpCompany)
        {
            return ProjectComponent.Instance.GetActiveProjects(erpCompany);
        }

        /// &lt;summary&gt;
        /// Gets active projects.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;erpCompany&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;currentUserID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetActiveProjectsForUserId(string erpCompany, int selectedUserID, ref int currentPage, string sortKey, int maxRowsInPage, out int totalCount, string optionalContractorBiddingRoleNameToExclude = null)
        {
            return ProjectComponent.Instance.GetActiveProjectsForUserId(erpCompany, selectedUserID, ref currentPage, sortKey, maxRowsInPage, out totalCount, optionalContractorBiddingRoleNameToExclude);
        }

        /// &lt;summary&gt;
        /// Gets active projects by IDs.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;erpCompany&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;currentUserID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetActiveProjectsByIDs(string erpCompany, int currentUserID, int roleId, int selectedUserID,
            string IDs)
        {
            return ProjectComponent.Instance.GetActiveProjectsByIDs(erpCompany, currentUserID, roleId, selectedUserID,
                IDs);
        }

        /// &lt;summary&gt;
        /// Manipulates a User&#39;s association with Projects
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;xmlData&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;Number of associations that threw a DB exception&lt;/returns&gt;
        public int AddOrRemoveUserInProjects(string xmlData)
        {
            return ProjectComponent.Instance.AddOrRemoveUserInProjects(xmlData);
        }

        public int AddOrRemoveUserInProjectsContract(string xmlData)
        {
            return ProjectComponent.Instance.AddOrRemoveUserInProjectsContract(xmlData);
        }

        public DataTable GetProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany)
        {
            int count = 0;
            return GetProjectsWithFeaturePermission(userID, roleID, feautresCode, moduleID,
                startRowIdx, maxRows, sortOrder,
                filterSearch, AXCompany, false, out count);
        }

        public DataTable GetProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany,
            bool filterOrSortHasPendingOnUser, out int count)
        {
            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                roleID = 0;

            UserDetail ud = UserDetail.GetCurrentUserDetail();
            string currentRoles = UserManager.Instance.GetRoleNames(ud.UID, 0, ud.RID, ud.RoleName);

            return ProjectComponent.Instance.GetProjectsWithFeaturePermission(userID, roleID, feautresCode, moduleID,
                startRowIdx, maxRows, sortOrder,
                filterSearch, AXCompany, currentRoles, filterOrSortHasPendingOnUser, out count);
        }

        public DataTable GetPlanningProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany, int IsProposedProject)
        {
            int count = 0;
            return GetPlanningProjectsWithFeaturePermission(userID, roleID, feautresCode, moduleID, startRowIdx, maxRows, sortOrder,
                filterSearch, AXCompany, IsProposedProject, false, out count);
        }

        public DataTable GetPlanningProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany, int IsProposedProject,
            bool filterOrSortHasPendingOnUser, out int count)
        {
            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                roleID = 0;

            UserDetail ud = UserDetail.GetCurrentUserDetail();
            string currentRoles = UserManager.Instance.GetRoleNames(ud.UID, 0, ud.RID, ud.RoleName);

            return ProjectComponent.Instance.GetPlanningProjectsWithFeaturePermission(userID, roleID, feautresCode,
                moduleID,
                startRowIdx, maxRows, sortOrder,
                filterSearch, AXCompany, IsProposedProject, currentRoles, filterOrSortHasPendingOnUser, out count);
        }

        /// &lt;summary&gt;
        /// Gets the list of status available while creating a project.Used in CreateProject.aspx
        /// &lt;/summary&gt;
        public DataTable GetStatus(bool IsLibrary)
        {
            return ProjectComponent.Instance.GetStatus(IsLibrary);
        }

        internal DataTable GetProjectSummary()
        {
            return ProjectComponent.Instance.GetProjectSummary(null);
        }

        internal DataTable GetProjectSummary(string AxCompany)
        {
            if (string.IsNullOrEmpty(AxCompany))
                return ProjectComponent.Instance.GetProjectSummary(null);
            else
                return ProjectComponent.Instance.GetProjectSummary(AxCompany);
        }


        public IQueryable&lt;AttributesMaster&gt; GetAttributes(string ModuleID, bool? IsDeActivated, bool? IsMandatory)
        {
            IQueryable&lt;AttributesMaster&gt; result = from m in CoreDb.Db.AttribuesMaster
                                                  where m.ModuleId == ModuleID &amp;&amp;
                                                        (IsDeActivated.HasValue
                                                            ? m.IsDeActivated == IsDeActivated
                                                            : true) &amp;&amp;
                                                        (IsMandatory.HasValue ? m.IsMandatory == IsMandatory : true)
                                                  select m;
            return result;
        }

        public bool IsDuplicateAttributeExists(int? AttributeId, string AttributeName, string ModuleId)
        {
            IQueryable&lt;AttributesMaster&gt; result = from m in CoreDb.Db.AttribuesMaster
                                                  where m.AttributeName == AttributeName &amp;&amp;
                                                        m.ModuleId == ModuleId &amp;&amp;
                                                        (AttributeId.HasValue ? m.AttributeId != AttributeId : true)
                                                  select m;

            return result.Count() &gt; 0;
        }

        /// &lt;summary&gt;
        /// Get the Projects Count for each status.
        /// &lt;/summary&gt;
        public DataTable GetProjectCountByStatus(string axCompany, int userID, int roleID)
        {
            return ProjectComponent.Instance.GetProjectCountByStatus(axCompany, userID, roleID);
        }

        /// &lt;summary&gt;
        /// Get the Projects Count by Cost.
        /// &lt;/summary&gt;
        public DataTable GetProjectCountByCost(string axCompany, int userID, int roleID)
        {
            DataTable dtRaw, dtTranspose;

            dtRaw = ProjectComponent.Instance.GetProjectCountByCost(axCompany, userID, roleID);

            dtTranspose = new BrixDataTable();
            dtTranspose.Columns.Add(&quot;Range&quot;, Type.GetType(&quot;System.String&quot;));
            dtTranspose.Columns.Add(&quot;Count&quot;, Type.GetType(&quot;System.Int32&quot;));
            int index = 0;

            foreach (DataColumn dc in dtRaw.Columns)
            {
                DataRow dr = dtTranspose.NewRow();
                dr[&quot;Range&quot;] = dc.Caption;
                dr[&quot;Count&quot;] = (DBNull.Value == dtRaw.Rows[0][index]) ? &quot;0&quot; : dtRaw.Rows[0][index].ToString2();
                dtTranspose.Rows.Add(dr);
                index++;
            }
            return dtTranspose;
        }

        /// &lt;summary&gt;
        /// Get the Projects Count by Completion Time.
        /// &lt;/summary&gt;
        public DataTable GetProjectCountByCompletion(string axCompany, int userID, int roleID)
        {
            DataTable dtRaw, dtTranspose;

            dtRaw = ProjectComponent.Instance.GetProjectCountByCompletion(axCompany, userID, roleID);

            dtTranspose = new BrixDataTable();
            dtTranspose.Columns.Add(&quot;Range&quot;, Type.GetType(&quot;System.String&quot;));
            dtTranspose.Columns.Add(&quot;Count&quot;, Type.GetType(&quot;System.Int32&quot;));
            int index = 0;

            foreach (DataColumn dc in dtRaw.Columns)
            {
                DataRow dr = dtTranspose.NewRow();
                dr[&quot;Range&quot;] = dc.Caption;
                dr[&quot;Count&quot;] = (DBNull.Value == dtRaw.Rows[0][index]) ? &quot;0&quot; : dtRaw.Rows[0][index].ToString2();
                dtTranspose.Rows.Add(dr);
                index++;
            }
            return dtTranspose;
        }

        /// &lt;summary&gt;
        /// Get all the templates available for creating a project.
        /// &lt;/summary&gt;
        public DataTable GetTemplates()
        {
            return ProjectComponent.Instance.GetTemplates();
        }

        /// &lt;summary&gt;
        ///  This returns the list of attributeNames and values for a particular project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectId&quot;&gt;&lt;/param&gt;
        internal Dictionary&lt;string, string&gt; GetProjectAttributes(int ProjectId)
        {
            return ProjectComponent.Instance.GetAttributesValues(ProjectId);
        }

        /// &lt;summary&gt;
        /// This Creates the project using the DTO object passed to it.THis also creates the Attributes and Modules for a project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectDTO&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        public int CreateProject(Project ProjectDTO, int userID, int roleID)
        {
            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                roleID = 0;
            return ProjectComponent.Instance.CreateProject(ProjectDTO, userID, roleID);
        }

        /// &lt;summary&gt;
        /// Creates a template
        /// &lt;/summary&gt;
        public int CreateTemplate(Template templateDTO)
        {
            return ProjectComponent.Instance.CreateTemplate(templateDTO);
        }

        /// &lt;summary&gt;
        /// Updates the project when editing a project,this also takes a DTO object as input parameter.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectDTO&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        public int UpdateProject(Project ProjectDTO, int userID, int roleID)
        {
            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                roleID = 0;
            return ProjectComponent.Instance.UpdateProject(ProjectDTO, userID, roleID);
        }

        /// &lt;summary&gt;
        /// Updates the project start and end date.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectDTO&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        public object UpdateProjectDates(int projectID, DateTime startDate, DateTime endDate)
        {
            return ProjectComponent.Instance.UpdateProjectDates(projectID, startDate, endDate);
        }

        /// &lt;summary&gt;
        ///project Value.
        /// &lt;/summary&gt;        
        /// &lt;param name=&quot;ProjectID&quot;&gt;&lt;/param&gt;        
        public Hashtable GetProjectValue(int ProjectID)
        {
            return ProjectComponent.Instance.GetProjectValue(ProjectID);
        }

        /// &lt;summary&gt;
        /// Updates an existing template.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateDTO&quot;&gt;&lt;/param&gt;
        public int UpdateTemplate(Template templateDTO)
        {
            return ProjectComponent.Instance.UpdateTemplate(templateDTO);
        }

        /// &lt;summary&gt;
        /// This returns a DTO object used in displaying the project details.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public Project GetProjectDetails(int projectId)
        {
            return ProjectComponent.Instance.GetProjectDetails(projectId);
        }

        /// &lt;summary&gt;
        /// This returns a DTO object used in displaying the project details.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal Dictionary&lt;string, string&gt; GetProjectDetailsDictionary(int projectId)
        {
            //modified on 11th jan. all keys are converted to uppercase.
            Project ProjectDTO = ProjectComponent.Instance.GetProjectDetails(projectId);
            Dictionary&lt;string, string&gt; projAtts = ProjectComponent.Instance.GetAttributesValues(projectId);
            var projDetails = new Dictionary&lt;string, string&gt;();

            projDetails.Add(&quot;PROJECTCODE&quot;, ProjectDTO.ProjectCode);
            projDetails.Add(&quot;CREATEDDATE&quot;, ProjectDTO.ProjectCreatedDate.ToString());
            projDetails.Add(&quot;DESCRIPTION&quot;, ProjectDTO.ProjectDescription);
            projDetails.Add(&quot;ENDDATE&quot;, ProjectDTO.ProjectEndDate.ToString());
            projDetails.Add(&quot;PROJECTID&quot;, ProjectDTO.ProjectID.ToString2());
            projDetails.Add(&quot;ISACTIVE&quot;, ProjectDTO.ProjectIsActive.ToString2());
            projDetails.Add(&quot;PROJECTNAME&quot;, ProjectDTO.ProjectName);
            projDetails.Add(&quot;OWNER&quot;, ProjectDTO.ProjectOwner);
            projDetails.Add(&quot;STARTDATE&quot;, ProjectDTO.ProjectStartDate.ToString());
            projDetails.Add(&quot;STATUS&quot;, ProjectDTO.ProjectStatus.ToString2());
            projDetails.Add(&quot;TEMPLATEID&quot;, ProjectDTO.ProjectTemplateID.ToString2());

            foreach (var att in projAtts)
                projDetails.Add(att.Key.ToUpper2(), att.Value);

            return projDetails;
        }

        /// &lt;summary&gt;
        /// Returns a Template DTO object
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateId&quot;&gt;&lt;/param&gt;
        public Template GetTemplateDetails(int templateId, string parentModuleID)
        {
            return ProjectComponent.Instance.GetTemplateDetails(templateId, parentModuleID);
        }

        /// &lt;summary&gt;
        /// This displays the modules for a project in the details view.
        /// &lt;/summary&gt;
        internal List&lt;Platform&gt; GetProjects(int ProjectId)
        {
            return ProjectComponent.Instance.GetProjectDetails(ProjectId).ProjectModules;
        }

        /// &lt;summary&gt;
        /// This deletes a particular project.
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public int DeleteProject(int projectId)
        {
            return ProjectComponent.Instance.DeleteProject(projectId);
        }

        /// &lt;summary&gt;
        /// This deletes a particular project.
        /// &lt;param name=&quot;UserID&quot;&gt;&lt;/param&gt;
        public int DeleteADUsersOrGroups(string UserIDs, string Type)
        {
            return ProjectComponent.Instance.DeleteADUsersOrGroups(UserIDs, Type);
        }

        /// &lt;summary&gt;
        /// Deletes a template
        /// &lt;/summary&gt;
        public int DeleteTemplate(int templateId)
        {
            return ProjectComponent.Instance.DeleteTemplate(templateId);
        }

        public enum EnumProjectActivateDeactivateEnum { Success = 0, BusinessUnitIsNotActive = 2, UnknownError = 999 }
        /// &lt;summary&gt;
        /// This is used for activate/deactivating a project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ProjectId&quot;&gt;&lt;/param&gt;
        public EnumProjectActivateDeactivateEnum ActivateDeactivateProject(int ProjectId)
        {
            return (EnumProjectActivateDeactivateEnum)ProjectComponent.Instance.ActivateDeactivateProject(ProjectId);
        }

        public bool TryToggleProjectStatus(int ProjectId, ref string knowErrorMsg)
        {
            EnumProjectActivateDeactivateEnum status = (EnumProjectActivateDeactivateEnum)ProjectComponent.Instance.ActivateDeactivateProject(ProjectId);

            switch (status)
            {
                case EnumProjectActivateDeactivateEnum.Success:
                    return true;
                case EnumProjectActivateDeactivateEnum.BusinessUnitIsNotActive:
                    {
                        knowErrorMsg = string.Format(&quot;This {0} cannot be activated as the {1} associated with this {0} is not active.&quot;, Project_Text, BusinessUnit_Text);
                        return false;
                    }
                case EnumProjectActivateDeactivateEnum.UnknownError:
                    {
                        knowErrorMsg = string.Format(&quot;Status cannot be changed for this {0} due to unknow exception in the database&quot;, Project_Text);
                        return false;
                    }
            }
            knowErrorMsg = &quot;Unknown Error&quot;;
            return false;
        }

        /// &lt;summary&gt;
        /// This is used to copy a project from an existing project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sourceProjectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;targetProjectName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;targetProjectCode&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;targetDescription&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyModules&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyAttributes&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyUsers&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        public int CopyProject(int sourceProjectId, string targetProjectName, string targetProjectCode,
            string targetDescription, bool copyModules,
            bool copyAttributes, bool copyUsers, int userID, int roleID)
        {
            return
                ProjectComponent.Instance.CopyProject(sourceProjectId, targetProjectName, targetProjectCode,
                    targetDescription, copyModules,
                    copyAttributes, copyUsers, userID, roleID);
        }

        /// &lt;summary&gt;
        /// To add users to a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userList&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public int AddUserstoProject(Dictionary&lt;int, int&gt; userList, int projectId)
        {
            return ProjectComponent.Instance.AddUserstoProject(userList, projectId);
        }

        public int AddRecentProject(int projectId, int userId)
        {
            return ProjectComponent.Instance.AddRecentProject(projectId, userId);
        }

        /// &lt;summary&gt;
        /// Gets the users associated with a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public DataTable GetProjectUsers(int projectId)
        {
            return ProjectComponent.Instance.GetProjectUsers(projectId);
        }

        /// &lt;summary&gt;
        /// Gets the users associated with a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public Dictionary&lt;int, string&gt; GetProjectUserDetails(int projectId)
        {
            Dictionary&lt;int, string&gt; users = new Dictionary&lt;int, string&gt;();
            DataTable dt = ProjectComponent.Instance.GetProjectUserDetails(projectId);
            for (int i = 0; i &lt; dt.Rows.Count; i++)
            {
                DataRow row = dt.Rows[i];
                users.Add(row[&quot;UserID&quot;].ToInt32_2(), row[&quot;UserFullName&quot;].ToString());
            }

            return users;
        }

        public List&lt;int&gt; GetProjectUserIDs(int projectId)
        {
            List&lt;int&gt; userIdList = new List&lt;int&gt;();
            DataTable dt = ProjectComponent.Instance.GetProjectUserIDs(projectId);

            for (int i = 0; i &lt; dt.Rows.Count; i++)
            {
                DataRow row = dt.Rows[i];
                userIdList.Add(row[&quot;UserID&quot;].ToInt32_2());
            }

            return userIdList;
        }

        /// &lt;summary&gt;
        /// Checks whether the given user and role is invited to the given project and returns true if invited  
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public bool IsUserWithRoleInvitedToProject(int projectId, int userId, int roleId)
        {
            DataTable projectUsers = ProjectComponent.Instance.GetProjectUsers(projectId);
            return
                projectUsers.Rows.OfType&lt;DataRow&gt;()
                    .Where(x =&gt; x[&quot;UserID&quot;].ToInt32_2() == userId &amp;&amp; x[&quot;RoleID&quot;].ToInt32_2() == roleId)
                    .ToList()
                    .Count &gt; 0;
        }

        public DataTable GetProjectUsersWithPrimary(int projectId)
        {
            return ProjectComponent.Instance.GetProjectUsersWithPrimary(projectId);
        }

        /// &lt;summary&gt;
        /// Gets all the roles defined
        /// &lt;/summary&gt;
        public Dictionary&lt;int, string&gt; GetRoles()
        {
            return UserManager.Instance.GetRoles();
        }

        /// &lt;summary&gt;
        /// Updates the role for a user assigned to a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;&lt;/param&gt;
        public int UpdateUserRole(int projectId, int userId, int roleId, bool isPrimary)
        {
            return ProjectComponent.Instance.UpdateUserRole(projectId, userId, roleId, isPrimary);
        }

        /// &lt;summary&gt;
        /// This deletes a particular User from the project.
        /// &lt;/summary&gt;
        public int DeleteUserRole(int projectId, int userId)
        {
            return ProjectComponent.Instance.DeleteUserRole(projectId, userId);
        }

        /// &lt;summary&gt;
        /// This deletes a particular status.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;statusId&quot;&gt;&lt;/param&gt;
        public int DeleteStatus(int statusId)
        {
            return ProjectComponent.Instance.DeleteStatus(statusId);
        }

        /// &lt;summary&gt;
        /// This deletes a particular attribute.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;attributeId&quot;&gt;&lt;/param&gt;
        public int DeleteAttribute(int attributeId)
        {
            return ProjectComponent.Instance.DeleteAttribute(attributeId);
        }

        /// &lt;summary&gt;
        /// This Creates a new status in the ProjectStatus table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;statusName&quot;&gt;&lt;/param&gt;
        public int CreateStatus(int StatusID, string statusName, bool ActivationStatus)
        {
            return ProjectComponent.Instance.CreateStatus(StatusID, statusName, ActivationStatus);
        }

        /// &lt;summary&gt;
        /// This Creates a new attribute in the ProjectStatus table
        /// &lt;param name=&quot;attributeName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;attributeType&quot;&gt;&lt;/param&gt;
        public int CreateAttribute(int attributeID, string attributeName, string attributeType, int? AttributeSize,
            bool Mandatory, bool DeActivate, string ModuleId)
        {
            return ProjectComponent.Instance.CreateAttribute(attributeID, attributeName, attributeType, AttributeSize,
                Mandatory, DeActivate, ModuleId);
        }

        /// &lt;summary&gt;
        /// This checks whether an attribute is used in any project or not
        /// &lt;/remarks&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;attributeId&quot;&gt;&lt;/param&gt;
        public int CheckAttribute(int attributeId, string ModuleId)
        {
            return ProjectComponent.Instance.CheckAttribute(attributeId, ModuleId);
        }

        /// &lt;summary&gt;
        /// Get all the available platforms
        /// &lt;/summary&gt;
        /// &lt;returns&gt;Dictionary&amp;lt;string, string&amp;gt;&lt;/returns&gt;
        public Dictionary&lt;string, string&gt; GetPlatformList()
        {
            return ModuleManager.Instance.GetPlatformList();
        }

        /// &lt;summary&gt;
        /// For Sync Service
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;platformKey&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public string GetProjectsXMLforPlatform(string platformKey, int roleId, string userID)
        {
            /* Old XML Format (used in the AMP3Mobile before 12-Mar-2007) */
            /* 
         try
         {
                
             //Get all the projects and their modules
             int uid = UserManager.Instance.GetUID(userID);
             DataTable dtProjects = ProjectComponent.Instance.GetProjectsforPlatform(&quot;W_W_WEB&quot;, uid);
             if (dtProjects == null || dtProjects.Rows.Count == 0)
                 return &quot;&quot;;

             //Get the XML Data for all modules
             string xmlData = ModuleManager.Instance.GetModulePlatforms(&quot;PROJECT&quot;);

             if (xmlData.Length == 0)
                 return &quot;&quot;;

             XmlDocument xDocModules = new XmlDocument();
             xDocModules.LoadXml(xmlData);

             StringBuilder xmlOutput = new StringBuilder(&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&lt;LogInfo&gt;&lt;Dependency Type=\&quot;Projects\&quot; Value=\&quot;\&quot;&gt;&quot;);
             string depFormatStr = &quot;&lt;Dependency ID=\&quot;{0}\&quot; Type=\&quot;{1}\&quot; Value=\&quot;{2}\&quot;&gt;&quot;;

             string contractxml;

             //Iterate over all the rows fo the Datatable
             foreach (DataRow row in dtProjects.Rows)
             {
                 object[] paramC = { BrixDatatypeHelper.ToInt32_2(row[&quot;ProjectId&quot;].ToString2()), roleId, platformKey };
                 object data = GetDataFromAssembly(&quot;Aurigo.AMP3.ContractsBL.dll&quot;, &quot;GetContractXMLForSync&quot;, paramC);
                 contractxml = (data != null) ? data.ToString2() : &quot;&quot;;

                 if (contractxml != &quot;&quot;)
                 {
                     xmlOutput.AppendFormat(depFormatStr, row[&quot;ProjectId&quot;].ToString2(), ReplaceXMLEscapeCharacters(row[&quot;ProjectName&quot;].ToString2()), ReplaceXMLEscapeCharacters(row[&quot;ProjectCode&quot;].ToString2()));
                     foreach (XmlNode node in xDocModules.SelectNodes(&quot;modules/module&quot;))
                     {
                         if (row[&quot;ModuleID&quot;].ToString2() == node.Attributes[&quot;key&quot;].Value)
                         {
                             xmlOutput.AppendFormat(depFormatStr, &quot;CONTRCT&quot;, &quot;Contracts&quot;, &quot;&quot;);
                             xmlOutput.Append(contractxml);
                             xmlOutput.Append(&quot;&lt;/Dependency&gt;&quot;);
                         }
                     }
                     xmlOutput.Append(&quot;&lt;/Dependency&gt;&quot;);
                 }
             }
             xmlOutput.Append(&quot;&lt;/Dependency&gt;&lt;/LogInfo&gt;&quot;);

             return xmlOutput.ToString2();
         }
         catch (Exception ex)
         {
             Logging.Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
             throw;
         }
         */
            /* New XML Format (used in the AMP3Mobile v 12-Mar-2007 and above) */

            try
            {
                //Get all the projects and their modules
                int uid = UserManager.Instance.GetUID(userID);
                DataTable dtProjects = ProjectComponent.Instance.GetProjectsforPlatform(&quot;W_W_WEB&quot;, uid);
                if (dtProjects == null || dtProjects.Rows.Count == 0)
                    return &quot;&quot;;

                //Get the XML Data for all modules
                string xmlData = ModuleManager.Instance.GetModulePlatforms(&quot;PROJECT&quot;);

                if (xmlData.Length == 0)
                    return &quot;&quot;;

                var xDocModules = new XmlDocument();
                xDocModules.LoadXml(xmlData);

                var sDocOutput = new XmlDocument();
                XmlElement rootNode = sDocOutput.CreateElement(&quot;AMP3&quot;);
                sDocOutput.AppendChild(rootNode);

                //Iterate over all the rows fo the Datatable
                foreach (DataRow row in dtProjects.Rows)
                {
                    object[] paramC = { row[&quot;ProjectId&quot;].ToString2().ToInt32_2(), roleId, platformKey };
                    object data = CoreDatabaseHelper.GetDataFromAssembly(row[&quot;ModuleId&quot;].ToString2(),
                        &quot;GetContractXMLForSync&quot;, paramC);
                    string contractxml = (data != null) ? data.ToString2() : &quot;&quot;;

                    //data = GetDataFromAssembly(&quot;Aurigo.AMP3.ContmgtBL.dll&quot;, &quot;GetContractXMLForSync&quot;, paramC);
                    //string contmgtxml = (data != null) ? data.ToString2() : &quot;&quot;;

                    if (contractxml != &quot;&quot;) // || contmgtxml != &quot;&quot;
                    {
                        XmlElement groupNode = sDocOutput.CreateElement(&quot;Group&quot;);
                        groupNode.SetAttribute(&quot;Id&quot;, row[&quot;ProjectId&quot;].ToString2());
                        groupNode.SetAttribute(&quot;Name&quot;, row[&quot;ProjectName&quot;].ToString2());
                        groupNode.SetAttribute(&quot;Code&quot;, row[&quot;ProjectCode&quot;].ToString2());
                        groupNode.SetAttribute(&quot;ModuleKey&quot;, &quot;PROJECT&quot;);
                        groupNode.SetAttribute(&quot;ModuleGroup&quot;, &quot;Projects&quot;);

                        foreach (XmlNode node in xDocModules.SelectNodes(&quot;modules/module&quot;))
                        {
                            if (row[&quot;ModuleID&quot;].ToString2() == node.Attributes[&quot;key&quot;].Value)
                            {
                                if (contractxml != &quot;&quot;)
                                    groupNode.InnerXml += contractxml + Environment.NewLine;
                                //if (contmgtxml != &quot;&quot;)
                                //    groupNode.InnerXml += contmgtxml + Environment.NewLine;
                            }
                        }
                        rootNode.AppendChild(groupNode);
                    }
                }

                return sDocOutput.OuterXml;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets recent project for a user, for a role.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;numProjects&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;CompleteTree&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal string GetRecentProjects(int userID, int roleID, int numProjects, bool CompleteTree, string AXCompany)
        {
            try
            {
                var xmlOutput = new StringBuilder();
                int count = 0;

                // Limit projects to a maximum of 10 
                numProjects = (numProjects &gt; 10) ? 10 : numProjects;

                if (CompleteTree)
                    xmlOutput.Append(
                        &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;&lt;AMP3 ModuleId=\&quot;PROJECT\&quot; Platform=\&quot;Web\&quot;&gt;&lt;CustomMenu&gt;&quot;);

                DataTable dt = ProjectComponent.Instance.GetRecentProjects(userID, roleID, AXCompany);

                if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
                {
                    DataTable dtAXProjects = new BrixDataTable();
                    dtAXProjects = IntegrationConnectorManager.Instance.GetAXMappedProjects();
                    DataRow[] drSelect = dtAXProjects.Select(&quot;ERPCompany &lt;&gt; &#39;&quot; + AXCompany + &quot;&#39;&quot;);
                    foreach (DataRow dr in drSelect)
                    {
                        DataRow[] drProjectDT = dt.Select(&quot;ProjectID = &quot; + dr[&quot;AMP3Id&quot;]);
                        if (drProjectDT.Length &gt; 0)
                            dt.Rows.Remove(drProjectDT[0]);
                    }
                }

                foreach (DataRow dr in dt.Rows)
                {
                    xmlOutput.AppendFormat(CultureInfo.CurrentCulture,
                        &quot;&lt;Group Name=\&quot;{0}\&quot;  TargetUrl=\&quot;{1}\&quot;  ImageUrl=\&quot;{2}\&quot; Description=\&quot;{3}\&quot;/&gt;&quot;,
                        UIHelper.ReplaceXMLCharEntities(dr[&quot;ProjectName&quot;].ToString2(),
                            UIHelper.XmlCharEntity.CE_ALL &amp;
                            ~UIHelper.XmlCharEntity.CE_APOS),
                        &quot;~/Modules/PROJECT/&quot; + dr[&quot;InstanceURL&quot;].ToString2() + &quot;?&quot; +
                        Constants.QRY_PROJECTID + &quot;=&quot; + dr[&quot;ProjectId&quot;].ToString2(),
                        IMG_LEAF, &quot;&quot;);

                    if (++count == numProjects)
                        break;
                }

                if (CompleteTree)
                    xmlOutput.Append(&quot;&lt;/CustomMenu&gt;&lt;/AMP3&gt;&quot;);

                return xmlOutput.ToString2();
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        public virtual TNode GetRecentProjects(int userID, int roleID, string AXCompany)
        {
            var recentTree = new TNode(&quot;Recent &quot; + LocalizationManager.GetString(&quot;Project&quot;) + &quot;s&quot;, null);
            DataTable dt = ProjectComponent.Instance.GetRecentProjects(userID, roleID, AXCompany);

            if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            {
                DataTable dtAXProjects = IntegrationConnectorManager.Instance.GetAXMappedProjects();
                DataRow[] drSelect = dtAXProjects.Select(&quot;ERPCompany &lt;&gt; &#39;&quot; + AXCompany + &quot;&#39;&quot;);
                foreach (DataRow dr in drSelect)
                {
                    DataRow[] drProjectDT = dt.Select(&quot;ProjectID = &quot; + dr[&quot;AMP3Id&quot;]);
                    if (drProjectDT.Length &gt; 0)
                        dt.Rows.Remove(drProjectDT[0]);
                }
            }

            int count = 0;

            foreach (DataRow dr in dt.Rows)
            {
                string Name = UIHelper.ReplaceXMLCharEntities(dr[&quot;ProjectName&quot;].ToString2(),
                    UIHelper.XmlCharEntity.CE_ALL &amp; ~UIHelper.XmlCharEntity.CE_APOS);
                if (components.Contains(&quot;ShowProjectCodeInTree&quot;))
                {
                    string Code = UIHelper.ReplaceXMLCharEntities(dr[&quot;ProjectCode&quot;].ToString2(),
                        UIHelper.XmlCharEntity.CE_ALL &amp; ~UIHelper.XmlCharEntity.CE_APOS);
                    if (Name.ToLower() != Code.ToLower())
                        //changed the logfic to get the displayname from database as it can be configured for client specific
                        Name = UIHelper.ReplaceXMLCharEntities(dr[&quot;ProjectDisplayName&quot;].ToString2(),
                            UIHelper.XmlCharEntity.CE_ALL &amp; ~UIHelper.XmlCharEntity.CE_APOS);
                }

                var pp = string.Empty;

                if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING) &amp;&amp;
                    (dr.Table.Columns.Contains(&quot;IsProposedProject&quot;) &amp;&amp; dr[&quot;IsProposedProject&quot;].ToString().IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;1&quot;, &quot;True&quot;)))
                {
                    pp = &quot;&amp;PP=1&quot;;
                }

                recentTree.Nodes.Add(
                    new TNode(Name,
                        &quot;~/Modules/PROJECT/&quot; + dr[&quot;InstanceURL&quot;].ToString2() + &quot;?&quot; + Constants.QRY_PROJECTID + &quot;=&quot; + dr[&quot;ProjectId&quot;].ToString2() + &quot;&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot; + pp));
                if (++count == 5)
                    break;
            }

            return recentTree;
        }

        private List&lt;string&gt; _components = null;

        private List&lt;string&gt; components
        {
            get
            {
                _components = ModuleManager.Instance.GetModuleComponenets(Constants.MODID_CORE);
                return _components;
            }
        }

        private int GetContractId(string projectId)
        {
            DataSet dsDetails = ComponentHelper.Instance.ExecuteDataSet(
                DocumentStoredProcedure.usp_DOCMGMTGetContractId, null, projectId);
            if (dsDetails != null &amp;&amp; dsDetails.Tables.Count &gt; 0 &amp;&amp; dsDetails.Tables[0].Rows.Count == 1)
            {
                int contractId = dsDetails.Tables[0].Rows[0][&quot;ContractID&quot;].ToInt32_2();
                return contractId;
            }
            else
                return 0;
        }

        /// &lt;summary&gt;
        /// Gets a XML file containing all the projects and their modules, formated in the log format
        /// &lt;/summary&gt;
        /// &lt;returns&gt;XML string&lt;/returns&gt;
        public virtual TNode GetProjectForTree(int projectId, int userId, int roleId)
        {
            try
            {
                if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                    roleId = 0;

                List&lt;string&gt; permissions = ModuleManager.Instance.GetPermissionByUserOrRole(Constants.MODID_PROJECT, userId, roleId, projectId);
                List&lt;string&gt; permissionsForChecklist = ModuleManager.Instance.GetPermissionByUserOrRole(&quot;CHKPRJL&quot;, userId, roleId, projectId);

                bool hideProjectTree = ConfigurationManager.AppSettings[&quot;HideProjectTree&quot;] == null
                    ? false
                    : ConfigurationManager.AppSettings[&quot;HideProjectTree&quot;].ToBoolean2();

                var tree = new TNode();
                // Get project and Modules
                DataSet dtProjects = ProjectComponent.Instance.GetProjectForTree(projectId, userId, roleId);
                //if (dtProjects == null || dtProjects.Tables.Count == 0 || dtProjects.Tables[0].Rows.Count == 0)
                //    tree.Nodes.Add(new TNode(&quot;Project List&quot;, &quot;~/Common/BrixListPage.aspx?context=PROJECT&quot;));

                if (dtProjects.Tables.Count &gt; 2 &amp;&amp; projectId == 0)
                {
                    //add project list level xml forms                    
                    foreach (DataRow dr in dtProjects.Tables[2].Rows)
                    {
                        if (dr[&quot;NavigateURL&quot;].ToString().Equals(&quot;xmlform&quot;, StringComparison.CurrentCulture))
                        {
                            if (dr.Table.Columns.Contains(&quot;IsSingleInstance&quot;) &amp;&amp; !dr.IsNull(&quot;IsSingleInstance&quot;) &amp;&amp; dr[&quot;IsSingleInstance&quot;].ToBoolean2())
                            {
                                tree.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                                  dr[&quot;InstanceUrl&quot;].ToString() + &quot;?context=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + projectId + &quot;&amp;ParentID=&quot; + projectId);
                            }
                            else
                            {
                                tree.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                               &quot;~/Common/BrixListPage.aspx?xContext=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + projectId + &quot;&amp;ParentID=&quot; + projectId);
                            }
                        }
                    }
                }

                if (ProjectModuleComponents.Contains(&quot;ShowRecentProjectsWithProjectTree&quot;))
                {
                    TNode recentProjects = GetRecentProjects(userId, roleId, (HttpContext.Current.Session[&quot;AXCompany&quot;] ?? &quot;&quot;).ToString());
                    tree.Nodes.Add(recentProjects);
                }

                if (dtProjects != null &amp;&amp; dtProjects.Tables.Count &gt; 0 &amp;&amp; dtProjects.Tables[0].Rows.Count &gt; 0)
                {
                    DataRow drproj = dtProjects.Tables[0].Rows[0];

                    string projId = drproj[&quot;ProjectId&quot;].ToString2();

                    string projectName = UIHelper.ReplaceXMLCharEntities(drproj[&quot;ProjectName&quot;].ToString2(),
                        UIHelper.XmlCharEntity.CE_ALL &amp; ~UIHelper.XmlCharEntity.CE_APOS);
                    if (ProjectModuleComponents.Contains(&quot;ShowProjectCodeInTree&quot;))
                    {
                        string projectCode = UIHelper.ReplaceXMLCharEntities(drproj[&quot;ProjectCode&quot;].ToString2(),
                            UIHelper.XmlCharEntity.CE_ALL &amp; ~UIHelper.XmlCharEntity.CE_APOS);
                        if (projectName.ToLower() != projectCode.ToLower())
                            projectName = string.Format(&quot;{0}, {1}&quot;, projectCode, projectName);
                    }
                    string projectUrl = $&quot;~/Modules/PROJECT/{drproj[&quot;InstanceURL&quot;].ToString2()}?{Constants.QRY_PROJECTID}={projId}&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;;
                    if (UploadedModuleList.ContainsKey(Constants.MODID_PLANING) &amp;&amp; drproj.Table.Columns.Contains(&quot;IsProposedProject&quot;) &amp;&amp;
                        drproj[&quot;IsProposedProject&quot;].ToString().IsEqualToAny(StringComparison.CurrentCultureIgnoreCase, &quot;1&quot;, &quot;True&quot;))
                        projectUrl += &quot;&amp;PP=1&quot;;

                    var projectNode = new TNode(projectName, projectUrl);
                    tree.Nodes.Add(projectNode);
                    // Unified Inbox tree --- Aug 27 2010
                    projectNode.Nodes.Add(new TNode(&quot;My Tasks&quot;,
                        &quot;~/Common/BrixListPage.aspx?Context=MYINBOX&amp;amp;Type=PROJECT&amp;amp;PID=&quot; +
                        projId + &quot;&amp;amp;IsCompleted=0&quot;));

                    if (AMP3ApplicationSettings.Instance.appSettings.ContainsKey(&quot;DocumentReadWriteLocation&quot;))
                    {
                        if (AMP3ApplicationSettings.Instance.appSettings[&quot;DocumentReadWriteLocation&quot;].ToString() ==
                            &quot;FILESYSTEM&quot;)
                        {
                            projectNode.Nodes.Add(new TNode(&quot;Metadata Search&quot;,
                                &quot;{0}SearchDocuments.aspx?PID={1}&quot;.Format2(&quot;~/Modules/DOCMGMT/&quot;, projId)));
                        }
                        else if (AMP3ApplicationSettings.Instance.appSettings[&quot;DocumentReadWriteLocation&quot;].ToString() ==
                                 &quot;DBVARBINARY&quot; ||
                                 AMP3ApplicationSettings.Instance.appSettings[&quot;DocumentReadWriteLocation&quot;].ToString() ==
                                 &quot;DBFILESTREAM&quot;)
                        {
                            projectNode.Nodes.Add(new TNode(&quot;Document Search&quot;,
                                &quot;{0}DocumentSearch.aspx?PID={1}&quot;.Format2(&quot;~/Modules/DOCMGMT/&quot;, projId)));
                        }
                    }

                    if (DOCMGMTModuleComponents.Contains(&quot;LogActivities&quot;) &amp;&amp; permissions.Contains(&quot;DocumentActivities&quot;))
                    {
                        Folder rootfolder = DocumentManager.Instance.GetInstanceRootFolder(projId.ToInt32_2(), &quot;PROJECT&quot;);
                        string fpath = &quot;~/Modules/DOCMGMT/DocumentDashboard.aspx?FID=&quot; + rootfolder.FolderId + &quot;&amp;PID=&quot; +
                                       projId + &quot;&amp;IID=&quot; + projId.ToInt32_2() + &quot;&amp;MID=PROJECT&quot;;

                        projectNode.Nodes.Add(new TNode(&quot;Document Activities&quot;, fpath));
                    }
                    if (ProjectModuleComponents.Contains(&quot;ShowQuickExplorer&quot;) &amp;&amp; permissions.Contains(&quot;QuickExplorer&quot;) &amp;&amp;
                        AMP3ApplicationSettings.Instance.DocumentViewer == DocumentViewer.ViewOne)
                    {
                        projectNode.Nodes.Add(new TNode(&quot;Quick Explorer&quot;,
                            &quot;{0}FileExplorer.aspx?PID={1}&quot;.Format2(&quot;~/Modules/DOCMGMT/&quot;, projId)));
                    }

                    if (ModuleManager.Instance.GetModuleList().ContainsKey(Constants.MODID_PLANING))
                    {
                        projectNode.Nodes.Add(new TNode(&quot;Work Projects&quot;,
                            &quot;~/Common/BrixListPage.aspx?xContext=WORKPRJ&amp;amp;PID={0}&amp;amp;ParentID={1}&quot;.Format2(projId,
                                GetContractId(projId).ToString())));
                    }

                    if (!hideProjectTree)
                    {
                        // Gantt View tree --- Nov 30 2012
                        if (ProjectModuleComponents.Contains(&quot;GanttView&quot;))
                        {
                            projectNode.Nodes.Add(new TNode(&quot;Scheduling&quot;, string.Format(CultureInfo.CurrentCulture,
                                &quot;~/ItemGanttView.aspx?Context=PROJECT&amp;ParentID={0}&amp;PID={0}&amp;UID={1}&amp;BackURL={2}&quot;, projId,
                                UserDetail.GetCurrentUserDetail().UID,
                                HttpContext.Current.Server.UrlEncode(SecurityHelpers.Encrypt_Simple(&quot;~/Modules/PROJECT/&quot; +
                                                                     drproj[&quot;InstanceURL&quot;].ToString2() + &quot;?&quot; +
                                                                     Constants.QRY_PROJECTID + &quot;=&quot; + projId)))));
                        }
                        // Gantt ResourceView View tree --- Nov 30 2012
                        if (ProjectModuleComponents.Contains(&quot;GanttResourceView&quot;))
                        {
                            projectNode.Nodes.Add(new TNode(&quot;Resource View&quot;, string.Format(CultureInfo.CurrentCulture,
                                &quot;~/ResourceView.aspx?Context=PROJECT&amp;ParentID={0}&amp;PID={0}&amp;UID={1}&amp;BackURL={2}&quot;, projId,
                                UserDetail.GetCurrentUserDetail().UID,
                                HttpContext.Current.Server.UrlEncode(&quot;~/Modules/PROJECT/&quot; +
                                                                     drproj[&quot;InstanceURL&quot;].ToString2() + &quot;?&quot; +
                                                                     Constants.QRY_PROJECTID + &quot;=&quot; + projId))));
                        }

                        // Checklist tree --- Nov 26 2008
                        //if (permissions.Contains(&quot;Checklist Create&quot;) || permissions.Contains(&quot;Checklist Edit&quot;) || permissions.Contains(&quot;Checklist Complete&quot;))
                        DataRow[] results = dtProjects.Tables[1].Select(&quot;ModuleID=&#39;CHKPRJL&#39;&quot;);
                        foreach (DataRow drResult in results)
                        {
                            if (permissionsForChecklist.Contains(&quot;Checklist Create&quot;) ||
                                permissionsForChecklist.Contains(&quot;Checklist Edit&quot;) ||
                                permissionsForChecklist.Contains(&quot;Checklist Complete&quot;))
                                projectNode.Nodes.Add(new TNode(&quot;Checklists&quot;,
                                    &quot;~/Common/BrixChecklist.aspx?PID=&quot; + projId + &quot;&amp;amp;Context=PROJECT&quot;));
                        }

                        //Commenting the following line as this is already taken care in the above statements, regardless of hideprojectTree is true or false
                        //projectNode.Nodes.Add(new TNode(&quot;Search Documents&quot;, &quot;{0}SearchDocuments.aspx?PID={1}&quot;.Format2(&quot;~/Modules/DOCMGMT/&quot;, projId)));

                        //Document Management
                        DocumentManager.Instance.GetXmlForTree(projectId, projectId, roleId, PLATFORM_KEY, &quot;PROJECT&quot;,
                            null, projectNode);

                        if (ProjectModuleComponents.Contains(&quot;ResourceManagement&quot;))
                        {
                            TNode resourceMnager = new TNode(&quot;Resource Management&quot;, &quot;#&quot;);
                            projectNode.Nodes.Add(resourceMnager);
                            resourceMnager.Nodes.Add(new TNode(&quot;Resource Gantt&quot;,
                                string.Format(&quot;~/Modules/RESMGMT/ResourceGantt.aspx?context=PROJECT&amp;PID={0}&quot;, projectId)));
                        }
                    }
                    //else
                    //projectNode.Nodes.Add(new TNode(&quot;Search Documents&quot;, &quot;{0}SearchDocuments.aspx?PID={1}&quot;.Format2(&quot;~/Modules/DOCMGMT/&quot;, projId)));

                    foreach (DataRow dr in dtProjects.Tables[1].Rows)
                    {
                        if (dr[&quot;NavigateURL&quot;].ToString().Equals(&quot;xmlform&quot;, StringComparison.CurrentCulture))
                        {
                            if (dr[&quot;ModuleID&quot;].ToString2() == &quot;PRJPRJP&quot; &amp;&amp; !CoreModuleComponents.Contains(&quot;EnableProjectPhase&quot;))
                                continue;

                            if (dtProjects.Tables[1].Columns.Contains(&quot;IsSingleInstance&quot;) &amp;&amp; !dr.IsNull(&quot;IsSingleInstance&quot;) &amp;&amp; dr[&quot;IsSingleInstance&quot;].ToBoolean2())
                            {
                                projectNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                                  dr[&quot;InstanceUrl&quot;].ToString() + &quot;?context=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + projectId + &quot;&amp;ParentID=&quot; + projectId);
                            }
                            else
                            {
                                projectNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                               &quot;~/Common/BrixListPage.aspx?xContext=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + projectId + &quot;&amp;ParentID=&quot; + projectId);
                            }
                        }
                        else
                        {
                            TNode subTreeNode = CoreDatabaseHelper.GetXmlTreeData(projectNode, dr[&quot;ModuleId&quot;].ToString2(),
                                projectId, userId, roleId, PLATFORM_KEY);
                            if (hideProjectTree) // Removing Contract / Estimate My Tasks
                            {
                                if (subTreeNode != null)
                                {
                                    TNode tNode = subTreeNode.Nodes.Find(t =&gt; t.text == &quot;My Tasks&quot;);
                                    if (tNode != null)
                                        subTreeNode.Nodes.Remove(tNode);
                                }
                            }
                            projectNode.AddSubTree(subTreeNode);
                        }
                    }
                    // Newly Added code -- Tree node which represents project level xml forms 
                    //if (dtProjects.Tables.Count &gt;= 1 &amp;&amp; dtProjects.Tables[1].Rows.Count &gt; 0)
                    //{
                    //    ProjectComponent.Instance.GetProjectLevelXmlForms(projectNode, dtProjects.Tables[1], projectId,
                    //        0);
                    //}
                    if (!hideProjectTree)
                    {
                        // Newly Added code -- Tree node which represents report gallery 
                        ReportManager.Instance.GetReportGalleryXml(projectNode, Constants.MODID_PROJECT, projectId, 0);
                        //End of Newly Added code
                    }
                }

                

                return tree;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Gets project details for a given project code.
        /// &lt;/summary&gt;
        internal Project GetProjectDetails(string projectCode)
        {
            return ProjectComponent.Instance.GetProjectDetails(projectCode);
        }

        /// &lt;summary&gt;
        /// Gets the project mode for a particular project.
        /// &lt;/summary&gt;
        public char GetProjectMode(int projectID)
        {
            return Convert.ToChar(ProjectComponent.Instance.GetProjectMode(projectID).Rows[0][&quot;ProjectMode&quot;].ToString());
        }

        /// &lt;summary&gt;
        /// Gets Saved attributes for a tempalte
        /// &lt;/summary&gt;
        public Dictionary&lt;int, string&gt; GetSavedAttributes(int templateId)
        {
            return ProjectComponent.Instance.GetSavedAttributes(templateId);
        }

        /// &lt;summary&gt;
        /// Gets all active attribute for a template
        /// &lt;/summary&gt;
        public Dictionary&lt;int, string&gt; GetActiveAttributes(int templateId)
        {
            return ProjectComponent.Instance.GetActiveAttributes(templateId);
        }

        /// &lt;summary&gt;
        /// Creates the Attributes HTML table for Projects view.
        /// &lt;/summary&gt;
        public int CreateAttributesHTMLTable(int ProjectID, Infragistics.WebUI.UltraWebGrid.UltraWebGrid GrdA)
        {
            try
            {
                List&lt;Project.AttributeClass&gt; attributes = GetProjectDetails(ProjectID).ProjectAttributesList;

                DataTable attributesDt = new DataTable();

                attributesDt.TableName = &quot;attributesDt&quot;;
                attributesDt.Columns.Add(&quot;AttributeName&quot;);
                attributesDt.Columns.Add(&quot;AttributeValue&quot;);
                attributesDt.Columns.Add(&quot;AttributeNotes&quot;);

                foreach (Project.AttributeClass attr in attributes)
                {
                    DataRow row = attributesDt.NewRow();
                    row[&quot;AttributeName&quot;] = attr.AttributeName;
                    row[&quot;AttributeValue&quot;] = attr.AttributeValue;
                    row[&quot;AttributeNotes&quot;] = attr.AttributeNotes;
                    attributesDt.Rows.Add(row);
                }

                GrdA.DataSource = attributesDt;
                GrdA.DataBind();

                return 1;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Checks if the user is added in a project.
        /// &lt;/summary&gt;
        internal bool CheckUserInProject(int UserID)
        {
            DataTable dt = ProjectComponent.Instance.GetProjectUsersAll();

            foreach (DataRow dr in dt.Rows)
            {
                if (dr[&quot;UserID&quot;].ToString2() == UserID.ToString2())
                    return true;
            }
            return false;
        }

        /// &lt;summary&gt;
        /// Checks if the Role is being used in any project.
        /// &lt;/summary&gt;
        internal bool CheckRoleInProject(int RoleID)
        {
            DataTable dt = ProjectComponent.Instance.GetProjectUsersAll();

            foreach (DataRow dr in dt.Rows)
            {
                if (dr[&quot;RoleID&quot;].ToString2() == RoleID.ToString2())
                    return true;
            }
            return false;
        }

        internal static string GetLibraryCatalogsXML(string catalogname, string attribute)
        {
            try
            {
                return
                    QueryInterface.Instance.GetCatalogRecords(catalogname, attribute, 0, 30, MWDateTimeHelper.MWToday.ToUtc().ToString2());
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, &quot;PROJECT&quot;);
                throw;
            }
        }

        public DataSet GetAssociatedProjectDetails(int projectID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetAssocProjUserDetails, null,
                new object[] { projectID });
        }

        public string GetProjectsXML(string typeOfData, int contractId, int projectId)
        {
            try
            {
                object data;
                if (typeOfData.Equals(&quot;Contract Details&quot;))
                {
                    data =
                        CoreDatabaseHelper.GetDataFromAssembly(Constants.MODID_CONTMGT, &quot;GetContractForMobile&quot;,
                            new object[] { contractId });

                    if (data == null)
                        return string.Empty;

                    var contractDS = (DataSet)data;

                    DataTable dtContract = new BrixDataTable(&quot;ContractDetails&quot;);
                    dtContract.Columns.AddRange(new[]
                    {
                        new DataColumn(&quot;ContractId&quot;),
                        new DataColumn(&quot;ContractCode&quot;),
                        new DataColumn(&quot;ContractName&quot;),
                        new DataColumn(&quot;ProjectId&quot;),
                        new DataColumn(&quot;PrimeContractor&quot;),
                        new DataColumn(&quot;Description&quot;),
                        new DataColumn(&quot;StartDate&quot;),
                        new DataColumn(&quot;Status&quot;),
                        new DataColumn(&quot;IsActive&quot;),
                        new DataColumn(&quot;ContractDays&quot;),
                        new DataColumn(&quot;StatusName&quot;),
                        new DataColumn(&quot;MeasurementSysID&quot;),
                    });

                    DataRow conrow = dtContract.NewRow();
                    conrow[&quot;ContractId&quot;] = contractId;
                    if (contractDS.Tables[0].Columns.Contains(&quot;Code&quot;))
                        conrow[&quot;ContractCode&quot;] = contractDS.Tables[0].Rows[0][&quot;Code&quot;];
                    if (contractDS.Tables[0].Columns.Contains(&quot;Name&quot;))
                        conrow[&quot;ContractName&quot;] = contractDS.Tables[0].Rows[0][&quot;Name&quot;];
                    if (contractDS.Tables[0].Columns.Contains(&quot;ProjectId&quot;))
                        conrow[&quot;ProjectId&quot;] = contractDS.Tables[0].Rows[0][&quot;ProjectId&quot;];
                    if (contractDS.Tables[0].Columns.Contains(&quot;Contact&quot;))
                        conrow[&quot;PrimeContractor&quot;] = contractDS.Tables[0].Rows[0][&quot;Contact&quot;];
                    if (contractDS.Tables[0].Columns.Contains(&quot;Desc&quot;))
                        conrow[&quot;Description&quot;] = contractDS.Tables[0].Rows[0][&quot;Desc&quot;];

                    if (contractDS.Tables[0].Columns.Contains(&quot;Status&quot;))
                        conrow[&quot;Status&quot;] = contractDS.Tables[0].Rows[0][&quot;Status&quot;];

                    if (contractDS.Tables[0].Columns.Contains(&quot;MeasSysID&quot;))
                        conrow[&quot;MeasurementSysID&quot;] = contractDS.Tables[0].Rows[0][&quot;MeasSysID&quot;];
                    dtContract.Rows.Add(conrow);

                    DataSet dsContractDetails = new BrixDataSet();
                    dsContractDetails.DataSetName = &quot;Records&quot;;
                    dsContractDetails.Tables.Add(dtContract.Copy());

                    return dsContractDetails.GetXml();
                }
                else if (typeOfData.Equals(&quot;Contract Attributes&quot;))
                {
                    data =
                        CoreDatabaseHelper.GetDataFromAssembly(Constants.MODID_CONTMGT, &quot;GetContractAttributes&quot;,
                            new object[] { contractId });

                    if (data == null)
                        return string.Empty;

                    var contractDS = (DataSet)data;

                    DataTable dtAttributes = new BrixDataTable(&quot;ContractAttributes&quot;);
                    dtAttributes.Columns.AddRange(new[]
                    {
                        new DataColumn(&quot;ContractId&quot;),
                        new DataColumn(&quot;AttributeName&quot;),
                        new DataColumn(&quot;AttributeValue&quot;)
                    });

                    foreach (DataRow dr in contractDS.Tables[0].Select(&quot;AttributeType &lt;&gt; &#39;LibraryCatalog&#39;&quot;))
                    {
                        DataRow attrow = dtAttributes.NewRow();
                        attrow[&quot;ContractId&quot;] = contractId;
                        attrow[&quot;AttributeName&quot;] = dr[&quot;AttributeName&quot;].ToString2();
                        attrow[&quot;AttributeValue&quot;] = dr[&quot;AttributeValue&quot;].ToString2();
                        dtAttributes.Rows.Add(attrow);
                    }

                    DataSet dsContractAtributes = new BrixDataSet();
                    dsContractAtributes.DataSetName = &quot;Records&quot;;
                    dsContractAtributes.Tables.Add(dtAttributes.Copy());

                    return dsContractAtributes.GetXml();
                }
                else if (typeOfData.Equals(&quot;Project Users&quot;))
                {
                    DataTable dtProjectUsers = Instance.GetProjectUsers(projectId);
                    Dictionary&lt;int, string&gt; rolesDict = UserManager.Instance.GetRoles();
                    Dictionary&lt;int, string&gt; adminUsers = UserManager.Instance.GetUsersInRole(1);

                    DataTable ProjectUsers = new BrixDataTable(&quot;ProjectUsers&quot;);
                    ProjectUsers.Columns.AddRange(new[]
                    {
                        new DataColumn(&quot;ContractId&quot;),
                        new DataColumn(&quot;UID&quot;),
                        new DataColumn(&quot;UserID&quot;),
                        new DataColumn(&quot;FirstName&quot;),
                        new DataColumn(&quot;MiddleName&quot;),
                        new DataColumn(&quot;LastName&quot;),
                        new DataColumn(&quot;Title&quot;),
                        new DataColumn(&quot;Company&quot;),
                        new DataColumn(&quot;Address1&quot;),
                        new DataColumn(&quot;Address2&quot;),
                        new DataColumn(&quot;Address3&quot;),
                        new DataColumn(&quot;City&quot;),
                        new DataColumn(&quot;State&quot;),
                        new DataColumn(&quot;Zipcode&quot;),
                        new DataColumn(&quot;PhoneNo&quot;),
                        new DataColumn(&quot;FaxNo&quot;),
                        new DataColumn(&quot;EmailID&quot;),
                        new DataColumn(&quot;CertNo&quot;)
                    });

                    string idList = String.Empty;
                    foreach (DataRow row in dtProjectUsers.Rows)
                    {
                        if ((&quot;,&quot; + idList + &quot;,&quot;).IndexOf((&quot;,&quot; + row[&quot;UserID&quot;].ToString() + &quot;,&quot;)) &lt; 0)
                            idList += row[&quot;UserID&quot;].ToString() + &quot;,&quot;;
                    }
                    foreach (KeyValuePair&lt;int, string&gt; pair in adminUsers)
                        if ((&quot;,&quot; + idList + &quot;,&quot;).IndexOf((&quot;,&quot; + pair.Key + &quot;,&quot;)) &lt; 0)
                            idList += pair.Key + &quot;,&quot;;

                    idList = Regex.Replace(idList, &quot;,$&quot;, &quot;&quot;);

                    DataTable userTable = UserManager.Instance.GetAllUsersDetails(idList);

                    foreach (DataRow userRow in userTable.Rows)
                    {
                        int uid = userRow[&quot;UserID&quot;].ToString2().ToInt32_2();
                        foreach (DataRow row in dtProjectUsers.Select(&quot;UserID=&quot; + uid))
                        {
                            DataRow dr = ProjectUsers.NewRow();

                            int rid = row[&quot;RoleID&quot;].ToInt32_2();

                            string strTitle;
                            rolesDict.TryGetValue(rid, out strTitle);
                            if (strTitle == null)
                                strTitle = &quot;&quot;;

                            dr[&quot;ContractId&quot;] = contractId.ToString2();
                            dr[&quot;UID&quot;] = uid;
                            dr[&quot;UserID&quot;] = userRow[&quot;UserName&quot;].ToString2();
                            dr[&quot;FirstName&quot;] = userRow[&quot;FirstName&quot;].ToString2();
                            dr[&quot;MiddleName&quot;] = userRow[&quot;MiddleName&quot;].ToString2();
                            dr[&quot;LastName&quot;] = userRow[&quot;LastName&quot;].ToString2();
                            dr[&quot;Title&quot;] = strTitle;
                            dr[&quot;Company&quot;] = userRow[&quot;CompanyName&quot;].ToString2();
                            dr[&quot;Address1&quot;] = userRow[&quot;Address1&quot;].ToString2();
                            dr[&quot;Address2&quot;] = userRow[&quot;Address2&quot;].ToString2();
                            dr[&quot;Address3&quot;] = userRow[&quot;Address3&quot;].ToString2();
                            dr[&quot;PhoneNo&quot;] = userRow[&quot;Telephone&quot;].ToString2();
                            dr[&quot;FaxNo&quot;] = userRow[&quot;Fax&quot;].ToString2();
                            dr[&quot;EmailID&quot;] = userRow[&quot;Email&quot;].ToString2();
                            dr[&quot;CertNo&quot;] = userRow[&quot;CertNo&quot;].ToString2();
                            ProjectUsers.Rows.Add(dr);
                        }
                    }

                    DataSet ds = new BrixDataSet(&quot;ProjectUsers&quot;);
                    ds.Tables.Add(ProjectUsers.Copy());

                    return ds.GetXml();
                }

                return string.Empty;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        public DataTable GetGPSProjects()
        {
            return ProjectComponent.Instance.GetGPSProjects();
        }

        public DataSet GetCIPReport(int ProjectID)
        {
            return ProjectComponent.Instance.GetCIPReport(ProjectID);
        }

        public int MapProjectInERP(string projectId, string projectGroup, string name, DateTime createdDate,
            DateTime startDate, DateTime endDate, int status)
        {
            return ProjectComponent.Instance.MapProjectInERP(projectId, projectGroup, name, createdDate, startDate,
                endDate, status);
        }

        public bool IsERPConnecterAttached()
        {
            return false; // ProjectComponent.Instance.IsERPConnecterAttached();
        }

        public DataTable GetProjectModes()
        {
            return ProjectComponent.Instance.GetProjectModes();
        }

        #region IReports

        Dictionary&lt;string, ReportType&gt; IReports.GetReportList()
        {
            var reportNames = new Dictionary&lt;string, ReportType&gt;();
            reportNames.Add(&quot;Active Projects List&quot;, ReportType.PDF);
            reportNames.Add(&quot;Inactive Projects List&quot;, ReportType.PDF);
            reportNames.Add(&quot;Project Status Report&quot;, ReportType.PDF);
            return reportNames;
        }

        MemoryStream IReports.GetReportStream(string reportName, string appPath, object[] parameters)
        {
            try
            {
                MemoryStream pdfStream = null;
                pdfStream = GetPdfStream(reportName, appPath, parameters);
                return pdfStream;
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, &quot;Error generating Report :&quot; + ex.Message, &quot;PROJECT&quot;);
                throw;
            }
        }

        string IReports.PostBackPage(string reportName)
        {
            return null;
        }

        internal MemoryStream GetPdfStream(string reportName, string appPath, object[] parameters)
        {
            var rptParams = new ReportParams();
            MemoryStream strm = null;
            string[] logoFileName = AMP3ApplicationSettings.Instance.AppLogo.Split(&#39;/&#39;);
            foreach (string strName in logoFileName)
            {
                if (strName.Contains(&quot;.&quot;))
                    rptParams.ReportLogoPath = appPath + &quot;Modules\\MODMGMT\\Images\\&quot; + strName;
            }
            //rptParams.ReportLogoPath = appPath + &quot;Modules\\CONTMGT\\Reports\\&quot; + AMP3ApplicationSettings.Instance.AppLogo;
            switch (reportName)
            {
                case &quot;Active Projects List&quot;:
                    {
                        rptParams.ReportPath = appPath + &quot;Modules\\PROJECT\\Reports\\rptProjectListReport.rpx&quot;;
                        rptParams.GetActiveProjects = true;
                        strm = GetPdfReport(0, rptParams, RPTName.ActiveProjectsList, parameters);
                        break;
                    }
                case &quot;Inactive Projects List&quot;:
                    {
                        rptParams.ReportPath = appPath + &quot;Modules\\PROJECT\\Reports\\rptProjectListReport.rpx&quot;;
                        rptParams.GetActiveProjects = false;
                        strm = GetPdfReport(0, rptParams, RPTName.InActiveProjectsList, parameters);
                        break;
                    }
                case &quot;Project Status Report&quot;:
                    {
                        rptParams.ReportPath = appPath + &quot;Modules\\PROJECT\\Reports\\rptProjectStatusReport.rpx&quot;;
                        strm = GetPdfReport(0, rptParams, RPTName.ProjectStatusReport, parameters);
                        break;
                    }
                case &quot;Project Submittals&quot;:
                    {
                        rptParams.ReportPath = appPath + &quot;Modules\\PROJECT\\Reports\\rptProjectSubmittals.rpx&quot;;
                        strm = GetPdfReport(0, rptParams, RPTName.ProjectSubmittalStatus, parameters);
                        break;
                    }
            }

            return strm;
        }

        internal MemoryStream GetPdfReport(int contractID, ReportParams rptParams, RPTName rptType, object[] paramters)
        {
            var pdf = new PdfExport();
            var rpt = new ActiveReport();
            try
            {
                var strm = new MemoryStream();
                XmlReader XReader = XmlReader.Create(rptParams.ReportPath);
                rpt.LoadLayout(XReader);
                rpt.PageSettings.Margins.Top = 0.5F;
                rpt.PageSettings.Margins.Left = 0.5F;
                rpt.PageSettings.Margins.Bottom = 0.5F;
                rpt.PageSettings.Margins.Right = 0.5F;
                rpt.PrintWidth = 7.5F;
                DataSet ds = null;
                if (File.Exists(rptParams.ReportLogoPath))
                {
                    Image logoImage = new Bitmap(rptParams.ReportLogoPath);

                    var pic = ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                    pic.Image = logoImage;

                    if (logoImage.Height &gt; pic.Height * 100 ||
                        logoImage.Width &gt; pic.Width * 100)

                        pic.SizeMode = SizeModes.Zoom;
                }

                switch (rptType)
                {
                    case RPTName.ProjectStatusReport:
                        try
                        {
                            ds = ProjectComponent.Instance.GetProjectListByStatus4PDF(paramters[0].ToInt32_2());
                            Image logoImage =
                                new Bitmap(HttpContext.Current.Server.MapPath(AMP3ApplicationSettings.Instance.AppLogo));
                            var pic = ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                            pic.Image = logoImage;
                            if (logoImage.Height &gt; pic.Height * 100 ||
                                logoImage.Width &gt; pic.Width * 100)
                                pic.SizeMode = SizeModes.Zoom;

                            ((TextBox)rpt.Sections[&quot;Detail&quot;].Controls[&quot;txtEstimatedCost&quot;]).OutputFormat =
                                ((TextBox)rpt.Sections[&quot;Detail&quot;].Controls[&quot;txtCurrentExpendtr&quot;]).OutputFormat =
                                    LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL) +
                                    AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
                        }
                        catch
                        {
                            ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]).Image = null;
                        }
                        break;
                    case RPTName.ActiveProjectsList:
                        ds = ProjectComponent.Instance.GetProjectList4PDF(1);
                        ((Label)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;lblProjectType&quot;]).Text = &quot;Active Projects&quot;;
                        try
                        {
                            Image logoImage =
                                new Bitmap(HttpContext.Current.Server.MapPath(AMP3ApplicationSettings.Instance.AppLogo));
                            var pic = ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                            pic.Image = logoImage;
                            if (logoImage.Height &gt; pic.Height * 100 ||
                                logoImage.Width &gt; pic.Width * 100)
                                pic.SizeMode = SizeModes.Zoom;
                        }
                        catch
                        {
                            ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]).Image = null;
                        }
                        break;
                    case RPTName.InActiveProjectsList:
                        ds = ProjectComponent.Instance.GetProjectList4PDF(0);
                        ((Label)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;lblProjectType&quot;]).Text = &quot;Inactive Projects&quot;;
                        try
                        {
                            Image logoImage =
                                new Bitmap(HttpContext.Current.Server.MapPath(AMP3ApplicationSettings.Instance.AppLogo));
                            var pic = ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]);
                            pic.Image = logoImage;
                            if (logoImage.Height &gt; pic.Height * 100 ||
                                logoImage.Width &gt; pic.Width * 100)
                                pic.SizeMode = SizeModes.Zoom;
                        }
                        catch
                        {
                            ((Picture)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;rptLogo&quot;]).Image = null;
                        }
                        break;
                    case RPTName.ProjectSubmittalStatus:

                        string rPath = rptParams.ReportPath.Replace(&quot;rptProjectSubmittals.rpx&quot;, &quot;&quot;);
                        if (paramters.Length &lt; 1) return null;
                        int pid = paramters[0].ToInt32_2();
                        ds = ProjectComponent.Instance.GetProjectSubmittals(pid);

                        if (ds.Tables.Count &gt; 1
                            &amp;&amp; ds.Tables[1].Rows.Count &gt; 0)
                        {
                            DataRow dr = ds.Tables[1].Rows[0];
                            if (dr.Table.Columns.Contains(&quot;ProjectCode&quot;)
                                &amp;&amp; dr[&quot;ProjectCode&quot;] != null)
                                ((TextBox)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;txtProjectCode&quot;]).Text =
                                    dr[&quot;ProjectCode&quot;].ToString2();
                            if (dr.Table.Columns.Contains(&quot;ProjectName&quot;)
                                &amp;&amp; dr[&quot;ProjectName&quot;] != null)
                                ((TextBox)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;txtProjectName&quot;]).Text =
                                    dr[&quot;ProjectName&quot;].ToString2();
                        }

                        if (ds.Tables.Count &gt; 0)
                            ds = GetReportDs(ds.Tables[0]);

                        //Past Due
                        if (ds.Tables[0].Rows.Count &gt; 0)
                        {
                            var rptSubdt = new ActiveReport();

                            XReader = XmlReader.Create(rPath + &quot;//subRptDueDate.rpx&quot;);
                            rptSubdt.LoadLayout(XReader);

                            ((Label)rptSubdt.Sections[&quot;GroupHeader1&quot;].Controls[&quot;lblDueType&quot;]).Text = &quot;Past Due Date&quot;;
                            rptSubdt.DataSource = ds.Tables[0];
                            ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate&quot;]).Report = rptSubdt;
                        }

                        //Due 7
                        if (ds.Tables[1].Rows.Count &gt; 0)
                        {
                            var rptSubdt7 = new ActiveReport();

                            XReader = XmlReader.Create(rPath + &quot;//subRptDueDate.rpx&quot;);
                            rptSubdt7.LoadLayout(XReader);

                            ((Label)rptSubdt7.Sections[&quot;GroupHeader1&quot;].Controls[&quot;lblDueType&quot;]).Text =
                                &quot;Due within 7 days&quot;;
                            rptSubdt7.DataSource = ds.Tables[1];
                            ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate7&quot;]).Report = rptSubdt7;
                        }

                        //Due 30
                        if (ds.Tables[2].Rows.Count &gt; 0)
                        {
                            var rptSubdt7_30 = new ActiveReport();

                            XReader = XmlReader.Create(rPath + &quot;//subRptDueDate.rpx&quot;);
                            rptSubdt7_30.LoadLayout(XReader);

                            ((Label)rptSubdt7_30.Sections[&quot;GroupHeader1&quot;].Controls[&quot;lblDueType&quot;]).Text =
                                &quot;Due within 7 - 30 days&quot;;
                            rptSubdt7_30.DataSource = ds.Tables[2];
                            ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate7_30&quot;]).Report = rptSubdt7_30;
                        }

                        //Due 7-30
                        if (ds.Tables[3].Rows.Count &gt; 0)
                        {
                            var rptSubdt30 = new ActiveReport();

                            XReader = XmlReader.Create(rPath + &quot;//subRptDueDate.rpx&quot;);
                            rptSubdt30.LoadLayout(XReader);

                            ((Label)rptSubdt30.Sections[&quot;GroupHeader1&quot;].Controls[&quot;lblDueType&quot;]).Text =
                                &quot;Due after 30 days&quot;;
                            rptSubdt30.DataSource = ds.Tables[3];
                            ((SubReport)rpt.Sections[&quot;Detail&quot;].Controls[&quot;subRptDueDate30&quot;]).Report = rptSubdt30;
                        }

                        ((Label)rpt.Sections[&quot;ReportHeader&quot;].Controls[&quot;lblModuleCategory&quot;]).Text = &quot;Submittals&quot;;
                        rpt.ShowParameterUI = false;
                        rpt.Run();
                        pdf.Export(rpt.Document, strm);
                        return strm;
                }

                rpt.ShowParameterUI = false;
                rpt.DataSource = ds.Tables[0];
                rpt.Run();
                pdf.Export(rpt.Document, strm);
                return strm;
            }
            catch (Exception Ex)
            {
                Logger.Log(Enumerations.LogType.Error, Ex.Message, &quot;PROJECT&quot;);
                throw;
            }
            finally
            {
                pdf.Dispose();
                rpt.Dispose();
            }
        }

        private DataSet GetReportDs(DataTable dt)
        {
            string fromDate;
            string toDate;
            DataSet ds = new BrixDataSet();

            DataRow[] rows;

            //OverDue..
            fromDate = toDate = DateTime.UtcNow.ToString();
            rows = dt.Select(&quot;DueDate&lt;&#39;&quot; + fromDate + &quot;&#39;&quot;);
            DataTable dtTemp = new BrixDataTable();
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;OverDue&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //7 days for due Date...
            fromDate = DateTime.UtcNow.ToString();
            toDate = DateTime.UtcNow.AddDays(7).ToString();
            rows = dt.Select(&quot;DueDate&gt;=&#39;&quot; + fromDate + &quot;&#39; AND DueDate&lt;=&#39;&quot; + toDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;7Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //30 days for due date...
            fromDate = DateTime.UtcNow.AddDays(7).ToString();
            toDate = DateTime.UtcNow.AddDays(30).ToString();
            rows = dt.Select(&quot;DueDate&gt;&#39;&quot; + fromDate + &quot;&#39; AND DueDate&lt;=&#39;&quot; + toDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;7-30Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            //&gt;30 days for due date...
            fromDate = DateTime.UtcNow.AddDays(30).ToString();
            rows = dt.Select(&quot;DueDate&gt;&#39;&quot; + fromDate + &quot;&#39;&quot;);
            dtTemp = dt.Clone();
            dtTemp.TableName = &quot;MoreThan30Days&quot;;

            foreach (DataRow dr in rows)
            {
                dtTemp.Rows.Add(dr.ItemArray);
            }
            ds.Tables.Add(dtTemp);

            return ds;
        }

        #endregion

        #region Measurement Systems

        public DataTable GetMeasurementSystems(string additionalInfo)
        {
            return ProjectComponent.Instance.GetMeasurementSystems(additionalInfo);
        }

        internal DataTable GetMeasurementSystem(int systemId)
        {
            return ProjectComponent.Instance.GetMeasurementSystem(systemId);
        }

        public int CreateMeasurementSystem(MeasurementSystem msDTO)
        {
            return ProjectComponent.Instance.CreateMeasurementSystem(msDTO);
        }

        internal int UpdateMeasurementSystem(MeasurementSystem msDTO)
        {
            return ProjectComponent.Instance.UpdateMeasurementSystem(msDTO);
        }

        public int DeleteMeasurementSystem(int systemId)
        {
            return ProjectComponent.Instance.DeleteMeasurementSystem(systemId);
        }

        #endregion

        #region LIBRARY Contract Type

        public DataTable GetLIBRARYContractType()
        {
            return ProjectComponent.Instance.GetLIBRARYContractType();
        }

        #endregion

        #region Measurement Units

        public DataTable GetMeasurementUnits()
        {
            return ProjectComponent.Instance.GetMeasurementUnits();
        }

        public DataTable GetMeasurementUnitsForSystem(string additionalInfo, int systemId)
        {
            return ProjectComponent.Instance.GetMeasurementUnitsForSystem(additionalInfo, systemId);
        }

        public DataTable GetMeasurementUnitsForImportItems(string moduleID, int parentInstanceID)
        {
            return ProjectComponent.Instance.GetMeasurementUnitsForImportItems(moduleID, parentInstanceID);
        }

        public int CreateMeasurementUnit(MeasurementUnit muDTO)
        {
            return ProjectComponent.Instance.CreateMeasurementUnit(muDTO);
        }

        internal int UpdateMeasurementUnit(MeasurementUnit muDTO)
        {
            return ProjectComponent.Instance.UpdateMeasurementUnit(muDTO);
        }

        public int DeleteMeasurementUnit(int unitId)
        {
            return ProjectComponent.Instance.DeleteMeasurementUnit(unitId);
        }

        #endregion

        #region Standard Tables

        /// &lt;summary&gt;
        /// Gets all Standard Tables
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetStandardTables()
        {
            return ProjectComponent.Instance.GetStandardTables();
        }

        /// &lt;summary&gt;
        /// Gets a Standard Table details
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetStandardTable(int standardTableID)
        {
            return ProjectComponent.Instance.GetStandardTable(standardTableID);
        }

        /// &lt;summary&gt;
        /// Creates a Standard Table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int CreateStandardTable(StandardTable stDTO)
        {
            return ProjectComponent.Instance.CreateStandardTable(stDTO);
        }

        /// &lt;summary&gt;
        /// Updates a Standard Table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int UpdateStandardTable(StandardTable stDTO)
        {
            return ProjectComponent.Instance.UpdateStandardTable(stDTO);
        }

        /// &lt;summary&gt;
        /// Deletes the Standard Table and also the items associated with it.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteStandardTable(int standardTableID)
        {
            return ProjectComponent.Instance.DeleteStandardTable(standardTableID);
        }

        #endregion

        public bool CheckIdDocsExists(int projectId)
        {
            DataTable dt = ProjectComponent.Instance.CheckIdDocsExists(projectId);
            if (dt.Rows.Count &gt; 0 &amp;&amp; dt.Rows[0][0].ToInt32_2() &gt; 0)
                return true;
            else
                return false;
        }

        public bool CheckIfPlannedProject(string projectId)
        {
            object obj = ProjectComponent.Instance.CheckIfPlannedProject(projectId);
            if (obj == null)
                return false;
            else
                return true;
        }

        public BrixFormModel GetProjectMetadataXMLModel(int projectID)
        {
            string projId = projectID.ToString(&quot;D4&quot;);
            BrixFormModel xmlForm = new BrixFormModel(&quot;PROJECT&quot;, &quot;PRJ&quot; + projId + &quot;.xml&quot;,
                Brix.Platform.BusinessLayer.XmlForm_Framework.XMLType.Control);
            return (xmlForm.form != null) ? xmlForm : null;
        }

        public int GetAllProjectCount()
        {
            return ProjectComponent.Instance.GetAllProjectCount();
        }

        internal DataTable GetActiveProjectsForPicker(string ErpCompany, int CurrentUserID, int RoleId,
            int SelectedUserID, string sortBy, int startIndex, int endIndex, out int totalCount, string sfilter)
        {
            return ProjectComponent.Instance.GetActiveProjectsForPicker(ErpCompany, CurrentUserID, RoleId,
                SelectedUserID, sortBy, startIndex, endIndex, out totalCount, sfilter);
        }

        /// &lt;summary&gt;
        /// This method returns no.of projects in the given project status id (PROJECTProjectStatus)
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;statusId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public int GetProjectsByStatusId(int statusId)
        {
            return
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTGetProjectCountByStatusId, null,
                    statusId).ToInt32_2();
        }


        /// &lt;summary&gt;
        /// To Validate businessUnits when we add Project to Users
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UserId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;ProjectIds&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool PROJECTValidateInvalidProjectToUsers(string ProjectIds, out string projectCodeCSV)
        {
            return ProjectComponent.Instance.PROJECTValidateInvalidProjectToUsers(ProjectIds, out projectCodeCSV);
        }

        public DataTable GetProjectsForMobileSync(int lastUserCount)
        {
            DataSet ds = ProjectComponent.Instance.GetProjectsForMobileSync(lastUserCount);
            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        public DataTable GetProjectUserRoles(int projectId, int userId)
        {
            DataSet ds = ProjectComponent.Instance.GetProjectUserRoles(projectId, userId);
            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        public bool CheckIfUserHasAccess(int projectId)
        {
            bool flag = false;
            UserDetail ud = UserDetail.GetCurrentUserDetail();

            DataTable dtProjUsers = GetProjectUsers(projectId);
            if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
            {
                if (UserManager.Instance.IsUserAdministrator(ud.UID) ||
                    (dtProjUsers.Select(&quot;UserID=&quot; + ud.UID).Length &gt; 0))
                    flag = true;
            }
            else if (ud.RID != Constants.USRMGMT_ADMIN_RID)
                if (dtProjUsers.Select(&quot;UserID=&quot; + ud.UID + &quot; and RoleID=&quot; + ud.RID).Length &gt; 0)
                    flag = true;

            return flag;
        }

        public bool CheckIfUserCreatingOrUpdatingProject_HasAccessToBusinessUnitSelected(int selectedBusinessUnitId, int userId)
        {
            List&lt;int&gt; buIdListForUser = UserManagementDAC.UserComponent.Instance.GetBusinessUnitIdList_ForUserId(userId);

            bool hasPermission = buIdListForUser.Contains(selectedBusinessUnitId);

            return hasPermission;
        }

        public void UpdateIsPublishFlag(int projectID, bool isPublished)
        {
            ProjectComponent.Instance.UpdateIsPublishFlag(projectID, isPublished);
        }

        public bool CheckConcurrency(int projectID, string timestamp)
        {
           return ProjectComponent.Instance.CheckConcurrency(projectID, timestamp);
        }

        public int CopyCalendarFromLibrary(int projectID, int calendarID, string ModifiedBy)
        {
            object obj;
            if (CoreModuleComponents.Contains(&quot;ShowForecastCalendar&quot;))
            {
                obj = ProjectComponent.Instance.CopyCalendarFromLibrary(projectID, calendarID, ModifiedBy);
            }
            else
            {
                obj = ProjectComponent.Instance.CopyCalendarFromLibraryToProject(projectID, calendarID, ModifiedBy);
            }

            if (obj != null)
            {
                return obj.ToInt32_2();
            }
            return 0;
        }

        public void UnmarkLatestCalendar(int ProjectID)
        {
            ProjectComponent.Instance.UnmarkLatestCalendar(ProjectID);
        }

        /// &lt;summary&gt;
        /// Checks if the project is added to the program
        /// This method will/should be called only when Planning Module exists
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool IsProjectAddedToProgram(int projectId)
        {
            bool isProjectAddedToProgram = false;
            DataTable dt = ProjectComponent.Instance.GetProgramDetailsForProject(projectId);

            if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
                isProjectAddedToProgram = true;

            return isProjectAddedToProgram;
        }

        public CalendarDetails GetCalendarDetails(int parentID, int calendarID)
        {
            CalendarDetails calendar = new CalendarDetails();
            int CurrentPage = 1;
            int count;
            Dictionary&lt;string, string&gt; filter = new Dictionary&lt;string, string&gt;();
            filter.Add(&quot;PID&quot;, parentID.ToString());
            filter.Add(&quot;IsLatest&quot;, &quot;1&quot;);
            DataTable dt = GetProjectCalendarList(filter);
            if (dt != null &amp;&amp; dt.Rows.Count &gt; 0)
            {
                DataRow dr = dt.Rows[0];
                calendar.ID = dr[&quot;ID&quot;].ToInt32_2();
                calendar.Name = dr[&quot;Name&quot;].ToString();

                if (!dr[&quot;CalendarType&quot;].Equals(DBNull.Value))
                    calendar.CalendarType = Convert.ToInt32(dr[&quot;CalendarType&quot;]);

                string starttime = Convert.ToString(dr[&quot;DefaultStartTime&quot;]);
                calendar.DefaultStartTime = (calendar.CalendarType == 1)
                    ? TimeSpan.Zero
                    : Convert.ToDateTime(starttime).ToMWDateTime().TimeOfDay;

                string endtime = Convert.ToString(dr[&quot;DefaultEndTime&quot;]);
                calendar.DefaultEndTime = (calendar.CalendarType == 1)
                    ? new TimeSpan(24, 0, 0)
                    : Convert.ToDateTime(endtime).ToMWDateTime().TimeOfDay;

                string hrs = Convert.ToString(dr[&quot;Hours&quot;]);
                calendar.Hours = (calendar.CalendarType == 1)
                    ? new TimeSpan(24, 0, 0)
                    : new TimeSpan(Convert.ToInt32(hrs.Substring(0, 2)), Convert.ToInt32(hrs.Substring(3, 2)), 0);

                calendar.WeekStartDay = (DayOfWeek)Enum.Parse(typeof(DayOfWeek), dr[&quot;WeekStartDay&quot;].ToString());

                calendar.WorkingDays = new List&lt;DayOfWeek&gt;();
                string workingDays = dr[&quot;WorkingDays&quot;].ToString();
                if (!string.IsNullOrEmpty(workingDays))
                    foreach (string dw in workingDays.Split(&#39;,&#39;))
                        calendar.WorkingDays.Add((DayOfWeek)Enum.Parse(typeof(DayOfWeek), dw));

                filter.Remove(&quot;PID&quot;);
                filter.Remove(&quot;IsLatest&quot;);
                filter.Add(&quot;CalendarID&quot;, calendar.ID.ToString());

                calendar.Holidays = new List&lt;DateTime&gt;();
                DataSet dsReturn = CoreDatabaseHelper.GetODSData(&quot;PROJECTCalendarHolidays&quot;, int.MaxValue, &quot;ID&quot;, null, true, ref CurrentPage, out count, null, filter);
                if (dsReturn != null &amp;&amp; dsReturn.Tables.Count &gt; 0)
                    foreach (DataRow holiday in dsReturn.Tables[0].Rows)
                        calendar.Holidays.Add(Convert.ToDateTime(holiday[&quot;Date&quot;].ToString()).ToMWDateTime().Date);
                dsReturn = null;

                if (calendar.CalendarType == 1)
                {
                    try
                    {
                        dsReturn = CoreDatabaseHelper.GetODSData(&quot;PROJECTCalendarCurve&quot;, int.MaxValue, &quot;ID&quot;, null, true,
                            ref CurrentPage, out count, null, filter);
                    }
                    catch
                    {
                    }
                    if (dsReturn != null &amp;&amp; dsReturn.Tables.Count &gt; 0)
                    {
                        int totDays = 0;
                        foreach (DataRow curve in dsReturn.Tables[0].Rows)
                        {
                            totDays += double.Parse(curve[&quot;WorkingDays&quot;].ToString()).ToInt32_2();
                            calendar.MonthWiseWorkDays.Add(new Tuple&lt;int, int&gt;(
                                double.Parse(curve[&quot;WorkingDays&quot;].ToString()).ToInt32_2(),
                                ((Months)Enum.Parse(typeof(Months), curve[&quot;Month&quot;].ToString())).ToInt32_2()));
                        }
                        calendar.TotalMonthWiseWorkDays = totDays;
                    }
                }
            }
            //if (cTime.BeginDt.HasValue)
            //{
            //    calendar.ProjectStartDate = cTime.BeginDt.Value;
            //    calendar.Days = (int)cTime.Days.Value;
            //    calendar.ProjectEndDate = cTime.CompletionDt.HasValue ? cTime.CompletionDt.Value : GetEndDate(cTime, calendar);
            //}    


            return calendar;
        }

        private DataTable GetProjectCalendarList(Dictionary&lt;string, string&gt; filter = null)
        {
            int CurrentPage = 1;
            int count;
            DataSet dsReturn = CoreDatabaseHelper.GetODSData(&quot;PROJECTCalendar&quot;, int.MaxValue, &quot;Name&quot;, null, true,
                ref CurrentPage, out count, null, filter);
            if (dsReturn != null &amp;&amp; dsReturn.Tables.Count &gt; 0)
            {
                DataTable dt = dsReturn.Tables[0];
                foreach (DataRow dr in dt.Rows)
                {
                    if (dr[&quot;CalendarType&quot;].ToInt32_2() == 1)
                        dr[&quot;Name&quot;] = &quot;{0}(Expenditure Curve)&quot;.Format2(dr[&quot;Name&quot;]);
                }
                return dt;
            }
            return null;
        }

        public void UpdateProjectWorkingDays(int projectID, int workingDays)
        {
            ProjectComponent.Instance.UpdateProjectWorkingDays(projectID, workingDays);
        }

        public DataTable GetContractDetailsForProjectUsers(int projectID, int userID)
        {
            return ProjectComponent.Instance.GetContractDetailsForProjectUsers(projectID, userID);
        }

        public void UpdateProjectContractorRoles(int projectID, string xmlData)
        {
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            ProjectComponent.Instance.UpdateProjectContractorRoles(projectID, ud.UID, xmlData);
        }

        public int DeleteUserContractorRole(int projectId, int userId)
        {
            return ProjectComponent.Instance.DeleteUserContractorRole(projectId, userId);
        }


        public CalendarDetails GetCalendarDetailsFromProject(int projectID)
        {
            if (CoreModuleComponents.Contains(&quot;ShowForecastCalendar&quot;))
            {
                DataSet ds = ProjectComponent.Instance.GetForecastCalendarDetails(projectID);
                return CalendarDetails.GetForecastCalendarDetails(ds);
            }
            else
            {
                DataSet ds = ProjectComponent.Instance.GetCalendarDetails(projectID);
                return CalendarDetails.GetCalendarDetails(ds);
            }
        }
    }


    public class ProjectsBreadCrumb : BreadCrumbBase
    {
        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        public override string Title
        {
            get { return ((IsProposedProject) ? &quot;Planned Projects&quot; : &quot;Projects&quot;); }
        }

        public override string URL
        {
            get
            {
                return ((IsProposedProject)
                    ? &quot;/Common/BrixListPage.aspx?context=PROJECT&amp;PP=1&quot;
                    : &quot;/Common/BrixListPage.aspx?context=PROJECT&quot;);
            }
        }

        public override BreadCrumbBase parent
        {
            get { return new RootBreadCrumb(); }
        }
    }

    [Context(Name = Constants.MODID_PROJECT)]
    public class ProjectBreadCrumb : BreadCrumbBase
    {
        string PID = string.Empty;
        bool isProjects = false;

        bool IsProposedProject
        {
            get
            {
                return (HttpContext.Current.Request == null ||
                        string.IsNullOrEmpty(HttpContext.Current.Request.QueryString[&quot;PP&quot;])
                    ? false
                    : (HttpContext.Current.Request.QueryString[&quot;PP&quot;] == &quot;1&quot;) ? true : false);
            }
        }

        public override string Title
        {
            get
            {
                PID = HttpContext.Current.Request.QueryString[&quot;pid&quot;];
                string projectName = string.Empty;
                try
                {
                    isProjects = string.IsNullOrEmpty(PID);
                    if (!isProjects &amp;&amp; PID != &quot;0&quot;)
                    {
                        string cacheKey = RedisKeyConstants.ProjectName + PID; // string.Format(&quot;PROJECT_NAME_{0}&quot;, PID);
                        string cachedProjName = CacheBroker.Get&lt;string&gt;(cacheKey, regionName: AMP3ApplicationSettings.Instance.RedisRegionName);

                        if (!string.IsNullOrEmpty(cachedProjName))
                            projectName = cachedProjName.ToString2();
                        else
                        {
                            // get the project name form the db and show
                            projectName = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTGETProjectTitle, null, PID).ToString();

                            if (!string.IsNullOrEmpty(projectName))
                            {
                                CacheBroker.Put(cacheKey, projectName, timeout: TimeSpan.FromMinutes(30), regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
                            }
                        }
                    }
                }
                catch (Exception)
                {
                    //Bug 15490:Fixed Server error in application is coming when PM role refresh the page in Manage users in Project page.
                    UIHelper.RedirectURL(
                        &quot;The current role does not have the required permissions to view this page.&quot;,
                        &quot;~/Modules/PLANING/Dashboard.aspx?nt=1&amp;Context=PLANING&amp;InstanceID=0&amp;Mode=View&quot;, null, HttpContext.Current);
                }
                return isProjects ? &quot;&quot; : projectName;
            }
        }

        public override string URL
        {
            get
            {
                return isProjects
                    ? &quot;&quot;
                    : (IsProposedProject)
                        ? &quot;/Modules/PROJECT/ProjectInfo.aspx?pid=&quot; + PID + &quot;&amp;PP=1&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;
                        : &quot;/Modules/PROJECT/ProjectInfo.aspx?pid=&quot; + PID + &quot;&amp;Context=PROJECT&amp;InstanceID=0&amp;Mode=View&quot;;
            }
        }

        public override BreadCrumbBase parent
        {
            get { return new ProjectsBreadCrumb(); }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[51,47,51,48,0],[51,49,51,102,0],[51,103,51,104,0],[52,42,52,43,0],[52,44,52,92,0],[52,93,52,94,0],[54,9,54,62,1],[55,9,55,62,1],[57,9,57,59,1],[62,13,62,14,1],[63,17,63,113,1],[64,17,64,49,1],[65,13,65,14,1],[71,13,71,14,1],[72,17,72,113,1],[73,17,73,49,1],[74,13,74,14,1],[80,13,80,14,1],[81,17,81,107,1],[82,17,82,46,1],[83,13,83,14,1],[89,13,89,14,1],[90,17,90,49,1],[91,21,91,82,1],[92,17,92,44,1],[93,13,93,14,1],[96,9,96,32,1],[97,9,97,10,1],[98,9,98,10,1],[100,9,100,67,1],[101,9,101,58,1],[106,9,106,10,0],[107,13,107,49,0],[111,9,111,10,0],[112,13,112,49,0],[116,9,116,10,0],[117,13,117,57,0],[118,13,118,14,0],[119,17,122,74,0],[123,17,123,71,0],[124,17,124,34,0],[125,17,125,56,0],[126,17,126,18,0],[127,21,127,55,0],[128,21,128,38,0],[129,17,129,18,0],[130,17,130,24,0],[130,26,130,36,0],[130,37,130,39,0],[130,40,130,54,0],[131,17,131,18,0],[132,21,132,91,0],[133,21,133,41,0],[134,21,134,22,0],[135,25,135,54,0],[136,25,136,73,0],[137,25,137,55,0],[138,21,138,22,0],[140,25,140,37,0],[141,17,141,18,0],[143,17,143,43,0],[144,13,144,14,0],[145,9,145,10,0],[152,9,152,10,1],[153,13,153,65,1],[154,9,154,10,1],[159,13,159,14,1],[160,17,160,81,1],[161,17,161,87,1],[162,17,166,53,1],[167,13,167,14,1],[168,17,168,18,0],[168,19,168,20,0],[173,17,173,18,1],[173,19,173,36,1],[173,37,173,38,1],[174,17,174,18,0],[174,19,174,20,0],[178,9,178,10,1],[179,13,179,83,1],[181,13,181,110,1],[182,13,182,65,1],[183,17,183,24,1],[183,26,183,37,0],[183,38,183,40,1],[183,41,183,65,1],[184,17,184,18,0],[185,21,185,91,0],[186,17,186,18,0],[187,13,187,28,1],[188,9,188,10,1],[195,9,195,10,0],[196,13,196,61,0],[197,9,197,10,0],[200,9,200,10,0],[201,13,201,40,0],[202,9,202,10,0],[211,9,211,10,1],[212,13,212,90,1],[213,9,213,10,1],[219,9,219,10,0],[220,13,220,63,0],[221,13,221,54,0],[222,9,222,10,0],[232,9,232,10,0],[233,13,233,80,0],[234,9,234,10,0],[244,9,244,10,0],[245,13,245,92,0],[246,9,246,10,0],[253,9,253,10,0],[254,13,254,76,0],[255,9,255,10,0],[264,9,264,10,1],[265,13,265,202,1],[266,9,266,10,1],[276,9,276,10,0],[277,13,278,22,0],[279,9,279,10,0],[287,9,287,10,1],[288,13,288,81,1],[289,9,289,10,1],[292,9,292,10,1],[293,13,293,89,1],[294,9,294,10,1],[300,9,300,10,0],[301,13,301,27,0],[302,13,304,60,0],[305,9,305,10,0],[312,9,312,10,0],[313,13,313,71,0],[314,17,314,28,0],[316,13,316,63,0],[317,13,317,101,0],[319,13,321,97,0],[322,9,322,10,0],[328,9,328,10,1],[329,13,329,27,1],[330,13,331,79,1],[332,9,332,10,1],[339,9,339,10,1],[340,13,340,71,1],[341,17,341,28,1],[343,13,343,63,1],[344,13,344,101,1],[346,13,349,116,1],[350,9,350,10,1],[356,9,356,10,1],[357,13,357,67,1],[358,9,358,10,1],[361,9,361,10,0],[362,13,362,70,0],[363,9,363,10,0],[366,9,366,10,0],[367,13,367,49,0],[368,17,368,74,0],[370,17,370,79,0],[371,9,371,10,0],[375,9,375,10,1],[376,13,382,60,1],[383,13,383,27,1],[384,9,384,10,1],[387,9,387,10,1],[388,13,392,60,1],[394,13,394,39,1],[395,9,395,10,1],[401,9,401,10,0],[402,13,402,97,0],[403,9,403,10,0],[409,9,409,10,0],[412,13,412,96,0],[414,13,414,47,0],[415,13,415,77,0],[416,13,416,76,0],[417,13,417,27,0],[419,13,419,20,0],[419,22,419,35,0],[419,36,419,38,0],[419,39,419,52,0],[420,13,420,14,0],[421,17,421,51,0],[422,17,422,42,0],[423,17,423,111,0],[424,17,424,42,0],[425,17,425,25,0],[426,13,426,14,0],[427,13,427,32,0],[428,9,428,10,0],[434,9,434,10,0],[437,13,437,102,0],[439,13,439,47,0],[440,13,440,77,0],[441,13,441,76,0],[442,13,442,27,0],[444,13,444,20,0],[444,22,444,35,0],[444,36,444,38,0],[444,39,444,52,0],[445,13,445,14,0],[446,17,446,51,0],[447,17,447,42,0],[448,17,448,111,0],[449,17,449,42,0],[450,17,450,25,0],[451,13,451,14,0],[452,13,452,32,0],[453,9,453,10,0],[459,9,459,10,0],[460,13,460,61,0],[461,9,461,10,0],[468,9,468,10,0],[469,13,469,77,0],[470,9,470,10,0],[479,9,479,10,1],[480,13,480,71,1],[481,17,481,28,1],[482,13,482,88,1],[483,9,483,10,1],[489,9,489,10,0],[490,13,490,74,0],[491,9,491,10,0],[500,9,500,10,1],[501,13,501,71,1],[502,17,502,28,1],[503,13,503,88,1],[504,9,504,10,1],[513,9,513,10,1],[514,13,514,96,1],[515,9,515,10,1],[522,9,522,10,1],[523,13,523,73,1],[524,9,524,10,1],[531,9,531,10,0],[532,13,532,74,0],[533,9,533,10,0],[540,9,540,10,1],[541,13,541,75,1],[542,9,542,10,1],[549,9,549,10,0],[551,13,551,89,0],[552,13,552,108,0],[553,13,553,64,0],[555,13,555,68,0],[556,13,556,86,0],[557,13,557,75,0],[558,13,558,78,0],[559,13,559,76,0],[560,13,560,81,0],[561,13,561,68,0],[562,13,562,63,0],[563,13,563,82,0],[564,13,564,77,0],[565,13,565,85,0],[567,13,567,20,0],[567,22,567,29,0],[567,30,567,32,0],[567,33,567,41,0],[568,17,568,64,0],[570,13,570,32,0],[571,9,571,10,0],[578,9,578,10,0],[579,13,579,93,0],[580,9,580,10,0],[586,9,586,10,0],[587,13,587,90,0],[588,9,588,10,0],[594,9,594,10,1],[595,13,595,71,1],[596,9,596,10,1],[602,9,602,10,0],[603,13,603,83,0],[604,9,604,10,0],[610,9,610,10,0],[611,13,611,73,0],[612,9,612,10,0],[620,9,620,10,0],[621,13,621,118,0],[622,9,622,10,0],[625,9,625,10,1],[626,13,626,154,1],[628,13,628,28,1],[631,21,631,33,1],[633,21,633,22,0],[634,25,634,170,0],[635,25,635,38,0],[638,21,638,22,0],[639,25,639,149,0],[640,25,640,38,0],[643,13,643,44,0],[644,13,644,26,0],[645,9,645,10,1],[662,9,662,10,1],[663,13,666,64,1],[667,9,667,10,1],[675,9,675,10,1],[676,13,676,85,1],[677,9,677,10,1],[680,9,680,10,1],[681,13,681,82,1],[682,9,682,10,1],[689,9,689,10,1],[690,13,690,73,1],[691,9,691,10,1],[698,9,698,10,1],[699,13,699,75,1],[700,13,700,87,1],[701,18,701,27,1],[701,29,701,46,1],[701,48,701,51,1],[702,13,702,14,1],[703,17,703,42,1],[704,17,704,86,1],[705,13,705,14,1],[707,13,707,26,1],[708,9,708,10,1],[711,9,711,10,1],[712,13,712,52,1],[713,13,713,83,1],[715,18,715,27,1],[715,29,715,46,1],[715,48,715,51,1],[716,13,716,14,1],[717,17,717,42,1],[718,17,718,59,1],[719,13,719,14,1],[721,13,721,31,1],[722,9,722,10,1],[729,9,729,10,0],[730,13,730,91,0],[731,13,733,33,0],[733,33,733,103,0],[733,103,735,32,0],[731,13,735,32,0],[736,9,736,10,0],[739,9,739,10,0],[740,13,740,84,0],[741,9,741,10,0],[747,9,747,10,0],[748,13,748,52,0],[749,9,749,10,0],[758,9,758,10,1],[759,13,759,99,1],[760,9,760,10,1],[766,9,766,10,1],[767,13,767,80,1],[768,9,768,10,1],[775,9,775,10,1],[776,13,776,69,1],[777,9,777,10,1],[784,9,784,10,1],[785,13,785,75,1],[786,9,786,10,1],[793,9,793,10,1],[794,13,794,99,1],[795,9,795,10,1],[803,9,803,10,1],[804,13,805,50,1],[806,9,806,10,1],[814,9,814,10,1],[815,13,815,84,1],[816,9,816,10,1],[823,9,823,10,1],[824,13,824,61,1],[825,9,825,10,1],[835,9,835,10,0],[896,13,896,14,0],[898,17,898,63,0],[899,17,899,105,0],[900,17,900,70,0],[901,21,901,31,0],[904,17,904,87,0],[906,17,906,41,0],[907,21,907,31,0],[909,17,909,53,0],[910,17,910,46,0],[912,17,912,52,0],[913,17,913,72,0],[914,17,914,50,0],[917,17,917,24,0],[917,26,917,37,0],[917,38,917,40,0],[917,41,917,56,0],[918,17,918,18,0],[919,21,919,105,0],[920,21,921,58,0],[922,21,922,81,0],[927,21,927,43,0],[928,21,928,22,0],[929,25,929,82,0],[930,25,930,84,0],[931,25,931,88,0],[932,25,932,88,0],[933,25,933,72,0],[934,25,934,75,0],[936,25,936,32,0],[936,34,936,46,0],[936,47,936,49,0],[936,50,936,91,0],[937,25,937,26,0],[938,29,938,93,0],[939,29,939,30,0],[940,33,940,55,0],[941,37,941,93,0],[944,29,944,30,0],[945,25,945,26,0],[946,25,946,57,0],[947,21,947,22,0],[948,17,948,18,0],[950,17,950,44,0],[952,13,952,33,0],[953,13,953,14,0],[954,17,954,93,0],[955,17,955,23,0],[957,9,957,10,0],[968,9,968,10,0],[970,13,970,14,0],[971,17,971,53,0],[972,17,972,31,0],[975,17,975,69,0],[977,17,977,34,0],[978,21,979,127,0],[981,17,981,103,0],[983,17,983,107,0],[984,17,984,18,0],[985,21,985,66,0],[986,21,986,95,0],[987,21,987,99,0],[988,21,988,28,0],[988,30,988,40,0],[988,41,988,43,0],[988,44,988,52,0],[989,21,989,22,0],[990,25,990,90,0],[991,25,991,52,0],[992,29,992,60,0],[993,21,993,22,0],[994,17,994,18,0],[996,17,996,24,0],[996,26,996,36,0],[996,37,996,39,0],[996,40,996,47,0],[997,17,997,18,0],[998,21,1005,39,0],[1007,21,1007,48,0],[1008,25,1008,31,0],[1009,17,1009,18,0],[1011,17,1011,34,0],[1012,21,1012,62,0],[1014,17,1014,46,0],[1016,13,1016,33,0],[1017,13,1017,14,0],[1018,17,1018,93,0],[1019,17,1019,23,0],[1021,9,1021,10,0],[1024,9,1024,10,1],[1025,13,1025,106,1],[1026,13,1026,99,1],[1028,13,1028,103,1],[1029,13,1029,14,0],[1030,17,1030,101,0],[1031,17,1031,95,0],[1032,17,1032,24,0],[1032,26,1032,36,0],[1032,37,1032,39,0],[1032,40,1032,48,0],[1033,17,1033,18,0],[1034,21,1034,86,0],[1035,21,1035,48,0],[1036,25,1036,56,0],[1037,17,1037,18,0],[1038,13,1038,14,0],[1040,13,1040,27,1],[1042,13,1042,20,1],[1042,22,1042,32,1],[1042,33,1042,35,1],[1042,36,1042,43,1],[1043,13,1043,14,1],[1044,17,1045,86,1],[1046,17,1046,66,1],[1047,17,1047,18,0],[1048,21,1049,90,0],[1050,21,1050,58,0],[1052,25,1053,94,0],[1054,17,1054,18,0],[1056,17,1056,39,1],[1058,17,1059,177,1],[1060,17,1060,18,1],[1061,21,1061,34,1],[1062,17,1062,18,1],[1064,17,1066,197,1],[1067,17,1067,34,1],[1068,21,1068,27,1],[1069,13,1069,14,1],[1071,13,1071,31,1],[1072,9,1072,10,1],[1074,9,1074,49,1],[1079,13,1079,14,1],[1080,17,1080,97,1],[1081,17,1081,36,1],[1082,13,1082,14,1],[1086,9,1086,10,1],[1087,13,1088,84,1],[1089,13,1089,104,1],[1090,13,1090,14,1],[1091,17,1091,88,1],[1092,17,1092,35,1],[1095,17,1095,26,0],[1096,9,1096,10,1],[1103,9,1103,10,1],[1105,13,1105,14,1],[1106,17,1106,75,1],[1107,21,1107,32,1],[1109,17,1109,145,1],[1110,17,1110,143,1],[1112,17,1114,88,1],[1116,17,1116,40,1],[1118,17,1118,109,1],[1122,17,1122,67,1],[1123,17,1123,18,1],[1125,21,1125,28,1],[1125,30,1125,40,1],[1125,41,1125,43,1],[1125,44,1125,69,1],[1126,21,1126,22,1],[1127,25,1127,109,1],[1128,25,1128,26,1],[1129,29,1129,152,1],[1130,29,1130,30,1],[1131,33,1132,145,1],[1133,29,1133,30,1],[1135,29,1135,30,0],[1136,33,1137,138,0],[1138,29,1138,30,0],[1139,25,1139,26,1],[1140,21,1140,22,1],[1141,17,1141,18,1],[1143,17,1143,91,1],[1144,17,1144,18,1],[1145,21,1145,139,1],[1146,21,1146,52,1],[1147,17,1147,18,1],[1149,17,1149,110,1],[1150,17,1150,18,1],[1151,21,1151,67,1],[1153,21,1153,69,1],[1155,21,1156,90,1],[1157,21,1157,83,1],[1158,21,1158,22,0],[1159,25,1160,94,0],[1161,25,1161,76,0],[1162,29,1162,95,0],[1163,21,1163,22,0],[1164,21,1164,172,1],[1165,21,1166,133,1],[1167,25,1167,47,1],[1169,21,1169,74,1],[1170,21,1170,49,1],[1172,21,1174,57,1],[1176,21,1176,111,1],[1177,21,1177,22,1],[1178,25,1179,42,1],[1180,25,1180,26,1],[1181,29,1182,107,1],[1183,25,1183,26,1],[1184,30,1187,49,0],[1188,25,1188,26,0],[1189,29,1190,106,0],[1191,25,1191,26,0],[1192,21,1192,22,1],[1194,21,1194,121,1],[1195,21,1195,22,0],[1196,25,1196,123,0],[1197,25,1198,95,0],[1200,25,1200,88,0],[1201,21,1201,22,0],[1202,21,1203,99,1],[1204,21,1204,22,0],[1205,25,1206,100,0],[1207,21,1207,22,0],[1209,21,1209,101,1],[1210,21,1210,22,1],[1211,25,1213,69,1],[1214,21,1214,22,1],[1216,21,1216,42,1],[1217,21,1217,22,0],[1219,25,1219,75,0],[1220,25,1220,26,0],[1221,29,1226,114,0],[1227,25,1227,26,0],[1229,25,1229,83,0],[1230,25,1230,26,0],[1231,29,1236,113,0],[1237,25,1237,26,0],[1241,25,1241,95,0],[1242,25,1242,32,0],[1242,34,1242,50,0],[1242,51,1242,53,0],[1242,54,1242,61,0],[1243,25,1243,26,0],[1244,29,1246,88,0],[1247,33,1248,108,0],[1249,25,1249,26,0],[1255,25,1256,48,0],[1258,25,1258,84,0],[1259,25,1259,26,0],[1260,29,1260,90,0],[1261,29,1261,67,0],[1262,29,1263,124,0],[1264,25,1264,26,0],[1265,21,1265,22,0],[1269,21,1269,28,1],[1269,30,1269,40,1],[1269,41,1269,43,1],[1269,44,1269,69,1],[1270,21,1270,22,1],[1271,25,1271,109,1],[1272,25,1272,26,1],[1273,29,1273,129,1],[1274,33,1274,42,1],[1276,29,1276,164,1],[1277,29,1277,30,1],[1278,33,1279,145,1],[1280,29,1280,30,1],[1282,29,1282,30,1],[1283,33,1284,138,1],[1285,29,1285,30,1],[1286,25,1286,26,1],[1288,25,1288,26,1],[1289,29,1290,74,1],[1291,29,1291,49,1],[1292,29,1292,30,1],[1293,33,1293,57,1],[1294,33,1294,34,1],[1295,37,1295,79,1],[1295,79,1295,99,1],[1295,99,1295,101,1],[1295,37,1295,101,1],[1296,37,1296,55,1],[1297,41,1297,73,1],[1298,33,1298,34,1],[1299,29,1299,30,1],[1300,29,1300,65,1],[1301,25,1301,26,1],[1302,21,1302,22,1],[1309,21,1309,42,1],[1310,21,1310,22,0],[1312,25,1312,120,0],[1314,21,1314,22,0],[1315,17,1315,18,1],[1319,17,1319,29,1],[1321,13,1321,33,0],[1322,13,1322,14,0],[1323,17,1323,93,0],[1324,17,1324,23,0],[1326,9,1326,10,1],[1333,9,1333,10,0],[1334,13,1334,77,0],[1335,9,1335,10,0],[1341,9,1341,10,0],[1342,13,1342,122,0],[1343,9,1343,10,0],[1349,9,1349,10,0],[1350,13,1350,77,0],[1351,9,1351,10,0],[1357,9,1357,10,0],[1358,13,1358,78,0],[1359,9,1359,10,0],[1365,9,1365,10,1],[1367,13,1367,14,1],[1368,17,1368,110,1],[1370,17,1370,58,1],[1372,17,1372,57,1],[1373,17,1373,59,1],[1374,17,1374,60,1],[1375,17,1375,60,1],[1377,17,1377,24,1],[1377,26,1377,53,1],[1377,54,1377,56,1],[1377,57,1377,67,1],[1378,17,1378,18,1],[1379,21,1379,57,1],[1380,21,1380,63,1],[1381,21,1381,65,1],[1382,21,1382,65,1],[1383,21,1383,48,1],[1384,17,1384,18,1],[1386,17,1386,48,1],[1387,17,1387,33,1],[1389,17,1389,26,1],[1391,13,1391,33,0],[1392,13,1392,14,0],[1393,17,1393,93,0],[1394,17,1394,23,0],[1396,9,1396,10,1],[1402,9,1402,10,0],[1403,13,1403,75,0],[1405,13,1405,20,0],[1405,22,1405,32,0],[1405,33,1405,35,0],[1405,36,1405,43,0],[1406,13,1406,14,0],[1407,17,1407,68,0],[1408,21,1408,33,0],[1409,13,1409,14,0],[1410,13,1410,26,0],[1411,9,1411,10,0],[1417,9,1417,10,0],[1418,13,1418,75,0],[1420,13,1420,20,0],[1420,22,1420,32,0],[1420,33,1420,35,0],[1420,36,1420,43,0],[1421,13,1421,14,0],[1422,17,1422,68,0],[1423,21,1423,33,0],[1424,13,1424,14,0],[1425,13,1425,26,0],[1426,9,1426,10,0],[1429,9,1429,10,0],[1431,13,1431,14,0],[1432,17,1433,140,0],[1435,13,1435,33,0],[1436,13,1436,14,0],[1437,17,1437,79,0],[1438,17,1438,23,0],[1440,9,1440,10,0],[1443,9,1443,10,0],[1444,13,1445,45,0],[1446,9,1446,10,0],[1449,9,1449,10,0],[1451,13,1451,14,0],[1453,17,1453,59,0],[1454,17,1454,18,0],[1455,21,1457,58,0],[1459,21,1459,38,0],[1460,25,1460,45,0],[1462,21,1462,52,0],[1464,21,1464,81,0],[1465,21,1479,24,0],[1481,21,1481,58,0],[1482,21,1482,55,0],[1483,21,1483,71,0],[1484,25,1484,87,0],[1485,21,1485,71,0],[1486,25,1486,87,0],[1487,21,1487,76,0],[1488,25,1488,89,0],[1489,21,1489,74,0],[1490,25,1490,93,0],[1491,21,1491,71,0],[1492,25,1492,86,0],[1494,21,1494,73,0],[1495,25,1495,83,0],[1497,21,1497,76,0],[1498,25,1498,96,0],[1499,21,1499,49,0],[1501,21,1501,67,0],[1502,21,1502,63,0],[1503,21,1503,69,0],[1505,21,1505,55,0],[1507,22,1507,67,0],[1508,17,1508,18,0],[1509,21,1511,58,0],[1513,21,1513,38,0],[1514,25,1514,45,0],[1516,21,1516,52,0],[1518,21,1518,86,0],[1519,21,1524,24,0],[1526,21,1526,28,0],[1526,30,1526,40,0],[1526,41,1526,43,0],[1526,44,1526,108,0],[1527,21,1527,22,0],[1528,25,1528,64,0],[1529,25,1529,59,0],[1530,25,1530,83,0],[1531,25,1531,85,0],[1532,25,1532,55,0],[1533,21,1533,22,0],[1535,21,1535,69,0],[1536,21,1536,65,0],[1537,21,1537,73,0],[1539,21,1539,57,0],[1541,22,1541,61,0],[1542,17,1542,18,0],[1543,21,1543,84,0],[1544,21,1544,89,0],[1545,21,1545,97,0],[1547,21,1547,80,0],[1548,21,1568,24,0],[1570,21,1570,50,0],[1571,21,1571,28,0],[1571,30,1571,41,0],[1571,42,1571,44,0],[1571,45,1571,64,0],[1572,21,1572,22,0],[1573,25,1573,102,0],[1574,29,1574,70,0],[1575,21,1575,22,0],[1576,21,1576,28,0],[1576,30,1576,60,0],[1576,61,1576,63,0],[1576,64,1576,74,0],[1577,25,1577,86,0],[1578,29,1578,54,0],[1580,21,1580,62,0],[1582,21,1582,91,0],[1584,21,1584,28,0],[1584,30,1584,45,0],[1584,46,1584,48,0],[1584,49,1584,63,0],[1585,21,1585,22,0],[1586,25,1586,77,0],[1587,25,1587,32,0],[1587,34,1587,45,0],[1587,46,1587,48,0],[1587,49,1587,87,0],[1588,25,1588,26,0],[1589,29,1589,64,0],[1591,29,1591,65,0],[1594,29,1594,70,0],[1595,29,1595,50,0],[1596,33,1596,47,0],[1598,29,1598,71,0],[1599,29,1599,45,0],[1600,29,1600,76,0],[1601,29,1601,80,0],[1602,29,1602,82,0],[1603,29,1603,78,0],[1604,29,1604,52,0],[1605,29,1605,80,0],[1606,29,1606,78,0],[1607,29,1607,78,0],[1608,29,1608,78,0],[1609,29,1609,78,0],[1610,29,1610,70,0],[1611,29,1611,74,0],[1612,29,1612,74,0],[1613,29,1613,55,0],[1614,25,1614,26,0],[1615,21,1615,22,0],[1617,21,1617,66,0],[1618,21,1618,56,0],[1620,21,1620,40,0],[1623,17,1623,37,0],[1625,13,1625,33,0],[1626,13,1626,14,0],[1627,17,1627,93,0],[1628,17,1628,23,0],[1630,9,1630,10,0],[1633,9,1633,10,0],[1634,13,1634,63,0],[1635,9,1635,10,0],[1638,9,1638,10,0],[1639,13,1639,70,0],[1640,9,1640,10,0],[1644,9,1644,10,0],[1645,13,1646,34,0],[1647,9,1647,10,0],[1650,9,1650,10,1],[1651,13,1651,26,1],[1652,9,1652,10,1],[1655,9,1655,10,0],[1656,13,1656,64,0],[1657,9,1657,10,0],[1662,9,1662,10,0],[1663,13,1663,68,0],[1664,13,1664,69,0],[1665,13,1665,71,0],[1666,13,1666,70,0],[1667,13,1667,32,0],[1668,9,1668,10,0],[1671,9,1671,10,0],[1673,13,1673,14,0],[1674,17,1674,47,0],[1675,17,1675,75,0],[1676,17,1676,34,0],[1678,13,1678,33,0],[1679,13,1679,14,0],[1680,17,1680,109,0],[1681,17,1681,23,0],[1683,9,1683,10,0],[1686,9,1686,10,0],[1687,13,1687,25,0],[1688,9,1688,10,0],[1691,9,1691,10,0],[1692,13,1692,48,0],[1693,13,1693,38,0],[1694,13,1694,89,0],[1695,13,1695,20,0],[1695,22,1695,36,0],[1695,37,1695,39,0],[1695,40,1695,52,0],[1696,13,1696,14,0],[1697,17,1697,43,0],[1698,21,1698,97,0],[1699,13,1699,14,0],[1701,13,1701,32,0],[1704,21,1704,22,0],[1705,25,1705,112,0],[1706,25,1706,60,0],[1707,25,1707,99,0],[1708,25,1708,31,0],[1711,21,1711,22,0],[1712,25,1712,112,0],[1713,25,1713,61,0],[1714,25,1714,101,0],[1715,25,1715,31,0],[1718,21,1718,22,0],[1719,25,1719,114,0],[1720,25,1720,100,0],[1721,25,1721,31,0],[1724,21,1724,22,0],[1725,25,1725,112,0],[1726,25,1726,103,0],[1727,25,1727,31,0],[1731,13,1731,25,0],[1732,9,1732,10,0],[1735,9,1735,10,0],[1736,13,1736,39,0],[1737,13,1737,42,0],[1739,13,1739,14,0],[1740,17,1740,47,0],[1741,17,1741,76,0],[1742,17,1742,41,0],[1743,17,1743,53,0],[1744,17,1744,54,0],[1745,17,1745,56,0],[1746,17,1746,55,0],[1747,17,1747,39,0],[1748,17,1748,35,0],[1749,17,1749,59,0],[1750,17,1750,18,0],[1751,21,1751,76,0],[1753,21,1753,91,0],[1754,21,1754,43,0],[1756,21,1757,59,0],[1759,25,1759,55,0],[1760,17,1760,18,0],[1762,17,1762,33,0],[1766,25,1766,26,0],[1767,29,1767,113,0],[1768,29,1769,122,0],[1770,29,1770,99,0],[1771,29,1771,51,0],[1772,29,1773,67,0],[1774,33,1774,63,0],[1776,29,1779,84,0],[1780,25,1780,26,0],[1781,25,1781,30,0],[1782,25,1782,26,0],[1783,29,1783,102,0],[1784,25,1784,26,0],[1785,25,1785,31,0],[1787,25,1787,78,0],[1788,25,1788,115,0],[1790,25,1790,26,0],[1791,29,1792,122,0],[1793,29,1793,99,0],[1794,29,1794,51,0],[1795,29,1796,67,0],[1797,33,1797,63,0],[1798,25,1798,26,0],[1799,25,1799,30,0],[1800,25,1800,26,0],[1801,29,1801,102,0],[1802,25,1802,26,0],[1803,25,1803,31,0],[1805,25,1805,78,0],[1806,25,1806,117,0],[1808,25,1808,26,0],[1809,29,1810,122,0],[1811,29,1811,99,0],[1812,29,1812,51,0],[1813,29,1814,67,0],[1815,33,1815,63,0],[1816,25,1816,26,0],[1817,25,1817,30,0],[1818,25,1818,26,0],[1819,29,1819,102,0],[1820,25,1820,26,0],[1821,25,1821,31,0],[1824,25,1824,101,0],[1825,25,1825,50,0],[1825,51,1825,63,0],[1826,25,1826,60,0],[1827,25,1827,82,0],[1829,25,1830,60,0],[1831,25,1831,26,0],[1832,29,1832,63,0],[1833,29,1834,62,0],[1835,33,1836,67,0],[1837,29,1838,62,0],[1839,33,1840,67,0],[1841,25,1841,26,0],[1843,25,1843,49,0],[1844,29,1844,60,0],[1847,25,1847,57,0],[1848,25,1848,26,0],[1849,29,1849,63,0],[1851,29,1851,87,0],[1852,29,1852,58,0],[1854,29,1854,118,0],[1855,29,1855,64,0],[1856,29,1856,109,0],[1857,25,1857,26,0],[1860,25,1860,57,0],[1861,25,1861,26,0],[1862,29,1862,64,0],[1864,29,1864,87,0],[1865,29,1865,59,0],[1867,29,1868,53,0],[1869,29,1869,65,0],[1870,29,1870,111,0],[1871,25,1871,26,0],[1874,25,1874,57,0],[1875,25,1875,26,0],[1876,29,1876,67,0],[1878,29,1878,87,0],[1879,29,1879,62,0],[1881,29,1882,58,0],[1883,29,1883,68,0],[1884,29,1884,117,0],[1885,25,1885,26,0],[1888,25,1888,57,0],[1889,25,1889,26,0],[1890,29,1890,65,0],[1892,29,1892,87,0],[1893,29,1893,60,0],[1895,29,1896,53,0],[1897,29,1897,66,0],[1898,29,1898,113,0],[1899,25,1899,26,0],[1901,25,1901,113,0],[1902,25,1902,53,0],[1903,25,1903,35,0],[1904,25,1904,56,0],[1905,25,1905,37,0],[1908,17,1908,45,0],[1909,17,1909,47,0],[1910,17,1910,27,0],[1911,17,1911,48,0],[1912,17,1912,29,0],[1914,13,1914,33,0],[1915,13,1915,14,0],[1916,17,1916,79,0],[1917,17,1917,23,0],[1920,13,1920,14,0],[1921,17,1921,31,0],[1922,17,1922,31,0],[1923,13,1923,14,0],[1924,9,1924,10,0],[1927,9,1927,10,0],[1930,13,1930,44,0],[1935,13,1935,60,0],[1936,13,1936,60,0],[1937,13,1937,52,0],[1938,13,1938,33,0],[1939,13,1939,42,0],[1941,13,1941,20,0],[1941,22,1941,32,0],[1941,33,1941,35,0],[1941,36,1941,40,0],[1942,13,1942,14,0],[1943,17,1943,47,0],[1944,13,1944,14,0],[1945,13,1945,35,0],[1948,13,1948,51,0],[1949,13,1949,60,0],[1950,13,1950,91,0],[1951,13,1951,33,0],[1952,13,1952,40,0],[1954,13,1954,20,0],[1954,22,1954,32,0],[1954,33,1954,35,0],[1954,36,1954,40,0],[1955,13,1955,14,0],[1956,17,1956,47,0],[1957,13,1957,14,0],[1958,13,1958,35,0],[1961,13,1961,62,0],[1962,13,1962,61,0],[1963,13,1963,90,0],[1964,13,1964,33,0],[1965,13,1965,43,0],[1967,13,1967,20,0],[1967,22,1967,32,0],[1967,33,1967,35,0],[1967,36,1967,40,0],[1968,13,1968,14,0],[1969,17,1969,47,0],[1970,13,1970,14,0],[1971,13,1971,35,0],[1974,13,1974,63,0],[1975,13,1975,60,0],[1976,13,1976,33,0],[1977,13,1977,49,0],[1979,13,1979,20,0],[1979,22,1979,32,0],[1979,33,1979,35,0],[1979,36,1979,40,0],[1980,13,1980,14,0],[1981,17,1981,47,0],[1982,13,1982,14,0],[1983,13,1983,35,0],[1985,13,1985,23,0],[1986,9,1986,10,0],[1993,9,1993,10,1],[1994,13,1994,84,1],[1995,9,1995,10,1],[1998,9,1998,10,0],[1999,13,1999,77,0],[2000,9,2000,10,0],[2003,9,2003,10,0],[2004,13,2004,77,0],[2005,9,2005,10,0],[2008,9,2008,10,0],[2009,13,2009,77,0],[2010,9,2010,10,0],[2013,9,2013,10,0],[2014,13,2014,80,0],[2015,9,2015,10,0],[2022,9,2022,10,0],[2023,13,2023,71,0],[2024,9,2024,10,0],[2031,9,2031,10,0],[2032,13,2032,68,0],[2033,9,2033,10,0],[2036,9,2036,10,0],[2037,13,2037,101,0],[2038,9,2038,10,0],[2041,9,2041,10,0],[2042,13,2042,108,0],[2043,9,2043,10,0],[2046,9,2046,10,0],[2047,13,2047,75,0],[2048,9,2048,10,0],[2051,9,2051,10,0],[2052,13,2052,75,0],[2053,9,2053,10,0],[2056,9,2056,10,0],[2057,13,2057,76,0],[2058,9,2058,10,0],[2069,9,2069,10,1],[2070,13,2070,66,1],[2071,9,2071,10,1],[2079,9,2079,10,1],[2080,13,2080,80,1],[2081,9,2081,10,1],[2089,9,2089,10,1],[2090,13,2090,73,1],[2091,9,2091,10,1],[2099,9,2099,10,0],[2100,13,2100,73,0],[2101,9,2101,10,0],[2109,9,2109,10,0],[2110,13,2110,83,0],[2111,9,2111,10,0],[2116,9,2116,10,1],[2117,13,2117,83,1],[2118,13,2118,68,1],[2119,17,2119,29,0],[2121,17,2121,30,1],[2122,9,2122,10,1],[2125,9,2125,10,1],[2126,13,2126,85,1],[2127,13,2127,29,1],[2128,17,2128,30,1],[2130,17,2130,29,0],[2131,9,2131,10,1],[2134,9,2134,10,1],[2135,13,2135,54,1],[2136,13,2137,80,1],[2138,13,2138,60,1],[2139,9,2139,10,1],[2142,9,2142,10,0],[2143,13,2143,67,0],[2144,9,2144,10,0],[2148,9,2148,10,1],[2149,13,2150,88,1],[2151,9,2151,10,1],[2159,9,2159,10,1],[2160,13,2162,43,1],[2163,9,2163,10,1],[2173,9,2173,10,1],[2174,13,2174,115,1],[2175,9,2175,10,1],[2178,9,2178,10,0],[2179,13,2179,92,0],[2180,13,2180,51,0],[2181,17,2181,37,0],[2183,17,2183,29,0],[2184,9,2184,10,0],[2187,9,2187,10,1],[2188,13,2188,91,1],[2189,13,2189,51,1],[2190,17,2190,37,1],[2192,17,2192,29,0],[2193,9,2193,10,1],[2196,9,2196,10,1],[2197,13,2197,31,1],[2198,13,2198,63,1],[2200,13,2200,64,1],[2201,13,2201,71,1],[2202,13,2202,14,1],[2203,17,2204,73,1],[2205,21,2205,33,1],[2206,13,2206,14,1],[2207,18,2207,60,0],[2208,17,2208,97,0],[2209,21,2209,33,0],[2211,13,2211,25,1],[2212,9,2212,10,1],[2215,9,2215,10,1],[2216,13,2216,122,1],[2218,13,2218,83,1],[2220,13,2220,34,1],[2221,9,2221,10,1],[2224,9,2224,10,1],[2225,13,2225,83,1],[2226,9,2226,10,1],[2229,9,2229,10,1],[2230,12,2230,84,1],[2231,9,2231,10,1],[2234,9,2234,10,0],[2236,13,2236,71,0],[2237,13,2237,14,0],[2238,17,2238,108,0],[2239,13,2239,14,0],[2241,13,2241,14,0],[2242,17,2242,117,0],[2243,13,2243,14,0],[2245,13,2245,29,0],[2246,13,2246,14,0],[2247,17,2247,40,0],[2249,13,2249,22,0],[2250,9,2250,10,0],[2253,9,2253,10,0],[2254,13,2254,71,0],[2255,9,2255,10,0],[2264,9,2264,10,1],[2265,13,2265,50,1],[2266,13,2266,93,1],[2268,13,2268,49,1],[2269,17,2269,48,0],[2271,13,2271,44,1],[2272,9,2272,10,1],[2275,9,2275,10,0],[2276,13,2276,62,0],[2277,13,2277,33,0],[2279,13,2279,82,0],[2280,13,2280,52,0],[2281,13,2281,41,0],[2282,13,2282,59,0],[2283,13,2283,49,0],[2284,13,2284,14,0],[2285,17,2285,41,0],[2286,17,2286,52,0],[2287,17,2287,55,0],[2289,17,2289,62,0],[2290,21,2290,81,0],[2292,17,2292,77,0],[2293,17,2295,78,0],[2297,17,2297,73,0],[2298,17,2300,76,0],[2302,17,2302,60,0],[2303,17,2305,115,0],[2307,17,2307,113,0],[2309,17,2309,62,0],[2310,17,2310,67,0],[2311,17,2311,56,0],[2312,21,2312,28,0],[2312,30,2312,39,0],[2312,40,2312,42,0],[2312,43,2312,65,0],[2313,25,2313,96,0],[2315,17,2315,38,0],[2316,17,2316,43,0],[2317,17,2317,66,0],[2319,17,2319,58,0],[2320,17,2320,167,0],[2321,17,2321,67,0],[2322,21,2322,28,0],[2322,30,2322,45,0],[2322,46,2322,48,0],[2322,49,2322,72,0],[2323,25,2323,115,0],[2324,17,2324,33,0],[2326,17,2326,48,0],[2327,17,2327,18,0],[2329,21,2329,22,0],[2330,25,2331,71,0],[2332,21,2332,22,0],[2333,21,2333,26,0],[2334,21,2334,22,0],[2335,21,2335,22,0],[2336,21,2336,71,0],[2337,21,2337,22,0],[2338,25,2338,41,0],[2339,25,2339,32,0],[2339,34,2339,47,0],[2339,48,2339,50,0],[2339,51,2339,74,0],[2340,25,2340,26,0],[2341,29,2341,98,0],[2342,29,2344,111,0],[2345,25,2345,26,0],[2346,25,2346,67,0],[2347,21,2347,22,0],[2348,17,2348,18,0],[2349,13,2349,14,0],[2358,13,2358,29,0],[2359,9,2359,10,0],[2362,9,2362,10,0],[2363,13,2363,33,0],[2365,13,2366,59,0],[2367,13,2367,63,0],[2368,13,2368,14,0],[2369,17,2369,51,0],[2370,17,2370,24,0],[2370,26,2370,36,0],[2370,37,2370,39,0],[2370,40,2370,47,0],[2371,17,2371,18,0],[2372,21,2372,61,0],[2373,25,2373,83,0],[2374,17,2374,18,0],[2375,17,2375,27,0],[2377,13,2377,25,0],[2378,9,2378,10,0],[2381,9,2381,10,0],[2382,13,2382,88,0],[2383,9,2383,10,0],[2386,9,2386,10,0],[2387,13,2387,99,0],[2388,9,2388,10,0],[2391,9,2391,10,0],[2392,13,2392,63,0],[2393,13,2393,96,0],[2394,9,2394,10,0],[2397,9,2397,10,1],[2398,13,2398,90,1],[2399,9,2399,10,1],[2403,9,2403,10,1],[2404,13,2404,71,1],[2405,13,2405,14,0],[2406,17,2406,94,0],[2407,17,2407,71,0],[2410,13,2410,14,1],[2411,17,2411,86,1],[2412,17,2412,63,1],[2414,9,2414,10,1],[2423,13,2423,14,1],[2424,17,2427,94,1],[2428,13,2428,14,1],[2433,17,2433,18,1],[2433,19,2433,82,1],[2433,83,2433,84,1],[2439,13,2439,14,1],[2440,17,2442,68,1],[2443,13,2443,14,1],[2448,17,2448,18,1],[2448,19,2448,47,1],[2448,48,2448,49,1],[2455,9,2455,35,1],[2456,9,2456,33,1],[2461,13,2461,14,1],[2462,17,2465,94,1],[2466,13,2466,14,1],[2472,13,2472,14,1],[2473,17,2473,70,1],[2474,17,2474,51,1],[2476,17,2476,18,1],[2477,21,2477,60,1],[2478,21,2478,51,1],[2479,21,2479,22,1],[2480,25,2480,79,1],[2481,25,2481,145,1],[2483,25,2483,67,1],[2484,29,2484,70,1],[2486,25,2486,26,1],[2488,29,2488,148,1],[2490,29,2490,68,1],[2491,29,2491,30,1],[2492,33,2492,169,1],[2493,29,2493,30,1],[2494,25,2494,26,1],[2495,21,2495,22,1],[2496,17,2496,18,1],[2497,17,2497,34,0],[2498,17,2498,18,0],[2500,21,2502,132,0],[2503,17,2503,18,0],[2504,17,2504,54,1],[2505,13,2505,14,1],[2511,13,2511,14,1],[2512,17,2516,118,1],[2517,13,2517,14,1],[2522,17,2522,18,1],[2522,19,2522,51,1],[2522,52,2522,53,1]]);
    </script>
  </body>
</html>