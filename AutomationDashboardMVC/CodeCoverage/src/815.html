<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\ItemManager.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using System.Xml;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.BusinessLayer.DTO;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.ProjectDAC;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Common.Utility;

namespace Aurigo.AMP3.Core.BusinessLayer.BL
{
    public class ItemManager : SingletonManagerBase&lt;ItemManager&gt;
    {
        private ItemManager()   
        {
        }

        public DataSet GetItemPickerData(int standardTableID, string AXCompany)
        {
            int currentpage = 0, pagecount = 0;
            return GetItemPickerData(int.MaxValue, null, standardTableID, string.Empty, ref currentpage,
                out pagecount, AXCompany);
        }

        public DataSet GetPickerSchema()
        {
            return ComponentHelper.Instance.ExecuteDataSet(&quot;exec usp_CORITEMGetItemPickerSchema&quot;);
        }

        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, bool? SendParentInstances,
            string FilterText, string CurrentModuleID, int? CurrentParentInstanceID,
            string AXCompany)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetItemDetails, null, moduleId,
                parentInstanceId, itemId, SendParentInstances, FilterText,
                null, CurrentModuleID, CurrentParentInstanceID, false,
                null, AXCompany, null);
        }

        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, bool? SendParentInstances,
            string FilterText, string sortOrder, string CurrentModuleID,
            int? CurrentParentInstanceID, bool Pagination, int PageSize,
            ref int CurrentPage, out int Pagecount, string AXCompany)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            dic[&quot;CurrentPage&quot;] = CurrentPage;
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetItemDetails, dic,
                moduleId, parentInstanceId, itemId,
                SendParentInstances, FilterText, sortOrder,
                CurrentModuleID, CurrentParentInstanceID,
                Pagination, PageSize, AXCompany, null);
            Int32.TryParse(dic[&quot;PageCount&quot;].ToString2(), out Pagecount);
            Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString2(), out CurrentPage);
            return ds;
        }

        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, bool? SendParentInstances,
            string FilterText, string sortOrder, string CurrentModuleID,
            int? CurrentParentInstanceID, bool Pagination, int PageSize,
            ref int CurrentPage, out int Pagecount, string AXCompany, out int totalRows, string filterQuery)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            dic[&quot;CurrentPage&quot;] = CurrentPage;
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetItemDetails, dic,
                moduleId, parentInstanceId, itemId,
                SendParentInstances, FilterText, sortOrder,
                CurrentModuleID, CurrentParentInstanceID,
                Pagination, PageSize, AXCompany, (filterQuery != null) ? filterQuery.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) : filterQuery);

            Int32.TryParse(dic[&quot;PageCount&quot;].ToString2(), out Pagecount);
            Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString2(), out CurrentPage);
            Int32.TryParse(dic[&quot;TotalRows&quot;].ToString2(), out totalRows);
            return ds;
        }


        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, bool? SendParentInstances,
            string FilterText)
        {
            return GetItemPickerData(moduleId, parentInstanceId, itemId, SendParentInstances, FilterText, null, null,
                null);
        }

        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, string FilterText,
            string CurrentModuleID, int CurrentParentInstanceID)
        {
            return GetItemPickerData(moduleId, parentInstanceId, itemId, null, FilterText, CurrentModuleID,
                CurrentParentInstanceID, null);
        }

        public DataSet GetItemPickerData(string moduleId, int parentInstanceId, int? itemId, string FilterText)
        {
            return GetItemPickerData(moduleId, parentInstanceId, itemId, null, FilterText, String.Empty, null, null);
        }

        public DataSet GetItemPickerData(int maxRowsInPage, string sortOrder, int standardTableID, string Filter,
            ref int CurrentPage, out int pageCount, string AXCompany)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            dic[&quot;CurrentPage&quot;] = CurrentPage;
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetStdItems, dic,
                maxRowsInPage, sortOrder, standardTableID.ToString2(), Filter, AXCompany, null);
            Int32.TryParse(dic[&quot;PageCount&quot;].ToString2(), out pageCount);
            Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString2(), out CurrentPage);
            return ds;
        }

        public DataSet GetItemPickerData(int maxRowsInPage, string sortOrder, int standardTableID, string Filter,
            ref int CurrentPage, out int pageCount, string AXCompany, string filterQuery, out int totalRows)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            dic[&quot;CurrentPage&quot;] = CurrentPage;
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetStdItems, dic,
                maxRowsInPage, sortOrder, standardTableID.ToString2(), Filter, AXCompany,
                (filterQuery != null) ? filterQuery.Replace(&quot;&#39;&quot;, &quot;&#39;&#39;&quot;) : filterQuery);
            Int32.TryParse(dic[&quot;PageCount&quot;].ToString2(), out pageCount);
            Int32.TryParse(dic[&quot;CurrentPage&quot;].ToString2(), out CurrentPage);
            Int32.TryParse(dic[&quot;TotalRows&quot;].ToString2(), out totalRows);
            return ds;
        }

        public Item GetItemDetails(string moduleID, int parentInstanceID, int itemID)
        {
            return GetItemDetails(moduleID, parentInstanceID, itemID, false);
        }

        public Item GetItemDetails(string moduleID, int parentInstanceID, int itemID, bool isContractView)
        {
            var itemDetails = new Item();

            string filter = String.Empty;
            if (isContractView)
                filter = string.Format(&quot;&lt;XMLRoot&gt;&lt;IsContractView&gt;{0}&lt;/IsContractView&gt;&lt;/XMLRoot&gt;&quot;, true);

            using (
                IDataReader dr = ComponentHelper.Instance.ExecuteReader(StoredProcedure.usp_CORITEMGetItemDetails,
                    null, moduleID, parentInstanceID, itemID,
                    null, filter, null, string.Empty, null,
                    false, null, null, null))
            {
                while (dr.Read())
                    ComponentHelper.CopyDataReaderToDto(dr, itemDetails);
            }
            return itemDetails;
        }

        public int SaveItemDetails(Item itemDetails)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;ItemID&quot;] = itemDetails.ItemID;

                ComponentHelper.Instance.ExecuteNonQuery(StoredProcedure.usp_CORITEMCUItemDetails, dic, itemDetails);

                int itemId;
                int.TryParse(dic[&quot;ItemID&quot;].ToString2(), out itemId);
                return itemId;
            }
        }

        public DataSet GetWPforBudgetItems(int Pid, int ParentId)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PLANINGGetWPforBudgetItems, dic,
                Pid, ParentId);
            return ds;
        }

        public void DeleteItemDetails(string itemIDList, bool? isNonContract)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Output&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_CORITEMDeleteItems,
                    dic, itemIDList, isNonContract);
                string result = dic[&quot;Output&quot;].ToString2();
                if (!string.IsNullOrEmpty(result))
                {
                    string msg = &quot;Cannot delete selected item(s) as they are associated with&quot;;

                    string[] res = result.Split(new[] { &#39;,&#39; }, StringSplitOptions.RemoveEmptyEntries);
                    foreach (string str in res)
                    {
                        switch (str)
                        {
                            case &quot;CI&quot;:
                                msg =
                                    &quot;One or more of the selected item(s) is marked contract. Cannot delete Contract Items after locking&quot;;
                                break;
                            case &quot;MI&quot;:
                                msg += &quot; Material Issue,&quot;;
                                break;
                            case &quot;SP&quot;:
                                msg += &quot; Spare Part Issue,&quot;;
                                break;
                            case &quot;IP&quot;:
                                msg += &quot; Item Posting,&quot;;
                                break;
                            case &quot;CO&quot;:
                                msg += &quot; Change Order,&quot;;
                                break;
                            case &quot;WO&quot;:
                                msg += &quot; Work Order,&quot;;
                                break;
                            case &quot;MOH&quot;:
                                msg += &quot; Material On Hand,&quot;;
                                break;
                            case &quot;SM&quot;:
                                msg += &quot; Submittals,&quot;;
                                break;
                        }
                    }

                    msg = msg.TrimEnd(&#39;,&#39;) + &quot;.Request Denied&quot;;

                    throw new Exception(msg);
                }
            }
        }

        public DataSet GetSubItemData(string moduleID, int parentInstanceID, int itemID)
        {
            return GetSubItemData(moduleID, parentInstanceID, itemID, false);
        }

        public DataSet GetSubItemData(string moduleID, int parentInstanceID, int itemID, bool isContractView)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetSubItems, null, moduleID,
                parentInstanceID, itemID, isContractView);
        }

        public DataSet GetSubItemDataByItemIdList(string moduleID, int parentInstanceID, List&lt;int&gt; itemIdList)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetSubItemsByItemIdList, null, moduleID, parentInstanceID, string.Join(&quot;,&quot;, itemIdList), false);
        }

        public SubItem GetSubItem(string moduleID, int parentInstanceID, int subItemID)
        {
            var subItemDetails = new SubItem();
            try
            {
                using (
                    IDataReader dr = ComponentHelper.Instance.ExecuteReader(StoredProcedure.usp_CORITEMGetSubItem,
                        null, moduleID, parentInstanceID,
                        subItemID))
                {
                    if (dr.Read())
                        ComponentHelper.CopyDataReaderToDto(dr, subItemDetails);
                }
            }
            catch
            {
                return null;
            }
            return subItemDetails;
        }

        public int SaveSubItem(SubItem subItemDTO)
        {
            lock (_oSync)
            {
                // PASS THE DTO TO THE SP AND FIRE IT ON THE DATABASE
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Output&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQuery(StoredProcedure.usp_CORITEMCUSubItem, dic, subItemDTO);
                int SubItemID;
                int.TryParse(dic[&quot;Output&quot;].ToString2(), out SubItemID);
                return SubItemID;
            }
        }

        public void DeleteSubItem(string subItemIDList)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Output&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMDeleteSubItems, dic, subItemIDList);
                int result = 0;
                int.TryParse(dic[&quot;Output&quot;].ToString2(), out result);
                if (result == -1)
                    throw new Exception(
                        &quot;Cannot delete SubItem since it is associated with a material issue or a spare parts issue&quot;);
            }
        }

        public DataSet GetRateAnalysis(string moduleID, int parentInstanceID, int itemID)
        {
            return GetRateAnalysis(moduleID, parentInstanceID, itemID, false);
        }

        public DataSet GetRateAnalysis(string moduleID, int parentInstanceID, int itemID, bool includeOverheads)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetRateAnalysis, null,
                moduleID, parentInstanceID, itemID, null,
                includeOverheads, false);
        }

        public Resource GetRateAnalysis(int resDetailID)
        {
            var resDetails = new Resource();
            try
            {
                using (
                    IDataReader dr =
                        ComponentHelper.Instance.ExecuteReader(StoredProcedure.usp_CORITEMGetRateAnalysis, null,
                            null, null, null, resDetailID, true, true))
                {
                    if (dr.Read())
                        ComponentHelper.CopyDataReaderToDto(dr, resDetails);
                }
            }
            catch
            {
                return null;
            }
            return resDetails;
        }

        public void DeleteResourceDetails(int itemID)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_CORITEMDeleteResourceDetails, null, itemID);
        }

        public DataTable GetOverheadRateAnalysis(string moduleID, int parentInstanceID, int itemID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadRateAnalysis, null,
                moduleID, parentInstanceID, itemID).Tables[0];
        }

        public int SaveRateAnalysisDetails(Resource resourceDetails)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;ResourceDetailID&quot;] = resourceDetails.ResourceDetailID;

                ComponentHelper.Instance.ExecuteNonQuery(StoredProcedure.usp_CORITEMCURateAnalysisDetails, dic,
                    resourceDetails);
                int ResourceDetailID;
                int.TryParse(dic[&quot;ResourceDetailID&quot;].ToString2(), out ResourceDetailID);
                return ResourceDetailID;
            }
        }

        public void DeleteRateAnalysis(string resourceDetailIDList)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMDeleteRateAnalysis, null, resourceDetailIDList);
            }
        }

        public object GetSubItemQuantity(int itemID, string moduleID, int? parentInstanceID)
        {
            return GetSubItemQuantity(itemID, moduleID, parentInstanceID, false);
        }

        public object GetSubItemQuantity(int itemID, string moduleID, int? parentInstanceID, bool isContractView)
        {
            object retVal = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetSubItemQuantity,
                null,
                new object[]
                {
                    itemID, moduleID, parentInstanceID,
                    isContractView
                });

            return retVal; // is decimal ? BrixDatatypeHelper.ToDecimal2(retVal) : 0;
        }

        public DataTable GetResourceTypes()
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetResourceTypes, null, null);
            return ds.Tables[0];
        }

        public void CopyRateAnalysisFromSrcItem(string SrcModuleID, int? SrcParentInstanceID, int SrcItemID,
            string DestModuleID, int DestParentInstanceID, int DestItemID,
            bool CopyQty)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCopyRateAnalysisFromSrcItem, null, SrcModuleID, SrcParentInstanceID,
                    SrcItemID, DestModuleID, DestParentInstanceID, DestItemID, CopyQty ? &quot;Y&quot; : &quot;N&quot;);
            }
        }

        public void CopySubItemsFromSrcItem(string SrcModuleID, int SrcParentInstanceID, int SrcItemID,
            string DestModuleID, int DestParentInstanceID, int DestItemID, bool CopyQty)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCopySubItemsFromSrcItem, null, SrcModuleID, SrcParentInstanceID,
                    SrcItemID, DestModuleID, DestParentInstanceID, DestItemID, CopyQty ? &quot;Y&quot; : &quot;N&quot;);
            }
        }

        public void CopyItemActivitiesFromSrcItem(string SrcModuleID, int SrcParentInstanceID, int SrcItemID,
            string DestModuleID, int DestParentInstanceID, int DestItemID,
            bool CopyQty)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCopyActivityFromStdItem, null, SrcModuleID, SrcParentInstanceID,
                    SrcItemID, DestModuleID, DestParentInstanceID, DestItemID, CopyQty ? &quot;Y&quot; : &quot;N&quot;);
            }
        }

        public int SaveContainer(ref int? containerID, string containerName, int parentContainerID, string moduleID,
            int parentInstanceID, string containerDescription, string containerNotes, string ModifiedBy, int ModifiedByID, DateTime ModifiedOn)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;ContainerID&quot;] = containerID;
                dic[&quot;Output&quot;] = 0;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_CORITEMCUContainer,
                    dic, containerName,
                    parentContainerID == -1
                        ? null
                        : (object)parentContainerID,
                    moduleID, parentInstanceID, containerDescription,
                    containerNotes, ModifiedBy, ModifiedByID, ModifiedOn);
                int Output, conID;
                int.TryParse(dic[&quot;Output&quot;].ToString2(), out Output);
                //if (Output &gt; 0)
                //    containerID = (int?)dic[&quot;ContainerID&quot;];
                if (int.TryParse(dic[&quot;ContainerID&quot;].ToString2(), out conID))
                    containerID = conID;
                return Output;
            }
        }

        public void ReorderItemStructure(int srcId, string srcType, int targetId, string targetType, string action,
            string moduleId, int parentInstanceId)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMReorderItemStructure, null, srcId, srcType,
                    targetId, targetType, action, moduleId, parentInstanceId);
            }
        }

        public object GetUnitCost(int itemID, string moduleID, int parentInstanceID)
        {
            object retVal = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetUnitCost, null,
                new object[] { itemID, moduleID, parentInstanceID });
            return retVal is decimal ? retVal.ToDecimal2() : 0;
        }

        public DataTable CopyItemsFromStdItemTable(string ItemIDList, string DestModuleID, int DestParentInstanceID,
            int CreatedBy, int ContainerID, bool IgnoreSections, int GroupID,
            bool UseStdGroups)
        {
            lock (_oSync)
            {
                return
                    ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMCopyItemsFromStdItemTable, null,
                        new object[]
                        {
                            ItemIDList, DestModuleID, DestParentInstanceID,
                            CreatedBy, ContainerID, IgnoreSections, GroupID,
                            UseStdGroups
                        }).Tables[0];
            }
        }

        public void ImportContainers(bool clearExcel, string moduleID, int parentInstanceID, string containersXML)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMImportContainers, null,
                    new object[] { clearExcel, moduleID, parentInstanceID, containersXML });
            }
        }

        public DataSet ImportItems(int pID, string moduleID, int parentInstanceID, string itemsXml, string xmlInjectionQuery = null)
        {
            lock (_oSync)
            {
                return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMImportItemDetails, null,
                    new object[] { pID, moduleID, parentInstanceID, itemsXml, xmlInjectionQuery });
            }
        }

        public DataSet ImportItemsUpdate(string moduleID, int parentInstanceID, string itemsXml)
        {
            lock (_oSync)
            {
                return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMImportItemDetailsUpdate, null,
                    new object[] { moduleID, parentInstanceID, itemsXml });
            }
        }
        public DataSet CheckDuplicateItemsBeforeImport(int pID, string moduleID, int parentInstanceID, string comntainerXml, string itemsXml)
        {
            lock (_oSync)
            {
                return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMImportCheckDuplicateItem, null,
                    new object[] { pID, moduleID, parentInstanceID, comntainerXml, itemsXml });
            }
        }

        public void ApplyRateChanges(string moduleID, int parentInstanceID, string rateXml)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMApplyRateChanges, null,
                    new object[] { moduleID, parentInstanceID, rateXml });
            }
        }

        public void SaveMarketPrice(string ModuleID, int InstanceID, string ResItemID, decimal MarketPrice,
            decimal BasePrice, decimal Tax, string Notes, string OPN)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMCUDMarketPrice, null,
                    new object[]
                    {
                        ModuleID, InstanceID, ResItemID, MarketPrice, BasePrice, Tax
                        , Notes, OPN
                    });
            }
        }

        public DataTable GetMarketPrices(string ModuleID, int InstanceID)
        {
            lock (_oSync)
            {
                return
                    ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMCUDMarketPrice, null,
                        new object[]
                        {
                            ModuleID, InstanceID, null, null, null, null, null,
                            null, null, null, null
                        }).Tables[0];
            }
        }

        public DataSet GetItemsWithRateChanges(string moduleID, int parentInstanceID, string rateXml)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetItemsWithRateChanges, null,
                new object[] { moduleID, parentInstanceID, rateXml });
        }

        public int SaveActivity(Activity activity)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Output&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQuery(StoredProcedure.usp_CORITEMCUActivity, dic, activity);
                int ActivityID;
                int.TryParse(dic[&quot;Output&quot;].ToString2(), out ActivityID);
                return ActivityID;
            }
        }

        public int CopyContainer(int srcContainerID, int? parentContainerID, string moduleID, int parentInstanceID)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Output&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCopyContainer, dic, srcContainerID, parentContainerID, moduleID,
                    parentInstanceID);
                int containerID;
                int.TryParse(dic[&quot;Output&quot;].ToString2(), out containerID);
                return containerID;
            }
        }

        public DataSet GetContainer(string moduleID, int? parentInstanceID, int? containerID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetContainer, null, moduleID,
                parentInstanceID, containerID);
        }

        public DataSet GetItemActivities(string moduleID, int? parentInstanceID, int? itemID, string getCount)
        {
            return GetItemActivities(moduleID, parentInstanceID, itemID, getCount, null);
        }

        public DataSet GetItemActivities(string moduleID, int? parentInstanceID, int? itemID, string getCount,
            bool? isContractView)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetActivities, null, moduleID,
                parentInstanceID, itemID, null, getCount, isContractView);
        }

        public DataSet GetItemActivitiesByIdList(string moduleID, int parentInstanceID, List&lt;int&gt; itemIdList, string getCount)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetActivitiesByItemIdList, null, moduleID,
                parentInstanceID, string.Join(&quot;,&quot;, itemIdList), null, getCount, null);
        }

        public int GetProjectIDOfItem(string moduleID, int parentInstanceID, int itemID)
        {
            int id = -1;
            object objId = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetProjectIDOfItem, null, moduleID,
                parentInstanceID, itemID);

            if (objId != null) int.TryParse(objId.ToString(), out id);
            return id;
        }

        public Activity GetActivity(string moduleID, int parentInstanceID, int? itemID, int activityID)
        {
            var activityDetails = new Activity();
            try
            {
                using (
                    IDataReader dr = ComponentHelper.Instance.ExecuteReader(
                        StoredProcedure.usp_CORITEMGetActivities, null, moduleID, parentInstanceID, itemID,
                        activityID, null, null))
                {
                    if (dr.Read())
                        ComponentHelper.CopyDataReaderToDto(dr, activityDetails);
                }
            }
            catch
            {
                return null;
            }
            return activityDetails;
        }

        public DataTable GetActivityDates(int activityID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetActivityDates, null,
                activityID).Tables[0];
        }

        public DataTable GetActivityDatesForItem(int itemID, int parentInstanceID, string moduleID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetActivityDatesForItem, null,
                itemID, parentInstanceID, moduleID).Tables[0];
        }


        public void DeleteActivity(string activityIDList)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMDeleteActivity, null, activityIDList);
            }
        }

        public int CopyMeasureUnit(string moduleID, int parentInstanceId, int unitID)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;NewUnitID&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCreateMeasureUnit, dic, moduleID, parentInstanceId, unitID);
                int UnitID;
                int.TryParse(dic[&quot;NewUnitID&quot;].ToString2(), out UnitID);
                return UnitID;
            }
        }

        public DataSet GetTaxCalculatorDetails(string moduleID, int parentInstanceID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetItemTotal, null, moduleID,
                parentInstanceID);
        }

        public DataTable GetProfitDiscountItemDistribution(string moduleID, int parentID)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetProfitDiscountItemDistribution,
                    null, moduleID, parentID);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            return new DataTable();
        }

        public DataTable GetProfitDiscountGroupDistribution(string moduleID, int parentInstanceID)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(
                    StoredProcedure.usp_CORITEMGetProfitDiscountGroupDistribution, null, moduleID, parentInstanceID);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            return new DataTable();
        }

        public int CUDProfitDiscountDetails(string moduleID, int parentInstanceID, int profitDiscountDistributionType,
            decimal profitValue, decimal discountValue,
            string ProfitDiscountItemDistributionXML)
        {
            lock (_oSync)
            {
                return
                    ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                        StoredProcedure.usp_CORITEMCUDProfitDiscountDetails, null, moduleID, parentInstanceID,
                        profitDiscountDistributionType, profitValue, discountValue, ProfitDiscountItemDistributionXML);
            }
        }

        public DataTable GetOverheadItemDistribution(int overheadDetailID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadItemDistribution, null,
                overheadDetailID).Tables[0];
        }

        public DataTable GetOverheadGroupDistribution(string moduleID, int parentInstanceID, int overheadDetailID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadGroupDistribution,
                null, moduleID, parentInstanceID, overheadDetailID).Tables[0];
        }

        public DataSet GetOverheadGroupDetails(string groupName)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadGroup, null,
                groupName);
        }

        public int CUDOverheadDetails(string moduleID, int parentInstanceID, int overheadGroupID, int overheadDetailID,
            string overheadDescription, string overheadCategoryID, double overheadPercentage,
            string overheadDistributionXML, int distributionType, string OverheadGroupName,
            decimal Amount, string type, string mode)
        {
            lock (_oSync)
            {
                return
                    ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                        StoredProcedure.usp_CORITEMCUDOverheadDetails, null, moduleID, parentInstanceID,
                        overheadDetailID, overheadGroupID, overheadDescription, overheadCategoryID, overheadPercentage,
                        overheadDistributionXML, distributionType, OverheadGroupName, Amount, type, mode);
            }
        }

        public int CreateItemTotalDetails(int ParentInstanceID, string ModuleID, decimal Discount, decimal Margin,
            string Overheads, string groupXML)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;ID&quot;] = null;

                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCUItemTotalDetails, dic, ParentInstanceID, ModuleID, Discount, Margin,
                    Overheads, groupXML);

                return dic[&quot;ID&quot;].ToString2().ToInt32_2();
            }
        }

        public int CUDGroupDetails(int parentInstanceID, string moduleID, string groupName, string groupDesc,
            decimal? otpPercentage, decimal? discount, int groupID, string operation,
            string groupXML)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;Error&quot;] = null;

                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_CORITEMCUDGroup, dic,
                    parentInstanceID, moduleID, groupName,
                    groupDesc, otpPercentage, discount,
                    groupID, operation, groupXML);

                return dic[&quot;Error&quot;].ToString2().ToInt32_2();
            }
        }

        public DataTable GetGroupDetails(int parentInstanceID, string moduleID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetGroupDetails, null,
                new object[] { parentInstanceID, moduleID }).Tables[0];
        }

        public string GetDefaultTableID(int parentID)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_ESTMATEGetEstimateDetails, dic,
                parentID);
            if (ds.Tables[0].Rows.Count &lt; 1) return &quot;0&quot;;
            string stdTableId = ds.Tables[0].Rows[0][&quot;StdItemTableID&quot;].ToString2();
            return string.IsNullOrEmpty(stdTableId) ? &quot;0&quot; : stdTableId;
        }

        public DataSet GetComponents(int ItemID, int parentInstanceID, string moduleID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetComponent, null, ItemID,
                moduleID, parentInstanceID, null);
        }

        public Component GetComponents(int ItemID, int parentInstanceID, string moduleID, int componentID)
        {
            var componentDetails = new Component();
            try
            {
                using (
                    IDataReader dr = ComponentHelper.Instance.ExecuteReader(
                        StoredProcedure.usp_CORITEMGetComponent, null, null, null, null, componentID))
                {
                    if (dr.Read())
                        ComponentHelper.CopyDataReaderToDto(dr, componentDetails);
                }
            }
            catch
            {
                return null;
            }
            return componentDetails;
        }

        public void CUComponents(Component comp)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQuery(StoredProcedure.usp_CORITEMCUComponent, null, comp);
            }
        }

        public string DeleteComponent(int ComponentID)
        {
            lock (_oSync)
            {
                var dic = new Dictionary&lt;string, object&gt;();
                dic[&quot;out_Result&quot;] = null;
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMDeleteComponent, dic, ComponentID);
                return dic[&quot;out_Result&quot;].ToString2();
            }
        }

        public void CopyComponentsFromStandardTable(String SrcModuleID, int SrcParentInstanceID, int SrcItemID,
            String DestModuleID, int DestParentInstanceID, int DestItemID)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMCopyComponentsFromStdItem, null, SrcModuleID, SrcParentInstanceID,
                    SrcItemID, DestModuleID, DestParentInstanceID, DestItemID);
            }
        }

        public int GetComponentCount(int ItemID, String ModuleID, int ParentInstanceID)
        {
            return ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetComponentCount, null, ItemID,
                ModuleID, ParentInstanceID).ToInt32_2();
        }

        public decimal GetBalancedQty(int ContractID, string ResItemID, string MaterialIssueNo)
        {
            DataSet ds =
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_ITMPOSTGetMaterialPostedQuantities, null,
                    ContractID, ResItemID, MaterialIssueNo);
            if (!String.IsNullOrEmpty(ds.Tables[0].Rows[0][&quot;Quantity&quot;].ToString2()))
                return ds.Tables[0].Rows[0][&quot;Quantity&quot;].ToString2().ToDecimal2();
            return 0.0M;
        }

        public DataSet GetEquipmentStage(int ContractID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetEquipmentStages, null,
                ContractID);
        }

        public DataTable GetContainer(string moduleId, int parentInstanceId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetContainer, null, moduleId,
                parentInstanceId, null).Tables[0];
        }

        public char GetGroupType(int InstanceID, string ModuleID)
        {
            var dic = new Dictionary&lt;string, object&gt;();
            dic[&quot;GroupType&quot;] = null;
            ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetGroupType, dic, InstanceID,
                ModuleID);
            return Convert.ToChar(dic[&quot;GroupType&quot;], CultureInfo.InvariantCulture);
        }

        public DataTable GetGlobalSubItemGroups(int InstanceID, string ModuleID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetGlobalSubItemGroups, null, ModuleID,
                InstanceID).Tables[0];
        }

        public DataSet GetProjectCategoryList(string strAdditionalInfo)
        {
            var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
            additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
            var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
            dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);
            var connectorParameters =
                new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                    EISObjectType.ProjectCategory, null, null);

            DataSet ds = new BrixDataSet();
            int count = 0;
            if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true))
            {
                return ds;
            }
            return null;
        }

        public void AddProjectCategory(string strAdditionalInfo, DataSet ds)
        {
            var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
            additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
            var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
            dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);
            var connectorParameters =
                new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                    EISObjectType.ProjectCategory, null, null);
            int count = 0;
            if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, false))
            {
            }
        }

        public DataTable GetOverHeadData(string strAdditionalInfo, int contractId, DateTime endDate)
        {
            var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
            additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
            var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
            dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);

            DataTable dtMap = IntegrationConnectorManager.Instance.GetERPObjectMapInfo(contractId.ToString2(),
                AMP3Object.CONTMGT, null,
                AMP3Object.UNKNOWN,
                RegisteredEIS.AX);
            string filterCriteria = &quot;&quot;;
            if (dtMap.Rows.Count &gt; 0)
            {
                filterCriteria = &quot;&lt;XMLRoot&gt;&lt;ProjId type=&#39;txt&#39;&gt;&quot; + dtMap.Rows[0][&quot;ERPId&quot;].ToString2() + &quot;&lt;/ProjId&gt;&quot; +
                                 &quot;&lt;endDate type=&#39;date&#39;&gt;&quot; + endDate.ToMWDateTimeString_FormatDateTime() + &quot;&lt;/endDate&gt; &quot; +
                                 &quot;&lt;/XMLRoot&gt;&quot;;
            }
            else
                throw new Exception(&quot;The Contract is not mapped to AX. Cannot Import Overhead Expenses.&quot;);

            var confilter = new ConnectionFilter(filterCriteria, null, null, null, null);
            var connectorParameters =
                new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                    EISObjectType.ProjectExpenseJournal, confilter, null);

            DataSet ds = new BrixDataSet();
            int count = 0;
            if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref count, ref ds, true) &amp;&amp;
                ds.Tables.Count &gt; 0)
            {
                //APPLY CURRENCY CONVERSION FROM EXPENSE CURRENCY TO CONTRACT CURRENCY
                foreach (DataRow dr in ds.Tables[0].Rows)
                {
                    decimal price = Convert.ToDecimal(dr[&quot;CostPrice&quot;]);
                    string contractCurrency = LocalizationManager.GetModuleCurrency(&quot;CONTMGT&quot;, contractId.ToString(),
                        strAdditionalInfo);
                    if (!contractCurrency.Equals(dr[&quot;CurrencyIdCost&quot;].ToString()))
                        LocalizationManager.ApplyCurrencyConversion(dr[&quot;CurrencyIdCost&quot;].ToString(), contractCurrency,
                            ref price, strAdditionalInfo);
                    dr[&quot;CostPrice&quot;] = price;
                }
                return ds.Tables[0];
            }
            else
                return null;
        }

        public DataTable HideMultiCurrencyColumns(DataTable dt)
        {
            var columns = new[] { &quot;Size&quot;, &quot;Color&quot;, &quot;Configuration&quot;, &quot;Contractor&quot;, &quot;TradeAgmtCurrency&quot; };
            foreach (string str in columns)
            {
                if (dt.Columns.Contains(str))
                    dt.Columns.Remove(str);
            }
            return dt;
        }

        public void ApplyCurrencyConversionForRateAnalysis(int itemID, string moduleID, int parentInstanceID,
            string AXCompany)
        {
            //Apply Currency Conversion for Rates
            DataSet dsRA = Instance.GetRateAnalysis(moduleID, parentInstanceID, itemID);
            if (dsRA.Tables.Count &gt; 1 &amp; dsRA.Tables[1].Rows.Count &gt; 0)
            {
                string companyCur = LocalizationManager.GetModuleCurrency(&quot;LIBRARY&quot;, null, AXCompany);
                string moduleCur = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
                if (!moduleCur.Equals(companyCur))
                {
                    using (var sWr = new StringWriter(CultureInfo.CurrentCulture))
                    {
                        using (var xWr = new XmlTextWriter(sWr))
                        {
                            xWr.WriteStartElement(&quot;Rates&quot;);
                            foreach (DataRow dr in dsRA.Tables[1].Rows)
                            {
                                xWr.WriteStartElement(&quot;Resource&quot;);
                                decimal rate = Convert.ToDecimal(dr[&quot;Rate&quot;]);
                                LocalizationManager.ApplyCurrencyConversion(companyCur, moduleCur, ref rate, AXCompany);
                                xWr.WriteElementString(&quot;ResItemID&quot;, dr[&quot;ResItemID&quot;].ToString());
                                xWr.WriteElementString(&quot;Rate&quot;, rate.ToString());
                                xWr.WriteEndElement();
                                ;
                            }
                            xWr.WriteEndElement();
                            xWr.Flush();

                            //Update Database with the New Rates applied with ERP Exchange Rates
                            lock (_oSync)
                            {
                                ComponentHelper.Instance.ExecuteScalar(
                                    StoredProcedure.usp_CORITEMApplyERPExchangeRateChanges, null,
                                    new object[] { moduleID, parentInstanceID, itemID, sWr.ToString() });
                            }
                        }
                    }
                }
            }
        }

        public int GetResourceTypeID(string resourceTypeName)
        {
            int id = 0;
            object objId =
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMGetResourceTypesForresourceTypeName,
                    null, resourceTypeName);

            if (objId != null) int.TryParse(objId.ToString(), out id);
            return id;
        }

        public void ApplyExchangeRatestoMultipleItems(string moduleId, int parentInstanceId, string itemIdList)
        {
            var currentPage = (Page)HttpContext.Current.Handler;
            string AXCompany = currentPage.Session[&quot;AXCompany&quot;].ToString();
            string moduleCurrency = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
            string companyCurrency = LocalizationManager.GetModuleCurrency(&quot;LIBRARY&quot;, null);


            DataSet dsItems = GetItemPickerData(moduleId, parentInstanceId, null, &quot;&quot;);

            string filter = &quot;ReferenceItemId IN (&quot; + itemIdList + &quot;)&quot;;

            DataRow[] drSelectItems = dsItems.Tables[1].Select(filter);

            if (drSelectItems.Length &gt; 0)
            {
                using (var sWr = new StringWriter(CultureInfo.CurrentCulture))
                {
                    using (var xWr = new XmlTextWriter(sWr))
                    {
                        xWr.WriteStartElement(&quot;ExchangeRates&quot;);

                        //FETCH ITEMS IN THE ITEMLIST
                        foreach (DataRow drItems in drSelectItems)
                        {
                            xWr.WriteStartElement(&quot;Item&quot;);
                            //decimal unitprice = Convert.ToDecimal(drItems[&quot;UnitPrice&quot;]);
                            decimal baseUnitCost = Convert.ToDecimal(drItems[&quot;BaseUnitCost&quot;]);
                            //decimal unitCost = Convert.ToDecimal(drItems[&quot;UnitCost&quot;]);
                            //decimal overheadCost = Convert.ToDecimal(drItems[&quot;OverheadCost&quot;]);

                            //LocalizationManager.ApplyCurrencyConversion(companyCurrency, moduleCurrency, ref unitprice, AXCompany);
                            LocalizationManager.ApplyCurrencyConversion(companyCurrency, moduleCurrency,
                                ref baseUnitCost, AXCompany);
                            //LocalizationManager.ApplyCurrencyConversion(companyCurrency, moduleCurrency, ref unitCost, AXCompany);
                            //LocalizationManager.ApplyCurrencyConversion(companyCurrency, moduleCurrency, ref overheadCost, AXCompany);

                            //xWr.WriteElementString(&quot;UnitPrice&quot;, unitprice.ToString());
                            xWr.WriteElementString(&quot;BaseUnitCost&quot;, baseUnitCost.ToString());
                            //xWr.WriteElementString(&quot;UnitCost&quot;, unitCost.ToString());
                            //xWr.WriteElementString(&quot;OverheadCost&quot;, overheadCost.ToString());
                            xWr.WriteElementString(&quot;ItemId&quot;, drItems[&quot;ItemId&quot;].ToString());
                            xWr.WriteEndElement();

                            //FETCH RA FOR THE ITEM                                               
                            DataSet dsRA = GetRateAnalysis(moduleId, parentInstanceId,
                                Convert.ToInt32(drItems[&quot;ItemId&quot;]));
                            foreach (DataRow drResource in dsRA.Tables[1].Rows)
                            {
                                decimal rate = Convert.ToDecimal(drResource[&quot;Rate&quot;]);
                                LocalizationManager.ApplyCurrencyConversion(companyCurrency, moduleCurrency, ref rate,
                                    AXCompany);
                                xWr.WriteStartElement(&quot;Resource&quot;);
                                xWr.WriteElementString(&quot;ResItemId&quot;, drResource[&quot;ResItemId&quot;].ToString());
                                xWr.WriteElementString(&quot;Rate&quot;, rate.ToString());
                                xWr.WriteElementString(&quot;ItemId&quot;, drResource[&quot;ItemId&quot;].ToString());
                                xWr.WriteEndElement();
                            }
                        }

                        xWr.WriteEndElement();
                        xWr.Flush();

                        //Update Database with the New Rates applied with ERP Exchange Rates
                        lock (_oSync)
                        {
                            ComponentHelper.Instance.ExecuteScalar(
                                StoredProcedure.usp_CORITEMApplyExchangeRatesToItems, null,
                                new object[] { moduleId, parentInstanceId, sWr.ToString() });
                        }
                    }
                }
            }
        }

        public void CUDOverheadDescription(int ID, string CategoryID, int ParentInstanceID, string moduleID,
            int Quantity, string FromMonth, int FromYear, string ToMonth, int ToYear,
            int Months, decimal UnitCost, decimal Amount, string Opn)
        {
            ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMCUDOverheadDescription, null,
                new object[]
                {
                    ID, CategoryID, ParentInstanceID, moduleID, Quantity, FromMonth,
                    FromYear, ToMonth, ToYear, Months, UnitCost, Amount, Opn
                });
        }

        public DataTable GetOverheadDescription(int ID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadDescription, null,
                    new object[] { ID }).Tables[0];
        }

        public string ValidateInventoryDimensions(string company, string resItemID, string size, string configuration,
            string color)
        {
            int recordCount = 0;
            var dsValdiate = new DataSet();
            EISAdditionalInfo info = new EISAdditionalInfo(RegisteredEIS.AX).AddInfo(&quot;AXCompany&quot;, company);
            var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
            dictAdditionalInfo.Add(RegisteredEIS.AX, info);

            string filter = &quot;&lt;XMLRoot&gt;&lt;ItemId type=&#39;txt&#39;&gt;&quot; + resItemID + &quot;&lt;/ItemId&gt;&lt;Size type=&#39;txt&#39;&gt;&quot; + size +
                            &quot;&lt;/Size&gt;&lt;Color type=&#39;txt&#39;&gt;&quot; + color + &quot;&lt;/Color&gt;&lt;Configuration type=&#39;txt&#39;&gt;&quot; + configuration +
                            &quot;&lt;/Configuration&gt;&lt;/XMLRoot&gt;&quot;;
            var connectorParameters =
                new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(), AMP3ObjectType.Unknown,
                    new ConnectionFilter(filter, null, null, null, null), null);

            if (IntegrationConnectorManager.HandleIntegration(connectorParameters, ref recordCount, ref dsValdiate, true))
            {
                if (dsValdiate.Tables.Count &gt; 0)
                {
                    if (dsValdiate.Tables[0].Rows.Count &gt; 0 &amp;&amp;
                        Convert.ToBoolean(dsValdiate.Tables[0].Rows[0][&quot;Status&quot;]).Equals(false))
                        return dsValdiate.Tables[0].Rows[0][&quot;ErrorMessage&quot;].ToString();
                }
                else
                    return &quot;&quot;;
            }
            return &quot;&quot;;
        }

        public DataSet ApplySummaryOfResourceChanges(string moduleID, int parentInstanceID, string operationsXML,
            char outputType, int applyChange)
        {
            lock (_oSync)
            {
                return ComponentHelper.Instance.ExecuteDataSet(
                    StoredProcedure.usp_CORITEMApplySummaryOfResourceChanges, null,
                    new object[] { operationsXML, parentInstanceID, moduleID, outputType, applyChange });
            }
        }

        public DataSet ApplySummaryOfResourceChanges(string moduleID, int parentInstanceID, string operationsXML,
            char outputType)
        {
            return ApplySummaryOfResourceChanges(moduleID, parentInstanceID, operationsXML, outputType, 0);
        }

        public DataSet GetModuleData(string moduleID, int parentInstanceID, string additionalInfo)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetModuleData, null,
                moduleID, parentInstanceID);

            if (IntegrationConnectorManager.Instance.IsIntegrationConnectorAttached(RegisteredEIS.AX))
            {
                // AX Company for Units is Login Company
                // GetModuleDataForErp(parentInstanceID);

                DataTable dt = ProjectComponent.Instance.GetMeasurementUnitsForSystem(additionalInfo, 0);
                DataTable dtUnit = null;
                if (dt != null)
                {
                    dtUnit = dt.Copy();
                }
                else
                {
                    dtUnit = new BrixDataTable();
                }
                //TODO : Remove Indexing
                ds.Tables[2].Rows.Clear();
                ds.Tables[2].Columns.Clear();
                ds.Tables[2].Merge(dtUnit);
            }
            return ds;
        }

        public DataSet GetFundRule(int pID)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_COREITEMGetFundRules, null,
                pID);
            return ds;
        }
        public DataSet GetInflationRules()
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetInflationRules, null, null);
            return ds;
        }

        public DataSet GetGrantRules(int pid)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_GRTMGMTGetGrantRules, null, pid);
            return ds;
        }

        public HierarchicalGridColumns HGridOverheadColumns()
        {
            var columns = new HierarchicalGridColumns();
            columns.TreeColumnWidth = 250;
            columns.Add(new HierarchicalGridColumn(&quot;Category Name&quot;, 100));
            columns.Add(new HierarchicalGridColumn(&quot;Percentage&quot;, 100, false,
                AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE, true));
            return columns;
        }

        public DataSet GetOverheadDetailsForHGrid(string moduleId, int parentInstanceId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetOverheadDetailsForHGrid, null,
                moduleId, parentInstanceId);
        }

        public DataTable GetLibraryCategories()
        {
            var dtCategories = new DataTable();
            dtCategories.Columns.Add(&quot;ID&quot;, typeof(int));
            dtCategories.Columns.Add(&quot;CategoryName&quot;, typeof(string));
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_LIBRARYGetLibraryCategories,
                null, null);
            if (ds.Tables.Count == 1)
                dtCategories = ds.Tables[0];
            return dtCategories;
        }

        public void CUDRAForOverheadosting(Resource resourceDTO, string mode)
        {
            lock (_oSync)
            {
                ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CUDRAForOverheadPosting, null, resourceDTO.ModuleID,
                    resourceDTO.ParentInstanceID, resourceDTO.Description, resourceDTO.Rate, resourceDTO.ResItemID, mode);
            }
        }

        public DataTable GetHierarchicalContainerPath(string moduleId, int parentInstanceId)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(
                StoredProcedure.usp_CORITEMGetHierarchicalContainerPath, null, moduleId, parentInstanceId);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        public DataTable ValidateItemSave(string itemXML)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMValidateItemSave, null, itemXML)
                    .Tables[0];
        }

        public void RefreshLineNumbers(string moduleID, int parentInstanceID)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                StoredProcedure.usp_CORITEMLineNumberReorder, null, moduleID, parentInstanceID);
        }

        public bool HasItems(string containerIDs)
        {
            object result = ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_CORITEMCheckIfContainerHasItems, null, containerIDs);
            if (result != null)
                return result.ToBoolean2();

            return false;
        }

        public void UpdateActivityDates(string xmlData)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                    StoredProcedure.usp_CORITEMUpdateActivityDates, null, xmlData);
        }

        public List&lt;GlobalGroup&gt; GetGroups(string moduleID, int parentInstanceID)
        {
            List&lt;GlobalGroup&gt; grpList = new List&lt;GlobalGroup&gt;();
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CORITEMGetGlobalGroups, null, moduleID, parentInstanceID);
            if (ds?.Tables?.Count &gt; 0 &amp;&amp; ds.Tables[0].Rows?.Count &gt; 0)
            {
                foreach (DataRow dataRow in ds.Tables[0].Rows)
                {
                    GlobalGroup grp = new GlobalGroup
                    {
                        GroupID = int.Parse(dataRow[&quot;GroupID&quot;].ToString2()),
                        GroupName = dataRow[&quot;GroupName&quot;].ToString2(),
                        GroupDesc = dataRow[&quot;GroupDesc&quot;].ToString2()
                    };

                    grpList.Add(grp);
                }
            }

            return grpList;
        }

        public void SaveInflationDetails(bool isContainer,string id,int ruleid,decimal InflationRate,DateTime? effectivefrom)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                StoredProcedure.usp_CORITEMSaveInflationDetails, null, isContainer, id, ruleid, InflationRate, effectivefrom);
        }

        public void SaveGrantRule(bool isContainer, string itemOrContainerIDs, int grantRuleID)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(
                StoredProcedure.usp_GRTMGMTSaveGrantRule, null, isContainer, itemOrContainerIDs, grantRuleID);
        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[27,9,27,30,1],[28,9,28,10,1],[29,9,29,10,1],[32,9,32,10,1],[33,13,33,32,1],[33,34,33,47,1],[34,13,35,43,1],[36,9,36,10,1],[39,9,39,10,0],[40,13,40,99,0],[41,9,41,10,0],[46,9,46,10,1],[47,13,50,40,1],[51,9,51,10,1],[57,9,57,10,0],[58,13,58,56,0],[59,13,59,46,0],[60,13,64,56,0],[65,13,65,73,0],[66,13,66,77,0],[67,13,67,23,0],[68,9,68,10,0],[74,9,74,10,1],[75,13,75,56,1],[76,13,76,46,1],[77,13,81,120,1],[83,13,83,73,1],[84,13,84,77,1],[85,13,85,73,1],[86,13,86,23,1],[87,9,87,10,1],[92,9,92,10,0],[93,13,94,23,0],[95,9,95,10,0],[99,9,99,10,0],[100,13,101,48,0],[102,9,102,10,0],[105,9,105,10,1],[106,13,106,118,1],[107,9,107,10,1],[111,9,111,10,1],[112,13,112,56,1],[113,13,113,46,1],[114,13,115,97,1],[116,13,116,73,1],[117,13,117,77,1],[118,13,118,23,1],[119,9,119,10,1],[123,9,123,10,1],[124,13,124,56,1],[125,13,125,46,1],[126,13,128,87,1],[129,13,129,73,1],[130,13,130,77,1],[131,13,131,73,1],[132,13,132,23,1],[133,9,133,10,1],[136,9,136,10,1],[137,13,137,78,1],[138,9,138,10,1],[141,9,141,10,1],[142,13,142,42,1],[144,13,144,42,1],[145,13,145,32,1],[146,17,146,105,0],[149,17,152,45,1],[153,13,153,14,1],[154,17,154,34,1],[155,21,155,74,1],[156,13,156,14,1],[157,13,157,32,1],[158,9,158,10,1],[161,9,161,10,1],[162,13,162,26,1],[163,13,163,14,1],[164,17,164,60,1],[165,17,165,52,1],[167,17,167,118,1],[170,17,170,69,1],[171,17,171,31,1],[173,9,173,10,1],[176,9,176,10,0],[177,13,177,56,0],[178,13,179,32,0],[180,13,180,23,0],[181,9,181,10,0],[184,9,184,10,1],[185,13,185,26,1],[186,13,186,14,1],[187,17,187,60,1],[188,17,188,38,1],[189,17,190,53,1],[191,17,191,59,1],[192,17,192,51,1],[193,17,193,18,0],[194,21,194,95,0],[196,21,196,103,0],[197,21,197,28,0],[197,30,197,40,0],[197,41,197,43,0],[197,44,197,47,0],[198,21,198,22,0],[199,25,199,37,0],[202,33,203,138,0],[204,33,204,39,0],[206,33,206,59,0],[207,33,207,39,0],[209,33,209,61,0],[210,33,210,39,0],[212,33,212,57,0],[213,33,213,39,0],[215,33,215,57,0],[216,33,216,39,0],[218,33,218,55,0],[219,33,219,39,0],[221,33,221,61,0],[222,33,222,39,0],[224,33,224,55,0],[225,33,225,39,0],[227,21,227,22,0],[229,21,229,64,0],[231,21,231,46,0],[233,13,233,14,1],[234,9,234,10,1],[237,9,237,10,1],[238,13,238,78,1],[239,9,239,10,1],[242,9,242,10,1],[243,13,244,59,1],[245,9,245,10,1],[248,9,248,10,1],[249,13,249,183,1],[250,9,250,10,1],[253,9,253,10,1],[254,13,254,48,1],[256,13,256,14,1],[258,21,260,35,1],[261,17,261,18,1],[262,21,262,35,1],[263,25,263,81,1],[264,17,264,18,1],[265,13,265,14,1],[266,13,266,18,0],[267,13,267,14,0],[268,17,268,29,0],[270,13,270,35,1],[271,9,271,10,1],[274,9,274,10,1],[275,13,275,26,1],[276,13,276,14,1],[278,17,278,60,1],[279,17,279,38,1],[280,17,280,113,1],[282,17,282,72,1],[283,17,283,34,1],[285,9,285,10,1],[288,9,288,10,0],[289,13,289,26,0],[290,13,290,14,0],[291,17,291,60,0],[292,17,292,38,0],[293,17,294,84,0],[295,17,295,32,0],[296,17,296,69,0],[297,17,297,34,0],[298,21,299,118,0],[300,13,300,14,0],[301,9,301,10,0],[304,9,304,10,1],[305,13,305,79,1],[306,9,306,10,1],[309,9,309,10,1],[310,13,312,42,1],[313,9,313,10,1],[316,9,316,10,0],[317,13,317,45,0],[319,13,319,14,0],[321,21,323,71,0],[324,17,324,18,0],[325,21,325,35,0],[326,25,326,77,0],[327,17,327,18,0],[328,13,328,14,0],[329,13,329,18,0],[330,13,330,14,0],[331,17,331,29,0],[333,13,333,31,0],[334,9,334,10,0],[337,9,337,10,1],[338,13,338,140,1],[339,9,339,10,1],[342,9,342,10,0],[343,13,344,63,0],[345,9,345,10,0],[348,9,348,10,0],[349,13,349,26,0],[350,13,350,14,0],[351,17,351,60,0],[352,17,352,76,0],[354,17,355,38,0],[357,17,357,89,0],[358,17,358,41,0],[360,9,360,10,0],[363,9,363,10,0],[364,13,364,26,0],[365,13,365,14,0],[366,17,367,96,0],[368,13,368,14,0],[369,9,369,10,0],[372,9,372,10,0],[373,13,373,82,0],[374,9,374,10,0],[377,9,377,10,1],[378,13,384,20,1],[386,13,386,27,1],[387,9,387,10,1],[390,9,390,10,1],[391,13,391,123,1],[392,13,392,33,1],[393,9,393,10,1],[398,9,398,10,1],[399,13,399,26,1],[400,13,400,14,1],[401,17,403,101,1],[404,13,404,14,1],[405,9,405,10,1],[409,9,409,10,1],[410,13,410,26,1],[411,13,411,14,1],[412,17,414,101,1],[415,13,415,14,1],[416,9,416,10,1],[421,9,421,10,0],[422,13,422,26,0],[423,13,423,14,0],[424,17,426,101,0],[427,13,427,14,0],[428,9,428,10,0],[432,9,432,10,1],[433,13,433,26,1],[434,13,434,14,1],[435,17,435,60,1],[436,17,436,50,1],[437,17,437,35,1],[438,17,444,75,1],[446,17,446,69,1],[449,17,449,77,1],[450,21,450,41,1],[451,17,451,31,1],[453,9,453,10,1],[457,9,457,10,0],[458,13,458,26,0],[459,13,459,14,0],[460,17,462,79,0],[463,13,463,14,0],[464,9,464,10,0],[467,9,467,10,1],[468,13,469,70,1],[470,13,470,64,1],[471,9,471,10,1],[476,9,476,10,1],[477,13,477,26,1],[478,13,478,14,1],[479,17,486,38,1],[488,9,488,10,1],[491,9,491,10,0],[492,13,492,26,0],[493,13,493,14,0],[494,17,495,93,0],[496,13,496,14,0],[497,9,497,10,0],[500,9,500,10,0],[501,13,501,26,0],[502,13,502,14,0],[503,17,504,100,0],[506,9,506,10,0],[509,9,509,10,0],[510,13,510,26,0],[511,13,511,14,0],[512,17,513,76,0],[515,9,515,10,0],[517,9,517,10,0],[518,13,518,26,0],[519,13,519,14,0],[520,17,521,96,0],[523,9,523,10,0],[526,9,526,10,0],[527,13,527,26,0],[528,13,528,14,0],[529,17,530,75,0],[531,13,531,14,0],[532,9,532,10,0],[536,9,536,10,0],[537,13,537,26,0],[538,13,538,14,0],[539,17,544,24,0],[545,13,545,14,0],[546,9,546,10,0],[549,9,549,10,0],[550,13,550,26,0],[551,13,551,14,0],[552,17,558,38,0],[560,9,560,10,0],[563,9,563,10,0],[564,13,565,71,0],[566,9,566,10,0],[569,9,569,10,1],[570,13,570,26,1],[571,13,571,14,1],[572,17,572,60,1],[573,17,573,38,1],[574,17,574,112,1],[576,17,576,73,1],[577,17,577,35,1],[579,9,579,10,1],[582,9,582,10,1],[583,13,583,26,1],[584,13,584,14,1],[585,17,585,60,1],[586,17,586,38,1],[587,17,589,39,1],[591,17,591,74,1],[592,17,592,36,1],[594,9,594,10,1],[597,9,597,10,1],[598,13,599,48,1],[600,9,600,10,1],[603,9,603,10,1],[604,13,604,90,1],[605,9,605,10,1],[609,9,609,10,1],[610,13,611,75,1],[612,9,612,10,1],[615,9,615,10,1],[616,13,617,87,1],[618,9,618,10,1],[621,9,621,10,1],[622,13,622,25,1],[623,13,624,43,1],[626,13,626,31,1],[626,32,626,71,1],[627,13,627,23,1],[628,9,628,10,1],[631,9,631,10,1],[632,13,632,50,1],[634,13,634,14,1],[636,21,638,48,1],[639,17,639,18,1],[640,21,640,35,1],[641,25,641,82,0],[642,17,642,18,1],[643,13,643,14,1],[644,13,644,18,0],[645,13,645,14,0],[646,17,646,29,0],[648,13,648,36,1],[649,9,649,10,1],[652,9,652,10,0],[653,13,654,39,0],[655,9,655,10,0],[658,9,658,10,0],[659,13,660,63,0],[661,9,661,10,0],[665,9,665,10,0],[666,13,666,26,0],[667,13,667,14,0],[668,17,669,86,0],[670,13,670,14,0],[671,9,671,10,0],[674,9,674,10,0],[675,13,675,26,0],[676,13,676,14,0],[677,17,677,60,0],[678,17,678,41,0],[679,17,680,108,0],[682,17,682,72,0],[683,17,683,31,0],[685,9,685,10,0],[688,9,688,10,0],[689,13,690,35,0],[691,9,691,10,0],[694,9,694,10,0],[695,13,697,47,0],[698,13,698,37,0],[699,17,699,37,0],[700,13,700,36,0],[701,9,701,10,0],[704,9,704,10,0],[705,13,707,118,0],[708,13,708,37,0],[709,17,709,37,0],[710,13,710,36,0],[711,9,711,10,0],[716,9,716,10,0],[717,13,717,26,0],[718,13,718,14,0],[719,17,722,120,0],[724,9,724,10,0],[727,9,727,10,0],[728,13,729,45,0],[730,9,730,10,0],[733,9,733,10,0],[734,13,735,79,0],[736,9,736,10,0],[739,9,739,10,0],[740,13,741,28,0],[742,9,742,10,0],[748,9,748,10,0],[749,13,749,26,0],[750,13,750,14,0],[751,17,755,107,0],[757,9,757,10,0],[761,9,761,10,0],[762,13,762,26,0],[763,13,763,14,0],[764,17,764,60,0],[765,17,765,34,0],[767,17,769,42,0],[771,17,771,58,0],[773,9,773,10,0],[778,9,778,10,1],[779,13,779,26,1],[780,13,780,14,1],[781,17,781,60,1],[782,17,782,37,1],[784,17,787,51,1],[789,17,789,61,1],[791,9,791,10,1],[794,9,794,10,1],[795,13,796,72,1],[797,9,797,10,1],[800,9,800,10,1],[801,13,801,56,1],[802,13,803,27,1],[804,13,804,45,1],[804,46,804,57,0],[805,13,805,84,1],[806,13,806,72,1],[807,9,807,10,1],[810,9,810,10,0],[811,13,812,51,0],[813,9,813,10,0],[816,9,816,10,0],[817,13,817,52,0],[819,13,819,14,0],[821,21,822,102,0],[823,17,823,18,0],[824,21,824,35,0],[825,25,825,83,0],[826,17,826,18,0],[827,13,827,14,0],[828,13,828,18,0],[829,13,829,14,0],[830,17,830,29,0],[832,13,832,37,0],[833,9,833,10,0],[836,9,836,10,0],[837,13,837,26,0],[838,13,838,14,0],[839,17,839,110,0],[840,13,840,14,0],[841,9,841,10,0],[844,9,844,10,0],[845,13,845,26,0],[846,13,846,14,0],[847,17,847,60,0],[848,17,848,42,0],[849,17,850,83,0],[851,17,851,54,0],[853,9,853,10,0],[857,9,857,10,1],[858,13,858,26,1],[859,13,859,14,1],[860,17,862,80,1],[863,13,863,14,1],[864,9,864,10,1],[867,9,867,10,1],[868,13,869,57,1],[870,9,870,10,1],[873,9,873,10,0],[874,13,876,61,0],[877,13,877,85,0],[878,17,878,82,0],[879,13,879,25,0],[880,9,880,10,0],[883,9,883,10,0],[884,13,885,29,0],[886,9,886,10,0],[889,9,889,10,1],[890,13,891,51,1],[892,9,892,10,1],[895,9,895,10,1],[896,13,896,56,1],[897,13,897,37,1],[898,13,899,27,1],[900,13,900,83,1],[901,9,901,10,1],[904,9,904,10,1],[905,13,906,39,1],[907,9,907,10,1],[910,9,910,10,0],[911,13,911,74,0],[912,13,912,86,0],[913,13,913,89,0],[914,13,914,70,0],[915,13,917,64,0],[919,13,919,44,0],[920,13,920,27,0],[921,13,921,109,0],[922,13,922,14,0],[923,17,923,27,0],[925,13,925,25,0],[926,9,926,10,0],[929,9,929,10,0],[930,13,930,74,0],[931,13,931,86,0],[932,13,932,89,0],[933,13,933,70,0],[934,13,936,64,0],[937,13,937,27,0],[938,13,938,110,0],[939,13,939,14,0],[940,13,940,14,0],[941,9,941,10,0],[944,9,944,10,0],[945,13,945,74,0],[946,13,946,86,0],[947,13,947,89,0],[948,13,948,70,0],[950,13,953,35,0],[954,13,954,40,0],[955,13,955,38,0],[956,13,956,14,0],[957,17,959,47,0],[960,13,960,14,0],[962,17,962,107,0],[964,13,964,90,0],[965,13,967,75,0],[969,13,969,44,0],[970,13,970,27,0],[971,13,972,37,0],[973,13,973,14,0],[975,17,975,24,0],[975,26,975,36,0],[975,37,975,39,0],[975,40,975,57,0],[976,17,976,18,0],[977,21,977,72,0],[978,21,979,44,0],[980,21,980,83,0],[981,25,982,59,0],[983,21,983,45,0],[984,17,984,18,0],[985,17,985,37,0],[988,17,988,29,0],[989,9,989,10,0],[992,9,992,10,0],[993,13,993,105,0],[994,13,994,20,0],[994,22,994,32,0],[994,33,994,35,0],[994,36,994,43,0],[995,13,995,14,0],[996,17,996,46,0],[997,21,997,44,0],[998,13,998,14,0],[999,13,999,23,0],[1000,9,1000,10,0],[1004,9,1004,10,1],[1006,13,1006,89,1],[1007,13,1007,71,1],[1008,13,1008,14,0],[1009,17,1009,103,0],[1010,17,1010,100,0],[1011,17,1011,51,0],[1012,17,1012,18,0],[1013,28,1013,82,0],[1014,21,1014,22,0],[1015,32,1015,64,0],[1016,25,1016,26,0],[1017,29,1017,60,0],[1018,29,1018,36,0],[1018,38,1018,48,0],[1018,49,1018,51,0],[1018,52,1018,71,0],[1019,29,1019,30,0],[1020,33,1020,67,0],[1021,33,1021,78,0],[1022,33,1022,121,0],[1023,33,1023,97,0],[1024,33,1024,81,0],[1025,33,1025,55,0],[1026,33,1026,34,0],[1027,29,1027,30,0],[1028,29,1028,51,0],[1029,29,1029,41,0],[1032,29,1032,42,0],[1033,29,1033,30,0],[1034,33,1036,106,0],[1037,29,1037,30,0],[1038,25,1038,26,0],[1039,21,1039,22,0],[1040,17,1040,18,0],[1041,13,1041,14,0],[1042,9,1042,10,1],[1045,9,1045,10,1],[1046,13,1046,24,1],[1047,13,1049,45,1],[1051,13,1051,31,1],[1051,32,1051,71,1],[1052,13,1052,23,1],[1053,9,1053,10,1],[1056,9,1056,10,1],[1057,13,1057,65,1],[1058,13,1058,76,1],[1059,13,1059,101,1],[1060,13,1060,93,1],[1063,13,1063,87,1],[1065,13,1065,71,1],[1067,13,1067,72,1],[1069,13,1069,42,1],[1070,13,1070,14,1],[1071,24,1071,78,1],[1072,17,1072,18,1],[1073,28,1073,60,1],[1074,21,1074,22,1],[1075,25,1075,64,1],[1078,25,1078,32,1],[1078,34,1078,49,1],[1078,50,1078,52,1],[1078,53,1078,66,1],[1079,25,1079,26,1],[1080,29,1080,59,1],[1082,29,1082,95,1],[1087,29,1088,62,1],[1093,29,1093,93,1],[1096,29,1096,92,1],[1097,29,1097,51,1],[1100,29,1101,69,1],[1102,29,1102,36,1],[1102,38,1102,56,0],[1102,57,1102,59,1],[1102,60,1102,79,1],[1103,29,1103,30,0],[1104,33,1104,86,0],[1105,33,1106,48,0],[1107,33,1107,67,0],[1108,33,1108,105,0],[1109,33,1109,81,0],[1110,33,1110,99,0],[1111,33,1111,55,0],[1112,29,1112,30,0],[1113,25,1113,26,1],[1115,25,1115,47,1],[1116,25,1116,37,1],[1119,25,1119,38,1],[1120,25,1120,26,1],[1121,29,1123,94,1],[1124,25,1124,26,1],[1125,21,1125,22,1],[1126,17,1126,18,1],[1127,13,1127,14,1],[1128,9,1128,10,1],[1133,9,1133,10,0],[1134,13,1139,20,0],[1140,9,1140,10,0],[1143,9,1143,10,0],[1144,13,1146,52,0],[1147,9,1147,10,0],[1151,9,1151,10,0],[1152,13,1152,33,0],[1153,13,1153,44,0],[1154,13,1154,108,0],[1155,13,1155,89,0],[1156,13,1156,60,0],[1158,13,1160,58,0],[1161,13,1163,81,0],[1165,13,1165,123,0],[1166,13,1166,14,0],[1167,17,1167,49,0],[1168,17,1168,18,0],[1169,21,1170,97,0],[1171,25,1171,88,0],[1172,17,1172,18,0],[1174,21,1174,31,0],[1175,13,1175,14,0],[1176,13,1176,23,0],[1177,9,1177,10,0],[1181,9,1181,10,0],[1182,13,1182,26,0],[1183,13,1183,14,0],[1184,17,1186,106,0],[1188,9,1188,10,0],[1192,9,1192,10,0],[1193,13,1193,108,0],[1194,9,1194,10,0],[1197,9,1197,10,1],[1198,13,1199,45,1],[1201,13,1201,103,1],[1202,13,1202,14,0],[1206,17,1206,106,0],[1207,17,1207,41,0],[1208,17,1208,32,0],[1209,17,1209,18,0],[1210,21,1210,40,0],[1211,17,1211,18,0],[1213,17,1213,18,0],[1214,21,1214,50,0],[1215,17,1215,18,0],[1217,17,1217,43,0],[1218,17,1218,46,0],[1219,17,1219,44,0],[1220,13,1220,14,0],[1221,13,1221,23,1],[1222,9,1222,10,1],[1225,9,1225,10,1],[1226,13,1227,22,1],[1228,13,1228,23,1],[1229,9,1229,10,1],[1231,9,1231,10,0],[1232,13,1232,124,0],[1233,13,1233,23,0],[1234,9,1234,10,0],[1237,9,1237,10,0],[1238,13,1238,119,0],[1239,13,1239,23,0],[1240,9,1240,10,0],[1243,9,1243,10,0],[1244,13,1244,57,0],[1245,13,1245,43,0],[1246,13,1246,75,0],[1247,13,1248,76,0],[1249,13,1249,28,0],[1250,9,1250,10,0],[1253,9,1253,10,0],[1254,13,1255,45,0],[1256,9,1256,10,0],[1259,9,1259,10,0],[1260,13,1260,48,0],[1261,13,1261,57,0],[1262,13,1262,70,0],[1263,13,1264,29,0],[1265,13,1265,38,0],[1266,17,1266,45,0],[1267,13,1267,33,0],[1268,9,1268,10,0],[1271,9,1271,10,0],[1272,13,1272,26,0],[1273,13,1273,14,0],[1274,17,1276,123,0],[1277,13,1277,14,0],[1278,9,1278,10,0],[1281,9,1281,10,0],[1282,13,1283,108,0],[1284,13,1284,37,0],[1285,17,1285,37,0],[1287,17,1287,29,0],[1288,9,1288,10,0],[1291,9,1291,10,1],[1292,13,1294,32,1],[1295,9,1295,10,1],[1298,9,1298,10,0],[1299,13,1300,97,0],[1301,9,1301,10,0],[1304,9,1304,10,1],[1305,13,1305,141,1],[1306,13,1306,32,1],[1307,17,1307,44,1],[1309,13,1309,26,0],[1310,9,1310,10,1],[1313,9,1313,10,1],[1314,13,1315,84,1],[1316,9,1316,10,1],[1319,9,1319,10,1],[1320,13,1320,65,1],[1321,13,1321,144,1],[1322,13,1322,71,1],[1323,13,1323,14,1],[1324,17,1324,24,1],[1324,26,1324,41,1],[1324,42,1324,44,1],[1324,45,1324,62,1],[1325,17,1325,18,1],[1326,21,1331,23,1],[1333,21,1333,38,1],[1334,17,1334,18,1],[1335,13,1335,14,1],[1337,13,1337,28,1],[1338,9,1338,10,1],[1341,9,1341,10,0],[1342,13,1343,127,0],[1344,9,1344,10,0],[1347,9,1347,10,0],[1348,13,1349,111,0],[1350,9,1350,10,0]]);
    </script>
  </body>
</html>