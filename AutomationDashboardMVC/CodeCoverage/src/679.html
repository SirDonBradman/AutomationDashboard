<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\BL\ProjectComponent.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.IntegrationConnector;
using Aurigo.AMP3.DataAccess.Core;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.ModuleManagementBL;
using Aurigo.AMP3.ProjectDTO;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.Brix.Platform.BusinessLayer.DataAccessHelper;
using Aurigo.Brix.Platform.BusinessLayer.DTO;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Aurigo.Common.Utility;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Data.Common;
using System.Globalization;
using System.Linq;
using System.Reflection;

namespace Aurigo.AMP3.ProjectDAC
{
    public class ProjectComponent : SingletonManagerBase&lt;ProjectComponent&gt;
    {
        private const string listClosedFormat = &quot;&lt;li&gt;&lt;a href=&#39;{2}&#39; title=&#39;{1}&#39;&gt;&lt;span&gt;{0}&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&quot;;
        private const string listOpenFormat = &quot;&lt;li&gt;&lt;a href=&#39;{2}&#39; title=&#39;{1}&#39;&gt;&lt;span&gt;{0}&lt;/span&gt;&lt;/a&gt;&quot;;

        private ProjectComponent()
        {
        }

        /// &lt;summary&gt;
        /// Gets the list of projects.
        /// &lt;/summary&gt;
        internal DataTable GetProjects(int uid, int rid)
        {
            return GetProjects(null, rid, uid);
        }

        /// &lt;summary&gt;
        /// Gets the list of projects.
        /// &lt;/summary&gt;
        internal DataTable GetProjects(string erpCompany, int rid, int uid)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjects&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                conn.DB.AddInParameter(cmd, &quot;BRIX_ROLE_ID&quot;, DbType.Int32, rid);
                conn.DB.AddInParameter(cmd, &quot;BRIX_USER_ID&quot;, DbType.Int32, uid);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets the list of projects along with ContractId.
        /// &lt;/summary&gt;
        internal DataTable GetProjectsWithContract(string erpCompany, int rid, int uid)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectWithContractDetails&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                conn.DB.AddInParameter(cmd, &quot;BRIX_ROLE_ID&quot;, DbType.Int32, rid);
                conn.DB.AddInParameter(cmd, &quot;BRIX_USER_ID&quot;, DbType.Int32, uid);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }


        /// &lt;summary&gt;
        /// Gets active projects with all details.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetActiveProjects(string erpCompany)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveProjects&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets active projects with all details.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetActiveProjectsForUserId(string erpCompany, int selectedUserID,
            ref int currentPage, string sortKey, int maxRowsInPage, out int totalCount, string optionalContractorBiddingRoleNameToExclude = null)
        {
            //Assumption is that sortKey may come in any format such as  &quot;Field1 ASC&quot;   &quot;Field1 DESC&quot;   &quot;Field1&quot;
            string sortFieldNameOnly = string.Empty;
            bool isAscendingOrder = true;

            if (!string.IsNullOrEmpty(sortKey))
            {
                string[] arr = sortKey.Split(&quot; &quot;.ToCharArray(), StringSplitOptions.RemoveEmptyEntries);

                if (arr.Length &gt; 1 &amp;&amp; arr.Any(t =&gt; t.ToUpper().Trim() == &quot;DESC&quot;))
                    isAscendingOrder = false;

                sortFieldNameOnly = arr.FirstOrDefault(t =&gt; !t.ToUpper().Trim().IsEqualToAny(&quot;DESC&quot;, &quot;ASC&quot;));
            }

            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveProjectsWithCurrentUser&quot;);

                conn.DB.AddInParameter(cmd, &quot;@SelectedUserID&quot;, DbType.Int32, selectedUserID);
                conn.DB.AddInParameter(cmd, &quot;@ERPCompany&quot;, DbType.String, erpCompany);

                //conn.DB.AddInParameter(cmd, &quot;currentUserID&quot;, DbType.Int32, currentUserID);
                //conn.DB.AddInParameter(cmd, &quot;currentRoleID&quot;, DbType.Int32, roleId);

                conn.DB.AddInParameter(cmd, &quot;@CurrentPage&quot;, DbType.Int32, currentPage);
                conn.DB.AddInParameter(cmd, &quot;@MaxRowsInPage&quot;, DbType.Int32, maxRowsInPage);

                if (!string.IsNullOrEmpty(sortFieldNameOnly))
                    conn.DB.AddInParameter(cmd, &quot;@OrderBy&quot;, DbType.String, sortFieldNameOnly);

                conn.DB.AddInParameter(cmd, &quot;@SortOrder&quot;, DbType.String, isAscendingOrder ? &quot;ASC&quot; : &quot;DESC&quot;);
                conn.DB.AddOutParameter(cmd, &quot;TotalCount&quot;, DbType.Int32, 4);

                if (!string.IsNullOrEmpty(optionalContractorBiddingRoleNameToExclude))
                    conn.DB.AddInParameter(cmd, &quot;@ContractorBiddingRoleNameToExclude&quot;, DbType.String, optionalContractorBiddingRoleNameToExclude);

                DataSet ds = conn.DB.ExecuteDataSet(cmd);
                totalCount = conn.DB.GetParameterValue(cmd, &quot;TotalCount&quot;).ToInt32_2();
                return ds.Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets active projects by ids.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetActiveProjectsByIDs(string erpCompany, int currentUserID, int roleId, int selectedUserID,
            string IDs)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveProjectsByIDs&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, erpCompany);
                conn.DB.AddInParameter(cmd, &quot;currentUserID&quot;, DbType.Int32, currentUserID);
                conn.DB.AddInParameter(cmd, &quot;currentRoleID&quot;, DbType.Int32, roleId);
                conn.DB.AddInParameter(cmd, &quot;selectedUserID&quot;, DbType.Int32, selectedUserID);
                conn.DB.AddInParameter(cmd, &quot;IDs&quot;, DbType.String, IDs);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets project list 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;feautresCode&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;startRowIdx&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;maxRows&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;sortOrder&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;filterSearch&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany, string currentRoles,
            bool filterOrSortHasPendingOnUser, out int count)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjVisibility_O&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userID);
                    conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                    conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.AnsiString, feautresCode);
                    conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.AnsiString, moduleID);

                    if (!string.IsNullOrEmpty(filterSearch) &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.AnsiString, filterSearch);
                    else
                        conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.AnsiString, &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot;);

                    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                    else
                        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, 1);

                    if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                    else
                        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, 10);

                    if (sortOrder != null)
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.AnsiString, sortOrder);
                    else
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.AnsiString, &quot;IsActive desc,ProjectName asc&quot;);

                    conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.AnsiStringFixedLength, &quot;N&quot;);

                    if (AXCompany != null)
                        conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.AnsiString, AXCompany);
                    conn.DB.AddInParameter(cmd, &quot;CurrentRole&quot;, DbType.AnsiString, currentRoles);
                    conn.DB.AddInParameter(cmd, &quot;filterTextOrSortHasPendingOnUser&quot;, DbType.Boolean, filterOrSortHasPendingOnUser);

                    conn.DB.AddOutParameter(cmd, &quot;Count&quot;, DbType.Int32, 4);

                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    count = conn.DB.GetParameterValue(cmd, &quot;Count&quot;).ToInt32_2();

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets Planning project list 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;feautresCode&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;moduleID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;startRowIdx&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;maxRows&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;sortOrder&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;filterSearch&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;AXCompany&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;IsProposedProject&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetPlanningProjectsWithFeaturePermission(int userID, int roleID,
            string feautresCode, string moduleID,
            object startRowIdx, object maxRows, string sortOrder,
            string filterSearch, string AXCompany, int IsProposedProject,
            string currentRoles, bool filterOrSortHasPendingOnUser, out int count)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PLANINGGetProjVisibility_O&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userID);
                    conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                    conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.AnsiString, feautresCode);
                    conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.AnsiString, moduleID);
                    conn.DB.AddInParameter(cmd, &quot;filterText&quot;, DbType.AnsiString, filterSearch);

                    if (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, startRowIdx);
                    else
                        conn.DB.AddInParameter(cmd, &quot;rowStartIdx&quot;, DbType.Int32, 1);

                    if (maxRows != null &amp;&amp; startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, maxRows);
                    else
                        conn.DB.AddInParameter(cmd, &quot;maxRowsInPage&quot;, DbType.Int32, 10);

                    if (sortOrder != null)
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.AnsiString, sortOrder);
                    else
                        conn.DB.AddInParameter(cmd, &quot;sortOrder&quot;, DbType.AnsiString, &quot;IsActive desc,ProjectName asc&quot;);

                    conn.DB.AddInParameter(cmd, &quot;getCount&quot;, DbType.AnsiStringFixedLength, &#39;N&#39;);

                    if (AXCompany != null)
                        conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.AnsiString, AXCompany);

                    conn.DB.AddInParameter(cmd, &quot;IsProposedProject&quot;, DbType.Int32, IsProposedProject);
                    conn.DB.AddInParameter(cmd, &quot;CurrentRole&quot;, DbType.AnsiString, currentRoles);
                    conn.DB.AddInParameter(cmd, &quot;filterTextOrSortHasPendingOnUser&quot;, DbType.Boolean, filterOrSortHasPendingOnUser);

                    conn.DB.AddOutParameter(cmd, &quot;Count&quot;, DbType.Int32, 4);

                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    count = conn.DB.GetParameterValue(cmd, &quot;Count&quot;).ToInt32_2();

                    return ds.Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Get the Projects Count for each status.
        /// &lt;/summary&gt;
        internal DataTable GetProjectCountByStatus(string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStatusProjCount&quot;);
                if (!string.IsNullOrEmpty(axCompany))
                    conn.DB.AddInParameter(cmd, &quot;Company&quot;, DbType.String, axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Get the Projects Count by Cost.
        /// &lt;/summary&gt;
        internal DataTable GetProjectCountByCost(string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_PROJECTCOUNTBYCOST&quot;);
                if (!string.IsNullOrEmpty(axCompany))
                    conn.DB.AddInParameter(cmd, &quot;Company&quot;, DbType.String, axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Get the Projects Count by Completion Time.
        /// &lt;/summary&gt;
        internal DataTable GetProjectCountByCompletion(string axCompany, int userID, int roleID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_PROJECTCOUNTBYCOMPLETION&quot;);
                if (!string.IsNullOrEmpty(axCompany))
                    conn.DB.AddInParameter(cmd, &quot;Company&quot;, DbType.String, axCompany);
                conn.DB.AddInParameter(cmd, &quot;UserID&quot;, DbType.Int32, userID);
                conn.DB.AddInParameter(cmd, &quot;RoleID&quot;, DbType.Int32, roleID);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Get all the project templates created in the system.
        /// &lt;/summary&gt;
        internal DataTable GetTemplates()
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetTemplates&quot;);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets the Attribute list for a project. 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal Dictionary&lt;string, string&gt; GetAttributesValues(int projectId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var iDict = new Dictionary&lt;string, string&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjAttribs&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);

                    DataTable attributeDt = conn.DB.ExecuteDataSet(cmd).Tables[0];

                    if (attributeDt.Rows.Count &gt; 0)
                    {
                        foreach (DataRow dr in attributeDt.Rows)
                        {
                            iDict.Add(dr[&quot;ATTRIBUTENAME&quot;].ToString2(), dr[&quot;ATTRIBUTEVALUE&quot;].ToString2());
                        }
                    }
                    return iDict;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Gets all the status available while creating a project.
        /// &lt;/summary&gt;
        internal DataTable GetStatus(bool IsLibrary)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStatusNames&quot;);
                conn.DB.AddInParameter(cmd, &quot;IsLibrary&quot;, DbType.Boolean, IsLibrary);
                return conn.DB.ExecuteDataSet(cmd).Tables[0];
            }
        }

        /// &lt;summary&gt;
        /// Gets all the status available while creating a project.
        /// &lt;/summary&gt;
        internal DataTable GetProjectSummary(string AxCompany)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectSummary, null, AxCompany).
                    Tables[0];
        }

        /// &lt;summary&gt;
        /// Gets the project mode for a particular project.
        /// &lt;/summary&gt;
        internal DataTable GetProjectMode(int projectID)
        {
            return
                ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectMode, null, projectID).
                    Tables[0];
        }

        /// &lt;summary&gt;
        /// Creates Projects.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectDTO&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CreateProject(Project projectDTO, int userID, int roleID)
        {
            List&lt;Platform&gt; projectModules = projectDTO.ProjectModules;
            List&lt;Project.AttributeClass&gt; projectAttributes = projectDTO.ProjectAttributesList;
            int projectId;

            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateProject&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_ProjectCode&quot;, DbType.String, projectDTO.ProjectCode);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectName&quot;, DbType.String, projectDTO.ProjectName);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, projectDTO.ProjectDescription);
                        conn.DB.AddInParameter(cmd, &quot;in_CreateDate&quot;, DbType.DateTime, projectDTO.ProjectCreatedDate);
                        conn.DB.AddInParameter(cmd, &quot;in_Owner&quot;, DbType.String, projectDTO.ProjectOwner);
                        conn.DB.AddInParameter(cmd, &quot;in_StartDate&quot;, DbType.DateTime, projectDTO.ProjectStartDate);
                        conn.DB.AddInParameter(cmd, &quot;in_EndDate&quot;, DbType.DateTime, projectDTO.ProjectEndDate);
                        conn.DB.AddInParameter(cmd, &quot;in_StatusId&quot;, DbType.Int32, projectDTO.ProjectStatus);
                        conn.DB.AddInParameter(cmd, &quot;in_IsActive&quot;, DbType.Boolean, projectDTO.ProjectIsActive);
                        conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, projectDTO.ProjectTemplateID);
                        conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userID);
                        conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                        conn.DB.AddInParameter(cmd, &quot;in_LMMasterID&quot;, DbType.Int32, projectDTO.LandMasterID);
                        conn.DB.AddInParameter(cmd, &quot;in_AXCompanyName&quot;, DbType.String, projectDTO.AXCompanyName);
                        conn.DB.AddInParameter(cmd, &quot;in_ERPCurrency&quot;, DbType.String, projectDTO.ERPCurrency);
                        conn.DB.AddInParameter(cmd, &quot;in_DocumentListID&quot;, DbType.String, projectDTO.DocumentListID);
                        // for share point 
                        conn.DB.AddInParameter(cmd, &quot;in_DocumentTemplateID&quot;, DbType.Int32, projectDTO.DocumentTemplateID);
                        // for document templates
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectMode&quot;, DbType.String, projectDTO.ProjectMode);
                        conn.DB.AddInParameter(cmd, &quot;in_DocMetadataID&quot;, DbType.String, projectDTO.DocumentMetadataID);
                        conn.DB.AddInParameter(cmd, &quot;in_ProgramYear&quot;, DbType.String, projectDTO.ProgramYear);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectValue&quot;, DbType.Decimal, projectDTO.ProjectValue);
                        conn.DB.AddInParameter(cmd, &quot;in_ExpenditureCurveID&quot;, DbType.String,
                            projectDTO.ExpenditureCurveID);
                        conn.DB.AddInParameter(cmd, &quot;in_CalendarType&quot;, DbType.String, projectDTO.CalendarType);
                        conn.DB.AddInParameter(cmd, &quot;in_CalendarDays&quot;, DbType.String, projectDTO.CalendarDays);
                        conn.DB.AddInParameter(cmd, &quot;in_ProgramClass&quot;, DbType.String, projectDTO.ProjectClass);
                        conn.DB.AddOutParameter(cmd, &quot;out_ProjectID&quot;, DbType.Int32, 4);
                        conn.DB.AddInParameter(cmd, &quot;in_BusinessUnitID&quot;, DbType.Int32, projectDTO.BusinessUnitID);
                        conn.DB.AddInParameter(cmd, &quot;in_ModifiedBy&quot;, DbType.String, projectDTO.ModifiedBy);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        projectId = conn.DB.GetParameterValue(cmd, &quot;out_ProjectID&quot;).ToInt32_2();
                        if (projectId &gt; 0)
                        {
                            if (projectAttributes != null)
                            {
                                foreach (Project.AttributeClass objAttributes in projectAttributes)
                                {
                                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddAttributes&quot;);

                                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                                    conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.String,
                                        objAttributes.AttributeId);
                                    conn.DB.AddInParameter(cmd, &quot;in_AttributeValue&quot;, DbType.String,
                                        (objAttributes.AttributeValue.Length &gt; 40
                                            ? objAttributes.AttributeValue.Substring(0, 40)
                                            : objAttributes.AttributeValue));
                                    conn.DB.AddInParameter(cmd, &quot;in_AttributeNotes&quot;, DbType.String,
                                        objAttributes.AttributeNotes);
                                    conn.DB.AddInParameter(cmd, &quot;in_ModifiedBy&quot;, DbType.String,
                                        projectDTO.ModifiedBy);
                                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                    conn.DB.ExecuteNonQuery(cmd, tran);
                                }
                            }

                            if (projectModules != null)
                            {
                                foreach (Platform objModules in projectModules)
                                {
                                    cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddModules&quot;);

                                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                                    conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, objModules.ModuleId);
                                    conn.DB.AddInParameter(cmd, &quot;in_PlatformKey&quot;, DbType.String, objModules.PlatformKey);
                                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                    conn.DB.ExecuteNonQuery(cmd, tran);
                                }
                            }

                            tran.Commit();

                            if (projectDTO.ProjectMode.Equals(&#39;L&#39;))
                                CacheManager.Instance.RemoveLiveProjects(projectDTO.ProjectID);
                            else
                                CacheManager.Instance.AddIntegratedProjects(projectDTO.ProjectID);


                            //# region AX Integration
                            //if (ConnectorFacade.Instance.LastException != null)
                            //    throw ConnectorFacade.Instance.LastException;

                            //if (ConnectorFacade.Instance.IsERPConnectorAttached)
                            //{
                            //    DataSet dsProject = new BrixDataSet();
                            //    DataTable dtProject = new BrixDataTable();
                            //    dtProject.Columns.Add(&quot;Code&quot;);
                            //    dtProject.Columns.Add(&quot;Project&quot;);
                            //    dtProject.Columns.Add(&quot;StartDate&quot;, typeof(System.DateTime));
                            //    dtProject.Columns.Add(&quot;EndDate&quot;, typeof(System.DateTime));
                            //    dtProject.Columns.Add(&quot;Owner&quot;);
                            //    dtProject.Columns.Add(&quot;Date Created&quot;, typeof(System.DateTime));
                            //    DataRow dr = dtProject.NewRow();
                            //    dr[&quot;Code&quot;] = projectDTO.ProjectCode;
                            //    dr[&quot;Project&quot;] = projectDTO.ProjectName;
                            //    dr[&quot;StartDate&quot;] = projectDTO.ProjectStartDate;
                            //    dr[&quot;EndDate&quot;] = projectDTO.ProjectEndDate;
                            //    dr[&quot;Owner&quot;] = projectDTO.ProjectOwner;
                            //    dr[&quot;Date Created&quot;] = projectDTO.ProjectCreatedDate;
                            //    dtProject.Rows.Add(dr);
                            //    dsProject.Tables.Add(dtProject);
                            //    NonQueryStatus[] objNonQueryStatus = ERPComponent.Instance.ExecuteERPTrigger(AMP3ObjectType.Project, MethodInfo.GetCurrentMethod(), dsProject);
                            //    if (objNonQueryStatus[0].Status == EISOperationStatus.Failure)
                            //    {
                            //        throw objNonQueryStatus[0].Exception;
                            //    }
                            //}
                            //# endregion
                        }
                        else
                        {
                            tran.Rollback();
                        }
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw ex;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw ex;
            }

            return projectId;
        }

        /// &lt;summary&gt;
        /// Creates Template ,its Attributes and Modules.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateDTO&quot;&gt;&lt;/param&gt;
        internal int CreateTemplate(Template templateDTO)
        {
            Dictionary&lt;string, string&gt; templateAttributes = templateDTO.TemplateAttributes;
            List&lt;Platform&gt; templateModules = templateDTO.TemplateModules;
            int templateId;

            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateTemplate&quot;);
                        conn.DB.AddInParameter(cmd, &quot;in_TemplateName&quot;, DbType.String, templateDTO.Name);
                        conn.DB.AddInParameter(cmd, &quot;in_CreatedBy&quot;, DbType.String, templateDTO.CreatedBy);

                        conn.DB.AddOutParameter(cmd, &quot;out_TemplateID&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        templateId = conn.DB.GetParameterValue(cmd, &quot;out_TemplateID&quot;).ToInt32_2();

                        if (templateId &gt; 0)
                        {
                            foreach (var objAttributes in templateAttributes)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddTemplateAttrib&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateId);
                                conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.String, objAttributes.Key);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);
                            }
                            for (int j = 0; j &lt; templateModules.Count; j++)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddTemplateModules&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateId);
                                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, templateModules[j].ModuleId);
                                conn.DB.AddInParameter(cmd, &quot;in_PlatformKey&quot;, DbType.String,
                                    templateModules[j].PlatformKey);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);
                            }
                            tran.Commit();
                        }
                        else
                        {
                            tran.Rollback();
                        }
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return templateId;
        }

        /// &lt;summary&gt;
        /// Updates the existing project details when editing and saving a project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        internal int UpdateProject(Project projectDTO, int userID, int roleID)
        {
            List&lt;Platform&gt; projectModules = projectDTO.ProjectModules;
            List&lt;Project.AttributeClass&gt; projectAttributes = projectDTO.ProjectAttributesList;
            int rtnValue;

            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateProject&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_ProjectCode&quot;, DbType.String, projectDTO.ProjectCode);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectName&quot;, DbType.String, projectDTO.ProjectName);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, projectDTO.ProjectDescription);
                        conn.DB.AddInParameter(cmd, &quot;in_CreateDate&quot;, DbType.DateTime, projectDTO.ProjectCreatedDate);
                        conn.DB.AddInParameter(cmd, &quot;in_Owner&quot;, DbType.String, projectDTO.ProjectOwner);
                        conn.DB.AddInParameter(cmd, &quot;in_StartDate&quot;, DbType.DateTime, projectDTO.ProjectStartDate);
                        conn.DB.AddInParameter(cmd, &quot;in_EndDate&quot;, DbType.DateTime, projectDTO.ProjectEndDate);
                        conn.DB.AddInParameter(cmd, &quot;in_StatusId&quot;, DbType.Int32, projectDTO.ProjectStatus);
                        conn.DB.AddInParameter(cmd, &quot;in_IsActive&quot;, DbType.Int32, (projectDTO.ProjectIsActive) ? 1 : 0);
                        conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, projectDTO.ProjectTemplateID);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectDTO.ProjectID);
                        conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userID);
                        conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);
                        conn.DB.AddInParameter(cmd, &quot;in_LMMasterID&quot;, DbType.Int32, projectDTO.LandMasterID);
                        conn.DB.AddInParameter(cmd, &quot;in_ERPCurrency&quot;, DbType.String, projectDTO.ERPCurrency);
                        conn.DB.AddInParameter(cmd, &quot;in_AXCompanyName&quot;, DbType.String, projectDTO.AXCompanyName);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectMode&quot;, DbType.String, projectDTO.ProjectMode);
                        conn.DB.AddInParameter(cmd, &quot;in_DocumentListID&quot;, DbType.String, projectDTO.DocumentListID);
                        conn.DB.AddInParameter(cmd, &quot;in_DocumentTemplateID&quot;, DbType.Int32, projectDTO.DocumentTemplateID);
                        conn.DB.AddInParameter(cmd, &quot;in_DocMetadataID&quot;, DbType.String, projectDTO.DocumentMetadataID);
                        conn.DB.AddInParameter(cmd, &quot;in_ProgramYear&quot;, DbType.String, projectDTO.ProgramYear);
                        conn.DB.AddInParameter(cmd, &quot;in_ModifiedBy&quot;, DbType.String, projectDTO.ModifiedBy);
                        conn.DB.AddInParameter(cmd, &quot;in_ModifiedOn&quot;, DbType.DateTime, projectDTO.ModifiedOn);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectValue&quot;, DbType.Decimal, projectDTO.ProjectValue);
                        conn.DB.AddInParameter(cmd, &quot;in_ExpenditureCurveID&quot;, DbType.Int32, projectDTO.ExpenditureCurveID);
                        conn.DB.AddInParameter(cmd, &quot;in_CalendarType&quot;, DbType.String, projectDTO.CalendarType);
                        conn.DB.AddInParameter(cmd, &quot;in_CalendarDays&quot;, DbType.String, projectDTO.CalendarDays);
                        conn.DB.AddInParameter(cmd, &quot;in_ProgramClass&quot;, DbType.String, projectDTO.ProjectClass);
                        conn.DB.AddOutParameter(cmd, &quot;out_retValue&quot;, DbType.Int32, 4);
                        conn.DB.AddInParameter(cmd, &quot;in_BusinessUnitID&quot;, DbType.Int32, projectDTO.BusinessUnitID);

                        conn.DB.ExecuteNonQuery(cmd, tran);

                        rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_retValue&quot;).ToInt32_2();

                        if (rtnValue &gt; 0)
                        {
                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelAllProjAttribs&quot;);
                            conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectDTO.ProjectID);
                            conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd, tran);

                            foreach (Project.AttributeClass objAttributes in projectAttributes)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddAttributes&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectDTO.ProjectID);
                                conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.String, objAttributes.AttributeId);
                                conn.DB.AddInParameter(cmd, &quot;in_AttributeValue&quot;, DbType.String,
                                    objAttributes.AttributeValue);
                                conn.DB.AddInParameter(cmd, &quot;in_AttributeNotes&quot;, DbType.String,
                                    objAttributes.AttributeNotes);
                                conn.DB.AddInParameter(cmd, &quot;in_ModifiedBy&quot;, DbType.String,
                                        projectDTO.ModifiedBy);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);
                                rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                            }

                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelAllProjMods&quot;);
                            conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectDTO.ProjectID);
                            conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd, tran);


                            foreach (Platform objModules in projectModules)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddModules&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectDTO.ProjectID);
                                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, objModules.ModuleId);
                                conn.DB.AddInParameter(cmd, &quot;in_PlatformKey&quot;, DbType.String, objModules.PlatformKey);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);
                                rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                            }
                            tran.Commit();

                            if (projectDTO.ProjectMode.Equals(&#39;L&#39;))
                                CacheManager.Instance.RemoveLiveProjects(projectDTO.ProjectID);
                            else
                                CacheManager.Instance.AddIntegratedProjects(projectDTO.ProjectID);
                        }
                        else
                        {
                            tran.Rollback();
                        }
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return rtnValue;
        }

        /// &lt;summary&gt;
        /// Updates the existing tempalte details when editing and saving a template.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateDTO&quot;&gt;&lt;/param&gt;
        internal int UpdateTemplate(Template templateDTO)
        {
            List&lt;Platform&gt; templateModules = templateDTO.TemplateModules;
            Dictionary&lt;string, string&gt; templateAttributes = templateDTO.TemplateAttributes;

            int rtnValue;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateTemplate&quot;);
                        conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateDTO.TempId);
                        conn.DB.AddInParameter(cmd, &quot;in_TemplateName&quot;, DbType.String, templateDTO.Name);
                        conn.DB.AddInParameter(cmd, &quot;in_CreatedBy&quot;, DbType.String, templateDTO.CreatedBy);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);
                        rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();

                        if (rtnValue &gt; 0)
                        {
                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelTemplateAttrib&quot;);
                            conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateDTO.TempId);
                            conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd, tran);

                            foreach (var objAttributes in templateAttributes)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddTemplateAttrib&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateDTO.TempId);
                                conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.String, objAttributes.Key);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);
                                rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                            }

                            cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelTemplateMod&quot;);
                            conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateDTO.TempId);
                            conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                            conn.DB.ExecuteNonQuery(cmd, tran);

                            for (int j = 0; j &lt; templateModules.Count; j++)
                            {
                                cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddTemplateModules&quot;);
                                conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateDTO.TempId);
                                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, templateModules[j].ModuleId);
                                conn.DB.AddInParameter(cmd, &quot;in_PlatformKey&quot;, DbType.String,
                                    templateModules[j].PlatformKey);
                                conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                                conn.DB.ExecuteNonQuery(cmd, tran);

                                rtnValue = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                            }
                            tran.Commit();
                        }
                        else
                        {
                            tran.Rollback();
                            rtnValue = -100; //Error while creating Project
                        }
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return rtnValue;
        }

        /// &lt;summary&gt;
        /// Gets the project value for a particular project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Hashtable GetProjectValue(int projectId)
        {
            Hashtable HtGetApprovedBudget = new Hashtable();
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_BDGMGMTApprovedBudget&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ProjectId&quot;, DbType.Int32, projectId);
                    conn.DB.AddOutParameter(cmd, &quot;IsApprovedBudget&quot;, DbType.Int32, 4);
                    conn.DB.AddOutParameter(cmd, &quot;ApprovedBudget&quot;, DbType.Double, 0);
                    conn.DB.ExecuteNonQuery(cmd);
                    HtGetApprovedBudget.Add(conn.DB.GetParameterValue(cmd, &quot;IsApprovedBudget&quot;).ToString(),
                        conn.DB.GetParameterValue(cmd, &quot;ApprovedBudget&quot;).ToString());
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return HtGetApprovedBudget;
        }

        internal bool CheckConcurrency(int projectID, string timestamp)
        {
            if (!string.IsNullOrEmpty(timestamp))
            {
                int count = 0;
                int.TryParse(
                    ComponentHelper.Instance.ExecuteScalar(&quot;select count(*) from PROJECTProjectMain where ProjectID ={0} and AUR_Timestamp ={1}&quot;,
                    projectID, timestamp).ToString(),
                    out count);
                if (count &lt; 1)
                    return false;
            }
            return true;
        }

        /// &lt;summary&gt;
        /// Gets the project details for a particular project.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal Project GetProjectDetails(int projectId)
        {
            var dtoProject = new Project();
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    int out_result = 0;
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectDetails&quot;,
                        new object[] { projectId, out_result });
                    //conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    //conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);

                    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;
                    var projectAttributes = new List&lt;Project.AttributeClass&gt;();
                    var projectModules = new List&lt;Platform&gt;();

                    if (dtColl[0].Rows.Count &gt; 0)
                    {
                        DataRow dtRow = dtColl[0].Rows[0];
                        dtoProject.IsPublished = dtRow[&quot;IsPublish&quot;].ToBoolean2();
                        dtoProject.ProjectID = dtRow[&quot;ProjectId&quot;].ToInt32_2();
                        dtoProject.ProjectCode = dtRow[&quot;ProjectCode&quot;].ToString2();
                        dtoProject.Timestamp = dtRow[&quot;AUR_Timestamp&quot;].ToString2();
                        dtoProject.ProjectName = dtRow[&quot;ProjectName&quot;].ToString2();
                        dtoProject.ProjectDescription = dtRow[&quot;Description&quot;].ToString2();
                        dtoProject.ProjectCreatedDate = Convert.ToDateTime(dtRow[&quot;CreateDate&quot;].ToString2(),
                            CultureInfo.InvariantCulture);
                        dtoProject.ProjectOwner = dtRow[&quot;Owner&quot;].ToString2();
                        dtoProject.ProjectStartDate = Convert.ToDateTime(dtRow[&quot;StartDate&quot;].ToString2(),
                            CultureInfo.InvariantCulture);
                        dtoProject.ProjectEndDate = Convert.ToDateTime(dtRow[&quot;EndDate&quot;].ToString2(),
                            CultureInfo.InvariantCulture);
                        dtoProject.ProjectStatus = dtRow[&quot;StatusId&quot;].ToInt32_2();
                        dtoProject.ProjectStatusName = dtRow[&quot;StatusName&quot;].ToString2();
                        dtoProject.ProjectIsActive = dtRow[&quot;IsActive&quot;].ToString2().ToBoolean2();
                        dtoProject.ProjectTemplateID = dtRow[&quot;TemplateId&quot;].ToString2().ToInt32_2();
                        dtoProject.LandMasterID = dtRow[&quot;LandMasterID&quot;].ToString2().ToInt32_2();
                        dtoProject.LandMasterName = dtRow[&quot;LandName&quot;].ToString2();

                        if (!dtRow[&quot;DocumentTemplateID&quot;].Equals(DBNull.Value))
                        {
                            dtoProject.DocumentTemplateID = dtRow[&quot;DocumentTemplateID&quot;].ToInt32_2();
                            dtoProject.DocumentTemplateName = dtRow[&quot;DocTemplateName&quot;].ToString2();
                        }
                        if (!dtRow[&quot;DocMetadataID&quot;].Equals(DBNull.Value))
                        {
                            dtoProject.DocumentMetadataID = dtRow[&quot;DocMetadataID&quot;].ToInt32_2();
                            dtoProject.DocumentMetadataName = dtRow[&quot;DocMetadataName&quot;].ToString2();
                        }
                        dtoProject.ProjectMode = Convert.ToChar(dtRow[&quot;ProjectMode&quot;].ToString(),
                            CultureInfo.InvariantCulture);
                        if (!dtRow[&quot;IsDeleted&quot;].Equals(DBNull.Value))
                            dtoProject.IsDeleted = dtRow[&quot;IsDeleted&quot;].ToBoolean2();

                        if (!dtRow[&quot;ProgramYear&quot;].Equals(DBNull.Value))
                            dtoProject.ProgramYear = dtRow[&quot;ProgramYear&quot;].ToString2();

                        if (!dtRow[&quot;ProjectClass&quot;].Equals(DBNull.Value))
                            dtoProject.ProjectClass = dtRow[&quot;ProjectClass&quot;].ToString2();


                        if (!dtRow[&quot;ProgramCategory&quot;].Equals(DBNull.Value))
                            dtoProject.ProjectClassName = dtRow[&quot;ProgramCategory&quot;].ToString2();

                        if (!dtRow[&quot;ProjectValue&quot;].Equals(DBNull.Value))
                            dtoProject.ProjectValue = (Convert.ToDecimal(dtRow[&quot;ProjectValue&quot;]));

                        if (!dtRow[&quot;ExpenditureCurve&quot;].Equals(DBNull.Value))
                            dtoProject.ExpenditureCurveID = dtRow[&quot;ExpenditureCurve&quot;].ToInt32_2();

                        if (!dtRow[&quot;CalendarType&quot;].Equals(DBNull.Value))
                            dtoProject.CalendarType = dtRow[&quot;CalendarType&quot;].ToInt32_2();

                        if (!dtRow[&quot;CalendarDays&quot;].Equals(DBNull.Value))
                            dtoProject.CalendarDays = dtRow[&quot;CalendarDays&quot;].ToInt32_2();

                        if (!dtRow[&quot;TotalScore&quot;].Equals(DBNull.Value))
                            dtoProject.ProjectScore = dtRow[&quot;TotalScore&quot;].ToDouble2();

                        if (dtRow[&quot;BusinessUnitID&quot;] == DBNull.Value || string.IsNullOrEmpty(dtRow[&quot;BusinessUnitID&quot;].ToString2()))
                        {
                            dtoProject.BusinessUnitID = null;
                            dtoProject.BusinessUnitPath = &quot;Not Defined&quot;;
                        }
                        else
                        {
                            dtoProject.BusinessUnitID = dtRow[&quot;BusinessUnitID&quot;].ToInt32_2();
                            dtoProject.BusinessUnitPath = dtRow[&quot;BusinessUnitPath&quot;].ToString2();
                        }

                    }
                    if (dtColl[1].Rows.Count &gt; 0)
                    {
                        foreach (DataRow dtSubRow in dtColl[1].Rows)
                        {
                            var attribute = new Project.AttributeClass
                            {
                                AttributeId = dtSubRow[&quot;ATTRIBUTEID&quot;].ToString2().Parse2(),
                                AttributeName = dtSubRow[&quot;AttributeName&quot;].ToString2(),
                                AttributeValue = dtSubRow[&quot;ATTRIBUTEVALUE&quot;].ToString2(),
                                AttributeType = dtSubRow[&quot;AttributeType&quot;].ToString2(),
                                AttributeNotes = dtSubRow[&quot;AttributeNotes&quot;].ToString2()
                            };
                            dtoProject.ProjectAttributesList.Add(attribute);
                        }
                    }
                    if (dtColl[2].Rows.Count &gt; 0)
                    {
                        foreach (DataRow dtSubRow in dtColl[2].Rows)
                            projectModules.Add(
                                new Platform(dtSubRow[&quot;MODULEID&quot;].ToString2(), dtSubRow[&quot;PLATFORMKEY&quot;].ToString2()));
                    }
                    dtoProject.ProjectModules = projectModules;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return dtoProject;
        }

        /// &lt;summary&gt;
        /// Gets the project details given a project code.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectCode&quot;&gt;&lt;/param&gt;
        internal Project GetProjectDetails(string projectCode)
        {
            var dtoProject = new Project();
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectDetailsfromCode&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectCode&quot;, DbType.String, projectCode);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);

                    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;
                    if (dtColl[0].Rows.Count &gt; 0)
                    {
                        DataRow dtRow = dtColl[0].Rows[0];
                        dtoProject.ProjectID = dtRow[&quot;ProjectId&quot;].ToInt32_2();
                        dtoProject.ProjectCode = dtRow[&quot;ProjectCode&quot;].ToString2();
                        dtoProject.ProjectName = dtRow[&quot;ProjectName&quot;].ToString2();
                        dtoProject.ProjectDescription = dtRow[&quot;Description&quot;].ToString2();
                        dtoProject.ProjectCreatedDate = Convert.ToDateTime(dtRow[&quot;CreateDate&quot;].ToString2(), CultureInfo.InvariantCulture);
                        dtoProject.ProjectOwner = dtRow[&quot;Owner&quot;].ToString2();
                        dtoProject.ProjectStartDate = Convert.ToDateTime(dtRow[&quot;StartDate&quot;].ToString2(), CultureInfo.InvariantCulture);
                        dtoProject.ProjectEndDate = Convert.ToDateTime(dtRow[&quot;EndDate&quot;].ToString2(), CultureInfo.InvariantCulture);
                        dtoProject.ProjectStatus = dtRow[&quot;StatusId&quot;].ToInt32_2();
                        dtoProject.ProjectIsActive = dtRow[&quot;IsActive&quot;].ToString2().ToBoolean2();
                        dtoProject.ProjectTemplateID = dtRow[&quot;TemplateId&quot;].ToString2().ToInt32_2();
                        dtoProject.ProgramYear = dtRow[&quot;ProgramYear&quot;].ToString2();

                        if (dtRow[&quot;BusinessUnitID&quot;] == DBNull.Value || string.IsNullOrEmpty(dtRow[&quot;BusinessUnitID&quot;].ToString2()))
                        {
                            dtoProject.BusinessUnitID = null;
                            dtoProject.BusinessUnitPath = &quot;Not Defined&quot;;
                        }
                        else
                        {
                            dtoProject.BusinessUnitID = dtRow[&quot;BusinessUnitID&quot;].ToInt32_2();
                            dtoProject.BusinessUnitPath = dtRow[&quot;BusinessUnitPath&quot;].ToString2();

                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return dtoProject;
        }

        /// &lt;summary&gt;
        /// Gets the template details for a template.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;templateId&quot;&gt;&lt;/param&gt;
        internal Template GetTemplateDetails(int templateId, string parentModuleID)
        {
            var dtoTemplate = new Template();
            try
            {
                //int nRetValue = 0;
                //DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetTemplateDetails&quot;, new object[] { templateId, null, null, null, nRetValue });
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetTemplateDetails&quot;,
                        new object[] { templateId });

                    DataTableCollection dtColl = conn.DB.ExecuteDataSet(cmd).Tables;
                    var templateAttributes = new Dictionary&lt;string, string&gt;();
                    var templateModules = new List&lt;Platform&gt;();

                    if (dtColl[0].Rows.Count &gt; 0)
                    {
                        DataRow dtRow = dtColl[0].Rows[0];
                        dtoTemplate.TempId = dtRow[&quot;TemplateId&quot;].ToInt32_2();
                        dtoTemplate.Name = dtRow[&quot;TemplateName&quot;].ToString2();
                        dtoTemplate.CreatedBy = dtRow[&quot;CreatedBy&quot;].ToString2();
                    }

                    // Attributes not implemented as of now.
                    //if (dtColl[1].Rows.Count &gt; 0)
                    //{
                    //    foreach (DataRow dtSubRow in dtColl[1].Rows)
                    //    {
                    //        templateAttributes.Add(dtSubRow[&quot;AttributeIdType&quot;].ToString2(),
                    //            dtSubRow[&quot;AttributeName&quot;].ToString2());
                    //    }
                    //}

                    DataTable dt_TemplateModules = dtColl[1];

                    if (dt_TemplateModules.Rows.Count &gt; 0)
                    {
                        string filterExpression = string.Format(&quot;ParentModuleID = &#39;{0}&#39;&quot;, parentModuleID);
                        DataRow[] rows = dt_TemplateModules.Select(filterExpression);
                        if (rows.IsNotNullAndHasItems())
                        {
                            foreach (DataRow row in rows)
                            {
                                templateModules.Add(new Platform(row[&quot;ModuleId&quot;].ToString2(), row[&quot;PlatformKey&quot;].ToString2()));
                            }
                        }
                    }

                    dtoTemplate.TemplateAttributes = templateAttributes;
                    dtoTemplate.TemplateModules = templateModules;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return dtoTemplate;
        }

        /// &lt;summary&gt;
        /// Deletes a particular peoject based on the ID passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal int DeleteProject(int projectId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteProject&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes a particular peoject based on the ID passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UserId&quot;&gt;&lt;/param&gt;
        internal int DeleteADUsersOrGroups(string UserIDOrGroupID, string Type)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_ADUsersGroupsDelete&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_UserOrGroupID&quot;, DbType.String, UserIDOrGroupID);
                    conn.DB.AddInParameter(cmd, &quot;in_Type&quot;, DbType.String, Type);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes a particular template based on the ID passed.
        /// &lt;/summary&gt;
        internal int DeleteTemplate(int templateId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteTemplate&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Activates / Deactivates a particular project based on the ID passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal int ActivateDeactivateProject(int projectId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTActvDactvProj&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Copies a project and its Modules/ Attributes based on the options selected.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sourceProjectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;targetProjectName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;targetProjectCode&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyModules&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyAttributes&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;copyUsers&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleID&quot;&gt;&lt;/param&gt;
        internal int CopyProject(int sourceProjectId, string targetProjectName, string targetProjectCode,
            string targetDescription,
            bool copyModules,
            bool copyAttributes, bool copyUsers, int userID, int roleID)
        {
            try
            {
                int tempCopyAttributes = 0;
                int tempCopyModules = 0;
                int tempCopyUsers = 0;
                if (copyAttributes) tempCopyAttributes = 1;
                if (copyModules) tempCopyModules = 1;
                if (copyUsers) tempCopyUsers = 1;
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCopyProject&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_SourceProjectID&quot;, DbType.Int32, sourceProjectId);
                    conn.DB.AddInParameter(cmd, &quot;in_TargetProjectName&quot;, DbType.String, targetProjectName);
                    conn.DB.AddInParameter(cmd, &quot;in_TargetProjectCode&quot;, DbType.String, targetProjectCode);
                    conn.DB.AddInParameter(cmd, &quot;in_TargetDescription&quot;, DbType.String, targetDescription);
                    conn.DB.AddInParameter(cmd, &quot;in_CopyModules&quot;, DbType.Int32, tempCopyModules);
                    conn.DB.AddInParameter(cmd, &quot;in_CopyAttributes&quot;, DbType.Int32, tempCopyAttributes);
                    conn.DB.AddInParameter(cmd, &quot;in_CopyUsers&quot;, DbType.Int32, tempCopyUsers);
                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userID);
                    conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleID);


                    conn.DB.AddOutParameter(cmd, &quot;out_ProjectId&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_ProjectId&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Adds project to the recently viewed list
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int AddRecentProject(int projectId, int userId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddRecentProject&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_ProjectId&quot;, DbType.Int32, projectId);
                    conn.DB.AddInParameter(cmd, &quot;in_UserId&quot;, DbType.Int32, userId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// To add users to a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userList&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal int AddUserstoProject(Dictionary&lt;int, int&gt; userList, int projectId)
        {
            try
            {
                int result = 0;
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    foreach (var obj in userList)
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddUsersToProject&quot;);
                        conn.DB.AddInParameter(cmd, &quot;in_ProjectId&quot;, DbType.Int32, projectId);
                        conn.DB.AddInParameter(cmd, &quot;in_UserId&quot;, DbType.Int32, obj.Value);
                        conn.DB.AddInParameter(cmd, &quot;in_RoleId&quot;, DbType.Int32, obj.Key);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);

                        conn.DB.ExecuteNonQuery(cmd);
                        result = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                    }
                    return result;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the users associated with a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        public DataTable GetProjectUsers(int projectId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectUsers&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    DataTable attributeDt = conn.DB.ExecuteDataSet(cmd).Tables[0];
                    return attributeDt;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets the users associated with a project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        internal DataTable GetProjectUserDetails(int projectId)
        {
            try
            {
                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectUserDetails,
                    null, projectId);
                if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                    return ds.Tables[0];
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return null;
        }

        internal DataTable GetProjectUserIDs(int projectId)
        {
            try
            {
                DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectUserIDs,
                    null, projectId);
                if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                    return ds.Tables[0];
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
            return null;
        }

        internal DataTable GetProjectUsersWithPrimary(int projectId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var iDict = new List&lt;Tuple&lt;int, int, bool&gt;&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectUsers&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    DataTable attributeDt = conn.DB.ExecuteDataSet(cmd).Tables[0];

                    return attributeDt;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Updates the user role for a user associated with the project
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;&lt;/param&gt;
        internal int UpdateUserRole(int projectId, int userId, int roleId, bool isPrimary)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateUserRole&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userId);
                    conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, roleId);
                    conn.DB.AddInParameter(cmd, &quot;in_IsPrimary&quot;, DbType.Int32, isPrimary);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deleting a user and his role from the project user table.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteUserRole(int projectId, int userId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteUserRole&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes a particular status based on the ID passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;statusId&quot;&gt;&lt;/param&gt;
        internal int DeleteStatus(int statusId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteStatus&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_StatusID&quot;, DbType.Int32, statusId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// This Method Creates a status in the ProjectStatus table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;statusName&quot;&gt;&lt;/param&gt;
        internal int CreateStatus(int StatusID, string statusName, bool ActivationStatus)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateStatus&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_StatusID&quot;, DbType.Int32, StatusID);
                    conn.DB.AddInParameter(cmd, &quot;in_StatusName&quot;, DbType.String, statusName);
                    conn.DB.AddInParameter(cmd, &quot;in_ActivationStatus&quot;, DbType.Boolean, ActivationStatus);
                    conn.DB.AddOutParameter(cmd, &quot;out_StatusID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_StatusID&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Deletes a particular attribute based on the ID passed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;attributeId&quot;&gt;&lt;/param&gt;
        internal int DeleteAttribute(int attributeId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteAttribute&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.Int32, attributeId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// This Method Creates an attribute in the MasterAttribute table
        ///  &lt;param name=&quot;attributeName&quot;&gt;&lt;/param&gt;
        ///  &lt;param name=&quot;attributeType&quot;&gt;&lt;/param&gt;
        internal int CreateAttribute(int attributeID, string attributeName, string attributeType, int? AttributeSize,
            bool Mandatory, bool Deactivated, string ModuleId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateAttribute&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.Int32, attributeID);
                    conn.DB.AddInParameter(cmd, &quot;in_AttributeName&quot;, DbType.String, attributeName);
                    conn.DB.AddInParameter(cmd, &quot;in_AttributeType&quot;, DbType.String, attributeType);
                    conn.DB.AddInParameter(cmd, &quot;in_AttributeSize&quot;, DbType.Int32, AttributeSize);
                    conn.DB.AddInParameter(cmd, &quot;in_Mandatory&quot;, DbType.Boolean, Mandatory);
                    conn.DB.AddInParameter(cmd, &quot;in_Deactivated&quot;, DbType.Boolean, Deactivated);
                    conn.DB.AddInParameter(cmd, &quot;in_ModuleId&quot;, DbType.String, ModuleId);
                    conn.DB.AddOutParameter(cmd, &quot;out_AttributeID&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_AttributeID&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// This checks whether an attribute is used in any project or not
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;attributeId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CheckAttribute(int attributeId, string ModuleId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTChkAttribInProjTmpl&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_AttributeID&quot;, DbType.Int32, attributeId);
                    conn.DB.AddInParameter(cmd, &quot;in_ModuleId&quot;, DbType.String, ModuleId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteScalar(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets project for tree
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataSet GetProjectForTree(int projectId, int userId, int roleId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjMod4Tree&quot;,
                        new object[] { projectId, userId, roleId });
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets Modules for MobileClient
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;userId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;roleId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataSet GetProjectForTreeOfflineClient(int projectId, int userId, int roleId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_CONTMGTGetContMod4Offline&quot;,
                        new object[] { projectId, userId, roleId });
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }


        /// &lt;summary&gt;
        /// Gets Projects for platform
        /// &lt;/summary&gt;
        internal DataTable GetProjectsforPlatform(string platformKey, int UID)
        {
            try
            {
                /* send UID =0 for all projects with all users OR
                 * UID &gt;0 for user specific projects*/

                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjMod4Platf&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_PlatformKey&quot;, DbType.String, platformKey);
                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, UID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets attributes saved in a template
        /// &lt;/summary&gt;
        internal Dictionary&lt;int, string&gt; GetSavedAttributes(int templateId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var savedattr = new Dictionary&lt;int, string&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetSavedAttributes&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateId);

                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        while (dr.Read()) //populate columns of dictionary from dataset
                            savedattr.Add(dr.GetInt32(0), dr.GetString(1));
                    }
                    return savedattr;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets all active attributes
        /// &lt;/summary&gt;
        internal Dictionary&lt;int, string&gt; GetActiveAttributes(int templateId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var activeattr = new Dictionary&lt;int, string&gt;();
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveAttributes&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_TemplateID&quot;, DbType.Int32, templateId);

                    using (IDataReader dr = conn.DB.ExecuteReader(cmd))
                    {
                        while (dr.Read()) //populate dictionary
                            activeattr.Add(dr.GetInt32(0), dr.GetString(1));
                    }
                    return activeattr;
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Manipulates a User&#39;s association with Projects
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;xmlData&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;Number of associations that threw a DB exception&lt;/returns&gt;
        internal int AddOrRemoveUserInProjects(string xmlData)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTAddDelUserInProj&quot;,
                        new object[] { xmlData, null });
                    //conn.DB.AddInParameter(cmd, &quot;InputXML&quot;, DbType.String, xmlData);
                    //conn.DB.AddOutParameter(cmd, &quot;OUTPUT&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;OUTPUT&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return -1;
            }
        }

        internal int AddOrRemoveUserInProjectsContract(string xmlData)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTContractAddDelUserInProj&quot;,
                        new object[] { xmlData, null });
                    //conn.DB.AddInParameter(cmd, &quot;InputXML&quot;, DbType.String, xmlData);
                    //conn.DB.AddOutParameter(cmd, &quot;OUTPUT&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);
                    return conn.DB.GetParameterValue(cmd, &quot;OUTPUT&quot;).ToString2().ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return -1;
            }
        }

        /// &lt;summary&gt;
        /// Gets All Projects Users
        /// &lt;/summary&gt;
        internal DataTable GetProjectUsersAll()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllProjectUsers&quot;);

                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        internal DataTable GetProjectsForUser(int userId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllProjectsforuser&quot;);
                    conn.DB.AddInParameter(cmd, &quot;userId&quot;, DbType.Int32, userId);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets recently viewed projects
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UserId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;RoleId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetRecentProjects(int UserId, int RoleId, string AXCompany)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetRecentProjects&quot;);

                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, UserId);
                    conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, RoleId);
                    conn.DB.AddInParameter(cmd, &quot;in_ERPCompany&quot;, DbType.String, AXCompany);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        /// &lt;summary&gt;
        /// Gets GPS projects
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetGPSProjects()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetGPSProjects&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        internal DataSet GetStdItemsTable(int stdTblID, object startRowIdx,
            object maxRows, string sortOrder, string filterSearch)
        {
            try
            {
                //if (ConnectorFacade.Instance.IsERPConnectorAttached)
                //{

                //    QueryStatus[] objERPOutput = ERPComponent.Instance.ExecuteERPTrigger(AMP3ObjectType.Library, MethodInfo.GetCurrentMethod(), null, null);

                //        DataSet ds = new BrixDataSet();
                //        DataTable dt1 =((DataTable) (objERPOutput[0].ERPDataSet.Tables[1])).Copy();
                //        DataTable dt2 = ((DataTable) (objERPOutput[0].ERPDataSet.Tables[0])).Copy();

                //        ds.Tables.Add(dt1);
                //        ds.Tables.Add(dt2);
                //        objERPOutput[0].ERPDataSet.Dispose();   


                //        return ds; 
                //    }

                //else
                //{
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@in_StandardTableID&quot;, DbType.Int32, stdTblID);
                    conn.DB.AddInParameter(cmd, &quot;@filterText&quot;, DbType.String,
                        (filterSearch != null &amp;&amp; startRowIdx != Type.Missing)
                            ? filterSearch
                            : &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@rowStartIdx&quot;, DbType.Int32,
                        (startRowIdx != null &amp;&amp; startRowIdx != Type.Missing) ? startRowIdx : 1);

                    if (startRowIdx != Type.Missing)
                        conn.DB.AddInParameter(cmd, &quot;@maxRowsInPage&quot;, DbType.Int32, maxRows);
                    else
                        conn.DB.AddInParameter(cmd, &quot;@maxRowsInPage&quot;, DbType.Int32, null);

                    conn.DB.AddInParameter(cmd, &quot;@sortOrder&quot;, DbType.String,
                        (sortOrder != null) ? sortOrder : &quot;upper(STANDARDITEMNO) ASC&quot;);
                    conn.DB.AddInParameter(cmd, &quot;@getCount&quot;, DbType.String, &quot;N&quot;);
                    //uncomment when working with oracle also
                    //amp3conn.DB.AddOutParameter(cmd, &quot;@ret_cur1&quot;, DbType.RefCur, null);
                    //amp3conn.DB.AddOutParameter(cmd, &quot;@ret_cur2&quot;, DbType.RefCur, null);
                    return conn.DB.ExecuteDataSet(cmd);
                    // }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, &quot;PROJECT&quot;);
                throw;
            }
        }

        internal int GetStdItemsCount(int stdTblID, string filterSearch)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    var arrObjParam = new object[6];
                    if (stdTblID != -1) arrObjParam[0] = stdTblID;
                    arrObjParam[1] = (filterSearch != null) ? filterSearch : &quot;&lt;XMLRoot&gt;&lt;/XMLRoot&gt;&quot;;
                    arrObjParam[5] = &quot;Y&quot;;

                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl&quot;, arrObjParam);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0].Rows[0][0].ToString2().Parse2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, &quot;PROJECT&quot;);
                throw;
            }
        }

        internal DataSet GetCIPReport(int ProjectID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;USP_PROJECTGETCIPREPORT&quot;, ProjectID);
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal DataSet GetProjectList4PDF(int IsActive)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                var o = new object[2];
                o[0] = IsActive;
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetProjectList&quot;, o);
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        /// &lt;summary&gt;
        /// Modified to allow filtering by role,permission
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UID&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;RID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataSet GetProjectListByStatus4PDF(int RID)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStatusReport&quot;);
                conn.DB.AddInParameter(cmd, &quot;in_RoleID&quot;, DbType.Int32, RID);
                conn.DB.AddInParameter(cmd, &quot;in_FeaturesCode&quot;, DbType.String, ProjectConstants.MODFEAT_VIEW);
                conn.DB.AddInParameter(cmd, &quot;in_ModuleID&quot;, DbType.String, ProjectConstants.MODID_PROJECT);
                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        internal int MapProjectInERP(string projectId, string projectGroup, string name, DateTime createdDate,
            DateTime startDate, DateTime endDate, int status)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_AX_PROJECTMapInERP&quot;);
                conn.DB.AddInParameter(cmd, &quot;ProjId&quot;, DbType.String, projectId);
                conn.DB.AddInParameter(cmd, &quot;ProjGroupId&quot;, DbType.String, projectGroup);
                conn.DB.AddInParameter(cmd, &quot;Name&quot;, DbType.String, name);
                conn.DB.AddInParameter(cmd, &quot;Type&quot;, DbType.Int32, 1);
                conn.DB.AddInParameter(cmd, &quot;Created&quot;, DbType.DateTime, createdDate);
                conn.DB.AddInParameter(cmd, &quot;StartDate&quot;, DbType.DateTime, startDate);
                conn.DB.AddInParameter(cmd, &quot;EndDate&quot;, DbType.DateTime, endDate);
                conn.DB.AddInParameter(cmd, &quot;Status&quot;, DbType.Int32, status);

                return conn.DB.ExecuteNonQuery(cmd);
            }
        }

        public DataSet GetData(string sp, object[] spParams, bool IsParentChild, string key)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = spParams != null
                        ? conn.DB.GetStoredProcCommand(sp, spParams)
                        : conn.DB.GetStoredProcCommand(sp);
                    DataSet ds = conn.DB.ExecuteDataSet(cmd);
                    ds.Tables[0].TableName = &quot;Parent&quot;;
                    if (ds.Tables[&quot;Parent&quot;].Columns.Contains(&quot;PE&quot;))
                        ds.Tables[&quot;Parent&quot;].Columns[&quot;PE&quot;].ColumnName =
                            LocalizationManager.GetString(KeyConstants.LOC_PAY_ESTIMATE);
                    if (ds.Tables[&quot;Parent&quot;].Columns.Contains(&quot;Pay Estimates&quot;))
                        ds.Tables[&quot;Parent&quot;].Columns[&quot;Pay Estimates&quot;].ColumnName =
                            LocalizationManager.GetString(KeyConstants.LOC_PAY_ESTIMATE);
                    if (IsParentChild)
                    {
                        ds.Tables[1].TableName = &quot;Child&quot;;
                        if (ds.Tables[&quot;Child&quot;].Columns.Contains(&quot;PE&quot;))
                            ds.Tables[&quot;Child&quot;].Columns[&quot;PE&quot;].ColumnName =
                                LocalizationManager.GetString(KeyConstants.LOC_PAY_ESTIMATE);
                        ds.Relations.Add(&quot;ParentChild&quot;, ds.Tables[0].Columns[key], ds.Tables[1].Columns[key]);
                    }
                    return ds;
                }
            }
            catch
            {
                return null;
            }
        }

        public DataSet GetWOData(string sp, object spParams)
        //This will fetch the details of Work Orders for a particular contract in Pending approvals webpart(Project level).
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CONTMGTGetWOList, null, spParams);
            }
            catch
            {
                return null;
            }
        }

        public DataSet GetWorkOrderData(string sp, object[] spParams)
        //This will fetch the details of Work Orders for a particular contract in Pending approvals webpart(Enterprise level).
        {
            try
            {
                return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_CONTMGTGetWorkOrderList, null,
                    spParams);
            }
            catch
            {
                return null;
            }
        }

        internal DataSet GetProjectSubmittals(int pid)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_SUBMTALGetRegister&quot;);
                conn.DB.AddInParameter(cmd, &quot;ProjectID&quot;, DbType.Int32, pid);
                conn.DB.AddInParameter(cmd, &quot;ModuleCategory&quot;, DbType.String, &quot;PROJECT&quot;);
                conn.DB.AddInParameter(cmd, &quot;ModuleLinkID&quot;, DbType.Int32, -1);
                conn.DB.AddInParameter(cmd, &quot;FilterText&quot;, DbType.String, &quot;&lt;XMLRoot&gt;&lt;Status&gt;P&lt;/Status&gt;&lt;/XMLRoot&gt;&quot;);
                conn.DB.AddInParameter(cmd, &quot;GetCount&quot;, DbType.String, &quot;N&quot;);

                return conn.DB.ExecuteDataSet(cmd);
            }
        }

        //TODO: Need to fix this function with new changes
        //(hiding Budget estimate link from project tree)
        public void GetProjectLevelXmlForms(TNode tree, DataTable dtModuleList, int pid, int parentId)
        {
            dtModuleList.DefaultView.Sort = &quot;ModuleType,Folder&quot;;
            TNode parentNode = tree;
            foreach (DataRow dr in dtModuleList.Rows)
            {
                if (!(dr[&quot;ModuleID&quot;].ToString() == Constants.MODID_CONTMGT ||
                      dr[&quot;ModuleID&quot;].ToString() == Constants.MODID_ESTMATE ||
                      dr[&quot;ModuleID&quot;].ToString() == &quot;BDGMGMT&quot; ||
                      dr[&quot;ModuleID&quot;].ToString() == Constants.MODID_LANDMGT || dr[&quot;ModuleID&quot;].ToString() == &quot;SUBMTAL&quot; ||
                      dr[&quot;ModuleID&quot;].ToString() == &quot;CHKPRJL&quot;))
                {
                    if (dtModuleList.Columns.Contains(&quot;IsSingleInstance&quot;) &amp;&amp; !dr.IsNull(&quot;IsSingleInstance&quot;) &amp;&amp; dr[&quot;IsSingleInstance&quot;].ToBoolean2())
                    {
                        parentNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                          dr[&quot;InstanceUrl&quot;].ToString() + &quot;?context=&quot; + dr[&quot;ModuleID&quot;]);
                    }
                    else
                    {
                        parentNode.AddPositionedNode(dr[&quot;ParentFolderPath&quot;].ToString(), dr[&quot;ModuleName&quot;].ToString(),
                       &quot;~/Common/BrixListPage.aspx?xContext=&quot; + dr[&quot;ModuleID&quot;] + &quot;&amp;PID=&quot; + pid + &quot;&amp;ParentID=&quot; + pid);
                    }
                }
            }
        }

        #region Measurement Systems

        /// &lt;summary&gt;
        /// Gets all measurement systems 
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetMeasurementSystems(string strAdditionalInfo)
        {
            try
            {
                var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);
                var connectorParameter = new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(),
                    AMP3ObjectType.Unknown, null, null);
                int count = 0;
                DataSet ds = new BrixDataSet();
                if (IntegrationConnectorManager.HandleIntegration(connectorParameter, ref count, ref ds, true))
                {
                    return ds.Tables[0];
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllMeasureSys&quot;);
                        return conn.DB.ExecuteDataSet(cmd).Tables[0];
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Gets a measurement system details
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;systemId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetMeasurementSystem(int systemId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetMeasureSystem&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_SystemID&quot;, DbType.Int32, systemId);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Creates a measurement system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;msDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CreateMeasurementSystem(MeasurementSystem msDTO)
        {
            int systemId;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateMeasureSys&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_SystemName&quot;, DbType.String, msDTO.SystemName);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, msDTO.Description);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        systemId = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (systemId &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return systemId;
        }

        /// &lt;summary&gt;
        /// Updates a measurement system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;msDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int UpdateMeasurementSystem(MeasurementSystem msDTO)
        {
            int systemId;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateMeasureSystem&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_SystemID&quot;, DbType.Int32, msDTO.SystemId);
                        conn.DB.AddInParameter(cmd, &quot;in_SystemName&quot;, DbType.String, msDTO.SystemName);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, msDTO.Description);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        systemId = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (systemId &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return systemId;
        }

        /// &lt;summary&gt;
        /// Deletes the measurement system and also the units associated with it.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;systemId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteMeasurementSystem(int systemId)
        {
            int result;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelMeasureSys&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_SystemId&quot;, DbType.Int32, systemId);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        result = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (result &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw new Exception(&quot;System is being used by a module. Deletion failed.&quot;);
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return result;
        }

        #endregion

        #region LIBRARY Contract Type

        internal DataTable GetLIBRARYContractType()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;[usp_LIBRARYGetContractType]&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        #endregion

        #region Measurement Units

        /// &lt;summary&gt;
        /// Gets all measurement units
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetMeasurementUnits()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllMeasureUnits&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        public DataTable GetMeasurementUnitsForImportItems(string moduleID, int parentInstanceID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetMeasurementUnitsForImportItems&quot;);
                    conn.DB.AddInParameter(cmd, &quot;ModuleID&quot;, DbType.String, moduleID);
                    conn.DB.AddInParameter(cmd, &quot;ParentInstanceID&quot;, DbType.Int32, parentInstanceID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }


        /// &lt;summary&gt;
        /// Gets  measurement units for a system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;systemId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public DataTable GetMeasurementUnitsForSystem(string strAdditionalInfo, int systemId)
        {
            try
            {
                var additionalInfo = new EISAdditionalInfo(RegisteredEIS.AX);
                additionalInfo.AddInfo(Constants.EIS_ADDITIONAL_INFO, strAdditionalInfo);
                var dictAdditionalInfo = new Dictionary&lt;RegisteredEIS, EISAdditionalInfo&gt;();
                dictAdditionalInfo.Add(RegisteredEIS.AX, additionalInfo);
                var connectorParameter = new ConnectorParameters(dictAdditionalInfo, MethodBase.GetCurrentMethod(),
                    AMP3ObjectType.Unknown, null, null);
                int count = 0;
                DataSet ds = new BrixDataSet();
                if (IntegrationConnectorManager.HandleIntegration(connectorParameter, ref count, ref ds, true))
                {
                    return ds.Tables[1];
                }
                else
                {
                    using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetMeasureUnit4Sys&quot;);
                        conn.DB.AddInParameter(cmd, &quot;in_SystemID&quot;, DbType.Int32, systemId);
                        return conn.DB.ExecuteDataSet(cmd).Tables[0];
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Creates a measurement unit for a system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;muDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CreateMeasurementUnit(MeasurementUnit muDTO)
        {
            int unitId;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateMeasureUnit&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_Unit&quot;, DbType.String, muDTO.Unit);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, muDTO.Description);
                        conn.DB.AddInParameter(cmd, &quot;in_Type&quot;, DbType.String, muDTO.Type);
                        conn.DB.AddInParameter(cmd, &quot;in_Prorated&quot;, DbType.String, muDTO.Prorated);
                        conn.DB.AddInParameter(cmd, &quot;in_SystemId&quot;, DbType.Int32, muDTO.SystemId);

                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        unitId = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (unitId &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return unitId;
        }

        /// &lt;summary&gt;
        /// Updates a measurement unit for a system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;muDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int UpdateMeasurementUnit(MeasurementUnit muDTO)
        {
            int unitId;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateMeasurementUnit&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_UnitID&quot;, DbType.Int32, muDTO.UnitId);
                        conn.DB.AddInParameter(cmd, &quot;in_Unit&quot;, DbType.String, muDTO.Unit);
                        conn.DB.AddInParameter(cmd, &quot;in_Description&quot;, DbType.String, muDTO.Description);
                        conn.DB.AddInParameter(cmd, &quot;in_Type&quot;, DbType.String, muDTO.Type);
                        conn.DB.AddInParameter(cmd, &quot;in_Prorated&quot;, DbType.String, muDTO.Prorated);
                        conn.DB.AddInParameter(cmd, &quot;in_SystemID&quot;, DbType.Int32, muDTO.SystemId);

                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        unitId = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (unitId &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return unitId;
        }

        /// &lt;summary&gt;
        /// Deletes the measurement units
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;unitId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteMeasurementUnit(int unitId)
        {
            int result;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDelMeasureUnit&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_UnitId&quot;, DbType.Int32, unitId);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        result = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (result &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw new Exception(&quot;Unit is being used by a module. Deletion failed.&quot;);
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return result;
        }

        #endregion

        #region Standard Tables

        /// &lt;summary&gt;
        /// Gets all Standard Tables
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetStandardTables()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl&quot;);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        internal DataSet GetStandardTableDetails(int standardTableID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdTableData&quot;);
                    conn.DB.AddInParameter(cmd, &quot;StandardTableID&quot;, DbType.Int32, standardTableID);
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Gets a Standard Table details
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetStandardTable(int standardTableID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStandardTable&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, standardTableID);
                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Creates a Standard Table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int CreateStandardTable(StandardTable stDTO)
        {
            int standardTableID;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTCreateStandardTable&quot;);
                        conn.DB.AddInParameter(cmd, &quot;StandardTableID&quot;, DbType.Int32, stDTO.StandardTableId);
                        conn.DB.AddInParameter(cmd, &quot;StandardTableName&quot;, DbType.String, stDTO.StandardTableName);
                        conn.DB.AddInParameter(cmd, &quot;MeasurementSystemID&quot;, DbType.Int32, stDTO.MeasurementSystemID);
                        conn.DB.AddOutParameter(cmd, &quot;OUTPUT&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        standardTableID = conn.DB.GetParameterValue(cmd, &quot;OUTPUT&quot;).ToInt32_2();
                        if (standardTableID &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return standardTableID;
        }

        /// &lt;summary&gt;
        /// Updates a Standard Table
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stDTO&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int UpdateStandardTable(StandardTable stDTO)
        {
            int standardTableID;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTUpdateStandardTable&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, stDTO.StandardTableId);
                        conn.DB.AddInParameter(cmd, &quot;in_StandardTableName&quot;, DbType.String, stDTO.StandardTableName);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        standardTableID = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (standardTableID &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return standardTableID;
        }

        /// &lt;summary&gt;
        /// Deletes the Standard Table and also the items associated with it.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal int DeleteStandardTable(int standardTableID)
        {
            int result;
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbConnection dbconn = conn.DB.CreateConnection();
                    dbconn.Open();
                    DbTransaction tran = dbconn.BeginTransaction();

                    try
                    {
                        DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteStandardTable&quot;);

                        conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, standardTableID);
                        conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                        conn.DB.ExecuteNonQuery(cmd, tran);

                        result = conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                        if (result &gt; 0)
                            tran.Commit();
                        else
                            tran.Rollback();
                    }
                    catch (Exception ex)
                    {
                        tran.Rollback();
                        Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                        throw;
                    }
                    finally
                    {
                        dbconn.Close();
                        dbconn.Dispose();
                    }
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }

            return result;
        }

        #endregion

        #region Standard Items

        /// &lt;summary&gt;
        /// Gets all Standard Items
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetStandardItems()
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetAllStandardItems&quot;);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        /// &lt;summary&gt;
        /// Gets  Standard Items for a system
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;standardTableID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetStandardItemsForStandardTable(int standardTableID)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetStdItems4StdTbl3&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_StandardTableID&quot;, DbType.Int32, standardTableID);

                    return conn.DB.ExecuteDataSet(cmd).Tables[0];
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                return null;
            }
        }

        #endregion

        internal DataTable GetProjectModes()
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectModes, null);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        internal DataTable CheckIdDocsExists(int projectId)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetDocumentCount, null,
                projectId);
            if (ds.Tables.Count &gt; 0)
                return ds.Tables[0];
            else
                return null;
        }

        public int GetAllProjectCount()
        {
            return
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTGetAllProjectCount, null).ToInt32_2();
        }

        public DataTable GetActiveProjectsForPicker(string ErpCompany, int CurrentUserID, int RoleId, int SelectedUserID,
            string SortBy, int startIndex, int endIndex, out int totalCount, string Filter)
        {
            using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
            {
                DataSet ds;
                DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetActiveProjectsForPicker&quot;);
                conn.DB.AddInParameter(cmd, &quot;ERPCompany&quot;, DbType.String, ErpCompany);
                conn.DB.AddInParameter(cmd, &quot;currentUserID&quot;, DbType.Int32, CurrentUserID);
                conn.DB.AddInParameter(cmd, &quot;currentRoleID&quot;, DbType.Int32, RoleId);
                conn.DB.AddInParameter(cmd, &quot;selectedUserID&quot;, DbType.Int32, SelectedUserID);
                conn.DB.AddInParameter(cmd, &quot;startIndex&quot;, DbType.Int32, startIndex);
                conn.DB.AddInParameter(cmd, &quot;endIndex&quot;, DbType.Int32, endIndex);
                conn.DB.AddInParameter(cmd, &quot;SortColumn&quot;, DbType.String, SortBy);
                conn.DB.AddInParameter(cmd, &quot;FilterQuery&quot;, DbType.String, Filter);
                conn.DB.AddOutParameter(cmd, &quot;TotalRowsCount&quot;, DbType.Int32, 4);
                try
                {
                    ds = conn.DB.ExecuteDataSet(cmd);
                    totalCount = conn.DB.GetParameterValue(cmd, &quot;TotalRowsCount&quot;).ToInt32_2();
                    return ds.Tables[0];
                }
                catch (Exception)
                {
                }
                totalCount = conn.DB.GetParameterValue(cmd, &quot;TotalRowsCount&quot;).ToInt32_2();
                return null;
            }
        }

        public DataSet GetProjectTreeForMobile(int projectId, int userId, int roleId)
        {
            try
            {
                if (ModuleManager.Instance.IsEffectivePermissionOfRoles())
                    roleId = 0;

                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTGetTreeForMobile&quot;,
                        new object[] { projectId, userId, roleId });
                    return conn.DB.ExecuteDataSet(cmd);
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        public DataSet GetProjectsForMobileSync(int lastUserCount)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectsForMobileSync, null,
                lastUserCount);
        }

        public DataSet GetProjectUserRoles(int projectId, int userId)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetProjectUserRoles, null,
                projectId, userId);
        }

        public object CheckIfPlannedProject(string ProjectId)
        {
            return
                ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PLANINGCheckIfPlannedProject, null, ProjectId);
        }

        /// &lt;summary&gt;
        /// To Validate businessUnits when we add Project to Users
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;UserId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;ProjectIds&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool PROJECTValidateInvalidProjectToUsers(string ProjectIds, out string projectCodeCSV)
        {
            bool flag = true;

            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(BusinessUnitStoredProcedures.PROJECTValidateInvalidProjectToUsers, null, ProjectIds);

            projectCodeCSV = string.Empty;

            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
            {
                if (ds.Tables[0].Rows.Count &gt; 0)
                {
                    flag = false;
                    List&lt;string&gt; projectCodeList = new List&lt;string&gt;();

                    foreach (DataRow dr in ds.Tables[0].Rows)
                    {
                        projectCodeList.Add(dr[&quot;ProjectCode&quot;].ToString());
                    }
                    projectCodeCSV = string.Join(&quot;,&quot;, projectCodeList);
                }
            }
            return flag;
        }

        public object UpdateProjectDates(int ProjectId, DateTime StartDate, DateTime EndDate)
        {
            return ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTUpdateProjectDates, null, ProjectId, StartDate, EndDate);
        }

        public void UpdateIsPublishFlag(int projectID, bool isPublished)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_PROJECTUpdateIsPublishFlag, null, projectID, isPublished);
        }

        public object CopyCalendarFromLibrary(int ProjectId, int CalendarId, string ModifiedBy)
        {
            return ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTUpdateCalendar, null, ProjectId, CalendarId, ModifiedBy, 0);
        }

        public object CopyCalendarFromLibraryToProject(int ProjectId, int CalendarId, string ModifiedBy)
        {
            return ComponentHelper.Instance.ExecuteScalar(StoredProcedure.usp_PROJECTUpdateProjectCalendar, null, ProjectId, CalendarId, ModifiedBy, 0);
        }

        public void UnmarkLatestCalendar(int ProjectID)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_PROJECTUpdateLatestCalendar, null, ProjectID);
        }

        /// &lt;summary&gt;
        /// Gets the details of the Program to which this project is added
        /// This method will/should be called only when planning module exists
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;projectID&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        internal DataTable GetProgramDetailsForProject(int projectID)
        {
            DataSet ds = ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PLANINGGetProgramDetailsForProject, null, projectID);

            if (ds != null &amp;&amp; ds.Tables.Count &gt; 0)
                return ds.Tables[0];

            return null;
        }

        internal void UpdateProjectWorkingDays(int projectID, int workingDays)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_PROJECTUpdateProjectWorkingDays, null, projectID, workingDays);
        }

        internal DataTable GetContractDetailsForProjectUsers(int projectID, int userID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_GetContractorDetailsForProjectUser, null, projectID, userID).Tables[0];
        }

        internal void UpdateProjectContractorRoles(int projectID, int modifiedBy, string xmlData)
        {
            ComponentHelper.Instance.ExecuteNonQueryWithVariableParameters(StoredProcedure.usp_UpdateProjectUserContractorRoles, null, projectID, modifiedBy, xmlData);
        }

        internal int DeleteUserContractorRole(int projectId, int userId)
        {
            try
            {
                using (var conn = new ConnHolder(ConnectionHelper.GetConnectionString()))
                {
                    DbCommand cmd = conn.DB.GetStoredProcCommand(&quot;usp_PROJECTDeleteUserAndContractorRole&quot;);
                    conn.DB.AddInParameter(cmd, &quot;in_ProjectID&quot;, DbType.Int32, projectId);
                    conn.DB.AddInParameter(cmd, &quot;in_UserID&quot;, DbType.Int32, userId);
                    conn.DB.AddOutParameter(cmd, &quot;out_Result&quot;, DbType.Int32, 4);
                    conn.DB.ExecuteNonQuery(cmd);

                    return conn.DB.GetParameterValue(cmd, &quot;out_Result&quot;).ToInt32_2();
                }
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_PROJECT);
                throw;
            }
        }

        internal DataSet GetCalendarDetails(int projectID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetCalendarDetails, null, projectID);
        }

        internal DataSet GetForecastCalendarDetails(int projectID)
        {
            return ComponentHelper.Instance.ExecuteDataSet(StoredProcedure.usp_PROJECTGetForecastCalendarDetails, null, projectID);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[30,9,30,35,1],[31,9,31,10,1],[32,9,32,10,1],[38,9,38,10,0],[39,13,39,48,0],[40,9,40,10,0],[46,9,46,10,0],[47,20,47,85,0],[48,13,48,14,0],[49,17,49,88,0],[50,17,50,86,0],[51,17,51,80,0],[52,17,52,80,0],[53,17,53,62,0],[55,9,55,10,0],[61,9,61,10,0],[62,20,62,85,0],[63,13,63,14,0],[64,17,64,106,0],[65,17,65,86,0],[66,17,66,80,0],[67,17,67,80,0],[68,17,68,62,0],[70,9,70,10,0],[78,9,78,10,0],[79,20,79,85,0],[80,13,80,14,0],[81,17,81,94,0],[82,17,82,86,0],[83,17,83,62,0],[85,9,85,10,0],[93,9,93,10,1],[95,13,95,53,1],[96,13,96,42,1],[98,13,98,48,1],[99,13,99,14,1],[100,17,100,104,1],[102,17,102,52,1],[102,52,102,80,0],[102,80,102,82,1],[102,17,102,82,1],[103,21,103,46,0],[105,17,105,61,1],[105,61,105,108,1],[105,108,105,110,1],[105,17,105,110,1],[106,13,106,14,1],[108,20,108,85,1],[109,13,109,14,1],[110,17,110,109,1],[112,17,112,94,1],[113,17,113,87,1],[118,17,118,88,1],[119,17,119,92,1],[121,17,121,62,1],[122,21,122,95,0],[124,17,124,109,1],[125,17,125,77,1],[127,17,127,87,1],[128,21,128,147,1],[130,17,130,58,1],[131,17,131,87,1],[132,17,132,37,1],[134,9,134,10,1],[142,9,142,10,0],[143,20,143,85,0],[144,13,144,14,0],[145,17,145,99,0],[146,17,146,86,0],[147,17,147,91,0],[148,17,148,84,0],[149,17,149,93,0],[150,17,150,72,0],[151,17,151,62,0],[153,9,153,10,0],[172,9,172,10,0],[174,13,174,14,0],[175,24,175,89,0],[176,17,176,18,0],[177,21,177,100,0],[179,21,179,84,0],[180,21,180,84,0],[181,21,181,101,0],[182,21,182,93,0],[184,21,184,92,0],[185,25,185,100,0],[187,25,187,109,0],[189,21,189,76,0],[190,25,190,95,0],[192,25,192,85,0],[194,21,194,72,0],[195,25,195,93,0],[197,25,197,88,0],[199,21,199,43,0],[200,25,200,96,0],[202,25,202,118,0],[204,21,204,96,0],[206,21,206,43,0],[207,25,207,97,0],[208,21,208,97,0],[209,21,209,131,0],[211,21,211,76,0],[213,21,213,62,0],[214,21,214,81,0],[216,21,216,66,0],[219,13,219,33,0],[220,13,220,14,0],[221,17,221,93,0],[222,17,222,23,0],[224,9,224,10,0],[245,9,245,10,1],[247,13,247,14,1],[248,24,248,89,1],[249,17,249,18,1],[250,21,250,100,1],[252,21,252,84,1],[253,21,253,84,1],[254,21,254,101,1],[255,21,255,93,1],[256,21,256,96,1],[258,21,258,76,1],[259,25,259,95,1],[261,25,261,85,0],[263,21,263,72,1],[264,25,264,93,1],[266,25,266,88,0],[268,21,268,43,1],[269,25,269,96,1],[271,25,271,118,0],[273,21,273,96,1],[275,21,275,43,1],[276,25,276,97,1],[278,21,278,103,1],[279,21,279,97,1],[280,21,280,131,1],[282,21,282,76,1],[284,21,284,62,1],[285,21,285,81,1],[287,21,287,41,1],[290,13,290,33,0],[291,13,291,14,0],[292,17,292,93,0],[293,17,293,23,0],[295,9,295,10,1],[301,9,301,10,0],[302,20,302,85,0],[303,13,303,14,0],[304,17,304,95,0],[305,17,305,54,0],[306,21,306,86,0],[307,17,307,77,0],[308,17,308,77,0],[309,17,309,62,0],[311,9,311,10,0],[317,9,317,10,0],[318,20,318,85,0],[319,13,319,14,0],[320,17,320,88,0],[321,17,321,54,0],[322,21,322,86,0],[323,17,323,77,0],[324,17,324,77,0],[325,17,325,62,0],[327,9,327,10,0],[333,9,333,10,0],[334,20,334,85,0],[335,13,335,14,0],[336,17,336,94,0],[337,17,337,54,0],[338,21,338,86,0],[339,17,339,77,0],[340,17,340,77,0],[341,17,341,62,0],[343,9,343,10,0],[349,9,349,10,0],[350,20,350,85,0],[351,13,351,14,0],[352,17,352,89,0],[353,17,353,62,0],[355,9,355,10,0],[362,9,362,10,0],[364,13,364,14,0],[365,24,365,89,0],[366,17,366,18,0],[367,21,367,66,0],[368,21,368,95,0],[370,21,370,90,0],[371,21,371,81,0],[373,21,373,83,0],[375,21,375,52,0],[376,21,376,22,0],[377,25,377,32,0],[377,34,377,44,0],[377,45,377,47,0],[377,48,377,64,0],[378,25,378,26,0],[379,29,379,106,0],[380,25,380,26,0],[381,21,381,22,0],[382,21,382,34,0],[385,13,385,33,0],[386,13,386,14,0],[387,17,387,93,0],[388,17,388,23,0],[390,9,390,10,0],[397,9,397,10,1],[398,20,398,85,1],[399,13,399,14,1],[400,17,400,91,1],[401,17,401,85,1],[402,17,402,62,1],[404,9,404,10,1],[410,9,410,10,0],[411,13,413,31,0],[414,9,414,10,0],[420,9,420,10,0],[421,13,423,31,0],[424,9,424,10,0],[434,9,434,10,1],[435,13,435,71,1],[436,13,436,95,1],[440,13,440,14,1],[441,24,441,89,1],[442,17,442,18,1],[443,21,443,70,1],[444,21,444,35,1],[445,21,445,68,1],[448,21,448,22,1],[449,25,449,98,1],[451,25,451,110,1],[452,25,452,110,1],[453,25,453,117,1],[454,25,454,118,1],[455,25,455,105,1],[456,25,456,115,1],[457,25,457,111,1],[458,25,458,108,1],[459,25,459,112,1],[460,25,460,114,1],[461,25,461,88,1],[462,25,462,88,1],[463,25,463,109,1],[464,25,464,114,1],[465,25,465,110,1],[466,25,466,116,1],[468,25,468,123,1],[470,25,470,110,1],[471,25,471,119,1],[472,25,472,110,1],[473,25,473,113,1],[474,25,475,60,1],[476,25,476,112,1],[477,25,477,112,1],[478,25,478,112,1],[479,25,479,88,1],[480,25,480,115,1],[481,25,481,108,1],[482,25,482,60,1],[484,25,484,97,1],[485,25,485,43,1],[486,25,486,26,1],[487,29,487,59,1],[488,29,488,30,1],[489,33,489,40,1],[489,42,489,78,1],[489,79,489,81,1],[489,82,489,99,1],[490,33,490,34,1],[491,37,491,100,1],[493,37,493,106,1],[494,37,495,68,1],[496,37,499,78,1],[500,37,501,71,1],[502,37,503,64,1],[504,37,504,97,1],[505,37,505,72,1],[506,33,506,34,1],[507,29,507,30,1],[509,29,509,56,1],[510,29,510,30,1],[511,33,511,40,1],[511,42,511,61,1],[511,62,511,64,1],[511,65,511,79,1],[512,33,512,34,1],[513,37,513,97,1],[515,37,515,106,1],[516,37,516,116,1],[517,37,517,122,1],[518,37,518,97,1],[519,37,519,72,1],[520,33,520,34,1],[521,29,521,30,1],[523,29,523,43,1],[525,29,525,68,1],[526,33,526,96,1],[528,33,528,99,0],[561,25,561,26,1],[563,25,563,26,0],[564,29,564,45,0],[565,25,565,26,0],[566,21,566,22,1],[567,21,567,41,0],[568,21,568,22,0],[569,25,569,41,0],[570,25,570,101,0],[571,25,571,34,0],[574,21,574,22,1],[575,25,575,40,1],[576,25,576,42,1],[577,21,577,22,1],[578,17,578,18,1],[579,13,579,14,1],[580,13,580,33,0],[581,13,581,14,0],[582,17,582,93,0],[583,17,583,26,0],[586,13,586,30,1],[587,9,587,10,1],[594,9,594,10,0],[595,13,595,92,0],[596,13,596,74,0],[600,13,600,14,0],[601,24,601,89,0],[602,17,602,18,0],[603,21,603,70,0],[604,21,604,35,0],[605,21,605,68,0],[608,21,608,22,0],[609,25,609,99,0],[610,25,610,105,0],[611,25,611,107,0],[613,25,613,89,0],[614,25,614,60,0],[616,25,616,99,0],[618,25,618,44,0],[619,25,619,26,0],[620,29,620,36,0],[620,38,620,55,0],[620,56,620,58,0],[620,59,620,77,0],[621,29,621,30,0],[622,33,622,100,0],[623,33,623,104,0],[624,33,624,113,0],[625,33,625,93,0],[626,33,626,68,0],[627,29,627,30,0],[628,34,628,43,0],[628,45,628,70,0],[628,72,628,75,0],[629,29,629,30,0],[630,33,630,101,0],[631,33,631,104,0],[632,33,632,120,0],[633,33,634,69,0],[635,33,635,93,0],[636,33,636,68,0],[637,29,637,30,0],[638,29,638,43,0],[639,25,639,26,0],[641,25,641,26,0],[642,29,642,45,0],[643,25,643,26,0],[644,21,644,22,0],[645,21,645,41,0],[646,21,646,22,0],[647,25,647,41,0],[648,25,648,101,0],[649,25,649,31,0],[652,21,652,22,0],[653,25,653,40,0],[654,25,654,42,0],[655,21,655,22,0],[656,17,656,18,0],[657,13,657,14,0],[658,13,658,33,0],[659,13,659,14,0],[660,17,660,93,0],[661,17,661,23,0],[664,13,664,31,0],[665,9,665,10,0],[675,9,675,10,1],[676,13,676,71,1],[677,13,677,95,1],[681,13,681,14,1],[682,24,682,89,1],[683,17,683,18,1],[684,21,684,70,1],[685,21,685,35,1],[686,21,686,68,1],[689,21,689,22,1],[690,25,690,98,1],[692,25,692,110,1],[693,25,693,110,1],[694,25,694,117,1],[695,25,695,118,1],[696,25,696,105,1],[697,25,697,115,1],[698,25,698,111,1],[699,25,699,108,1],[700,25,700,120,1],[701,25,701,114,1],[702,25,702,105,1],[703,25,703,88,1],[704,25,704,88,1],[705,25,705,109,1],[706,25,706,110,1],[707,25,707,114,1],[708,25,708,110,1],[709,25,709,116,1],[710,25,710,123,1],[711,25,711,119,1],[712,25,712,110,1],[713,25,713,108,1],[714,25,714,110,1],[715,25,715,113,1],[716,25,716,123,1],[717,25,717,112,1],[718,25,718,112,1],[719,25,719,112,1],[720,25,720,87,1],[721,25,721,115,1],[723,25,723,60,1],[725,25,725,95,1],[727,25,727,42,1],[728,25,728,26,1],[729,29,729,96,1],[730,29,730,109,1],[731,29,731,89,1],[732,29,732,64,1],[734,29,734,36,1],[734,38,734,74,1],[734,75,734,77,1],[734,78,734,95,1],[735,29,735,30,1],[736,33,736,96,1],[737,33,737,113,1],[738,33,738,121,1],[739,33,740,67,1],[741,33,742,67,1],[743,33,744,64,1],[745,33,745,93,1],[746,33,746,68,1],[747,33,747,101,1],[748,29,748,30,1],[750,29,750,93,1],[751,29,751,109,1],[752,29,752,89,1],[753,29,753,64,1],[756,29,756,36,1],[756,38,756,57,1],[756,58,756,60,1],[756,61,756,75,1],[757,29,757,30,1],[758,33,758,93,1],[759,33,759,113,1],[760,33,760,112,1],[761,33,761,118,1],[762,33,762,93,1],[763,33,763,68,1],[764,33,764,101,1],[765,29,765,30,1],[766,29,766,43,1],[768,29,768,68,1],[769,33,769,96,1],[771,33,771,99,0],[772,25,772,26,1],[774,25,774,26,0],[775,29,775,45,0],[776,25,776,26,0],[777,21,777,22,1],[778,21,778,41,0],[779,21,779,22,0],[780,25,780,41,0],[781,25,781,101,0],[782,25,782,31,0],[785,21,785,22,1],[786,25,786,40,1],[787,25,787,42,1],[788,21,788,22,1],[789,17,789,18,1],[790,13,790,14,1],[791,13,791,33,0],[792,13,792,14,0],[793,17,793,93,0],[794,17,794,23,0],[797,13,797,29,1],[798,9,798,10,1],[805,9,805,10,0],[806,13,806,74,0],[807,13,807,92,0],[811,13,811,14,0],[812,24,812,89,0],[813,17,813,18,0],[814,21,814,70,0],[815,21,815,35,0],[816,21,816,68,0],[819,21,819,22,0],[820,25,820,99,0],[821,25,821,104,0],[822,25,822,105,0],[823,25,823,107,0],[824,25,824,85,0],[825,25,825,60,0],[826,25,826,93,0],[828,25,828,42,0],[829,25,829,26,0],[830,29,830,96,0],[831,29,831,108,0],[832,29,832,89,0],[833,29,833,64,0],[835,29,835,36,0],[835,38,835,55,0],[835,56,835,58,0],[835,59,835,77,0],[836,29,836,30,0],[837,33,837,100,0],[838,33,838,112,0],[839,33,839,113,0],[840,33,840,93,0],[841,33,841,68,0],[842,33,842,101,0],[843,29,843,30,0],[845,29,845,93,0],[846,29,846,108,0],[847,29,847,89,0],[848,29,848,64,0],[850,34,850,43,0],[850,45,850,70,0],[850,72,850,75,0],[851,29,851,30,0],[852,33,852,101,0],[853,33,853,112,0],[854,33,854,120,0],[855,33,856,69,0],[857,33,857,93,0],[858,33,858,68,0],[860,33,860,101,0],[861,29,861,30,0],[862,29,862,43,0],[863,25,863,26,0],[865,25,865,26,0],[866,29,866,45,0],[867,29,867,45,0],[868,25,868,26,0],[869,21,869,22,0],[870,21,870,41,0],[871,21,871,22,0],[872,25,872,41,0],[873,25,873,101,0],[874,25,874,31,0],[877,21,877,22,0],[878,25,878,40,0],[879,25,879,42,0],[880,21,880,22,0],[881,17,881,18,0],[882,13,882,14,0],[883,13,883,33,0],[884,13,884,14,0],[885,17,885,93,0],[886,17,886,23,0],[888,13,888,29,0],[889,9,889,10,0],[897,9,897,10,1],[898,13,898,61,1],[900,13,900,14,1],[901,24,901,89,1],[902,17,902,18,1],[903,21,903,95,1],[904,21,904,87,1],[905,21,905,87,1],[906,21,906,86,1],[907,21,907,50,1],[908,21,909,86,1],[910,17,910,18,1],[911,13,911,14,1],[912,13,912,33,0],[913,13,913,14,0],[914,17,914,93,0],[915,17,915,23,0],[917,13,917,40,1],[918,9,918,10,1],[921,9,921,10,1],[922,13,922,50,1],[923,13,923,14,1],[924,17,924,31,1],[925,17,928,32,1],[929,17,929,31,1],[930,21,930,34,0],[931,13,931,14,1],[932,13,932,25,1],[933,9,933,10,1],[941,9,941,10,1],[942,13,942,44,1],[944,13,944,14,1],[945,24,945,89,1],[946,17,946,18,1],[947,21,947,40,1],[948,21,949,65,1],[953,21,953,85,1],[954,21,954,80,1],[955,21,955,63,1],[957,21,957,50,1],[958,21,958,22,1],[959,25,959,59,1],[960,25,960,82,1],[961,25,961,79,1],[962,25,962,83,1],[963,25,963,83,1],[964,25,964,83,1],[965,25,965,90,1],[966,25,967,59,1],[968,25,968,78,1],[969,25,970,59,1],[971,25,972,59,1],[973,25,973,82,1],[974,25,974,88,1],[975,25,975,97,1],[976,25,976,100,1],[977,25,977,97,1],[978,25,978,83,1],[980,25,980,79,1],[981,25,981,26,1],[982,29,982,101,1],[983,29,983,100,1],[984,25,984,26,1],[985,25,985,74,1],[986,25,986,26,0],[987,29,987,96,0],[988,29,988,100,0],[989,25,989,26,0],[990,25,991,59,1],[992,25,992,70,1],[993,29,993,84,0],[995,25,995,72,1],[996,29,996,87,1],[998,25,998,73,1],[999,29,999,89,1],[1002,25,1002,76,1],[1003,29,1003,96,1],[1005,25,1005,73,1],[1006,29,1006,98,1],[1008,25,1008,77,1],[1009,29,1009,99,1],[1011,25,1011,73,1],[1012,29,1012,89,1],[1014,25,1014,73,1],[1015,29,1015,89,1],[1017,25,1017,71,1],[1018,29,1018,87,0],[1020,25,1020,130,1],[1021,25,1021,26,0],[1022,29,1022,62,0],[1023,29,1023,73,0],[1024,25,1024,26,0],[1026,25,1026,26,1],[1027,29,1027,93,1],[1028,29,1028,97,1],[1029,25,1029,26,1],[1031,21,1031,22,1],[1032,21,1032,50,1],[1033,21,1033,22,1],[1034,25,1034,32,1],[1034,34,1034,50,1],[1034,51,1034,53,1],[1034,54,1034,68,1],[1035,25,1035,26,1],[1036,29,1043,31,1],[1044,29,1044,77,1],[1045,25,1045,26,1],[1046,21,1046,22,1],[1047,21,1047,50,1],[1048,21,1048,22,1],[1049,25,1049,32,1],[1049,34,1049,50,1],[1049,51,1049,53,1],[1049,54,1049,68,1],[1050,29,1051,118,1],[1052,21,1052,22,1],[1053,21,1053,64,1],[1054,17,1054,18,1],[1055,13,1055,14,1],[1056,13,1056,33,0],[1057,13,1057,14,0],[1058,17,1058,93,0],[1059,17,1059,23,0],[1061,13,1061,31,1],[1062,9,1062,10,1],[1069,9,1069,10,0],[1070,13,1070,44,0],[1072,13,1072,14,0],[1073,24,1073,89,0],[1074,17,1074,18,0],[1075,21,1075,106,0],[1076,21,1076,95,0],[1077,21,1077,81,0],[1079,21,1079,85,0],[1080,21,1080,50,0],[1081,21,1081,22,0],[1082,25,1082,59,0],[1083,25,1083,79,0],[1084,25,1084,83,0],[1085,25,1085,83,0],[1086,25,1086,90,0],[1087,25,1087,139,0],[1088,25,1088,78,0],[1089,25,1089,136,0],[1090,25,1090,132,0],[1091,25,1091,82,0],[1092,25,1092,97,0],[1093,25,1093,100,0],[1094,25,1094,83,0],[1096,25,1096,130,0],[1097,25,1097,26,0],[1098,29,1098,62,0],[1099,29,1099,73,0],[1100,25,1100,26,0],[1102,25,1102,26,0],[1103,29,1103,93,0],[1104,29,1104,97,0],[1106,25,1106,26,0],[1107,21,1107,22,0],[1108,17,1108,18,0],[1109,13,1109,14,0],[1110,13,1110,33,0],[1111,13,1111,14,0],[1112,17,1112,93,0],[1113,17,1113,23,0],[1115,13,1115,31,0],[1116,9,1116,10,0],[1123,9,1123,10,0],[1124,13,1124,46,0],[1126,13,1126,14,0],[1129,24,1129,89,0],[1130,17,1130,18,0],[1131,21,1132,54,0],[1134,21,1134,85,0],[1135,21,1135,79,0],[1136,21,1136,64,0],[1138,21,1138,50,0],[1139,21,1139,22,0],[1140,25,1140,59,0],[1141,25,1141,78,0],[1142,25,1142,78,0],[1143,25,1143,80,0],[1144,21,1144,22,0],[1156,21,1156,62,0],[1158,21,1158,59,0],[1159,21,1159,22,0],[1160,25,1160,107,0],[1161,25,1161,86,0],[1162,25,1162,57,0],[1163,25,1163,26,0],[1164,29,1164,36,0],[1164,38,1164,49,0],[1164,50,1164,52,0],[1164,53,1164,57,0],[1165,29,1165,30,0],[1166,33,1166,128,0],[1167,29,1167,30,0],[1168,25,1168,26,0],[1169,21,1169,22,0],[1171,21,1171,73,0],[1172,21,1172,67,0],[1173,17,1173,18,0],[1174,13,1174,14,0],[1175,13,1175,33,0],[1176,13,1176,14,0],[1177,17,1177,93,0],[1178,17,1178,23,0],[1180,13,1180,32,0],[1181,9,1181,10,0],[1188,9,1188,10,1],[1190,13,1190,14,1],[1191,24,1191,89,1],[1192,17,1192,18,1],[1193,21,1193,94,1],[1194,21,1194,90,1],[1195,21,1195,81,1],[1196,21,1196,50,1],[1198,21,1198,85,1],[1201,13,1201,33,0],[1202,13,1202,14,0],[1203,17,1203,93,0],[1204,17,1204,23,0],[1206,9,1206,10,1],[1213,9,1213,10,0],[1215,13,1215,14,0],[1216,24,1216,89,0],[1217,17,1217,18,0],[1218,21,1218,93,0],[1219,21,1219,101,0],[1220,21,1220,81,0],[1221,21,1221,81,0],[1222,21,1222,50,0],[1224,21,1224,85,0],[1227,13,1227,33,0],[1228,13,1228,14,0],[1229,17,1229,93,0],[1230,17,1230,23,0],[1232,9,1232,10,0],[1238,9,1238,10,0],[1240,13,1240,14,0],[1241,24,1241,89,0],[1242,17,1242,18,0],[1243,21,1243,95,0],[1244,21,1244,92,0],[1245,21,1245,81,0],[1246,21,1246,50,0],[1248,21,1248,85,0],[1251,13,1251,33,0],[1252,13,1252,14,0],[1253,17,1253,93,0],[1254,17,1254,23,0],[1256,9,1256,10,0],[1263,9,1263,10,1],[1265,13,1265,14,1],[1266,24,1266,89,1],[1267,17,1267,18,1],[1268,21,1268,94,1],[1269,21,1269,90,1],[1270,21,1270,81,1],[1271,21,1271,50,1],[1273,21,1273,85,1],[1276,13,1276,33,0],[1277,13,1277,14,0],[1278,17,1278,93,0],[1279,17,1279,23,0],[1281,9,1281,10,1],[1298,9,1298,10,1],[1300,13,1300,14,1],[1301,17,1301,44,1],[1302,17,1302,41,1],[1303,17,1303,39,1],[1304,17,1304,36,1],[1304,37,1304,60,0],[1305,17,1305,33,1],[1305,34,1305,54,1],[1306,17,1306,31,1],[1306,32,1306,50,0],[1307,24,1307,89,1],[1308,17,1308,18,1],[1309,21,1309,92,1],[1311,21,1311,102,1],[1312,21,1312,107,1],[1313,21,1313,107,1],[1314,21,1314,107,1],[1315,21,1315,98,1],[1316,21,1316,104,1],[1317,21,1317,94,1],[1318,21,1318,84,1],[1319,21,1319,84,1],[1322,21,1322,84,1],[1323,21,1323,48,1],[1325,21,1325,100,1],[1328,13,1328,33,0],[1329,13,1329,14,0],[1330,17,1330,93,0],[1331,17,1331,23,0],[1333,9,1333,10,1],[1342,9,1342,10,1],[1344,13,1344,14,1],[1345,24,1345,89,1],[1346,17,1346,18,1],[1347,21,1347,97,1],[1349,21,1349,90,1],[1350,21,1350,84,1],[1351,21,1351,81,1],[1352,21,1352,50,1],[1354,21,1354,85,1],[1357,13,1357,33,0],[1358,13,1358,14,0],[1359,17,1359,93,0],[1360,17,1360,23,0],[1362,9,1362,10,1],[1370,9,1370,10,1],[1372,13,1372,14,1],[1373,17,1373,32,1],[1374,24,1374,89,1],[1375,17,1375,18,1],[1376,21,1376,28,1],[1376,30,1376,37,1],[1376,38,1376,40,1],[1376,41,1376,49,1],[1377,21,1377,22,1],[1378,25,1378,102,1],[1379,25,1379,94,1],[1380,25,1380,91,1],[1381,25,1381,89,1],[1382,25,1382,85,1],[1384,25,1384,54,1],[1385,25,1385,91,1],[1386,21,1386,22,1],[1387,21,1387,35,1],[1390,13,1390,33,0],[1391,13,1391,14,0],[1392,17,1392,93,0],[1393,17,1393,23,0],[1395,9,1395,10,1],[1402,9,1402,10,1],[1404,13,1404,14,1],[1405,24,1405,89,1],[1406,17,1406,18,1],[1407,21,1407,96,1],[1409,21,1409,90,1],[1410,21,1410,83,1],[1411,21,1411,40,1],[1414,13,1414,33,0],[1415,13,1415,14,0],[1416,17,1416,93,0],[1417,17,1417,23,0],[1419,9,1419,10,1],[1426,9,1426,10,1],[1428,13,1428,14,1],[1429,17,1430,38,1],[1431,17,1431,55,1],[1432,21,1432,41,1],[1433,13,1433,14,0],[1434,13,1434,33,0],[1435,13,1435,14,0],[1436,17,1436,93,0],[1437,17,1437,23,0],[1439,13,1439,25,0],[1440,9,1440,10,1],[1443,9,1443,10,1],[1445,13,1445,14,1],[1446,17,1447,38,1],[1448,17,1448,55,1],[1449,21,1449,41,1],[1450,13,1450,14,0],[1451,13,1451,33,0],[1452,13,1452,14,0],[1453,17,1453,93,0],[1454,17,1454,23,0],[1456,13,1456,25,0],[1457,9,1457,10,1],[1460,9,1460,10,0],[1462,13,1462,14,0],[1463,24,1463,89,0],[1464,17,1464,18,0],[1465,21,1465,67,0],[1466,21,1466,96,0],[1468,21,1468,90,0],[1469,21,1469,83,0],[1471,21,1471,40,0],[1474,13,1474,33,0],[1475,13,1475,14,0],[1476,17,1476,93,0],[1477,17,1477,23,0],[1479,9,1479,10,0],[1488,9,1488,10,1],[1490,13,1490,14,1],[1491,24,1491,89,1],[1492,17,1492,18,1],[1493,21,1493,95,1],[1494,21,1494,90,1],[1495,21,1495,84,1],[1496,21,1496,84,1],[1497,21,1497,90,1],[1498,21,1498,81,1],[1499,21,1499,50,1],[1501,21,1501,85,1],[1504,13,1504,33,0],[1505,13,1505,14,0],[1506,17,1506,93,0],[1507,17,1507,23,0],[1509,9,1509,10,1],[1518,9,1518,10,1],[1520,13,1520,14,1],[1521,24,1521,89,1],[1522,17,1522,18,1],[1523,21,1523,95,1],[1524,21,1524,90,1],[1525,21,1525,84,1],[1526,21,1526,81,1],[1527,21,1527,50,1],[1529,21,1529,85,1],[1532,13,1532,33,0],[1533,13,1533,14,0],[1534,17,1534,93,0],[1535,17,1535,23,0],[1537,9,1537,10,1],[1544,9,1544,10,1],[1546,13,1546,14,1],[1547,24,1547,89,1],[1548,17,1548,18,1],[1549,21,1549,93,1],[1551,21,1551,88,1],[1552,21,1552,81,1],[1553,21,1553,48,1],[1555,21,1555,85,1],[1558,13,1558,33,0],[1559,13,1559,14,0],[1560,17,1560,93,0],[1561,17,1561,23,0],[1563,9,1563,10,1],[1570,9,1570,10,1],[1572,13,1572,14,1],[1573,24,1573,89,1],[1574,17,1574,18,1],[1575,21,1575,93,1],[1577,21,1577,88,1],[1578,21,1578,93,1],[1579,21,1579,106,1],[1580,21,1580,83,1],[1581,21,1581,48,1],[1583,21,1583,99,1],[1586,13,1586,33,0],[1587,13,1587,14,0],[1588,17,1588,93,0],[1589,17,1589,23,0],[1591,9,1591,10,1],[1598,9,1598,10,1],[1600,13,1600,14,1],[1601,24,1601,89,1],[1602,17,1602,18,1],[1603,21,1603,96,1],[1605,21,1605,94,1],[1606,21,1606,81,1],[1607,21,1607,48,1],[1609,21,1609,85,1],[1612,13,1612,33,0],[1613,13,1613,14,0],[1614,17,1614,93,0],[1615,17,1615,23,0],[1617,9,1617,10,1],[1625,9,1625,10,1],[1627,13,1627,14,1],[1628,24,1628,89,1],[1629,17,1629,18,1],[1630,21,1630,96,1],[1632,21,1632,94,1],[1633,21,1633,99,1],[1634,21,1634,99,1],[1635,21,1635,98,1],[1636,21,1636,92,1],[1637,21,1637,96,1],[1638,21,1638,89,1],[1639,21,1639,86,1],[1640,21,1640,48,1],[1642,21,1642,90,1],[1645,13,1645,33,0],[1646,13,1646,14,0],[1647,17,1647,93,0],[1648,17,1648,23,0],[1650,9,1650,10,1],[1658,9,1658,10,1],[1660,13,1660,14,1],[1661,24,1661,89,1],[1662,17,1662,18,1],[1663,21,1663,100,1],[1665,21,1665,94,1],[1666,21,1666,89,1],[1667,21,1667,81,1],[1668,21,1668,48,1],[1670,21,1670,85,1],[1673,13,1673,33,0],[1674,13,1674,14,0],[1675,17,1675,93,0],[1676,17,1676,23,0],[1678,9,1678,10,1],[1688,9,1688,10,1],[1690,13,1690,14,1],[1691,24,1691,89,1],[1692,17,1692,18,1],[1693,21,1694,69,1],[1695,21,1695,56,1],[1698,13,1698,33,0],[1699,13,1699,14,0],[1700,17,1700,93,0],[1701,17,1701,23,0],[1703,9,1703,10,1],[1713,9,1713,10,0],[1715,13,1715,14,0],[1716,24,1716,89,0],[1717,17,1717,18,0],[1718,21,1719,69,0],[1720,21,1720,56,0],[1723,13,1723,33,0],[1724,13,1724,14,0],[1725,17,1725,93,0],[1726,17,1726,23,0],[1728,9,1728,10,0],[1735,9,1735,10,0],[1737,13,1737,14,0],[1741,24,1741,89,0],[1742,17,1742,18,0],[1743,21,1743,97,0],[1745,21,1745,95,0],[1746,21,1746,81,0],[1748,21,1748,66,0],[1751,13,1751,33,0],[1752,13,1752,14,0],[1753,17,1753,93,0],[1754,17,1754,23,0],[1756,9,1756,10,0],[1762,9,1762,10,0],[1764,13,1764,14,0],[1765,24,1765,89,0],[1766,17,1766,18,0],[1767,21,1767,67,0],[1768,21,1768,99,0],[1770,21,1770,92,0],[1772,28,1772,71,0],[1773,21,1773,22,0],[1774,25,1774,42,0],[1775,29,1775,76,0],[1776,21,1776,22,0],[1777,21,1777,38,0],[1780,13,1780,33,0],[1781,13,1781,14,0],[1782,17,1782,93,0],[1783,17,1783,23,0],[1785,9,1785,10,0],[1791,9,1791,10,0],[1793,13,1793,14,0],[1794,24,1794,89,0],[1795,17,1795,18,0],[1796,21,1796,68,0],[1797,21,1797,100,0],[1799,21,1799,92,0],[1801,28,1801,71,0],[1802,21,1802,22,0],[1803,25,1803,42,0],[1804,29,1804,77,0],[1805,21,1805,22,0],[1806,21,1806,39,0],[1809,13,1809,33,0],[1810,13,1810,14,0],[1811,17,1811,93,0],[1812,17,1812,23,0],[1814,9,1814,10,0],[1822,9,1822,10,1],[1824,13,1824,14,1],[1825,24,1825,89,1],[1826,17,1826,18,1],[1827,21,1828,57,1],[1831,21,1831,50,1],[1832,21,1832,93,1],[1835,13,1835,33,0],[1836,13,1836,14,0],[1837,17,1837,93,0],[1838,17,1838,27,0],[1840,9,1840,10,1],[1843,9,1843,10,1],[1845,13,1845,14,1],[1846,24,1846,89,1],[1847,17,1847,18,1],[1848,21,1849,57,1],[1852,21,1852,50,1],[1853,21,1853,93,1],[1856,13,1856,33,0],[1857,13,1857,14,0],[1858,17,1858,93,0],[1859,17,1859,27,0],[1861,9,1861,10,1],[1867,9,1867,10,0],[1869,13,1869,14,0],[1870,24,1870,89,0],[1871,17,1871,18,0],[1872,21,1872,99,0],[1874,21,1874,81,0],[1876,21,1876,66,0],[1879,13,1879,33,0],[1880,13,1880,14,0],[1881,17,1881,93,0],[1882,17,1882,23,0],[1884,9,1884,10,0],[1887,9,1887,10,0],[1889,13,1889,14,0],[1890,24,1890,89,0],[1891,17,1891,18,0],[1892,21,1892,102,0],[1893,21,1893,81,0],[1895,21,1895,66,0],[1898,13,1898,33,0],[1899,13,1899,14,0],[1900,17,1900,93,0],[1901,17,1901,23,0],[1903,9,1903,10,0],[1912,9,1912,10,1],[1914,13,1914,14,1],[1915,24,1915,89,1],[1916,17,1916,18,1],[1917,21,1917,98,1],[1919,21,1919,84,1],[1920,21,1920,84,1],[1921,21,1921,92,1],[1923,21,1923,66,1],[1926,13,1926,33,0],[1927,13,1927,14,0],[1928,17,1928,93,0],[1929,17,1929,23,0],[1931,9,1931,10,1],[1938,9,1938,10,0],[1940,13,1940,14,0],[1941,24,1941,89,0],[1942,17,1942,18,0],[1943,21,1943,95,0],[1945,21,1945,66,0],[1948,13,1948,33,0],[1949,13,1949,14,0],[1950,17,1950,93,0],[1951,17,1951,29,0],[1953,9,1953,10,0],[1957,9,1957,10,0],[1959,13,1959,14,0],[1979,24,1979,89,0],[1980,17,1980,18,0],[1981,21,1981,99,0],[1982,21,1982,96,0],[1983,21,1986,54,0],[1987,21,1988,97,0],[1990,21,1990,53,0],[1991,25,1991,94,0],[1993,25,1993,91,0],[1995,21,1996,88,0],[1997,21,1997,82,0],[2001,21,2001,56,0],[2005,13,2005,33,0],[2006,13,2006,14,0],[2007,17,2007,79,0],[2008,17,2008,23,0],[2010,9,2010,10,0],[2013,9,2013,10,0],[2015,13,2015,14,0],[2016,24,2016,89,0],[2017,17,2017,18,0],[2018,21,2018,53,0],[2019,21,2019,40,0],[2019,41,2019,67,0],[2020,21,2020,100,0],[2021,21,2021,42,0],[2023,21,2023,112,0],[2025,21,2025,98,0],[2028,13,2028,33,0],[2029,13,2029,14,0],[2030,17,2030,79,0],[2031,17,2031,23,0],[2033,9,2033,10,0],[2036,9,2036,10,0],[2037,20,2037,85,0],[2038,13,2038,14,0],[2039,17,2039,100,0],[2040,17,2040,52,0],[2042,9,2042,10,0],[2045,9,2045,10,0],[2046,20,2046,85,0],[2047,13,2047,14,0],[2048,17,2048,39,0],[2049,17,2049,33,0],[2050,17,2050,94,0],[2051,17,2051,52,0],[2053,9,2053,10,0],[2062,9,2062,10,0],[2063,20,2063,85,0],[2064,13,2064,14,0],[2065,17,2065,92,0],[2066,17,2066,77,0],[2067,17,2067,110,0],[2068,17,2068,107,0],[2069,17,2069,52,0],[2071,9,2071,10,0],[2075,9,2075,10,0],[2076,20,2076,85,0],[2077,13,2077,14,0],[2078,17,2078,88,0],[2079,17,2079,81,0],[2080,17,2080,89,0],[2081,17,2081,74,0],[2082,17,2082,70,0],[2083,17,2083,86,0],[2084,17,2084,86,0],[2085,17,2085,82,0],[2086,17,2086,77,0],[2088,17,2088,53,0],[2090,9,2090,10,0],[2093,9,2093,10,0],[2095,13,2095,14,0],[2096,24,2096,89,0],[2097,17,2097,18,0],[2098,21,2100,60,0],[2101,21,2101,62,0],[2102,21,2102,55,0],[2103,21,2103,68,0],[2104,25,2105,90,0],[2106,21,2106,79,0],[2107,25,2108,90,0],[2109,21,2109,39,0],[2110,21,2110,22,0],[2111,25,2111,58,0],[2112,25,2112,71,0],[2113,29,2114,94,0],[2115,25,2115,111,0],[2116,21,2116,22,0],[2117,21,2117,31,0],[2120,13,2120,18,0],[2121,13,2121,14,0],[2122,17,2122,29,0],[2124,9,2124,10,0],[2128,9,2128,10,0],[2130,13,2130,14,0],[2131,17,2131,118,0],[2133,13,2133,18,0],[2134,13,2134,14,0],[2135,17,2135,29,0],[2137,9,2137,10,0],[2141,9,2141,10,0],[2143,13,2143,14,0],[2144,17,2145,31,0],[2147,13,2147,18,0],[2148,13,2148,14,0],[2149,17,2149,29,0],[2151,9,2151,10,0],[2154,9,2154,10,0],[2155,20,2155,85,0],[2156,13,2156,14,0],[2157,17,2157,88,0],[2158,17,2158,77,0],[2159,17,2159,89,0],[2160,17,2160,79,0],[2161,17,2161,115,0],[2162,17,2162,77,0],[2164,17,2164,52,0],[2166,9,2166,10,0],[2171,9,2171,10,1],[2172,13,2172,65,1],[2173,13,2173,37,1],[2174,13,2174,20,1],[2174,22,2174,32,1],[2174,33,2174,35,1],[2174,36,2174,53,1],[2175,13,2175,14,1],[2176,17,2180,63,1],[2181,17,2181,18,1],[2182,21,2182,148,1],[2183,21,2183,22,1],[2184,25,2185,88,1],[2186,21,2186,22,1],[2188,21,2188,22,1],[2189,25,2190,118,1],[2191,21,2191,22,1],[2192,17,2192,18,1],[2193,13,2193,14,1],[2194,9,2194,10,1],[2203,9,2203,10,1],[2205,13,2205,14,1],[2206,17,2206,78,1],[2207,17,2207,90,1],[2208,17,2208,93,1],[2209,17,2209,74,1],[2210,17,2211,57,1],[2212,17,2212,31,1],[2213,17,2213,48,1],[2214,17,2214,112,1],[2215,17,2215,18,0],[2216,21,2216,41,0],[2219,17,2219,18,1],[2220,28,2220,93,1],[2221,21,2221,22,1],[2222,25,2222,101,1],[2223,25,2223,70,1],[2227,13,2227,33,0],[2228,13,2228,14,0],[2229,17,2229,93,0],[2230,17,2230,29,0],[2232,9,2232,10,1],[2240,9,2240,10,0],[2242,13,2242,14,0],[2243,24,2243,89,0],[2244,17,2244,18,0],[2245,21,2245,97,0],[2246,21,2246,88,0],[2247,21,2247,66,0],[2250,13,2250,33,0],[2251,13,2251,14,0],[2252,17,2252,93,0],[2253,17,2253,29,0],[2255,9,2255,10,0],[2263,9,2263,10,0],[2266,13,2266,14,0],[2267,24,2267,89,0],[2268,17,2268,18,0],[2269,21,2269,70,0],[2270,21,2270,35,0],[2271,21,2271,68,0],[2274,21,2274,22,0],[2275,25,2275,101,0],[2277,25,2277,103,0],[2278,25,2278,105,0],[2279,25,2279,85,0],[2280,25,2280,60,0],[2282,25,2282,93,0],[2283,25,2283,42,0],[2284,29,2284,43,0],[2286,29,2286,45,0],[2287,21,2287,22,0],[2288,21,2288,41,0],[2289,21,2289,22,0],[2290,25,2290,41,0],[2291,25,2291,101,0],[2292,25,2292,31,0],[2295,21,2295,22,0],[2296,25,2296,40,0],[2297,25,2297,42,0],[2298,21,2298,22,0],[2299,17,2299,18,0],[2300,13,2300,14,0],[2301,13,2301,33,0],[2302,13,2302,14,0],[2303,17,2303,93,0],[2304,17,2304,23,0],[2307,13,2307,29,0],[2308,9,2308,10,0],[2316,9,2316,10,0],[2319,13,2319,14,0],[2320,24,2320,89,0],[2321,17,2321,18,0],[2322,21,2322,70,0],[2323,21,2323,35,0],[2324,21,2324,68,0],[2327,21,2327,22,0],[2328,25,2328,104,0],[2330,25,2330,98,0],[2331,25,2331,103,0],[2332,25,2332,105,0],[2333,25,2333,85,0],[2334,25,2334,60,0],[2336,25,2336,93,0],[2337,25,2337,42,0],[2338,29,2338,43,0],[2340,29,2340,45,0],[2341,21,2341,22,0],[2342,21,2342,41,0],[2343,21,2343,22,0],[2344,25,2344,41,0],[2345,25,2345,101,0],[2346,25,2346,31,0],[2349,21,2349,22,0],[2350,25,2350,40,0],[2351,25,2351,42,0],[2352,21,2352,22,0],[2353,17,2353,18,0],[2354,13,2354,14,0],[2355,13,2355,33,0],[2356,13,2356,14,0],[2357,17,2357,93,0],[2358,17,2358,23,0],[2361,13,2361,29,0],[2362,9,2362,10,0],[2370,9,2370,10,0],[2373,13,2373,14,0],[2374,24,2374,89,0],[2375,17,2375,18,0],[2376,21,2376,70,0],[2377,21,2377,35,0],[2378,21,2378,68,0],[2381,21,2381,22,0],[2382,25,2382,98,0],[2384,25,2384,92,0],[2385,25,2385,85,0],[2386,25,2386,60,0],[2388,25,2388,91,0],[2389,25,2389,40,0],[2390,29,2390,43,0],[2392,29,2392,45,0],[2393,21,2393,22,0],[2394,21,2394,41,0],[2395,21,2395,22,0],[2396,25,2396,41,0],[2397,25,2397,101,0],[2398,25,2398,99,0],[2401,21,2401,22,0],[2402,25,2402,40,0],[2403,25,2403,42,0],[2404,21,2404,22,0],[2405,17,2405,18,0],[2406,13,2406,14,0],[2407,13,2407,33,0],[2408,13,2408,14,0],[2409,17,2409,93,0],[2410,17,2410,23,0],[2413,13,2413,27,0],[2414,9,2414,10,0],[2421,9,2421,10,0],[2423,13,2423,14,0],[2424,24,2424,89,0],[2425,17,2425,18,0],[2426,21,2426,98,0],[2428,21,2428,66,0],[2431,13,2431,33,0],[2432,13,2432,14,0],[2433,17,2433,93,0],[2434,17,2434,29,0],[2436,9,2436,10,0],[2447,9,2447,10,0],[2449,13,2449,14,0],[2450,24,2450,89,0],[2451,17,2451,18,0],[2452,21,2452,99,0],[2454,21,2454,66,0],[2457,13,2457,33,0],[2458,13,2458,14,0],[2459,17,2459,93,0],[2460,17,2460,29,0],[2462,9,2462,10,0],[2465,9,2465,10,0],[2467,13,2467,14,0],[2468,24,2468,89,0],[2469,17,2469,18,0],[2470,21,2470,114,0],[2471,21,2471,86,0],[2472,21,2472,101,0],[2473,21,2473,66,0],[2476,13,2476,33,0],[2477,13,2477,14,0],[2478,17,2478,93,0],[2479,17,2479,29,0],[2481,9,2481,10,0],[2490,9,2490,10,0],[2492,13,2492,14,0],[2493,17,2493,78,0],[2494,17,2494,90,0],[2495,17,2495,93,0],[2496,17,2496,74,0],[2497,17,2498,57,0],[2499,17,2499,31,0],[2500,17,2500,48,0],[2501,17,2501,112,0],[2502,17,2502,18,0],[2503,21,2503,41,0],[2506,17,2506,18,0],[2507,28,2507,93,0],[2508,21,2508,22,0],[2509,25,2509,103,0],[2510,25,2510,92,0],[2511,25,2511,70,0],[2515,13,2515,33,0],[2516,13,2516,14,0],[2517,17,2517,93,0],[2518,17,2518,29,0],[2520,9,2520,10,0],[2528,9,2528,10,0],[2531,13,2531,14,0],[2532,24,2532,89,0],[2533,17,2533,18,0],[2534,21,2534,70,0],[2535,21,2535,35,0],[2536,21,2536,68,0],[2539,21,2539,22,0],[2540,25,2540,102,0],[2542,25,2542,91,0],[2543,25,2543,105,0],[2544,25,2544,91,0],[2545,25,2545,99,0],[2546,25,2546,98,0],[2548,25,2548,85,0],[2549,25,2549,60,0],[2551,25,2551,91,0],[2552,25,2552,40,0],[2553,29,2553,43,0],[2555,29,2555,45,0],[2556,21,2556,22,0],[2557,21,2557,41,0],[2558,21,2558,22,0],[2559,25,2559,41,0],[2560,25,2560,101,0],[2561,25,2561,31,0],[2564,21,2564,22,0],[2565,25,2565,40,0],[2566,25,2566,42,0],[2567,21,2567,22,0],[2568,17,2568,18,0],[2569,13,2569,14,0],[2570,13,2570,33,0],[2571,13,2571,14,0],[2572,17,2572,93,0],[2573,17,2573,23,0],[2576,13,2576,27,0],[2577,9,2577,10,0],[2585,9,2585,10,0],[2588,13,2588,14,0],[2589,24,2589,89,0],[2590,17,2590,18,0],[2591,21,2591,70,0],[2592,21,2592,35,0],[2593,21,2593,68,0],[2596,21,2596,22,0],[2597,25,2597,106,0],[2599,25,2599,94,0],[2600,25,2600,91,0],[2601,25,2601,105,0],[2602,25,2602,91,0],[2603,25,2603,99,0],[2604,25,2604,98,0],[2606,25,2606,85,0],[2607,25,2607,60,0],[2609,25,2609,91,0],[2610,25,2610,40,0],[2611,29,2611,43,0],[2613,29,2613,45,0],[2614,21,2614,22,0],[2615,21,2615,41,0],[2616,21,2616,22,0],[2617,25,2617,41,0],[2618,25,2618,101,0],[2619,25,2619,31,0],[2622,21,2622,22,0],[2623,25,2623,40,0],[2624,25,2624,42,0],[2625,21,2625,22,0],[2626,17,2626,18,0],[2627,13,2627,14,0],[2628,13,2628,33,0],[2629,13,2629,14,0],[2630,17,2630,93,0],[2631,17,2631,23,0],[2634,13,2634,27,0],[2635,9,2635,10,0],[2643,9,2643,10,0],[2646,13,2646,14,0],[2647,24,2647,89,0],[2648,17,2648,18,0],[2649,21,2649,70,0],[2650,21,2650,35,0],[2651,21,2651,68,0],[2654,21,2654,22,0],[2655,25,2655,99,0],[2657,25,2657,88,0],[2658,25,2658,85,0],[2659,25,2659,60,0],[2661,25,2661,91,0],[2662,25,2662,40,0],[2663,29,2663,43,0],[2665,29,2665,45,0],[2666,21,2666,22,0],[2667,21,2667,41,0],[2668,21,2668,22,0],[2669,25,2669,41,0],[2670,25,2670,101,0],[2671,25,2671,97,0],[2674,21,2674,22,0],[2675,25,2675,40,0],[2676,25,2676,42,0],[2677,21,2677,22,0],[2678,17,2678,18,0],[2679,13,2679,14,0],[2680,13,2680,33,0],[2681,13,2681,14,0],[2682,17,2682,93,0],[2683,17,2683,23,0],[2686,13,2686,27,0],[2687,9,2687,10,0],[2698,9,2698,10,1],[2700,13,2700,14,1],[2701,24,2701,89,1],[2702,17,2702,18,1],[2703,21,2703,99,1],[2704,21,2704,66,1],[2707,13,2707,33,0],[2708,13,2708,14,0],[2709,17,2709,93,0],[2710,17,2710,29,0],[2712,9,2712,10,1],[2715,9,2715,10,0],[2717,13,2717,14,0],[2718,24,2718,89,0],[2719,17,2719,18,0],[2720,21,2720,96,0],[2721,21,2721,99,0],[2722,21,2722,56,0],[2725,13,2725,33,0],[2726,13,2726,14,0],[2727,17,2727,93,0],[2728,17,2728,29,0],[2730,9,2730,10,0],[2738,9,2738,10,1],[2740,13,2740,14,1],[2741,24,2741,89,1],[2742,17,2742,18,1],[2743,21,2743,97,1],[2744,21,2744,102,1],[2745,21,2745,66,1],[2748,13,2748,33,0],[2749,13,2749,14,0],[2750,17,2750,93,0],[2751,17,2751,29,0],[2753,9,2753,10,1],[2761,9,2761,10,1],[2764,13,2764,14,1],[2765,24,2765,89,1],[2766,17,2766,18,1],[2767,21,2767,70,1],[2768,21,2768,35,1],[2769,21,2769,68,1],[2772,21,2772,22,1],[2773,25,2773,104,1],[2774,25,2774,109,1],[2775,25,2775,114,1],[2776,25,2776,117,1],[2777,25,2777,81,1],[2778,25,2778,60,1],[2780,25,2780,96,1],[2781,25,2781,49,1],[2782,29,2782,43,1],[2784,29,2784,45,0],[2785,21,2785,22,1],[2786,21,2786,41,0],[2787,21,2787,22,0],[2788,25,2788,41,0],[2789,25,2789,101,0],[2790,25,2790,31,0],[2793,21,2793,22,1],[2794,25,2794,40,1],[2795,25,2795,42,1],[2796,21,2796,22,1],[2797,17,2797,18,1],[2798,13,2798,14,1],[2799,13,2799,33,0],[2800,13,2800,14,0],[2801,17,2801,93,0],[2802,17,2802,23,0],[2805,13,2805,36,1],[2806,9,2806,10,1],[2814,9,2814,10,0],[2817,13,2817,14,0],[2818,24,2818,89,0],[2819,17,2819,18,0],[2820,21,2820,70,0],[2821,21,2821,35,0],[2822,21,2822,68,0],[2825,21,2825,22,0],[2826,25,2826,104,0],[2828,25,2828,112,0],[2829,25,2829,117,0],[2830,25,2830,85,0],[2831,25,2831,60,0],[2833,25,2833,100,0],[2834,25,2834,49,0],[2835,29,2835,43,0],[2837,29,2837,45,0],[2838,21,2838,22,0],[2839,21,2839,41,0],[2840,21,2840,22,0],[2841,25,2841,41,0],[2842,25,2842,101,0],[2843,25,2843,31,0],[2846,21,2846,22,0],[2847,25,2847,40,0],[2848,25,2848,42,0],[2849,21,2849,22,0],[2850,17,2850,18,0],[2851,13,2851,14,0],[2852,13,2852,33,0],[2853,13,2853,14,0],[2854,17,2854,93,0],[2855,17,2855,23,0],[2858,13,2858,36,0],[2859,9,2859,10,0],[2867,9,2867,10,0],[2870,13,2870,14,0],[2871,24,2871,89,0],[2872,17,2872,18,0],[2873,21,2873,70,0],[2874,21,2874,35,0],[2875,21,2875,68,0],[2878,21,2878,22,0],[2879,25,2879,104,0],[2881,25,2881,106,0],[2882,25,2882,85,0],[2883,25,2883,60,0],[2885,25,2885,91,0],[2886,25,2886,40,0],[2887,29,2887,43,0],[2889,29,2889,45,0],[2890,21,2890,22,0],[2891,21,2891,41,0],[2892,21,2892,22,0],[2893,25,2893,41,0],[2894,25,2894,101,0],[2895,25,2895,31,0],[2898,21,2898,22,0],[2899,25,2899,40,0],[2900,25,2900,42,0],[2901,21,2901,22,0],[2902,17,2902,18,0],[2903,13,2903,14,0],[2904,13,2904,33,0],[2905,13,2905,14,0],[2906,17,2906,93,0],[2907,17,2907,23,0],[2910,13,2910,27,0],[2911,9,2911,10,0],[2922,9,2922,10,0],[2924,13,2924,14,0],[2925,24,2925,89,0],[2926,17,2926,18,0],[2927,21,2927,100,0],[2929,21,2929,66,0],[2932,13,2932,33,0],[2933,13,2933,14,0],[2934,17,2934,93,0],[2935,17,2935,29,0],[2937,9,2937,10,0],[2945,9,2945,10,0],[2947,13,2947,14,0],[2948,24,2948,89,0],[2949,17,2949,18,0],[2950,21,2950,100,0],[2951,21,2951,102,0],[2953,21,2953,66,0],[2956,13,2956,33,0],[2957,13,2957,14,0],[2958,17,2958,93,0],[2959,17,2959,29,0],[2961,9,2961,10,0],[2966,9,2966,10,0],[2967,13,2967,116,0],[2968,13,2968,37,0],[2969,17,2969,37,0],[2971,17,2971,29,0],[2972,9,2972,10,0],[2975,9,2975,10,1],[2976,13,2977,28,1],[2978,13,2978,37,1],[2979,17,2979,37,1],[2981,17,2981,29,0],[2982,9,2982,10,1],[2985,9,2985,10,0],[2986,13,2987,121,0],[2988,9,2988,10,0],[2992,9,2992,10,1],[2993,20,2993,85,1],[2994,13,2994,14,1],[2996,17,2996,103,1],[2997,17,2997,86,1],[2998,17,2998,91,1],[2999,17,2999,84,1],[3000,17,3000,93,1],[3001,17,3001,85,1],[3002,17,3002,81,1],[3003,17,3003,82,1],[3004,17,3004,83,1],[3005,17,3005,81,1],[3007,17,3007,18,1],[3008,21,3008,54,1],[3009,21,3009,95,1],[3010,21,3010,41,1],[3012,17,3012,34,0],[3013,17,3013,18,0],[3014,17,3014,18,0],[3015,17,3015,91,0],[3016,17,3016,29,0],[3018,9,3018,10,1],[3021,9,3021,10,1],[3023,13,3023,14,1],[3024,17,3024,75,1],[3025,21,3025,32,1],[3027,24,3027,89,1],[3028,17,3028,18,1],[3029,21,3030,69,1],[3031,21,3031,56,1],[3034,13,3034,33,0],[3035,13,3035,14,0],[3036,17,3036,93,0],[3037,17,3037,23,0],[3039,9,3039,10,1],[3042,9,3042,10,0],[3043,13,3044,32,0],[3045,9,3045,10,0],[3048,9,3048,10,1],[3049,13,3050,36,1],[3051,9,3051,10,1],[3054,9,3054,10,1],[3055,13,3056,123,1],[3057,9,3057,10,1],[3066,9,3066,10,1],[3067,13,3067,30,1],[3069,13,3069,151,1],[3071,13,3071,43,1],[3073,13,3073,51,1],[3074,13,3074,14,1],[3075,17,3075,49,1],[3076,17,3076,18,0],[3077,21,3077,34,0],[3078,21,3078,71,0],[3080,21,3080,28,0],[3080,30,3080,40,0],[3080,41,3080,43,0],[3080,44,3080,61,0],[3081,21,3081,22,0],[3082,25,3082,75,0],[3083,21,3083,22,0],[3084,21,3084,72,0],[3085,17,3085,18,0],[3086,13,3086,14,1],[3087,13,3087,25,1],[3088,9,3088,10,1],[3091,9,3091,10,1],[3092,13,3092,143,1],[3093,9,3093,10,1],[3096,9,3096,10,1],[3097,13,3097,154,1],[3098,9,3098,10,1],[3101,9,3101,10,0],[3102,13,3102,146,0],[3103,9,3103,10,0],[3106,9,3106,10,0],[3107,13,3107,153,0],[3108,9,3108,10,0],[3111,9,3111,10,0],[3112,13,3112,142,0],[3113,9,3113,10,0],[3122,9,3122,10,1],[3123,13,3123,139,1],[3125,13,3125,51,1],[3126,17,3126,37,1],[3128,13,3128,25,0],[3129,9,3129,10,1],[3132,9,3132,10,0],[3133,13,3133,159,0],[3134,9,3134,10,0],[3137,9,3137,10,0],[3138,13,3138,151,0],[3139,9,3139,10,0],[3142,9,3142,10,0],[3143,13,3143,168,0],[3144,9,3144,10,0],[3147,9,3147,10,1],[3149,13,3149,14,1],[3150,24,3150,89,1],[3151,17,3151,18,1],[3152,21,3152,108,1],[3153,21,3153,90,1],[3154,21,3154,84,1],[3155,21,3155,81,1],[3156,21,3156,50,1],[3158,21,3158,85,1],[3161,13,3161,33,0],[3162,13,3162,14,0],[3163,17,3163,93,0],[3164,17,3164,23,0],[3166,9,3166,10,1],[3169,9,3169,10,1],[3170,13,3170,124,1],[3171,9,3171,10,1],[3174,9,3174,10,0],[3175,13,3175,132,0],[3176,9,3176,10,0]]);
    </script>
  </body>
</html>