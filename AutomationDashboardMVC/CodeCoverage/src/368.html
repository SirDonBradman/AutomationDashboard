<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Construction Vertical\Addon Modules\Contract Manager\Work Order\ViewACTIWO.aspx.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.Web.UI.WebControls;
using Aurigo.AMP3.Common;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.Resources.TerminologyResources;
using Aurigo.AMP3.WORKORDBL;
using Aurigo.AMP3.WORKORDDTO;
using Aurigo.Brix.Core.WebUiHelper;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Aurigo.Brix.Platform.BusinessLayer.Utility;

namespace Aurigo.AMP3.WORKORDUI
{
    public partial class ViewACTIWO : BrixPageBase
    {
        protected UltraWebGrid uwgQuotItems, uwgQuotations, uwgPrepaymentTypes, uwgActivities, uwgWOItems;   
        private int _ContractID;
        private int _WorkOrderID;

        /// &lt;summary&gt;
        /// attachments control.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Auto-generated field.
        /// To modify move field declaration from designer file to code-behind file.
        /// &lt;/remarks&gt;
        protected global::Aurigo.AMP3.Core.UserControls.AttachmentsControl attachments;

        protected override void OnInit(EventArgs e)
        {
            hdnAmountDigits.Value = CoreDatabaseHelper.GetDigitsAfterDecimal(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT).ToString2();
            uwgActivities.InitializeRow += uwgActivities_InitializeRow;
            base.OnInit(e);
        }

        protected void uwgActivities_InitializeRow(object sender, RowEventArgs e)
        {
            if (e.Row.Cells.Exists(&quot;IsShortClose&quot;) &amp;&amp; e.Row.Cells.FromKey(&quot;IsShortClose&quot;).Value.ToBoolean2())
            {
                e.Row.Style.BackColor = Color.LightGray;
            }
        }

        protected void Page_Load(object sender, EventArgs e)
        {
            EnsureChildControls();
            UIHelper.DisableRoleSelection(Page);
            _ContractID = Request.QueryString[WOConstants.QRY_CONTRACTID].ToInt32_2();

            _WorkOrderID = Request.QueryString[WOConstants.QRY_WORKORDERID].ToInt32_2();
            txtId.Value = _WorkOrderID.ToString2();

            var featurelist = (List&lt;string&gt;) Context.Items[Constants.MODULE_PERMISSIONS];
            if (!featurelist.Contains(WOConstants.MODFEAT_VIEW))
            {
                string redurl;
                redurl = (Request[&quot;ES&quot;] != null)
                             ? &quot;~/Modules/ENTPRSE/CustomSearch.aspx&quot;
                             : &quot;~/Common/BrixListPage.aspx?context=ACTI-WO&amp;PID=&quot; + Request[Constants.QRY_PROJECTID] +
                               &quot;&amp;ContractID=&quot; + Request[&quot;ContractID&quot;] + &quot;&amp;ParentID=&quot; + Request[&quot;ContractID&quot;];
                UIHelper.RedirectURL(&quot;Do not have permissions to View Work Order.&quot;, redurl, null, Context);
                return;
            }

            //Load Work Order Details here
            if (!IsPostBack)
            {
                LoadWorkOrderInstanceDetails();
                hdnVisibleTab.Value = WOConstants.TAB_WO;
                if (!string.IsNullOrEmpty(Request[&quot;Tab&quot;]) &amp;&amp; Request[&quot;Tab&quot;] == WOConstants.TAB_QUOT)
                {
                    hdnVisibleTab.Value = WOConstants.TAB_QUOT;
                    Page.ClientScript.RegisterStartupScript(GetType(), &quot;S&quot;,
                                                           @&quot;showPane(document.getElementById(document.getElementById(&#39;&quot; +
                                                           hdnVisibleTab.ClientID + &quot;&#39;).value), true);&quot;, true);
                }
                attachments.InstanceID = _WorkOrderID.ToString2();
                attachments.SrcType = WOConstants.MODULE_NAME;
                attachments.ReadOnly = true;
            }
            litCurrency.Text = LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2());
        }

        private void LoadWorkOrderInstanceDetails()
        {
            WorkOrderDTO WODTO =
                WOManager.Instance.GetWorkOrderDetails(Request.QueryString[WOConstants.QRY_WORKORDERID].ToInt32_2());
            if (WODTO == null)
            {
                Page.ClientScript.RegisterStartupScript(GetType(), &quot;Instance deleted.&quot;,
                                                        &quot;&lt;script&gt; alert(&#39;The Work Order instance has been deleted.&#39;); document.location=&#39;&quot; +
                                                        &quot;~/Common/BrixListPage.aspx?context=ACTI-WO&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&quot;
                                                            .Format2(UIHelper.UrlEncode(Request[WOConstants.QRY_PROJECTID]),
                                                                     UIHelper.UrlEncode(_ContractID.ToString2())) + &quot;&#39;;&lt;/script&gt;&quot;);
                return;
            }

            lblWONO.Text = WODTO.WorkOrderNo;
            lblExtReference.Text = WODTO.ExtReference;
            lblWOReqBy.Text = WODTO.WorkOrderRequestedBy;

            lblWODate.Text = WODTO.WorkOrderDate.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
            lblContractor.Text = WODTO.Contractor;
            txtDesc.Text = WODTO.Description;
            txtNotes.Text = WODTO.Notes;
            txtScope.Text = WODTO.ScopeOfWork;
            txtTaxPayerID.Text = WODTO.TaxPayerID;
            txtLicenseCity.Text = WODTO.LicenseCity;
            txtLicenseState.Text = WODTO.LicenseState;
            txtInsurance.Text = WODTO.Insurance;

            txtDesc.ReadOnly = txtNotes.ReadOnly = txtScope.ReadOnly = true;

            chkWithMaterial.Checked = WODTO.WithMaterial;
            chkEquipment.Checked = WODTO.WithEquipment;
            chkLabour.Checked = WODTO.WithLabour;

            chkEquipment.Enabled = chkWithMaterial.Enabled = chkLabour.Enabled = false;

            lblStartDate.Text = WODTO.StartDate.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
            lblEndDate.Text = WODTO.EndDate.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);

            tdStatus.InnerText = ((WODTO.Status == WOConstants.STAGE_DRAFT)
                                      ? &quot;Draft&quot;
                                      : ((WODTO.Status == WOConstants.STAGE_APPROVED)
                                             ? &quot;Approved&quot;
                                             : ((WODTO.Status == WOConstants.STAGE_ISSUED)
                                                    ? &quot;Issued&quot;
                                                    : ((WODTO.Status == WOConstants.STAGE_DRAFT_AMENDMENT)
                                                           ? &quot;Draft Amendment&quot;
                                                           : ((WODTO.Status == WOConstants.STAGE_APPROVE_AMENDMENT)
                                                                  ? &quot;Approved Amendment&quot;
                                                                  : &quot;Closed&quot;)
                                                      ))));

            tdCreatedBy.InnerText = WODTO.CreatedBy;
            tdCreatedOn.InnerText = WODTO.CreatedOn.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
            //remove the above after adding the attribute in td

            if (WODTO.Status &gt;= WOConstants.STAGE_APPROVED &amp;&amp; WODTO.Status != WOConstants.STAGE_DRAFT_AMENDMENT)
            {
                tdApprovedBy.InnerText = WODTO.ApprovedBy;
                tdApprovedOn.InnerText = WODTO.ApprovedOn.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);

                if (WODTO.Status &gt;= WOConstants.STAGE_ISSUED &amp;&amp; WODTO.Status != WOConstants.STAGE_APPROVE_AMENDMENT)
                {
                    tdIssuedBy.InnerText = WODTO.IssuedBy;
                    tdIssuedOn.InnerText = WODTO.IssuedOn.ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
                }
                else
                {
                    trIssuedBy.Visible = false;
                }
            }
            else
            {
                trApprovedBy.Visible = false;
                trIssuedBy.Visible = false;
            }
            BindActivitiesData();
            BindQuotationData();

            hdnTotalAmt.Value =
                (WODTO.TotalAmount == 0 ? hdnTotalAmt.Value.ToDecimal2() : WODTO.TotalAmount).ToString2();

            #region Loading Prepayment Rule, Prepayment Types and Retention details

            DataSet dsRRDetails = WORKORDManager.Instance.GetRecoveryRetentionDetails(&quot;WORKORD&quot;, _WorkOrderID);
            //Table[0] - Recovery Details
            //Table[1] - Associated Prepayment Details
            //Table[2] - Retention Details
            string mode = string.Empty;
            if (dsRRDetails.Tables[0].Rows.Count != 0 &amp;&amp; dsRRDetails.Tables[1].Rows.Count != 0)
            {
                #region Loading Prepayment Rule

                DataRow row = dsRRDetails.Tables[0].Rows[0];

                mode = ((row[&quot;Prepaymentmode&quot;].ToString2() == &quot;False&quot; || row[&quot;Prepaymentmode&quot;].ToString2() == &quot;0&quot;)
                            ? WOConstants.MODE_AMOUNT
                            : WOConstants.MODE_PERCENTAGE);
                lblMaxPercentage.Text =
                    ((row[&quot;Prepaymentmode&quot;].ToString2() == &quot;True&quot; || row[&quot;Prepaymentmode&quot;].ToString2() == &quot;0&quot;)
                         ? row[&quot;Value&quot;].ToString2()
                         : &quot;0&quot;).ToDecimal2().ToString(AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE, CultureInfo.CurrentCulture);
                lblMaxAmount.Text =
                    ((row[&quot;Prepaymentmode&quot;].ToString2() == &quot;False&quot; || row[&quot;Prepaymentmode&quot;].ToString2() == &quot;1&quot;)
                         ? row[&quot;Value&quot;].ToString2()
                         : &quot;0&quot;).ToDecimal2().ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                lblPrepaymentRule.Text = row[&quot;RecoveryRuleName&quot;].ToString2();

                #endregion

                #region Loading Prepayment Types

                DataTable dtTypes = dsRRDetails.Tables[1];
                dtTypes.Columns.Add(WOConstants.HEADING_RV_IN_RAB);
                string format = (mode == WOConstants.MODE_PERCENTAGE
                                     ? AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE
                                     : AMP3ApplicationSettings.Instance.FORMAT_AMOUNT);
                foreach (DataRow rw in dtTypes.Rows)
                {
                    rw[WOConstants.HEADING_RV_IN_RAB] =
                        CalculateRecoveryValueInEachRAB(rw[&quot;RecoveryValue&quot;].ToString2(),
                                                        rw[&quot;PrepaymentValue&quot;].ToString2(), mode).ToDecimal2().ToString(
                                                            AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                    ;
                    rw[WOConstants.HEADING_AMOUNT_PAID] =
                        rw[WOConstants.HEADING_AMOUNT_PAID].ToDecimal2().ToString(format, CultureInfo.CurrentCulture).
                            ToDecimal2();
                    rw[WOConstants.HEADING_RECOVERED_AMOUNT] =
                        rw[WOConstants.HEADING_RECOVERED_AMOUNT].ToDecimal2().ToString(format,
                                                                                       CultureInfo.CurrentCulture).
                            ToDecimal2();
                }
                dtTypes.AcceptChanges();
                uwgPrepaymentTypes.DataSource = dtTypes;
                uwgPrepaymentTypes.DataBind();

                FormatPrepaymentTypesGrid(mode);

                CalculateAmountOrPercentage(mode);

                #endregion
            }

            if (dsRRDetails.Tables[2].Rows.Count != 0)
            {
                #region Loading Retention Details

                DataRow row1 = dsRRDetails.Tables[2].Rows[0];

                mode = ((row1[&quot;RetentionCeilingMode&quot;].ToString2() == &quot;False&quot; ||
                         row1[&quot;RetentionCeilingMode&quot;].ToString2() == &quot;0&quot;)
                            ? WOConstants.MODE_AMOUNT
                            : WOConstants.MODE_PERCENTAGE);
                lblRetentnCeiling.Text = (mode == WOConstants.MODE_PERCENTAGE
                                              ? &quot;Retention Ceiling Percentage :&quot;
                                              : &quot;Retention Ceiling Amount in &quot; +
                                                LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT,
                                                                                      _ContractID.ToString2()) + &quot; :&quot;);
                lblRetentionPercentage.Text =
                    (row1[&quot;RetentionPercentage&quot;].ToString2() == &quot;&quot; ? &quot;0&quot; : row1[&quot;RetentionPercentage&quot;]).ToDecimal2().
                        ToString(AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE, CultureInfo.CurrentCulture);
                lblRetentionCeilng.Text =
                    (row1[&quot;RetentionCeilingValue&quot;].ToString2() == &quot;&quot; ? &quot;0&quot; : row1[&quot;RetentionCeilingValue&quot;]).ToDecimal2()
                        .ToString(
                            mode == WOConstants.MODE_PERCENTAGE ? AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE : AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                            CultureInfo.CurrentCulture);
                lblRetentionRule.Text = row1[&quot;RetentionRuleName&quot;].ToString2();

                #endregion
            }

            #endregion

            if ((WODTO.Status == WOConstants.STAGE_ISSUED ||
                 WOManager.Instance.IsWorkFlowInProgress(WODTO.WorkOrderID.ToInt32_2())) &amp;&amp;
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Enabled = false;
        }

        private void BindActivitiesData()
        {
            string currency = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
            DataTable dsActivities = WOManager.Instance.GetActivities(_WorkOrderID).Tables[0];

            uwgActivities.DisplayLayout.NoDataMessage = &quot;No items to display&quot;;

            uwgActivities.Height = Unit.Pixel(100);
            uwgActivities.DataSource = dsActivities;
            uwgActivities.DataBind();
            ColumnsCollection cols = uwgActivities.Columns;
            RowsCollection rows = uwgActivities.Rows;

            if (cols.Exists(&quot;SubItem&quot;))
                cols.FromKey(&quot;SubItem&quot;).Header.Caption = &quot;Sub Item&quot;;
            (new List&lt;string&gt; {&quot;LineNo&quot;, &quot;StandardItemNo&quot;, &quot;Description&quot;, &quot;SubItem&quot;}).ForEach(x =&gt;
                                                                                                  {
                                                                                                      if (cols.Exists(x))
                                                                                                      {
                                                                                                          if (
                                                                                                              dsActivities
                                                                                                                  .
                                                                                                                  Select
                                                                                                                  (x +
                                                                                                                   &quot; IS NOT NULL&quot;)
                                                                                                                  .
                                                                                                                  Length ==
                                                                                                              0)
                                                                                                              cols.
                                                                                                                  FromKey
                                                                                                                  (x).
                                                                                                                  Hidden
                                                                                                                  = true;
                                                                                                          else
                                                                                                          {
                                                                                                              //cols.FromKey(x).Format = Constants.FORMAT_QUANTITY;
                                                                                                              cols.
                                                                                                                  FromKey
                                                                                                                  (x).
                                                                                                                  Header
                                                                                                                  .Style
                                                                                                                  .
                                                                                                                  HorizontalAlign
                                                                                                                  =
                                                                                                                  cols.
                                                                                                                      FromKey
                                                                                                                      (x)
                                                                                                                      .
                                                                                                                      CellStyle
                                                                                                                      .
                                                                                                                      HorizontalAlign
                                                                                                                  =
                                                                                                                  HorizontalAlign
                                                                                                                      .
                                                                                                                      Right;
                                                                                                              cols.
                                                                                                                  FromKey
                                                                                                                  (x).
                                                                                                                  CellStyle
                                                                                                                  .
                                                                                                                  Padding
                                                                                                                  .Right
                                                                                                                  =
                                                                                                                  cols.
                                                                                                                      FromKey
                                                                                                                      (x)
                                                                                                                      .
                                                                                                                      Header
                                                                                                                      .
                                                                                                                      Style
                                                                                                                      .
                                                                                                                      Padding
                                                                                                                      .
                                                                                                                      Right
                                                                                                                  =
                                                                                                                  new Unit
                                                                                                                      (&quot;2px&quot;);
                                                                                                          }
                                                                                                      }
                                                                                                  });

            (new List&lt;string&gt; {&quot;Number&quot;, &quot;Length&quot;, &quot;Width&quot;, &quot;Height&quot;}).ForEach(
                x =&gt; { if (cols.Exists(x)) cols.FromKey(x).Hidden = true; });

            if (cols.Exists(&quot;ContractUnitCost&quot;))
                cols.FromKey(&quot;ContractUnitCost&quot;).Header.Caption = &quot;Estimated Rate (&quot; + currency + &quot;)&quot;;
            if (cols.Exists(&quot;Amount&quot;))
                cols.FromKey(&quot;Amount&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
            if (cols.Exists(&quot;Quantity&quot;))
                cols.FromKey(&quot;Quantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
            (new List&lt;string&gt; {&quot;ContractUnitCost&quot;, &quot;Amount&quot;, &quot;Quantity&quot;}).ForEach(x =&gt;
                                                                                      {
                                                                                          if (cols.Exists(x))
                                                                                          {
                                                                                              cols.FromKey(x).Header.
                                                                                                  Style.HorizontalAlign
                                                                                                  =
                                                                                                  cols.FromKey(x).
                                                                                                      CellStyle.
                                                                                                      HorizontalAlign =
                                                                                                  HorizontalAlign.Right;
                                                                                              cols.FromKey(x).CellStyle.
                                                                                                  Padding.Right =
                                                                                                  cols.FromKey(x).Header
                                                                                                      .Style.Padding.
                                                                                                      Right =
                                                                                                  new Unit(&quot;2px&quot;);
                                                                                          }
                                                                                      });
            (new List&lt;string&gt;
                 {
                     &quot;AvailQty&quot;,
                     &quot;Amt&quot;,
                     &quot;UnitCost&quot;,
                     &quot;ActivityID&quot;,
                     &quot;ActID&quot;,
                     &quot;WorkOrderID&quot;,
                     &quot;ActivityName&quot;,
                     &quot;WOQuantity&quot;,
                     &quot;ItemID&quot;,
                     &quot;SubItemID&quot;,
                     &quot;UnitID&quot;,
                     &quot;To&quot;,
                     &quot;AssociatedResourceID&quot;,
                     &quot;PreVerActID&quot;,
                     &quot;ItemCompletedQuantity&quot;,
                     &quot;CompletedQuantity&quot;
                 }).ForEach(x =&gt;
                                {
                                    if (cols.Exists(x))
                                        cols.FromKey(x).Hidden = true;
                                });

            decimal totalAmt = 0;
            foreach (DataRow row in dsActivities.Rows)
            {
                totalAmt += row[&quot;Amount&quot;].ToDecimal2();
            }
            hdnTotalAmt.Value = totalAmt.ToString2();
            if (cols.Exists(&quot;Posted Quantity/MBook Quantity&quot;))
                cols.FromKey(&quot;Posted Quantity/MBook Quantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
            if (cols.Exists(&quot;BilledQuantity&quot;))
            {
                cols.FromKey(&quot;BilledQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;BilledQuantity&quot;).Header.Caption = &quot;Total Billed Quantity&quot;;
            }
            if (cols.Exists(&quot;CertifiedQuantity&quot;))
            {
                cols.FromKey(&quot;CertifiedQuantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
                cols.FromKey(&quot;CertifiedQuantity&quot;).Header.Caption = &quot;Total Certified Quantity&quot;;
            }
            if (cols.Exists(&quot;IsShortClose&quot;)) cols.FromKey(&quot;IsShortClose&quot;).Hidden = true;

            if (cols.Exists(&quot;Activity Description&quot;))
            {
                cols.FromKey(&quot;Activity Description&quot;).Move(cols.FromKey(&quot;Activity Name&quot;).Index + 1);
                cols.FromKey(&quot;Activity Description&quot;).Width = 125;
            }

            if (cols.Exists(&quot;Activity Name&quot;))
            {
                cols.FromKey(&quot;Activity Name&quot;).Width = 125;
            }
        }

        private void BindQuotationData()
        {
            DataSet dsQuotations = WOManager.Instance.GetQuotations(_WorkOrderID);

            uwgQuotations.DisplayLayout.NoDataMessage = &quot;No items to display&quot;;

            uwgQuotations.Height = Unit.Pixel(100);
            uwgQuotations.DataSource = dsQuotations.Tables[0];
            uwgQuotations.DataBind();

            ColumnsCollection cols = uwgQuotations.Columns;
            cols.FromKey(&quot;QuotationID&quot;).Hidden = true;
            cols.FromKey(&quot;ContractorID&quot;).Hidden = true;

            cols.FromKey(&quot;TotalAmount&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
            cols.FromKey(&quot;TotalAmount&quot;).Header.Caption = &quot;Amount&quot;;


            cols.FromKey(&quot;Date&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_DATE;

            cols.FromKey(&quot;% Over Low Bid&quot;).Format =
                cols.FromKey(&quot;% Over Contract&quot;).Format = &quot;##0.00&quot;;

            cols.FromKey(&quot;TotalAmount&quot;).CellStyle.HorizontalAlign =
                cols.FromKey(&quot;% Over Low Bid&quot;).CellStyle.HorizontalAlign =
                cols.FromKey(&quot;% Over Contract&quot;).CellStyle.HorizontalAlign = HorizontalAlign.Right;

            cols.FromKey(&quot;TotalAmount&quot;).Header.Style.HorizontalAlign =
                cols.FromKey(&quot;% Over Low Bid&quot;).Header.Style.HorizontalAlign =
                cols.FromKey(&quot;% Over Contract&quot;).Header.Style.HorizontalAlign = HorizontalAlign.Right;

            cols.FromKey(&quot;TotalAmount&quot;).CellStyle.Padding.Right =
                cols.FromKey(&quot;% Over Low Bid&quot;).CellStyle.Padding.Right =
                cols.FromKey(&quot;% Over Contract&quot;).CellStyle.Padding.Right =
                cols.FromKey(&quot;TotalAmount&quot;).Header.Style.Padding.Right =
                cols.FromKey(&quot;% Over Low Bid&quot;).Header.Style.Padding.Right =
                cols.FromKey(&quot;% Over Contract&quot;).Header.Style.Padding.Right = new Unit(&quot;2px&quot;);

            RowsCollection rows = uwgQuotations.Rows;
            for (int i = 0; i &lt; rows.Count; i++)
            {
                int status = rows[i].Cells.FromKey(&quot;Status&quot;).Value.ToInt32_2();
                rows[i].Cells.FromKey(&quot;Status&quot;).Style.BackgroundImage = (status == WOConstants.QUOTATION_STAGE_REJECTED)
                                                                            ? &quot;../../Images/toolbar/IcnUnapprove.gif&quot;
                                                                            : (status ==
                                                                               WOConstants.QUOTATION_STAGE_AWARDED)
                                                                                  ? &quot;../../Images/toolbar/IcnAward.gif&quot;
                                                                                  : null;

                rows[i].Cells.FromKey(&quot;Status&quot;).Style.Padding.Left = new Unit(&quot;16px&quot;, CultureInfo.CurrentCulture);
                rows[i].Cells.FromKey(&quot;Status&quot;).Style.CustomRules = &quot;background-repeat: no-repeat&quot;;
                rows[i].Cells.FromKey(&quot;Status&quot;).Value = (status == WOConstants.QUOTATION_STAGE_REJECTED)
                                                            ? &quot;Rejected&quot;
                                                            : (status == WOConstants.QUOTATION_STAGE_AWARDED)
                                                                  ? &quot;Awarded&quot;
                                                                  : &quot;Received&quot;;
            }

            if (!(dsQuotations.Tables[0].Select(&quot;Status = 3&quot;).Length == 0))
            {
                string currency = LocalizationManager.GetString(KeyConstants.LOC_CURRENCY_SYMBOL);
                uwgActivities.Columns.FromKey(&quot;ContractUnitCost&quot;).Hidden = false;
                uwgActivities.Columns.FromKey(&quot;ContractUnitCost&quot;).Header.Caption = &quot;Estimated Rate (&quot; + currency + &quot;)&quot;;
                uwgActivities.Columns.FromKey(&quot;UnitCost&quot;).Header.Caption = &quot;WO Rate (&quot; + currency + &quot;)&quot;;
                uwgActivities.Columns.FromKey(&quot;UnitCost&quot;).Hidden = false;
            }
        }

        protected void lnkEdit_Click(object sender, EventArgs e)
        {
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null &amp;&amp; MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Enabled)
            {
                WorkOrderDTO WODTO = WOManager.Instance.GetWorkOrderDetails(_WorkOrderID);
                if (WODTO == null)
                {
                    lblErr.Text = &quot;The work order instance may have been deleted by another user.&quot;;
                    return;
                }


                Response.Redirect(
                    &quot;NewACTIWorkOrder.aspx?Type=E&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&amp;WOID={2}&amp;ParentContext=CONTMGT&quot;.Format2(
                        Request[WOConstants.QRY_PROJECTID], Request[WOConstants.QRY_CONTRACTID],
                        Request[WOConstants.QRY_WORKORDERID]), false);
            }
        }

        protected void btnBack_Click(object sender, EventArgs e)
        {
            Response.Redirect(
                &quot;~/Common/BrixListPage.aspx?context=WORKORD&amp;PID={0}&amp;ContractID={1}&amp;ParentID={1}&quot;.Format2(
                    Request[WOConstants.QRY_PROJECTID], Request[WOConstants.QRY_CONTRACTID]), false);
        }

        protected void lnkView_Click(object sender, EventArgs e)
        {
            if (hdnQuotationID == null || string.IsNullOrEmpty(hdnQuotationID.Value))
                return;

            DataSet ds = WOManager.Instance.GetQuotation(hdnQuotationID.Value.ToInt32_2(), _WorkOrderID);
            if (ds.Tables[0].Rows.Count == 0)
                return;

            DataRow dr = ds.Tables[0].Rows[0];
            lblQuotContractor.Text = dr[&quot;Contractor&quot;].ToString2();
            lblQuotDate.Text = dr[&quot;Date&quot;].ToDateTime_MWCulture().ToString(AMP3ApplicationSettings.Instance.FORMAT_DATE, CultureInfo.CurrentCulture);
            lblQuotTotal.Text = dr[&quot;TotalAmount&quot;].ToDecimal2().ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT,
                                                                        CultureInfo.CurrentCulture);
            txtQNotes.Text = dr[&quot;Notes&quot;].ToString2();

            uwgQuotItems.DataSource = ds.Tables[1];
            uwgQuotItems.DataBind();
            SetQuotationItemsGridColumns();
            trQuotTemplate.Style.Add(&quot;display&quot;, &quot;block&quot;);

            if ((dr[&quot;WOStatus&quot;].ToInt32_2() == WOConstants.STAGE_ISSUED ||
                 WOManager.Instance.IsWorkFlowInProgress(_WorkOrderID)) &amp;&amp;
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Enabled = false;

            hdnVisibleTab.Value = WOConstants.TAB_QUOT;
        }

        protected void lnkPrint_Click(object sender, EventArgs e)
        {
            if (MainToolBar.GetMenuReference(&quot;lnkPrint&quot;) != null &amp;&amp; MainToolBar.GetMenuReference(&quot;lnkPrint&quot;).Enabled)
            {
                Response.Redirect(
                    &quot;~/Common/BrixReportPage.aspx?Context=ACTI-WO&amp;MODID=ACTI-WO&amp;ParentID={0}&amp;WOID={1}&amp;code=WOR&amp;PID={2}&amp;ParentModuleID=CONTMGT&quot;
                        .Format2(_ContractID, _WorkOrderID, Request[&quot;PID&quot;]), false);
            }

            return;
        }

        private void SetQuotationItemsGridColumns()
        {
            uwgQuotItems.DisplayLayout.AllowSortingDefault = AllowSorting.OnClient;
            uwgQuotItems.DisplayLayout.NoDataMessage = &quot;No data to display&quot;;
            ColumnsCollection cols = uwgQuotItems.Columns;
            if (cols.Exists(&quot;ActivityName&quot;))
                cols.FromKey(&quot;ActivityName&quot;).Header.Caption = &quot;Activity Name&quot;;
            if (cols.Exists(&quot;Quantity&quot;))
                cols.FromKey(&quot;Quantity&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_QUANTITY;
            if (cols.Exists(&quot;Amount&quot;))
                cols.FromKey(&quot;Amount&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
            if (cols.Exists(&quot;Rate&quot;))
                cols.FromKey(&quot;Rate&quot;).Format = AMP3ApplicationSettings.Instance.FORMAT_UNIT_PRICE;
            (new List&lt;string&gt; {&quot;Rate&quot;, &quot;Amount&quot;, &quot;Quantity&quot;}).ForEach(x =&gt;
                                                                          {
                                                                              if (cols.Exists(x))
                                                                              {
                                                                                  cols.FromKey(x).Header.Style.
                                                                                      HorizontalAlign =
                                                                                      cols.FromKey(x).CellStyle.
                                                                                          HorizontalAlign =
                                                                                      HorizontalAlign.Right;
                                                                                  cols.FromKey(x).CellStyle.Padding.
                                                                                      Right =
                                                                                      cols.FromKey(x).Header.Style.
                                                                                          Padding.Right =
                                                                                      new Unit(&quot;2px&quot;);
                                                                              }
                                                                          });
            (new List&lt;string&gt;
                 {
                     &quot;ContractUnitCost&quot;,
                     &quot;UnitCost&quot;,
                     &quot;ActivityID&quot;,
                     &quot;WorkOrderID&quot;,
                     &quot;QuotationID&quot;,
                     &quot;Number&quot;,
                     &quot;Length&quot;,
                     &quot;Width&quot;,
                     &quot;Height&quot;
                 }).ForEach(x =&gt;
                                {
                                    if (cols.Exists(x))
                                        cols.FromKey(x).Hidden = true;
                                });
        }

        protected override void CreateChildControls()
        {
            var menus = new MenuArray();
            var featurelist = (List&lt;string&gt;) Context.Items[Constants.MODULE_PERMISSIONS];

            if (featurelist.Contains(WOConstants.MODFEAT_EDIT))
                menus.Add(new BrixMenu(&quot;lnkEdit&quot;, &quot;Edit&quot;, &quot;Icn_Edit.png&quot;, 55));

            //hiding this report as new sql reports have been created for this
            //if (featurelist.Contains(WOConstants.MODFEAT_VIEW))
            //    menus.Add(new BrixMenu(&quot;lnkPrint&quot;, &quot;Report&quot;, &quot;Icn_Reports.png&quot;, 55));

            menus.Add(new BrixMenu(&quot;lnkBack&quot;, &quot;Back&quot;, &quot;Icn_Back.png&quot;, 55));
            CreateToolBarMenu(menus, null);
        }

        protected override void CustomizeToolBar()
        {
            var featurelist = (List&lt;string&gt;) Context.Items[Constants.MODULE_PERMISSIONS];
            if (MainToolBar.GetMenuReference(&quot;lnkEdit&quot;) != null)
            {
                if (!featurelist.Contains(WOConstants.MODFEAT_EDIT))
                    MainToolBar.DisableMenu(&quot;lnkEdit&quot;);
                MainToolBar.GetMenuReference(&quot;lnkEdit&quot;).Click += lnkEdit_Click;
            }

            if (MainToolBar.GetMenuReference(&quot;lnkPrint&quot;) != null)
            {
                if (!featurelist.Contains(WOConstants.MODFEAT_VIEW))
                    MainToolBar.DisableMenu(&quot;lnkPrint&quot;);
                MainToolBar.GetMenuReference(&quot;lnkPrint&quot;).Click += lnkPrint_Click;
            }

            if (MainToolBar.GetMenuReference(&quot;lnkBack&quot;) != null)
                MainToolBar.GetMenuReference(&quot;lnkBack&quot;).Click += btnBack_Click;
        }

        #region Prepayment rule and retention rule association

        private void FormatPrepaymentTypesGrid(string mode)
        {
            ColumnsCollection cols = uwgPrepaymentTypes.Columns;
            uwgPrepaymentTypes.Width = 500;

            if (cols.Exists(WOConstants.HEADING_SL_NO))
                cols.FromKey(WOConstants.HEADING_SL_NO).Width = 40;

            if (cols.Exists(WOConstants.HEADING_PREPAYMENTVALUE))
            {
                cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Header.Caption = (mode == WOConstants.MODE_AMOUNT
                                                                                        ? &quot;Pre-payment Amount&quot;
                                                                                        : &quot;Pre-payment Percentage&quot;);
                cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Width = 125;
                cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Header.Caption =
                    cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Header.Caption + &quot; &quot; +
                    (mode == WOConstants.MODE_PERCENTAGE
                         ? &quot;&quot;
                         : &quot; in &quot; +
                           LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2()));
            }
            if (cols.Exists(WOConstants.HEADING_RECOVERYVALUE))
            {
                cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Header.Caption = (mode == WOConstants.MODE_AMOUNT
                                                                                      ? &quot;Recovery Amount&quot;
                                                                                      : &quot;Recovery Percentage&quot;);
                cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Width = 125;
                cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Header.Caption =
                    cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Header.Caption + &quot; &quot; +
                    (mode == WOConstants.MODE_PERCENTAGE
                         ? &quot;&quot;
                         : &quot; in &quot; +
                           LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2()));
            }
            if (cols.Exists(WOConstants.HEADING_RABNO))
            {
                cols.FromKey(WOConstants.HEADING_RABNO).Header.Caption = &quot;From RA Bill&quot;;
                cols.FromKey(WOConstants.HEADING_RABNO).Width = 100;
            }
            if (cols.Exists(WOConstants.HEADING_RV_IN_RAB))
            {
                cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Width = 125;
                cols.FromKey(WOConstants.HEADING_RV_IN_RAB).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Header.Caption =
                    cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Header.Caption + &quot; &quot; + &quot; in &quot; +
                    LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2());
            }

            if (cols.Exists(WOConstants.HEADING_AMOUNT_PAID))
            {
                cols.FromKey(WOConstants.HEADING_AMOUNT_PAID).Width = 100;
                cols.FromKey(WOConstants.HEADING_AMOUNT_PAID).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_AMOUNT_PAID).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_AMOUNT_PAID).Header.Caption =
                    cols.FromKey(WOConstants.HEADING_AMOUNT_PAID).Header.Caption + &quot; &quot; + &quot; in &quot; +
                    LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2());
            }

            if (cols.Exists(WOConstants.HEADING_RECOVERED_AMOUNT))
            {
                cols.FromKey(WOConstants.HEADING_RECOVERED_AMOUNT).Width = 100;
                cols.FromKey(WOConstants.HEADING_RECOVERED_AMOUNT).CellStyle.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RECOVERED_AMOUNT).Header.Style.HorizontalAlign = HorizontalAlign.Right;
                cols.FromKey(WOConstants.HEADING_RECOVERED_AMOUNT).Header.Caption =
                    cols.FromKey(WOConstants.HEADING_RECOVERED_AMOUNT).Header.Caption + &quot; &quot; + &quot; in &quot; +
                    LocalizationManager.GetModuleCurrency(Constants.MODID_CONTMGT, _ContractID.ToString2());
            }

            if (cols.Exists(&quot;PrepaymentTypeID&quot;))
            {
                cols.FromKey(&quot;PrepaymentTypeID&quot;).Hidden = true;
                if (cols.Exists(WOConstants.HEADING_RV_IN_RAB))
                    cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Move(5);
            }
            else if (cols.Exists(WOConstants.HEADING_RV_IN_RAB))
                cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Move(4);

            if (cols.Exists(&quot;PrepaymentType&quot;))
            {
                cols.FromKey(&quot;PrepaymentType&quot;).Header.Caption = WOConstants.HEADING_PREPAYMENTNAME;
                cols.FromKey(&quot;PrepaymentType&quot;).Width = 125;
            }

            if (cols.Exists(WOConstants.HEADING_PREPAYMENTNAME))
            {
                cols.FromKey(WOConstants.HEADING_PREPAYMENTNAME).Header.Caption = WOConstants.HEADING_PREPAYMENTNAME;
                cols.FromKey(WOConstants.HEADING_PREPAYMENTNAME).Width = 125;
            }

            if (mode == WOConstants.MODE_PERCENTAGE)
            {
                //Percentage Based Prepayment rule
                if (cols.Exists(WOConstants.HEADING_RV_IN_RAB))
                {
                    cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Hidden = false;
                    cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
                }

                if (cols.Exists(WOConstants.HEADING_PREPAYMENTVALUE))
                    cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Format = AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE;

                if (cols.Exists(WOConstants.HEADING_RECOVERYVALUE))
                    cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Format = AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE;
            }
            else if (mode == WOConstants.MODE_AMOUNT)
            {
                //Amount Based Prepayment rule
                if (cols.Exists(WOConstants.HEADING_RV_IN_RAB))
                    cols.FromKey(WOConstants.HEADING_RV_IN_RAB).Hidden = true;

                if (cols.Exists(WOConstants.HEADING_PREPAYMENTVALUE))
                    cols.FromKey(WOConstants.HEADING_PREPAYMENTVALUE).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;

                if (cols.Exists(WOConstants.HEADING_RECOVERYVALUE))
                    cols.FromKey(WOConstants.HEADING_RECOVERYVALUE).Format = AMP3ApplicationSettings.Instance.FORMAT_AMOUNT;
            }

            uwgPrepaymentTypes.DisplayLayout.AllowSortingDefault = AllowSorting.OnClient;
        }

        private decimal CalculateRecoveryValueInEachRAB(string RecoveryValue, string prepaymentValue, string mode)
        {
            string woAmt = hdnTotalAmt.Value;
            decimal rabRecoveryValue = 0;

            if (mode == WOConstants.MODE_PERCENTAGE)
            {
                decimal prepaymentAmt = decimal.Parse(prepaymentValue)/100*decimal.Parse(woAmt);
                rabRecoveryValue = (decimal.Parse(RecoveryValue)/100*prepaymentAmt);
            }
            return rabRecoveryValue;
        }

        private void CalculateAmountOrPercentage(string mode)
        {
            try
            {
                if (uwgActivities.Rows.Count &gt; 0)
                {
                    if (mode == WOConstants.MODE_PERCENTAGE)
                        lblMaxAmount.Text =
                            (decimal.Parse(lblMaxPercentage.Text)/100*decimal.Parse(hdnTotalAmt.Value)).ToDecimal2().
                                ToString(AMP3ApplicationSettings.Instance.FORMAT_PERCENTAGE, CultureInfo.CurrentCulture);
                    else
                        lblMaxPercentage.Text =
                            (decimal.Parse(lblMaxAmount.Text)/decimal.Parse(hdnTotalAmt.Value)*100).ToDecimal2().
                                ToString(AMP3ApplicationSettings.Instance.FORMAT_AMOUNT, CultureInfo.CurrentCulture);
                }
            }
            catch
            {
            }
        }

        #endregion
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[35,9,35,10,0],[36,13,36,138,0],[37,13,37,72,0],[38,13,38,28,0],[39,9,39,10,0],[42,9,42,10,0],[43,13,43,110,0],[44,13,44,14,0],[45,17,45,57,0],[46,13,46,14,0],[47,9,47,10,0],[50,9,50,10,0],[51,13,51,35,0],[52,13,52,49,0],[53,13,53,87,0],[55,13,55,89,0],[56,13,56,52,0],[58,13,58,90,0],[59,13,59,65,0],[60,13,60,14,0],[62,17,65,110,0],[66,17,66,108,0],[67,17,67,24,0],[71,13,71,29,0],[72,13,72,14,0],[73,17,73,48,0],[74,17,74,58,0],[75,17,75,101,0],[76,17,76,18,0],[77,21,77,64,0],[78,21,80,112,0],[81,17,81,18,0],[82,17,82,67,0],[83,17,83,63,0],[84,17,84,45,0],[85,13,85,14,0],[86,13,86,120,0],[87,9,87,10,0],[90,9,90,10,0],[91,13,92,118,0],[93,13,93,31,0],[94,13,94,14,0],[95,17,99,132,0],[100,17,100,24,0],[103,13,103,46,0],[104,13,104,55,0],[105,13,105,58,0],[107,13,107,133,0],[108,13,108,51,0],[109,13,109,46,0],[110,13,110,41,0],[111,13,111,47,0],[112,13,112,51,0],[113,13,113,53,0],[114,13,114,55,0],[115,13,115,49,0],[117,13,117,77,0],[119,13,119,58,0],[120,13,120,56,0],[121,13,121,50,0],[123,13,123,88,0],[125,13,125,132,0],[126,13,126,128,0],[128,13,139,60,0],[141,13,141,53,0],[142,13,142,136,0],[145,13,145,113,0],[146,13,146,14,0],[147,17,147,59,0],[148,17,148,142,0],[150,17,150,117,0],[151,17,151,18,0],[152,21,152,59,0],[153,21,153,142,0],[154,17,154,18,0],[156,17,156,18,0],[157,21,157,48,0],[158,17,158,18,0],[159,13,159,14,0],[161,13,161,14,0],[162,17,162,46,0],[163,17,163,44,0],[164,13,164,14,0],[165,13,165,34,0],[166,13,166,33,0],[168,13,169,107,0],[173,13,173,112,0],[177,13,177,40,0],[178,13,178,96,0],[179,13,179,14,0],[182,17,182,61,0],[184,17,186,60,0],[187,17,190,135,0],[191,17,194,131,0],[195,17,195,78,0],[201,17,201,59,0],[202,17,202,68,0],[203,17,205,88,0],[206,17,206,24,0],[206,26,206,36,0],[206,37,206,39,0],[206,40,206,52,0],[207,17,207,18,0],[208,21,211,137,0],[212,21,212,22,0],[213,21,215,42,0],[216,21,219,42,0],[220,17,220,18,0],[221,17,221,41,0],[222,17,222,57,0],[223,17,223,47,0],[225,17,225,49,0],[227,17,227,51,0],[230,13,230,14,0],[232,13,232,55,0],[233,13,233,14,0],[236,17,236,62,0],[238,17,241,60,0],[242,17,246,120,0],[247,17,249,114,0],[250,17,254,57,0],[255,17,255,79,0],[258,13,258,14,0],[262,13,264,65,0],[265,17,265,73,0],[266,9,266,10,0],[269,9,269,10,0],[270,13,270,95,0],[271,13,271,95,0],[273,13,273,79,0],[275,13,275,52,0],[276,13,276,53,0],[277,13,277,38,0],[278,13,278,60,0],[279,13,279,54,0],[281,13,281,40,0],[282,17,282,69,0],[283,13,284,99,0],[284,99,284,100,0],[284,100,285,103,0],[285,103,285,122,0],[285,122,286,103,0],[286,103,286,104,0],[286,104,287,107,0],[287,107,295,113,0],[295,113,296,111,0],[296,111,300,122,0],[300,122,302,107,0],[302,107,302,108,0],[302,108,304,111,0],[304,111,322,125,0],[322,125,323,111,0],[323,111,344,127,0],[344,127,345,107,0],[345,107,345,108,0],[345,108,346,103,0],[346,103,346,104,0],[346,104,347,99,0],[347,99,347,100,0],[347,100,347,102,0],[283,13,347,102,0],[349,13,350,22,0],[350,22,350,23,0],[350,23,350,24,0],[350,24,350,43,0],[350,43,350,44,0],[350,44,350,74,0],[350,74,350,75,0],[350,75,350,76,0],[350,76,350,78,0],[349,13,350,78,0],[352,13,352,49,0],[353,17,353,103,0],[354,13,354,39,0],[355,17,355,96,0],[356,13,356,41,0],[357,17,357,100,0],[358,13,359,87,0],[359,87,359,88,0],[359,88,360,91,0],[360,91,360,110,0],[360,110,361,91,0],[361,91,361,92,0],[361,92,362,95,0],[362,95,368,121,0],[368,121,369,95,0],[369,95,374,115,0],[374,115,375,91,0],[375,91,375,92,0],[375,92,376,87,0],[376,87,376,88,0],[376,88,376,90,0],[358,13,376,90,0],[377,13,396,33,0],[396,33,396,34,0],[396,34,397,37,0],[397,37,397,56,0],[397,56,398,41,0],[398,41,398,71,0],[398,71,399,33,0],[399,33,399,34,0],[399,34,399,36,0],[377,13,399,36,0],[401,13,401,34,0],[402,13,402,20,0],[402,22,402,33,0],[402,34,402,36,0],[402,37,402,54,0],[403,13,403,14,0],[404,17,404,56,0],[405,13,405,14,0],[406,13,406,54,0],[407,13,407,63,0],[408,17,408,122,0],[409,13,409,47,0],[410,13,410,14,0],[411,17,411,106,0],[412,17,412,89,0],[413,13,413,14,0],[414,13,414,50,0],[415,13,415,14,0],[416,17,416,109,0],[417,17,417,95,0],[418,13,418,14,0],[419,13,419,45,0],[419,46,419,89,0],[421,13,421,53,0],[422,13,422,14,0],[423,17,423,100,0],[424,17,424,66,0],[425,13,425,14,0],[427,13,427,46,0],[428,13,428,14,0],[429,17,429,59,0],[430,13,430,14,0],[431,9,431,10,0],[434,9,434,10,0],[435,13,435,83,0],[437,13,437,79,0],[439,13,439,52,0],[440,13,440,63,0],[441,13,441,38,0],[443,13,443,60,0],[444,13,444,55,0],[445,13,445,56,0],[447,13,447,97,0],[448,13,448,67,0],[451,13,451,88,0],[453,13,454,67,0],[456,13,458,99,0],[460,13,462,102,0],[464,13,469,94,0],[471,13,471,54,0],[472,18,472,27,0],[472,29,472,43,0],[472,45,472,48,0],[473,13,473,14,0],[474,17,474,80,0],[475,17,480,90,0],[482,17,482,115,0],[483,17,483,100,0],[484,17,488,80,0],[489,13,489,14,0],[491,13,491,76,0],[492,13,492,14,0],[493,17,493,99,0],[494,17,494,82,0],[495,17,495,120,0],[496,17,496,105,0],[497,17,497,74,0],[498,13,498,14,0],[499,9,499,10,0],[502,9,502,10,0],[503,13,503,116,0],[504,13,504,14,0],[505,17,505,91,0],[506,17,506,35,0],[507,17,507,18,0],[508,21,508,100,0],[509,21,509,28,0],[513,17,516,71,0],[517,13,517,14,0],[518,9,518,10,0],[521,9,521,10,0],[522,13,524,102,0],[525,9,525,10,0],[528,9,528,10,0],[529,13,529,86,0],[530,17,530,24,0],[532,13,532,106,0],[533,13,533,46,0],[534,17,534,24,0],[536,13,536,47,0],[537,13,537,67,0],[538,13,538,149,0],[539,13,540,101,0],[541,13,541,54,0],[543,13,543,52,0],[544,13,544,37,0],[545,13,545,44,0],[546,13,546,58,0],[548,13,550,65,0],[551,17,551,73,0],[553,13,553,56,0],[554,9,554,10,0],[557,9,557,10,0],[558,13,558,118,0],[559,13,559,14,0],[560,17,562,85,0],[563,13,563,14,0],[565,13,565,20,0],[566,9,566,10,0],[569,9,569,10,0],[570,13,570,84,0],[571,13,571,77,0],[572,13,572,59,0],[573,13,573,45,0],[574,17,574,79,0],[575,13,575,41,0],[576,17,576,100,0],[577,13,577,39,0],[578,17,578,96,0],[579,13,579,37,0],[580,17,580,98,0],[581,13,582,75,0],[582,75,582,76,0],[582,76,583,79,0],[583,79,583,98,0],[583,98,584,79,0],[584,79,584,80,0],[584,80,585,83,0],[585,83,589,109,0],[589,109,590,83,0],[590,83,594,103,0],[594,103,595,79,0],[595,79,595,80,0],[595,80,596,75,0],[596,75,596,76,0],[596,76,596,78,0],[581,13,596,78,0],[597,13,609,33,0],[609,33,609,34,0],[609,34,610,37,0],[610,37,610,56,0],[610,56,611,41,0],[611,41,611,71,0],[611,71,612,33,0],[612,33,612,34,0],[612,34,612,36,0],[597,13,612,36,0],[613,9,613,10,0],[616,9,616,10,0],[617,13,617,41,0],[618,13,618,90,0],[620,13,620,64,0],[621,17,621,80,0],[627,13,627,76,0],[628,13,628,44,0],[629,9,629,10,0],[632,9,632,10,0],[633,13,633,90,0],[634,13,634,65,0],[635,13,635,14,0],[636,17,636,69,0],[637,21,637,56,0],[638,17,638,80,0],[639,13,639,14,0],[641,13,641,66,0],[642,13,642,14,0],[643,17,643,69,0],[644,21,644,57,0],[645,17,645,82,0],[646,13,646,14,0],[648,13,648,65,0],[649,17,649,80,0],[650,9,650,10,0],[655,9,655,10,0],[656,13,656,65,0],[657,13,657,44,0],[659,13,659,56,0],[660,17,660,68,0],[662,13,662,66,0],[663,13,663,14,0],[664,17,666,117,0],[667,17,667,79,0],[668,17,668,117,0],[669,17,669,120,0],[670,17,675,117,0],[676,13,676,14,0],[677,13,677,64,0],[678,13,678,14,0],[679,17,681,112,0],[682,17,682,77,0],[683,17,683,115,0],[684,17,684,118,0],[685,17,690,117,0],[691,13,691,14,0],[692,13,692,56,0],[693,13,693,14,0],[694,17,694,89,0],[695,17,695,69,0],[696,13,696,14,0],[697,13,697,60,0],[698,13,698,14,0],[699,17,699,73,0],[700,17,700,111,0],[701,17,701,114,0],[702,17,704,109,0],[705,13,705,14,0],[707,13,707,62,0],[708,13,708,14,0],[709,17,709,75,0],[710,17,710,113,0],[711,17,711,116,0],[712,17,714,109,0],[715,13,715,14,0],[717,13,717,67,0],[718,13,718,14,0],[719,17,719,80,0],[720,17,720,118,0],[721,17,721,121,0],[722,17,724,109,0],[725,13,725,14,0],[727,13,727,49,0],[728,13,728,14,0],[729,17,729,64,0],[730,17,730,64,0],[731,21,731,73,0],[732,13,732,14,0],[733,18,733,65,0],[734,17,734,69,0],[736,13,736,47,0],[737,13,737,14,0],[738,17,738,100,0],[739,17,739,60,0],[740,13,740,14,0],[742,13,742,65,0],[743,13,743,14,0],[744,17,744,118,0],[745,17,745,78,0],[746,13,746,14,0],[748,13,748,53,0],[749,13,749,14,0],[751,17,751,64,0],[752,17,752,18,0],[753,21,753,80,0],[754,21,754,121,0],[755,17,755,18,0],[757,17,757,70,0],[758,21,758,131,0],[760,17,760,68,0],[761,21,761,129,0],[762,13,762,14,0],[763,18,763,54,0],[764,13,764,14,0],[766,17,766,64,0],[767,21,767,79,0],[769,17,769,70,0],[770,21,770,127,0],[772,17,772,68,0],[773,21,773,125,0],[774,13,774,14,0],[776,13,776,90,0],[777,9,777,10,0],[780,9,780,10,0],[781,13,781,46,0],[782,13,782,42,0],[784,13,784,53,0],[785,13,785,14,0],[786,17,786,97,0],[787,17,787,85,0],[788,13,788,14,0],[789,13,789,37,0],[790,9,790,10,0],[793,9,793,10,0],[795,13,795,14,0],[796,17,796,50,0],[797,17,797,18,0],[798,21,798,61,0],[799,25,801,122,0],[803,25,805,118,0],[806,17,806,18,0],[807,13,807,14,0],[808,13,808,18,0],[809,13,809,14,0],[810,13,810,14,0],[811,9,811,10,0]]);
    </script>
  </body>
</html>