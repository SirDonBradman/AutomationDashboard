<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Masterworks\MasterworksRelease\.Net\Platform\Business Layer\Utility\UIHelper.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.Globalization;
using System.IO;
using System.Text;
using System.Web;
using System.Web.Configuration;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Xml;
using Aurigo.AMP3.Core.UserControls;
using Aurigo.AMP3.Logging;
using Aurigo.AMP3.Resources.MessageResources;
using Aurigo.Brix.Platform.CoreUtilities.Utility;
using Infragistics.WebUI.UltraWebGrid;
using Infragistics.WebUI.WebCombo;
using Infragistics.WebUI.WebSchedule;
using Telerik.Web.UI;
using Encoder = System.Drawing.Imaging.Encoder;
using CacheProvider;
using System.Collections.Generic;
using System.Collections.Specialized;
using Aurigo.Brix.Platform.BusinessLayer.Utility;
using System.Configuration;

namespace Aurigo.AMP3.Common
{
    public class UIHelper
    {
        [Serializable]
        private class XMLMessage
        {
            public bool IsValidMessage;
            public string MessageID;
            public string MessageName;
            public string MessageType;
            public string MessageText;
            public string MessageLevel;
        }

        #region UI Helper

        [Flags]
        public enum XmlCharEntity
        {
            CE_AMP = 1,
            CE_QUOT = 2,
            CE_APOS = 4,
            CE_LT = 8,
            CE_GT = 16,
            CE_ALL = 31
        }

        private const string IMGPATHCATEGORY = &quot;~/Images/IcnFolder.gif&quot;;

        public static bool IsOfflineMode
        {
            get
            {
                if (HttpContext.Current != null &amp;&amp; HttpContext.Current.Application[&quot;IsOfflineMode&quot;] != null)
                    return (bool)HttpContext.Current.Application[&quot;IsOfflineMode&quot;];
                else
                    return false;
            }
        }

        public static ArrayList GetMessageById(string id, string fileName)
        {

            XMLMessage message;
            var alList = new ArrayList();
            try
            {
                Dictionary&lt;string, XMLMessage&gt; messageDict = CacheBroker.Get&lt;Dictionary&lt;string, XMLMessage&gt;&gt;(fileName, regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
               
                // Fetch from Redis.
                if (messageDict == null || !messageDict.ContainsKey(id))
                {
                    XmlDocument doc = new XmlDocument();
                    doc.Load(HttpContext.Current.Server.MapPath(WebConfigurationManager.AppSettings[&quot;MSGSROOT&quot;] + fileName));

                    XmlNodeList list = doc.SelectNodes(&quot;//MSGS/MSG[@ID=&#39;&quot; + id + &quot;&#39;]&quot;);
                    bool bln = (list.Count &gt;= 1);

                    message = new XMLMessage()
                    {
                        IsValidMessage = bln,
                        MessageType = !bln ? null : (list[0] as XmlElement).GetAttribute(&quot;TYPE&quot;),
                        MessageLevel = !bln ? null : (list[0] as XmlElement).GetAttribute(&quot;LEVEL&quot;),
                        MessageText = !bln ? WebConfigurationManager.AppSettings[&quot;DEFMSG&quot;] : (list[0] as XmlElement).GetAttribute(&quot;TEXT&quot;),
                        MessageID = id
                    };

                    messageDict = new Dictionary&lt;string, XMLMessage&gt;();
                    messageDict.Add(id, message);

                    // Put into Redis.
                    CacheBroker.Put(fileName, messageDict, timeout: TimeSpan.FromMinutes(AMP3ApplicationSettings.Instance.SessionTimeout), regionName: AMP3ApplicationSettings.Instance.RedisRegionName);
                }
                else
                {
                    message = messageDict[id];
                }

                if (message != null)
                {
                    alList.Add(message.IsValidMessage);
                    alList.Add(!message.IsValidMessage ? null : message.MessageType);
                    alList.Add(!message.IsValidMessage ? null : message.MessageLevel);
                    alList.Add(!message.IsValidMessage ? WebConfigurationManager.AppSettings[&quot;DEFMSG&quot;] : message.MessageText);
                }
                else
                {
                    alList.Add(true);
                    alList.Add(null);
                    alList.Add(null);
                    alList.Add(WebConfigurationManager.AppSettings[&quot;DEFMSG&quot;]);
                }
            }
            catch (Exception ex)
            {
                alList.Add(true);
                alList.Add(null);
                alList.Add(null);
                alList.Add(WebConfigurationManager.AppSettings[&quot;DEFMSG&quot;]);

                Logger.Log(&quot;UIHelper&quot;, ex);
            }
            return alList;
        }

        public static void DisableRoleSelection(Page page)
        {
            if (page.Master.Master != null)
                (page.Master.Master.FindControl(&quot;ddlRole&quot;) as DropDownList).Enabled = false;
            else
                (page.Master.FindControl(&quot;ddlRole&quot;) as DropDownList).Enabled = false;
        }

        public static void EnableRoleSelection(Page page)
        {
            if (page.Master.Master != null)
                (page.Master.Master.FindControl(&quot;ddlRole&quot;) as DropDownList).Enabled = true;
            else
                (page.Master.FindControl(&quot;ddlRole&quot;) as DropDownList).Enabled = true;
        }

        public static string JavascriptEncode(string inputString)
        {
            return System.Web.HttpUtility.HtmlEncode(inputString);
        }

        public static string UrlEncode(string inputString)
        {
            return System.Web.HttpUtility.UrlEncode(inputString);
        }

        public static string GetSortOrder(string sortKey, GridSortOrder indicator)
        {
            string sortOrder = null;
            if (!string.IsNullOrEmpty(sortKey))
            {
                switch (indicator)
                {
                    case GridSortOrder.None:
                        if (sortKey.Contains(&quot;[&quot;) &amp;&amp; sortKey.Contains(&quot;]&quot;))
                            sortOrder = &quot;{0} DESC&quot;.Format2(sortKey);
                        else
                            sortOrder = &quot;[{0}] DESC&quot;.Format2(sortKey);
                        break;
                    case GridSortOrder.Ascending:
                        if (sortKey.Contains(&quot;[&quot;) &amp;&amp; sortKey.Contains(&quot;]&quot;))
                            sortOrder = &quot;{0} ASC&quot;.Format2(sortKey);
                        else
                            sortOrder = &quot;[{0}] ASC&quot;.Format2(sortKey);
                        break;
                    case GridSortOrder.Descending:
                        if (sortKey.Contains(&quot;[&quot;) &amp;&amp; sortKey.Contains(&quot;]&quot;))
                            sortOrder = &quot;{0} DESC&quot;.Format2(sortKey);
                        else
                            sortOrder = &quot;[{0}] DESC&quot;.Format2(sortKey);
                        break;
                    default:
                        break;
                }
            }
            return sortOrder;
        }

        public static SortIndicator GetSortIndicator(object sortOrder)
        {
            SortIndicator indicator = SortIndicator.None;
            if (sortOrder != null)
            {
                string sort = sortOrder.ToString2();
                if (sort.EndsWith(&quot; DESC&quot;))
                    indicator = SortIndicator.Descending;
                if (sort.EndsWith(&quot; ASC&quot;))
                    indicator = SortIndicator.Ascending;
            }
            return indicator;
        }

        public static void UpdateModuleStateBag(string key, object objState, HttpContext context)
        {
            Dictionary&lt;string, object&gt; listState;

            if ((listState = context.Session[&quot;STATE_MODULES&quot;] as Dictionary&lt;string, object&gt;) == null)
                context.Session[&quot;STATE_MODULES&quot;] = listState = new Dictionary&lt;string, object&gt;();

            if (listState.ContainsKey(key))
                listState[key] = objState;
            else
                listState.Add(key, objState);
        }

        public static object GetModuleFromStateBag(string key, HttpContext context)
        {
            Dictionary&lt;string, object&gt; listState;

            if (((listState = context.Session[&quot;STATE_MODULES&quot;] as Dictionary&lt;string, object&gt;) == null)
                || !listState.ContainsKey(key))
                return null;

            return listState[key];
        }

        public static void ClearModuleStateBag(HttpContext context)
        {
            context.Session[&quot;STATE_MODULES&quot;] = null;
        }

        public static void RedirectURL(string strMsg, string strBaseURL, string strRedirURL, HttpContext context)
        {
            context.Session.Add(&quot;REDIRECTMESSAGE&quot;, strMsg);

            if (!string.IsNullOrEmpty(strRedirURL) &amp;&amp;
                (strRedirURL.EndsWith(&quot;default.aspx&quot;, StringComparison.CurrentCultureIgnoreCase) ||
                 strRedirURL.Contains(Constants.URL_ENTERPRISE)))
                strRedirURL = string.Empty;
            else
                //When the user login in with a return url then the tree should be updated, hence adding nt=1 if its not there
                if (!string.IsNullOrEmpty(strRedirURL) &amp;&amp; !strRedirURL.Contains(&quot;nt=1&quot;))
                strRedirURL = strRedirURL + (strRedirURL.Contains(&quot;?&quot;) ? &quot;&amp;nt=1&quot; : &quot;?nt=1&quot;);

            context.Response.Redirect((strBaseURL +
                                       (!string.IsNullOrEmpty(strRedirURL)
                                           ? &quot;?ReturnURL=&quot; + strRedirURL
                                           : &quot;&quot; +
                                             (((strBaseURL ?? &quot;&quot;).Contains(&quot;?&quot;) || ((strRedirURL ?? &quot;&quot;).Contains(&quot;?&quot;)))
                                                 ? &quot;&amp;&quot;
                                                 : &quot;?&quot;) + &quot;Redirected=true&quot;)));
        }

        public static string ReplaceXMLCharEntities(string inputXml)
        {
            return String.IsNullOrEmpty(inputXml)
                ? String.Empty
                : inputXml.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace(&quot;\&quot;&quot;, &quot;&amp;quot;&quot;).Replace(&quot;&#39;&quot;, &quot;&amp;apos;&quot;).Replace(&quot;&lt;&quot;,
                    &quot;&amp;lt;&quot;).
                    Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);
        }

        public static string RevertXMLCharEntities(string inputXml)
        {
            return String.IsNullOrEmpty(inputXml)
                ? String.Empty
                : inputXml.Replace(&quot;&amp;gt;&quot;, &quot;&gt;&quot;).Replace(&quot;&amp;lt;&quot;, &quot;&lt;&quot;).Replace(&quot;&amp;apos;&quot;, &quot;&#39;&quot;).Replace(&quot;&amp;quot;&quot;,
                    &quot;\&quot;&quot;).Replace
                    (&quot;&amp;amp;&quot;, &quot;&amp;&quot;);
        }

        public static string ReplaceXMLCharEntities(string inputXml, XmlCharEntity en)
        {
            if (String.IsNullOrEmpty(inputXml))
                return String.Empty;

            if ((en &amp; XmlCharEntity.CE_AMP) == XmlCharEntity.CE_AMP)
                inputXml = inputXml.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;);
            if ((en &amp; XmlCharEntity.CE_QUOT) == XmlCharEntity.CE_QUOT)
                inputXml = inputXml.Replace(&quot;\&quot;&quot;, &quot;&amp;quot;&quot;);
            if ((en &amp; XmlCharEntity.CE_APOS) == XmlCharEntity.CE_APOS)
                inputXml = inputXml.Replace(&quot;&#39;&quot;, &quot;&amp;apos;&quot;);
            if ((en &amp; XmlCharEntity.CE_LT) == XmlCharEntity.CE_LT)
                inputXml = inputXml.Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;);
            if ((en &amp; XmlCharEntity.CE_GT) == XmlCharEntity.CE_GT)
                inputXml = inputXml.Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;);

            return inputXml;
        }

        public static string RevertXMLCharEntities(string inputXml, XmlCharEntity en)
        {
            if (String.IsNullOrEmpty(inputXml))
                return String.Empty;

            if ((en &amp; XmlCharEntity.CE_GT) == XmlCharEntity.CE_GT)
                inputXml = inputXml.Replace(&quot;&amp;gt;&quot;, &quot;&gt;&quot;);
            if ((en &amp; XmlCharEntity.CE_LT) == XmlCharEntity.CE_LT)
                inputXml = inputXml.Replace(&quot;&amp;lt;&quot;, &quot;&lt;&quot;);
            if ((en &amp; XmlCharEntity.CE_APOS) == XmlCharEntity.CE_APOS)
                inputXml = inputXml.Replace(&quot;&amp;apos;&quot;, &quot;&#39;&quot;);
            if ((en &amp; XmlCharEntity.CE_QUOT) == XmlCharEntity.CE_QUOT)
                inputXml = inputXml.Replace(&quot;&amp;quot;&quot;, &quot;\&quot;&quot;);
            if ((en &amp; XmlCharEntity.CE_AMP) == XmlCharEntity.CE_AMP)
                inputXml = inputXml.Replace(&quot;&amp;amp;&quot;, &quot;&amp;&quot;);

            return inputXml;
        }

        public static StringBuilder GenerateFilterXML(Control aspPnlFilterCtrl)
        {
            var sbFilterSearch = new StringBuilder();
            sbFilterSearch.Append(&quot;&lt;XMLRoot&gt;&quot;);
            foreach (Control ctrl in aspPnlFilterCtrl.Controls)
            {
                string ctrlTypeName = ctrl.GetType().FullName;

                if (ctrlTypeName == &quot;System.Web.UI.WebControls.TextBox&quot;)
                {
                    var tbox = (ctrl as TextBox);
                    if (tbox.Text.Length &gt; 0)
                    {
                        sbFilterSearch.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;{0} type=&#39;{2}&#39;&gt;{1}&lt;/{0}&gt;&quot;,
                            tbox.ID.Substring(3),
                            tbox.Text.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;),
                            tbox.ID.Substring(0, 3));
                    }
                }
                else if (ctrlTypeName == &quot;System.Web.UI.WebControls.RadioButtonList&quot;)
                {
                    var rbtnList = (ctrl as RadioButtonList);
                    if (rbtnList.SelectedValue != &quot;&quot;)
                    {
                        sbFilterSearch.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;{0} type=&#39;{2}&#39;&gt;{1}&lt;/{0}&gt;&quot;,
                            rbtnList.ID.Substring(3),
                            rbtnList.SelectedValue.Replace(&quot;&amp;&quot;, &quot;&amp;amp;&quot;).Replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;).
                                Replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;),
                            rbtnList.ID.Substring(0, 3));
                    }
                }
                else if (ctrlTypeName == &quot;Infragistics.WebUI.WebSchedule.WebDateChooser&quot;)
                {
                    WebDateChooser webDateChooser_Ctrl = ctrl as WebDateChooser;
                    if (webDateChooser_Ctrl != null &amp;&amp; webDateChooser_Ctrl.Value != null)
                    {
                        sbFilterSearch.AppendFormat(CultureInfo.CurrentCulture, &quot;&lt;{0} type=&#39;{2}&#39;&gt;{1}&lt;/{0}&gt;&quot;,
                            webDateChooser_Ctrl.ID.Substring(2),
                            &quot;{0:dd/MMM/yyyy}&quot;.Format2(webDateChooser_Ctrl.Text),
                            webDateChooser_Ctrl.ID.Substring(0, 2));
                    }
                }
            }
            if (sbFilterSearch.ToString2() == &quot;&lt;XMLRoot&gt;&quot;)
            {
                return null;
            }
            sbFilterSearch.Append(&quot;&lt;/XMLRoot&gt;&quot;);
            return sbFilterSearch;
        }

        public static KeyValuePair&lt;int, int&gt; RatioStretch(int imgWidth, int imgHeight, int ctrlWidth, int ctrlHeight)
        {
            var imRatio = (float)(imgWidth / (imgHeight * 1.0));
            var pRatio = (float)(ctrlWidth / (ctrlHeight * 1.0));

            if (ctrlWidth &gt;= imgWidth &amp;&amp; ctrlHeight &gt;= imgHeight)
                return new KeyValuePair&lt;int, int&gt;(imgWidth, imgHeight);

            if (ctrlWidth &gt; imgWidth &amp;&amp; ctrlHeight &lt; imgHeight)
                return new KeyValuePair&lt;int, int&gt;((int)(ctrlHeight * imRatio), ctrlHeight);

            if (ctrlWidth &lt; imgWidth &amp;&amp; ctrlHeight &gt; imgHeight)
                return new KeyValuePair&lt;int, int&gt;(ctrlWidth, (int)(ctrlWidth / imRatio));

            //i.e (ctrlWidth &lt; imgWidth &amp;&amp; ctrlHeight &lt; imgHeight)
            if (ctrlWidth &gt;= ctrlHeight)
            {
                //ctrlWidth image
                if (imgWidth &gt;= imgHeight &amp;&amp; imRatio &gt;= pRatio)
                    return new KeyValuePair&lt;int, int&gt;(ctrlWidth, (int)(ctrlWidth / imRatio));
                return new KeyValuePair&lt;int, int&gt;((int)(ctrlHeight * imRatio), ctrlHeight);
            }

            //width image
            if (ctrlWidth &lt; ctrlHeight &amp;&amp; imRatio &lt; pRatio)
                return new KeyValuePair&lt;int, int&gt;((int)(ctrlHeight * imRatio), ctrlHeight);
            // height image
            return new KeyValuePair&lt;int, int&gt;(ctrlWidth, (int)(ctrlWidth / imRatio));
        }

        public static void WritePDFOnResponse(HttpResponse response, MemoryStream strm)
        {
            response.ClearHeaders();
            response.ClearContent();
            response.ContentType = &quot;application/pdf&quot;;
            response.AddHeader(&quot;Content-Length&quot;, strm.Length.ToString2());
            response.BinaryWrite(strm.ToArray());
            response.Flush();
            HttpContext.Current.ApplicationInstance.CompleteRequest();
        }

        public static void WritePDFOnResponse(HttpResponse response, MemoryStream strm, string fileName)
        {
            response.ClearHeaders();
            response.ClearContent();
            response.ContentType = &quot;application/pdf&quot;;
            response.AddHeader(&quot;Content-Length&quot;, strm.Length.ToString2());
            if (fileName != null)
                response.AddHeader(&quot;Content-Disposition&quot;, &quot;attachment; filename=&quot; + fileName + &quot;.pdf&quot;);
            response.BinaryWrite(strm.ToArray());
            response.Flush();
            HttpContext.Current.ApplicationInstance.CompleteRequest();
        }

        public static void BindDropDownData(ListControl ddl, DataTable dataTable, string textFieldColumn,
            string valueFieldColumn, bool sortByValue = false)
        {
            dataTable.DefaultView.Sort = (sortByValue) ? valueFieldColumn : textFieldColumn;
            ddl.DataSource = dataTable.DefaultView;
            ddl.DataTextField = textFieldColumn;
            ddl.DataValueField = valueFieldColumn;
            ddl.DataBind();
        }

        public static void BindDropDownData(WebCombo ddl, DataTable dataTable, string textFieldColumn,
            string valueFieldColumn)
        {
            dataTable.DefaultView.Sort = textFieldColumn;
            ddl.DataSource = dataTable.DefaultView;
            ddl.DataTextField = textFieldColumn;
            ddl.DataValueField = valueFieldColumn;
            ddl.DataBind();
        }

        public static void BindDropDownData(ValueList ddl, DataTable dataTable, string textFieldColumn,
            string valueFieldColumn, bool sortByValue = false)
        {
            dataTable.DefaultView.Sort = (sortByValue) ? valueFieldColumn : textFieldColumn;
            ddl.DataSource = dataTable.DefaultView;
            ddl.DisplayMember = textFieldColumn;
            ddl.ValueMember = valueFieldColumn;
            ddl.DataBind();
        }

        public static void SetGridLayout(UltraWebGrid grid)
        {
            //Set Column Properties
            grid.DisplayLayout.CellSpacingDefault = 0;
            //grid.DisplayLayout.CellPaddingDefault = 4;
            //Set Row Properties
            grid.DisplayLayout.RowStyleDefault.BorderStyle = BorderStyle.Solid;
            grid.DisplayLayout.RowStyleDefault.BorderWidth = Unit.Pixel(1);
            //Set Allowed Actions
            grid.DisplayLayout.AllowAddNewDefault = AllowAddNew.Yes;
            grid.DisplayLayout.AllowUpdateDefault = AllowUpdate.Yes;
            grid.DisplayLayout.AllowDeleteDefault = AllowDelete.Yes;
        }

        internal static void CompressImageToThumbnail(string originalFilePath, string thumbnailFilePath, Size newSize)
        {
            MemoryStream memStrm = null;
            var logoFile = new HtmlInputFile();
            if (originalFilePath != &quot;&quot;)
            {
                string fName = originalFilePath.Substring(originalFilePath.LastIndexOf(&#39;\\&#39;) + 1);
                var sizeInbytes = (int)logoFile.PostedFile.InputStream.Length;
                var dataBytes = new byte[sizeInbytes];

                logoFile.PostedFile.InputStream.Read(dataBytes, 0, sizeInbytes);

                memStrm = new MemoryStream(dataBytes, 0, dataBytes.Length);
            }
            CompressImageToThumbnail(memStrm, thumbnailFilePath, newSize);
        }

        internal static void CompressImageToThumbnail(Stream srcFileStream, string thumbnailFilePath, Size newSize)
        {
            using (var bmp = new Bitmap(srcFileStream))
            {
                using (var thumb = new Bitmap(bmp, newSize))
                {
                    using (Graphics g = Graphics.FromImage(thumb)) // Create Graphics object from original Image
                    {
                        g.SmoothingMode = SmoothingMode.HighQuality;
                        g.InterpolationMode = InterpolationMode.High;
                        g.CompositingQuality = CompositingQuality.HighQuality;

                        //Set Image codec of JPEG type, the index of JPEG codec is &quot;1&quot;
                        ImageCodecInfo codec = ImageCodecInfo.GetImageEncoders()[1];

                        //Set the parameters for defining the quality of the thumbnail... here it is set to 100%
                        var eParams = new EncoderParameters(1);
                        eParams.Param[0] = new EncoderParameter(Encoder.Quality, 100L);

                        //Now draw the image on the instance of thumbnail Bitmap object
                        g.DrawImage(bmp, new Rectangle(0, 0, thumb.Width, thumb.Height));

                        thumb.Save(thumbnailFilePath, codec, eParams);
                    }
                }
            }
        }

        //this method remove as it was not getting use.
        //this function already exist in Aurigo.AMP3.Core.AbstractModels.ListModel.GetFilterXML
        //public static string GetFilterXML(string prefix, HttpRequest request, string[] filterCtrls)

        public static void AddItemtoXml(XmlTextWriter xWr, string tagName, string target, string name, string desc,
            string imgUrl, bool isEndElement, bool isAddGroup)
        {
            xWr.WriteStartElement(isAddGroup ? &quot;Group&quot; : tagName);
            if (!string.IsNullOrEmpty(target))
                xWr.WriteAttributeString(&quot;TargetUrl&quot;, target);
            xWr.WriteAttributeString(&quot;Name&quot;, name);
            xWr.WriteAttributeString(&quot;Description&quot;, desc);
            xWr.WriteAttributeString(&quot;ImageUrl&quot;, isAddGroup ? IMGPATHCATEGORY : imgUrl);
            if (isEndElement &amp;&amp; !isAddGroup) xWr.WriteEndElement();
        }

        /// &lt;summary&gt;
        /// 
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;userID&quot;&gt;&lt;/param&gt;
        /// &lt;remarks&gt;
        /// ASP.NET 2.0 Web Parts framework works with the Membership framework as well as the Forms or 
        /// Windows authentication modes. The problem is that, 
        /// if you don’t want to use any authentication mode, 
        /// you can’t use Web Parts. The client user, 
        /// who will able to change the web site&#39;s design with Web Parts, 
        /// should be authenticated. If not authenticated, 
        /// the ASP.NET Web Parts framework can’t save users&#39; design settings 
        /// with data providers and for that reason can’t allow even to switch design modes.
        /// 
        /// This will work with Anonymous access.
        /// &lt;/remarks&gt;
        /// &lt;see cref=&quot;http://www.codeproject.com/aspnet/anonywebparts.asp&quot;/&gt;
        public static void FakeFormsAuthentication(string userID)
        {
            try
            {
                var authTicket = new FormsAuthenticationTicket(1, userID, DateTime.UtcNow,
                    DateTime.UtcNow.AddYears(1), true,
                    &quot;roles&quot;);
                FormsAuthentication.SetAuthCookie(userID, true);
                FormsAuthentication.RenewTicketIfOld(authTicket);
            }
            catch (Exception ex)
            {
                Logger.Log(Enumerations.LogType.Error, ex.Message, Constants.MODID_USRMGMT);
                throw ex;
            }
        }

        public static void CreateDashboadTabs(int firstPage, TabBar tabBar, List&lt;WidgetPage&gt; pages, int currPage, string pagePrefix = &quot;Enterprise&quot;, string queryString = &quot;&quot;)
        {
            string url = string.Empty;
            pages.ForEach(page =&gt;
            {
                if (page.IsVisible)
                {
                    Tab tb = new Tab(page.Caption, &quot;#&quot;, (page.PageNo == currPage));
                    url = string.Format(&quot;{0}{1}.aspx{2}&quot;, pagePrefix,
                                (page.PageNo == 1 ? &quot;&quot; : (page.PageNo - 1).ToString()), queryString);

                    tb.linkButton.OnClientClick = &quot;javascript:window.location.href=&#39;&quot; + url + &quot;&#39;;return false;&quot;;
                    tabBar.Tabs.Add(tb);
                    //tabBar.Tabs.Add(
                    //    new Tab(page.Caption,
                    //        string.Format(&quot;{0}{1}.aspx{2}&quot;, pagePrefix,
                    //            (page.PageNo == 1 ? &quot;&quot; : (page.PageNo - 1).ToString()), queryString),
                    //        (page.PageNo == currPage)));
                }
            });
        }

        public static void ShowHideDashbodTab(string SettingName, int TabNo, bool Visible)
        {
            UserDetail ud = UserDetail.GetCurrentUserDetail();
            string s = CoreDatabaseHelper.GetControlSettings(ud.UID, SettingName);
            if (string.IsNullOrEmpty(s))
                s =
                    string.Format(
                        &quot;&lt;WidgetSettings&gt;&lt;WidgetPage LayoutNo=\&quot;2\&quot; IsVisible=\&quot;True\&quot; PageNo=\&quot;{0}\&quot; Caption=\&quot;Widget Page {0}\&quot; /&gt;&lt;/WidgetSettings&gt;&quot;,
                        TabNo);
            XmlDocument xDoc = new XmlDocument();
            xDoc.LoadXml(s);
            XmlNode xNode = xDoc.SelectSingleNode(string.Format(&quot;/WidgetSettings/WidgetPage[@PageNo=\&quot;{0}\&quot;]&quot;, TabNo));
            if (xNode != null)
            {
                xNode.Attributes[&quot;IsVisible&quot;].Value = Visible ? &quot;True&quot; : &quot;False&quot;;
                CoreDatabaseHelper.SaveControlSettings(ud.UID, SettingName, xDoc.OuterXml);
            }
        }

        public static string BuildURL(string url, IEnumerable&lt;string&gt; escapeKeys, HttpContext context)
        {
            string url_UPPER_CASE = url.ToUpper();

            escapeKeys = escapeKeys.Select(t =&gt; t.ToUpper());
            foreach (string key in context.Request.QueryString.AllKeys)
            {
                string key_UPPER = key.ToUpper();

                if (!escapeKeys.Any(t =&gt; t == key_UPPER)
                    &amp;&amp; !(url_UPPER_CASE.Contains(&quot;&amp;&quot; + key_UPPER + &quot;=&quot;) ||
                         url_UPPER_CASE.Contains(&quot;?&quot; + key_UPPER + &quot;=&quot;))
                )
                {
                    url += (url.Contains(&quot;?&quot;) ? &quot;&amp;&quot; : &quot;?&quot;) + key + &quot;=&quot; + context.Request.QueryString[key];
                    url_UPPER_CASE = url.ToUpper();
                }
            }

            return url;
        }

        #endregion

        public static Dictionary&lt;string, object&gt; GetRequestParams()
        {
            Dictionary&lt;String, String&gt; queryDict = new Dictionary&lt;string, string&gt;();
            var queryUrl = HttpContext.Current.Request.RawUrl.Split(&#39;?&#39;);
            if (queryUrl.Length &gt; 1)
                foreach (String token in queryUrl[1].Split(new char[] { &#39;&amp;&#39; }, StringSplitOptions.RemoveEmptyEntries))
                {
                    string[] parts = token.Split(new char[] { &#39;=&#39; }, StringSplitOptions.RemoveEmptyEntries);
                    if (parts.Length == 2)
                        queryDict[parts[0].Trim()] = HttpUtility.UrlDecode(parts[1]).Trim();
                    else
                        queryDict[parts[0].Trim()] = &quot;&quot;;
                }
            Dictionary&lt;string, object&gt; obj = new Dictionary&lt;string, object&gt;(StringComparer.OrdinalIgnoreCase);
            foreach (var row in queryDict)
            {
                obj.Add(row.Key, row.Value);
            }
            if (!obj.ContainsKey(&quot;instanceid&quot;))
            {
                obj.Add(&quot;instanceid&quot;, &quot;&quot;);
            }
            return obj;
        }        

        public static string JQueryFileName
        {
            get
            {
                var jqueryFileName = ConfigurationManager.AppSettings[&quot;JqueryFileName&quot;];

                if (string.IsNullOrEmpty(jqueryFileName))
                    return &quot;jquery-1.10.2.min.js&quot;;

                return jqueryFileName;
            }
        }

    }

    public class UIScriptHelper
    {
        private const string _frameworkBundle = &quot;FrameworkBundle&quot;;
        private const string _frameworkBundlePath = &quot;~/Scripts/bundle.framework.*.js&quot;;
        private OrderedDictionary _scriptRepository = new OrderedDictionary(StringComparer.OrdinalIgnoreCase);
        private OrderedDictionary _styleRepository = new OrderedDictionary(StringComparer.OrdinalIgnoreCase);

        public static string Get_FrameworkBundle_Const() { return _frameworkBundle; }

        public static string Get_FrameworkBundlePath_Const() { return _frameworkBundlePath; }

        private static List&lt;KeyValuePair&lt;string, List&lt;string&gt;&gt;&gt; IndividualJsFilesInbundle
        {
            get
            {
                List&lt;KeyValuePair&lt;string, List&lt;string&gt;&gt;&gt; jsFiles = new List&lt;KeyValuePair&lt;string, List&lt;string&gt;&gt;&gt;();

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Scripts/bundle.framework.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Scripts/InsiteCore.js&quot;,
                        &quot;~/Scripts/JSExtensions.js&quot;,
                        &quot;~/Scripts/WorkflowButtonsScripts.js&quot;,
                        &quot;~/Scripts/Workflow.js&quot;,
                        &quot;~/Scripts/ToastrNotification.js&quot;,
                        &quot;~/Scripts/BrixContextMenuJScript.js&quot;,
                        &quot;~/Scripts/AttachmentControl.js&quot;,
                        &quot;~/Scripts/GenericPickerControl.js&quot;,
                        &quot;~/Scripts/Picker.js&quot;,
                        &quot;~/Scripts/PickerGrid.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Scripts/bundle.brixlist.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Scripts/BrixListPage.js&quot;,
                        &quot;~/Scripts/BrixListPageValidate.js&quot;,
                        &quot;~/Scripts/MailMergeControl.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Scripts/bundle.brixform.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Scripts/XmlframeworkJScript.js&quot;,
                        &quot;~/Scripts/XMLFrameworkWrapperClass.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Scripts/bundle.brixitem.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Scripts/GridScript.js&quot;,
                        &quot;~/Scripts/RateAnalysisControl.js&quot;,
                        &quot;~/Scripts/BrixListPageValidate.js&quot;,
                        &quot;~/Scripts/BrixItemPageValidation.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Modules/WORKFLW/Scripts/app/bundle.workflow.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Modules/WORKFLW/Scripts/app/Application.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CollapsibleShape.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/View.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/Toolbar.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/Stage.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/StartStage.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/EndStage.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/IntermediateStage.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/ActivityContainer.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/ResourcePicker.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/Activity.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/ConditionsBlock.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/IfActivity.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/MorphWorkflow.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/FormData.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/GetFormData.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/SetFormData.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CreateNewForm.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/WorkflowConnection.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CallWorkflowResource.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/FormStatus.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/SetDueDate.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/SetStakeHolders.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/IsUserInRole.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/DisplayMessage.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/SendEmail.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/RequestDetails.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CreateNotification.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/WorkflowEditorWindow.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Modules/WORKFLW/Scripts/app/bundle.workflow.codeaction.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Modules/WORKFLW/Scripts/app/CodeAction.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CodeEditorWindow.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/CodeMirrorEditorWindow.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/FormTemplateWindow.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Modules/WORKFLW/Scripts/app/bundle.workflow.editor.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Modules/WORKFLW/Scripts/app/TabStrip.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/ActionUi.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/WorkflowActionsWindow.js&quot;,
                        &quot;~/Modules/WORKFLW/Scripts/app/ExpressionsEditorWindow.js&quot;
                    }));

                jsFiles.Add(new KeyValuePair&lt;string, List&lt;string&gt;&gt;(&quot;~/Modules/FRMBLDR/javascripts/bundle.frmbldr.*.js&quot;,
                    new List&lt;string&gt;()
                    {
                        &quot;~/Modules/FRMBLDR/javascripts/FormBuilder.js&quot;,
                        &quot;~/Modules/FRMBLDR/javascripts/PropertyEditor.js&quot;,
                        &quot;~/Modules/FRMBLDR/javascripts/HierarchyTree.js&quot;,
                        &quot;~/Modules/FRMBLDR/javascripts/XmlEditor.js&quot;
                    }));
                return jsFiles;
            }
        }

        //TODO: Use Redis Cache, monitor file modification
        public static long GetFileCacheDateTimeParam(string fileName)
        {
            string filePath = HttpContext.Current.Server.MapPath(fileName);
            if (HttpContext.Current != null &amp;&amp; HttpContext.Current.Cache[filePath] == null)
            {
                if (File.Exists(filePath))
                {
                    DateTime modification = File.GetLastWriteTime(filePath);
                    HttpContext.Current.Cache.Add(filePath, modification.Ticks, null,
                        DateTime.Now.AddDays(1), System.Web.Caching.Cache.NoSlidingExpiration, System.Web.Caching.CacheItemPriority.AboveNormal, null);

                }
            }
            return (long)(HttpContext.Current.Cache[filePath] ?? 0L);
        }

        public OrderedDictionary Get_ScriptRepository() { return _scriptRepository; }

        public OrderedDictionary Get_StyleRepository() { return _styleRepository; }

        private void AddScriptFile(Control scriptControl, string scriptId, string scriptFileWithPath, int index)
        {
            if (!string.IsNullOrEmpty(scriptFileWithPath) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                ScriptResource s = new ScriptResource();
                s.FilePath = scriptFileWithPath;
                s.IsFile = true;
                s.ScriptControl = scriptControl;
                if (index &gt; 0 &amp;&amp; index &lt; _scriptRepository.Count)
                    _scriptRepository.Insert(index, scriptId, s);
                else
                    _scriptRepository.Add(scriptId, s);
            }
        }

        public void AddScriptFile(Control scriptControl, string scriptId, string scriptFileWithPath)
        {
            AddScriptFile(scriptControl, scriptId, scriptFileWithPath, -1);
        }

        public void AddScriptFileBeforeTarget(Control scriptControl, string scriptId, string scriptFileWithPath, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptFileWithPath) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScriptFile(scriptControl, scriptId, scriptFileWithPath, _scriptRepository.GetIndex(scriptIdTarget));
            }
        }
        
        public void AddScriptFileAfterTarget(Control scriptControl, string scriptId, string scriptFileWithPath, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptFileWithPath) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScriptFile(scriptControl, scriptId, scriptFileWithPath, _scriptRepository.GetIndex(scriptIdTarget) + 1);
            }
        }

        private void AddScript(Control scriptControl, bool isStartUpScript, string scriptId, string scriptCode, int index = -1)
        {
            if (!string.IsNullOrEmpty(scriptCode) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                ScriptResource s = new ScriptResource();
                s.ScriptCode = scriptCode;
                s.IsFile = false;
                s.IsStartUpScript = isStartUpScript;
                s.ScriptControl = scriptControl;
                if(index &gt; 0 &amp;&amp; index &lt; _scriptRepository.Count)
                    _scriptRepository.Insert(index, scriptId, s);
                else
                    _scriptRepository.Add(scriptId, s);
            }
        }

        public void AddScript(Control scriptControl, string scriptId, string scriptCode)
        {
            AddScript(scriptControl, false, scriptId, scriptCode, -1);
        }

        public void AddScriptBeforeTarget(Control scriptControl, string scriptId, string scriptCode, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptCode) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScript(scriptControl, false, scriptId, scriptCode, _scriptRepository.GetIndex(scriptIdTarget));
            }
        }

        public void AddScriptAfterTarget(Control scriptControl, string scriptId, string scriptCode, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptCode) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScript(scriptControl, false, scriptId, scriptCode, _scriptRepository.GetIndex(scriptIdTarget) + 1);
            }
        }

        public void AddStartUpScript(Control scriptControl, string scriptId, string scriptCode)
        {
            AddScript(scriptControl, true, scriptId, scriptCode, -1);
        }

        public void AddStartUpScriptBeforeTarget(Control scriptControl, string scriptId, string scriptCode, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptCode) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScript(scriptControl, true, scriptId, scriptCode, _scriptRepository.GetIndex(scriptIdTarget));
            }
        }

        public void AddStartUpScriptAfterTarget(Control scriptControl, string scriptId, string scriptCode, string scriptIdTarget)
        {
            if (!string.IsNullOrEmpty(scriptCode) &amp;&amp; !_scriptRepository.Contains(scriptId))
            {
                AddScript(scriptControl, true, scriptId, scriptCode, _scriptRepository.GetIndex(scriptIdTarget) + 1);
            }
        }

        public void AddStyleFile(string styleId, string styleFilePath)
        {
            if (!string.IsNullOrEmpty(styleFilePath) &amp;&amp; !_styleRepository.Contains(styleId))
            {
                _styleRepository.Add(styleId, styleFilePath);
            }
        }

        private string BuildScriptMode
        {
            get
            {
                if (ConfigurationManager.AppSettings[&quot;BuildScriptMode&quot;] != null)
                    return ConfigurationManager.AppSettings[&quot;BuildScriptMode&quot;];
                return &quot;debug&quot;;
            }
        }

        private bool IsPartialPostBack(Page page)
        {
           return ScriptManager.GetCurrent(page).IsInAsyncPostBack;
        }

        public void RegisterScriptsAndStyles(Page page)
        {
            RegisterScript(page);
            RegisterStyle(page);
        }

        private void RegisterScript(Page page)
        {
            if (this.Get_ScriptRepository().Count &gt; 0)
            {
                foreach (DictionaryEntry de in this.Get_ScriptRepository())
                {
                    ScriptResource value = de.Value as ScriptResource;

                    if (value.IsFile)
                    {
                        string fileName = value.FilePath;

                        if (BuildScriptMode.ToLower() == &quot;dev&quot; &amp;&amp; value.FilePath.ToLower().Contains(&quot;bundle&quot;))
                        {
                            List&lt;string&gt; indFiles = IndividualJsFilesInbundle.Find(x =&gt; x.Key.ToLower() == fileName.ToLower()).Value;
                            if (indFiles != null)
                            {
                                foreach (string indFile in indFiles)
                                {
                                    fileName = indFile + &quot;?v=&quot; + UIScriptHelper.GetFileCacheDateTimeParam(indFile);

                                    RegisterClientScriptInclude(page, Guid.NewGuid().ToString2(), page.ResolveClientUrl(fileName), value.ScriptControl, IsPartialPostBack(page));
                                }
                            }
                            continue;
                        }
                        else if (BuildScriptMode.ToLower() == &quot;debug&quot;)
                            fileName = value.FilePath.Replace(&quot;*&quot;, &quot;dev&quot;);
                        else if (BuildScriptMode.ToLower() == &quot;prod&quot;)
                            fileName = value.FilePath.Replace(&quot;*&quot;, &quot;prod&quot;);

                        fileName = fileName + &quot;?v=&quot; + UIScriptHelper.GetFileCacheDateTimeParam(fileName);

                        RegisterClientScriptInclude(page, de.Key.ToString(), page.ResolveClientUrl(fileName), value.ScriptControl, IsPartialPostBack(page));
                    }
                    else if (value.IsStartUpScript)
                    {
                        RegisterStartupScript(page, de.Key.ToString(), value.ScriptCode, value.ScriptControl, IsPartialPostBack(page));
                    }
                    else
                    {
                        RegisterClientScriptBlock(page, de.Key.ToString(), value.ScriptCode, value.ScriptControl, IsPartialPostBack(page));
                    }
                }
            }
        }

        private void RegisterStyle(Page page)
        {
            if (this.Get_StyleRepository().Count &gt; 0)
            {
                foreach (DictionaryEntry de in this.Get_StyleRepository())
                {
                    page.Header.Controls.Add(new System.Web.UI.LiteralControl(string.Format(&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;{0}\&quot; /&gt;&quot;, page.ResolveUrl(de.Value.ToString()))));
                }
            }
        }

        private void RegisterStartupScript(Page page, string key, string script, Control registerForControl = null, bool registerOnPartialPostback = false)
        {
            if (registerOnPartialPostback)
                ScriptManager.RegisterStartupScript(registerForControl ?? page, (registerForControl ?? page).GetType(), key, script, true);
            else
                page.ClientScript.RegisterStartupScript((registerForControl ?? page).GetType(), key, script, true);
        }

        private void RegisterClientScriptBlock(Page page, string key, string script, Control registerForControl = null, bool registerOnPartialPostback = false)
        {
            if (registerOnPartialPostback)
                ScriptManager.RegisterClientScriptBlock(registerForControl ?? page, (registerForControl ?? page).GetType(), key, script, true);
            else
                page.ClientScript.RegisterClientScriptBlock((registerForControl ?? page).GetType(), key, script, true);
        }

        private void RegisterClientScriptInclude(Page page, string key, string file, Control registerForControl = null, bool registerOnPartialPostback = false)
        {
            if (registerOnPartialPostback)
                ScriptManager.RegisterClientScriptInclude(registerForControl ?? page, (registerForControl ?? page).GetType(), key, file);
            else
                page.ClientScript.RegisterClientScriptInclude((registerForControl ?? page).GetType(), key, file);
        }
    }

    public enum ModelType
    {
        List,
        Edit,
        ItemList,
        ItemEdit,
        Gallery,
        ContextMenu
    }

    public enum ContextMenuActionType
    {
        Link,
        BrixPage,
        Code,
        ClientScript,
        Report
    }


}
    </pre>
    <script type="text/javascript">
      highlightRanges([[67,13,67,14,1],[68,17,68,109,1],[69,21,69,83,0],[71,21,71,34,1],[72,13,72,14,1],[76,9,76,10,0],[79,13,79,42,0],[81,13,81,14,0],[82,17,82,182,0],[85,17,85,73,0],[86,17,86,18,0],[87,21,87,57,0],[88,21,88,126,0],[90,21,90,88,0],[91,21,91,50,0],[93,21,100,23,0],[102,21,102,72,0],[103,21,103,50,0],[106,21,106,202,0],[107,17,107,18,0],[109,17,109,18,0],[110,21,110,47,0],[111,17,111,18,0],[113,17,113,37,0],[114,17,114,18,0],[115,21,115,56,0],[116,21,116,86,0],[117,21,117,87,0],[118,21,118,127,0],[119,17,119,18,0],[121,17,121,18,0],[122,21,122,38,0],[123,21,123,38,0],[124,21,124,38,0],[125,21,125,79,0],[126,17,126,18,0],[127,13,127,14,0],[128,13,128,33,0],[129,13,129,14,0],[130,17,130,34,0],[131,17,131,34,0],[132,17,132,34,0],[133,17,133,75,0],[135,17,135,44,0],[136,13,136,14,0],[137,13,137,27,0],[138,9,138,10,0],[141,9,141,10,1],[142,13,142,44,1],[143,17,143,93,1],[145,17,145,86,1],[146,9,146,10,1],[149,9,149,10,1],[150,13,150,44,1],[151,17,151,92,0],[153,17,153,85,1],[154,9,154,10,1],[157,9,157,10,1],[158,13,158,67,1],[159,9,159,10,1],[162,9,162,10,1],[163,13,163,66,1],[164,9,164,10,1],[167,9,167,10,1],[168,13,168,37,1],[169,13,169,48,1],[170,13,170,14,1],[171,17,171,35,1],[174,25,174,76,1],[175,29,175,69,0],[177,29,177,71,1],[178,25,178,31,1],[180,25,180,76,1],[181,29,181,68,1],[183,29,183,70,1],[184,25,184,31,1],[186,25,186,76,1],[187,29,187,69,0],[189,29,189,71,1],[190,25,190,31,1],[192,25,192,31,0],[194,13,194,14,1],[195,13,195,30,1],[196,9,196,10,1],[199,9,199,10,1],[200,13,200,58,1],[201,13,201,35,1],[202,13,202,14,0],[203,17,203,53,0],[204,17,204,44,0],[205,21,205,58,0],[206,17,206,43,0],[207,21,207,57,0],[208,13,208,14,0],[209,13,209,30,1],[210,9,210,10,1],[213,9,213,10,1],[216,13,216,102,1],[217,17,217,97,1],[219,13,219,44,1],[220,17,220,43,1],[222,17,222,46,1],[223,9,223,10,1],[226,9,226,10,1],[229,13,230,48,1],[231,17,231,29,1],[233,13,233,35,1],[234,9,234,10,1],[237,9,237,10,0],[238,13,238,53,0],[239,9,239,10,0],[242,9,242,10,1],[243,13,243,60,1],[245,13,247,66,1],[248,17,248,44,1],[251,17,251,89,1],[252,17,252,93,0],[254,13,260,80,1],[261,9,261,10,0],[264,9,264,10,1],[265,13,269,42,1],[270,9,270,10,1],[273,9,273,10,1],[274,13,278,36,1],[279,9,279,10,1],[282,9,282,10,1],[283,13,283,48,1],[284,17,284,37,0],[286,13,286,69,1],[287,17,287,59,1],[288,13,288,71,1],[289,17,289,61,1],[290,13,290,71,1],[291,17,291,60,0],[292,13,292,67,1],[293,17,293,58,1],[294,13,294,67,1],[295,17,295,58,1],[297,13,297,29,1],[298,9,298,10,1],[301,9,301,10,0],[302,13,302,48,0],[303,17,303,37,0],[305,13,305,67,0],[306,17,306,58,0],[307,13,307,67,0],[308,17,308,58,0],[309,13,309,71,0],[310,17,310,60,0],[311,13,311,71,0],[312,17,312,61,0],[313,13,313,69,0],[314,17,314,59,0],[316,13,316,29,0],[317,9,317,10,0],[320,9,320,10,1],[321,13,321,54,1],[322,13,322,48,1],[323,13,323,20,1],[323,22,323,34,1],[323,35,323,37,1],[323,38,323,63,1],[324,13,324,14,1],[325,17,325,63,1],[327,17,327,73,1],[328,17,328,18,1],[329,21,329,50,1],[330,21,330,46,1],[331,21,331,22,0],[332,25,335,54,0],[336,21,336,22,0],[337,17,337,18,1],[338,22,338,86,1],[339,17,339,18,1],[340,21,340,62,1],[341,21,341,54,1],[342,21,342,22,1],[343,25,347,58,1],[348,21,348,22,1],[349,17,349,18,1],[350,22,350,90,1],[351,17,351,18,0],[352,21,352,81,0],[353,21,353,90,0],[354,21,354,22,0],[355,25,358,69,0],[359,21,359,22,0],[360,17,360,18,0],[361,13,361,14,1],[362,13,362,59,1],[363,13,363,14,0],[364,17,364,29,0],[366,13,366,49,1],[367,13,367,35,1],[368,9,368,10,1],[371,9,371,10,1],[372,13,372,65,1],[373,13,373,66,1],[375,13,375,66,1],[376,17,376,72,1],[378,13,378,64,0],[379,17,379,92,0],[381,13,381,64,0],[382,17,382,90,0],[385,13,385,41,0],[386,13,386,14,0],[388,17,388,64,0],[389,21,389,94,0],[390,17,390,92,0],[394,13,394,60,0],[395,17,395,92,0],[397,13,397,86,0],[398,9,398,10,1],[401,9,401,10,0],[402,13,402,37,0],[403,13,403,37,0],[404,13,404,54,0],[405,13,405,75,0],[406,13,406,50,0],[407,13,407,30,0],[408,13,408,71,0],[409,9,409,10,0],[412,9,412,10,0],[413,13,413,37,0],[414,13,414,37,0],[415,13,415,54,0],[416,13,416,75,0],[417,13,417,34,0],[418,17,418,104,0],[419,13,419,50,0],[420,13,420,30,0],[421,13,421,71,0],[422,9,422,10,0],[426,9,426,10,1],[427,13,427,93,1],[428,13,428,52,1],[429,13,429,49,1],[430,13,430,51,1],[431,13,431,28,1],[432,9,432,10,1],[436,9,436,10,0],[437,13,437,58,0],[438,13,438,52,0],[439,13,439,49,0],[440,13,440,51,0],[441,13,441,28,0],[442,9,442,10,0],[446,9,446,10,1],[447,13,447,93,1],[448,13,448,52,1],[449,13,449,49,1],[450,13,450,48,1],[451,13,451,28,1],[452,9,452,10,1],[455,9,455,10,1],[457,13,457,55,1],[460,13,460,80,1],[461,13,461,76,1],[463,13,463,69,1],[464,13,464,69,1],[465,13,465,69,1],[466,9,466,10,1],[469,9,469,10,0],[470,13,470,41,0],[471,13,471,48,0],[472,13,472,40,0],[473,13,473,14,0],[474,17,474,99,0],[475,17,475,79,0],[476,17,476,55,0],[478,17,478,81,0],[480,17,480,76,0],[481,13,481,14,0],[482,13,482,75,0],[483,9,483,10,0],[486,9,486,10,0],[487,20,487,55,0],[488,13,488,14,0],[489,24,489,60,0],[490,17,490,18,0],[491,28,491,66,0],[492,21,492,22,0],[493,25,493,69,0],[494,25,494,70,0],[495,25,495,79,0],[498,25,498,85,0],[501,25,501,64,0],[502,25,502,88,0],[505,25,505,90,0],[507,25,507,71,0],[508,21,508,22,0],[509,17,509,18,0],[510,13,510,14,0],[511,9,511,10,0],[519,9,519,10,0],[520,13,520,67,0],[521,13,521,47,0],[522,17,522,63,0],[523,13,523,52,0],[524,13,524,59,0],[525,13,525,89,0],[526,13,526,45,0],[526,46,526,68,0],[527,9,527,10,0],[547,9,547,10,1],[549,13,549,14,1],[550,17,552,30,1],[553,17,553,65,1],[554,17,554,66,1],[555,13,555,14,1],[556,13,556,33,0],[557,13,557,14,0],[558,17,558,93,0],[559,17,559,26,0],[561,9,561,10,1],[564,9,564,10,1],[565,13,565,39,1],[566,13,567,13,1],[567,13,567,14,1],[567,14,568,17,1],[568,17,568,36,1],[568,36,569,17,1],[569,17,569,18,0],[569,18,570,21,1],[570,21,570,84,0],[570,84,571,21,1],[571,21,572,102,0],[572,102,574,21,1],[574,21,574,113,0],[574,113,575,21,1],[575,21,575,41,0],[575,41,581,17,1],[581,17,581,18,0],[581,18,582,13,1],[582,13,582,14,1],[582,14,582,16,1],[566,13,582,16,1],[583,9,583,10,1],[586,9,586,10,0],[587,13,587,63,0],[588,13,588,83,0],[589,13,589,41,0],[590,17,593,32,0],[594,13,594,50,0],[595,13,595,29,0],[596,13,596,120,0],[597,13,597,31,0],[598,13,598,14,0],[599,17,599,82,0],[600,17,600,92,0],[601,13,601,14,0],[602,9,602,10,0],[605,9,605,10,1],[606,13,606,51,1],[608,13,608,49,1],[608,49,608,60,1],[608,60,608,62,1],[608,13,608,62,1],[609,13,609,20,1],[609,22,609,32,1],[609,33,609,35,1],[609,36,609,71,1],[610,13,610,14,1],[611,17,611,50,1],[613,17,613,42,1],[613,42,613,56,1],[613,56,616,18,1],[613,17,616,18,1],[617,17,617,18,1],[618,21,618,107,1],[619,21,619,52,1],[620,17,620,18,1],[621,13,621,14,1],[623,13,623,24,1],[624,9,624,10,1],[629,9,629,10,1],[630,13,630,85,1],[631,13,631,74,1],[632,13,632,37,1],[633,17,633,24,1],[633,26,633,38,1],[633,39,633,41,1],[633,42,633,118,1],[634,17,634,18,1],[635,21,635,109,1],[636,21,636,43,1],[637,25,637,93,1],[639,25,639,57,0],[640,17,640,18,1],[641,13,641,111,1],[642,13,642,20,1],[642,22,642,29,1],[642,30,642,32,1],[642,33,642,42,1],[643,13,643,14,1],[644,17,644,45,1],[645,13,645,14,1],[646,13,646,48,1],[647,13,647,14,1],[648,17,648,43,1],[649,13,649,14,1],[650,13,650,24,1],[651,9,651,10,1],[656,13,656,14,1],[657,17,657,89,1],[659,17,659,58,1],[660,21,660,51,1],[662,17,662,39,0],[663,13,663,14,1],[672,9,672,111,1],[673,9,673,110,1],[675,58,675,59,1],[675,60,675,84,1],[675,85,675,86,1],[677,62,677,63,1],[677,64,677,92,1],[677,93,677,94,1],[682,13,682,14,0],[683,17,683,115,0],[685,17,698,25,0],[700,17,706,25,0],[708,17,713,25,0],[715,17,722,25,0],[724,17,756,25,0],[758,17,765,25,0],[767,17,774,25,0],[776,17,783,25,0],[784,17,784,32,0],[785,13,785,14,0],[790,9,790,10,1],[791,13,791,76,1],[792,13,792,92,1],[793,13,793,14,1],[794,17,794,43,1],[795,17,795,18,1],[796,21,796,77,1],[797,21,798,152,1],[800,17,800,18,1],[801,13,801,14,1],[802,13,802,70,1],[803,9,803,10,1],[805,57,805,58,1],[805,59,805,84,1],[805,85,805,86,1],[807,56,807,57,1],[807,58,807,82,1],[807,83,807,84,1],[810,9,810,10,1],[811,13,811,100,1],[812,13,812,14,1],[813,17,813,57,1],[814,17,814,49,1],[815,17,815,33,1],[816,17,816,49,1],[817,17,817,66,1],[818,21,818,66,0],[820,21,820,56,1],[821,13,821,14,1],[822,9,822,10,1],[825,9,825,10,1],[826,13,826,76,1],[827,9,827,10,1],[830,9,830,10,0],[831,13,831,100,0],[832,13,832,14,0],[833,17,833,120,0],[834,13,834,14,0],[835,9,835,10,0],[838,9,838,10,0],[839,13,839,100,0],[840,13,840,14,0],[841,17,841,124,0],[842,13,842,14,0],[843,9,843,10,0],[846,9,846,10,1],[847,13,847,92,1],[848,13,848,14,1],[849,17,849,57,1],[850,17,850,43,1],[851,17,851,34,1],[852,17,852,53,1],[853,17,853,49,1],[854,17,854,65,1],[855,21,855,66,0],[857,21,857,56,1],[858,13,858,14,1],[859,9,859,10,1],[862,9,862,10,1],[863,13,863,71,1],[864,9,864,10,1],[867,9,867,10,0],[868,13,868,92,0],[869,13,869,14,0],[870,17,870,115,0],[871,13,871,14,0],[872,9,872,10,0],[875,9,875,10,0],[876,13,876,92,0],[877,13,877,14,0],[878,17,878,119,0],[879,13,879,14,0],[880,9,880,10,0],[883,9,883,10,1],[884,13,884,70,1],[885,9,885,10,1],[888,9,888,10,0],[889,13,889,92,0],[890,13,890,14,0],[891,17,891,114,0],[892,13,892,14,0],[893,9,893,10,0],[896,9,896,10,0],[897,13,897,92,0],[898,13,898,14,0],[899,17,899,118,0],[900,13,900,14,0],[901,9,901,10,0],[904,9,904,10,1],[905,13,905,93,1],[906,13,906,14,1],[907,17,907,62,1],[908,13,908,14,1],[909,9,909,10,1],[914,13,914,14,1],[915,17,915,81,1],[916,21,916,80,1],[917,17,917,32,0],[918,13,918,14,1],[922,9,922,10,1],[923,12,923,68,1],[924,9,924,10,1],[927,9,927,10,1],[928,13,928,34,1],[929,13,929,33,1],[930,9,930,10,1],[933,9,933,10,1],[934,13,934,55,1],[935,13,935,14,1],[936,17,936,24,1],[936,26,936,44,1],[936,45,936,47,1],[936,48,936,75,1],[937,17,937,18,1],[938,21,938,71,1],[940,21,940,38,1],[941,21,941,22,1],[942,25,942,58,1],[944,25,944,111,1],[945,25,945,26,0],[946,29,946,89,0],[946,89,946,126,0],[946,126,946,134,0],[946,29,946,134,0],[947,29,947,50,0],[948,29,948,30,0],[949,33,949,40,0],[949,42,949,56,0],[949,57,949,59,0],[949,60,949,68,0],[950,33,950,34,0],[951,37,951,116,0],[953,37,953,178,0],[954,33,954,34,0],[955,29,955,30,0],[956,29,956,38,0],[958,30,958,71,1],[959,29,959,75,0],[960,30,960,70,1],[961,29,961,76,1],[963,25,963,106,1],[965,25,965,157,1],[966,21,966,22,1],[967,26,967,52,1],[968,21,968,22,1],[969,25,969,136,1],[970,21,970,22,1],[972,21,972,22,1],[973,25,973,140,1],[974,21,974,22,1],[975,17,975,18,1],[976,13,976,14,1],[977,9,977,10,1],[980,9,980,10,1],[981,13,981,54,1],[982,13,982,14,1],[983,17,983,24,1],[983,26,983,44,1],[983,45,983,47,1],[983,48,983,74,1],[984,17,984,18,1],[985,21,985,195,1],[986,17,986,18,1],[987,13,987,14,1],[988,9,988,10,1],[991,9,991,10,1],[992,13,992,43,1],[993,17,993,140,1],[995,17,995,116,1],[996,9,996,10,1],[999,9,999,10,1],[1000,13,1000,43,1],[1001,17,1001,144,1],[1003,17,1003,120,1],[1004,9,1004,10,1],[1007,9,1007,10,1],[1008,13,1008,43,1],[1009,17,1009,138,1],[1011,17,1011,114,1],[1012,9,1012,10,1]]);
    </script>
  </body>
</html>